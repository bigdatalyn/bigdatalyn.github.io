if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.ajax"]=true;

;if(!dojo._hasResource["com.ibm.ajax.auth"]){
dojo._hasResource["com.ibm.ajax.auth"]=true;
dojo.provide("com.ibm.ajax.auth");
com.ibm.ajax.auth={contentTypeRegex:/^text\/html/,ignoredDojoErrors:["cancel","timeout"],nonHtmlTypes:["xml","json","json-comment-optional"],checkFromCaller:true,checkByContentType:true,checkByStatusCode:true,checkAllStatusCodes:false,checkByXLConnAuth:false,authenticationChecks:[],interceptDojoXhr:function(_1){
if(this._intercepted){
return;
}
this._intercepted=true;
if(_1){
this.isUrlSecure=_1;
}
dojo.xhr=dojo.hitch(dojo,this.xhrIntercept,this,dojo.xhr);
if(dojo.getObject("dojo.io.iframe")){
dojo.io.iframe.send=dojo.hitch(dojo.io.iframe,this.ioIntercept,this,dojo.io.iframe.send);
}
},prepareSecure:function(_2,_3,_4,_5){
if(_2["com.ibm.ajax.auth.prepareSecureCalled"]){
return _2;
}
_2["com.ibm.ajax.auth.prepareSecureCalled"]=true;
if(!_5){
var h=_2.headers=_2.headers||{};
var p=h.Pragma;
if(!dojo.isArray(p)){
p=h.Pragma=p?[p]:[];
}
p.push("WWW-Authenticate=XHR");
}
_2._handle=_2.handle;
_2.handle=dojo.partial(this.testAuthenticationHandler,this,_3,_4);
return _2;
},setAuthenticationHandler:function(_6){
this.authenticationHandler=_6;
},setDefaultAuthenticationTests:function(_7,_8,_9){
this.checkFromCaller=_7;
this.checkByContentType=_8;
this.checkByStatusCode=_9;
},addAuthenticationCheck:function(_a){
if(_a){
this.authenticationChecks.push(_a);
}
},setAuthenticationTest:function(_b){
this.isAuthenticationRequired=dojo.partial(_b,this);
},isAuthenticationRequired:function(_c,_d){
if(this.isPossibleLoginRedirect(_c,_d)){
return true;
}
var i;
for(i=0;i<this.authenticationChecks.length;i++){
if(this.authenticationChecks[i](this,_c,_d)){
_d._authOutcome="Custom authentication check #"+(i+1)+" indicated login necessary";
return true;
}
}
return false;
},isPossibleLoginRedirect:function(_e,_f){
if(_f.xhr&&(!_e||dojo.indexOf(this.ignoredDojoErrors,_e.dojoType)==-1)){
var _10;
try{
_10=_f.xhr.status;
}
catch(ignore){
}
var _11=_f.handleAs;
if(_f.args){
_11=_f.args.expectedContentType||_f.args.handleAs;
}
var _12=dojo.indexOf(this.nonHtmlTypes,_11)!=-1;
if(this.checkByStatusCode&&(_12||this.checkAllStatusCodes)){
if(_10==302){
_f._authOutcome="Status code was 302";
return true;
}
if(_10==401){
_f._authOutcome="Status code was 401";
return true;
}
if(dojo.isIE&&(_10==0||_10=="unknown")){
_f._authOutcome="Status code was 0 or \"unknown\"";
return true;
}
}
var _13="html";
if(_f.xhr.getResponseHeader){
_13=_f.xhr.getResponseHeader("Content-Type");
}else{
if(_f.HEADERS){
_13=_f.HEADERS["Content-Type"];
}
}
if(this.checkByContentType&&_12&&this.contentTypeRegex.exec(_13)&&_10>=200&&_10<300&&_10!=204){
_f._authOutcome="Content-Type was HTML and status code indicated success";
return true;
}
try{
if(this.checkByXLConnAuth&&_f&&_f.xhr){
var h=_f.xhr.getResponseHeader("X-LConn-Auth");
if(h=="true"){
return false;
}
if(h=="false"){
return true;
}
}
}
catch(ignore){
}
}
return false;
},testAuthenticationHandler:function(_14,_15,_16,_17,_18){
var _19=dojo._toArray(arguments).slice(3);
var _1a=false;
if(_14.checkFromCaller&&typeof _15=="function"&&_15(_17,_18)){
_18._authOutcome="isAuthRequired returned true";
_1a=true;
}
_1a=_1a||_14.isAuthenticationRequired(_17,_18);
if(_1a){
_14.authenticationHandler(_17,_18,_16);
_19[0]=new Error("xhr unauthenticated");
_19[0].dojoType="unauthenticated";
}
if(_18.args&&_18.args._handle){
return _18.args._handle.apply(this,_19);
}
if(_18._handle){
return _18._handle.apply(this,_19);
}
return _17;
},authenticationHandler:function(){
console.log("auth::authenticationHandler DEBUG authentication was required");
},xhrIntercept:function(_1b,f,_1c,_1d){
var _1e=dojo._toArray(arguments).slice(2);
var p=_1d.auth||{};
var _1f=p.secured;
if(_1f||(_1f!=false&&_1b.isUrlSecure(_1d.url))){
_1e[1]=_1b.prepareSecure(_1d,p.isAuthRequired,p.onLogin,p.sendXhrAuthHeader===false);
}
return f.apply(this,_1e);
},ioIntercept:function(_20,f,_21){
var _22=dojo._toArray(arguments).slice(2);
var p=_21.auth||{};
var _23=p.secured;
if(_23||(_23!=false&&_20.isUrlSecure(_21.url))){
_22[0]=_20.prepareSecure(_21,p.isAuthRequired,p.onLogin,p.sendXhrAuthHeader===false);
}
return f.apply(this,_22);
},isUrlSecure:function(url){
return false;
}};
}

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.mm"]=true;

;if(!dojo._hasResource["com.ibm.mm.livetext.serviceImpl"]){
dojo._hasResource["com.ibm.mm.livetext.serviceImpl"]=true;
dojo.provide("com.ibm.mm.livetext.serviceImpl");
dojo.declare("com.ibm.mm.livetext.serviceImpl",null,{_tagTypes:null,tagChanged:"/com/ibm/mashups/livetext/livetextchanged",tagStatusChange:"/com/ibm/mashups/livetext/livetextchanged",tagContentChanged:"/com/ibm/mashups/livetext/livetextcontentchanged",entryAdded:"/com/ibm/mashups/livetext/configentryadded",entryRemoved:"/com/ibm/mashups/livetext/configentryremoved",init:function(){
this._loadTags();
dojo.subscribe(this.tagChanged,this,"onTagChanged");
dojo.subscribe(this.tagContentChanged,this,"onTagContentChanged");
dojo.subscribe(this.entryAdded,this,"onAddConfigEntry");
dojo.subscribe(this.entryRemoved,this,"onRemoveConfigEntry");
dojo.publish(this.tagContentChanged,[document,true]);
},_getNodes:function(_1,_2){
if(_2.processEnclosedTags){
return dojo.query(_2.match,_1);
}else{
var a=dojo.query(_2.match+" "+_2.match,_1);
var b=dojo.query(_2.match,_1);
var _3,_4;
while(a.length>0){
_3=a[0];
_4=0;
while(_4<b.length){
if(_3==b[_4]){
a.splice(0,1);
b.splice(_4,1);
break;
}else{
_4++;
}
}
}
return b;
}
},onTagChanged:function(_5,_6,_7,_8){
var _9=null,_a=null,_b=null;
for(var _c=0;_c<this._tagTypes.length;_c++){
_9=this._tagTypes[_c];
this._processTypeTag(_5,_9,_6,_7,_8,true);
}
},onTagContentChanged:function(_d,_e,_f,_10){
var tag=null,_11=null,_12=null;
for(var _13=0;_13<this._tagTypes.length;_13++){
tag=this._tagTypes[_13];
this._processTypeTag(_d,tag,_e,_f,_10,false);
}
},_processTypeTag:function(_14,tag,_15,_16,_17,_18){
var _19=[];
if(_18&&this._checkRoot(_14,tag)){
_19[0]=_14;
}
_19=_19.concat(this._getNodes(_14,tag));
var _1a=[];
_1a=_1a.concat(_19);
if(_1a.length>0){
if(tag.loaded==null){
this._loadTagHandler(tag);
}
var _1b=[];
if(dojo.isFunction(_16)){
try{
_16(_14,_1a);
}
catch(error){
if(dojo.config.isDebug){
console.debug(error);
}
}
}
for(var _1c=0;_1c<_19.length;_1c++){
try{
tag.tagHandler.processTag(_19[_1c]);
}
catch(error){
_1b[_1b.length]=error;
if(_15){
break;
}
}
}
if(dojo.isFunction(_17)){
try{
_17(_14,_1a,_1b);
}
catch(error){
if(dojo.config.isDebug){
console.debug(error);
}
}
}
}
},_checkRoot:function(_1d,tag){
var _1e=false;
if(_1d!=null&&_1d.nodeType){
var _1f=_1d.cloneNode(false);
var _20=document.createElement("div");
_20.appendChild(_1f);
var _21=this._getNodes(_20,tag);
if(_21!=null&&_21.length>0){
_1e=true;
}
delete _1f;
delete _20;
delete _21;
}
return _1e;
},_loadTags:function(){
if(this._tagTypes==null){
var _22=this;
if(typeof livetextCfg!="undefined"){
this._tagTypes=livetextCfg;
}else{
dojo.xhrGet({url:dojo.moduleUrl("com.ibm.mm.livetext","tagservice.entries.cfg"),handleAs:"text",sync:true,load:function(_23){
_22._tagTypes=dojo.fromJson(_23);
},error:function(_24){
console.dir(_24);
}});
}
}
},onAddConfigEntry:function(_25){
},onRemoveConfigEntry:function(_26){
},parseDom:function(_27,_28){
dojo.publish(this.tagChanged,[_28]);
},_loadTagHandler:function(tag){
dojo.registerModulePath(tag.module,tag.path);
dojo.eval("dojo.r"+"equire('"+tag.baseClass+"')");
var _29="{create:function(){return new "+tag.baseClass+"()}}";
var _2a=dojo.fromJson(_29);
tag.tagHandler=_2a.create();
tag.loaded=true;
}});
}


;define("dojo/window",["./_base/lang","./sniff","./_base/window","./dom","./dom-geometry","./dom-style","./dom-construct"],function(_1,_2,_3,_4,_5,_6,_7){
_2.add("rtl-adjust-position-for-verticalScrollBar",function(_8,_9){
var _a=_3.body(_9),_b=_7.create("div",{style:{overflow:"scroll",overflowX:"visible",direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},_a,"last"),_c=_7.create("div",{style:{overflow:"hidden",direction:"ltr"}},_b,"last"),_d=_5.position(_c).x!=0;
_b.removeChild(_c);
_a.removeChild(_b);
return _d;
});
_2.add("position-fixed-support",function(_e,_f){
var _10=_3.body(_f),_11=_7.create("span",{style:{visibility:"hidden",position:"fixed",left:"1px",top:"1px"}},_10,"last"),_12=_7.create("span",{style:{position:"fixed",left:"0",top:"0"}},_11,"last"),ret=_5.position(_12).x!=_5.position(_11).x;
_11.removeChild(_12);
_10.removeChild(_11);
return ret;
});
var _13={getBox:function(doc){
doc=doc||_3.doc;
var _14=(doc.compatMode=="BackCompat")?_3.body(doc):doc.documentElement,_15=_5.docScroll(doc),w,h;
if(_2("touch")){
var _16=_13.get(doc);
w=_16.innerWidth||_14.clientWidth;
h=_16.innerHeight||_14.clientHeight;
}else{
w=_14.clientWidth;
h=_14.clientHeight;
}
return {l:_15.x,t:_15.y,w:w,h:h};
},get:function(doc){
if(_2("ie")<9&&_13!==document.parentWindow){
doc.parentWindow.execScript("document._parentWindow = window;","Javascript");
var win=doc._parentWindow;
doc._parentWindow=null;
return win;
}
return doc.parentWindow||doc.defaultView;
},scrollIntoView:function(_17,pos){
try{
_17=_4.byId(_17);
var doc=_17.ownerDocument||_3.doc,_18=_3.body(doc),_19=doc.documentElement||_18.parentNode,_1a=_2("ie"),_1b=_2("webkit");
if(_17==_18||_17==_19){
return;
}
if(!(_2("mozilla")||_1a||_1b||_2("opera")||_2("trident"))&&("scrollIntoView" in _17)){
_17.scrollIntoView(false);
return;
}
var _1c=doc.compatMode=="BackCompat",_1d=Math.min(_18.clientWidth||_19.clientWidth,_19.clientWidth||_18.clientWidth),_1e=Math.min(_18.clientHeight||_19.clientHeight,_19.clientHeight||_18.clientHeight),_1f=(_1b||_1c)?_18:_19,_20=pos||_5.position(_17),el=_17.parentNode,_21=function(el){
return (_1a<=6||(_1a==7&&_1c))?false:(_2("position-fixed-support")&&(_6.get(el,"position").toLowerCase()=="fixed"));
},_22=this,_23=function(el,x,y){
if(el.tagName=="BODY"||el.tagName=="HTML"){
_22.get(el.ownerDocument).scrollBy(x,y);
}else{
x&&(el.scrollLeft+=x);
y&&(el.scrollTop+=y);
}
};
if(_21(_17)){
return;
}
while(el){
if(el==_18){
el=_1f;
}
var _24=_5.position(el),_25=_21(el),rtl=_6.getComputedStyle(el).direction.toLowerCase()=="rtl";
if(el==_1f){
_24.w=_1d;
_24.h=_1e;
if(_1f==_19&&(_1a||_2("trident"))&&rtl){
_24.x+=_1f.offsetWidth-_24.w;
}
if(_24.x<0||!_1a||_1a>=9||_2("trident")){
_24.x=0;
}
if(_24.y<0||!_1a||_1a>=9||_2("trident")){
_24.y=0;
}
}else{
var pb=_5.getPadBorderExtents(el);
_24.w-=pb.w;
_24.h-=pb.h;
_24.x+=pb.l;
_24.y+=pb.t;
var _26=el.clientWidth,_27=_24.w-_26;
if(_26>0&&_27>0){
if(rtl&&_2("rtl-adjust-position-for-verticalScrollBar")){
_24.x+=_27;
}
_24.w=_26;
}
_26=el.clientHeight;
_27=_24.h-_26;
if(_26>0&&_27>0){
_24.h=_26;
}
}
if(_25){
if(_24.y<0){
_24.h+=_24.y;
_24.y=0;
}
if(_24.x<0){
_24.w+=_24.x;
_24.x=0;
}
if(_24.y+_24.h>_1e){
_24.h=_1e-_24.y;
}
if(_24.x+_24.w>_1d){
_24.w=_1d-_24.x;
}
}
var l=_20.x-_24.x,t=_20.y-_24.y,r=l+_20.w-_24.w,bot=t+_20.h-_24.h;
var s,old;
if(r*l>0&&(!!el.scrollLeft||el==_1f||el.scrollWidth>el.offsetHeight)){
s=Math[l<0?"max":"min"](l,r);
if(rtl&&((_1a==8&&!_1c)||_1a>=9||_2("trident"))){
s=-s;
}
old=el.scrollLeft;
_23(el,s,0);
s=el.scrollLeft-old;
_20.x-=s;
}
if(bot*t>0&&(!!el.scrollTop||el==_1f||el.scrollHeight>el.offsetHeight)){
s=Math.ceil(Math[t<0?"max":"min"](t,bot));
old=el.scrollTop;
_23(el,0,s);
s=el.scrollTop-old;
_20.y-=s;
}
el=(el!=_1f)&&!_25&&el.parentNode;
}
}
catch(error){
console.error("scrollIntoView: "+error);
_17.scrollIntoView(false);
}
}};
_2("extend-dojo")&&_1.setObject("dojo.window",_13);
return _13;
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["dijit"]=true;

;define("dijit/Viewport",["dojo/Evented","dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(_1,on,_2,_3,_4){
var _5=new _1();
var _6;
_2(function(){
var _7=_4.getBox();
_5._rlh=on(window,"resize",function(){
var _8=_4.getBox();
if(_7.h==_8.h&&_7.w==_8.w){
return;
}
_7=_8;
_5.emit("resize");
});
if(_3("ie")==8){
var _9=screen.deviceXDPI;
setInterval(function(){
if(screen.deviceXDPI!=_9){
_9=screen.deviceXDPI;
_5.emit("resize");
}
},500);
}
if(_3("ios")){
on(document,"focusin",function(_a){
_6=_a.target;
});
on(document,"focusout",function(_b){
_6=null;
});
}
});
_5.getEffectiveBox=function(_c){
var _d=_4.getBox(_c);
var _e=_6&&_6.tagName&&_6.tagName.toLowerCase();
if(_3("ios")&&_6&&!_6.readOnly&&(_e=="textarea"||(_e=="input"&&/^(color|email|number|password|search|tel|text|url)$/.test(_6.type)))){
_d.h*=(orientation==0||orientation==180?0.66:0.4);
var _f=_6.getBoundingClientRect();
_d.h=Math.max(_d.h,_f.top+_f.height);
}
return _d;
};
return _5;
});


;define("dijit/main",["dojo/_base/kernel"],function(_1){
return _1.dijit;
});


;define("dijit/place",["dojo/_base/array","dojo/dom-geometry","dojo/dom-style","dojo/_base/kernel","dojo/_base/window","./Viewport","./main"],function(_1,_2,_3,_4,_5,_6,_7){
function _8(_9,_a,_b,_c){
var _d=_6.getEffectiveBox(_9.ownerDocument);
if(!_9.parentNode||String(_9.parentNode.tagName).toLowerCase()!="body"){
_5.body(_9.ownerDocument).appendChild(_9);
}
var _e=null;
_1.some(_a,function(_f){
var _10=_f.corner;
var pos=_f.pos;
var _11=0;
var _12={w:{"L":_d.l+_d.w-pos.x,"R":pos.x-_d.l,"M":_d.w}[_10.charAt(1)],h:{"T":_d.t+_d.h-pos.y,"B":pos.y-_d.t,"M":_d.h}[_10.charAt(0)]};
var s=_9.style;
s.left=s.right="auto";
if(_b){
var res=_b(_9,_f.aroundCorner,_10,_12,_c);
_11=typeof res=="undefined"?0:res;
}
var _13=_9.style;
var _14=_13.display;
var _15=_13.visibility;
if(_13.display=="none"){
_13.visibility="hidden";
_13.display="";
}
var bb=_2.position(_9);
_13.display=_14;
_13.visibility=_15;
var _16={"L":pos.x,"R":pos.x-bb.w,"M":Math.max(_d.l,Math.min(_d.l+_d.w,pos.x+(bb.w>>1))-bb.w)}[_10.charAt(1)],_17={"T":pos.y,"B":pos.y-bb.h,"M":Math.max(_d.t,Math.min(_d.t+_d.h,pos.y+(bb.h>>1))-bb.h)}[_10.charAt(0)],_18=Math.max(_d.l,_16),_19=Math.max(_d.t,_17),_1a=Math.min(_d.l+_d.w,_16+bb.w),_1b=Math.min(_d.t+_d.h,_17+bb.h),_1c=_1a-_18,_1d=_1b-_19;
_11+=(bb.w-_1c)+(bb.h-_1d);
var _1e=false;
var _1f=document.querySelectorAll("[widgetid]");
var _20=_1f.length;
for(i=0;i<_20;i++){
if(_1f[i].getAttribute("widgetid").indexOf("com_ibm_social_ee_widget")>-1){
_1e=true;
break;
}
}
if(_1e&&(_18-_11>=0)){
_18-=_11;
}
if(_e==null||_11<_e.overflow){
_e={corner:_10,aroundCorner:_f.aroundCorner,x:_18,y:_19,w:_1c,h:_1d,overflow:_11,spaceAvailable:_12};
}
return !_11;
});
if(_e.overflow&&_b){
_b(_9,_e.aroundCorner,_e.corner,_e.spaceAvailable,_c);
}
var top=_e.y,_21=_e.x,_22=_5.body(_9.ownerDocument);
if(/relative|absolute/.test(_3.get(_22,"position"))){
top-=_3.get(_22,"marginTop");
_21-=_3.get(_22,"marginLeft");
}
var s=_9.style;
s.top=top+"px";
s.left=_21+"px";
s.right="auto";
return _e;
};
var _23={"TL":"BR","TR":"BL","BL":"TR","BR":"TL"};
var _24={at:function(_25,pos,_26,_27,_28){
var _29=_1.map(_26,function(_2a){
var c={corner:_2a,aroundCorner:_23[_2a],pos:{x:pos.x,y:pos.y}};
if(_27){
c.pos.x+=_2a.charAt(1)=="L"?_27.x:-_27.x;
c.pos.y+=_2a.charAt(0)=="T"?_27.y:-_27.y;
}
return c;
});
return _8(_25,_29,_28);
},around:function(_2b,_2c,_2d,_2e,_2f){
var _30;
if(typeof _2c=="string"||"offsetWidth" in _2c||"ownerSVGElement" in _2c){
_30=_2.position(_2c,true);
if(/^(above|below)/.test(_2d[0])){
var _31=_2.getBorderExtents(_2c),_32=_2c.firstChild?_2.getBorderExtents(_2c.firstChild):{t:0,l:0,b:0,r:0},_33=_2.getBorderExtents(_2b),_34=_2b.firstChild?_2.getBorderExtents(_2b.firstChild):{t:0,l:0,b:0,r:0};
_30.y+=Math.min(_31.t+_32.t,_33.t+_34.t);
_30.h-=Math.min(_31.t+_32.t,_33.t+_34.t)+Math.min(_31.b+_32.b,_33.b+_34.b);
}
}else{
_30=_2c;
}
if(_2c.parentNode){
var _35=_3.getComputedStyle(_2c).position=="absolute";
var _36=_2c.parentNode;
while(_36&&_36.nodeType==1&&_36.nodeName!="BODY"){
var _37=_2.position(_36,true),pcs=_3.getComputedStyle(_36);
if(/relative|absolute/.test(pcs.position)){
_35=false;
}
if(!_35&&/hidden|auto|scroll/.test(pcs.overflow)){
var _38=Math.min(_30.y+_30.h,_37.y+_37.h);
var _39=Math.min(_30.x+_30.w,_37.x+_37.w);
_30.x=Math.max(_30.x,_37.x);
_30.y=Math.max(_30.y,_37.y);
_30.h=_38-_30.y;
_30.w=_39-_30.x;
}
if(pcs.position=="absolute"){
_35=true;
}
_36=_36.parentNode;
}
}
var x=_30.x,y=_30.y,_3a="w" in _30?_30.w:(_30.w=_30.width),_3b="h" in _30?_30.h:(_4.deprecated("place.around: dijit/place.__Rectangle: { x:"+x+", y:"+y+", height:"+_30.height+", width:"+_3a+" } has been deprecated.  Please use { x:"+x+", y:"+y+", h:"+_30.height+", w:"+_3a+" }","","2.0"),_30.h=_30.height);
var _3c=[];
function _3d(_3e,_3f){
_3c.push({aroundCorner:_3e,corner:_3f,pos:{x:{"L":x,"R":x+_3a,"M":x+(_3a>>1)}[_3e.charAt(1)],y:{"T":y,"B":y+_3b,"M":y+(_3b>>1)}[_3e.charAt(0)]}});
};
_1.forEach(_2d,function(pos){
var ltr=_2e;
switch(pos){
case "above-centered":
_3d("TM","BM");
break;
case "below-centered":
_3d("BM","TM");
break;
case "after-centered":
ltr=!ltr;
case "before-centered":
_3d(ltr?"ML":"MR",ltr?"MR":"ML");
break;
case "after":
ltr=!ltr;
case "before":
_3d(ltr?"TL":"TR",ltr?"TR":"TL");
_3d(ltr?"BL":"BR",ltr?"BR":"BL");
break;
case "below-alt":
ltr=!ltr;
case "below":
_3d(ltr?"BL":"BR",ltr?"TL":"TR");
_3d(ltr?"BR":"BL",ltr?"TR":"TL");
break;
case "above-alt":
ltr=!ltr;
case "above":
_3d(ltr?"TL":"TR",ltr?"BL":"BR");
_3d(ltr?"TR":"TL",ltr?"BR":"BL");
break;
default:
_3d(pos.aroundCorner,pos.corner);
}
});
var _40=_8(_2b,_3c,_2f,{w:_3a,h:_3b});
_40.aroundNodePos=_30;
return _40;
}};
return _7.place=_24;
});


;define("dijit/BackgroundIframe",["require","./main","dojo/_base/config","dojo/dom-construct","dojo/dom-style","dojo/_base/lang","dojo/on","dojo/sniff"],function(_1,_2,_3,_4,_5,_6,on,_7){
_7.add("config-bgIframe",(_7("ie")&&!/IEMobile\/10\.0/.test(navigator.userAgent))||(_7("trident")&&/Windows NT 6.[01]/.test(navigator.userAgent)));
var _8=new function(){
var _9=[];
this.pop=function(){
var _a;
if(_9.length){
_a=_9.pop();
_a.style.display="";
}else{
if(_7("ie")<9){
var _b=_3["dojoBlankHtmlUrl"]||_1.toUrl("dojo/resources/blank.html")||"javascript:\"\"";
var _c="<iframe src='"+_b+"' role='presentation'"+" style='position: absolute; left: 0px; top: 0px;"+"z-index: -1; filter:Alpha(Opacity=\"0\");'>";
_a=document.createElement(_c);
}else{
_a=_4.create("iframe");
_a.src="javascript:\"\"";
_a.className="dijitBackgroundIframe";
_a.setAttribute("role","presentation");
_5.set(_a,"opacity",0.1);
}
_a.tabIndex=-1;
}
return _a;
};
this.push=function(_d){
_d.style.display="none";
_9.push(_d);
};
}();
_2.BackgroundIframe=function(_e){
if(!_e.id){
throw new Error("no id");
}
if(_7("config-bgIframe")){
var _f=(this.iframe=_8.pop());
_e.appendChild(_f);
if(_7("ie")<7||_7("quirks")){
this.resize(_e);
this._conn=on(_e,"resize",_6.hitch(this,"resize",_e));
}else{
_5.set(_f,{width:"100%",height:"100%"});
}
}
};
_6.extend(_2.BackgroundIframe,{resize:function(_10){
if(this.iframe){
_5.set(this.iframe,{width:_10.offsetWidth+"px",height:_10.offsetHeight+"px"});
}
},destroy:function(){
if(this._conn){
this._conn.remove();
this._conn=null;
}
if(this.iframe){
if(this.iframe.parentNode){
this.iframe.parentNode.removeChild(this.iframe);
}
_8.push(this.iframe);
delete this.iframe;
}
}});
return _2.BackgroundIframe;
});


;define("dijit/popup",["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/keys","dojo/_base/lang","dojo/on","./place","./BackgroundIframe","./Viewport","./main"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,on,_c,_d,_e,_f){
function _10(){
if(this._popupWrapper){
_6.destroy(this._popupWrapper);
delete this._popupWrapper;
}
};
var _11=_3(null,{_stack:[],_beginZIndex:1000,_idGen:1,_repositionAll:function(){
if(this._firstAroundNode){
var _12=this._firstAroundPosition,_13=_7.position(this._firstAroundNode,true),dx=_13.x-_12.x,dy=_13.y-_12.y;
if(dx||dy){
this._firstAroundPosition=_13;
for(var i=0;i<this._stack.length;i++){
var _14=this._stack[i].wrapper.style;
_14.top=(parseFloat(_14.top)+dy)+"px";
if(_14.right=="auto"){
_14.left=(parseFloat(_14.left)+dx)+"px";
}else{
_14.right=(parseFloat(_14.right)-dx)+"px";
}
}
}
this._aroundMoveListener=setTimeout(_b.hitch(this,"_repositionAll"),dx||dy?10:50);
}
},_createWrapper:function(_15){
var _16=_15._popupWrapper,_17=_15.domNode;
if(!_16){
_16=_6.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":_15["aria-label"]||_15.label||_15.name||_15.id},_15.ownerDocumentBody);
_16.appendChild(_17);
var s=_17.style;
s.display="";
s.visibility="";
s.position="";
s.top="0px";
_15._popupWrapper=_16;
_2.after(_15,"destroy",_10,true);
if("ontouchend" in document){
on(_16,"touchend",function(evt){
if(!/^(input|button|textarea)$/i.test(evt.target.tagName)){
evt.preventDefault();
}
});
}
}
return _16;
},moveOffScreen:function(_18){
var _19=this._createWrapper(_18);
var ltr=_7.isBodyLtr(_18.ownerDocument),_1a={visibility:"hidden",top:"-9999px",display:""};
_1a[ltr?"left":"right"]="-9999px";
_1a[ltr?"right":"left"]="auto";
_8.set(_19,_1a);
return _19;
},hide:function(_1b){
var _1c=this._createWrapper(_1b);
_8.set(_1c,{display:"none",height:"auto",overflow:"visible",border:""});
var _1d=_1b.domNode;
if("_originalStyle" in _1d){
_1d.style.cssText=_1d._originalStyle;
}
},getTopPopup:function(){
var _1e=this._stack;
for(var pi=_1e.length-1;pi>0&&_1e[pi].parent===_1e[pi-1].widget;pi--){
}
return _1e[pi];
},open:function(_1f){
var _20=this._stack,_21=_1f.popup,_22=_21.domNode,_23=_1f.orient||["below","below-alt","above","above-alt"],ltr=_1f.parent?_1f.parent.isLeftToRight():_7.isBodyLtr(_21.ownerDocument),_24=_1f.around,id=(_1f.around&&_1f.around.id)?(_1f.around.id+"_dropdown"):("popup_"+this._idGen++);
while(_20.length&&(!_1f.parent||!_4.isDescendant(_1f.parent.domNode,_20[_20.length-1].widget.domNode))){
this.close(_20[_20.length-1].widget);
}
var _25=this.moveOffScreen(_21);
if(_21.startup&&!_21._started){
_21.startup();
}
var _26,_27=_7.position(_22);
if("maxHeight" in _1f&&_1f.maxHeight!=-1){
_26=_1f.maxHeight||Infinity;
}else{
var _28=_e.getEffectiveBox(this.ownerDocument),_29=_24?_7.position(_24,false):{y:_1f.y-(_1f.padding||0),h:(_1f.padding||0)*2};
_26=Math.floor(Math.max(_29.y,_28.h-(_29.y+_29.h)));
}
if(_27.h>_26){
var cs=_8.getComputedStyle(_22),_2a=cs.borderLeftWidth+" "+cs.borderLeftStyle+" "+cs.borderLeftColor;
_8.set(_25,{overflowY:"scroll",height:_26+"px",border:_2a});
_22._originalStyle=_22.style.cssText;
_22.style.border="none";
}
_5.set(_25,{id:id,style:{zIndex:this._beginZIndex+_20.length},"class":"dijitPopup "+(_21.baseClass||_21["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:_1f.parent?_1f.parent.id:""});
if(_20.length==0&&_24){
this._firstAroundNode=_24;
this._firstAroundPosition=_7.position(_24,true);
this._aroundMoveListener=setTimeout(_b.hitch(this,"_repositionAll"),50);
}
if(_9("config-bgIframe")&&!_21.bgIframe){
_21.bgIframe=new _d(_25);
}
var _2b=_21.orient?_b.hitch(_21,"orient"):null,_2c=_24?_c.around(_25,_24,_23,ltr,_2b):_c.at(_25,_1f,_23=="R"?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],_1f.padding,_2b);
_25.style.visibility="visible";
_22.style.visibility="visible";
var _2d=[];
_2d.push(on(_25,"keydown",_b.hitch(this,function(evt){
if(evt.keyCode==_a.ESCAPE&&_1f.onCancel){
evt.stopPropagation();
evt.preventDefault();
_1f.onCancel();
}else{
if(evt.keyCode==_a.TAB){
evt.stopPropagation();
evt.preventDefault();
var _2e=this.getTopPopup();
if(_2e&&_2e.onCancel){
_2e.onCancel();
}
}
}
})));
if(_21.onCancel&&_1f.onCancel){
_2d.push(_21.on("cancel",_1f.onCancel));
}
_2d.push(_21.on(_21.onExecute?"execute":"change",_b.hitch(this,function(){
var _2f=this.getTopPopup();
if(_2f&&_2f.onExecute){
_2f.onExecute();
}
})));
_20.push({widget:_21,wrapper:_25,parent:_1f.parent,onExecute:_1f.onExecute,onCancel:_1f.onCancel,onClose:_1f.onClose,handlers:_2d});
if(_21.onOpen){
_21.onOpen(_2c);
}
return _2c;
},close:function(_30){
var _31=this._stack;
while((_30&&_1.some(_31,function(_32){
return _32.widget==_30;
}))||(!_30&&_31.length)){
var top=_31.pop(),_33=top.widget,_34=top.onClose;
if(_33.bgIframe){
if(typeof _33.bgIframe.parentNode!="undefined"){
_33.bgIframe.destroy();
}
delete _33.bgIframe;
}
if(_33.onClose){
_33.onClose();
}
var h;
while(h=top.handlers.pop()){
h.remove();
}
if(_33&&_33.domNode){
this.hide(_33);
}
if(_34){
_34();
}
}
if(_31.length==0&&this._aroundMoveListener){
clearTimeout(this._aroundMoveListener);
this._firstAroundNode=this._firstAroundPosition=this._aroundMoveListener=null;
}
}});
return (_f.popup=new _11());
});


;define("dijit/_base/popup",["dojo/dom-class","dojo/_base/window","../popup","../BackgroundIframe"],function(_1,_2,_3){
var _4=_3._createWrapper;
_3._createWrapper=function(_5){
if(!_5.declaredClass){
_5={_popupWrapper:(_5.parentNode&&_1.contains(_5.parentNode,"dijitPopup"))?_5.parentNode:null,domNode:_5,destroy:function(){
},declaredClass:"dijit._base.popup.wrapper",ownerDocument:_5.ownerDocument,ownerDocumentBody:_2.body(_5.ownerDocument)};
}
return _4.call(this,_5);
};
var _6=_3.open;
_3.open=function(_7){
if(_7.orient&&typeof _7.orient!="string"&&!("length" in _7.orient)){
var _8=[];
for(var _9 in _7.orient){
_8.push({aroundCorner:_9,corner:_7.orient[_9]});
}
_7.orient=_8;
}
return _6.call(this,_7);
};
return _3;
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.oneui"]=true;

;if(!dojo._hasResource["com.ibm.oneui.util.openAround"]){
dojo._hasResource["com.ibm.oneui.util.openAround"]=true;
dojo.provide("com.ibm.oneui.util.openAround");


com.ibm.oneui.util.openAround=function(_1,_2,_3,_4,_5){
var _6=dijit.byId(_1);
if(_4){
dojo.stopEvent(_4);
}
if(_6&&_6.preventReopen){
_6.preventReopen=_6.wasShowing=false;
return;
}
if(_4&&!_2){
_2=_4.target;
}
function _7(){
try{
dijit.focus(_2);
}
catch(e){
}
dijit.popup.close(_6);
};
if(_5&&_5.x&&_5.y){
dijit.popup.open({popup:_6,x:_5.x,y:_5.y,orient:(_3?_3.orient:null)||(dojo._isBodyLtr()?{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"}:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"}),onExecute:_7,onCancel:_7});
}else{
dijit.popup.open({popup:_6,around:_2,orient:(_3?_3.orient:null)||(dojo._isBodyLtr()?{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"}:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"}),onExecute:_7,onCancel:_7});
}
if(!(_3&&_3.noFocus)){
_6.focus();
}
if(!_6._blurCloseHandler){
_6._blurCloseHandler=_6.connect(_6,"_onBlur",function(){
_6.wasShowing=_6.isShowingNow;
setTimeout(function(){
_6.wasShowing=false;
},1);
dijit.popup.close(_6);
});
}
};
}


;if(!dojo._hasResource["com.ibm.oneui.util.proxy"]){
dojo._hasResource["com.ibm.oneui.util.proxy"]=true;
(function(){
dojo.provide("com.ibm.oneui.util.proxy");
var _1=com.ibm.oneui.util;
var _2=function(_3){
return _3=="https"?443:80;
};
var _4=dojo.config.proxy;
var _5=window.location;
var _6=_5.hostname||"localhost";
var _7=(_5.protocol||"http").replace(":","");
var _8=_5.port||_2(_7);
_1.proxy=function(_9,_a){
var _b=_a||_4;
if(!_b){
return _9;
}
var _c=new dojo._Url(_9);
var _d=_c.host;
if(_d){
var _e=_c.scheme||_7;
var _f=_c.port||_2(_e);
if(_e!=_7||_f!=_8||_d!=_6){
return _b+"/"+_e+"/"+encodeURIComponent(_d+":"+_f)+(_c.path||"")+(_c.query?("?"+_c.query):"");
}
}
return _9;
};
})();
}


;define("dijit/registry",["dojo/_base/array","dojo/_base/window","./main"],function(_1,_2,_3){
var _4={},_5={};
var _6={length:0,add:function(_7){
if(_5[_7.id]){
throw new Error("Tried to register widget with id=="+_7.id+" but that id is already registered");
}
_5[_7.id]=_7;
this.length++;
},remove:function(id){
if(_5[id]){
delete _5[id];
this.length--;
}
},byId:function(id){
return typeof id=="string"?_5[id]:id;
},byNode:function(_8){
return _5[_8.getAttribute("widgetId")];
},toArray:function(){
var ar=[];
for(var id in _5){
ar.push(_5[id]);
}
return ar;
},getUniqueId:function(_9){
var id;
do{
id=_9+"_"+(_9 in _4?++_4[_9]:_4[_9]=0);
}while(_5[id]);
return _3._scopeName=="dijit"?id:_3._scopeName+"_"+id;
},findWidgets:function(_a,_b){
var _c=[];
function _d(_e){
for(var _f=_e.firstChild;_f;_f=_f.nextSibling){
if(_f.nodeType==1){
var _10=_f.getAttribute("widgetId");
if(_10){
var _11=_5[_10];
if(_11){
_c.push(_11);
}
}else{
if(_f!==_b){
_d(_f);
}
}
}
}
};
_d(_a);
return _c;
},_destroyAll:function(){
_3._curFocus=null;
_3._prevFocus=null;
_3._activeStack=[];
_1.forEach(_6.findWidgets(_2.body()),function(_12){
if(!_12._destroyed){
if(_12.destroyRecursive){
_12.destroyRecursive();
}else{
if(_12.destroy){
_12.destroy();
}
}
}
});
},getEnclosingWidget:function(_13){
while(_13){
var id=_13.nodeType==1&&_13.getAttribute("widgetId");
if(id){
return _5[id];
}
_13=_13.parentNode;
}
return null;
},_hash:_5};
_3.registry=_6;
return _6;
});


;define("dojo/Stateful",["./_base/declare","./_base/lang","./_base/array","./when"],function(_1,_2,_3,_4){
return _1("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(_5){
var _6=this._attrPairNames;
if(_6[_5]){
return _6[_5];
}
return (_6[_5]={s:"_"+_5+"Setter",g:"_"+_5+"Getter"});
},postscript:function(_7){
if(_7){
this.set(_7);
}
},_get:function(_8,_9){
return typeof this[_9.g]==="function"?this[_9.g]():this[_8];
},get:function(_a){
return this._get(_a,this._getAttrNames(_a));
},set:function(_b,_c){
if(typeof _b==="object"){
for(var x in _b){
if(_b.hasOwnProperty(x)&&x!="_watchCallbacks"){
this.set(x,_b[x]);
}
}
return this;
}
var _d=this._getAttrNames(_b),_e=this._get(_b,_d),_f=this[_d.s],_10;
if(typeof _f==="function"){
_10=_f.apply(this,Array.prototype.slice.call(arguments,1));
}else{
this[_b]=_c;
}
if(this._watchCallbacks){
var _11=this;
_4(_10,function(){
_11._watchCallbacks(_b,_e,_c);
});
}
return this;
},_changeAttrValue:function(_12,_13){
var _14=this.get(_12);
this[_12]=_13;
if(this._watchCallbacks){
this._watchCallbacks(_12,_14,_13);
}
return this;
},watch:function(_15,_16){
var _17=this._watchCallbacks;
if(!_17){
var _18=this;
_17=this._watchCallbacks=function(_19,_1a,_1b,_1c){
var _1d=function(_1e){
if(_1e){
_1e=_1e.slice();
for(var i=0,l=_1e.length;i<l;i++){
_1e[i].call(_18,_19,_1a,_1b);
}
}
};
_1d(_17["_"+_19]);
if(!_1c){
_1d(_17["*"]);
}
};
}
if(!_16&&typeof _15==="function"){
_16=_15;
_15="*";
}else{
_15="_"+_15;
}
var _1f=_17[_15];
if(typeof _1f!=="object"){
_1f=_17[_15]=[];
}
_1f.push(_16);
var _20={};
_20.unwatch=_20.remove=function(){
var _21=_3.indexOf(_1f,_16);
if(_21>-1){
_1f.splice(_21,1);
}
};
return _20;
}});
});


;define("dijit/Destroyable",["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(_1,_2,_3){
return _3("dijit.Destroyable",null,{destroy:function(_4){
this._destroyed=true;
},own:function(){
var _5=["destroyRecursive","destroy","remove"];
_1.forEach(arguments,function(_6){
var _7;
var _8=_2.before(this,"destroy",function(_9){
_6[_7](_9);
});
var _a=[];
function _b(){
_8.remove();
_1.forEach(_a,function(_c){
_c.remove();
});
};
if(_6.then){
_7="cancel";
_6.then(_b,_b);
}else{
_1.forEach(_5,function(_d){
if(typeof _6[_d]==="function"){
if(!_7){
_7=_d;
}
_a.push(_2.after(_6,_d,_b,true));
}
});
}
},this);
return arguments;
}});
});


;define("dijit/_BidiMixin",[],function(){
var _1={LRM:"\u200e",LRE:"\u202a",PDF:"\u202c",RLM:"\u200f",RLE:"\u202b"};
return {textDir:"",getTextDir:function(_2){
return this.textDir=="auto"?this._checkContextual(_2):this.textDir;
},_checkContextual:function(_3){
var _4=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(_3);
return _4?(_4[0]<="z"?"ltr":"rtl"):this.dir?this.dir:this.isLeftToRight()?"ltr":"rtl";
},applyTextDir:function(_5,_6){
if(this.textDir){
var _7=this.textDir;
if(_7=="auto"){
if(typeof _6==="undefined"){
var _8=_5.tagName.toLowerCase();
_6=(_8=="input"||_8=="textarea")?_5.value:_5.innerText||_5.textContent||"";
}
_7=this._checkContextual(_6);
}
if(_5.dir!=_7){
_5.dir=_7;
}
}
},enforceTextDirWithUcc:function(_9,_a){
if(this.textDir){
if(_9){
_9.originalText=_a;
}
var _b=this.textDir=="auto"?this._checkContextual(_a):this.textDir;
return (_b=="ltr"?_1.LRE:_1.RLE)+_a+_1.PDF;
}
return _a;
},restoreOriginalText:function(_c){
if(_c.originalText){
_c.text=_c.originalText;
delete _c.originalText;
}
return _c;
},_setTextDirAttr:function(_d){
if(!this._created||this.textDir!=_d){
this._set("textDir",_d);
var _e=null;
if(this.displayNode){
_e=this.displayNode;
this.displayNode.align=this.dir=="rtl"?"right":"left";
}else{
_e=this.textDirNode||this.focusNode||this.textbox;
}
if(_e){
this.applyTextDir(_e);
}
}
}};
});


;define("dijit/_base/manager",["dojo/_base/array","dojo/_base/config","dojo/_base/lang","../registry","../main"],function(_1,_2,_3,_4,_5){
var _6={};
_1.forEach(["byId","getUniqueId","findWidgets","_destroyAll","byNode","getEnclosingWidget"],function(_7){
_6[_7]=_4[_7];
});
_3.mixin(_6,{defaultDuration:_2["defaultDuration"]||200});
_3.mixin(_5,_6);
return _5;
});


;define("dijit/_WidgetBase",["require","dojo/_base/array","dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/ready","dojo/Stateful","dojo/topic","dojo/_base/window","./Destroyable","dojo/has!dojo-bidi?./_BidiMixin","./registry","./_base/manager"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,on,_10,_11,_12,win,_13,_14,_15){
_d.add("dijit-legacy-requires",!_e.isAsync);
_d.add("dojo-bidi",false);
var _16={};
function _17(obj){
var ret={};
for(var _18 in obj){
ret[_18.toLowerCase()]=true;
}
return ret;
};
function _19(_1a){
return function(val){
_8[val?"set":"remove"](this.domNode,_1a,val);
this._set(_1a,val);
};
};
function _1b(a,b){
return a===b||(a!==a&&b!==b);
};
var _1c=_6("dijit._WidgetBase",[_11,_13],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:_19("lang"),dir:"",_setDirAttr:_19("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(val){
this._set("ownerDocument",val);
},attributeMap:{},_blankGif:_4.blankGif||_1.toUrl("dojo/resources/blank.gif?etag=Z6uJWS0"),_introspect:function(){
var _1d=this.constructor;
if(!_1d._setterAttrs){
var _1e=_1d.prototype,_1f=_1d._setterAttrs=[],_20=(_1d._onMap={});
for(var _21 in _1e.attributeMap){
_1f.push(_21);
}
for(_21 in _1e){
if(/^on/.test(_21)){
_20[_21.substring(2).toLowerCase()]=_21;
}
if(/^_set[A-Z](.*)Attr$/.test(_21)){
_21=_21.charAt(4).toLowerCase()+_21.substr(5,_21.length-9);
if(!_1e.attributeMap||!(_21 in _1e.attributeMap)){
_1f.push(_21);
}
}
}
}
},postscript:function(_22,_23){
this.create(_22,_23);
},create:function(_24,_25){
this._introspect();
this.srcNodeRef=_7.byId(_25);
this._connects=[];
this._supportingWidgets=[];
if(this.srcNodeRef&&(typeof this.srcNodeRef.id=="string")){
this.id=this.srcNodeRef.id;
}
if(_24){
this.params=_24;
_f.mixin(this,_24);
}
this.postMixInProperties();
if(!this.id){
this.id=_15.getUniqueId(this.declaredClass.replace(/\./g,"_"));
if(this.params){
delete this.params.id;
}
}
this.ownerDocument=this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);
this.ownerDocumentBody=win.body(this.ownerDocument);
_15.add(this);
this.buildRendering();
var _26;
if(this.domNode){
this._applyAttributes();
var _27=this.srcNodeRef;
if(_27&&_27.parentNode&&this.domNode!==_27){
_27.parentNode.replaceChild(this.domNode,_27);
_26=true;
}
this.domNode.setAttribute("widgetId",this.id);
}
this.postCreate();
if(_26){
delete this.srcNodeRef;
}
this._created=true;
},_applyAttributes:function(){
var _28={};
for(var key in this.params||{}){
_28[key]=this._get(key);
}
_2.forEach(this.constructor._setterAttrs,function(key){
if(!(key in _28)){
var val=this._get(key);
if(val){
this.set(key,val);
}
}
},this);
for(key in _28){
this.set(key,_28[key]);
}
},postMixInProperties:function(){
},buildRendering:function(){
if(!this.domNode){
this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div");
}
if(this.baseClass){
var _29=this.baseClass.split(" ");
if(!this.isLeftToRight()){
_29=_29.concat(_2.map(_29,function(_2a){
return _2a+"Rtl";
}));
}
_9.add(this.domNode,_29);
}
},postCreate:function(){
},startup:function(){
if(this._started){
return;
}
this._started=true;
_2.forEach(this.getChildren(),function(obj){
if(!obj._started&&!obj._destroyed&&_f.isFunction(obj.startup)){
obj.startup();
obj._started=true;
}
});
},destroyRecursive:function(_2b){
this._beingDestroyed=true;
this.destroyDescendants(_2b);
this.destroy(_2b);
},destroy:function(_2c){
this._beingDestroyed=true;
this.uninitialize();
function _2d(w){
if(w.destroyRecursive){
w.destroyRecursive(_2c);
}else{
if(w.destroy){
w.destroy(_2c);
}
}
};
_2.forEach(this._connects,_f.hitch(this,"disconnect"));
_2.forEach(this._supportingWidgets,_2d);
if(this.domNode){
_2.forEach(_15.findWidgets(this.domNode,this.containerNode),_2d);
}
this.destroyRendering(_2c);
_15.remove(this.id);
this._destroyed=true;
},destroyRendering:function(_2e){
if(this.bgIframe){
this.bgIframe.destroy(_2e);
delete this.bgIframe;
}
if(this.domNode){
if(_2e){
_8.remove(this.domNode,"widgetId");
}else{
_a.destroy(this.domNode);
}
delete this.domNode;
}
if(this.srcNodeRef){
if(!_2e){
_a.destroy(this.srcNodeRef);
}
delete this.srcNodeRef;
}
},destroyDescendants:function(_2f){
_2.forEach(this.getChildren(),function(_30){
if(_30.destroyRecursive){
_30.destroyRecursive(_2f);
}
});
},uninitialize:function(){
return false;
},_setStyleAttr:function(_31){
var _32=this.domNode;
if(_f.isObject(_31)){
_c.set(_32,_31);
}else{
if(_32.style.cssText){
_32.style.cssText+="; "+_31;
}else{
_32.style.cssText=_31;
}
}
this._set("style",_31);
},_attrToDom:function(_33,_34,_35){
_35=arguments.length>=3?_35:this.attributeMap[_33];
_2.forEach(_f.isArray(_35)?_35:[_35],function(_36){
var _37=this[_36.node||_36||"domNode"];
var _38=_36.type||"attribute";
switch(_38){
case "attribute":
if(_f.isFunction(_34)){
_34=_f.hitch(this,_34);
}
var _39=_36.attribute?_36.attribute:(/^on[A-Z][a-zA-Z]*$/.test(_33)?_33.toLowerCase():_33);
if(_37.tagName){
_8.set(_37,_39,_34);
}else{
_37.set(_39,_34);
}
break;
case "innerText":
_37.innerHTML="";
_37.appendChild(this.ownerDocument.createTextNode(_34));
break;
case "innerHTML":
_37.innerHTML=_34;
break;
case "class":
_9.replace(_37,_34,this[_33]);
break;
}
},this);
},get:function(_3a){
var _3b=this._getAttrNames(_3a);
return this[_3b.g]?this[_3b.g]():this._get(_3a);
},set:function(_3c,_3d){
if(typeof _3c==="object"){
for(var x in _3c){
this.set(x,_3c[x]);
}
return this;
}
var _3e=this._getAttrNames(_3c),_3f=this[_3e.s];
if(_f.isFunction(_3f)){
var _40=_3f.apply(this,Array.prototype.slice.call(arguments,1));
}else{
var _41=this.focusNode&&!_f.isFunction(this.focusNode)?"focusNode":"domNode",tag=this[_41]&&this[_41].tagName,_42=tag&&(_16[tag]||(_16[tag]=_17(this[_41]))),map=_3c in this.attributeMap?this.attributeMap[_3c]:_3e.s in this?this[_3e.s]:((_42&&_3e.l in _42&&typeof _3d!="function")||/^aria-|^data-|^role$/.test(_3c))?_41:null;
if(map!=null){
this._attrToDom(_3c,_3d,map);
}
this._set(_3c,_3d);
}
return _40||this;
},_attrPairNames:{},_getAttrNames:function(_43){
var apn=this._attrPairNames;
if(apn[_43]){
return apn[_43];
}
var uc=_43.replace(/^[a-z]|-[a-zA-Z]/g,function(c){
return c.charAt(c.length-1).toUpperCase();
});
return (apn[_43]={n:_43+"Node",s:"_set"+uc+"Attr",g:"_get"+uc+"Attr",l:uc.toLowerCase()});
},_set:function(_44,_45){
var _46=this[_44];
this[_44]=_45;
if(this._created&&!_1b(_46,_45)){
if(this._watchCallbacks){
this._watchCallbacks(_44,_46,_45);
}
this.emit("attrmodified-"+_44,{detail:{prevValue:_46,newValue:_45}});
}
},_get:function(_47){
return this[_47];
},emit:function(_48,_49,_4a){
_49=_49||{};
if(_49.bubbles===undefined){
_49.bubbles=true;
}
if(_49.cancelable===undefined){
_49.cancelable=true;
}
if(!_49.detail){
_49.detail={};
}
_49.detail.widget=this;
var ret,_4b=this["on"+_48];
if(_4b){
ret=_4b.apply(this,_4a?_4a:[_49]);
}
if(this._started&&!this._beingDestroyed){
on.emit(this.domNode,_48.toLowerCase(),_49);
}
return ret;
},on:function(_4c,_4d){
var _4e=this._onMap(_4c);
if(_4e){
return _3.after(this,_4e,_4d,true);
}
return this.own(on(this.domNode,_4c,_4d))[0];
},_onMap:function(_4f){
var _50=this.constructor,map=_50._onMap;
if(!map){
map=(_50._onMap={});
for(var _51 in _50.prototype){
if(/^on/.test(_51)){
map[_51.replace(/^on/,"").toLowerCase()]=_51;
}
}
}
return map[typeof _4f=="string"&&_4f.toLowerCase()];
},toString:function(){
return "[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]";
},getChildren:function(){
return this.containerNode?_15.findWidgets(this.containerNode):[];
},getParent:function(){
return _15.getEnclosingWidget(this.domNode.parentNode);
},connect:function(obj,_52,_53){
return this.own(_5.connect(obj,_52,this,_53))[0];
},disconnect:function(_54){
if(_54&&_54.remove){
_54.remove();
}else{
console.warn("_WidgetBase#disconnect was called with an invalid handle; no handles were disconnected");
}
},subscribe:function(t,_55){
return this.own(_12.subscribe(t,_f.hitch(this,_55)))[0];
},unsubscribe:function(_56){
_56.remove();
},isLeftToRight:function(){
return this.dir?(this.dir.toLowerCase()=="ltr"):_b.isBodyLtr(this.ownerDocument);
},isFocusable:function(){
return this.focus&&(_c.get(this.domNode,"display")!="none");
},placeAt:function(_57,_58){
var _59=!_57.tagName&&_15.byId(_57);
if(_59&&_59.addChild&&(!_58||typeof _58==="number")){
_59.addChild(this,_58);
}else{
var ref=_59&&("domNode" in _59)?(_59.containerNode&&!/after|before|replace/.test(_58||"")?_59.containerNode:_59.domNode):_7.byId(_57,this.ownerDocument);
_a.place(this.domNode,ref,_58);
if(!this._started&&(this.getParent()||{})._started){
this.startup();
}
}
return this;
},defer:function(fcn,_5a){
var _5b=setTimeout(_f.hitch(this,function(){
if(!_5b){
return;
}
_5b=null;
if(!this._destroyed){
_f.hitch(this,fcn)();
}
}),_5a||0);
return {remove:function(){
if(_5b){
clearTimeout(_5b);
_5b=null;
}
return null;
}};
}});
if(_d("dojo-bidi")){
_1c.extend(_14);
}
return _1c;
});


;define("dojo/touch",["./_base/kernel","./aspect","./dom","./dom-class","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9){
var _a=_6("ios")<5;
var _b=_6("pointer-events")||_6("MSPointer"),_c=(function(){
var _d={};
for(var _e in {down:1,move:1,up:1,cancel:1,over:1,out:1}){
_d[_e]=_6("MSPointer")?"MSPointer"+_e.charAt(0).toUpperCase()+_e.slice(1):"pointer"+_e;
}
return _d;
})();
var _f=_6("touch-events");
var _10,_11,_12=false,_13,_14,_15,_16,_17,_18;
var _19;
function _1a(_1b,_1c,_1d){
if(_b&&_1d){
return function(_1e,_1f){
return on(_1e,_1d,_1f);
};
}else{
if(_f){
return function(_20,_21){
var _22=on(_20,_1c,function(evt){
_21.call(this,evt);
_19=(new Date()).getTime();
}),_23=on(_20,_1b,function(evt){
if(!_19||(new Date()).getTime()>_19+1000){
_21.call(this,evt);
}
});
return {remove:function(){
_22.remove();
_23.remove();
}};
};
}else{
return function(_24,_25){
return on(_24,_1b,_25);
};
}
}
};
function _26(_27){
do{
if(_27.dojoClick!==undefined){
return _27;
}
}while(_27=_27.parentNode);
};
function _28(e,_29,_2a){
var _2b=_26(e.target);
_11=!e.target.disabled&&_2b&&_2b.dojoClick;
if(_11){
_12=(_11=="useTarget");
_13=(_12?_2b:e.target);
if(_12){
e.preventDefault();
}
_14=e.changedTouches?e.changedTouches[0].pageX-_9.global.pageXOffset:e.clientX;
_15=e.changedTouches?e.changedTouches[0].pageY-_9.global.pageYOffset:e.clientY;
_16=(typeof _11=="object"?_11.x:(typeof _11=="number"?_11:0))||4;
_17=(typeof _11=="object"?_11.y:(typeof _11=="number"?_11:0))||4;
if(!_10){
_10=true;
function _2c(e){
if(_12){
_11=_3.isDescendant(_9.doc.elementFromPoint((e.changedTouches?e.changedTouches[0].pageX-_9.global.pageXOffset:e.clientX),(e.changedTouches?e.changedTouches[0].pageY-_9.global.pageYOffset:e.clientY)),_13);
}else{
_11=_11&&(e.changedTouches?e.changedTouches[0].target:e.target)==_13&&Math.abs((e.changedTouches?e.changedTouches[0].pageX-_9.global.pageXOffset:e.clientX)-_14)<=_16&&Math.abs((e.changedTouches?e.changedTouches[0].pageY-_9.global.pageYOffset:e.clientY)-_15)<=_17;
}
};
_9.doc.addEventListener(_29,function(e){
_2c(e);
if(_12){
e.preventDefault();
}
},true);
_9.doc.addEventListener(_2a,function(e){
_2c(e);
if(_11){
_18=(new Date()).getTime();
var _2d=(_12?_13:e.target);
if(_2d.tagName==="LABEL"){
_2d=_3.byId(_2d.getAttribute("for"))||_2d;
}
var src=(e.changedTouches)?e.changedTouches[0]:e;
var _2e=document.createEvent("MouseEvents");
_2e._dojo_click=true;
_2e.initMouseEvent("click",true,true,e.view,e.detail,src.screenX,src.screenY,src.clientX,src.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);
setTimeout(function(){
on.emit(_2d,"click",_2e);
_18=(new Date()).getTime();
},0);
}
},true);
function _2f(_30){
_9.doc.addEventListener(_30,function(e){
if(!e._dojo_click&&(new Date()).getTime()<=_18+1000&&!(e.target.tagName=="INPUT"&&_4.contains(e.target,"dijitOffScreen"))){
e.stopPropagation();
e.stopImmediatePropagation&&e.stopImmediatePropagation();
if(_30=="click"&&(e.target.tagName!="INPUT"||e.target.type=="radio"||e.target.type=="checkbox")&&e.target.tagName!="TEXTAREA"&&e.target.tagName!="AUDIO"&&e.target.tagName!="VIDEO"){
e.preventDefault();
}
}
},true);
};
_2f("click");
_2f("mousedown");
_2f("mouseup");
}
}
};
var _31;
if(_b){
_8(function(){
_9.doc.addEventListener(_c.down,function(evt){
_28(evt,_c.move,_c.up);
},true);
});
}else{
if(_f){
_8(function(){
_31=_9.body();
_9.doc.addEventListener("touchstart",function(evt){
_19=(new Date()).getTime();
var _32=_31;
_31=evt.target;
on.emit(_32,"dojotouchout",{relatedTarget:_31,bubbles:true});
on.emit(_31,"dojotouchover",{relatedTarget:_32,bubbles:true});
_28(evt,"touchmove","touchend");
},true);
function _33(evt){
var _34=_5.delegate(evt,{bubbles:true});
if(_6("ios")>=6){
_34.touches=evt.touches;
_34.altKey=evt.altKey;
_34.changedTouches=evt.changedTouches;
_34.ctrlKey=evt.ctrlKey;
_34.metaKey=evt.metaKey;
_34.shiftKey=evt.shiftKey;
_34.targetTouches=evt.targetTouches;
}
return _34;
};
on(_9.doc,"touchmove",function(evt){
_19=(new Date()).getTime();
var _35=_9.doc.elementFromPoint(evt.pageX-(_a?0:_9.global.pageXOffset),evt.pageY-(_a?0:_9.global.pageYOffset));
if(_35){
if(_31!==_35){
on.emit(_31,"dojotouchout",{relatedTarget:_35,bubbles:true});
on.emit(_35,"dojotouchover",{relatedTarget:_31,bubbles:true});
_31=_35;
}
if(!on.emit(_35,"dojotouchmove",_33(evt))){
evt.preventDefault();
}
}
});
on(_9.doc,"touchend",function(evt){
_19=(new Date()).getTime();
var _36=_9.doc.elementFromPoint(evt.pageX-(_a?0:_9.global.pageXOffset),evt.pageY-(_a?0:_9.global.pageYOffset))||_9.body();
on.emit(_36,"dojotouchend",_33(evt));
});
});
}
}
var _37={press:_1a("mousedown","touchstart",_c.down),move:_1a("mousemove","dojotouchmove",_c.move),release:_1a("mouseup","dojotouchend",_c.up),cancel:_1a(_7.leave,"touchcancel",_b?_c.cancel:null),over:_1a("mouseover","dojotouchover",_c.over),out:_1a("mouseout","dojotouchout",_c.out),enter:_7._eventHandler(_1a("mouseover","dojotouchover",_c.over)),leave:_7._eventHandler(_1a("mouseout","dojotouchout",_c.out))};
_6("extend-dojo")&&(_1.touch=_37);
return _37;
});


;define("dijit/a11yclick",["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(_1,_2,on,_3){
function _4(e){
if((e.keyCode===_1.ENTER||e.keyCode===_1.SPACE)&&!/input|button|textarea/i.test(e.target.nodeName)){
for(var _5=e.target;_5;_5=_5.parentNode){
if(_5.dojoClick){
return true;
}
}
}
};
var _6;
on(document,"keydown",function(e){
if(_4(e)){
_6=e.target;
e.preventDefault();
}else{
_6=null;
}
});
on(document,"keyup",function(e){
if(_4(e)&&e.target==_6){
_6=null;
on.emit(e.target,"click",{cancelable:true,bubbles:true,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,altKey:e.altKey,_origType:e.type});
}
});
var _7=function(_8,_9){
_8.dojoClick=true;
return on(_8,"click",_9);
};
_7.click=_7;
_7.press=function(_a,_b){
var _c=on(_a,_3.press,function(_d){
if(_d.type=="mousedown"&&!_2.isLeft(_d)){
return;
}
_b(_d);
}),_e=on(_a,"keydown",function(_f){
if(_f.keyCode===_1.ENTER||_f.keyCode===_1.SPACE){
_b(_f);
}
});
return {remove:function(){
_c.remove();
_e.remove();
}};
};
_7.release=function(_10,_11){
var _12=on(_10,_3.release,function(evt){
if(evt.type=="mouseup"&&!_2.isLeft(evt)){
return;
}
_11(evt);
}),_13=on(_10,"keyup",function(evt){
if(evt.keyCode===_1.ENTER||evt.keyCode===_1.SPACE){
_11(evt);
}
});
return {remove:function(){
_12.remove();
_13.remove();
}};
};
_7.move=_3.move;
return _7;
});


;define("dijit/_OnDijitClickMixin",["dojo/on","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/has","./a11yclick"],function(on,_1,_2,_3,_4,_5){
var _6=_3("dijit._OnDijitClickMixin",null,{connect:function(_7,_8,_9){
return this.inherited(arguments,[_7,_8=="ondijitclick"?_5:_8,_9]);
}});
_6.a11yclick=_5;
return _6;
});


;define("dijit/a11y",["dojo/_base/array","dojo/dom","dojo/dom-attr","dojo/dom-style","dojo/_base/lang","dojo/sniff","./main"],function(_1,_2,_3,_4,_5,_6,_7){
var _8;
var _9={_isElementShown:function(_a){
var s=_4.get(_a);
return (s.visibility!="hidden")&&(s.visibility!="collapsed")&&(s.display!="none")&&(_3.get(_a,"type")!="hidden");
},hasDefaultTabStop:function(_b){
switch(_b.nodeName.toLowerCase()){
case "a":
return _3.has(_b,"href");
case "area":
case "button":
case "input":
case "object":
case "select":
case "textarea":
return true;
case "iframe":
var _c;
try{
var _d=_b.contentDocument;
if("designMode" in _d&&_d.designMode=="on"){
return true;
}
_c=_d.body;
}
catch(e1){
try{
_c=_b.contentWindow.document.body;
}
catch(e2){
return false;
}
}
return _c&&(_c.contentEditable=="true"||(_c.firstChild&&_c.firstChild.contentEditable=="true"));
default:
return _b.contentEditable=="true";
}
},effectiveTabIndex:function(_e){
if(_3.get(_e,"disabled")){
return _8;
}else{
if(_3.has(_e,"tabIndex")){
return +_3.get(_e,"tabIndex");
}else{
return _9.hasDefaultTabStop(_e)?0:_8;
}
}
},isTabNavigable:function(_f){
return _9.effectiveTabIndex(_f)>=0;
},isFocusable:function(_10){
return _9.effectiveTabIndex(_10)>=-1;
},_getTabNavigable:function(_11){
var _12,_13,_14,_15,_16,_17,_18={};
function _19(_1a){
return _1a&&_1a.tagName.toLowerCase()=="input"&&_1a.type&&_1a.type.toLowerCase()=="radio"&&_1a.name&&_1a.name.toLowerCase();
};
var _1b=_9._isElementShown,_1c=_9.effectiveTabIndex;
var _1d=function(_1e){
for(var _1f=_1e.firstChild;_1f;_1f=_1f.nextSibling){
if(_1f.nodeType!=1||(_6("ie")<=9&&_1f.scopeName!=="HTML")||!_1b(_1f)){
continue;
}
var _20=_1c(_1f);
if(_20>=0){
if(_20==0){
if(!_12){
_12=_1f;
}
_13=_1f;
}else{
if(_20>0){
if(!_14||_20<_15){
_15=_20;
_14=_1f;
}
if(!_16||_20>=_17){
_17=_20;
_16=_1f;
}
}
}
var rn=_19(_1f);
if(_3.get(_1f,"checked")&&rn){
_18[rn]=_1f;
}
}
if(_1f.nodeName.toUpperCase()!="SELECT"){
_1d(_1f);
}
}
};
if(_1b(_11)){
_1d(_11);
}
function rs(_21){
return _18[_19(_21)]||_21;
};
return {first:rs(_12),last:rs(_13),lowest:rs(_14),highest:rs(_16)};
},getFirstInTabbingOrder:function(_22,doc){
var _23=_9._getTabNavigable(_2.byId(_22,doc));
return _23.lowest?_23.lowest:_23.first;
},getLastInTabbingOrder:function(_24,doc){
var _25=_9._getTabNavigable(_2.byId(_24,doc));
return _25.last?_25.last:_25.highest;
}};
_6("extend-dojo")&&_5.mixin(_7,_9);
return _9;
});


;define("dijit/focus",["dojo/aspect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/Evented","dojo/_base/lang","dojo/on","dojo/domReady","dojo/sniff","dojo/Stateful","dojo/_base/window","dojo/window","./a11y","./registry","./main"],function(_1,_2,_3,_4,_5,_6,_7,_8,on,_9,_a,_b,_c,_d,_e,_f,_10){
var _11;
var _12;
var _13=_2([_b,_7],{curNode:null,activeStack:[],constructor:function(){
var _14=_8.hitch(this,function(_15){
if(_3.isDescendant(this.curNode,_15)){
this.set("curNode",null);
}
if(_3.isDescendant(this.prevNode,_15)){
this.set("prevNode",null);
}
});
_1.before(_6,"empty",_14);
_1.before(_6,"destroy",_14);
},registerIframe:function(_16){
return this.registerWin(_16.contentWindow,_16);
},registerWin:function(_17,_18){
var _19=this,_1a=_17.document&&_17.document.body;
if(_1a){
var _1b=_a("pointer-events")?"pointerdown":_a("MSPointer")?"MSPointerDown":_a("touch-events")?"mousedown, touchstart":"mousedown";
var mdh=on(_17.document,_1b,function(evt){
if(evt&&evt.target&&evt.target.parentNode==null){
return;
}
_19._onTouchNode(_18||evt.target,"mouse");
});
var fih=on(_1a,"focusin",function(evt){
if(!evt.target.tagName){
return;
}
var tag=evt.target.tagName.toLowerCase();
if(tag=="#document"||tag=="body"){
return;
}
if(_e.isFocusable(evt.target)){
_19._onFocusNode(_18||evt.target);
}else{
_19._onTouchNode(_18||evt.target);
}
});
var foh=on(_1a,"focusout",function(evt){
_19._onBlurNode(_18||evt.target);
});
return {remove:function(){
mdh.remove();
fih.remove();
foh.remove();
mdh=fih=foh=null;
_1a=null;
}};
}
},_onBlurNode:function(_1c){
var now=(new Date()).getTime();
if(now<_11+100){
return;
}
if(this._clearFocusTimer){
clearTimeout(this._clearFocusTimer);
}
this._clearFocusTimer=setTimeout(_8.hitch(this,function(){
this.set("prevNode",this.curNode);
this.set("curNode",null);
}),0);
if(this._clearActiveWidgetsTimer){
clearTimeout(this._clearActiveWidgetsTimer);
}
if(now<_12+100){
return;
}
this._clearActiveWidgetsTimer=setTimeout(_8.hitch(this,function(){
delete this._clearActiveWidgetsTimer;
this._setStack([]);
}),0);
},_onTouchNode:function(_1d,by){
_12=(new Date()).getTime();
if(this._clearActiveWidgetsTimer){
clearTimeout(this._clearActiveWidgetsTimer);
delete this._clearActiveWidgetsTimer;
}
if(_5.contains(_1d,"dijitPopup")){
_1d=_1d.firstChild;
}
var _1e=[];
try{
while(_1d){
var _1f=_4.get(_1d,"dijitPopupParent");
if(_1f){
_1d=_f.byId(_1f).domNode;
}else{
if(_1d.tagName&&_1d.tagName.toLowerCase()=="body"){
if(_1d===_c.body()){
break;
}
_1d=_d.get(_1d.ownerDocument).frameElement;
}else{
var id=_1d.getAttribute&&_1d.getAttribute("widgetId"),_20=id&&_f.byId(id);
if(_20&&!(by=="mouse"&&_20.get("disabled"))&&(!_a("ie")||_20.isFocusable())){
_1e.unshift(id);
}
_1d=_1d.parentNode;
}
}
}
}
catch(e){
}
this._setStack(_1e,by);
},_onFocusNode:function(_21){
if(!_21){
return;
}
if(_21.nodeType==9){
return;
}
_11=(new Date()).getTime();
if(this._clearFocusTimer){
clearTimeout(this._clearFocusTimer);
delete this._clearFocusTimer;
}
this._onTouchNode(_21);
if(_21==this.curNode){
return;
}
this.set("prevNode",this.curNode);
this.set("curNode",_21);
},_setStack:function(_22,by){
var _23=this.activeStack,_24=_23.length-1,_25=_22.length-1;
if(_22[_25]==_23[_24]){
return;
}
this.set("activeStack",_22);
var _26,i;
for(i=_24;i>=0&&_23[i]!=_22[i];i--){
_26=_f.byId(_23[i]);
if(_26){
_26._hasBeenBlurred=true;
_26.set("focused",false);
if(_26._focusManager==this){
_26._onBlur(by);
}
this.emit("widget-blur",_26,by);
}
}
for(i++;i<=_25;i++){
_26=_f.byId(_22[i]);
if(_26){
_26.set("focused",true);
if(_26._focusManager==this){
_26._onFocus(by);
}
this.emit("widget-focus",_26,by);
}
}
},focus:function(_27){
if(_27){
try{
_27.focus();
}
catch(e){
}
}
}});
var _28=new _13();
_9(function(){
var _29=_28.registerWin(_d.get(document));
if(_a("ie")){
on(window,"unload",function(){
if(_29){
_29.remove();
_29=null;
}
});
}
});
_10.focus=function(_2a){
_28.focus(_2a);
};
for(var _2b in _28){
if(!/^_/.test(_2b)){
_10.focus[_2b]=typeof _28[_2b]=="function"?_8.hitch(_28,_2b):_28[_2b];
}
}
_28.watch(function(_2c,_2d,_2e){
_10.focus[_2c]=_2e;
});
return _28;
});


;define("dijit/_FocusMixin",["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(_1,_2,_3,_4){
_4.extend(_2,{focused:false,onFocus:function(){
},onBlur:function(){
},_onFocus:function(){
this.onFocus();
},_onBlur:function(){
this.onBlur();
}});
return _3("dijit._FocusMixin",null,{_focusManager:_1});
});


;define("dojo/uacss",["./dom-geometry","./_base/lang","./domReady","./sniff","./_base/window"],function(_1,_2,_3,_4,_5){
var _6=_5.doc.documentElement,ie=_4("ie"),_7=_4("trident"),_8=_4("opera"),_9=Math.floor,ff=_4("ff"),_a=_1.boxModel.replace(/-/,""),_b={"dj_quirks":_4("quirks"),"dj_opera":_8,"dj_khtml":_4("khtml"),"dj_webkit":_4("webkit"),"dj_safari":_4("safari"),"dj_chrome":_4("chrome"),"dj_gecko":_4("mozilla"),"dj_ios":_4("ios"),"dj_android":_4("android")};
if(ie){
_b["dj_ie"]=true;
_b["dj_ie"+_9(ie)]=true;
_b["dj_iequirks"]=_4("quirks");
}
if(_7){
_b["dj_trident"]=true;
_b["dj_trident"+_9(_7)]=true;
}
if(ff){
_b["dj_ff"+_9(ff)]=true;
}
_b["dj_"+_a]=true;
var _c="";
for(var _d in _b){
if(_b[_d]){
_c+=_d+" ";
}
}
_6.className=_2.trim(_6.className+" "+_c);
_3(function(){
if(!_1.isBodyLtr()){
var _e="dj_rtl dijitRtl "+_c.replace(/ /g,"-rtl ");
_6.className=_2.trim(_6.className+" "+_e+"dj_rtl dijitRtl "+_c.replace(/ /g,"-rtl "));
}
});
return _4;
});


;define("dojo/hccss",["require","./_base/config","./dom-class","./dom-style","./has","./domReady","./_base/window"],function(_1,_2,_3,_4,_5,_6,_7){
_5.add("highcontrast",function(){
var _8=_7.doc.createElement("div");
_8.style.cssText="border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;"+"background-image: url(\""+(_2.blankGif||_1.toUrl("dojo/resources/blank.gif?etag=Z6uJWS0"))+"\");";
_7.body().appendChild(_8);
var cs=_4.getComputedStyle(_8),_9=cs.backgroundImage,hc=(cs.borderTopColor==cs.borderRightColor)||(_9&&(_9=="none"||_9=="url(invalid-url:)"));
if(_5("ie")<=8){
_8.outerHTML="";
}else{
_7.body().removeChild(_8);
}
return hc;
});
_6(function(){
if(_5("highcontrast")){
_3.add(_7.body(),"dj_a11y");
}
});
return _5;
});


;define("dijit/hccss",["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(_1,_2,_3,_4){
_3(function(){
if(_2("highcontrast")){
_1.add(_4.body(),"dijit_a11y");
}
});
return _2;
});


;define("dijit/WidgetSet",["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","./registry"],function(_1,_2,_3,_4){
var _5=_2("dijit.WidgetSet",null,{constructor:function(){
this._hash={};
this.length=0;
},add:function(_6){
if(this._hash[_6.id]){
throw new Error("Tried to register widget with id=="+_6.id+" but that id is already registered");
}
this._hash[_6.id]=_6;
this.length++;
},remove:function(id){
if(this._hash[id]){
delete this._hash[id];
this.length--;
}
},forEach:function(_7,_8){
_8=_8||_3.global;
var i=0,id;
for(id in this._hash){
_7.call(_8,this._hash[id],i++,this._hash);
}
return this;
},filter:function(_9,_a){
_a=_a||_3.global;
var _b=new _5(),i=0,id;
for(id in this._hash){
var w=this._hash[id];
if(_9.call(_a,w,i++,this._hash)){
_b.add(w);
}
}
return _b;
},byId:function(id){
return this._hash[id];
},byClass:function(_c){
var _d=new _5(),id,_e;
for(id in this._hash){
_e=this._hash[id];
if(_e.declaredClass==_c){
_d.add(_e);
}
}
return _d;
},toArray:function(){
var ar=[];
for(var id in this._hash){
ar.push(this._hash[id]);
}
return ar;
},map:function(_f,_10){
return _1.map(this.toArray(),_f,_10);
},every:function(_11,_12){
_12=_12||_3.global;
var x=0,i;
for(i in this._hash){
if(!_11.call(_12,this._hash[i],x++,this._hash)){
return false;
}
}
return true;
},some:function(_13,_14){
_14=_14||_3.global;
var x=0,i;
for(i in this._hash){
if(_13.call(_14,this._hash[i],x++,this._hash)){
return true;
}
}
return false;
}});
_1.forEach(["forEach","filter","byClass","map","every","some"],function(_15){
_4[_15]=_5.prototype[_15];
});
return _5;
});


;define("dijit/selection",["dojo/_base/array","dojo/dom","dojo/_base/lang","dojo/sniff","dojo/_base/window","dijit/focus"],function(_1,_2,_3,_4,_5,_6){
var _7=function(_8){
var _9=_8.document;
this.getType=function(){
if(_9.getSelection){
var _a="text";
var _b;
try{
_b=_8.getSelection();
}
catch(e){
}
if(_b&&_b.rangeCount==1){
var _c=_b.getRangeAt(0);
if((_c.startContainer==_c.endContainer)&&((_c.endOffset-_c.startOffset)==1)&&(_c.startContainer.nodeType!=3)){
_a="control";
}
}
return _a;
}else{
return _9.selection.type.toLowerCase();
}
};
this.getSelectedText=function(){
if(_9.getSelection){
var _d=_8.getSelection();
return _d?_d.toString():"";
}else{
if(this.getType()=="control"){
return null;
}
return _9.selection.createRange().text;
}
};
this.getSelectedHtml=function(){
if(_9.getSelection){
var _e=_8.getSelection();
if(_e&&_e.rangeCount){
var i;
var _f="";
for(i=0;i<_e.rangeCount;i++){
var _10=_e.getRangeAt(i).cloneContents();
var div=_9.createElement("div");
div.appendChild(_10);
_f+=div.innerHTML;
}
return _f;
}
return null;
}else{
if(this.getType()=="control"){
return null;
}
return _9.selection.createRange().htmlText;
}
};
this.getSelectedElement=function(){
if(this.getType()=="control"){
if(_9.getSelection){
var _11=_8.getSelection();
return _11.anchorNode.childNodes[_11.anchorOffset];
}else{
var _12=_9.selection.createRange();
if(_12&&_12.item){
return _9.selection.createRange().item(0);
}
}
}
return null;
};
this.getParentElement=function(){
if(this.getType()=="control"){
var p=this.getSelectedElement();
if(p){
return p.parentNode;
}
}else{
if(_9.getSelection){
var _13=_9.getSelection();
if(_13){
var _14=_13.anchorNode;
while(_14&&(_14.nodeType!=1)){
_14=_14.parentNode;
}
return _14;
}
}else{
var r=_9.selection.createRange();
r.collapse(true);
return r.parentElement();
}
}
return null;
};
this.hasAncestorElement=function(_15){
return this.getAncestorElement.apply(this,arguments)!=null;
};
this.getAncestorElement=function(_16){
var _17=this.getSelectedElement()||this.getParentElement();
return this.getParentOfType(_17,arguments);
};
this.isTag=function(_18,_19){
if(_18&&_18.tagName){
var _1a=_18.tagName.toLowerCase();
for(var i=0;i<_19.length;i++){
var _1b=String(_19[i]).toLowerCase();
if(_1a==_1b){
return _1b;
}
}
}
return "";
};
this.getParentOfType=function(_1c,_1d){
while(_1c){
if(this.isTag(_1c,_1d).length){
return _1c;
}
_1c=_1c.parentNode;
}
return null;
};
this.collapse=function(_1e){
if(_9.getSelection){
var _1f=_8.getSelection();
if(_1f.removeAllRanges){
if(_1e){
_1f.collapseToStart();
}else{
_1f.collapseToEnd();
}
}else{
_1f.collapse(_1e);
}
}else{
var _20=_9.selection.createRange();
_20.collapse(_1e);
_20.select();
}
};
this.remove=function(){
var sel=_9.selection;
if(_9.getSelection){
sel=_8.getSelection();
sel.deleteFromDocument();
return sel;
}else{
if(sel.type.toLowerCase()!="none"){
sel.clear();
}
return sel;
}
};
this.selectElementChildren=function(_21,_22){
var _23;
_21=_2.byId(_21);
if(_9.getSelection){
var _24=_8.getSelection();
if(_4("opera")){
if(_24.rangeCount){
_23=_24.getRangeAt(0);
}else{
_23=_9.createRange();
}
_23.setStart(_21,0);
_23.setEnd(_21,(_21.nodeType==3)?_21.length:_21.childNodes.length);
_24.addRange(_23);
}else{
_24.selectAllChildren(_21);
}
}else{
_23=_21.ownerDocument.body.createTextRange();
_23.moveToElementText(_21);
if(!_22){
try{
_23.select();
}
catch(e){
}
}
}
};
this.selectElement=function(_25,_26){
var _27;
_25=_2.byId(_25);
if(_9.getSelection){
var _28=_9.getSelection();
_27=_9.createRange();
if(_28.removeAllRanges){
if(_4("opera")){
if(_28.getRangeAt(0)){
_27=_28.getRangeAt(0);
}
}
_27.selectNode(_25);
_28.removeAllRanges();
_28.addRange(_27);
}
}else{
try{
var tg=_25.tagName?_25.tagName.toLowerCase():"";
if(tg==="img"||tg==="table"){
_27=_5.body(_9).createControlRange();
}else{
_27=_5.body(_9).createRange();
}
_27.addElement(_25);
if(!_26){
_27.select();
}
}
catch(e){
this.selectElementChildren(_25,_26);
}
}
};
this.inSelection=function(_29){
if(_29){
var _2a;
var _2b;
if(_9.getSelection){
var sel=_8.getSelection();
if(sel&&sel.rangeCount>0){
_2b=sel.getRangeAt(0);
}
if(_2b&&_2b.compareBoundaryPoints&&_9.createRange){
try{
_2a=_9.createRange();
_2a.setStart(_29,0);
if(_2b.compareBoundaryPoints(_2b.START_TO_END,_2a)===1){
return true;
}
}
catch(e){
}
}
}else{
_2b=_9.selection.createRange();
try{
_2a=_29.ownerDocument.body.createTextRange();
_2a.moveToElementText(_29);
}
catch(e2){
}
if(_2b&&_2a){
if(_2b.compareEndPoints("EndToStart",_2a)===1){
return true;
}
}
}
}
return false;
};
this.getBookmark=function(){
var bm,rg,tg,sel=_9.selection,cf=_6.curNode;
if(_9.getSelection){
sel=_8.getSelection();
if(sel){
if(sel.isCollapsed){
tg=cf?cf.tagName:"";
if(tg){
tg=tg.toLowerCase();
if(tg=="textarea"||(tg=="input"&&(!cf.type||cf.type.toLowerCase()=="text"))){
sel={start:cf.selectionStart,end:cf.selectionEnd,node:cf,pRange:true};
return {isCollapsed:(sel.end<=sel.start),mark:sel};
}
}
bm={isCollapsed:true};
if(sel.rangeCount){
bm.mark=sel.getRangeAt(0).cloneRange();
}
}else{
rg=sel.getRangeAt(0);
bm={isCollapsed:false,mark:rg.cloneRange()};
}
}
}else{
if(sel){
tg=cf?cf.tagName:"";
tg=tg.toLowerCase();
if(cf&&tg&&(tg=="button"||tg=="textarea"||tg=="input")){
if(sel.type&&sel.type.toLowerCase()=="none"){
return {isCollapsed:true,mark:null};
}else{
rg=sel.createRange();
return {isCollapsed:rg.text&&rg.text.length?false:true,mark:{range:rg,pRange:true}};
}
}
bm={};
try{
rg=sel.createRange();
bm.isCollapsed=!(sel.type=="Text"?rg.htmlText.length:rg.length);
}
catch(e){
bm.isCollapsed=true;
return bm;
}
if(sel.type.toUpperCase()=="CONTROL"){
if(rg.length){
bm.mark=[];
var i=0,len=rg.length;
while(i<len){
bm.mark.push(rg.item(i++));
}
}else{
bm.isCollapsed=true;
bm.mark=null;
}
}else{
bm.mark=rg.getBookmark();
}
}else{
console.warn("No idea how to store the current selection for this browser!");
}
}
return bm;
};
this.moveToBookmark=function(_2c){
var _2d=_2c.mark;
if(_2d){
if(_9.getSelection){
var sel=_8.getSelection();
if(sel&&sel.removeAllRanges){
if(_2d.pRange){
var n=_2d.node;
n.selectionStart=_2d.start;
n.selectionEnd=_2d.end;
}else{
sel.removeAllRanges();
sel.addRange(_2d);
}
}else{
console.warn("No idea how to restore selection for this browser!");
}
}else{
if(_9.selection&&_2d){
var rg;
if(_2d.pRange){
rg=_2d.range;
}else{
if(_3.isArray(_2d)){
rg=_9.body.createControlRange();
_1.forEach(_2d,function(n){
rg.addElement(n);
});
}else{
rg=_9.body.createTextRange();
rg.moveToBookmark(_2d);
}
}
rg.select();
}
}
}
};
this.isCollapsed=function(){
return this.getBookmark().isCollapsed;
};
};
var _2e=new _7(window);
_2e.SelectionManager=_7;
return _2e;
});


;define("dijit/_base/focus",["dojo/_base/array","dojo/dom","dojo/_base/lang","dojo/topic","dojo/_base/window","../focus","../selection","../main"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9={_curFocus:null,_prevFocus:null,isCollapsed:function(){
return _8.getBookmark().isCollapsed;
},getBookmark:function(){
var _a=_5.global==window?_7:new _7.SelectionManager(_5.global);
return _a.getBookmark();
},moveToBookmark:function(_b){
var _c=_5.global==window?_7:new _7.SelectionManager(_5.global);
return _c.moveToBookmark(_b);
},getFocus:function(_d,_e){
var _f=!_6.curNode||(_d&&_2.isDescendant(_6.curNode,_d.domNode))?_8._prevFocus:_6.curNode;
return {node:_f,bookmark:_f&&(_f==_6.curNode)&&_5.withGlobal(_e||_5.global,_8.getBookmark),openedForWindow:_e};
},_activeStack:[],registerIframe:function(_10){
return _6.registerIframe(_10);
},unregisterIframe:function(_11){
_11&&_11.remove();
},registerWin:function(_12,_13){
return _6.registerWin(_12,_13);
},unregisterWin:function(_14){
_14&&_14.remove();
}};
_6.focus=function(_15){
if(!_15){
return;
}
var _16="node" in _15?_15.node:_15,_17=_15.bookmark,_18=_15.openedForWindow,_19=_17?_17.isCollapsed:false;
if(_16){
var _1a=(_16.tagName.toLowerCase()=="iframe")?_16.contentWindow:_16;
if(_1a&&_1a.focus){
try{
_1a.focus();
}
catch(e){
}
}
_6._onFocusNode(_16);
}
if(_17&&_5.withGlobal(_18||_5.global,_8.isCollapsed)&&!_19){
if(_18){
_18.focus();
}
try{
_5.withGlobal(_18||_5.global,_8.moveToBookmark,null,[_17]);
}
catch(e2){
}
}
};
_6.watch("curNode",function(_1b,_1c,_1d){
_8._curFocus=_1d;
_8._prevFocus=_1c;
if(_1d){
_4.publish("focusNode",_1d);
}
});
_6.watch("activeStack",function(_1e,_1f,_20){
_8._activeStack=_20;
});
_6.on("widget-blur",function(_21,by){
_4.publish("widgetBlur",_21,by);
});
_6.on("widget-focus",function(_22,by){
_4.publish("widgetFocus",_22,by);
});
_3.mixin(_8,_9);
return _8;
});


;define("dijit/_base/place",["dojo/_base/array","dojo/_base/lang","dojo/window","../place","../main"],function(_1,_2,_3,_4,_5){
var _6={};
_6.getViewport=function(){
return _3.getBox();
};
_6.placeOnScreen=_4.at;
_6.placeOnScreenAroundElement=function(_7,_8,_9,_a){
var _b;
if(_2.isArray(_9)){
_b=_9;
}else{
_b=[];
for(var _c in _9){
_b.push({aroundCorner:_c,corner:_9[_c]});
}
}
return _4.around(_7,_8,_b,true,_a);
};
_6.placeOnScreenAroundNode=_6.placeOnScreenAroundElement;
_6.placeOnScreenAroundRectangle=_6.placeOnScreenAroundElement;
_6.getPopupAroundAlignment=function(_d,_e){
var _f={};
_1.forEach(_d,function(pos){
var ltr=_e;
switch(pos){
case "after":
_f[_e?"BR":"BL"]=_e?"BL":"BR";
break;
case "before":
_f[_e?"BL":"BR"]=_e?"BR":"BL";
break;
case "below-alt":
ltr=!ltr;
case "below":
_f[ltr?"BL":"BR"]=ltr?"TL":"TR";
_f[ltr?"BR":"BL"]=ltr?"TR":"TL";
break;
case "above-alt":
ltr=!ltr;
case "above":
default:
_f[ltr?"TL":"TR"]=ltr?"BL":"BR";
_f[ltr?"TR":"TL"]=ltr?"BR":"BL";
break;
}
});
return _f;
};
_2.mixin(_5,_6);
return _5;
});


;define("dijit/_base/scroll",["dojo/window","../main"],function(_1,_2){
_2.scrollIntoView=function(_3,_4){
_1.scrollIntoView(_3,_4);
};
});


;define("dijit/_base/sniff",["dojo/uacss"],function(){
});


;define("dijit/typematic",["dojo/_base/array","dojo/_base/connect","dojo/_base/lang","dojo/on","dojo/sniff","./main"],function(_1,_2,_3,on,_4,_5){
var _6=(_5.typematic={_fireEventAndReload:function(){
this._timer=null;
this._callback(++this._count,this._node,this._evt);
this._currentTimeout=Math.max(this._currentTimeout<0?this._initialDelay:(this._subsequentDelay>1?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay)),this._minDelay);
this._timer=setTimeout(_3.hitch(this,"_fireEventAndReload"),this._currentTimeout);
},trigger:function(_7,_8,_9,_a,_b,_c,_d,_e){
if(_b!=this._obj){
this.stop();
this._initialDelay=_d||500;
this._subsequentDelay=_c||0.9;
this._minDelay=_e||10;
this._obj=_b;
this._node=_9;
this._currentTimeout=-1;
this._count=-1;
this._callback=_3.hitch(_8,_a);
this._evt={faux:true};
for(var _f in _7){
if(_f!="layerX"&&_f!="layerY"){
var v=_7[_f];
if(typeof v!="function"&&typeof v!="undefined"){
this._evt[_f]=v;
}
}
}
this._fireEventAndReload();
}
},stop:function(){
if(this._timer){
clearTimeout(this._timer);
this._timer=null;
}
if(this._obj){
this._callback(-1,this._node,this._evt);
this._obj=null;
}
},addKeyListener:function(_10,_11,_12,_13,_14,_15,_16){
var _17="keyCode" in _11?"keydown":"charCode" in _11?"keypress":_2._keypress,_18="keyCode" in _11?"keyCode":"charCode" in _11?"charCode":"charOrCode";
var _19=[on(_10,_17,_3.hitch(this,function(evt){
if(evt[_18]==_11[_18]&&(_11.ctrlKey===undefined||_11.ctrlKey==evt.ctrlKey)&&(_11.altKey===undefined||_11.altKey==evt.altKey)&&(_11.metaKey===undefined||_11.metaKey==(evt.metaKey||false))&&(_11.shiftKey===undefined||_11.shiftKey==evt.shiftKey)){
evt.stopPropagation();
evt.preventDefault();
_6.trigger(evt,_12,_10,_13,_11,_14,_15,_16);
}else{
if(_6._obj==_11){
_6.stop();
}
}
})),on(_10,"keyup",_3.hitch(this,function(){
if(_6._obj==_11){
_6.stop();
}
}))];
return {remove:function(){
_1.forEach(_19,function(h){
h.remove();
});
}};
},addMouseListener:function(_1a,_1b,_1c,_1d,_1e,_1f){
var _20=[on(_1a,"mousedown",_3.hitch(this,function(evt){
evt.preventDefault();
_6.trigger(evt,_1b,_1a,_1c,_1a,_1d,_1e,_1f);
})),on(_1a,"mouseup",_3.hitch(this,function(evt){
if(this._obj){
evt.preventDefault();
}
_6.stop();
})),on(_1a,"mouseout",_3.hitch(this,function(evt){
if(this._obj){
evt.preventDefault();
}
_6.stop();
})),on(_1a,"dblclick",_3.hitch(this,function(evt){
evt.preventDefault();
if(_4("ie")<9){
_6.trigger(evt,_1b,_1a,_1c,_1a,_1d,_1e,_1f);
setTimeout(_3.hitch(this,_6.stop),50);
}
}))];
return {remove:function(){
_1.forEach(_20,function(h){
h.remove();
});
}};
},addListener:function(_21,_22,_23,_24,_25,_26,_27,_28){
var _29=[this.addKeyListener(_22,_23,_24,_25,_26,_27,_28),this.addMouseListener(_21,_24,_25,_26,_27,_28)];
return {remove:function(){
_1.forEach(_29,function(h){
h.remove();
});
}};
}});
return _6;
});


;define("dijit/_base/typematic",["../typematic"],function(){
});


;define("dijit/_base/wai",["dojo/dom-attr","dojo/_base/lang","../main","../hccss"],function(_1,_2,_3){
var _4={hasWaiRole:function(_5,_6){
var _7=this.getWaiRole(_5);
return _6?(_7.indexOf(_6)>-1):(_7.length>0);
},getWaiRole:function(_8){
return _2.trim((_1.get(_8,"role")||"").replace("wairole:",""));
},setWaiRole:function(_9,_a){
_1.set(_9,"role",_a);
},removeWaiRole:function(_b,_c){
var _d=_1.get(_b,"role");
if(!_d){
return;
}
if(_c){
var t=_2.trim((" "+_d+" ").replace(" "+_c+" "," "));
_1.set(_b,"role",t);
}else{
_b.removeAttribute("role");
}
},hasWaiState:function(_e,_f){
return _e.hasAttribute?_e.hasAttribute("aria-"+_f):!!_e.getAttribute("aria-"+_f);
},getWaiState:function(_10,_11){
return _10.getAttribute("aria-"+_11)||"";
},setWaiState:function(_12,_13,_14){
_12.setAttribute("aria-"+_13,_14);
},removeWaiState:function(_15,_16){
_15.removeAttribute("aria-"+_16);
}};
_2.mixin(_3,_4);
return _3;
});


;define("dijit/_base/window",["dojo/window","../main"],function(_1,_2){
_2.getDocumentWindow=function(_3){
return _1.get(_3);
};
});


;define("dijit/_base",["./main","./a11y","./WidgetSet","./_base/focus","./_base/manager","./_base/place","./_base/popup","./_base/scroll","./_base/sniff","./_base/typematic","./_base/wai","./_base/window"],function(_1){
return _1._base;
});


;define("dijit/_Widget",["dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/has","dojo/_base/kernel","dojo/_base/lang","dojo/query","dojo/ready","./registry","./_WidgetBase","./_OnDijitClickMixin","./_FocusMixin","dojo/uacss","./hccss","./_base"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){
function _e(){
};
function _f(_10){
return function(obj,_11,_12,_13){
if(obj&&typeof _11=="string"&&obj[_11]==_e){
return obj.on(_11.substring(2).toLowerCase(),_7.hitch(_12,_13));
}
return _10.apply(_3,arguments);
};
};
_1.around(_3,"connect",_f);
if(_6.connect){
_1.around(_6,"connect",_f);
}
var _14=_4("dijit._Widget",[_b,_c,_d],{onClick:_e,onDblClick:_e,onKeyDown:_e,onKeyPress:_e,onKeyUp:_e,onMouseDown:_e,onMouseMove:_e,onMouseOut:_e,onMouseOver:_e,onMouseLeave:_e,onMouseEnter:_e,onMouseUp:_e,constructor:function(_15){
this._toConnect={};
for(var _16 in _15){
if(this[_16]===_e){
this._toConnect[_16.replace(/^on/,"").toLowerCase()]=_15[_16];
delete _15[_16];
}
}
},postCreate:function(){
this.inherited(arguments);
for(var _17 in this._toConnect){
this.on(_17,this._toConnect[_17]);
}
delete this._toConnect;
},on:function(_18,_19){
if(this[this._onMap(_18)]===_e){
return _3.connect(this.domNode,_18.toLowerCase(),this,_19);
}
return this.inherited(arguments);
},_setFocusedAttr:function(val){
this._focused=val;
this._set("focused",val);
},setAttribute:function(_1a,_1b){
_6.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");
this.set(_1a,_1b);
},attr:function(_1c,_1d){
var _1e=arguments.length;
if(_1e>=2||typeof _1c==="object"){
return this.set.apply(this,arguments);
}else{
return this.get(_1c);
}
},getDescendants:function(){
_6.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");
return this.containerNode?_8("[widgetId]",this.containerNode).map(_a.byNode):[];
},_onShow:function(){
this.onShow();
},onShow:function(){
},onHide:function(){
},onClose:function(){
return true;
}});
return _14;
});


;define("dojo/request",["./request/xhr"],function(r){
return r;
});


;define("dojo/text",["./_base/kernel","require","./has","./has!host-browser?./request"],function(_1,_2,_3,_4){
var _5;
if(_3("host-browser")){
_5=function(_6,_7,_8){
_4(_6,{sync:!!_7,headers:{"X-Requested-With":null}}).then(_8);
};
}else{
if(_2.getText){
_5=_2.getText;
}else{
console.error("dojo/text plugin failed to load because loader does not support getText");
}
}
var _9={},_a=function(_b){
if(_b){
_b=_b.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");
var _c=_b.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);
if(_c){
_b=_c[1];
}
}else{
_b="";
}
return _b;
},_d={},_e={};
_1.cache=function(_f,url,_10){
var key;
if(typeof _f=="string"){
if(/\//.test(_f)){
key=_f;
_10=url;
}else{
key=_2.toUrl(_f.replace(/\./g,"/")+(url?("/"+url):""));
}
}else{
key=_f+"";
_10=url;
}
var val=(_10!=undefined&&typeof _10!="string")?_10.value:_10,_11=_10&&_10.sanitize;
if(typeof val=="string"){
_9[key]=val;
return _11?_a(val):val;
}else{
if(val===null){
delete _9[key];
return null;
}else{
if(!(key in _9)){
_5(key,true,function(_12){
_9[key]=_12;
});
}
return _11?_a(_9[key]):_9[key];
}
}
};
return {dynamic:true,normalize:function(id,_13){
var _14=id.split("!"),url=_14[0];
return (/^\./.test(url)?_13(url):url)+(_14[1]?"!"+_14[1]:"");
},load:function(id,_15,_16){
var _17=id.split("!"),_18=_17.length>1,_19=_17[0],url=_15.toUrl(_17[0]),_1a="url:"+url,_1b=_d,_1c=function(_1d){
_16(_18?_a(_1d):_1d);
};
if(_19 in _9){
_1b=_9[_19];
}else{
if(_15.cache&&_1a in _15.cache){
_1b=_15.cache[_1a];
}else{
if(url in _9){
_1b=_9[url];
}
}
}
if(_1b===_d){
if(_e[url]){
_e[url].push(_1c);
}else{
var _1e=_e[url]=[_1c];
_5(url,!_15.async,function(_1f){
_9[_19]=_9[url]=_1f;
for(var i=0;i<_1e.length;){
_1e[i++](_1f);
}
delete _e[url];
});
}
}else{
_1c(_1b);
}
}};
});


;define("dojo/cache",["./_base/kernel","./text"],function(_1){
return _1.cache;
});


;define("dojo/string",["./_base/kernel","./_base/lang"],function(_1,_2){
var _3=/[&<>'"\/]/g;
var _4={"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#x27;","/":"&#x2F;"};
var _5={};
_2.setObject("dojo.string",_5);
_5.escape=function(_6){
if(!_6){
return "";
}
return _6.replace(_3,function(c){
return _4[c];
});
};
_5.rep=function(_7,_8){
if(_8<=0||!_7){
return "";
}
var _9=[];
for(;;){
if(_8&1){
_9.push(_7);
}
if(!(_8>>=1)){
break;
}
_7+=_7;
}
return _9.join("");
};
_5.pad=function(_a,_b,ch,_c){
if(!ch){
ch="0";
}
var _d=String(_a),_e=_5.rep(ch,Math.ceil((_b-_d.length)/ch.length));
return _c?_d+_e:_e+_d;
};
_5.substitute=function(_f,map,_10,_11){
_11=_11||_1.global;
_10=_10?_2.hitch(_11,_10):function(v){
return v;
};
return _f.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(_12,key,_13){
var _14=_2.getObject(key,false,map);
if(_13){
_14=_2.getObject(_13,false,_11).call(_11,_14,key);
}
return _10(_14,key).toString();
});
};
_5.trim=String.prototype.trim?_2.trim:function(str){
str=str.replace(/^\s+/,"");
for(var i=str.length-1;i>=0;i--){
if(/\S/.test(str.charAt(i))){
str=str.substring(0,i+1);
break;
}
}
return str;
};
return _5;
});


;define("dijit/_AttachMixin",["require","dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","dojo/mouse","dojo/on","dojo/touch","./_WidgetBase"],function(_1,_2,_3,_4,_5,_6,on,_7,_8){
var _9=_5.delegate(_7,{"mouseenter":_6.enter,"mouseleave":_6.leave,"keypress":_3._keypress});
var _a;
var _b=_4("dijit._AttachMixin",null,{constructor:function(){
this._attachPoints=[];
this._attachEvents=[];
},buildRendering:function(){
this.inherited(arguments);
this._attachTemplateNodes(this.domNode);
this._beforeFillContent();
},_beforeFillContent:function(){
},_attachTemplateNodes:function(_c){
var _d=_c;
while(true){
if(_d.nodeType==1&&(this._processTemplateNode(_d,function(n,p){
return n.getAttribute(p);
},this._attach)||this.searchContainerNode)&&_d.firstChild){
_d=_d.firstChild;
}else{
if(_d==_c){
return;
}
while(!_d.nextSibling){
_d=_d.parentNode;
if(_d==_c){
return;
}
}
_d=_d.nextSibling;
}
}
},_processTemplateNode:function(_e,_f,_10){
var ret=true;
var _11=this.attachScope||this,_12=_f(_e,"dojoAttachPoint")||_f(_e,"data-dojo-attach-point");
if(_12){
var _13,_14=_12.split(/\s*,\s*/);
while((_13=_14.shift())){
if(_5.isArray(_11[_13])){
_11[_13].push(_e);
}else{
_11[_13]=_e;
}
ret=(_13!="containerNode");
this._attachPoints.push(_13);
}
}
var _15=_f(_e,"dojoAttachEvent")||_f(_e,"data-dojo-attach-event");
if(_15){
var _16,_17=_15.split(/\s*,\s*/);
var _18=_5.trim;
while((_16=_17.shift())){
if(_16){
var _19=null;
if(_16.indexOf(":")!=-1){
var _1a=_16.split(":");
_16=_18(_1a[0]);
_19=_18(_1a[1]);
}else{
_16=_18(_16);
}
if(!_19){
_19=_16;
}
this._attachEvents.push(_10(_e,_16,_5.hitch(_11,_19)));
}
}
}
return ret;
},_attach:function(_1b,_1c,_1d){
_1c=_1c.replace(/^on/,"").toLowerCase();
if(_1c=="dijitclick"){
_1c=_a||(_a=_1("./a11yclick"));
}else{
_1c=_9[_1c]||_1c;
}
return on(_1b,_1c,_1d);
},_detachTemplateNodes:function(){
var _1e=this.attachScope||this;
_2.forEach(this._attachPoints,function(_1f){
delete _1e[_1f];
});
this._attachPoints=[];
_2.forEach(this._attachEvents,function(_20){
_20.remove();
});
this._attachEvents=[];
},destroyRendering:function(){
this._detachTemplateNodes();
this.inherited(arguments);
}});
_5.extend(_8,{dojoAttachEvent:"",dojoAttachPoint:""});
return _b;
});


;define("dijit/_TemplatedMixin",["dojo/cache","dojo/_base/declare","dojo/dom-construct","dojo/_base/lang","dojo/on","dojo/sniff","dojo/string","./_AttachMixin"],function(_1,_2,_3,_4,on,_5,_6,_7){
function _8(_9){
if(_9.nodeType===1){
return _9;
}
var _a=_9;
if(_9.nodeType===11){
var _b=_9.childNodes.length,n=null,nt=null,_c=null,_d=false;
while(_b--&&!_d){
n=_9.childNodes[_b];
nt=n.nodeType;
if(nt===8){
continue;
}
if(nt===3){
if(n.nodeValue&&_4.trim(n.nodeValue).length>0){
_d=true;
}
}else{
if(nt===1){
if(!_c){
_c=n;
}else{
_d=true;
}
}
}
}
if(!_d){
if(!_c){
_d=true;
}else{
_9=_c;
}
}
}
return _d?_a:_9;
};
var _e=_2("dijit._TemplatedMixin",_7,{templateString:null,templatePath:null,_skipNodeCache:false,searchContainerNode:true,_stringRepl:function(_f){
var _10=this.declaredClass,_11=this;
return _6.substitute(_f,this,function(_12,key){
if(key.charAt(0)=="!"){
_12=_4.getObject(key.substr(1),false,_11);
}
if(typeof _12=="undefined"){
throw new Error(_10+" template:"+key);
}
if(_12==null){
return "";
}
return key.charAt(0)=="!"?_12:this._escapeValue(""+_12);
},this);
},_escapeValue:function(val){
return val.replace(/["'<>&]/g,function(val){
return {"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#x27;"}[val];
});
},buildRendering:function(){
if(!this._rendered){
if(!this.templateString){
this.templateString=_1(this.templatePath,{sanitize:true});
}
var _13=_e.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument);
var _14;
if(_4.isString(_13)){
_14=_8(_3.toDom(this._stringRepl(_13),this.ownerDocument));
if(_14.nodeType!=1){
throw new Error("Invalid template: "+_13);
}
}else{
_14=_13.cloneNode(true);
}
this.domNode=_14;
}
this.inherited(arguments);
if(!this._rendered){
this._fillContent(this.srcNodeRef);
}
this._rendered=true;
},_fillContent:function(_15){
var _16=this.containerNode;
if(_15&&_16){
while(_15.hasChildNodes()){
_16.appendChild(_15.firstChild);
}
}
}});
_e._templateCache={};
_e.getCachedTemplate=function(_17,_18,doc){
var _19=_e._templateCache;
var key=_17;
var _1a=_19[key];
if(_1a){
try{
if(!_1a.ownerDocument||_1a.ownerDocument==(doc||document)){
return _1a;
}
}
catch(e){
}
_3.destroy(_1a);
}
_17=_6.trim(_17);
if(_18||_17.match(/\$\{([^\}]+)\}/g)){
return (_19[key]=_17);
}else{
var _1b=_8(_3.toDom(_17,doc));
if(_1b.nodeType!=1){
throw new Error("Invalid template: "+_17);
}
return (_19[key]=_1b);
}
};
if(_5("ie")){
on(window,"unload",function(){
var _1c=_e._templateCache;
for(var key in _1c){
var _1d=_1c[key];
if(typeof _1d=="object"){
_3.destroy(_1d);
}
delete _1c[key];
}
});
}
return _e;
});


;define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_1,_2){
return _1("dijit._Contained",null,{_getSibling:function(_3){
var p=this.getParent();
return (p&&p._getSiblingOfChild&&p._getSiblingOfChild(this,_3=="previous"?-1:1))||null;
},getPreviousSibling:function(){
return this._getSibling("previous");
},getNextSibling:function(){
return this._getSibling("next");
},getIndexInParent:function(){
var p=this.getParent();
if(!p||!p.getIndexOfChild){
return -1;
}
return p.getIndexOfChild(this);
}});
});


;define("dijit/_CssStateMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-class","dojo/has","dojo/_base/lang","dojo/on","dojo/domReady","dojo/touch","dojo/_base/window","./a11yclick","./registry"],function(_1,_2,_3,_4,_5,_6,on,_7,_8,_9,_a,_b){
var _c=_2("dijit._CssStateMixin",[],{hovering:false,active:false,_applyAttributes:function(){
this.inherited(arguments);
_1.forEach(["disabled","readOnly","checked","selected","focused","state","hovering","active","_opened"],function(_d){
this.watch(_d,_6.hitch(this,"_setStateClass"));
},this);
for(var ap in this.cssStateNodes||{}){
this._trackMouseState(this[ap],this.cssStateNodes[ap]);
}
this._trackMouseState(this.domNode,this.baseClass);
this._setStateClass();
},_cssMouseEvent:function(_e){
if(!this.disabled){
switch(_e.type){
case "mouseover":
case "MSPointerOver":
case "pointerover":
this._set("hovering",true);
this._set("active",this._mouseDown);
break;
case "mouseout":
case "MSPointerOut":
case "pointerout":
this._set("hovering",false);
this._set("active",false);
break;
case "mousedown":
case "touchstart":
case "MSPointerDown":
case "pointerdown":
case "keydown":
this._set("active",true);
break;
case "mouseup":
case "dojotouchend":
case "MSPointerUp":
case "pointerup":
case "keyup":
this._set("active",false);
break;
}
}
},_setStateClass:function(){
var _f=this.baseClass.split(" ");
function _10(_11){
_f=_f.concat(_1.map(_f,function(c){
return c+_11;
}),"dijit"+_11);
};
if(!this.isLeftToRight()){
_10("Rtl");
}
var _12=this.checked=="mixed"?"Mixed":(this.checked?"Checked":"");
if(this.checked){
_10(_12);
}
if(this.state){
_10(this.state);
}
if(this.selected){
_10("Selected");
}
if(this._opened){
_10("Opened");
}
if(this.disabled){
_10("Disabled");
}else{
if(this.readOnly){
_10("ReadOnly");
}else{
if(this.active){
_10("Active");
}else{
if(this.hovering){
_10("Hover");
}
}
}
}
if(this.focused){
_10("Focused");
}
var tn=this.stateNode||this.domNode,_13={};
_1.forEach(tn.className.split(" "),function(c){
_13[c]=true;
});
if("_stateClasses" in this){
_1.forEach(this._stateClasses,function(c){
delete _13[c];
});
}
_1.forEach(_f,function(c){
_13[c]=true;
});
var _14=[];
for(var c in _13){
_14.push(c);
}
tn.className=_14.join(" ");
this._stateClasses=_f;
},_subnodeCssMouseEvent:function(_15,_16,evt){
if(this.disabled||this.readOnly){
return;
}
function _17(_18){
_4.toggle(_15,_16+"Hover",_18);
};
function _19(_1a){
_4.toggle(_15,_16+"Active",_1a);
};
function _1b(_1c){
_4.toggle(_15,_16+"Focused",_1c);
};
switch(evt.type){
case "mouseover":
case "MSPointerOver":
case "pointerover":
_17(true);
break;
case "mouseout":
case "MSPointerOut":
case "pointerout":
_17(false);
_19(false);
break;
case "mousedown":
case "touchstart":
case "MSPointerDown":
case "pointerdown":
case "keydown":
_19(true);
break;
case "mouseup":
case "MSPointerUp":
case "pointerup":
case "dojotouchend":
case "keyup":
_19(false);
break;
case "focus":
case "focusin":
_1b(true);
break;
case "blur":
case "focusout":
_1b(false);
break;
}
},_trackMouseState:function(_1d,_1e){
_1d._cssState=_1e;
}});
_7(function(){
function _1f(evt,_20,_21){
if(_21&&_3.isDescendant(_21,_20)){
return;
}
for(var _22=_20;_22&&_22!=_21;_22=_22.parentNode){
if(_22._cssState){
var _23=_b.getEnclosingWidget(_22);
if(_23){
if(_22==_23.domNode){
_23._cssMouseEvent(evt);
}else{
_23._subnodeCssMouseEvent(_22,_22._cssState,evt);
}
}
}
}
};
var _24=_9.body(),_25;
on(_24,_8.over,function(evt){
_1f(evt,evt.target,evt.relatedTarget);
});
on(_24,_8.out,function(evt){
_1f(evt,evt.target,evt.relatedTarget);
});
on(_24,_a.press,function(evt){
_25=evt.target;
_1f(evt,_25);
});
on(_24,_a.release,function(evt){
_1f(evt,_25);
_25=null;
});
on(_24,"focusin, focusout",function(evt){
var _26=evt.target;
if(_26._cssState&&!_26.getAttribute("widgetId")){
var _27=_b.getEnclosingWidget(_26);
if(_27){
_27._subnodeCssMouseEvent(_26,_26._cssState,evt);
}
}
});
});
return _c;
});


;define("dojo/text!dijit/templates/MenuItem.html", '<tr class="dijitReset" data-dojo-attach-point="focusNode" role="menuitem" tabIndex="-1">\n	<td class="dijitReset dijitMenuItemIconCell" role="presentation">\n		<span role="presentation" class="dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point="iconNode"></span>\n	</td>\n	<td class="dijitReset dijitMenuItemLabel" colspan="2" data-dojo-attach-point="containerNode,textDirNode"\n		role="presentation"></td>\n	<td class="dijitReset dijitMenuItemAccelKey" style="display: none" data-dojo-attach-point="accelKeyNode"></td>\n	<td class="dijitReset dijitMenuArrowCell" role="presentation">\n		<span data-dojo-attach-point="arrowWrapper" style="visibility: hidden">\n			<span class="dijitInline dijitIcon dijitMenuExpand"></span>\n			<span class="dijitMenuExpandA11y">+</span>\n		</span>\n	</td>\n</tr>\n');

;define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/kernel","dojo/sniff","dojo/_base/lang","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
var _d=_1("dijit.MenuItem"+(_6("dojo-bidi")?"_NoBidi":""),[_8,_9,_a,_b],{templateString:_c,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(_e){
this._set("label",_e);
var _f="";
var _10;
var ndx=_e.search(/{\S}/);
if(ndx>=0){
_f=_e.charAt(ndx+1);
var _11=_e.substr(0,ndx);
var _12=_e.substr(ndx+3);
_10=_11+_f+_12;
_e=_11+"<span class=\"dijitMenuItemShortcutKey\">"+_f+"</span>"+_12;
}else{
_10=_e;
}
this.domNode.setAttribute("aria-label",_10+" "+this.accelKey);
this.containerNode.innerHTML=_e;
this._set("shortcutKey",_f);
},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:false,_fillContent:function(_13){
if(_13&&!("label" in this.params)){
this._set("label",_13.innerHTML);
}
},buildRendering:function(){
this.inherited(arguments);
var _14=this.id+"_text";
_3.set(this.containerNode,"id",_14);
if(this.accelKeyNode){
_3.set(this.accelKeyNode,"id",this.id+"_accel");
}
_2.setSelectable(this.domNode,false);
},onClick:function(){
},focus:function(){
try{
if(_6("ie")==8){
this.containerNode.focus();
}
this.focusNode.focus();
}
catch(e){
}
},_setSelected:function(_15){
_4.toggle(this.domNode,"dijitMenuItemSelected",_15);
},setLabel:function(_16){
_5.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");
this.set("label",_16);
},setDisabled:function(_17){
_5.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");
this.set("disabled",_17);
},_setDisabledAttr:function(_18){
this.focusNode.setAttribute("aria-disabled",_18?"true":"false");
this._set("disabled",_18);
},_setAccelKeyAttr:function(_19){
if(this.accelKeyNode){
this.accelKeyNode.style.display=_19?"":"none";
this.accelKeyNode.innerHTML=_19;
_3.set(this.containerNode,"colSpan",_19?"1":"2");
}
this._set("accelKey",_19);
}});
if(_6("dojo-bidi")){
_d=_1("dijit.MenuItem",_d,{_setLabelAttr:function(val){
this.inherited(arguments);
if(this.textDir==="auto"){
this.applyTextDir(this.textDirNode);
}
}});
}
return _d;
});


;define("dojo/text!dijit/templates/CheckedMenuItem.html", '<tr class="dijitReset" data-dojo-attach-point="focusNode" role="${role}" tabIndex="-1" aria-checked="${checked}">\n	<td class="dijitReset dijitMenuItemIconCell" role="presentation">\n		<span class="dijitInline dijitIcon dijitMenuItemIcon dijitCheckedMenuItemIcon" data-dojo-attach-point="iconNode"></span>\n		<span class="dijitMenuItemIconChar dijitCheckedMenuItemIconChar">${!checkedChar}</span>\n	</td>\n	<td class="dijitReset dijitMenuItemLabel" colspan="2" data-dojo-attach-point="containerNode,labelNode,textDirNode"></td>\n	<td class="dijitReset dijitMenuItemAccelKey" style="display: none" data-dojo-attach-point="accelKeyNode"></td>\n	<td class="dijitReset dijitMenuArrowCell" role="presentation">&#160;</td>\n</tr>\n');

;define("dijit/CheckedMenuItem",["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(_1,_2,_3,_4){
return _1("dijit.CheckedMenuItem",_3,{baseClass:"dijitMenuItem dijitCheckedMenuItem",templateString:_4,checked:false,_setCheckedAttr:function(_5){
this.domNode.setAttribute("aria-checked",_5?"true":"false");
this._set("checked",_5);
},iconClass:"",role:"menuitemcheckbox",checkedChar:"&#10003;",onChange:function(){
},_onClick:function(_6){
if(!this.disabled){
this.set("checked",!this.checked);
this.onChange(this.checked);
}
this.onClick(_6);
}});
});


;define("dojo/i18n",["require","./_base/kernel"],function(_1,_2){
var _3="."+_2.locale.replace(/-/,"_");
function _4(_5,_6,_7){
_7=_7?_7.toLowerCase():_2.locale;
_5=_5.replace(/\./g,"/");
_6=_6.replace(/\./g,"/");
return (/root/i.test(_7))?(_5+"/nls/"+_6):(_5+"/nls/"+_7+"/"+_6);
};
function _8(_9,_a,_b){
_b=_b?_b.toLowerCase():_2.locale;
var _c=_9+".nls."+_a,_d="dojo/i18n!"+_c.replace(/\./g,"/");
return _e(_c,"."+_b.replace(/-/,"_"))||define._modules[_d];
};
_2.i18n={normalizeLocale:function(_f){
var _10=_f?_f.toLowerCase():_2.locale;
return _10=="root"?"ROOT":_10;
},_preloadLocalizations:function(){
_2.deprecated("Connections doesn't support the 'dojo-preload-i18n-Api', we're providing this stub as a convenience.","5.0");
},getLocalization:function(_11,_12,_13){
return _e(_11+".nls."+_12,_13?"."+_13.replace(/-/,"_"):_3)||_14(_11,_12);
},requireLocalization:function(_15,_16,_17){
_2.deprecated("dojo.requireLocalization()","Deprecated. Use dojo/i18n! plugin plugin instead.","2.0");
_17=_17?_17.toLowerCase():_2.locale;
var _18=!_8(_15,_16,_17);
if(_18){
net.jazz.ajax.xdloader.load_sync(_15+".nls."+_17+"."+_16,true);
}
}};
function _e(_19,_1a){
var _1b,_1c=_2.getObject(_19),_1d=_1a.substr(1).split("_");
for(var i=_1d.length;i>0;i--){
var loc=_1d.slice(0,i).join("_");
if(_2.exists(loc,_1c)){
_1b=_1c[loc];
break;
}
}
if(!_1b&&_1c&&_1c.ROOT){
_1b=_1c.ROOT;
}
return _1b;
};
function _14(_1e,_1f){
_1e=_1e.replace(/\./g,"/");
var i=_1f.lastIndexOf("/")+1;
return _1("dojo/i18n!"+_1e+"/"+_1f.substring(0,i)+"nls/"+_1f.substring(i));
};
_2.requireLocalization=_2.i18n.requireLocalization;
_2.getLocalization=_2.i18n.getLocalization;
return {normalizeLocale:_2.i18n.normalizeLocale,getLocalization:_14};
});


;define("dojo/dnd/common",["../sniff","../_base/kernel","../_base/lang","../dom"],function(_1,_2,_3,_4){
var _5=_3.getObject("dojo.dnd",true);
_5.getCopyKeyState=function(_6){
return _6[_1("mac")?"metaKey":"ctrlKey"];
};
_5._uniqueId=0;
_5.getUniqueId=function(){
var id;
do{
id=_2._scopeName+"Unique"+(++_5._uniqueId);
}while(_4.byId(id));
return id;
};
_5._empty={};
_5.isFormElement=function(e){
var t=e.target;
if(t.nodeType==3){
t=t.parentNode;
}
return " a button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;
};
return _5;
});


;define("dojo/dnd/autoscroll",["../_base/lang","../sniff","../_base/window","../dom-geometry","../dom-style","../window"],function(_1,_2,_3,_4,_5,_6){
var _7={};
_1.setObject("dojo.dnd.autoscroll",_7);
_7.getViewport=_6.getBox;
_7.V_TRIGGER_AUTOSCROLL=32;
_7.H_TRIGGER_AUTOSCROLL=32;
_7.V_AUTOSCROLL_VALUE=16;
_7.H_AUTOSCROLL_VALUE=16;
var _8,_9=_3.doc,_a=Infinity,_b=Infinity;
_7.autoScrollStart=function(d){
_9=d;
_8=_6.getBox(_9);
var _c=_3.body(_9).parentNode;
_a=Math.max(_c.scrollHeight-_8.h,0);
_b=Math.max(_c.scrollWidth-_8.w,0);
};
_7.autoScroll=function(e){
var v=_8||_6.getBox(_9),_d=_3.body(_9).parentNode,dx=0,dy=0;
if(e.clientX<_7.H_TRIGGER_AUTOSCROLL){
dx=-_7.H_AUTOSCROLL_VALUE;
}else{
if(e.clientX>v.w-_7.H_TRIGGER_AUTOSCROLL){
dx=Math.min(_7.H_AUTOSCROLL_VALUE,_b-_d.scrollLeft);
}
}
if(e.clientY<_7.V_TRIGGER_AUTOSCROLL){
dy=-_7.V_AUTOSCROLL_VALUE;
}else{
if(e.clientY>v.h-_7.V_TRIGGER_AUTOSCROLL){
dy=Math.min(_7.V_AUTOSCROLL_VALUE,_a-_d.scrollTop);
}
}
window.scrollBy(dx,dy);
};
_7._validNodes={"div":1,"p":1,"td":1};
_7._validOverflow={"auto":1,"scroll":1};
_7.autoScrollNodes=function(e){
var b,t,w,h,rx,ry,dx=0,dy=0,_e,_f;
for(var n=e.target;n;){
if(n.nodeType==1&&(n.tagName.toLowerCase() in _7._validNodes)){
var s=_5.getComputedStyle(n),_10=(s.overflow.toLowerCase() in _7._validOverflow),_11=(s.overflowX.toLowerCase() in _7._validOverflow),_12=(s.overflowY.toLowerCase() in _7._validOverflow);
if(_10||_11||_12){
b=_4.getContentBox(n,s);
t=_4.position(n,true);
}
if(_10||_11){
w=Math.min(_7.H_TRIGGER_AUTOSCROLL,b.w/2);
rx=e.pageX-t.x;
if(_2("webkit")||_2("opera")){
rx+=_3.body().scrollLeft;
}
dx=0;
if(rx>0&&rx<b.w){
if(rx<w){
dx=-w;
}else{
if(rx>b.w-w){
dx=w;
}
}
_e=n.scrollLeft;
n.scrollLeft=n.scrollLeft+dx;
}
}
if(_10||_12){
h=Math.min(_7.V_TRIGGER_AUTOSCROLL,b.h/2);
ry=e.pageY-t.y;
if(_2("webkit")||_2("opera")){
ry+=_3.body().scrollTop;
}
dy=0;
if(ry>0&&ry<b.h){
if(ry<h){
dy=-h;
}else{
if(ry>b.h-h){
dy=h;
}
}
_f=n.scrollTop;
n.scrollTop=n.scrollTop+dy;
}
}
if(dx||dy){
return;
}
}
try{
n=n.parentNode;
}
catch(x){
n=null;
}
}
_7.autoScroll(e);
};
return _7;
});


;define("dojo/dnd/Mover",["../_base/array","../_base/declare","../_base/lang","../sniff","../_base/window","../dom","../dom-geometry","../dom-style","../Evented","../on","../touch","./common","./autoscroll"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,on,_a,_b,_c){
return _2("dojo.dnd.Mover",[_9],{constructor:function(_d,e,_e){
this.node=_6.byId(_d);
this.marginBox={l:e.pageX,t:e.pageY};
this.mouseButton=e.button;
var h=(this.host=_e),d=_d.ownerDocument;
function _f(e){
e.preventDefault();
e.stopPropagation();
};
this.events=[on(d,_a.move,_3.hitch(this,"onFirstMove")),on(d,_a.move,_3.hitch(this,"onMouseMove")),on(d,_a.release,_3.hitch(this,"onMouseUp")),on(d,"dragstart",_f),on(d.body,"selectstart",_f)];
_c.autoScrollStart(d);
if(h&&h.onMoveStart){
h.onMoveStart(this);
}
},onMouseMove:function(e){
_c.autoScroll(e);
var m=this.marginBox;
this.host.onMove(this,{l:m.l+e.pageX,t:m.t+e.pageY},e);
e.preventDefault();
e.stopPropagation();
},onMouseUp:function(e){
if(_4("webkit")&&_4("mac")&&this.mouseButton==2?e.button==0:this.mouseButton==e.button){
this.destroy();
}
e.preventDefault();
e.stopPropagation();
},onFirstMove:function(e){
var s=this.node.style,l,t,h=this.host;
switch(s.position){
case "relative":
case "absolute":
l=Math.round(parseFloat(s.left))||0;
t=Math.round(parseFloat(s.top))||0;
break;
default:
s.position="absolute";
var m=_7.getMarginBox(this.node);
var b=_5.doc.body;
var bs=_8.getComputedStyle(b);
var bm=_7.getMarginBox(b,bs);
var bc=_7.getContentBox(b,bs);
l=m.l-(bc.l-bm.l);
t=m.t-(bc.t-bm.t);
break;
}
this.marginBox.l=l-this.marginBox.l;
this.marginBox.t=t-this.marginBox.t;
if(h&&h.onFirstMove){
h.onFirstMove(this,e);
}
this.events.shift().remove();
},destroy:function(){
_1.forEach(this.events,function(_10){
_10.remove();
});
var h=this.host;
if(h&&h.onMoveStop){
h.onMoveStop(this);
}
this.events=this.node=this.host=null;
}});
});


;define("dojo/dnd/Moveable",["../_base/array","../_base/declare","../_base/lang","../dom","../dom-class","../Evented","../on","../topic","../touch","./common","./Mover","../_base/window"],function(_1,_2,_3,_4,_5,_6,on,_7,_8,_9,_a,_b){
var _c=_2("dojo.dnd.Moveable",[_6],{handle:"",delay:0,skip:false,constructor:function(_d,_e){
this.node=_4.byId(_d);
if(!_e){
_e={};
}
this.handle=_e.handle?_4.byId(_e.handle):null;
if(!this.handle){
this.handle=this.node;
}
this.delay=_e.delay>0?_e.delay:0;
this.skip=_e.skip;
this.mover=_e.mover?_e.mover:_a;
this.events=[on(this.handle,_8.press,_3.hitch(this,"onMouseDown")),on(this.handle,"dragstart",_3.hitch(this,"onSelectStart")),on(this.handle,"selectstart",_3.hitch(this,"onSelectStart"))];
},markupFactory:function(_f,_10,_11){
return new _11(_10,_f);
},destroy:function(){
_1.forEach(this.events,function(_12){
_12.remove();
});
this.events=this.node=this.handle=null;
},onMouseDown:function(e){
if(this.skip&&_9.isFormElement(e)){
return;
}
if(this.delay){
this.events.push(on(this.handle,_8.move,_3.hitch(this,"onMouseMove")),on(this.handle,_8.release,_3.hitch(this,"onMouseUp")));
this._lastX=e.pageX;
this._lastY=e.pageY;
}else{
this.onDragDetected(e);
}
e.stopPropagation();
e.preventDefault();
},onMouseMove:function(e){
if(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay){
this.onMouseUp(e);
this.onDragDetected(e);
}
e.stopPropagation();
e.preventDefault();
},onMouseUp:function(e){
for(var i=0;i<2;++i){
this.events.pop().remove();
}
e.stopPropagation();
e.preventDefault();
},onSelectStart:function(e){
if(!this.skip||!_9.isFormElement(e)){
e.stopPropagation();
e.preventDefault();
}
},onDragDetected:function(e){
new this.mover(this.node,e,this);
},onMoveStart:function(_13){
_7.publish("/dnd/move/start",_13);
_5.add(_b.body(),"dojoMove");
_5.add(this.node,"dojoMoveItem");
},onMoveStop:function(_14){
_7.publish("/dnd/move/stop",_14);
_5.remove(_b.body(),"dojoMove");
_5.remove(this.node,"dojoMoveItem");
},onFirstMove:function(){
},onMove:function(_15,_16){
this.onMoving(_15,_16);
var s=_15.node.style;
s.left=_16.l+"px";
s.top=_16.t+"px";
this.onMoved(_15,_16);
},onMoving:function(){
},onMoved:function(){
}});
return _c;
});


;define("dojo/dnd/TimedMoveable",["../_base/declare","./Moveable"],function(_1,_2){
var _3=_2.prototype.onMove;
return _1("dojo.dnd.TimedMoveable",_2,{timeout:40,constructor:function(_4,_5){
if(!_5){
_5={};
}
if(_5.timeout&&typeof _5.timeout=="number"&&_5.timeout>=0){
this.timeout=_5.timeout;
}
},onMoveStop:function(_6){
if(_6._timer){
clearTimeout(_6._timer);
_3.call(this,_6,_6._leftTop);
}
_2.prototype.onMoveStop.apply(this,arguments);
},onMove:function(_7,_8){
_7._leftTop=_8;
if(!_7._timer){
var _9=this;
_7._timer=setTimeout(function(){
_7._timer=null;
_3.call(_9,_7,_7._leftTop);
},this.timeout);
}
}});
});


;define("dijit/form/_FormMixin",["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/window"],function(_1,_2,_3,_4,on,_5){
return _2("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(_6){
var _7=[];
_1.forEach(_6||this.getChildren(),function(_8){
if("value" in _8){
_7.push(_8);
}else{
_7=_7.concat(this._getDescendantFormWidgets(_8.getChildren()));
}
},this);
return _7;
},reset:function(){
_1.forEach(this._getDescendantFormWidgets(),function(_9){
if(_9.reset){
_9.reset();
}
});
},validate:function(){
var _a=false;
return _1.every(_1.map(this._getDescendantFormWidgets(),function(_b){
_b._hasBeenBlurred=true;
var _c=_b.disabled||!_b.validate||_b.validate();
if(!_c&&!_a){
_5.scrollIntoView(_b.containerNode||_b.domNode);
_b.focus();
_a=true;
}
return _c;
}),function(_d){
return _d;
});
},setValues:function(_e){
_3.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");
return this.set("value",_e);
},_setValueAttr:function(_f){
var map={};
_1.forEach(this._getDescendantFormWidgets(),function(_10){
if(!_10.name){
return;
}
var _11=map[_10.name]||(map[_10.name]=[]);
_11.push(_10);
});
for(var _12 in map){
if(!map.hasOwnProperty(_12)){
continue;
}
var _13=map[_12],_14=_4.getObject(_12,false,_f);
if(_14===undefined){
continue;
}
_14=[].concat(_14);
if(typeof _13[0].checked=="boolean"){
_1.forEach(_13,function(w){
w.set("value",_1.indexOf(_14,w._get("value"))!=-1);
});
}else{
if(_13[0].multiple){
_13[0].set("value",_14);
}else{
_1.forEach(_13,function(w,i){
w.set("value",_14[i]);
});
}
}
}
},getValues:function(){
_3.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");
return this.get("value");
},_getValueAttr:function(){
var obj={};
_1.forEach(this._getDescendantFormWidgets(),function(_15){
var _16=_15.name;
if(!_16||_15.disabled){
return;
}
var _17=_15.get("value");
if(typeof _15.checked=="boolean"){
if(/Radio/.test(_15.declaredClass)){
if(_17!==false){
_4.setObject(_16,_17,obj);
}else{
_17=_4.getObject(_16,false,obj);
if(_17===undefined){
_4.setObject(_16,null,obj);
}
}
}else{
var ary=_4.getObject(_16,false,obj);
if(!ary){
ary=[];
_4.setObject(_16,ary,obj);
}
if(_17!==false){
ary.push(_17);
}
}
}else{
var _18=_4.getObject(_16,false,obj);
if(typeof _18!="undefined"){
if(_4.isArray(_18)){
_18.push(_17);
}else{
_4.setObject(_16,[_18,_17],obj);
}
}else{
_4.setObject(_16,_17,obj);
}
}
});
return obj;
},isValid:function(){
return this.state=="";
},onValidStateChange:function(){
},_getState:function(){
var _19=_1.map(this._descendants,function(w){
return w.get("state")||"";
});
return _1.indexOf(_19,"Error")>=0?"Error":_1.indexOf(_19,"Incomplete")>=0?"Incomplete":"";
},disconnectChildren:function(){
},connectChildren:function(_1a){
this._descendants=this._getDescendantFormWidgets();
_1.forEach(this._descendants,function(_1b){
if(!_1b._started){
_1b.startup();
}
});
if(!_1a){
this._onChildChange();
}
},_onChildChange:function(_1c){
if(!_1c||_1c=="state"||_1c=="disabled"){
this._set("state",this._getState());
}
if(!_1c||_1c=="value"||_1c=="disabled"||_1c=="checked"){
if(this._onChangeDelayTimer){
this._onChangeDelayTimer.remove();
}
this._onChangeDelayTimer=this.defer(function(){
delete this._onChangeDelayTimer;
this._set("value",this.get("value"));
},10);
}
},startup:function(){
this.inherited(arguments);
this._descendants=this._getDescendantFormWidgets();
this.value=this.get("value");
this.state=this._getState();
var _1d=this;
this.own(on(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(evt){
if(evt.target==_1d.domNode){
return;
}
_1d._onChildChange(evt.type.replace("attrmodified-",""));
}));
this.watch("state",function(_1e,_1f,_20){
this.onValidStateChange(_20=="");
});
},destroy:function(){
this.inherited(arguments);
}});
});


;define("dijit/_DialogMixin",["dojo/_base/declare","./a11y"],function(_1,_2){
return _1("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){
},onCancel:function(){
},onExecute:function(){
},_onSubmit:function(){
this.onExecute();
this.execute(this.get("value"));
},_getFocusItems:function(){
var _3=_2._getTabNavigable(this.domNode);
this._firstFocusItem=_3.lowest||_3.first||this.closeButtonNode||this.domNode;
this._lastFocusItem=_3.last||_3.highest||this._firstFocusItem;
}});
});


;define("dijit/DialogUnderlay",["dojo/_base/declare","dojo/_base/lang","dojo/aspect","dojo/dom-attr","dojo/dom-style","dojo/on","dojo/window","./_Widget","./_TemplatedMixin","./BackgroundIframe","./Viewport","./main"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9,_a,_b){
var _c=_1("dijit.DialogUnderlay",[_7,_8],{templateString:"<div class='dijitDialogUnderlayWrapper'><div class='dijitDialogUnderlay' tabIndex='-1' data-dojo-attach-point='node'></div></div>",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(id){
_4.set(this.node,"id",id+"_underlay");
this._set("dialogId",id);
},_setClassAttr:function(_d){
this.node.className="dijitDialogUnderlay "+_d;
this._set("class",_d);
},postCreate:function(){
this.ownerDocumentBody.appendChild(this.domNode);
this.own(on(this.domNode,"keydown",_2.hitch(this,"_onKeyDown")));
this.inherited(arguments);
},layout:function(){
var is=this.node.style,os=this.domNode.style;
os.display="none";
var _e=_6.getBox(this.ownerDocument);
os.top=_e.t+"px";
os.left=_e.l+"px";
is.width=_e.w+"px";
is.height=_e.h+"px";
os.display="block";
},show:function(){
this.domNode.style.display="block";
this.open=true;
this.layout();
this.bgIframe=new _9(this.domNode);
var _f=_6.get(this.ownerDocument);
this._modalConnects=[_a.on("resize",_2.hitch(this,"layout")),on(_f,"scroll",_2.hitch(this,"layout"))];
},hide:function(){
this.bgIframe.destroy();
delete this.bgIframe;
this.domNode.style.display="none";
while(this._modalConnects.length){
(this._modalConnects.pop()).remove();
}
this.open=false;
},destroy:function(){
while(this._modalConnects.length){
(this._modalConnects.pop()).remove();
}
this.inherited(arguments);
},_onKeyDown:function(){
}});
_c.show=function(_10,_11){
var _12=_c._singleton;
if(!_12||_12._destroyed){
_12=_b._underlay=_c._singleton=new _c(_10);
}else{
if(_10){
_12.set(_10);
}
}
_5.set(_12.domNode,"zIndex",_11);
if(!_12.open){
_12.show();
}
};
_c.hide=function(){
var _13=_c._singleton;
if(_13&&!_13._destroyed){
_13.hide();
}
};
return _c;
});


;define("dijit/_Container",["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],function(_1,_2,_3,_4){
return _2("dijit._Container",null,{buildRendering:function(){
this.inherited(arguments);
if(!this.containerNode){
this.containerNode=this.domNode;
}
},addChild:function(_5,_6){
var _7=this.containerNode;
if(_6>0){
_7=_7.firstChild;
while(_6>0){
if(_7.nodeType==1){
_6--;
}
_7=_7.nextSibling;
}
if(_7){
_6="before";
}else{
_7=this.containerNode;
_6="last";
}
}
_3.place(_5.domNode,_7,_6);
if(this._started&&!_5._started){
_5.startup();
}
},removeChild:function(_8){
if(typeof _8=="number"){
_8=this.getChildren()[_8];
}
if(_8){
var _9=_8.domNode;
if(_9&&_9.parentNode){
_9.parentNode.removeChild(_9);
}
}
},hasChildren:function(){
return this.getChildren().length>0;
},_getSiblingOfChild:function(_a,_b){
var _c=this.getChildren(),_d=_1.indexOf(_c,_a);
return _c[_d+_b];
},getIndexOfChild:function(_e){
return _1.indexOf(this.getChildren(),_e);
}});
});


;define("dijit/layout/utils",["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],function(_1,_2,_3,_4,_5){
function _6(_7){
return _7.substring(0,1).toUpperCase()+_7.substring(1);
};
function _8(_9,_a){
var _b=_9.resize?_9.resize(_a):_3.setMarginBox(_9.domNode,_a);
if(_b){
_5.mixin(_9,_b);
}else{
_5.mixin(_9,_3.getMarginBox(_9.domNode));
_5.mixin(_9,_a);
}
};
var _c={marginBox2contentBox:function(_d,mb){
var cs=_4.getComputedStyle(_d);
var me=_3.getMarginExtents(_d,cs);
var pb=_3.getPadBorderExtents(_d,cs);
return {l:_4.toPixelValue(_d,cs.paddingLeft),t:_4.toPixelValue(_d,cs.paddingTop),w:mb.w-(me.w+pb.w),h:mb.h-(me.h+pb.h)};
},layoutChildren:function(_e,_f,_10,_11,_12){
_f=_5.mixin({},_f);
_2.add(_e,"dijitLayoutContainer");
_10=_1.filter(_10,function(_13){
return _13.region!="center"&&_13.layoutAlign!="client";
}).concat(_1.filter(_10,function(_14){
return _14.region=="center"||_14.layoutAlign=="client";
}));
_1.forEach(_10,function(_15){
var elm=_15.domNode,pos=(_15.region||_15.layoutAlign);
if(!pos){
throw new Error("No region setting for "+_15.id);
}
var _16=elm.style;
_16.left=_f.l+"px";
_16.top=_f.t+"px";
_16.position="absolute";
_2.add(elm,"dijitAlign"+_6(pos));
var _17={};
if(_11&&_11==_15.id){
_17[_15.region=="top"||_15.region=="bottom"?"h":"w"]=_12;
}
if(pos=="leading"){
pos=_15.isLeftToRight()?"left":"right";
}
if(pos=="trailing"){
pos=_15.isLeftToRight()?"right":"left";
}
if(pos=="top"||pos=="bottom"){
_17.w=_f.w;
_8(_15,_17);
_f.h-=_15.h;
if(pos=="top"){
_f.t+=_15.h;
}else{
_16.top=_f.t+_f.h+"px";
}
}else{
if(pos=="left"||pos=="right"){
_17.h=_f.h;
_8(_15,_17);
_f.w-=_15.w;
if(pos=="left"){
_f.l+=_15.w;
}else{
_16.left=_f.l+_f.w+"px";
}
}else{
if(pos=="client"||pos=="center"){
_8(_15,_f);
}
}
}
});
}};
_5.setObject("dijit.layout.utils",_c);
return _c;
});


;define("dijit/layout/_ContentPaneResizeMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang","dojo/query","../registry","../Viewport","./utils"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
return _2("dijit.layout._ContentPaneResizeMixin",null,{doLayout:true,isLayoutContainer:true,startup:function(){
if(this._started){
return;
}
var _b=this.getParent();
this._childOfLayoutWidget=_b&&_b.isLayoutContainer;
this._needLayout=!this._childOfLayoutWidget;
this.inherited(arguments);
if(this._isShown()){
this._onShow();
}
if(!this._childOfLayoutWidget){
this.own(_9.on("resize",_6.hitch(this,"resize")));
}
},_checkIfSingleChild:function(){
if(!this.doLayout){
return;
}
var _c=[],_d=false;
_7("> *",this.containerNode).some(function(_e){
var _f=_8.byNode(_e);
if(_f&&_f.resize){
_c.push(_f);
}else{
if(!/script|link|style/i.test(_e.nodeName)&&_e.offsetHeight){
_d=true;
}
}
});
this._singleChild=_c.length==1&&!_d?_c[0]:null;
_3.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild);
},resize:function(_10,_11){
this._resizeCalled=true;
this._scheduleLayout(_10,_11);
},_scheduleLayout:function(_12,_13){
if(this._isShown()){
this._layout(_12,_13);
}else{
this._needLayout=true;
this._changeSize=_12;
this._resultSize=_13;
}
},_layout:function(_14,_15){
delete this._needLayout;
if(!this._wasShown&&this.open!==false){
this._onShow();
}
if(_14){
_4.setMarginBox(this.domNode,_14);
}
var cn=this.containerNode;
if(cn===this.domNode){
var mb=_15||{};
_6.mixin(mb,_14||{});
if(!("h" in mb)||!("w" in mb)){
mb=_6.mixin(_4.getMarginBox(cn),mb);
}
this._contentBox=_a.marginBox2contentBox(cn,mb);
}else{
this._contentBox=_4.getContentBox(cn);
}
this._layoutChildren();
},_layoutChildren:function(){
this._checkIfSingleChild();
if(this._singleChild&&this._singleChild.resize){
var cb=this._contentBox||_4.getContentBox(this.containerNode);
this._singleChild.resize({w:cb.w,h:cb.h});
}else{
var _16=this.getChildren(),_17,i=0;
while(_17=_16[i++]){
if(_17.resize){
_17.resize();
}
}
}
},_isShown:function(){
if(this._childOfLayoutWidget){
if(this._resizeCalled&&"open" in this){
return this.open;
}
return this._resizeCalled;
}else{
if("open" in this){
return this.open;
}else{
var _18=this.domNode,_19=this.domNode.parentNode;
return (_18.style.display!="none")&&(_18.style.visibility!="hidden")&&!_3.contains(_18,"dijitHidden")&&_19&&_19.style&&(_19.style.display!="none");
}
}
},_onShow:function(){
this._wasShown=true;
if(this._needLayout){
this._layout(this._changeSize,this._resultSize);
}
this.inherited(arguments);
}});
});


;define("dojo/promise/all",["../_base/array","../Deferred","../when"],function(_1,_2,_3){
"use strict";
var _4=_1.some;
return function all(_5){
var _6,_1;
if(_5 instanceof Array){
_1=_5;
}else{
if(_5&&typeof _5==="object"){
_6=_5;
}
}
var _7;
var _8=[];
if(_6){
_1=[];
for(var _9 in _6){
if(Object.hasOwnProperty.call(_6,_9)){
_8.push(_9);
_1.push(_6[_9]);
}
}
_7={};
}else{
if(_1){
_7=[];
}
}
if(!_1||!_1.length){
return new _2().resolve(_7);
}
var _a=new _2();
_a.promise.always(function(){
_7=_8=null;
});
var _b=_1.length;
_4(_1,function(_c,_d){
if(!_6){
_8.push(_d);
}
_3(_c,function(_e){
if(!_a.isFulfilled()){
_7[_8[_d]]=_e;
if(--_b===0){
_a.resolve(_7);
}
}
},_a.reject);
return _a.isFulfilled();
});
return _a.promise;
};
});


;define("dojo/date/stamp",["../_base/lang","../_base/array"],function(_1,_2){
var _3={};
_1.setObject("dojo.date.stamp",_3);
_3.fromISOString=function(_4,_5){
if(!_3._isoRegExp){
_3._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/;
}
var _6=_3._isoRegExp.exec(_4),_7=null;
if(_6){
_6.shift();
if(_6[1]){
_6[1]--;
}
if(_6[6]){
_6[6]*=1000;
}
if(_5){
_5=new Date(_5);
_2.forEach(_2.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(_8){
return _5["get"+_8]();
}),function(_9,_a){
_6[_a]=_6[_a]||_9;
});
}
_7=new Date(_6[0]||1970,_6[1]||0,_6[2]||1,_6[3]||0,_6[4]||0,_6[5]||0,_6[6]||0);
if(_6[0]<100){
_7.setFullYear(_6[0]||1970);
}
var _b=0,_c=_6[7]&&_6[7].charAt(0);
if(_c!="Z"){
_b=((_6[8]||0)*60)+(Number(_6[9])||0);
if(_c!="-"){
_b*=-1;
}
}
if(_c){
_b-=_7.getTimezoneOffset();
}
if(_b){
_7.setTime(_7.getTime()+_b*60000);
}
}
return _7;
};
_3.toISOString=function(_d,_e){
var _f=function(n){
return (n<10)?"0"+n:n;
};
_e=_e||{};
var _10=[],_11=_e.zulu?"getUTC":"get",_12="";
if(_e.selector!="time"){
var _13=_d[_11+"FullYear"]();
_12=["0000".substr((_13+"").length)+_13,_f(_d[_11+"Month"]()+1),_f(_d[_11+"Date"]())].join("-");
}
_10.push(_12);
if(_e.selector!="date"){
var _14=[_f(_d[_11+"Hours"]()),_f(_d[_11+"Minutes"]()),_f(_d[_11+"Seconds"]())].join(":");
var _15=_d[_11+"Milliseconds"]();
if(_e.milliseconds){
_14+="."+(_15<100?"0":"")+_f(_15);
}
if(_e.zulu){
_14+="Z";
}else{
if(_e.selector!="time"){
var _16=_d.getTimezoneOffset();
var _17=Math.abs(_16);
_14+=(_16>0?"-":"+")+_f(Math.floor(_17/60))+":"+_f(_17%60);
}
}
_10.push(_14);
}
return _10.join("T");
};
return _3;
});


;define("dojo/parser",["require","./_base/kernel","./_base/lang","./_base/array","./_base/config","./dom","./_base/window","./_base/url","./aspect","./promise/all","./date/stamp","./Deferred","./has","./query","./on","./ready"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){
new Date("X");
function _11(_12){
return eval("("+_12+")");
};
var _13=0;
_9.after(_3,"extend",function(){
_13++;
},true);
function _14(_15){
var map=_15._nameCaseMap,_16=_15.prototype;
if(!map||map._extendCnt<_13){
map=_15._nameCaseMap={};
for(var _17 in _16){
if(_17.charAt(0)==="_"){
continue;
}
map[_17.toLowerCase()]=_17;
}
map._extendCnt=_13;
}
return map;
};
var _18={};
function _19(_1a,_1b){
var ts=_1a.join();
if(!_18[ts]){
var _1c=[];
for(var i=0,l=_1a.length;i<l;i++){
var t=_1a[i];
_1c[_1c.length]=(_18[t]=_18[t]||(_3.getObject(t)||(~t.indexOf("/")&&(_1b?_1b(t):_1(t)))));
}
var _1d=_1c.shift();
_18[ts]=_1c.length?(_1d.createSubclass?_1d.createSubclass(_1c):_1d.extend.apply(_1d,_1c)):_1d;
}
return _18[ts];
};
var _1e={_clearCache:function(){
_13++;
_18={};
},_functionFromScript:function(_1f,_20){
var _21="",_22="",_23=(_1f.getAttribute(_20+"args")||_1f.getAttribute("args")),_24=_1f.getAttribute("with");
var _25=(_23||"").split(/\s*,\s*/);
if(_24&&_24.length){
_4.forEach(_24.split(/\s*,\s*/),function(_26){
_21+="with("+_26+"){";
_22+="}";
});
}
return new Function(_25,_21+_1f.innerHTML+_22);
},instantiate:function(_27,_28,_29){
_28=_28||{};
_29=_29||{};
var _2a=(_29.scope||_2._scopeName)+"Type",_2b="data-"+(_29.scope||_2._scopeName)+"-",_2c=_2b+"type",_2d=_2b+"mixins";
var _2e=[];
_4.forEach(_27,function(_2f){
var _30=_2a in _28?_28[_2a]:_2f.getAttribute(_2c)||_2f.getAttribute(_2a);
if(_30){
var _31=_2f.getAttribute(_2d),_32=_31?[_30].concat(_31.split(/\s*,\s*/)):[_30];
_2e.push({node:_2f,types:_32});
}
});
return this._instantiate(_2e,_28,_29);
},_instantiate:function(_33,_34,_35,_36){
var _37=_4.map(_33,function(obj){
var _38=obj.ctor||_19(obj.types,_35.contextRequire);
if(!_38){
throw new Error("Unable to resolve constructor for: '"+obj.types.join()+"'");
}
return this.construct(_38,obj.node,_34,_35,obj.scripts,obj.inherited);
},this);
function _39(_3a){
if(!_34._started&&!_35.noStart){
_4.forEach(_3a,function(_3b){
if(typeof _3b.startup==="function"&&!_3b._started){
_3b.startup();
}
});
}
return _3a;
};
if(_36){
return _a(_37).then(_39);
}else{
return _39(_37);
}
},construct:function(_3c,_3d,_3e,_3f,_40,_41){
var _42=_3c&&_3c.prototype;
_3f=_3f||{};
var _43={};
if(_3f.defaults){
_3.mixin(_43,_3f.defaults);
}
if(_41){
_3.mixin(_43,_41);
}
var _44;
if(_d("dom-attributes-explicit")){
_44=_3d.attributes;
}else{
if(_d("dom-attributes-specified-flag")){
_44=_4.filter(_3d.attributes,function(a){
return a.specified;
});
}else{
var _45=/^input$|^img$/i.test(_3d.nodeName)?_3d:_3d.cloneNode(false),_46=_45.outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,"");
_44=_4.map(_46.split(/\s+/),function(_47){
var _48=_47.toLowerCase();
return {name:_47,value:(_3d.nodeName=="LI"&&_47=="value")||_48=="enctype"?_3d.getAttribute(_48):_3d.getAttributeNode(_48).value};
});
}
}
var _49=_3f.scope||_2._scopeName,_4a="data-"+_49+"-",_4b={};
if(_49!=="dojo"){
_4b[_4a+"props"]="data-dojo-props";
_4b[_4a+"type"]="data-dojo-type";
_4b[_4a+"mixins"]="data-dojo-mixins";
_4b[_49+"type"]="dojoType";
_4b[_4a+"id"]="data-dojo-id";
}
var i=0,_4c,_4d=[],_4e,_4f;
while(_4c=_44[i++]){
var _50=_4c.name,_51=_50.toLowerCase(),_52=_4c.value;
switch(_4b[_51]||_51){
case "data-dojo-type":
case "dojotype":
case "data-dojo-mixins":
break;
case "data-dojo-props":
_4f=_52;
break;
case "data-dojo-id":
case "jsid":
_4e=_52;
break;
case "data-dojo-attach-point":
case "dojoattachpoint":
_43.dojoAttachPoint=_52;
break;
case "data-dojo-attach-event":
case "dojoattachevent":
_43.dojoAttachEvent=_52;
break;
case "class":
_43["class"]=_3d.className;
break;
case "style":
_43["style"]=_3d.style&&_3d.style.cssText;
break;
default:
if(!(_50 in _42)){
var map=_14(_3c);
_50=map[_51]||_50;
}
if(_50 in _42){
switch(typeof _42[_50]){
case "string":
_43[_50]=_52;
break;
case "number":
_43[_50]=_52.length?Number(_52):NaN;
break;
case "boolean":
_43[_50]=_52.toLowerCase()!="false";
break;
case "function":
if(_52===""||_52.search(/[^\w\.]+/i)!=-1){
_43[_50]=new Function(_52);
}else{
_43[_50]=_3.getObject(_52,false)||new Function(_52);
}
_4d.push(_50);
break;
default:
var _53=_42[_50];
_43[_50]=(_53&&"length" in _53)?(_52?_52.split(/\s*,\s*/):[]):(_53 instanceof Date)?(_52==""?new Date(""):_52=="now"?new Date():_b.fromISOString(_52)):(_53 instanceof _8)?(_2.baseUrl+_52):_11(_52);
}
}else{
_43[_50]=_52;
}
}
}
for(var j=0;j<_4d.length;j++){
var _54=_4d[j].toLowerCase();
_3d.removeAttribute(_54);
_3d[_54]=null;
}
if(_4f){
try{
_4f=_11.call(_3f.propsThis,"{"+_4f+"}");
_3.mixin(_43,_4f);
}
catch(e){
throw new Error(e.toString()+" in data-dojo-props='"+_4f+"'");
}
}
_3.mixin(_43,_3e);
if(!_40){
_40=(_3c&&(_3c._noScript||_42._noScript)?[]:_e("> script[type^='dojo/']",_3d));
}
var _55=[],_56=[],_57=[],ons=[];
if(_40){
for(i=0;i<_40.length;i++){
var _58=_40[i];
_3d.removeChild(_58);
var _59=(_58.getAttribute(_4a+"event")||_58.getAttribute("event")),_5a=_58.getAttribute(_4a+"prop"),_5b=_58.getAttribute(_4a+"method"),_5c=_58.getAttribute(_4a+"advice"),_5d=_58.getAttribute("type"),nf=this._functionFromScript(_58,_4a);
if(_59){
if(_5d=="dojo/connect"){
_55.push({method:_59,func:nf});
}else{
if(_5d=="dojo/on"){
ons.push({event:_59,func:nf});
}else{
_43[_59]=nf;
}
}
}else{
if(_5d=="dojo/aspect"){
_55.push({method:_5b,advice:_5c,func:nf});
}else{
if(_5d=="dojo/watch"){
_57.push({prop:_5a,func:nf});
}else{
_56.push(nf);
}
}
}
}
}
var _5e=_3c.markupFactory||_42.markupFactory;
var _5f=_5e?_5e(_43,_3d,_3c):new _3c(_43,_3d);
function _60(_61){
if(_4e){
_3.setObject(_4e,_61);
}
for(i=0;i<_55.length;i++){
_9[_55[i].advice||"after"](_61,_55[i].method,_3.hitch(_61,_55[i].func),true);
}
for(i=0;i<_56.length;i++){
_56[i].call(_61);
}
for(i=0;i<_57.length;i++){
_61.watch(_57[i].prop,_57[i].func);
}
for(i=0;i<ons.length;i++){
_f(_61,ons[i].event,ons[i].func);
}
return _61;
};
if(_5f.then){
return _5f.then(_60);
}else{
return _60(_5f);
}
},scan:function(_62,_63){
var _64=[],_65=[],_66={};
var _67=(_63.scope||_2._scopeName)+"Type",_68="data-"+(_63.scope||_2._scopeName)+"-",_69=_68+"type",_6a=_68+"textdir",_6b=_68+"mixins";
var _6c=_62.firstChild;
var _6d=_63.inherited;
if(!_6d){
function _6e(_6f,_70){
return (_6f.getAttribute&&_6f.getAttribute(_70))||(_6f.parentNode&&_6e(_6f.parentNode,_70));
};
_6d={dir:_6e(_62,"dir"),lang:_6e(_62,"lang"),textDir:_6e(_62,_6a)};
for(var key in _6d){
if(!_6d[key]){
delete _6d[key];
}
}
}
var _71={inherited:_6d};
var _72;
var _73;
function _74(_75){
if(!_75.inherited){
_75.inherited={};
var _76=_75.node,_77=_74(_75.parent);
var _78={dir:_76.getAttribute("dir")||_77.dir,lang:_76.getAttribute("lang")||_77.lang,textDir:_76.getAttribute(_6a)||_77.textDir};
for(var key in _78){
if(_78[key]){
_75.inherited[key]=_78[key];
}
}
}
return _75.inherited;
};
while(true){
if(!_6c){
if(!_71||!_71.node){
break;
}
_6c=_71.node.nextSibling;
_73=false;
_71=_71.parent;
_72=_71.scripts;
continue;
}
if(_6c.nodeType!=1){
_6c=_6c.nextSibling;
continue;
}
if(_72&&_6c.nodeName.toLowerCase()=="script"){
_79=_6c.getAttribute("type");
if(_79&&/^dojo\/\w/i.test(_79)){
_72.push(_6c);
}
_6c=_6c.nextSibling;
continue;
}
if(_73){
_6c=_6c.nextSibling;
continue;
}
var _79=_6c.getAttribute(_69)||_6c.getAttribute(_67);
var _7a=_6c.firstChild;
if(!_79&&(!_7a||(_7a.nodeType==3&&!_7a.nextSibling))){
_6c=_6c.nextSibling;
continue;
}
var _7b;
var _7c=null;
if(_79){
var _7d=_6c.getAttribute(_6b),_7e=_7d?[_79].concat(_7d.split(/\s*,\s*/)):[_79];
try{
_7c=_19(_7e,_63.contextRequire);
}
catch(e){
}
if(!_7c){
_4.forEach(_7e,function(t){
if(~t.indexOf("/")&&!_66[t]){
_66[t]=true;
_65[_65.length]=t;
}
});
}
var _7f=_7c&&!_7c.prototype._noScript?[]:null;
_7b={types:_7e,ctor:_7c,parent:_71,node:_6c,scripts:_7f};
_7b.inherited=_74(_7b);
_64.push(_7b);
}else{
_7b={node:_6c,scripts:_72,parent:_71};
}
_72=_7f;
_73=_6c.stopParser||(_7c&&_7c.prototype.stopParser&&!(_63.template));
_71=_7b;
_6c=_7a;
}
var d=new _c();
if(_65.length){
if(_d("dojo-debug-messages")){
console.warn("WARNING: Modules being Auto-Required: "+_65.join(", "));
}
var r=_63.contextRequire||_1;
r(_65,function(){
d.resolve(_4.filter(_64,function(_80){
if(!_80.ctor){
try{
_80.ctor=_19(_80.types,_63.contextRequire);
}
catch(e){
}
}
var _81=_80.parent;
while(_81&&!_81.types){
_81=_81.parent;
}
var _82=_80.ctor&&_80.ctor.prototype;
_80.instantiateChildren=!(_82&&_82.stopParser&&!(_63.template));
_80.instantiate=!_81||(_81.instantiate&&_81.instantiateChildren);
return _80.instantiate;
}));
});
}else{
d.resolve(_64);
}
return d.promise;
},_require:function(_83,_84){
var _85=_11("{"+_83.innerHTML+"}"),_86=[],_87=[],d=new _c();
var _88=(_84&&_84.contextRequire)||_1;
for(var _89 in _85){
_86.push(_89);
_87.push(_85[_89]);
}
_88(_87,function(){
for(var i=0;i<_86.length;i++){
_3.setObject(_86[i],arguments[i]);
}
d.resolve(arguments);
});
return d.promise;
},_scanAmd:function(_8a,_8b){
var _8c=new _c(),_8d=_8c.promise;
_8c.resolve(true);
var _8e=this;
_e("script[type='dojo/require']",_8a).forEach(function(_8f){
_8d=_8d.then(function(){
return _8e._require(_8f,_8b);
});
_8f.parentNode.removeChild(_8f);
});
return _8d;
},parse:function(_90,_91){
var _92;
if(!_91&&_90&&_90.rootNode){
_91=_90;
_92=_91.rootNode;
}else{
if(_90&&_3.isObject(_90)&&!("nodeType" in _90)){
_91=_90;
}else{
_92=_90;
}
}
_92=_92?_6.byId(_92):_7.body();
_91=_91||{};
var _93=_91.template?{template:true}:{},_94=[],_95=this;
var p=this._scanAmd(_92,_91).then(function(){
return _95.scan(_92,_91);
}).then(function(_96){
return _95._instantiate(_96,_93,_91,true);
}).then(function(_97){
return _94=_94.concat(_97);
}).otherwise(function(e){
console.error("dojo/parser::parse() error",e);
throw e;
});
_3.mixin(_94,p);
return _94;
}};
if(_d("extend-dojo")){
_2.parser=_1e;
}
if(_5.parseOnLoad){
_10(100,_1e,"parse");
}
return _1e;
});


;define("dojo/html",["./_base/kernel","./_base/lang","./_base/array","./_base/declare","./dom","./dom-construct","./parser"],function(_1,_2,_3,_4,_5,_6,_7){
var _8=0;
var _9={_secureForInnerHtml:function(_a){
return _a.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"");
},_emptyNode:_6.empty,_setNodeContent:function(_b,_c){
_6.empty(_b);
if(_c){
if(typeof _c=="string"){
_c=_6.toDom(_c,_b.ownerDocument);
}
if(!_c.nodeType&&_2.isArrayLike(_c)){
for(var _d=_c.length,i=0;i<_c.length;i=_d==_c.length?i+1:0){
_6.place(_c[i],_b,"last");
}
}else{
_6.place(_c,_b,"last");
}
}
return _b;
},_ContentSetter:_4("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:false,extractContent:false,parseContent:false,parserScope:_1._scopeName,startup:true,constructor:function(_e,_f){
_2.mixin(this,_e||{});
_f=this.node=_5.byId(this.node||_f);
if(!this.id){
this.id=["Setter",(_f)?_f.id||_f.tagName:"",_8++].join("_");
}
},set:function(_10,_11){
if(undefined!==_10){
this.content=_10;
}
if(_11){
this._mixin(_11);
}
this.onBegin();
this.setContent();
var ret=this.onEnd();
if(ret&&ret.then){
return ret;
}else{
return this.node;
}
},setContent:function(){
var _12=this.node;
if(!_12){
throw new Error(this.declaredClass+": setContent given no node");
}
try{
_12=_9._setNodeContent(_12,this.content);
}
catch(e){
var _13=this.onContentError(e);
try{
_12.innerHTML=_13;
}
catch(e){
console.error("Fatal "+this.declaredClass+".setContent could not change content due to "+e.message,e);
}
}
this.node=_12;
},empty:function(){
if(this.parseDeferred){
if(!this.parseDeferred.isResolved()){
this.parseDeferred.cancel();
}
delete this.parseDeferred;
}
if(this.parseResults&&this.parseResults.length){
_3.forEach(this.parseResults,function(w){
if(w.destroy){
w.destroy();
}
});
delete this.parseResults;
}
_6.empty(this.node);
},onBegin:function(){
var _14=this.content;
if(_2.isString(_14)){
if(this.cleanContent){
_14=_9._secureForInnerHtml(_14);
}
if(this.extractContent){
var _15=_14.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);
if(_15){
_14=_15[1];
}
}
}
this.empty();
this.content=_14;
return this.node;
},onEnd:function(){
if(this.parseContent){
this._parse();
}
return this.node;
},tearDown:function(){
delete this.parseResults;
delete this.parseDeferred;
delete this.node;
delete this.content;
},onContentError:function(err){
return "Error occurred setting content: "+err;
},onExecError:function(err){
return "Error occurred executing scripts: "+err;
},_mixin:function(_16){
var _17={},key;
for(key in _16){
if(key in _17){
continue;
}
this[key]=_16[key];
}
},_parse:function(){
var _18=this.node;
try{
var _19={};
_3.forEach(["dir","lang","textDir"],function(_1a){
if(this[_1a]){
_19[_1a]=this[_1a];
}
},this);
var _1b=this;
this.parseDeferred=_7.parse({rootNode:_18,noStart:!this.startup,inherited:_19,scope:this.parserScope}).then(function(_1c){
return _1b.parseResults=_1c;
},function(e){
_1b._onError("Content",e,"Error parsing in _ContentSetter#"+this.id);
});
}
catch(e){
this._onError("Content",e,"Error parsing in _ContentSetter#"+this.id);
}
},_onError:function(_1d,err,_1e){
var _1f=this["on"+_1d+"Error"].call(this,err);
if(_1e){
console.error(_1e,err);
}else{
if(_1f){
_9._setNodeContent(this.node,_1f,true);
}
}
}}),set:function(_20,_21,_22){
if(undefined==_21){
console.warn("dojo.html.set: no cont argument provided, using empty string");
_21="";
}
if(!_22){
return _9._setNodeContent(_20,_21,true);
}else{
var op=new _9._ContentSetter(_2.mixin(_22,{content:_21,node:_20}));
return op.set();
}
}};
_2.setObject("dojo.html",_9);
return _9;
});


;define("dojo/i18n!dijit/nls/loading", {"loadingState":"Loading...","errorState":"Sorry, an error occurred"});

;define("dijit/layout/ContentPane",["dojo/_base/kernel","dojo/_base/lang","../_Widget","../_Container","./_ContentPaneResizeMixin","dojo/string","dojo/html","dojo/i18n!../nls/loading","dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/_base/xhr","dojo/i18n","dojo/when"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11){
return _a("dijit.layout.ContentPane",[_3,_4,_5],{href:"",content:"",extractContent:false,parseOnLoad:true,parserScope:_1._scopeName,preventCache:false,preload:false,refreshOnShow:false,loadingMessage:"<span class='dijitContentPaneLoading'><span class='dijitInline dijitIconLoading'></span>${loadingState}</span>",errorMessage:"<span class='dijitContentPaneError'><span class='dijitInline dijitIconError'></span>${errorState}</span>",isLoaded:false,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:true,template:false,markupFactory:function(_12,_13,_14){
var _15=new _14(_12,_13);
return !_15.href&&_15._contentSetter&&_15._contentSetter.parseDeferred&&!_15._contentSetter.parseDeferred.isFulfilled()?_15._contentSetter.parseDeferred.then(function(){
return _15;
}):_15;
},create:function(_16,_17){
if((!_16||!_16.template)&&_17&&!("href" in _16)&&!("content" in _16)){
_17=_c.byId(_17);
var df=_17.ownerDocument.createDocumentFragment();
while(_17.firstChild){
df.appendChild(_17.firstChild);
}
_16=_2.delegate(_16,{content:df});
}
this.inherited(arguments,[_16,_17]);
},postMixInProperties:function(){
this.inherited(arguments);
var _18=_10.getLocalization("dijit","loading",this.lang);
this.loadingMessage=_6.substitute(this.loadingMessage,_18);
this.errorMessage=_6.substitute(this.errorMessage,_18);
},buildRendering:function(){
this.inherited(arguments);
if(!this.containerNode){
this.containerNode=this.domNode;
}
this.domNode.removeAttribute("title");
},startup:function(){
this.inherited(arguments);
if(this._contentSetter){
_9.forEach(this._contentSetter.parseResults,function(obj){
if(!obj._started&&!obj._destroyed&&_2.isFunction(obj.startup)){
obj.startup();
obj._started=true;
}
},this);
}
},_startChildren:function(){
_9.forEach(this.getChildren(),function(obj){
if(!obj._started&&!obj._destroyed&&_2.isFunction(obj.startup)){
obj.startup();
obj._started=true;
}
});
if(this._contentSetter){
_9.forEach(this._contentSetter.parseResults,function(obj){
if(!obj._started&&!obj._destroyed&&_2.isFunction(obj.startup)){
obj.startup();
obj._started=true;
}
},this);
}
},setHref:function(_19){
_1.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.","","2.0");
return this.set("href",_19);
},_setHrefAttr:function(_1a){
this.cancel();
this.onLoadDeferred=new _b(_2.hitch(this,"cancel"));
this.onLoadDeferred.then(_2.hitch(this,"onLoad"));
this._set("href",_1a);
if(this.preload||(this._created&&this._isShown())){
this._load();
}else{
this._hrefChanged=true;
}
return this.onLoadDeferred;
},setContent:function(_1b){
_1.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");
this.set("content",_1b);
},_setContentAttr:function(_1c){
this._set("href","");
this.cancel();
this.onLoadDeferred=new _b(_2.hitch(this,"cancel"));
if(this._created){
this.onLoadDeferred.then(_2.hitch(this,"onLoad"));
}
this._setContent(_1c||"");
this._isDownloaded=false;
return this.onLoadDeferred;
},_getContentAttr:function(){
return this.containerNode.innerHTML;
},cancel:function(){
if(this._xhrDfd&&(this._xhrDfd.fired==-1)){
this._xhrDfd.cancel();
}
delete this._xhrDfd;
this.onLoadDeferred=null;
},destroy:function(){
this.cancel();
this.inherited(arguments);
},destroyRecursive:function(_1d){
if(this._beingDestroyed){
return;
}
this.inherited(arguments);
},_onShow:function(){
this.inherited(arguments);
if(this.href){
if(!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow)){
return this.refresh();
}
}
},refresh:function(){
this.cancel();
this.onLoadDeferred=new _b(_2.hitch(this,"cancel"));
this.onLoadDeferred.then(_2.hitch(this,"onLoad"));
this._load();
return this.onLoadDeferred;
},_load:function(){
this._setContent(this.onDownloadStart(),true);
var _1e=this;
var _1f={preventCache:(this.preventCache||this.refreshOnShow),url:this.href,handleAs:"text"};
if(_2.isObject(this.ioArgs)){
_2.mixin(_1f,this.ioArgs);
}
var _20=(this._xhrDfd=(this.ioMethod||_f.get)(_1f)),_21;
_20.then(function(_22){
_21=_22;
try{
_1e._isDownloaded=true;
return _1e._setContent(_22,false);
}
catch(err){
_1e._onError("Content",err);
}
},function(err){
if(!_20.canceled){
_1e._onError("Download",err);
}
delete _1e._xhrDfd;
return err;
}).then(function(){
_1e.onDownloadEnd();
delete _1e._xhrDfd;
return _21;
});
delete this._hrefChanged;
},_onLoadHandler:function(_23){
this._set("isLoaded",true);
try{
this.onLoadDeferred.resolve(_23);
}
catch(e){
console.error("Error "+this.widgetId+" running custom onLoad code: "+e.message);
}
},_onUnloadHandler:function(){
this._set("isLoaded",false);
try{
this.onUnload();
}
catch(e){
console.error("Error "+this.widgetId+" running custom onUnload code: "+e.message);
}
},destroyDescendants:function(_24){
if(this.isLoaded){
this._onUnloadHandler();
}
var _25=this._contentSetter;
_9.forEach(this.getChildren(),function(_26){
if(_26.destroyRecursive){
_26.destroyRecursive(_24);
}else{
if(_26.destroy){
_26.destroy(_24);
}
}
_26._destroyed=true;
});
if(_25){
_9.forEach(_25.parseResults,function(_27){
if(!_27._destroyed){
if(_27.destroyRecursive){
_27.destroyRecursive(_24);
}else{
if(_27.destroy){
_27.destroy(_24);
}
}
_27._destroyed=true;
}
});
delete _25.parseResults;
}
if(!_24){
_e.empty(this.containerNode);
}
delete this._singleChild;
},_setContent:function(_28,_29){
this.destroyDescendants();
var _2a=this._contentSetter;
if(!(_2a&&_2a instanceof _7._ContentSetter)){
_2a=this._contentSetter=new _7._ContentSetter({node:this.containerNode,_onError:_2.hitch(this,this._onError),onContentError:_2.hitch(this,function(e){
var _2b=this.onContentError(e);
try{
this.containerNode.innerHTML=_2b;
}
catch(e){
console.error("Fatal "+this.id+" could not change content due to "+e.message,e);
}
})});
}
var _2c=_2.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!_28.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:false,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{});
var p=_2a.set((_2.isObject(_28)&&_28.domNode)?_28.domNode:_28,_2c);
var _2d=this;
return _11(p&&p.then?p:_2a.parseDeferred,function(){
delete _2d._contentSetterParams;
if(!_29){
if(_2d._started){
_2d._startChildren();
_2d._scheduleLayout();
}
_2d._onLoadHandler(_28);
}
});
},_onError:function(_2e,err,_2f){
this.onLoadDeferred.reject(err);
var _30=this["on"+_2e+"Error"].call(this,err);
if(_2f){
console.error(_2f,err);
}else{
if(_30){
this._setContent(_30,true);
}
}
},onLoad:function(){
},onUnload:function(){
},onDownloadStart:function(){
return this.loadingMessage;
},onContentError:function(){
},onDownloadError:function(){
return this.errorMessage;
},onDownloadEnd:function(){
}});
});


;define("dojo/text!dijit/templates/Dialog.html", '<div class="dijitDialog" role="dialog" aria-labelledby="${id}_title">\n	<div data-dojo-attach-point="titleBar" class="dijitDialogTitleBar">\n		<span data-dojo-attach-point="titleNode" class="dijitDialogTitle" id="${id}_title"\n				role="heading" level="1"></span>\n		<span data-dojo-attach-point="closeButtonNode" class="dijitDialogCloseIcon" data-dojo-attach-event="ondijitclick: onCancel" title="${buttonCancel}" role="button" tabindex="-1">\n			<span data-dojo-attach-point="closeText" class="closeText" title="${buttonCancel}">x</span>\n		</span>\n	</div>\n	<div data-dojo-attach-point="containerNode" class="dijitDialogPaneContent"></div>\n	${!actionBarTemplate}\n</div>\n\n');

;define("dojo/i18n!dijit/nls/common", {"itemClose":"Close","buttonCancel":"Cancel","buttonOk":"OK","buttonSave":"Save"});

;define("dojo/text!dijit/templates/TooltipDialog.html", '<div role="alertdialog" tabIndex="-1">\n	<div class="dijitTooltipContainer" role="presentation">\n		<div data-dojo-attach-point="contentsNode" class="dijitTooltipContents dijitTooltipFocusNode">\n			<div data-dojo-attach-point="containerNode"></div>\n			${!actionBarTemplate}\n		</div>\n	</div>\n	<div class="dijitTooltipConnector" role="presentation" data-dojo-attach-point="connectorNode"></div>\n</div>\n');

;define("dijit/TooltipDialog",["dojo/_base/declare","dojo/dom-class","dojo/has","dojo/keys","dojo/_base/lang","dojo/on","./focus","./layout/ContentPane","./_DialogMixin","./form/_FormMixin","./_TemplatedMixin","dojo/text!./templates/TooltipDialog.html","./main"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9,_a,_b,_c){
var _d=_1("dijit.TooltipDialog",[_7,_a,_9,_8],{title:"",doLayout:false,autofocus:true,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:_b,_setTitleAttr:"containerNode",postCreate:function(){
this.inherited(arguments);
this.own(on(this.domNode,"keydown",_5.hitch(this,"_onKey")));
},orient:function(_e,_f,_10){
var _11={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft","BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[_f+"-"+_10];
_2.replace(this.domNode,_11,this._currentOrientClass||"");
this._currentOrientClass=_11;
},focus:function(){
this._getFocusItems();
_6.focus(this._firstFocusItem);
},onOpen:function(pos){
this.orient(this.domNode,pos.aroundCorner,pos.corner);
var _12=pos.aroundNodePos;
if(pos.corner.charAt(0)=="M"&&pos.aroundCorner.charAt(0)=="M"){
this.connectorNode.style.top=_12.y+((_12.h-this.connectorNode.offsetHeight)>>1)-pos.y+"px";
this.connectorNode.style.left="";
}else{
if(pos.corner.charAt(1)=="M"&&pos.aroundCorner.charAt(1)=="M"){
this.connectorNode.style.left=_12.x+((_12.w-this.connectorNode.offsetWidth)>>1)-pos.x+"px";
}
}
this._onShow();
},onClose:function(){
this.onHide();
},_onKey:function(evt){
if(evt.keyCode==_4.ESCAPE){
this.defer("onCancel");
evt.stopPropagation();
evt.preventDefault();
}else{
if(evt.keyCode==_4.TAB){
var _13=evt.target;
this._getFocusItems();
if(this._firstFocusItem==this._lastFocusItem){
evt.stopPropagation();
evt.preventDefault();
}else{
if(_13==this._firstFocusItem&&evt.shiftKey){
_6.focus(this._lastFocusItem);
evt.stopPropagation();
evt.preventDefault();
}else{
if(_13==this._lastFocusItem&&!evt.shiftKey){
_6.focus(this._firstFocusItem);
evt.stopPropagation();
evt.preventDefault();
}else{
evt.stopPropagation();
}
}
}
}
}
}});
if(_3("dojo-bidi")){
_d.extend({_setTitleAttr:function(_14){
this.containerNode.title=(this.textDir&&this.enforceTextDirWithUcc)?this.enforceTextDirWithUcc(null,_14):_14;
this._set("title",_14);
},_setTextDirAttr:function(_15){
if(!this._created||this.textDir!=_15){
this._set("textDir",_15);
if(this.textDir&&this.title){
this.containerNode.title=this.enforceTextDirWithUcc(null,this.title);
}
}
}});
}
return _d;
});


;define("dijit/Dialog",["require","dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/Deferred","dojo/dom","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/fx","dojo/i18n","dojo/keys","dojo/_base/lang","dojo/on","dojo/ready","dojo/sniff","dojo/window","dojo/dnd/Moveable","dojo/dnd/TimedMoveable","./focus","./_base/manager","./_Widget","./_TemplatedMixin","./_CssStateMixin","./form/_FormMixin","./_DialogMixin","./DialogUnderlay","./layout/ContentPane","./layout/utils","dojo/text!./templates/Dialog.html","./a11yclick","dojo/i18n!./nls/common","./TooltipDialog"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,fx,_a,_b,_c,on,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,_1a,_1b,_1c){
var _1d=new _5();
_1d.resolve(true);
var _1e=_4("dijit._DialogBase"+(_e("dojo-bidi")?"_NoBidi":""),[_15,_17,_18,_16],{templateString:_1c,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:false,duration:_13.defaultDuration,refocus:true,autofocus:true,_firstFocusItem:null,_lastFocusItem:null,draggable:true,_setDraggableAttr:function(val){
this._set("draggable",val);
},maxRatio:0.9,closable:true,_setClosableAttr:function(val){
this.closeButtonNode.style.display=val?"":"none";
this._set("closable",val);
},postMixInProperties:function(){
var _1f=_a.getLocalization("dijit","common");
_c.mixin(this,_1f);
this.inherited(arguments);
},postCreate:function(){
_9.set(this.domNode,{display:"none",position:"absolute"});
this.ownerDocumentBody.appendChild(this.domNode);
this.inherited(arguments);
_3.after(this,"onExecute",_c.hitch(this,"hide"),true);
_3.after(this,"onCancel",_c.hitch(this,"hide"),true);
this._modalconnects=[];
},onLoad:function(){
this.resize();
this._position();
if(this.autofocus&&_20.isTop(this)){
this._getFocusItems();
_12.focus(this._firstFocusItem);
}
this.inherited(arguments);
},focus:function(){
this._getFocusItems();
_12.focus(this._firstFocusItem);
},_endDrag:function(){
var _21=_8.position(this.domNode),_22=_f.getBox(this.ownerDocument);
_21.y=Math.min(Math.max(_21.y,0),(_22.h-_21.h));
_21.x=Math.min(Math.max(_21.x,0),(_22.w-_21.w));
this._relativePosition=_21;
this._position();
},_setup:function(){
var _23=this.domNode;
if(this.titleBar&&this.draggable){
this._moveable=new ((_e("ie")==6)?_11:_10)(_23,{handle:this.titleBar});
_3.after(this._moveable,"onMoveStop",_c.hitch(this,"_endDrag"),true);
}else{
_7.add(_23,"dijitDialogFixed");
}
this.underlayAttrs={dialogId:this.id,"class":_2.map(this["class"].split(/\s/),function(s){
return s+"_underlay";
}).join(" "),_onKeyDown:_c.hitch(this,"_onKey"),ownerDocument:this.ownerDocument};
},_size:function(){
this.resize();
},_position:function(){
if(!_7.contains(this.ownerDocumentBody,"dojoMove")){
var _24=this.domNode,_25=_f.getBox(this.ownerDocument),p=this._relativePosition,bb=p?null:_8.position(_24),l=Math.floor(_25.l+(p?p.x:(_25.w-bb.w)/2)),t=Math.floor(_25.t+(p?p.y:(_25.h-bb.h)/2));
_9.set(_24,{left:l+"px",top:t+"px"});
}
},_onKey:function(evt){
if(evt.keyCode==_b.TAB){
this._getFocusItems();
var _26=evt.target;
if(this._firstFocusItem==this._lastFocusItem){
evt.stopPropagation();
evt.preventDefault();
}else{
if(_26==this._firstFocusItem&&evt.shiftKey){
_12.focus(this._lastFocusItem);
evt.stopPropagation();
evt.preventDefault();
}else{
if(_26==this._lastFocusItem&&!evt.shiftKey){
_12.focus(this._firstFocusItem);
evt.stopPropagation();
evt.preventDefault();
}
}
}
}else{
if(this.closable&&evt.keyCode==_b.ESCAPE){
this.onCancel();
evt.stopPropagation();
evt.preventDefault();
}
}
},show:function(){
if(this.open){
return _1d.promise;
}
if(!this._started){
this.startup();
}
if(!this._alreadyInitialized){
this._setup();
this._alreadyInitialized=true;
}
if(this._fadeOutDeferred){
this._fadeOutDeferred.cancel();
_20.hide(this);
}
var win=_f.get(this.ownerDocument);
this._modalconnects.push(on(win,"scroll",_c.hitch(this,"resize",null)));
this._modalconnects.push(on(this.domNode,"keydown",_c.hitch(this,"_onKey")));
_9.set(this.domNode,{opacity:0,display:""});
this._set("open",true);
this._onShow();
this.resize();
this._position();
var _27;
this._fadeInDeferred=new _5(_c.hitch(this,function(){
_27.stop();
delete this._fadeInDeferred;
}));
var _28=this._fadeInDeferred.promise;
_27=fx.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:_c.hitch(this,function(){
_20.show(this,this.underlayAttrs);
}),onEnd:_c.hitch(this,function(){
if(this.autofocus&&_20.isTop(this)){
this._getFocusItems();
_12.focus(this._firstFocusItem);
}
this._fadeInDeferred.resolve(true);
delete this._fadeInDeferred;
})}).play();
return _28;
},hide:function(){
if(!this._alreadyInitialized||!this.open){
return _1d.promise;
}
if(this._fadeInDeferred){
this._fadeInDeferred.cancel();
}
var _29;
this._fadeOutDeferred=new _5(_c.hitch(this,function(){
_29.stop();
delete this._fadeOutDeferred;
}));
this._fadeOutDeferred.then(_c.hitch(this,"onHide"));
var _2a=this._fadeOutDeferred.promise;
_29=fx.fadeOut({node:this.domNode,duration:this.duration,onEnd:_c.hitch(this,function(){
this.domNode.style.display="none";
_20.hide(this);
this._fadeOutDeferred.resolve(true);
delete this._fadeOutDeferred;
})}).play();
if(this._scrollConnected){
this._scrollConnected=false;
}
var h;
while(h=this._modalconnects.pop()){
h.remove();
}
if(this._relativePosition){
delete this._relativePosition;
}
this._set("open",false);
return _2a;
},resize:function(dim){
if(this.domNode.style.display!="none"){
this._checkIfSingleChild();
if(!dim){
if(this._shrunk){
if(this._singleChild){
if(typeof this._singleChildOriginalStyle!="undefined"){
this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle;
delete this._singleChildOriginalStyle;
}
}
_2.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode,this.footer_AP],function(_2b){
if(_2b){
_9.set(_2b,{position:"static",width:"auto",height:"auto"});
}
});
this.domNode.style.position="absolute";
}
var _2c=_f.getBox(this.ownerDocument);
_2c.w*=this.maxRatio;
_2c.h*=this.maxRatio;
var bb=_8.position(this.domNode);
if(bb.w>=_2c.w||bb.h>=_2c.h){
dim={w:Math.min(bb.w,_2c.w),h:Math.min(bb.h,_2c.h)};
this._shrunk=true;
}else{
this._shrunk=false;
}
}
if(dim){
_8.setMarginBox(this.domNode,dim);
var _2d=[];
if(this.titleBar){
_2d.push({domNode:this.titleBar,region:"top"});
}
if(this.actionBarNode){
_2d.push({domNode:this.actionBarNode,region:"bottom"});
}else{
if(this.footer_AP){
_2d.push({domNode:this.footer_AP,region:"bottom"});
}
}
var _2e={domNode:this.containerNode,region:"center"};
_2d.push(_2e);
var _2f=_1b.marginBox2contentBox(this.domNode,dim);
_1b.layoutChildren(this.domNode,_2f,_2d);
if(this._singleChild){
var cb=_1b.marginBox2contentBox(this.containerNode,_2e);
this._singleChild.resize({w:cb.w,h:cb.h});
}else{
this.containerNode.style.overflow="auto";
this._layoutChildren();
}
}else{
this._layoutChildren();
}
if(!_e("touch")&&!dim){
this._position();
}
}
},_layoutChildren:function(){
_2.forEach(this.getChildren(),function(_30){
if(_30.resize){
_30.resize();
}
});
},destroy:function(){
if(this._fadeInDeferred){
this._fadeInDeferred.cancel();
}
if(this._fadeOutDeferred){
this._fadeOutDeferred.cancel();
}
if(this._moveable){
this._moveable.destroy();
}
var h;
while(h=this._modalconnects.pop()){
h.remove();
}
_20.hide(this);
this.inherited(arguments);
}});
if(_e("dojo-bidi")){
_1e=_4("dijit._DialogBase",_1e,{_setTitleAttr:function(_31){
this._set("title",_31);
this.titleNode.innerHTML=_31;
this.applyTextDir(this.titleNode);
},_setTextDirAttr:function(_32){
if(this._created&&this.textDir!=_32){
this._set("textDir",_32);
this.set("title",this.title);
}
}});
}
var _33=_4("dijit.Dialog",[_1a,_1e],{});
_33._DialogBase=_1e;
var _20=_33._DialogLevelManager={_beginZIndex:950,show:function(_34,_35){
ds[ds.length-1].focus=_12.curNode;
var _36=ds[ds.length-1].dialog?ds[ds.length-1].zIndex+2:_33._DialogLevelManager._beginZIndex;
_9.set(_34.domNode,"zIndex",_36);
_19.show(_35,_36-1);
ds.push({dialog:_34,underlayAttrs:_35,zIndex:_36});
},hide:function(_37){
if(ds[ds.length-1].dialog==_37){
ds.pop();
var pd=ds[ds.length-1];
if(ds.length==1){
_19.hide();
}else{
_19.show(pd.underlayAttrs,pd.zIndex-1);
}
if(_37.refocus){
var _38=pd.focus;
if(pd.dialog&&(!_38||!_6.isDescendant(_38,pd.dialog.domNode))){
pd.dialog._getFocusItems();
_38=pd.dialog._firstFocusItem;
}
if(_38){
try{
_38.focus();
}
catch(e){
}
}
}
}else{
var idx=_2.indexOf(_2.map(ds,function(_39){
return _39.dialog;
}),_37);
if(idx!=-1){
ds.splice(idx,1);
}
}
},isTop:function(_3a){
return ds[ds.length-1].dialog==_3a;
}};
var ds=_33._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];
_12.watch("curNode",function(_3b,_3c,_3d){
var _3e=ds[ds.length-1].dialog;
if(_3d&&_3e&&!_3e._fadeOutDeferred&&_3d.ownerDocument==_3e.ownerDocument){
do{
if(_3d==_3e.domNode||_7.contains(_3d,"dijitPopup")||_7.contains(_3d,"typeAhead")){
return;
}
}while(_3d=_3d.parentNode);
_3e.focus();
}
});
return _33;
});


;define("dojo/text!dijit/templates/Menu.html", '<table class="dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role="menu" tabIndex="${tabIndex}"\n	   cellspacing="0">\n	<tbody class="dijitReset" data-dojo-attach-point="containerNode"></tbody>\n</table>\n');

;define("dijit/_KeyNavMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/lang","dojo/on","dijit/registry","dijit/_FocusMixin"],function(_1,_2,_3,_4,_5,on,_6,_7){
return _2("dijit._KeyNavMixin",_7,{tabIndex:"0",childSelector:null,postCreate:function(){
this.inherited(arguments);
_3.set(this.domNode,"tabIndex",this.tabIndex);
if(!this._keyNavCodes){
var _8=this._keyNavCodes={};
_8[_4.HOME]=_5.hitch(this,"focusFirstChild");
_8[_4.END]=_5.hitch(this,"focusLastChild");
_8[this.isLeftToRight()?_4.LEFT_ARROW:_4.RIGHT_ARROW]=_5.hitch(this,"_onLeftArrow");
_8[this.isLeftToRight()?_4.RIGHT_ARROW:_4.LEFT_ARROW]=_5.hitch(this,"_onRightArrow");
_8[_4.UP_ARROW]=_5.hitch(this,"_onUpArrow");
_8[_4.DOWN_ARROW]=_5.hitch(this,"_onDownArrow");
}
var _9=this,_a=typeof this.childSelector=="string"?this.childSelector:_5.hitch(this,"childSelector");
this.own(on(this.domNode,"keypress",_5.hitch(this,"_onContainerKeypress")),on(this.domNode,"keydown",_5.hitch(this,"_onContainerKeydown")),on(this.domNode,"focus",_5.hitch(this,"_onContainerFocus")),on(this.containerNode,on.selector(_a,"focusin"),function(_b){
_9._onChildFocus(_6.getEnclosingWidget(this),_b);
}));
},_onLeftArrow:function(){
},_onRightArrow:function(){
},_onUpArrow:function(){
},_onDownArrow:function(){
},focus:function(){
this.focusFirstChild();
},_getFirstFocusableChild:function(){
return this._getNextFocusableChild(null,1);
},_getLastFocusableChild:function(){
return this._getNextFocusableChild(null,-1);
},focusFirstChild:function(){
this.focusChild(this._getFirstFocusableChild());
},focusLastChild:function(){
this.focusChild(this._getLastFocusableChild());
},focusChild:function(_c,_d){
if(!_c){
return;
}
if(this.focusedChild&&_c!==this.focusedChild){
this._onChildBlur(this.focusedChild);
}
_c.set("tabIndex",this.tabIndex);
_c.focus(_d?"end":"start");
},_onContainerFocus:function(_e){
if(_e.target!==this.domNode||this.focusedChild){
return;
}
this.focus();
},_onFocus:function(){
_3.set(this.domNode,"tabIndex","-1");
this.inherited(arguments);
},_onBlur:function(_f){
_3.set(this.domNode,"tabIndex",this.tabIndex);
if(this.focusedChild){
this.focusedChild.set("tabIndex","-1");
this.lastFocusedChild=this.focusedChild;
this._set("focusedChild",null);
}
this.inherited(arguments);
},_onChildFocus:function(_10){
if(_10&&_10!=this.focusedChild){
if(this.focusedChild&&!this.focusedChild._destroyed){
this.focusedChild.set("tabIndex","-1");
}
_10.set("tabIndex",this.tabIndex);
this.lastFocused=_10;
this._set("focusedChild",_10);
}
},_searchString:"",multiCharSearchDuration:1000,onKeyboardSearch:function(_11,evt,_12,_13){
if(_11){
this.focusChild(_11);
}
},_keyboardSearchCompare:function(_14,_15){
var _16=_14.domNode,_17=_14.label||(_16.focusNode?_16.focusNode.label:"")||_16.innerText||_16.textContent||"",_18=_17.replace(/^\s+/,"").substr(0,_15.length).toLowerCase();
return (!!_15.length&&_18==_15)?-1:0;
},_onContainerKeydown:function(evt){
var _19=this._keyNavCodes[evt.keyCode];
if(_19){
_19(evt,this.focusedChild);
evt.stopPropagation();
evt.preventDefault();
this._searchString="";
}else{
if(evt.keyCode==_4.SPACE&&this._searchTimer&&!(evt.ctrlKey||evt.altKey||evt.metaKey)){
evt.stopImmediatePropagation();
evt.preventDefault();
this._keyboardSearch(evt," ");
}
}
},_onContainerKeypress:function(evt){
if(evt.charCode<=_4.SPACE||evt.ctrlKey||evt.altKey||evt.metaKey){
return;
}
evt.preventDefault();
evt.stopPropagation();
this._keyboardSearch(evt,String.fromCharCode(evt.charCode).toLowerCase());
},_keyboardSearch:function(evt,_1a){
var _1b=null,_1c,_1d=0,_1e=_5.hitch(this,function(){
if(this._searchTimer){
this._searchTimer.remove();
}
this._searchString+=_1a;
var _1f=/^(.)\1*$/.test(this._searchString);
var _20=_1f?1:this._searchString.length;
_1c=this._searchString.substr(0,_20);
this._searchTimer=this.defer(function(){
this._searchTimer=null;
this._searchString="";
},this.multiCharSearchDuration);
var _21=this.focusedChild||null;
if(_20==1||!_21){
_21=this._getNextFocusableChild(_21,1);
if(!_21){
return;
}
}
var _22=_21;
do{
var rc=this._keyboardSearchCompare(_21,_1c);
if(!!rc&&_1d++==0){
_1b=_21;
}
if(rc==-1){
_1d=-1;
break;
}
_21=this._getNextFocusableChild(_21,1);
}while(_21!=_22);
});
_1e();
this.onKeyboardSearch(_1b,evt,_1c,_1d);
},_onChildBlur:function(){
},_getNextFocusableChild:function(_23,dir){
var _24=_23;
do{
if(!_23){
_23=this[dir>0?"_getFirst":"_getLast"]();
if(!_23){
break;
}
}else{
_23=this._getNext(_23,dir);
}
if(_23!=null&&_23!=_24&&_23.isFocusable()){
return _23;
}
}while(_23!=_24);
return null;
},_getFirst:function(){
return null;
},_getLast:function(){
return null;
},_getNext:function(_25,dir){
if(_25){
_25=_25.domNode;
while(_25){
_25=_25[dir<0?"previousSibling":"nextSibling"];
if(_25&&"getAttribute" in _25){
var w=_6.byNode(_25);
if(w){
return w;
}
}
}
}
return null;
}});
});


;define("dijit/_KeyNavContainer",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/_base/kernel","dojo/keys","dojo/_base/lang","./registry","./_Container","./_FocusMixin","./_KeyNavMixin"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
return _2("dijit._KeyNavContainer",[_9,_a,_8],{connectKeyNavHandlers:function(_b,_c){
var _d=(this._keyNavCodes={});
var _e=_6.hitch(this,"focusPrev");
var _f=_6.hitch(this,"focusNext");
_1.forEach(_b,function(_10){
_d[_10]=_e;
});
_1.forEach(_c,function(_11){
_d[_11]=_f;
});
_d[_5.HOME]=_6.hitch(this,"focusFirstChild");
_d[_5.END]=_6.hitch(this,"focusLastChild");
},startupKeyNavChildren:function(){
_4.deprecated("startupKeyNavChildren() call no longer needed","","2.0");
},startup:function(){
this.inherited(arguments);
_1.forEach(this.getChildren(),_6.hitch(this,"_startupChild"));
},addChild:function(_12,_13){
this.inherited(arguments);
this._startupChild(_12);
},_startupChild:function(_14){
_14.set("tabIndex","-1");
},_getFirst:function(){
var _15=this.getChildren();
return _15.length?_15[0]:null;
},_getLast:function(){
var _16=this.getChildren();
return _16.length?_16[_16.length-1]:null;
},focusNext:function(){
this.focusChild(this._getNextFocusableChild(this.focusedChild,1));
},focusPrev:function(){
this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);
},childSelector:function(_17){
var _17=_7.byNode(_17);
return _17&&_17.getParent()==this;
}});
});


;define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./a11yclick","./registry","./_Widget","./_CssStateMixin","./_KeyNavContainer","./_TemplatedMixin"],function(_1,_2,_3,_4,_5,_6,_7,on,_8,_9,_a,_b,_c,_d,_e){
return _2("dijit._MenuBase",[_b,_e,_d,_c],{selected:null,_setSelectedAttr:function(_f){
if(this.selected!=_f){
if(this.selected){
this.selected._setSelected(false);
this._onChildDeselect(this.selected);
}
if(_f){
_f._setSelected(true);
}
this._set("selected",_f);
}
},activated:false,_setActivatedAttr:function(val){
_5.toggle(this.domNode,"dijitMenuActive",val);
_5.toggle(this.domNode,"dijitMenuPassive",!val);
this._set("activated",val);
},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:false,childSelector:function(_10){
var _11=_a.byNode(_10);
return _10.parentNode==this.containerNode&&_11&&_11.focus;
},postCreate:function(){
var _12=this,_13=typeof this.childSelector=="string"?this.childSelector:_6.hitch(this,"childSelector");
this.own(on(this.containerNode,on.selector(_13,_7.enter),function(){
_12.onItemHover(_a.byNode(this));
}),on(this.containerNode,on.selector(_13,_7.leave),function(){
_12.onItemUnhover(_a.byNode(this));
}),on(this.containerNode,on.selector(_13,_9),function(evt){
_12.onItemClick(_a.byNode(this),evt);
evt.stopPropagation();
}),on(this.containerNode,on.selector(_13,"focusin"),function(){
_12._onItemFocus(_a.byNode(this));
}));
this.inherited(arguments);
},onKeyboardSearch:function(_14,evt,_15,_16){
this.inherited(arguments);
if(!!_14&&(_16==-1||(!!_14.popup&&_16==1))){
this.onItemClick(_14,evt);
}
},_keyboardSearchCompare:function(_17,_18){
if(!!_17.shortcutKey){
return _18==_17.shortcutKey.toLowerCase()?-1:0;
}
return this.inherited(arguments)?1:0;
},onExecute:function(){
},onCancel:function(){
},_moveToPopup:function(evt){
if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){
this.onItemClick(this.focusedChild,evt);
}else{
var _19=this._getTopMenu();
if(_19&&_19._isMenuBar){
_19.focusNext();
}
}
},_onPopupHover:function(){
this.set("selected",this.currentPopupItem);
this._stopPendingCloseTimer();
},onItemHover:function(_1a){
if(this.activated){
this.set("selected",_1a);
if(_1a.popup&&!_1a.disabled&&!this.hover_timer){
this.hover_timer=this.defer(function(){
this._openItemPopup(_1a);
},this.popupDelay);
}
}else{
if(this.passivePopupDelay<Infinity){
if(this.passive_hover_timer){
this.passive_hover_timer.remove();
}
this.passive_hover_timer=this.defer(function(){
this.onItemClick(_1a,{type:"click"});
},this.passivePopupDelay);
}
}
this._hoveredChild=_1a;
_1a._set("hovering",true);
},_onChildDeselect:function(_1b){
this._stopPopupTimer();
if(this.currentPopupItem==_1b){
this._stopPendingCloseTimer();
this._pendingClose_timer=this.defer(function(){
this._pendingClose_timer=null;
this.currentPopupItem=null;
_1b._closePopup();
},this.popupDelay);
}
},onItemUnhover:function(_1c){
if(this._hoveredChild==_1c){
this._hoveredChild=null;
}
if(this.passive_hover_timer){
this.passive_hover_timer.remove();
this.passive_hover_timer=null;
}
_1c._set("hovering",false);
},_stopPopupTimer:function(){
if(this.hover_timer){
this.hover_timer=this.hover_timer.remove();
}
},_stopPendingCloseTimer:function(){
if(this._pendingClose_timer){
this._pendingClose_timer=this._pendingClose_timer.remove();
}
},_getTopMenu:function(){
for(var top=this;top.parentMenu;top=top.parentMenu){
}
return top;
},onItemClick:function(_1d,evt){
if(this.passive_hover_timer){
this.passive_hover_timer.remove();
}
this.focusChild(_1d);
if(_1d.disabled){
return false;
}
if(_1d.popup){
this.set("selected",_1d);
this.set("activated",true);
var _1e=/^key/.test(evt._origType||evt.type)||(evt.clientX==0&&evt.clientY==0);
this._openItemPopup(_1d,_1e);
}else{
this.onExecute();
_1d._onClick?_1d._onClick(evt):_1d.onClick(evt);
}
},_openItemPopup:function(_1f,_20){
if(_1f==this.currentPopupItem){
return;
}
if(this.currentPopupItem){
this._stopPendingCloseTimer();
this.currentPopupItem._closePopup();
}
this._stopPopupTimer();
var _21=_1f.popup;
_21.parentMenu=this;
this.own(this._mouseoverHandle=on.once(_21.domNode,"mouseover",_6.hitch(this,"_onPopupHover")));
var _22=this;
_1f._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){
if(_20){
_22.focusChild(_1f);
}
_22._cleanUp();
},onExecute:_6.hitch(this,"_cleanUp",true),onClose:function(){
if(_22._mouseoverHandle){
_22._mouseoverHandle.remove();
delete _22._mouseoverHandle;
}
}},_20);
this.currentPopupItem=_1f;
},onOpen:function(){
this.isShowingNow=true;
this.set("activated",true);
},onClose:function(){
this.set("activated",false);
this.set("selected",null);
this.isShowingNow=false;
this.parentMenu=null;
},_closeChild:function(){
this._stopPopupTimer();
if(this.currentPopupItem){
if(this.focused){
_4.set(this.selected.focusNode,"tabIndex",this.tabIndex);
this.selected.focusNode.focus();
}
this.currentPopupItem._closePopup();
this.currentPopupItem=null;
}
},_onItemFocus:function(_23){
if(this._hoveredChild&&this._hoveredChild!=_23){
this.onItemUnhover(this._hoveredChild);
}
this.set("selected",_23);
},_onBlur:function(){
this._cleanUp(true);
this.inherited(arguments);
},_cleanUp:function(_24){
this._closeChild();
if(typeof this.isShowingNow=="undefined"){
this.set("activated",false);
}
if(_24){
this.set("selected",null);
}
}});
});


;define("dijit/DropDownMenu",["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(_1,_2,_3,_4){
return _1("dijit.DropDownMenu",_4,{templateString:_3,baseClass:"dijitMenu",_onUpArrow:function(){
this.focusPrev();
},_onDownArrow:function(){
this.focusNext();
},_onRightArrow:function(_5){
this._moveToPopup(_5);
_5.stopPropagation();
_5.preventDefault();
},_onLeftArrow:function(_6){
if(this.parentMenu){
if(this.parentMenu._isMenuBar){
this.parentMenu.focusPrev();
}else{
this.onCancel(false);
}
}else{
_6.stopPropagation();
_6.preventDefault();
}
}});
});


;define("dijit/PopupMenuItem",["dojo/_base/declare","dojo/dom-style","dojo/_base/lang","dojo/query","./popup","./registry","./MenuItem","./hccss"],function(_1,_2,_3,_4,pm,_5,_6){
return _1("dijit.PopupMenuItem",_6,{baseClass:"dijitMenuItem dijitPopupMenuItem",_fillContent:function(){
if(this.srcNodeRef){
var _7=_4("*",this.srcNodeRef);
this.inherited(arguments,[_7[0]]);
this.dropDownContainer=this.srcNodeRef;
}
},_openPopup:function(_8,_9){
var _a=this.popup;
pm.open(_3.delegate(_8,{popup:this.popup,around:this.domNode}));
if(_9&&_a.focus){
_a.focus();
}
},_closePopup:function(){
pm.close(this.popup);
this.popup.parentMenu=null;
},startup:function(){
if(this._started){
return;
}
this.inherited(arguments);
if(!this.popup){
var _b=_4("[widgetId]",this.dropDownContainer)[0];
this.popup=_5.byNode(_b);
}
this.ownerDocumentBody.appendChild(this.popup.domNode);
this.popup.domNode.setAttribute("aria-labelledby",this.containerNode.id);
this.popup.startup();
this.popup.domNode.style.display="none";
if(this.arrowWrapper){
_2.set(this.arrowWrapper,"visibility","");
}
this.focusNode.setAttribute("aria-haspopup","true");
},destroyDescendants:function(_c){
if(this.popup){
if(!this.popup._destroyed){
this.popup.destroyRecursive(_c);
}
delete this.popup;
}
this.inherited(arguments);
}});
});


;define("dojo/text!dijit/templates/MenuSeparator.html", '<tr class="dijitMenuSeparator" role="separator">\n	<td class="dijitMenuSeparatorIconCell">\n		<div class="dijitMenuSeparatorTop"></div>\n		<div class="dijitMenuSeparatorBottom"></div>\n	</td>\n	<td colspan="3" class="dijitMenuSeparatorLabelCell">\n		<div class="dijitMenuSeparatorTop dijitMenuSeparatorLabel"></div>\n		<div class="dijitMenuSeparatorBottom"></div>\n	</td>\n</tr>\n');

;define("dijit/MenuSeparator",["dojo/_base/declare","dojo/dom","./_WidgetBase","./_TemplatedMixin","./_Contained","dojo/text!./templates/MenuSeparator.html"],function(_1,_2,_3,_4,_5,_6){
return _1("dijit.MenuSeparator",[_3,_4,_5],{templateString:_6,buildRendering:function(){
this.inherited(arguments);
_2.setSelectable(this.domNode,false);
},isFocusable:function(){
return false;
}});
});


;define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready","./MenuItem","./PopupMenuItem","./CheckedMenuItem","./MenuSeparator"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,on,_a,_b,_c,pm,_d,_e){
return _3("dijit.Menu",_d,{constructor:function(){
this._bindings=[];
},targetNodeIds:[],selector:"",contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){
if(this.contextMenuForWindow){
this.bindDomNode(this.ownerDocumentBody);
}else{
_2.forEach(this.targetNodeIds,this.bindDomNode,this);
}
this.inherited(arguments);
},_iframeContentWindow:function(_f){
return _c.get(this._iframeContentDocument(_f))||this._iframeContentDocument(_f)["__parent__"]||(_f.name&&document.frames[_f.name])||null;
},_iframeContentDocument:function(_10){
return _10.contentDocument||(_10.contentWindow&&_10.contentWindow.document)||(_10.name&&document.frames[_10.name]&&document.frames[_10.name].document)||null;
},bindDomNode:function(_11){
_11=_4.byId(_11,this.ownerDocument);
var cn;
if(_11.tagName.toLowerCase()=="iframe"){
var _12=_11,_13=this._iframeContentWindow(_12);
cn=_b.body(_13.document);
}else{
cn=(_11==_b.body(this.ownerDocument)?this.ownerDocument.documentElement:_11);
}
var _14={node:_11,iframe:_12};
_5.set(_11,"_dijitMenu"+this.id,this._bindings.push(_14));
var _15=_9.hitch(this,function(cn){
var _16=this.selector,_17=_16?function(_18){
return on.selector(_16,_18);
}:function(_19){
return _19;
},_1a=this;
return [on(cn,_17(this.leftClickToOpen?"click":"contextmenu"),function(evt){
evt.stopPropagation();
evt.preventDefault();
if((new Date()).getTime()<_1a._lastKeyDown+500){
return;
}
_1a._scheduleOpen(this,_12,{x:evt.pageX,y:evt.pageY},evt.target);
}),on(cn,_17("keydown"),function(evt){
if(evt.keyCode==93||(evt.shiftKey&&evt.keyCode==_8.F10)||(_1a.leftClickToOpen&&evt.keyCode==_8.SPACE)){
evt.stopPropagation();
evt.preventDefault();
_1a._scheduleOpen(this,_12,null,evt.target);
_1a._lastKeyDown=(new Date()).getTime();
}
})];
});
_14.connects=cn?_15(cn):[];
if(_12){
_14.onloadHandler=_9.hitch(this,function(){
var _1b=this._iframeContentWindow(_12),cn=_b.body(_1b.document);
_14.connects=_15(cn);
});
if(_12.addEventListener){
_12.addEventListener("load",_14.onloadHandler,false);
}else{
_12.attachEvent("onload",_14.onloadHandler);
}
}
},unBindDomNode:function(_1c){
var _1d;
try{
_1d=_4.byId(_1c,this.ownerDocument);
}
catch(e){
return;
}
var _1e="_dijitMenu"+this.id;
if(_1d&&_5.has(_1d,_1e)){
var bid=_5.get(_1d,_1e)-1,b=this._bindings[bid],h;
while((h=b.connects.pop())){
h.remove();
}
var _1f=b.iframe;
if(_1f){
if(_1f.removeEventListener){
_1f.removeEventListener("load",b.onloadHandler,false);
}else{
_1f.detachEvent("onload",b.onloadHandler);
}
}
_5.remove(_1d,_1e);
delete this._bindings[bid];
}
},_scheduleOpen:function(_20,_21,_22,_23){
if(!this._openTimer){
this._openTimer=this.defer(function(){
delete this._openTimer;
this._openMyself({target:_23,delegatedTarget:_20,iframe:_21,coords:_22});
},1);
}
},_openMyself:function(_24){
var _25=_24.target,_26=_24.iframe,_27=_24.coords,_28=!_27;
this.currentTarget=_24.delegatedTarget;
if(_27){
if(_26){
var ifc=_6.position(_26,true),_29=this._iframeContentWindow(_26),_2a=_6.docScroll(_29.document);
var cs=_7.getComputedStyle(_26),tp=_7.toPixelValue,_2b=(_a("ie")&&_a("quirks")?0:tp(_26,cs.paddingLeft))+(_a("ie")&&_a("quirks")?tp(_26,cs.borderLeftWidth):0),top=(_a("ie")&&_a("quirks")?0:tp(_26,cs.paddingTop))+(_a("ie")&&_a("quirks")?tp(_26,cs.borderTopWidth):0);
_27.x+=ifc.x+_2b-_2a.x;
_27.y+=ifc.y+top-_2a.y;
}
}else{
_27=_6.position(_25,true);
_27.x+=10;
_27.y+=10;
}
var _2c=this;
var _2d=this._focusManager.get("prevNode");
var _2e=this._focusManager.get("curNode");
var _2f=!_2e||(_4.isDescendant(_2e,this.domNode))?_2d:_2e;
function _30(){
if(_2c.refocus&&_2f){
_2f.focus();
}
pm.close(_2c);
};
pm.open({popup:this,x:_27.x,y:_27.y,onExecute:_30,onCancel:_30,orient:this.isLeftToRight()?"L":"R"});
this.focus();
if(!_28){
this.defer(function(){
this._cleanUp(true);
});
}
this._onBlur=function(){
this.inherited("_onBlur",arguments);
pm.close(this);
};
},destroy:function(){
_2.forEach(this._bindings,function(b){
if(b){
this.unBindDomNode(b.node);
}
},this);
this.inherited(arguments);
}});
});


;define("dojo/text!dijit/templates/Tooltip.html", '<div class="dijitTooltip dijitTooltipLeft" id="dojoTooltip" data-dojo-attach-event="mouseenter:onMouseEnter,mouseleave:onMouseLeave"\n	><div class="dijitTooltipConnector" data-dojo-attach-point="connectorNode"></div\n	><div class="dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point="containerNode" role=\'alert\'></div\n></div>\n');

;define("dijit/Tooltip",["dojo/_base/array","dojo/_base/declare","dojo/_base/fx","dojo/dom","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang","dojo/mouse","dojo/on","dojo/sniff","./_base/manager","./place","./_Widget","./_TemplatedMixin","./BackgroundIframe","dojo/text!./templates/Tooltip.html","./main"],function(_1,_2,fx,_3,_4,_5,_6,_7,_8,on,_9,_a,_b,_c,_d,_e,_f,_10){
var _11=_2("dijit._MasterTooltip",[_c,_d],{duration:_a.defaultDuration,templateString:_f,postCreate:function(){
this.ownerDocumentBody.appendChild(this.domNode);
this.bgIframe=new _e(this.domNode);
this.fadeIn=fx.fadeIn({node:this.domNode,duration:this.duration,onEnd:_7.hitch(this,"_onShow")});
this.fadeOut=fx.fadeOut({node:this.domNode,duration:this.duration,onEnd:_7.hitch(this,"_onHide")});
},show:function(_12,_13,_14,rtl,_15,_16,_17){
if(this.aroundNode&&this.aroundNode===_13&&this.containerNode.innerHTML==_12){
return;
}
if(this.fadeOut.status()=="playing"){
this._onDeck=arguments;
return;
}
this.containerNode.innerHTML=_12;
if(_15){
this.set("textDir",_15);
}
this.containerNode.align=rtl?"right":"left";
var pos=_b.around(this.domNode,_13,_14&&_14.length?_14:_18.defaultPosition,!rtl,_7.hitch(this,"orient"));
var _19=pos.aroundNodePos;
if(pos.corner.charAt(0)=="M"&&pos.aroundCorner.charAt(0)=="M"){
this.connectorNode.style.top=_19.y+((_19.h-this.connectorNode.offsetHeight)>>1)-pos.y+"px";
this.connectorNode.style.left="";
}else{
if(pos.corner.charAt(1)=="M"&&pos.aroundCorner.charAt(1)=="M"){
this.connectorNode.style.left=_19.x+((_19.w-this.connectorNode.offsetWidth)>>1)-pos.x+"px";
}else{
this.connectorNode.style.left="";
this.connectorNode.style.top="";
}
}
_6.set(this.domNode,"opacity",0);
this.fadeIn.play();
this.isShowingNow=true;
this.aroundNode=_13;
this.onMouseEnter=_16||_1a;
this.onMouseLeave=_17||_1a;
},orient:function(_1b,_1c,_1d,_1e,_1f){
this.connectorNode.style.top="";
var _20=_1e.h,_21=_1e.w;
_1b.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[_1c+"-"+_1d];
this.domNode.style.width="auto";
var _22=_5.position(this.domNode);
if(_9("ie")||_9("trident")){
_22.w+=2;
}
var _23=Math.min((Math.max(_21,1)),_22.w);
_5.setMarginBox(this.domNode,{w:_23});
if(_1d.charAt(0)=="B"&&_1c.charAt(0)=="B"){
var bb=_5.position(_1b);
var _24=this.connectorNode.offsetHeight;
if(bb.h>_20){
var _25=_20-((_1f.h+_24)>>1);
this.connectorNode.style.top=_25+"px";
this.connectorNode.style.bottom="";
}else{
this.connectorNode.style.bottom=Math.min(Math.max(_1f.h/2-_24/2,0),bb.h-_24)+"px";
this.connectorNode.style.top="";
}
}else{
this.connectorNode.style.top="";
this.connectorNode.style.bottom="";
}
return Math.max(0,_22.w-_21);
},_onShow:function(){
if(_9("ie")){
this.domNode.style.filter="";
}
},hide:function(_26){
if(this._onDeck&&this._onDeck[1]==_26){
this._onDeck=null;
}else{
if(this.aroundNode===_26){
this.fadeIn.stop();
this.isShowingNow=false;
this.aroundNode=null;
this.fadeOut.play();
}else{
}
}
this.onMouseEnter=this.onMouseLeave=_1a;
},_onHide:function(){
this.domNode.style.cssText="";
this.containerNode.innerHTML="";
if(this._onDeck){
this.show.apply(this,this._onDeck);
this._onDeck=null;
}
}});
if(_9("dojo-bidi")){
_11.extend({_setAutoTextDir:function(_27){
this.applyTextDir(_27);
_1.forEach(_27.children,function(_28){
this._setAutoTextDir(_28);
},this);
},_setTextDirAttr:function(_29){
this._set("textDir",_29);
if(_29=="auto"){
this._setAutoTextDir(this.containerNode);
}else{
this.containerNode.dir=this.textDir;
}
}});
}
_10.showTooltip=function(_2a,_2b,_2c,rtl,_2d,_2e,_2f){
if(_2c){
_2c=_1.map(_2c,function(val){
return {after:"after-centered",before:"before-centered"}[val]||val;
});
}
if(!_18._masterTT){
_10._masterTT=_18._masterTT=new _11();
}
return _18._masterTT.show(_2a,_2b,_2c,rtl,_2d,_2e,_2f);
};
_10.hideTooltip=function(_30){
return _18._masterTT&&_18._masterTT.hide(_30);
};
var _31="DORMANT",_32="SHOW TIMER",_33="SHOWING",_34="HIDE TIMER";
function _1a(){
};
var _18=_2("dijit.Tooltip",_c,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(_35){
_1.forEach(this._connections||[],function(_36){
_1.forEach(_36,function(_37){
_37.remove();
});
},this);
this._connectIds=_1.filter(_7.isArrayLike(_35)?_35:(_35?[_35]:[]),function(id){
return _3.byId(id,this.ownerDocument);
},this);
this._connections=_1.map(this._connectIds,function(id){
var _38=_3.byId(id,this.ownerDocument),_39=this.selector,_3a=_39?function(_3b){
return on.selector(_39,_3b);
}:function(_3c){
return _3c;
},_3d=this;
return [on(_38,_3a(_8.enter),function(){
_3d._onHover(this);
}),on(_38,_3a("focusin"),function(){
_3d._onHover(this);
}),on(_38,_3a(_8.leave),_7.hitch(_3d,"_onUnHover")),on(_38,_3a("focusout"),_7.hitch(_3d,"set","state",_31))];
},this);
this._set("connectId",_35);
},addTarget:function(_3e){
var id=_3e.id||_3e;
if(_1.indexOf(this._connectIds,id)==-1){
this.set("connectId",this._connectIds.concat(id));
}
},removeTarget:function(_3f){
var id=_3f.id||_3f,idx=_1.indexOf(this._connectIds,id);
if(idx>=0){
this._connectIds.splice(idx,1);
this.set("connectId",this._connectIds);
}
},buildRendering:function(){
this.inherited(arguments);
_4.add(this.domNode,"dijitTooltipData");
},startup:function(){
this.inherited(arguments);
var ids=this.connectId;
_1.forEach(_7.isArrayLike(ids)?ids:[ids],this.addTarget,this);
},getContent:function(_40){
return this.label||this.domNode.innerHTML;
},state:_31,_setStateAttr:function(val){
if(this.state==val||(val==_32&&this.state==_33)||(val==_34&&this.state==_31)){
return;
}
if(this._hideTimer){
this._hideTimer.remove();
delete this._hideTimer;
}
if(this._showTimer){
this._showTimer.remove();
delete this._showTimer;
}
switch(val){
case _31:
if(this._connectNode){
_18.hide(this._connectNode);
delete this._connectNode;
this.onHide();
}
break;
case _32:
if(this.state!=_33){
this._showTimer=this.defer(function(){
this.set("state",_33);
},this.showDelay);
}
break;
case _33:
var _41=this.getContent(this._connectNode);
if(!_41){
this.set("state",_31);
return;
}
_18.show(_41,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,_7.hitch(this,"set","state",_33),_7.hitch(this,"set","state",_34));
this.onShow(this._connectNode,this.position);
break;
case _34:
this._hideTimer=this.defer(function(){
this.set("state",_31);
},this.hideDelay);
break;
}
this._set("state",val);
},_onHover:function(_42){
if(this._connectNode&&_42!=this._connectNode){
this.set("state",_31);
}
this._connectNode=_42;
this.set("state",_32);
},_onUnHover:function(_43){
this.set("state",_34);
},open:function(_44){
this.set("state",_31);
this._connectNode=_44;
this.set("state",_33);
},close:function(){
this.set("state",_31);
},onShow:function(){
},onHide:function(){
},destroy:function(){
this.set("state",_31);
_1.forEach(this._connections||[],function(_45){
_1.forEach(_45,function(_46){
_46.remove();
});
},this);
this.inherited(arguments);
}});
_18._MasterTooltip=_11;
_18.show=_10.showTooltip;
_18.hide=_10.hideTooltip;
_18.defaultPosition=["after-centered","before-centered"];
return _18;
});


;define("dijit/form/_FormWidgetMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/dom-style","dojo/_base/lang","dojo/mouse","dojo/on","dojo/sniff","dojo/window","../a11y"],function(_1,_2,_3,_4,_5,_6,on,_7,_8,_9){
return _2("dijit.form._FormWidgetMixin",null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:false,intermediateChanges:false,scrollOnFocus:true,_setIdAttr:"focusNode",_setDisabledAttr:function(_a){
this._set("disabled",_a);
if(/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)){
_3.set(this.focusNode,"disabled",_a);
}else{
this.focusNode.setAttribute("aria-disabled",_a?"true":"false");
}
if(this.valueNode){
_3.set(this.valueNode,"disabled",_a);
}
if(_a){
this._set("hovering",false);
this._set("active",false);
var _b="tabIndex" in this.attributeMap?this.attributeMap.tabIndex:("_setTabIndexAttr" in this)?this._setTabIndexAttr:"focusNode";
_1.forEach(_5.isArray(_b)?_b:[_b],function(_c){
var _d=this[_c];
if(_7("webkit")||_9.hasDefaultTabStop(_d)){
_d.setAttribute("tabIndex","-1");
}else{
_d.removeAttribute("tabIndex");
}
},this);
}else{
if(this.tabIndex!=""){
this.set("tabIndex",this.tabIndex);
}
}
},_onFocus:function(by){
if(by=="mouse"&&this.isFocusable()){
var _e=this.own(on(this.focusNode,"focus",function(){
_f.remove();
_e.remove();
}))[0];
var _10=_7("pointer-events")?"pointerup":_7("MSPointer")?"MSPointerUp":_7("touch-events")?"touchend, mouseup":"mouseup";
var _f=this.own(on(this.ownerDocumentBody,_10,_5.hitch(this,function(evt){
_f.remove();
_e.remove();
if(this.focused){
if(evt.type=="touchend"){
this.defer("focus");
}else{
this.focus();
}
}
})))[0];
}
if(this.scrollOnFocus){
this.defer(function(){
_8.scrollIntoView(this.domNode);
});
}
this.inherited(arguments);
},isFocusable:function(){
return !this.disabled&&this.focusNode&&(_4.get(this.domNode,"display")!="none");
},focus:function(){
if(!this.disabled&&this.focusNode.focus){
try{
this.focusNode.focus();
}
catch(e){
}
}
},compare:function(_11,_12){
if(typeof _11=="number"&&typeof _12=="number"){
return (isNaN(_11)&&isNaN(_12))?0:_11-_12;
}else{
if(_11>_12){
return 1;
}else{
if(_11<_12){
return -1;
}else{
return 0;
}
}
}
},onChange:function(){
},_onChangeActive:false,_handleOnChange:function(_13,_14){
if(this._lastValueReported==undefined&&(_14===null||!this._onChangeActive)){
this._resetValue=this._lastValueReported=_13;
}
this._pendingOnChange=this._pendingOnChange||(typeof _13!=typeof this._lastValueReported)||(this.compare(_13,this._lastValueReported)!=0);
if((this.intermediateChanges||_14||_14===undefined)&&this._pendingOnChange){
this._lastValueReported=_13;
this._pendingOnChange=false;
if(this._onChangeActive){
if(this._onChangeHandle){
this._onChangeHandle.remove();
}
this._onChangeHandle=this.defer(function(){
this._onChangeHandle=null;
this.onChange(_13);
});
}
}
},create:function(){
this.inherited(arguments);
this._onChangeActive=true;
},destroy:function(){
if(this._onChangeHandle){
this._onChangeHandle.remove();
this.onChange(this._lastValueReported);
}
this.inherited(arguments);
}});
});


;define("dijit/form/_FormWidget",["dojo/_base/declare","dojo/sniff","dojo/_base/kernel","dojo/ready","../_Widget","../_CssStateMixin","../_TemplatedMixin","./_FormWidgetMixin","jazz/inverted!./_FormValueWidget"],function(_1,_2,_3,_4,_5,_6,_7,_8){
return _1("dijit.form._FormWidget",[_5,_7,_6,_8],{setDisabled:function(_9){
_3.deprecated("setDisabled("+_9+") is deprecated. Use set('disabled',"+_9+") instead.","","2.0");
this.set("disabled",_9);
},setValue:function(_a){
_3.deprecated("dijit.form._FormWidget:setValue("+_a+") is deprecated.  Use set('value',"+_a+") instead.","","2.0");
this.set("value",_a);
},getValue:function(){
_3.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.","","2.0");
return this.get("value");
},postMixInProperties:function(){
this.nameAttrSetting=(this.name&&!_2("msapp"))?("name=\""+this.name.replace(/"/g,"&quot;")+"\""):"";
this.inherited(arguments);
}});
});


;define("dijit/form/_FormValueMixin",["dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/lang","dojo/on","./_FormWidgetMixin"],function(_1,_2,_3,_4,on,_5){
return _1("dijit.form._FormValueMixin",_5,{readOnly:false,_setReadOnlyAttr:function(_6){
_2.set(this.focusNode,"readOnly",_6);
this._set("readOnly",_6);
},postCreate:function(){
this.inherited(arguments);
if(this._resetValue===undefined){
this._lastValueReported=this._resetValue=this.value;
}
},_setValueAttr:function(_7,_8){
this._handleOnChange(_7,_8);
},_handleOnChange:function(_9,_a){
this._set("value",_9);
this.inherited(arguments);
},undo:function(){
this._setValueAttr(this._lastValueReported,false);
},reset:function(){
this._hasBeenBlurred=false;
this._setValueAttr(this._resetValue,true);
}});
});


;define("dijit/form/_FormValueWidget",["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(_1,_2,_3,_4){
return _1("dijit.form._FormValueWidget",[_3,_4],{_layoutHackIE7:function(){
if(_2("ie")==7){
var _5=this.domNode;
var _6=_5.parentNode;
var _7=_5.firstChild||_5;
var _8=_7.style.filter;
var _9=this;
while(_6&&_6.clientHeight==0){
(function ping(){
var _a=_9.connect(_6,"onscroll",function(){
_9.disconnect(_a);
_7.style.filter=(new Date()).getMilliseconds();
_9.defer(function(){
_7.style.filter=_8;
});
});
})();
_6=_6.parentNode;
}
}
}});
});


;define("dijit/form/_ButtonMixin",["dojo/_base/declare","dojo/dom","dojo/has","../registry"],function(_1,_2,_3,_4){
var _5=_1("dijit.form._ButtonMixin"+(_3("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(e){
e.stopPropagation();
e.preventDefault();
if(!this.disabled){
this.valueNode.click(e);
}
return false;
},_onClick:function(e){
if(this.disabled){
e.stopPropagation();
e.preventDefault();
return false;
}
if(this.onClick(e)===false){
e.preventDefault();
}
var _6=e.defaultPrevented;
if(!_6&&this.type=="submit"&&!(this.valueNode||this.focusNode).form){
for(var _7=this.domNode;_7.parentNode;_7=_7.parentNode){
var _8=_4.byNode(_7);
if(_8&&typeof _8._onSubmit=="function"){
_8._onSubmit(e);
e.preventDefault();
_6=true;
break;
}
}
}
return !_6;
},postCreate:function(){
this.inherited(arguments);
_2.setSelectable(this.focusNode,false);
},onClick:function(){
return true;
},_setLabelAttr:function(_9){
this._set("label",_9);
var _a=this.containerNode||this.focusNode;
_a.innerHTML=_9;
}});
if(_3("dojo-bidi")){
_5=_1("dijit.form._ButtonMixin",_5,{_setLabelAttr:function(){
this.inherited(arguments);
var _b=this.containerNode||this.focusNode;
this.applyTextDir(_b);
}});
}
return _5;
});


;define("dojo/text!dijit/form/templates/Button.html", '<span class="dijit dijitReset dijitInline" role="presentation"\n	><span class="dijitReset dijitInline dijitButtonNode"\n		data-dojo-attach-event="ondijitclick:__onClick" role="presentation"\n		><span class="dijitReset dijitStretch dijitButtonContents"\n			data-dojo-attach-point="titleNode,focusNode"\n			role="button" aria-labelledby="${id}_label"\n			><span class="dijitReset dijitInline dijitIcon" data-dojo-attach-point="iconNode"></span\n			><span class="dijitReset dijitToggleButtonIconChar">&#x25CF;</span\n			><span class="dijitReset dijitInline dijitButtonText"\n				id="${id}_label"\n				data-dojo-attach-point="containerNode"\n			></span\n		></span\n	></span\n	><input ${!nameAttrSetting} type="${type}" value="${value}" class="dijitOffScreen"\n		data-dojo-attach-event="onclick:_onClick"\n		tabIndex="-1" aria-hidden="true" data-dojo-attach-point="valueNode"\n/></span>\n');

;define("dijit/form/Button",["require","dojo/_base/declare","dojo/dom-class","dojo/has","dojo/_base/kernel","dojo/_base/lang","dojo/ready","./_FormWidget","./_ButtonMixin","dojo/text!./templates/Button.html","jazz/inverted!./DropDownButton","jazz/inverted!./ComboButton","jazz/inverted!./ToggleButton","../a11yclick"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
var _b=_2("dijit.form.Button"+(_4("dojo-bidi")?"_NoBidi":""),[_8,_9],{showLabel:true,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:_a,_setValueAttr:"valueNode",_setNameAttr:function(_c){
if(this.valueNode){
this.valueNode.setAttribute("name",_c);
}
},_fillContent:function(_d){
if(_d&&(!this.params||!("label" in this.params))){
var _e=_6.trim(_d.innerHTML);
if(_e){
this.label=_e;
}
}
},_setShowLabelAttr:function(_f){
if(this.containerNode){
_3.toggle(this.containerNode,"dijitDisplayNone",!_f);
}
this._set("showLabel",_f);
},setLabel:function(_10){
_5.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");
this.set("label",_10);
},_setLabelAttr:function(_11){
this.inherited(arguments);
if(!this.showLabel&&!("title" in this.params)){
this.titleNode.title=_6.trim(this.containerNode.innerText||this.containerNode.textContent||"");
}
}});
if(_4("dojo-bidi")){
_b=_2("dijit.form.Button",_b,{_setLabelAttr:function(_12){
this.inherited(arguments);
if(this.titleNode.title){
this.applyTextDir(this.titleNode,this.titleNode.title);
}
},_setTextDirAttr:function(_13){
if(this._created&&this.textDir!=_13){
this._set("textDir",_13);
this._setLabelAttr(this.label);
}
}});
}
return _b;
});


;define("dijit/_HasDropDown",["dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/keys","dojo/_base/lang","dojo/on","dojo/touch","./registry","./focus","./popup","./_FocusMixin"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,on,_b,_c,_d,_e,_f){
return _1("dijit._HasDropDown",_f,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:true,forceWidth:false,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:true,_onDropDownMouseDown:function(e){
if(this.disabled||this.readOnly){
return;
}
if(e.type!="MSPointerDown"&&e.type!="pointerdown"){
e.preventDefault();
}
this.own(on.once(this.ownerDocument,_b.release,_a.hitch(this,"_onDropDownMouseUp")));
this.toggleDropDown();
},_onDropDownMouseUp:function(e){
var _10=this.dropDown,_11=false;
if(e&&this._opened){
var c=_6.position(this._buttonNode,true);
if(!(e.pageX>=c.x&&e.pageX<=c.x+c.w)||!(e.pageY>=c.y&&e.pageY<=c.y+c.h)){
var t=e.target;
while(t&&!_11){
if(_5.contains(t,"dijitPopup")){
_11=true;
}else{
t=t.parentNode;
}
}
if(_11){
t=e.target;
if(_10.onItemClick){
var _12;
while(t&&!(_12=_c.byNode(t))){
t=t.parentNode;
}
if(_12&&_12.onClick&&_12.getParent){
_12.getParent().onItemClick(_12,e);
}
}
return;
}
}
}
if(this._opened){
if(_10.focus&&(_10.autoFocus!==false||(e.type=="mouseup"&&!this.hovering))){
this._focusDropDownTimer=this.defer(function(){
_10.focus();
delete this._focusDropDownTimer;
});
}
}else{
if(this.focus){
this.defer("focus");
}
}
},_onDropDownClick:function(e){
if(this._stopClickEvents){
e.stopPropagation();
e.preventDefault();
}
},buildRendering:function(){
this.inherited(arguments);
this._buttonNode=this._buttonNode||this.focusNode||this.domNode;
this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;
var _13={"after":this.isLeftToRight()?"Right":"Left","before":this.isLeftToRight()?"Left":"Right","above":"Up","below":"Down","left":"Left","right":"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";
_5.add(this._arrowWrapperNode||this._buttonNode,"dijit"+_13+"ArrowButton");
},postCreate:function(){
this.inherited(arguments);
var _14=this.focusNode||this.domNode;
this.own(on(this._buttonNode,_b.press,_a.hitch(this,"_onDropDownMouseDown")),on(this._buttonNode,"click",_a.hitch(this,"_onDropDownClick")),on(_14,"keydown",_a.hitch(this,"_onKey")),on(_14,"keyup",_a.hitch(this,"_onKeyUp")));
},destroy:function(){
if(this._opened){
this.closeDropDown(true);
}
if(this.dropDown){
if(!this.dropDown._destroyed){
this.dropDown.destroyRecursive();
}
delete this.dropDown;
}
this.inherited(arguments);
},_onKey:function(e){
if(this.disabled||this.readOnly){
return;
}
var d=this.dropDown,_15=e.target;
if(d&&this._opened&&d.handleKey){
if(d.handleKey(e)===false){
e.stopPropagation();
e.preventDefault();
return;
}
}
if(d&&this._opened&&e.keyCode==_9.ESCAPE){
this.closeDropDown();
e.stopPropagation();
e.preventDefault();
}else{
if(!this._opened&&(e.keyCode==_9.DOWN_ARROW||((e.keyCode==_9.ENTER||(e.keyCode==_9.SPACE&&(!this._searchTimer||(e.ctrlKey||e.altKey||e.metaKey))))&&((_15.tagName||"").toLowerCase()!=="input"||(_15.type&&_15.type.toLowerCase()!=="text"))))){
this._toggleOnKeyUp=true;
e.stopPropagation();
e.preventDefault();
}
}
},_onKeyUp:function(){
if(this._toggleOnKeyUp){
delete this._toggleOnKeyUp;
this.toggleDropDown();
var d=this.dropDown;
if(d&&d.focus){
this.defer(_a.hitch(d,"focus"),1);
}
}
},_onBlur:function(){
this.closeDropDown(false);
this.inherited(arguments);
},isLoaded:function(){
return true;
},loadDropDown:function(_16){
_16();
},loadAndOpenDropDown:function(){
var d=new _2(),_17=_a.hitch(this,function(){
this.openDropDown();
d.resolve(this.dropDown);
});
if(!this.isLoaded()){
this.loadDropDown(_17);
}else{
_17();
}
return d;
},toggleDropDown:function(){
if(this.disabled||this.readOnly){
return;
}
if(!this._opened){
this.loadAndOpenDropDown();
}else{
this.closeDropDown(true);
}
},openDropDown:function(){
var _18=this.dropDown,_19=_18.domNode,_1a=this._aroundNode||this.domNode,_1b=this;
var _1c=_e.open({parent:this,popup:_18,around:_1a,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){
_1b.closeDropDown(true);
},onCancel:function(){
_1b.closeDropDown(true);
},onClose:function(){
_4.set(_1b._popupStateNode,"popupActive",false);
_5.remove(_1b._popupStateNode,"dijitHasDropDownOpen");
_1b._set("_opened",false);
}});
if(this.forceWidth||(this.autoWidth&&_1a.offsetWidth>_18._popupWrapper.offsetWidth)){
var _1d=_1a.offsetWidth-_18._popupWrapper.offsetWidth;
var _1e={w:_18.domNode.offsetWidth+_1d};
if(_a.isFunction(_18.resize)){
_18.resize(_1e);
}else{
_6.setMarginBox(_19,_1e);
}
if(_1c.corner[1]=="R"){
_18._popupWrapper.style.left=(_18._popupWrapper.style.left.replace("px","")-_1d)+"px";
}
}
_4.set(this._popupStateNode,"popupActive","true");
_5.add(this._popupStateNode,"dijitHasDropDownOpen");
this._set("_opened",true);
this._popupStateNode.setAttribute("aria-expanded","true");
this._popupStateNode.setAttribute("aria-owns",_18.id);
if(_19.getAttribute("role")!=="presentation"&&!_19.getAttribute("aria-labelledby")){
_19.setAttribute("aria-labelledby",this.id);
}
return _1c;
},closeDropDown:function(_1f){
if(this._focusDropDownTimer){
this._focusDropDownTimer.remove();
delete this._focusDropDownTimer;
}
if(this._opened){
this._popupStateNode.setAttribute("aria-expanded","false");
if(_1f&&this.focus){
this.focus();
}
_e.close(this.dropDown);
this._opened=false;
}
}});
});


;define("dojo/text!dijit/form/templates/DropDownButton.html", '<span class="dijit dijitReset dijitInline"\n	><span class=\'dijitReset dijitInline dijitButtonNode\'\n		data-dojo-attach-event="ondijitclick:__onClick" data-dojo-attach-point="_buttonNode"\n		><span class="dijitReset dijitStretch dijitButtonContents"\n			data-dojo-attach-point="focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\n			role="button" aria-haspopup="true" aria-labelledby="${id}_label"\n			><span class="dijitReset dijitInline dijitIcon"\n				data-dojo-attach-point="iconNode"\n			></span\n			><span class="dijitReset dijitInline dijitButtonText"\n				data-dojo-attach-point="containerNode"\n				id="${id}_label"\n			></span\n			><span class="dijitReset dijitInline dijitArrowButtonInner"></span\n			><span class="dijitReset dijitInline dijitArrowButtonChar">&#9660;</span\n		></span\n	></span\n	><input ${!nameAttrSetting} type="${type}" value="${value}" class="dijitOffScreen" tabIndex="-1"\n		data-dojo-attach-event="onclick:_onClick" data-dojo-attach-point="valueNode" aria-hidden="true"\n/></span>\n');

;define("dijit/form/DropDownButton",["dojo/_base/declare","dojo/_base/lang","dojo/query","../registry","../popup","./Button","../_Container","../_HasDropDown","dojo/text!./templates/DropDownButton.html","../a11yclick"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
return _1("dijit.form.DropDownButton",[_6,_7,_8],{baseClass:"dijitDropDownButton",templateString:_9,_fillContent:function(){
if(this.srcNodeRef){
var _a=_3("*",this.srcNodeRef);
this.inherited(arguments,[_a[0]]);
this.dropDownContainer=this.srcNodeRef;
}
},startup:function(){
if(this._started){
return;
}
if(!this.dropDown&&this.dropDownContainer){
var _b=_3("[widgetId]",this.dropDownContainer)[0];
if(_b){
this.dropDown=_4.byNode(_b);
}
delete this.dropDownContainer;
}
if(this.dropDown){
_5.hide(this.dropDown);
}
this.inherited(arguments);
},isLoaded:function(){
var _c=this.dropDown;
return (!!_c&&(!_c.href||_c.isLoaded));
},loadDropDown:function(_d){
var _e=this.dropDown;
var _f=_e.on("load",_2.hitch(this,function(){
_f.remove();
_d();
}));
_e.refresh();
},isFocusable:function(){
return this.inherited(arguments)&&!this._mouseDown;
}});
});


;define("dojo/text!dijit/form/templates/ComboButton.html", '<table class="dijit dijitReset dijitInline dijitLeft"\n	cellspacing=\'0\' cellpadding=\'0\' role="presentation"\n	><tbody role="presentation"><tr role="presentation"\n		><td class="dijitReset dijitStretch dijitButtonNode" data-dojo-attach-point="buttonNode" data-dojo-attach-event="ondijitclick:__onClick,onkeydown:_onButtonKeyDown"\n		><div id="${id}_button" class="dijitReset dijitButtonContents"\n			data-dojo-attach-point="titleNode"\n			role="button" aria-labelledby="${id}_label"\n			><div class="dijitReset dijitInline dijitIcon" data-dojo-attach-point="iconNode" role="presentation"></div\n			><div class="dijitReset dijitInline dijitButtonText" id="${id}_label" data-dojo-attach-point="containerNode" role="presentation"></div\n		></div\n		></td\n		><td id="${id}_arrow" class=\'dijitReset dijitRight dijitButtonNode dijitArrowButton\'\n			data-dojo-attach-point="_popupStateNode,focusNode,_buttonNode"\n			data-dojo-attach-event="onkeydown:_onArrowKeyDown"\n			title="${optionsTitle}"\n			role="button" aria-haspopup="true"\n			><div class="dijitReset dijitArrowButtonInner" role="presentation"></div\n			><div class="dijitReset dijitArrowButtonChar" role="presentation">&#9660;</div\n		></td\n		><td style="display:none !important;"\n			><input ${!nameAttrSetting} type="${type}" value="${value}" data-dojo-attach-point="valueNode"\n				class="dijitOffScreen" aria-hidden="true" data-dojo-attach-event="onclick:_onClick"\n		/></td></tr></tbody\n></table>\n');

;define("dijit/form/ComboButton",["dojo/_base/declare","dojo/keys","../focus","./DropDownButton","dojo/text!./templates/ComboButton.html","../a11yclick"],function(_1,_2,_3,_4,_5){
return _1("dijit.form.ComboButton",_4,{templateString:_5,_setIdAttr:"",_setTabIndexAttr:["focusNode","titleNode"],_setTitleAttr:"titleNode",optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{"buttonNode":"dijitButtonNode","titleNode":"dijitButtonContents","_popupStateNode":"dijitDownArrowButton"},_focusedNode:null,_onButtonKeyDown:function(_6){
if(_6.keyCode==_2[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]){
_3.focus(this._popupStateNode);
_6.stopPropagation();
_6.preventDefault();
}
},_onArrowKeyDown:function(_7){
if(_7.keyCode==_2[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"]){
_3.focus(this.titleNode);
_7.stopPropagation();
_7.preventDefault();
}
},focus:function(_8){
if(!this.disabled){
_3.focus(_8=="start"?this.titleNode:this._popupStateNode);
}
}});
});


;define("dijit/form/_ToggleButtonMixin",["dojo/_base/declare","dojo/dom-attr"],function(_1,_2){
return _1("dijit.form._ToggleButtonMixin",null,{checked:false,_aria_attr:"aria-pressed",_onClick:function(_3){
var _4=this.checked;
this._set("checked",!_4);
var _5=this.inherited(arguments);
this.set("checked",_5?this.checked:_4);
return _5;
},_setCheckedAttr:function(_6,_7){
this._set("checked",_6);
var _8=this.focusNode||this.domNode;
if(this._created){
if(_2.get(_8,"checked")!=!!_6){
_2.set(_8,"checked",!!_6);
}
}
_8.setAttribute(this._aria_attr,String(_6));
this._handleOnChange(_6,_7);
},postCreate:function(){
this.inherited(arguments);
var _9=this.focusNode||this.domNode;
if(this.checked){
_9.setAttribute("checked","checked");
}
if(this._resetValue===undefined){
this._lastValueReported=this._resetValue=this.checked;
}
},reset:function(){
this._hasBeenBlurred=false;
this.set("checked",this.params.checked||false);
}});
});


;define("dijit/form/ToggleButton",["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(_1,_2,_3,_4){
return _1("dijit.form.ToggleButton",[_3,_4],{baseClass:"dijitToggleButton",setChecked:function(_5){
_2.deprecated("setChecked("+_5+") is deprecated. Use set('checked',"+_5+") instead.","","2.0");
this.set("checked",_5);
}});
});


;define("dijit/form/_CheckBoxMixin",["dojo/_base/declare","dojo/dom-attr"],function(_1,_2){
return _1("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:false,_aria_attr:"aria-checked",_setReadOnlyAttr:function(_3){
this._set("readOnly",_3);
_2.set(this.focusNode,"readOnly",_3);
},_setLabelAttr:undefined,_getSubmitValue:function(_4){
return (_4==null||_4==="")?"on":_4;
},_setValueAttr:function(_5){
_5=this._getSubmitValue(_5);
this._set("value",_5);
_2.set(this.focusNode,"value",_5);
},reset:function(){
this.inherited(arguments);
this._set("value",this._getSubmitValue(this.params.value));
_2.set(this.focusNode,"value",this.value);
},_onClick:function(e){
if(this.readOnly){
e.stopPropagation();
e.preventDefault();
return false;
}
return this.inherited(arguments);
}});
});


;define("dojo/text!dijit/form/templates/CheckBox.html", '<div class="dijit dijitReset dijitInline" role="presentation"\n	><input\n	 	${!nameAttrSetting} type="${type}" role="${type}" aria-checked="false" ${checkedAttrSetting}\n		class="dijitReset dijitCheckBoxInput"\n		data-dojo-attach-point="focusNode"\n	 	data-dojo-attach-event="ondijitclick:_onClick"\n/></div>\n');

;define("dijit/form/CheckBox",["require","dojo/_base/declare","dojo/dom-attr","dojo/has","dojo/query","dojo/ready","./ToggleButton","./_CheckBoxMixin","dojo/text!./templates/CheckBox.html","dojo/NodeList-dom","../a11yclick","jazz/inverted!./RadioButton"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
return _2("dijit.form.CheckBox",[_7,_8],{templateString:_9,baseClass:"dijitCheckBox",_setValueAttr:function(_a,_b){
if(typeof _a=="string"){
this.inherited(arguments);
_a=true;
}
if(this._created){
this.set("checked",_a,_b);
}
},_getValueAttr:function(){
return this.checked&&this._get("value");
},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){
this.inherited(arguments);
this.checkedAttrSetting="";
},_fillContent:function(){
},_onFocus:function(){
if(this.id){
_5("label[for='"+this.id+"']").addClass("dijitFocusedLabel");
}
this.inherited(arguments);
},_onBlur:function(){
if(this.id){
_5("label[for='"+this.id+"']").removeClass("dijitFocusedLabel");
}
this.inherited(arguments);
}});
});


;define("dijit/form/_RadioButtonMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/_base/lang","dojo/query","../registry"],function(_1,_2,_3,_4,_5,_6){
return _2("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){
var _7=[];
_5("input[type=radio]",this.focusNode.form||this.ownerDocument).forEach(_4.hitch(this,function(_8){
if(_8.name==this.name&&_8.form==this.focusNode.form){
var _9=_6.getEnclosingWidget(_8);
if(_9){
_7.push(_9);
}
}
}));
return _7;
},_setCheckedAttr:function(_a){
this.inherited(arguments);
if(!this._created){
return;
}
if(_a){
_1.forEach(this._getRelatedWidgets(),_4.hitch(this,function(_b){
if(_b!=this&&_b.checked){
_b.set("checked",false);
}
}));
}
},_getSubmitValue:function(_c){
return _c==null?"on":_c;
},_onClick:function(e){
if(this.checked||this.disabled){
e.stopPropagation();
e.preventDefault();
return false;
}
if(this.readOnly){
e.stopPropagation();
e.preventDefault();
_1.forEach(this._getRelatedWidgets(),_4.hitch(this,function(_d){
_3.set(this.focusNode||this.domNode,"checked",_d.checked);
}));
return false;
}
return this.inherited(arguments);
}});
});


;define("dijit/form/RadioButton",["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(_1,_2,_3){
return _1("dijit.form.RadioButton",[_2,_3],{baseClass:"dijitRadio"});
});


;define("dijit/form/_TextBoxMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/sniff","dojo/keys","dojo/_base/lang","dojo/on","../main"],function(_1,_2,_3,_4,_5,_6,on,_7){
var _8=_2("dijit.form._TextBoxMixin"+(_4("dojo-bidi")?"_NoBidi":""),null,{trim:false,uppercase:false,lowercase:false,propercase:false,maxLength:"",selectOnClick:false,placeHolder:"",_getValueAttr:function(){
return this.parse(this.get("displayedValue"),this.constraints);
},_setValueAttr:function(_9,_a,_b){
var _c;
if(_9!==undefined){
_c=this.filter(_9);
if(typeof _b!="string"){
if(_c!==null&&((typeof _c!="number")||!isNaN(_c))){
_b=this.filter(this.format(_c,this.constraints));
}else{
_b="";
}
if(this.compare(_c,this.filter(this.parse(_b,this.constraints)))!=0){
_b=null;
}
}
}
if(_b!=null&&((typeof _b)!="number"||!isNaN(_b))&&this.textbox.value!=_b){
this.textbox.value=_b;
this._set("displayedValue",this.get("displayedValue"));
}
this.inherited(arguments,[_c,_a]);
},displayedValue:"",_getDisplayedValueAttr:function(){
return this.filter(this.textbox.value);
},_setDisplayedValueAttr:function(_d){
if(_d==null){
_d="";
}else{
if(typeof _d!="string"){
_d=String(_d);
}
}
this.textbox.value=_d;
this._setValueAttr(this.get("value"),undefined);
this._set("displayedValue",this.get("displayedValue"));
},format:function(_e){
return _e==null?"":(_e.toString?_e.toString():_e);
},parse:function(_f){
return _f;
},_refreshState:function(){
},onInput:function(evt){
this._lastInputProducingEvent=evt;
},_onInput:function(){
this._lastInputEventValue=this.textbox.value;
this._processInput(this._lastInputProducingEvent);
if(this.intermediateChanges){
this._handleOnChange(this.get("value"),false);
}
},_processInput:function(evt){
this._refreshState();
this._set("displayedValue",this.get("displayedValue"));
},postCreate:function(){
this.textbox.setAttribute("value",this.textbox.value);
this.inherited(arguments);
function _10(e){
var _11;
if(e.type=="keydown"){
_11=e.keyCode;
switch(_11){
case _5.SHIFT:
case _5.ALT:
case _5.CTRL:
case _5.META:
case _5.CAPS_LOCK:
case _5.NUM_LOCK:
case _5.SCROLL_LOCK:
return;
}
if(!e.ctrlKey&&!e.metaKey&&!e.altKey){
switch(_11){
case _5.NUMPAD_0:
case _5.NUMPAD_1:
case _5.NUMPAD_2:
case _5.NUMPAD_3:
case _5.NUMPAD_4:
case _5.NUMPAD_5:
case _5.NUMPAD_6:
case _5.NUMPAD_7:
case _5.NUMPAD_8:
case _5.NUMPAD_9:
case _5.NUMPAD_MULTIPLY:
case _5.NUMPAD_PLUS:
case _5.NUMPAD_ENTER:
case _5.NUMPAD_MINUS:
case _5.NUMPAD_PERIOD:
case _5.NUMPAD_DIVIDE:
return;
}
if((_11>=65&&_11<=90)||(_11>=48&&_11<=57)||_11==_5.SPACE){
return;
}
var _12=false;
for(var i in _5){
if(_5[i]===e.keyCode){
_12=true;
break;
}
}
if(!_12){
return;
}
}
}
_11=e.charCode>=32?String.fromCharCode(e.charCode):e.charCode;
if(!_11){
_11=(e.keyCode>=65&&e.keyCode<=90)||(e.keyCode>=48&&e.keyCode<=57)||e.keyCode==_5.SPACE?String.fromCharCode(e.keyCode):e.keyCode;
}
if(!_11){
_11=229;
}
if(e.type=="keypress"){
if(typeof _11!="string"){
return;
}
if((_11>="a"&&_11<="z")||(_11>="A"&&_11<="Z")||(_11>="0"&&_11<="9")||(_11===" ")){
if(e.ctrlKey||e.metaKey||e.altKey){
return;
}
}
}
var _13={faux:true},_14;
for(_14 in e){
if(!/^(layer[XY]|returnValue|keyLocation)$/.test(_14)){
var v=e[_14];
if(typeof v!="function"&&typeof v!="undefined"){
_13[_14]=v;
}
}
}
_6.mixin(_13,{charOrCode:_11,_wasConsumed:false,preventDefault:function(){
_13._wasConsumed=true;
e.preventDefault();
},stopPropagation:function(){
e.stopPropagation();
}});
if(this.onInput(_13)===false){
_13.preventDefault();
_13.stopPropagation();
}
if(_13._wasConsumed){
return;
}
if(_4("ie")<=9){
switch(e.keyCode){
case _5.TAB:
case _5.ESCAPE:
case _5.DOWN_ARROW:
case _5.UP_ARROW:
case _5.LEFT_ARROW:
case _5.RIGHT_ARROW:
break;
default:
if(e.keyCode==_5.ENTER&&this.textbox.tagName.toLowerCase()!="textarea"){
break;
}
this.defer(function(){
if(this.textbox.value!==this._lastInputEventValue){
on.emit(this.textbox,"input",{bubbles:true});
}
});
}
}
};
this.own(on(this.textbox,"keydown, keypress, paste, cut, compositionend",_6.hitch(this,_10)),on(this.textbox,"input",_6.hitch(this,"_onInput")),on(this.domNode,"keypress",function(e){
e.stopPropagation();
}));
},_blankValue:"",filter:function(val){
if(val===null){
return this._blankValue;
}
if(typeof val!="string"){
return val;
}
if(this.trim){
val=_6.trim(val);
}
if(this.uppercase){
val=val.toUpperCase();
}
if(this.lowercase){
val=val.toLowerCase();
}
if(this.propercase){
val=val.replace(/[^\s]+/g,function(_15){
return _15.substring(0,1).toUpperCase()+_15.substring(1);
});
}
return val;
},_setBlurValue:function(){
this._setValueAttr(this.get("value"),true);
},_onBlur:function(e){
if(this.disabled){
return;
}
this._setBlurValue();
this.inherited(arguments);
},_isTextSelected:function(){
return this.textbox.selectionStart!=this.textbox.selectionEnd;
},_onFocus:function(by){
if(this.disabled||this.readOnly){
return;
}
if(this.selectOnClick&&by=="mouse"){
this._selectOnClickHandle=on.once(this.domNode,"mouseup, touchend",_6.hitch(this,function(evt){
if(!this._isTextSelected()){
_8.selectInputText(this.textbox);
}
}));
this.own(this._selectOnClickHandle);
this.defer(function(){
if(this._selectOnClickHandle){
this._selectOnClickHandle.remove();
this._selectOnClickHandle=null;
}
},500);
}
this.inherited(arguments);
this._refreshState();
},reset:function(){
this.textbox.value="";
this.inherited(arguments);
}});
if(_4("dojo-bidi")){
_8=_2("dijit.form._TextBoxMixin",_8,{_setValueAttr:function(){
this.inherited(arguments);
this.applyTextDir(this.focusNode);
},_setDisplayedValueAttr:function(){
this.inherited(arguments);
this.applyTextDir(this.focusNode);
},_onInput:function(){
this.applyTextDir(this.focusNode);
this.inherited(arguments);
}});
}
_8._setSelectionRange=_7._setSelectionRange=function(_16,_17,_18){
if(_16.setSelectionRange){
_16.setSelectionRange(_17,_18);
}
};
_8.selectInputText=_7.selectInputText=function(_19,_1a,_1b){
_19=_3.byId(_19);
if(isNaN(_1a)){
_1a=0;
}
if(isNaN(_1b)){
_1b=_19.value?_19.value.length:0;
}
try{
_19.focus();
_8._setSelectionRange(_19,_1a,_1b);
}
catch(e){
}
};
return _8;
});


;define("dojo/text!dijit/form/templates/TextBox.html", '<div class="dijit dijitReset dijitInline dijitLeft" id="widget_${id}" role="presentation"\n	><div class="dijitReset dijitInputField dijitInputContainer"\n		><input class="dijitReset dijitInputInner" data-dojo-attach-point=\'textbox,focusNode\' autocomplete="off"\n			${!nameAttrSetting} type=\'${type}\'\n	/></div\n></div>\n');

;define("dijit/form/TextBox",["dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/sniff","./_FormValueWidget","./_TextBoxMixin","dojo/text!./templates/TextBox.html","../main"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9,_a){
var _b=_1("dijit.form.TextBox"+(_6("dojo-bidi")?"_NoBidi":""),[_7,_8],{templateString:_9,_singleNodeTemplate:"<input class=\"dijit dijitReset dijitLeft dijitInputField\" data-dojo-attach-point=\"textbox,focusNode\" autocomplete=\"off\" type=\"${type}\" ${!nameAttrSetting} />",_buttonInputDisabled:_6("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){
var _c=this.type.toLowerCase();
if(this.templateString&&this.templateString.toLowerCase()=="input"||((_c=="hidden"||_c=="file")&&this.templateString==this.constructor.prototype.templateString)){
this.templateString=this._singleNodeTemplate;
}
this.inherited(arguments);
},postCreate:function(){
this.inherited(arguments);
if(_6("ie")<9){
this.defer(function(){
try{
var s=_3.getComputedStyle(this.domNode);
if(s){
var ff=s.fontFamily;
if(ff){
var _d=this.domNode.getElementsByTagName("INPUT");
if(_d){
for(var i=0;i<_d.length;i++){
_d[i].style.fontFamily=ff;
}
}
}
}
}
catch(e){
}
});
}
},_setPlaceHolderAttr:function(v){
this._set("placeHolder",v);
if(!this._phspan){
this._attachPoints.push("_phspan");
this._phspan=_2.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after");
this.own(on(this._phspan,"mousedown",function(_e){
_e.preventDefault();
}),on(this._phspan,"touchend, pointerup, MSPointerUp",_5.hitch(this,function(){
this.focus();
})));
}
this._phspan.innerHTML="";
this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(v));
this._updatePlaceHolder();
},_onInput:function(_f){
this.inherited(arguments);
this._updatePlaceHolder();
},_updatePlaceHolder:function(){
if(this._phspan){
this._phspan.style.display=(this.placeHolder&&!this.textbox.value)?"":"none";
}
},_setValueAttr:function(_10,_11,_12){
this.inherited(arguments);
this._updatePlaceHolder();
},getDisplayedValue:function(){
_4.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");
return this.get("displayedValue");
},setDisplayedValue:function(_13){
_4.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");
this.set("displayedValue",_13);
},_onBlur:function(e){
if(this.disabled){
return;
}
this.inherited(arguments);
this._updatePlaceHolder();
if(_6("mozilla")){
if(this.selectOnClick){
this.textbox.selectionStart=this.textbox.selectionEnd=undefined;
}
}
},_onFocus:function(by){
if(this.disabled||this.readOnly){
return;
}
this.inherited(arguments);
this._updatePlaceHolder();
}});
if(_6("ie")<9){
_b.prototype._isTextSelected=function(){
var _14=this.ownerDocument.selection.createRange();
var _15=_14.parentElement();
return _15==this.textbox&&_14.text.length>0;
};
_a._setSelectionRange=_8._setSelectionRange=function(_16,_17,_18){
if(_16.createTextRange){
var r=_16.createTextRange();
r.collapse(true);
r.moveStart("character",-99999);
r.moveStart("character",_17);
r.moveEnd("character",_18-_17);
r.select();
}
};
}
if(_6("dojo-bidi")){
_b=_1("dijit.form.TextBox",_b,{_setPlaceHolderAttr:function(v){
this.inherited(arguments);
this.applyTextDir(this._phspan);
}});
}
return _b;
});


;define("dojo/text!dijit/form/templates/ValidationTextBox.html", '<div class="dijit dijitReset dijitInline dijitLeft"\n	id="widget_${id}" role="presentation"\n	><div class=\'dijitReset dijitValidationContainer\'\n		><input class="dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value="&#935; " type="text" tabIndex="-1" readonly="readonly" role="presentation"\n	/></div\n	><div class="dijitReset dijitInputField dijitInputContainer"\n		><input class="dijitReset dijitInputInner" data-dojo-attach-point=\'textbox,focusNode\' autocomplete="off"\n			${!nameAttrSetting} type=\'${type}\'\n	/></div\n></div>\n');

;define("dojo/i18n!dijit/form/nls/validate", {"invalidMessage":"The value entered is not valid.","missingMessage":"This value is required.","rangeMessage":"This value is out of range."});

;define("dijit/form/ValidationTextBox",["dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/i18n","./TextBox","../Tooltip","dojo/text!./templates/ValidationTextBox.html","dojo/i18n!./nls/validate"],function(_1,_2,_3,_4,_5,_6,_7){
var _8=_1("dijit.form.ValidationTextBox",_5,{templateString:_7,required:false,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",regExpGen:function(){
},state:"",tooltipPosition:[],_deprecateRegExp:function(_9,_a){
if(_a!=_8.prototype[_9]){
_2.deprecated("ValidationTextBox id="+this.id+", set('"+_9+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0");
this.set("pattern",_a);
}
},_setRegExpGenAttr:function(_b){
this._deprecateRegExp("regExpGen",_b);
this._set("regExpGen",this._computeRegexp);
},_setRegExpAttr:function(_c){
this._deprecateRegExp("regExp",_c);
},_setValueAttr:function(){
this.inherited(arguments);
this._refreshState();
},validator:function(_d,_e){
return (new RegExp("^(?:"+this._computeRegexp(_e)+")"+(this.required?"":"?")+"$")).test(_d)&&(!this.required||!this._isEmpty(_d))&&(this._isEmpty(_d)||this.parse(_d,_e)!==undefined);
},_isValidSubset:function(){
return this.textbox.value.search(this._partialre)==0;
},isValid:function(){
return this.validator(this.textbox.value,this.get("constraints"));
},_isEmpty:function(_f){
return (this.trim?/^\s*$/:/^$/).test(_f);
},getErrorMessage:function(){
var _10=this.invalidMessage=="$_unset_$"?this.messages.invalidMessage:!this.invalidMessage?this.promptMessage:this.invalidMessage;
var _11=this.missingMessage=="$_unset_$"?this.messages.missingMessage:!this.missingMessage?_10:this.missingMessage;
return (this.required&&this._isEmpty(this.textbox.value))?_11:_10;
},getPromptMessage:function(){
return this.promptMessage;
},_maskValidSubsetError:true,validate:function(_12){
var _13="";
var _14=this.disabled||this.isValid(_12);
if(_14){
this._maskValidSubsetError=true;
}
var _15=this._isEmpty(this.textbox.value);
var _16=!_14&&_12&&this._isValidSubset();
this._set("state",_14?"":(((((!this._hasBeenBlurred||_12)&&_15)||_16)&&(this._maskValidSubsetError||(_16&&!this._hasBeenBlurred&&_12)))?"Incomplete":"Error"));
this.focusNode.setAttribute("aria-invalid",this.state=="Error"?"true":"false");
if(this.state=="Error"){
this._maskValidSubsetError=_12&&_16;
_13=this.getErrorMessage(_12);
}else{
if(this.state=="Incomplete"){
_13=this.getPromptMessage(_12);
this._maskValidSubsetError=!this._hasBeenBlurred||_12;
}else{
if(_15){
_13=this.getPromptMessage(_12);
}
}
}
this.set("message",_13);
return _14;
},displayMessage:function(_17){
if(_17&&this.focused){
_6.show(_17,this.domNode,this.tooltipPosition,!this.isLeftToRight());
}else{
_6.hide(this.domNode);
}
},_refreshState:function(){
if(this._created){
this.validate(this.focused);
}
this.inherited(arguments);
},constructor:function(_18){
this.constraints=_3.clone(this.constraints);
this.baseClass+=" dijitValidationTextBox";
},startup:function(){
this.inherited(arguments);
this._refreshState();
},_setConstraintsAttr:function(_19){
if(!_19.locale&&this.lang){
_19.locale=this.lang;
}
this._set("constraints",_19);
this._refreshState();
},_setPatternAttr:function(_1a){
this._set("pattern",_1a);
this._refreshState();
},_computeRegexp:function(_1b){
var p=this.pattern;
if(typeof p=="function"){
p=p.call(this,_1b);
}
if(p!=this._lastRegExp){
var _1c="";
this._lastRegExp=p;
if(p!=".*"){
p.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(re){
switch(re.charAt(0)){
case "{":
case "+":
case "?":
case "*":
case "^":
case "$":
case "|":
case "(":
_1c+=re;
break;
case ")":
_1c+="|$)";
break;
default:
_1c+="(?:"+re+"|$)";
break;
}
});
}
try{
"".search(_1c);
}
catch(e){
_1c=this.pattern;
console.warn("RegExp error in "+this.declaredClass+": "+this.pattern);
}
this._partialre="^(?:"+_1c+")$";
}
return p;
},postMixInProperties:function(){
this.inherited(arguments);
this.messages=_4.getLocalization("dijit.form","validate",this.lang);
this._setConstraintsAttr(this.constraints);
},_setDisabledAttr:function(_1d){
this.inherited(arguments);
this._refreshState();
},_setRequiredAttr:function(_1e){
this._set("required",_1e);
this.focusNode.setAttribute("aria-required",_1e);
this._refreshState();
},_setMessageAttr:function(_1f){
this._set("message",_1f);
this.displayMessage(_1f);
},reset:function(){
this._maskValidSubsetError=true;
this.inherited(arguments);
},_onBlur:function(){
this.displayMessage("");
this.inherited(arguments);
},destroy:function(){
_6.hide(this.domNode);
this.inherited(arguments);
}});
return _8;
});


;define("dojo/store/util/QueryResults",["../../_base/array","../../_base/lang","../../when"],function(_1,_2,_3){
var _4=function(_5){
if(!_5){
return _5;
}
var _6=!!_5.then;
if(_6){
_5=_2.delegate(_5);
}
function _7(_8){
_5[_8]=function(){
var _9=arguments;
var _a=_3(_5,function(_b){
Array.prototype.unshift.call(_9,_b);
return _4(_1[_8].apply(_1,_9));
});
if(_8!=="forEach"||_6){
return _a;
}
};
};
_7("forEach");
_7("filter");
_7("map");
if(_5.total==null){
_5.total=_3(_5,function(_c){
return _c.length;
});
}
return _5;
};
_2.setObject("dojo.store.util.QueryResults",_4);
return _4;
});


;define("dojo/regexp",["./_base/kernel","./_base/lang"],function(_1,_2){
var _3={};
_2.setObject("dojo.regexp",_3);
_3.escapeString=function(_4,_5){
return _4.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(ch){
if(_5&&_5.indexOf(ch)!=-1){
return ch;
}
return "\\"+ch;
});
};
_3.buildGroupRE=function(_6,re,_7){
if(!(_6 instanceof Array)){
return re(_6);
}
var b=[];
for(var i=0;i<_6.length;i++){
b.push(re(_6[i]));
}
return _3.group(b.join("|"),_7);
};
_3.group=function(_8,_9){
return "("+(_9?"?:":"")+_8+")";
};
return _3;
});


;define("dojo/store/util/SimpleQueryEngine",["../../_base/array"],function(_1){
return function(_2,_3){
switch(typeof _2){
default:
throw new Error("Can not query with a "+typeof _2);
case "object":
case "undefined":
var _4=_2;
_2=function(_5){
for(var _6 in _4){
var _7=_4[_6];
if(_7&&_7.test){
if(!_7.test(_5[_6],_5)){
return false;
}
}else{
if(_7!=_5[_6]){
return false;
}
}
}
return true;
};
break;
case "string":
if(!this[_2]){
throw new Error("No filter function "+_2+" was found in store");
}
_2=this[_2];
case "function":
}
function _8(_9){
var _a=_1.filter(_9,_2);
var _b=_3&&_3.sort;
if(_b){
_a.sort(typeof _b=="function"?_b:function(a,b){
for(var _c,i=0;_c=_b[i];i++){
var _d=a[_c.attribute];
var _e=b[_c.attribute];
_d=_d!=null?_d.valueOf():_d;
_e=_e!=null?_e.valueOf():_e;
if(_d!=_e){
return !!_c.descending==(_d==null||_d>_e)?-1:1;
}
}
return 0;
});
}
if(_3&&(_3.start||_3.count)){
var _f=_a.length;
_a=_a.slice(_3.start||0,(_3.start||0)+(_3.count||Infinity));
_a.total=_f;
}
return _a;
};
_8.matches=_2;
return _8;
};
});


;define("dojo/store/Memory",["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(_1,_2,_3){
var _4=null;
return _1("dojo.store.Memory",_4,{constructor:function(_5){
for(var i in _5){
this[i]=_5[i];
}
this.setData(this.data||[]);
},data:null,idProperty:"id",index:null,queryEngine:_3,get:function(id){
return this.data[this.index[id]];
},getIdentity:function(_6){
return _6[this.idProperty];
},put:function(_7,_8){
var _9=this.data,_a=this.index,_b=this.idProperty;
var id=_7[_b]=(_8&&"id" in _8)?_8.id:_b in _7?_7[_b]:Math.random();
if(id in _a){
if(_8&&_8.overwrite===false){
throw new Error("Object already exists");
}
_9[_a[id]]=_7;
}else{
_a[id]=_9.push(_7)-1;
}
return id;
},add:function(_c,_d){
(_d=_d||{}).overwrite=false;
return this.put(_c,_d);
},remove:function(id){
var _e=this.index;
var _f=this.data;
if(id in _e){
_f.splice(_e[id],1);
this.setData(_f);
return true;
}
},query:function(_10,_11){
return _2(this.queryEngine(_10,_11)(this.data));
},setData:function(_12){
if(_12.items){
this.idProperty=_12.identifier||this.idProperty;
_12=this.data=_12.items;
}else{
this.data=_12;
}
this.index={};
for(var i=0,l=_12.length;i<l;i++){
this.index[_12[i][this.idProperty]]=i;
}
}});
});


;define("dijit/form/DataList",["dojo/_base/declare","dojo/dom","dojo/_base/lang","dojo/query","dojo/store/Memory","../registry"],function(_1,_2,_3,_4,_5,_6){
function _7(_8){
return {id:_8.value,value:_8.value,name:_3.trim(_8.innerText||_8.textContent||"")};
};
return _1("dijit.form.DataList",_5,{constructor:function(_9,_a){
this.domNode=_2.byId(_a);
_3.mixin(this,_9);
if(this.id){
_6.add(this);
}
this.domNode.style.display="none";
this.inherited(arguments,[{data:_4("option",this.domNode).map(_7)}]);
},destroy:function(){
_6.remove(this.id);
},fetchSelectedItem:function(){
var _b=_4("> option[selected]",this.domNode)[0]||_4("> option",this.domNode)[0];
return _b&&_7(_b);
}});
});


;define("dijit/form/_SearchMixin",["dojo/_base/declare","dojo/keys","dojo/_base/lang","dojo/query","dojo/string","dojo/when","../registry"],function(_1,_2,_3,_4,_5,_6,_7){
return _1("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(_8){
this._set("list",_8);
},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:true,_patternToRegExp:function(_9){
return new RegExp("^"+_9.replace(/(\\.)|(\*)|(\?)|\W/g,function(_a,_b,_c,_d){
return _c?".*":_d?".":_b?_b:"\\"+_a;
})+"$",this.ignoreCase?"mi":"m");
},_abortQuery:function(){
if(this.searchTimer){
this.searchTimer=this.searchTimer.remove();
}
if(this._queryDeferHandle){
this._queryDeferHandle=this._queryDeferHandle.remove();
}
if(this._fetchHandle){
if(this._fetchHandle.abort){
this._cancelingQuery=true;
this._fetchHandle.abort();
this._cancelingQuery=false;
}
if(this._fetchHandle.cancel){
this._cancelingQuery=true;
this._fetchHandle.cancel();
this._cancelingQuery=false;
}
this._fetchHandle=null;
}
},_processInput:function(_e){
if(this.disabled||this.readOnly){
return;
}
var _f=_e.charOrCode;
var _10=false;
this._prev_key_backspace=false;
switch(_f){
case _2.DELETE:
case _2.BACKSPACE:
this._prev_key_backspace=true;
this._maskValidSubsetError=true;
_10=true;
break;
default:
_10=typeof _f=="string"||_f==229;
}
if(_10){
if(!this.store){
this.onSearch();
}else{
this.searchTimer=this.defer("_startSearchFromInput",1);
}
}
},onSearch:function(){
},_startSearchFromInput:function(){
this._startSearch(this.focusNode.value);
},_startSearch:function(_11){
this._abortQuery();
var _12=this,_4=_3.clone(this.query),_13={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:true}},qs=_5.substitute(this.queryExpr,[_11.replace(/([\\\*\?])/g,"\\$1")]),q,_14=function(){
var _15=_12._fetchHandle=_12.store.query(_4,_13);
if(_12.disabled||_12.readOnly||(q!==_12._lastQuery)){
return;
}
_6(_15,function(res){
_12._fetchHandle=null;
if(!_12.disabled&&!_12.readOnly&&(q===_12._lastQuery)){
_6(_15.total,function(_16){
res.total=_16;
var _17=_12.pageSize;
if(isNaN(_17)||_17>res.total){
_17=res.total;
}
res.nextPage=function(_18){
_13.direction=_18=_18!==false;
_13.count=_17;
if(_18){
_13.start+=res.length;
if(_13.start>=res.total){
_13.count=0;
}
}else{
_13.start-=_17;
if(_13.start<0){
_13.count=Math.max(_17+_13.start,0);
_13.start=0;
}
}
if(_13.count<=0){
res.length=0;
_12.onSearch(res,_4,_13);
}else{
_14();
}
};
_12.onSearch(res,_4,_13);
});
}
},function(err){
_12._fetchHandle=null;
if(!_12._cancelingQuery){
console.error(_12.declaredClass+" "+err.toString());
}
});
};
_3.mixin(_13,this.fetchProperties);
if(this.store._oldAPI){
q=qs;
}else{
q=this._patternToRegExp(qs);
q.toString=function(){
return qs;
};
}
this._lastQuery=_4[this.searchAttr]=q;
this._queryDeferHandle=this.defer(_14,this.searchDelay);
},constructor:function(){
this.query={};
this.fetchProperties={};
},postMixInProperties:function(){
if(!this.store){
var _19=this.list;
if(_19){
this.store=_7.byId(_19);
}
}
this.inherited(arguments);
}});
});


;define("dijit/form/_AutoCompleterMixin",["dojo/aspect","dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/lang","dojo/query","dojo/regexp","dojo/sniff","./DataList","./_TextBoxMixin","./_SearchMixin"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
var _c=_2("dijit.form._AutoCompleterMixin",_b,{item:null,autoComplete:true,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:false,_getCaretPos:function(_d){
var _e=0;
if(typeof (_d.selectionStart)=="number"){
_e=_d.selectionStart;
}else{
if(_8("ie")){
var tr=_d.ownerDocument.selection.createRange().duplicate();
var _f=_d.createTextRange();
tr.move("character",0);
_f.move("character",0);
try{
_f.setEndPoint("EndToEnd",tr);
_e=String(_f.text).replace(/\r/g,"").length;
}
catch(e){
}
}
}
return _e;
},_setCaretPos:function(_10,_11){
_11=parseInt(_11);
_a.selectInputText(_10,_11,_11);
},_setDisabledAttr:function(_12){
this.inherited(arguments);
this.domNode.setAttribute("aria-disabled",_12?"true":"false");
},_onKey:function(evt){
if(evt.charCode>=32){
return;
}
var key=evt.charCode||evt.keyCode;
if(key==_4.ALT||key==_4.CTRL||key==_4.META||key==_4.SHIFT){
return;
}
var pw=this.dropDown;
var _13=null;
this._abortQuery();
this.inherited(arguments);
if(evt.altKey||evt.ctrlKey||evt.metaKey){
return;
}
if(this._opened){
_13=pw.getHighlightedOption();
}
switch(key){
case _4.PAGE_DOWN:
case _4.DOWN_ARROW:
case _4.PAGE_UP:
case _4.UP_ARROW:
if(this._opened){
this._announceOption(_13);
}
evt.stopPropagation();
evt.preventDefault();
break;
case _4.ENTER:
if(_13){
if(_13==pw.nextButton){
this._nextSearch(1);
evt.stopPropagation();
evt.preventDefault();
break;
}else{
if(_13==pw.previousButton){
this._nextSearch(-1);
evt.stopPropagation();
evt.preventDefault();
break;
}
}
evt.stopPropagation();
evt.preventDefault();
}else{
this._setBlurValue();
this._setCaretPos(this.focusNode,this.focusNode.value.length);
}
case _4.TAB:
var _14=this.get("displayedValue");
if(pw&&(_14==pw._messages["previousMessage"]||_14==pw._messages["nextMessage"])){
break;
}
if(_13){
this._selectOption(_13);
}
case _4.ESCAPE:
if(this._opened){
this._lastQuery=null;
this.closeDropDown();
}
break;
}
},_autoCompleteText:function(_15){
var fn=this.focusNode;
_a.selectInputText(fn,fn.value.length);
var _16=this.ignoreCase?"toLowerCase":"substr";
if(_15[_16](0).indexOf(this.focusNode.value[_16](0))==0){
var _17=this.autoComplete?this._getCaretPos(fn):fn.value.length;
if((_17+1)>fn.value.length){
fn.value=_15;
_a.selectInputText(fn,_17);
}
}else{
fn.value=_15;
_a.selectInputText(fn);
}
},_openResultList:function(_18,_19,_1a){
var _1b=this.dropDown.getHighlightedOption();
this.dropDown.clearResultList();
if(!_18.length&&_1a.start==0){
this.closeDropDown();
return;
}
this._nextSearch=this.dropDown.onPage=_5.hitch(this,function(_1c){
_18.nextPage(_1c!==-1);
this.focus();
});
this.dropDown.createOptions(_18,_1a,_5.hitch(this,"_getMenuLabelFromItem"));
this._showResultList();
if("direction" in _1a){
if(_1a.direction){
this.dropDown.highlightFirstOption();
}else{
if(!_1a.direction){
this.dropDown.highlightLastOption();
}
}
if(_1b){
this._announceOption(this.dropDown.getHighlightedOption());
}
}else{
if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_19[this.searchAttr].toString())){
this._announceOption(this.dropDown.containerNode.firstChild.nextSibling);
}
}
},_showResultList:function(){
this.closeDropDown(true);
this.openDropDown();
this.domNode.setAttribute("aria-expanded","true");
},loadDropDown:function(){
this._startSearchAll();
},isLoaded:function(){
return false;
},closeDropDown:function(){
this._abortQuery();
if(this._opened){
this.inherited(arguments);
this.domNode.setAttribute("aria-expanded","false");
}
},_setBlurValue:function(){
var _1d=this.get("displayedValue");
var pw=this.dropDown;
if(pw&&(_1d==pw._messages["previousMessage"]||_1d==pw._messages["nextMessage"])){
this._setValueAttr(this._lastValueReported,true);
}else{
if(typeof this.item=="undefined"){
this.item=null;
this.set("displayedValue",_1d);
}else{
if(this.value!=this._lastValueReported){
this._handleOnChange(this.value,true);
}
this._refreshState();
}
}
this.focusNode.removeAttribute("aria-activedescendant");
},_setItemAttr:function(_1e,_1f,_20){
var _21="";
if(_1e){
if(!_20){
_20=this.store._oldAPI?this.store.getValue(_1e,this.searchAttr):_1e[this.searchAttr];
}
_21=this._getValueField()!=this.searchAttr?this.store.getIdentity(_1e):_20;
}
this.set("value",_21,_1f,_20,_1e);
},_announceOption:function(_22){
if(!_22){
return;
}
var _23;
if(_22==this.dropDown.nextButton||_22==this.dropDown.previousButton){
_23=_22.innerHTML;
this.item=undefined;
this.value="";
}else{
if(this.dropDown.visitorModelInviteDiv!="undefined"&&this.dropDown.visitorModelInviteDiv!=null&&_22==this.dropDown.visitorModelInviteDiv){
var _23=this.get("displayedValue");
}else{
var _24=this.dropDown.items[_22.getAttribute("item")];
_23=(this.store._oldAPI?this.store.getValue(_24,this.searchAttr):_24[this.searchAttr]).toString();
this.set("item",_24,false,_23);
}
}
this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);
this.focusNode.setAttribute("aria-activedescendant",_3.get(_22,"id"));
this._autoCompleteText(_23);
},_selectOption:function(_25){
this.closeDropDown();
if(_25){
this._announceOption(_25);
}
this._setCaretPos(this.focusNode,this.focusNode.value.length);
this._handleOnChange(this.value,true);
this.focusNode.removeAttribute("aria-activedescendant");
},_startSearchAll:function(){
this._startSearch("");
},_startSearchFromInput:function(){
this.item=undefined;
this.inherited(arguments);
},_startSearch:function(key){
if(!this.dropDown){
var _26=this.id+"_popup",_27=_5.isString(this.dropDownClass)?_5.getObject(this.dropDownClass,false):this.dropDownClass;
this.dropDown=new _27({onChange:_5.hitch(this,this._selectOption),id:_26,dir:this.dir,textDir:this.textDir});
}
this._lastInput=key;
this.inherited(arguments);
},_getValueField:function(){
return this.searchAttr;
},postMixInProperties:function(){
this.inherited(arguments);
if(!this.store&&this.srcNodeRef){
var _28=this.srcNodeRef;
this.store=new _9({},_28);
if(!("value" in this.params)){
var _29=(this.item=this.store.fetchSelectedItem());
if(_29){
var _2a=this._getValueField();
this.value=this.store._oldAPI?this.store.getValue(_29,_2a):_29[_2a];
}
}
}
},postCreate:function(){
var _2b=_6("label[for=\""+this.id+"\"]");
if(_2b.length){
if(!_2b[0].id){
_2b[0].id=this.id+"_label";
}
this.domNode.setAttribute("aria-labelledby",_2b[0].id);
}
this.inherited(arguments);
_1.after(this,"onSearch",_5.hitch(this,"_openResultList"),true);
},_getMenuLabelFromItem:function(_2c){
var _2d=this.labelFunc(_2c,this.store),_2e=this.labelType;
if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){
_2d=this.doHighlight(_2d,this._lastInput);
_2e="html";
}
return {html:_2e=="html",label:_2d};
},doHighlight:function(_2f,_30){
var _31=(this.ignoreCase?"i":"")+(this.highlightMatch=="all"?"g":""),i=this.queryExpr.indexOf("${0}");
_30=_7.escapeString(_30);
return this._escapeHtml(_2f.replace(new RegExp((i==0?"^":"")+"("+_30+")"+(i==(this.queryExpr.length-4)?"$":""),_31),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,"<span class=\"dijitComboBoxHighlightMatch\">$1</span>");
},_escapeHtml:function(str){
str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");
return str;
},reset:function(){
this.item=null;
this.inherited(arguments);
},labelFunc:function(_32,_33){
return (_33._oldAPI?_33.getValue(_32,this.labelAttr||this.searchAttr):_32[this.labelAttr||this.searchAttr]).toString();
},_setValueAttr:function(_34,_35,_36,_37){
this._set("item",_37||null);
if(_34==null){
_34="";
}
this.inherited(arguments);
}});
if(_8("dojo-bidi")){
_c.extend({_setTextDirAttr:function(_38){
this.inherited(arguments);
if(this.dropDown){
this.dropDown._set("textDir",_38);
}
}});
}
return _c;
});


;define("dojo/i18n!dijit/form/nls/ComboBox", {"previousMessage":"Previous choices","nextMessage":"More choices"});

;define("dijit/form/_ComboBoxMenuMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/has","dojo/i18n","dojo/i18n!./nls/ComboBox"],function(_1,_2,_3,_4,_5){
var _6=_2("dijit.form._ComboBoxMenuMixin"+(_4("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){
this.inherited(arguments);
this._messages=_5.getLocalization("dijit.form","ComboBox",this.lang);
},buildRendering:function(){
this.inherited(arguments);
this.previousButton.innerHTML=this._messages["previousMessage"];
this.nextButton.innerHTML=this._messages["nextMessage"];
},_setValueAttr:function(_7){
this._set("value",_7);
this.onChange(_7);
},onClick:function(_8){
if(_8==this.previousButton){
this._setSelectedAttr(null);
this.onPage(-1);
}else{
if(_8==this.nextButton){
this._setSelectedAttr(null);
this.onPage(1);
}else{
this.onChange(_8);
}
}
},onChange:function(){
},onPage:function(){
},onClose:function(){
this._setSelectedAttr(null);
},_createOption:function(_9,_a){
var _b=this._createMenuItem();
var _c=_a(_9);
if(_c.html){
_b.innerHTML=_c.label;
}else{
_b.appendChild(_b.ownerDocument.createTextNode(_c.label));
}
if(_b.innerHTML==""){
_b.innerHTML="&#160;";
}
return _b;
},createOptions:function(_d,_e,_f){
this.items=_d;
this.previousButton.style.display=(_e.start==0)?"none":"";
_3.set(this.previousButton,"id",this.id+"_prev");
_1.forEach(_d,function(_10,i){
var _11=this._createOption(_10,_f);
_11.setAttribute("item",i);
_3.set(_11,"id",this.id+i);
this.nextButton.parentNode.insertBefore(_11,this.nextButton);
},this);
var _12=false;
if(_d.total&&!_d.total.then&&_d.total!=-1){
if((_e.start+_e.count)<_d.total){
_12=true;
}else{
if((_e.start+_e.count)>_d.total&&_e.count==_d.length){
_12=true;
}
}
}else{
if(_e.count==_d.length){
_12=true;
}
}
this.nextButton.style.display=_12?"":"none";
_3.set(this.nextButton,"id",this.id+"_next");
},clearResultList:function(){
var _13=this.containerNode;
while(_13.childNodes.length>2){
_13.removeChild(_13.childNodes[_13.childNodes.length-2]);
}
this._setSelectedAttr(null);
},highlightFirstOption:function(){
this.selectFirstNode();
},highlightLastOption:function(){
this.selectLastNode();
},selectFirstNode:function(){
this.inherited(arguments);
if(this.getHighlightedOption()==this.previousButton){
this.selectNextNode();
}
},selectLastNode:function(){
this.inherited(arguments);
if(this.getHighlightedOption()==this.nextButton){
this.selectPreviousNode();
}
},getHighlightedOption:function(){
return this.selected;
}});
if(_4("dojo-bidi")){
_6=_2("dijit.form._ComboBoxMenuMixin",_6,{_createOption:function(){
var _14=this.inherited(arguments);
this.applyTextDir(_14);
return _14;
}});
}
return _6;
});


;define("dijit/form/_ListBase",["dojo/_base/declare","dojo/on","dojo/window"],function(_1,on,_2){
return _1("dijit.form._ListBase",null,{selected:null,_listConnect:function(_3,_4){
var _5=this;
return _5.own(on(_5.containerNode,on.selector(function(_6,_7,_8){
return _6.parentNode==_8;
},_3),function(_9){
_5[_4](_9,this);
}));
},selectFirstNode:function(){
var _a=this.containerNode.firstChild;
while(_a&&_a.style.display=="none"){
_a=_a.nextSibling;
}
this._setSelectedAttr(_a,true);
},selectLastNode:function(){
var _b=this.containerNode.lastChild;
while(_b&&_b.style.display=="none"){
_b=_b.previousSibling;
}
this._setSelectedAttr(_b,true);
},selectNextNode:function(){
var _c=this.selected;
if(!_c){
this.selectFirstNode();
}else{
var _d=_c.nextSibling;
while(_d&&_d.style.display=="none"){
_d=_d.nextSibling;
}
if(!_d){
this.selectFirstNode();
}else{
this._setSelectedAttr(_d,true);
}
}
},selectPreviousNode:function(){
var _e=this.selected;
if(!_e){
this.selectLastNode();
}else{
var _f=_e.previousSibling;
while(_f&&_f.style.display=="none"){
_f=_f.previousSibling;
}
if(!_f){
this.selectLastNode();
}else{
this._setSelectedAttr(_f,true);
}
}
},_setSelectedAttr:function(_10,_11){
if(this.selected!=_10){
var _12=this.selected;
if(_12){
this.onDeselect(_12);
}
if(_10){
if(_11){
_2.scrollIntoView(_10);
}
this.onSelect(_10);
}
this._set("selected",_10);
}else{
if(_10){
this.onSelect(_10);
}
}
}});
});


;define("dijit/form/_ListMouseMixin",["dojo/_base/declare","dojo/on","dojo/touch","./_ListBase"],function(_1,on,_2,_3){
return _1("dijit.form._ListMouseMixin",_3,{postCreate:function(){
this.inherited(arguments);
this.domNode.dojoClick=true;
this._listConnect("click","_onClick");
this._listConnect("mousedown","_onMouseDown");
this._listConnect("mouseup","_onMouseUp");
this._listConnect("mouseover","_onMouseOver");
this._listConnect("mouseout","_onMouseOut");
},_onClick:function(_4,_5){
this._setSelectedAttr(_5,false);
if(this._deferredClick){
this._deferredClick.remove();
}
this._deferredClick=this.defer(function(){
this._deferredClick=null;
this.onClick(_5);
});
},_onMouseDown:function(_6,_7){
if(this._hoveredNode){
this.onUnhover(this._hoveredNode);
this._hoveredNode=null;
}
this._isDragging=true;
this._setSelectedAttr(_7,false);
},_onMouseUp:function(_8,_9){
this._isDragging=false;
var _a=this.selected;
var _b=this._hoveredNode;
if(_a&&_9==_a){
this.defer(function(){
this._onClick(_8,_a);
});
}else{
if(_b){
this.defer(function(){
this._onClick(_8,_b);
});
}
}
},_onMouseOut:function(_c,_d){
if(this._hoveredNode){
this.onUnhover(this._hoveredNode);
this._hoveredNode=null;
}
if(this._isDragging){
this._cancelDrag=(new Date()).getTime()+1000;
}
},_onMouseOver:function(_e,_f){
if(this._cancelDrag){
var _10=(new Date()).getTime();
if(_10>this._cancelDrag){
this._isDragging=false;
}
this._cancelDrag=null;
}
this._hoveredNode=_f;
this.onHover(_f);
if(this._isDragging){
this._setSelectedAttr(_f,false);
}
}});
});


;define("dijit/form/_ComboBoxMenu",["dojo/_base/declare","dojo/dom-class","dojo/dom-style","dojo/keys","../_WidgetBase","../_TemplatedMixin","./_ComboBoxMenuMixin","./_ListMouseMixin"],function(_1,_2,_3,_4,_5,_6,_7,_8){
return _1("dijit.form._ComboBoxMenu",[_5,_6,_8,_7],{templateString:"<div class='dijitReset dijitMenu' data-dojo-attach-point='containerNode' style='overflow: auto; overflow-x: hidden;' role='listbox'>"+"<div class='dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point='previousButton' role='option'></div>"+"<div class='dijitMenuItem dijitMenuNextButton' data-dojo-attach-point='nextButton' role='option'></div>"+"</div>",baseClass:"dijitComboBoxMenu",postCreate:function(){
this.inherited(arguments);
if(!this.isLeftToRight()){
_2.add(this.previousButton,"dijitMenuItemRtl");
_2.add(this.nextButton,"dijitMenuItemRtl");
}
this.containerNode.setAttribute("role","listbox");
},_createMenuItem:function(){
var _9=this.ownerDocument.createElement("div");
_9.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");
_9.setAttribute("role","option");
return _9;
},onHover:function(_a){
_2.add(_a,"dijitMenuItemHover");
},onUnhover:function(_b){
_2.remove(_b,"dijitMenuItemHover");
},onSelect:function(_c){
_2.add(_c,"dijitMenuItemSelected");
},onDeselect:function(_d){
_2.remove(_d,"dijitMenuItemSelected");
},_page:function(up){
var _e=0;
var _f=this.domNode.scrollTop;
var _10=_3.get(this.domNode,"height");
if(!this.getHighlightedOption()){
this.selectNextNode();
}
while(_e<_10){
var _11=this.getHighlightedOption();
if(up){
if(!_11.previousSibling||_11.previousSibling.style.display=="none"){
break;
}
this.selectPreviousNode();
}else{
if(!_11.nextSibling||_11.nextSibling.style.display=="none"){
break;
}
this.selectNextNode();
}
var _12=this.domNode.scrollTop;
_e+=(_12-_f)*(up?-1:1);
_f=_12;
}
},handleKey:function(evt){
switch(evt.keyCode){
case _4.DOWN_ARROW:
this.selectNextNode();
return false;
case _4.PAGE_DOWN:
this._page(false);
return false;
case _4.UP_ARROW:
this.selectPreviousNode();
return false;
case _4.PAGE_UP:
this._page(true);
return false;
default:
return true;
}
}});
});


;define("dojo/text!dijit/form/templates/DropDownBox.html", '<div class="dijit dijitReset dijitInline dijitLeft"\n	id="widget_${id}"\n	role="combobox"\n	aria-haspopup="true"\n	data-dojo-attach-point="_popupStateNode"\n	><div class=\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\n		data-dojo-attach-point="_buttonNode" role="presentation"\n		><input class="dijitReset dijitInputField dijitArrowButtonInner" value="&#9660; " type="text" tabIndex="-1" readonly="readonly" role="button presentation" aria-hidden="true"\n			${_buttonInputDisabled}\n	/></div\n	><div class=\'dijitReset dijitValidationContainer\'\n		><input class="dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value="&#935; " type="text" tabIndex="-1" readonly="readonly" role="presentation"\n	/></div\n	><div class="dijitReset dijitInputField dijitInputContainer"\n		><input class=\'dijitReset dijitInputInner\' ${!nameAttrSetting} type="text" autocomplete="off"\n			data-dojo-attach-point="textbox,focusNode" role="textbox"\n	/></div\n></div>\n');

;define("dijit/form/ComboBoxMixin",["dojo/_base/declare","dojo/Deferred","dojo/_base/kernel","dojo/_base/lang","dojo/store/util/QueryResults","./_AutoCompleterMixin","./_ComboBoxMenu","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
return _1("dijit.form.ComboBoxMixin",[_8,_6],{dropDownClass:_7,hasDownArrow:true,templateString:_9,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},_setHasDownArrowAttr:function(_a){
this._set("hasDownArrow",_a);
this._buttonNode.style.display=_a?"":"none";
},_showResultList:function(){
this.displayMessage("");
this.inherited(arguments);
},_setStoreAttr:function(_b){
if(!_b.get){
_4.mixin(_b,{_oldAPI:true,get:function(id){
var _c=new _2();
this.fetchItemByIdentity({identity:id,onItem:function(_d){
_c.resolve(_d);
},onError:function(_e){
_c.reject(_e);
}});
return _c.promise;
},query:function(_f,_10){
var _11=new _2(function(){
_12.abort&&_12.abort();
});
_11.total=new _2();
var _12=this.fetch(_4.mixin({query:_f,onBegin:function(_13){
_11.total.resolve(_13);
},onComplete:function(_14){
_11.resolve(_14);
},onError:function(_15){
_11.reject(_15);
}},_10));
return _5(_11);
}});
}
this._set("store",_b);
},postMixInProperties:function(){
var _16=this.params.store||this.store;
if(_16){
this._setStoreAttr(_16);
}
this.inherited(arguments);
if(!this.params.store&&this.store&&!this.store._oldAPI){
var _17=this.declaredClass;
_4.mixin(this.store,{getValue:function(_18,_19){
_3.deprecated(_17+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");
return _18[_19];
},getLabel:function(_1a){
_3.deprecated(_17+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");
return _1a.name;
},fetch:function(_1b){
_3.deprecated(_17+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");
var _1c=["dojo/data/ObjectStore"];
require(_1c,_4.hitch(this,function(_1d){
new _1d({objectStore:this}).fetch(_1b);
}));
}});
}
},buildRendering:function(){
this.inherited(arguments);
this.focusNode.setAttribute("aria-autocomplete",this.autoComplete?"both":"list");
}});
});


;define("dijit/form/ComboBox",["dojo/_base/declare","./ValidationTextBox","./ComboBoxMixin"],function(_1,_2,_3){
return _1("dijit.form.ComboBox",[_2,_3],{});
});


;define("dojo/AdapterRegistry",["./_base/kernel","./_base/lang"],function(_1,_2){
var _3=_1.AdapterRegistry=function(_4){
this.pairs=[];
this.returnWrappers=_4||false;
};
_2.extend(_3,{register:function(_5,_6,_7,_8,_9){
this.pairs[((_9)?"unshift":"push")]([_5,_6,_7,_8]);
},match:function(){
for(var i=0;i<this.pairs.length;i++){
var _a=this.pairs[i];
if(_a[1].apply(this,arguments)){
if((_a[3])||(this.returnWrappers)){
return _a[2];
}else{
return _a[2].apply(this,arguments);
}
}
}
throw new Error("No match found");
},unregister:function(_b){
for(var i=0;i<this.pairs.length;i++){
var _c=this.pairs[i];
if(_c[0]==_b){
this.pairs.splice(i,1);
return true;
}
}
return false;
}});
return _3;
});


;define("dojo/cldr/supplemental",["../_base/lang","../i18n"],function(_1,_2){
var _3={};
_1.setObject("dojo.cldr.supplemental",_3);
_3.getFirstDayOfWeek=function(_4){
var _5={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0};
var _6=_3._region(_4);
var _7=_5[_6];
return (_7===undefined)?1:_7;
};
_3._region=function(_8){
_8=_2.normalizeLocale(_8);
var _9=_8.split("-");
var _a=_9[1];
if(!_a){
_a={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",yav:"cm",zza:"tr"}[_9[0]];
}else{
if(_a.length==4){
_a=_9[2];
}
}
return _a;
};
_3.getWeekend=function(_b){
var _c={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5},_d={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6},_e=_3._region(_b),_f=_c[_e],end=_d[_e];
if(_f===undefined){
_f=6;
}
if(end===undefined){
end=0;
}
return {start:_f,end:end};
};
return _3;
});


;define("dojo/cookie",["./_base/kernel","./regexp"],function(_1,_2){
_1.cookie=function(_3,_4,_5){
var c=document.cookie,_6;
if(arguments.length==1){
var _7=c.match(new RegExp("(?:^|; )"+_2.escapeString(_3)+"=([^;]*)"));
_6=_7?decodeURIComponent(_7[1]):undefined;
}else{
_5=_5||{};
var _8=_5.expires;
if(typeof _8=="number"){
var d=new Date();
d.setTime(d.getTime()+_8*24*60*60*1000);
_8=_5.expires=d;
}
if(_8&&_8.toUTCString){
_5.expires=_8.toUTCString();
}
_4=encodeURIComponent(_4);
var _9=_3+"="+_4,_a;
for(_a in _5){
_9+="; "+_a;
var _b=_5[_a];
if(_b!==true){
_9+="="+_b;
}
}
document.cookie=_9;
}
return _6;
};
_1.cookie.isSupported=function(){
if(!("cookieEnabled" in navigator)){
this("__djCookieTest__","CookiesAllowed");
navigator.cookieEnabled=this("__djCookieTest__")=="CookiesAllowed";
if(navigator.cookieEnabled){
this("__djCookieTest__","",{expires:-1});
}
}
return navigator.cookieEnabled;
};
return _1.cookie;
});


;define("dojo/data/util/filter",["../../_base/lang"],function(_1){
var _2={};
_1.setObject("dojo.data.util.filter",_2);
_2.patternToRegExp=function(_3,_4){
var _5="^";
var c=null;
for(var i=0;i<_3.length;i++){
c=_3.charAt(i);
switch(c){
case "\\":
_5+=c;
i++;
_5+=_3.charAt(i);
break;
case "*":
_5+=".*";
break;
case "?":
_5+=".";
break;
case "$":
case "^":
case "/":
case "+":
case ".":
case "|":
case "(":
case ")":
case "{":
case "}":
case "[":
case "]":
_5+="\\";
default:
_5+=c;
}
}
_5+="$";
if(_4){
return new RegExp(_5,"mi");
}else{
return new RegExp(_5,"m");
}
};
return _2;
});


;define("dojo/data/util/sorter",["../../_base/lang"],function(_1){
var _2={};
_1.setObject("dojo.data.util.sorter",_2);
_2.basicComparator=function(a,b){
var r=-1;
if(a===null){
a=undefined;
}
if(b===null){
b=undefined;
}
if(a==b){
r=0;
}else{
if(a>b||a==null){
r=1;
}
}
return r;
};
_2.createSortFunction=function(_3,_4){
var _5=[];
function _6(_7,_8,_9,s){
return function(_a,_b){
var a=s.getValue(_a,_7);
var b=s.getValue(_b,_7);
return _8*_9(a,b);
};
};
var _c;
var _d=_4.comparatorMap;
var bc=_2.basicComparator;
for(var i=0;i<_3.length;i++){
_c=_3[i];
var _e=_c.attribute;
if(_e){
var _f=(_c.descending)?-1:1;
var _10=bc;
if(_d){
if(typeof _e!=="string"&&("toString" in _e)){
_e=_e.toString();
}
_10=_d[_e]||bc;
}
_5.push(_6(_e,_f,_10,_4));
}
}
return function(_11,_12){
var i=0;
while(i<_5.length){
var ret=_5[i++](_11,_12);
if(ret!==0){
return ret;
}
}
return 0;
};
};
return _2;
});


;define("dojo/data/util/simpleFetch",["../../_base/lang","../../_base/kernel","./sorter"],function(_1,_2,_3){
var _4={};
_1.setObject("dojo.data.util.simpleFetch",_4);
_4.errorHandler=function(_5,_6){
if(_6.onError){
var _7=_6.scope||_2.global;
_6.onError.call(_7,_5,_6);
}
};
_4.fetchHandler=function(_8,_9){
var _a=_9.abort||null,_b=false,_c=_9.start?_9.start:0,_d=(_9.count&&(_9.count!==Infinity))?(_c+_9.count):_8.length;
_9.abort=function(){
_b=true;
if(_a){
_a.call(_9);
}
};
var _e=_9.scope||_2.global;
if(!_9.store){
_9.store=this;
}
if(_9.onBegin){
_9.onBegin.call(_e,_8.length,_9);
}
if(_9.sort){
_8.sort(_3.createSortFunction(_9.sort,this));
}
if(_9.onItem){
for(var i=_c;(i<_8.length)&&(i<_d);++i){
var _f=_8[i];
if(!_b){
_9.onItem.call(_e,_f,_9);
}
}
}
if(_9.onComplete&&!_b){
var _10=null;
if(!_9.onItem){
_10=_8.slice(_c,_d);
}
_9.onComplete.call(_e,_10,_9);
}
};
_4.fetch=function(_11){
_11=_11||{};
if(!_11.store){
_11.store=this;
}
this._fetchItems(_11,_1.hitch(this,"fetchHandler"),_1.hitch(this,"errorHandler"));
return _11;
};
return _4;
});


;define("dojo/date",["./has","./_base/lang"],function(_1,_2){
var _3={};
_3.getDaysInMonth=function(_4){
var _5=_4.getMonth();
var _6=[31,28,31,30,31,30,31,31,30,31,30,31];
if(_5==1&&_3.isLeapYear(_4)){
return 29;
}
return _6[_5];
};
_3.isLeapYear=function(_7){
var _8=_7.getFullYear();
return !(_8%400)||(!(_8%4)&&!!(_8%100));
};
_3.getTimezoneName=function(_9){
var _a=_9.toString();
var tz="";
var _b;
var _c=_a.indexOf("(");
if(_c>-1){
tz=_a.substring(++_c,_a.indexOf(")"));
}else{
var _d=/([A-Z\/]+) \d{4}$/;
if((_b=_a.match(_d))){
tz=_b[1];
}else{
_a=_9.toLocaleString();
_d=/ ([A-Z\/]+)$/;
if((_b=_a.match(_d))){
tz=_b[1];
}
}
}
return (tz=="AM"||tz=="PM")?"":tz;
};
_3.compare=function(_e,_f,_10){
_e=new Date(+_e);
_f=new Date(+(_f||new Date()));
if(_10=="date"){
_e.setHours(0,0,0,0);
_f.setHours(0,0,0,0);
}else{
if(_10=="time"){
_e.setFullYear(0,0,0);
_f.setFullYear(0,0,0);
}
}
if(_e>_f){
return 1;
}
if(_e<_f){
return -1;
}
return 0;
};
_3.add=function(_11,_12,_13){
var sum=new Date(+_11);
var _14=false;
var _15="Date";
switch(_12){
case "day":
break;
case "weekday":
var _16,_17;
var mod=_13%5;
if(!mod){
_16=(_13>0)?5:-5;
_17=(_13>0)?((_13-5)/5):((_13+5)/5);
}else{
_16=mod;
_17=parseInt(_13/5);
}
var _18=_11.getDay();
var adj=0;
if(_18==6&&_13>0){
adj=1;
}else{
if(_18==0&&_13<0){
adj=-1;
}
}
var _19=_18+_16;
if(_19==0||_19==6){
adj=(_13>0)?2:-2;
}
_13=(7*_17)+_16+adj;
break;
case "year":
_15="FullYear";
_14=true;
break;
case "week":
_13*=7;
break;
case "quarter":
_13*=3;
case "month":
_14=true;
_15="Month";
break;
default:
_15="UTC"+_12.charAt(0).toUpperCase()+_12.substring(1)+"s";
}
if(_15){
sum["set"+_15](sum["get"+_15]()+_13);
}
if(_14&&(sum.getDate()<_11.getDate())){
sum.setDate(0);
}
return sum;
};
_3.difference=function(_1a,_1b,_1c){
_1b=_1b||new Date();
_1c=_1c||"day";
var _1d=_1b.getFullYear()-_1a.getFullYear();
var _1e=1;
switch(_1c){
case "quarter":
var m1=_1a.getMonth();
var m2=_1b.getMonth();
var q1=Math.floor(m1/3)+1;
var q2=Math.floor(m2/3)+1;
q2+=(_1d*4);
_1e=q2-q1;
break;
case "weekday":
var _1f=Math.round(_3.difference(_1a,_1b,"day"));
var _20=parseInt(_3.difference(_1a,_1b,"week"));
var mod=_1f%7;
if(mod==0){
_1f=_20*5;
}else{
var adj=0;
var _21=_1a.getDay();
var _22=_1b.getDay();
_20=parseInt(_1f/7);
mod=_1f%7;
var _23=new Date(_1a);
_23.setDate(_23.getDate()+(_20*7));
var _24=_23.getDay();
if(_1f>0){
switch(true){
case _21==6:
adj=-1;
break;
case _21==0:
adj=0;
break;
case _22==6:
adj=-1;
break;
case _22==0:
adj=-2;
break;
case (_24+mod)>5:
adj=-2;
}
}else{
if(_1f<0){
switch(true){
case _21==6:
adj=0;
break;
case _21==0:
adj=1;
break;
case _22==6:
adj=2;
break;
case _22==0:
adj=1;
break;
case (_24+mod)<0:
adj=2;
}
}
}
_1f+=adj;
_1f-=(_20*2);
}
_1e=_1f;
break;
case "year":
_1e=_1d;
break;
case "month":
_1e=(_1b.getMonth()-_1a.getMonth())+(_1d*12);
break;
case "week":
_1e=parseInt(_3.difference(_1a,_1b,"day")/7);
break;
case "day":
_1e/=24;
case "hour":
_1e/=60;
case "minute":
_1e/=60;
case "second":
_1e/=1000;
case "millisecond":
_1e*=_1b.getTime()-_1a.getTime();
}
return Math.round(_1e);
};
_1("extend-dojo")&&_2.mixin(_2.getObject("dojo.date",true),_3);
return _3;
});


;define("dojo/i18n!dojo/cldr/nls/gregorian", {"field-era":"Era","dateFormat-long":"MMMM d, y","days-standAlone-wide":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","dateTimeFormat-full":"{1} \'at\' {0}","dateFormatItem-MMMd":"MMM d","dateTimeFormats-appendItem-Timezone":"{0} {1}","months-format-wide":["January","February","March","April","May","June","July","August","September","October","November","December"],"field-second-relative+0":"now","dateFormatItem-MMMEd":"E, MMM d","dateFormat-full":"EEEE, MMMM d, y","dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","dateFormatItem-yQQQQ":"QQQQ y","dateTimeFormat-medium":"{1}, {0}","timeFormat-medium":"h:mm:ss a","dateFormatItem-EHms":"E HH:mm:ss","dateFormatItem-GyMMM":"MMM y G","field-minute":"Minute","dateFormatItem-yMMM":"MMM y","field-day":"Day","dateTimeFormats-appendItem-Year":"{0} {1}","quarters-standAlone-abbr":["Q1","Q2","Q3","Q4"],"dayPeriods-format-narrow-noon":"n","eraNames":["Before Christ","Anno Domini"],"dayPeriods-format-abbr-pm":"PM","dateFormatItem-Ehms":"E h:mm:ss a","dateTimeFormat-short":"{1}, {0}","dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}","days-format-wide":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"dateFormatItem-MEd":"E, M/d","dayPeriods-format-wide-pm":"PM","dayPeriods-format-abbr-noon":"noon","field-sun-relative+0":"this Sunday","field-sun-relative+1":"next Sunday","dayPeriods-format-abbr-am":"AM","field-sat-relative+-1":"last Saturday","timeFormat-short":"h:mm a","months-format-narrow":["J","F","M","A","M","J","J","A","S","O","N","D"],"dateFormatItem-Hms":"HH:mm:ss","dateFormatItem-yMd":"M/d/y","field-zone":"Time Zone","field-thu-relative+-1":"last Thursday","dayPeriods-format-wide-am":"AM","field-second":"Second","field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","field-mon-relative+-1":"last Monday","dateFormatItem-Ed":"d E","dateFormatItem-Ehm":"E h:mm a","dateFormatItem-hms":"h:mm:ss a","dateTimeFormats-appendItem-Era":"{0} {1}","quarters-format-abbr":["Q1","Q2","Q3","Q4"],"dateFormatItem-yMMMEd":"E, MMM d, y","eraNarrow":["B","A"],"dateFormatItem-EHm":"E HH:mm","field-hour":"Hour","days-format-short":["Su","Mo","Tu","We","Th","Fr","Sa"],"field-week-relative+-1":"last week","dateFormatItem-GyMMMd":"MMM d, y G","field-month-relative+-1":"last month","field-week":"Week","dateFormatItem-yM":"M/y","quarters-format-narrow":["1","2","3","4"],"dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","quarters-standAlone-wide":["1st quarter","2nd quarter","3rd quarter","4th quarter"],"dateFormatItem-hm":"h:mm a","dateFormat-medium":"MMM d, y","months-standAlone-abbr":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"dateFormatItem-Gy":"y G","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})","days-standAlone-narrow":["S","M","T","W","T","F","S"],"field-month-relative+0":"this month","field-month-relative+1":"next month","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","dateFormatItem-Hm":"HH:mm","dayPeriods-format-wide-noon":"noon","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","field-year":"Year","field-thu-relative+0":"this Thursday","field-thu-relative+1":"next Thursday","field-day-relative+0":"today","field-day-relative+1":"tomorrow","field-wed-relative+0":"this Wednesday","dateFormatItem-yMMMd":"MMM d, y","field-wed-relative+1":"next Wednesday","field-day-relative+-1":"yesterday","field-fri-relative+-1":"last Friday","field-dayperiod":"AM/PM","field-weekday":"Day of the Week","dateFormatItem-MMM":"LLL","quarters-format-wide":["1st quarter","2nd quarter","3rd quarter","4th quarter"],"days-standAlone-abbr":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dateFormatItem-yMEd":"E, M/d/y","months-format-abbr":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"dateFormatItem-GyMMMEd":"E, MMM d, y G","timeFormat-long":"h:mm:ss a z","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","days-standAlone-short":["Su","Mo","Tu","We","Th","Fr","Sa"],"timeFormat-full":"h:mm:ss a zzzz","dateFormatItem-ms":"mm:ss","months-standAlone-wide":["January","February","March","April","May","June","July","August","September","October","November","December"],"eraAbbr":["BC","AD"],"field-year-relative+-1":"last year","field-tue-relative+-1":"last Tuesday","months-standAlone-narrow":["J","F","M","A","M","J","J","A","S","O","N","D"],"dateFormatItem-Md":"M/d","dayPeriods-format-narrow-pm":"p","dateFormatItem-H":"HH","dateFormatItem-M":"L","field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday","dateFormatItem-yQQQ":"QQQ y","field-tue-relative+0":"this Tuesday","field-tue-relative+1":"next Tuesday","dateFormatItem-d":"d","days-format-abbr":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dateFormatItem-h":"h a","field-week-relative+0":"this week","field-week-relative+1":"next week","dayPeriods-format-narrow-am":"a","dateFormatItem-y":"y","field-month":"Month","field-year-relative+0":"this year","field-sun-relative+-1":"last Sunday","field-year-relative+1":"next year","dateFormat-short":"M/d/yy","dateTimeFormat-long":"{1} \'at\' {0}","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","field-wed-relative+-1":"last Wednesday","days-format-narrow":["S","M","T","W","T","F","S"],"quarters-standAlone-narrow":["1","2","3","4"]});

;define("dojo/date/locale",["../_base/lang","../_base/array","../date","../cldr/supplemental","../i18n","../regexp","../string","../i18n!../cldr/nls/gregorian","module"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
var _a={};
_1.setObject(_9.id.replace(/\//g,"."),_a);
function _b(_c,_d,_e,_f){
return _f.replace(/([a-z])\1*/ig,function(_10){
var s,pad,c=_10.charAt(0),l=_10.length,_11=["abbr","wide","narrow"];
switch(c){
case "G":
s=_d[(l<4)?"eraAbbr":"eraNames"][_c.getFullYear()<0?0:1];
break;
case "y":
s=_c.getFullYear();
switch(l){
case 1:
break;
case 2:
if(!_e.fullYear){
s=String(s);
s=s.substr(s.length-2);
break;
}
default:
pad=true;
}
break;
case "Q":
case "q":
s=Math.ceil((_c.getMonth()+1)/3);
pad=true;
break;
case "M":
case "L":
var m=_c.getMonth();
if(l<3){
s=m+1;
pad=true;
}else{
var _12=["months",c=="L"?"standAlone":"format",_11[l-3]].join("-");
s=_d[_12][m];
}
break;
case "w":
var _13=0;
s=_a._getWeekOfYear(_c,_13);
pad=true;
break;
case "d":
s=_c.getDate();
pad=true;
break;
case "D":
s=_a._getDayOfYear(_c);
pad=true;
break;
case "e":
case "c":
var d=_c.getDay();
if(l<2){
s=(d-_4.getFirstDayOfWeek(_e.locale)+8)%7;
break;
}
case "E":
d=_c.getDay();
if(l<3){
s=d+1;
pad=true;
}else{
var _14=["days",c=="c"?"standAlone":"format",_11[l-3]].join("-");
s=_d[_14][d];
}
break;
case "a":
var _15=_c.getHours()<12?"am":"pm";
s=_e[_15]||_d["dayPeriods-format-wide-"+_15];
break;
case "h":
case "H":
case "K":
case "k":
var h=_c.getHours();
switch(c){
case "h":
s=(h%12)||12;
break;
case "H":
s=h;
break;
case "K":
s=(h%12);
break;
case "k":
s=h||24;
break;
}
pad=true;
break;
case "m":
s=_c.getMinutes();
pad=true;
break;
case "s":
s=_c.getSeconds();
pad=true;
break;
case "S":
s=Math.round(_c.getMilliseconds()*Math.pow(10,l-3));
pad=true;
break;
case "v":
case "z":
s=_a._getZone(_c,true,_e);
if(s){
break;
}
l=4;
case "Z":
var _16=_a._getZone(_c,false,_e);
var tz=[(_16<=0?"+":"-"),_7.pad(Math.floor(Math.abs(_16)/60),2),_7.pad(Math.abs(_16)%60,2)];
if(l==4){
tz.splice(0,0,"GMT");
tz.splice(3,0,":");
}
s=tz.join("");
break;
default:
throw new Error("dojo.date.locale.format: invalid pattern char: "+_f);
}
if(pad){
s=_7.pad(s,l);
}
return s;
});
};
_a._getZone=function(_17,_18,_19){
if(_18){
return _3.getTimezoneName(_17);
}else{
return _17.getTimezoneOffset();
}
};
_a.format=function(_1a,_1b){
_1b=_1b||{};
var _1c=_5.normalizeLocale(_1b.locale),_1d=_1b.formatLength||"short",_1e=_a._getGregorianBundle(_1c),str=[],_1f=_1.hitch(this,_b,_1a,_1e,_1b);
if(_1b.selector=="year"){
return _20(_1e["dateFormatItem-yyyy"]||"yyyy",_1f);
}
var _21;
if(_1b.selector!="date"){
_21=_1b.timePattern||_1e["timeFormat-"+_1d];
if(_21){
str.push(_20(_21,_1f));
}
}
if(_1b.selector!="time"){
_21=_1b.datePattern||_1e["dateFormat-"+_1d];
if(_21){
str.push(_20(_21,_1f));
}
}
return str.length==1?str[0]:_1e["dateTimeFormat-"+_1d].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(_22,key){
return str[key];
});
};
_a.regexp=function(_23){
return _a._parseInfo(_23).regexp;
};
_a._parseInfo=function(_24){
_24=_24||{};
var _25=_5.normalizeLocale(_24.locale),_26=_a._getGregorianBundle(_25),_27=_24.formatLength||"short",_28=_24.datePattern||_26["dateFormat-"+_27],_29=_24.timePattern||_26["timeFormat-"+_27],_2a;
if(_24.selector=="date"){
_2a=_28;
}else{
if(_24.selector=="time"){
_2a=_29;
}else{
_2a=_26["dateTimeFormat-"+_27].replace(/\{(\d+)\}/g,function(_2b,key){
return [_29,_28][key];
});
}
}
var _2c=[],re=_20(_2a,_1.hitch(this,_2d,_2c,_26,_24));
return {regexp:re,tokens:_2c,bundle:_26};
};
_a.parse=function(_2e,_2f){
var _30=/[\u200E\u200F\u202A\u202E]/g,_31=_a._parseInfo(_2f),_32=_31.tokens,_33=_31.bundle,re=new RegExp("^"+_31.regexp.replace(_30,"")+"$",_31.strict?"":"i"),_34=re.exec(_2e&&_2e.replace(_30,""));
if(!_34){
return null;
}
var _35=["abbr","wide","narrow"],_36=[1970,0,1,0,0,0,0],_37="",_38=_2.every(_34,function(v,i){
if(!i){
return true;
}
var _39=_32[i-1],l=_39.length,c=_39.charAt(0);
switch(c){
case "y":
if(l!=2&&_2f.strict){
_36[0]=v;
}else{
if(v<100){
v=Number(v);
var _3a=""+new Date().getFullYear(),_3b=_3a.substring(0,2)*100,_3c=Math.min(Number(_3a.substring(2,4))+20,99);
_36[0]=(v<_3c)?_3b+v:_3b-100+v;
}else{
if(_2f.strict){
return false;
}
_36[0]=v;
}
}
break;
case "M":
case "L":
if(l>2){
var _3d=_33["months-"+(c=="L"?"standAlone":"format")+"-"+_35[l-3]].concat();
if(!_2f.strict){
v=v.replace(".","").toLowerCase();
_3d=_2.map(_3d,function(s){
return s.replace(".","").toLowerCase();
});
}
v=_2.indexOf(_3d,v);
if(v==-1){
return false;
}
}else{
v--;
}
_36[1]=v;
break;
case "E":
case "e":
case "c":
var _3e=_33["days-"+(c=="c"?"standAlone":"format")+"-"+_35[l-3]].concat();
if(!_2f.strict){
v=v.toLowerCase();
_3e=_2.map(_3e,function(d){
return d.toLowerCase();
});
}
v=_2.indexOf(_3e,v);
if(v==-1){
return false;
}
break;
case "D":
_36[1]=0;
case "d":
_36[2]=v;
break;
case "a":
var am=_2f.am||_33["dayPeriods-format-wide-am"],pm=_2f.pm||_33["dayPeriods-format-wide-pm"];
if(!_2f.strict){
var _3f=/\./g;
v=v.replace(_3f,"").toLowerCase();
am=am.replace(_3f,"").toLowerCase();
pm=pm.replace(_3f,"").toLowerCase();
}
if(_2f.strict&&v!=am&&v!=pm){
return false;
}
_37=(v==pm)?"p":(v==am)?"a":"";
break;
case "K":
if(v==24){
v=0;
}
case "h":
case "H":
case "k":
if(v>23){
return false;
}
_36[3]=v;
break;
case "m":
_36[4]=v;
break;
case "s":
_36[5]=v;
break;
case "S":
_36[6]=v;
}
return true;
});
var _40=+_36[3];
if(_37==="p"&&_40<12){
_36[3]=_40+12;
}else{
if(_37==="a"&&_40==12){
_36[3]=0;
}
}
var _41=new Date(_36[0],_36[1],_36[2],_36[3],_36[4],_36[5],_36[6]);
if(_2f.strict){
_41.setFullYear(_36[0]);
}
var _42=_32.join(""),_43=_42.indexOf("d")!=-1,_44=_42.indexOf("M")!=-1;
if(!_38||(_44&&_41.getMonth()>_36[1])||(_43&&_41.getDate()>_36[2])){
return null;
}
if((_44&&_41.getMonth()<_36[1])||(_43&&_41.getDate()<_36[2])){
_41=_3.add(_41,"hour",1);
}
return _41;
};
function _20(_45,_46,_47,_48){
var _49=function(x){
return x;
};
_46=_46||_49;
_47=_47||_49;
_48=_48||_49;
var _4a=_45.match(/(''|[^'])+/g),_4b=_45.charAt(0)=="'";
_2.forEach(_4a,function(_4c,i){
if(!_4c){
_4a[i]="";
}else{
_4a[i]=(_4b?_47:_46)(_4c.replace(/''/g,"'"));
_4b=!_4b;
}
});
return _48(_4a.join(""));
};
function _2d(_4d,_4e,_4f,_50){
_50=_6.escapeString(_50);
if(!_4f.strict){
_50=_50.replace(" a"," ?a");
}
return _50.replace(/([a-z])\1*/ig,function(_51){
var s,c=_51.charAt(0),l=_51.length,p2="",p3="";
if(_4f.strict){
if(l>1){
p2="0"+"{"+(l-1)+"}";
}
if(l>2){
p3="0"+"{"+(l-2)+"}";
}
}else{
p2="0?";
p3="0{0,2}";
}
switch(c){
case "y":
s="\\d{2,4}";
break;
case "M":
case "L":
s=(l>2)?"\\S+?":"1[0-2]|"+p2+"[1-9]";
break;
case "D":
s="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+p2+"[1-9][0-9]|"+p3+"[1-9]";
break;
case "d":
s="3[01]|[12]\\d|"+p2+"[1-9]";
break;
case "w":
s="[1-4][0-9]|5[0-3]|"+p2+"[1-9]";
break;
case "E":
case "e":
case "c":
s=".+?";
break;
case "h":
s="1[0-2]|"+p2+"[1-9]";
break;
case "k":
s="1[01]|"+p2+"\\d";
break;
case "H":
s="1\\d|2[0-3]|"+p2+"\\d";
break;
case "K":
s="1\\d|2[0-4]|"+p2+"[1-9]";
break;
case "m":
case "s":
s="[0-5]\\d";
break;
case "S":
s="\\d{"+l+"}";
break;
case "a":
var am=_4f.am||_4e["dayPeriods-format-wide-am"],pm=_4f.pm||_4e["dayPeriods-format-wide-pm"];
s=am+"|"+pm;
if(!_4f.strict){
if(am!=am.toLowerCase()){
s+="|"+am.toLowerCase();
}
if(pm!=pm.toLowerCase()){
s+="|"+pm.toLowerCase();
}
if(s.indexOf(".")!=-1){
s+="|"+s.replace(/\./g,"");
}
}
s=s.replace(/\./g,"\\.");
break;
default:
s=".*";
}
if(_4d){
_4d.push(_51);
}
return "("+s+")";
}).replace(/[\xa0 ]/g,"[\\s\\xa0]");
};
var _52=[];
_a.addCustomFormats=function(_53,_54){
_52.push({pkg:_53,name:_54});
};
_a._getGregorianBundle=function(_55){
var _56={};
_2.forEach(_52,function(_57){
var _58=_5.getLocalization(_57.pkg,_57.name,_55);
_56=_1.mixin(_56,_58);
},this);
return _56;
};
_a.addCustomFormats(_9.id.replace(/\/date\/locale$/,".cldr"),"gregorian");
_a.getNames=function(_59,_5a,_5b,_5c){
var _5d,_5e=_a._getGregorianBundle(_5c),_5f=[_59,_5b,_5a];
if(_5b=="standAlone"){
var key=_5f.join("-");
_5d=_5e[key];
if(_5d[0]==1){
_5d=undefined;
}
}
_5f[1]="format";
return (_5d||_5e[_5f.join("-")]).concat();
};
_a.isWeekend=function(_60,_61){
var _62=_4.getWeekend(_61),day=(_60||new Date()).getDay();
if(_62.end<_62.start){
_62.end+=7;
if(day<_62.start){
day+=7;
}
}
return day>=_62.start&&day<=_62.end;
};
_a._getDayOfYear=function(_63){
return _3.difference(new Date(_63.getFullYear(),0,1,_63.getHours()),_63)+1;
};
_a._getWeekOfYear=function(_64,_65){
if(arguments.length==1){
_65=0;
}
var _66=new Date(_64.getFullYear(),0,1).getDay(),adj=(_66-_65+7)%7,_67=Math.floor((_a._getDayOfYear(_64)+adj-1)/7);
if(_66==_65){
_67++;
}
return _67;
};
return _a;
});


;define("dojo/dnd/move",["../_base/declare","../dom-geometry","../dom-style","./common","./Mover","./Moveable"],function(_1,_2,_3,_4,_5,_6){
var _7=_1("dojo.dnd.move.constrainedMoveable",_6,{constraints:function(){
},within:false,constructor:function(_8,_9){
if(!_9){
_9={};
}
this.constraints=_9.constraints;
this.within=_9.within;
},onFirstMove:function(_a){
var c=this.constraintBox=this.constraints.call(this,_a);
c.r=c.l+c.w;
c.b=c.t+c.h;
if(this.within){
var mb=_2.getMarginSize(_a.node);
c.r-=mb.w;
c.b-=mb.h;
}
},onMove:function(_b,_c){
var c=this.constraintBox,s=_b.node.style;
this.onMoving(_b,_c);
_c.l=_c.l<c.l?c.l:c.r<_c.l?c.r:_c.l;
_c.t=_c.t<c.t?c.t:c.b<_c.t?c.b:_c.t;
s.left=_c.l+"px";
s.top=_c.t+"px";
this.onMoved(_b,_c);
}});
var _d=_1("dojo.dnd.move.boxConstrainedMoveable",_7,{box:{},constructor:function(_e,_f){
var box=_f&&_f.box;
this.constraints=function(){
return box;
};
}});
var _10=_1("dojo.dnd.move.parentConstrainedMoveable",_7,{area:"content",constructor:function(_11,_12){
var _13=_12&&_12.area;
this.constraints=function(){
var n=this.node.parentNode,s=_3.getComputedStyle(n),mb=_2.getMarginBox(n,s);
if(_13=="margin"){
return mb;
}
var t=_2.getMarginExtents(n,s);
mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;
if(_13=="border"){
return mb;
}
t=_2.getBorderExtents(n,s);
mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;
if(_13=="padding"){
return mb;
}
t=_2.getPadExtents(n,s);
mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;
return mb;
};
}});
return {constrainedMoveable:_7,boxConstrainedMoveable:_d,parentConstrainedMoveable:_10};
});


;define("dojo/fx/Toggler",["../_base/lang","../_base/declare","../_base/fx","../aspect"],function(_1,_2,_3,_4){
return _2("dojo.fx.Toggler",null,{node:null,showFunc:_3.fadeIn,hideFunc:_3.fadeOut,showDuration:200,hideDuration:200,constructor:function(_5){
var _6=this;
_1.mixin(_6,_5);
_6.node=_5.node;
_6._showArgs=_1.mixin({},_5);
_6._showArgs.node=_6.node;
_6._showArgs.duration=_6.showDuration;
_6.showAnim=_6.showFunc(_6._showArgs);
_6._hideArgs=_1.mixin({},_5);
_6._hideArgs.node=_6.node;
_6._hideArgs.duration=_6.hideDuration;
_6.hideAnim=_6.hideFunc(_6._hideArgs);
_4.after(_6.showAnim,"beforeBegin",_1.hitch(_6.hideAnim,"stop",true),true);
_4.after(_6.hideAnim,"beforeBegin",_1.hitch(_6.showAnim,"stop",true),true);
},show:function(_7){
return this.showAnim.play(_7||0);
},hide:function(_8){
return this.hideAnim.play(_8||0);
}});
});


;define("dojo/fx",["./_base/lang","./Evented","./_base/kernel","./_base/array","./aspect","./_base/fx","./dom","./dom-style","./dom-geometry","./ready","require","./fx/Toggler"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
var _c=_3.fx={};
var _d={_fire:function(_e,_f){
if(this[_e]){
this[_e].apply(this,_f||[]);
}
return this;
}};
var _10=function(_11){
this._index=-1;
this._animations=_11||[];
this._current=this._onAnimateCtx=this._onEndCtx=null;
this.duration=0;
_4.forEach(this._animations,function(a){
this.duration+=a.duration;
if(a.delay){
this.duration+=a.delay;
}
},this);
};
_10.prototype=new _2();
_1.extend(_10,{_onAnimate:function(){
this._fire("onAnimate",arguments);
},_onEnd:function(){
this._onAnimateCtx.remove();
this._onEndCtx.remove();
this._onAnimateCtx=this._onEndCtx=null;
if(this._index+1==this._animations.length){
this._fire("onEnd");
}else{
this._current=this._animations[++this._index];
this._onAnimateCtx=_5.after(this._current,"onAnimate",_1.hitch(this,"_onAnimate"),true);
this._onEndCtx=_5.after(this._current,"onEnd",_1.hitch(this,"_onEnd"),true);
this._current.play(0,true);
}
},play:function(_12,_13){
if(!this._current){
this._current=this._animations[this._index=0];
}
if(!_13&&this._current.status()=="playing"){
return this;
}
var _14=_5.after(this._current,"beforeBegin",_1.hitch(this,function(){
this._fire("beforeBegin");
}),true),_15=_5.after(this._current,"onBegin",_1.hitch(this,function(arg){
this._fire("onBegin",arguments);
}),true),_16=_5.after(this._current,"onPlay",_1.hitch(this,function(arg){
this._fire("onPlay",arguments);
_14.remove();
_15.remove();
_16.remove();
}));
if(this._onAnimateCtx){
this._onAnimateCtx.remove();
}
this._onAnimateCtx=_5.after(this._current,"onAnimate",_1.hitch(this,"_onAnimate"),true);
if(this._onEndCtx){
this._onEndCtx.remove();
}
this._onEndCtx=_5.after(this._current,"onEnd",_1.hitch(this,"_onEnd"),true);
this._current.play.apply(this._current,arguments);
return this;
},pause:function(){
if(this._current){
var e=_5.after(this._current,"onPause",_1.hitch(this,function(arg){
this._fire("onPause",arguments);
e.remove();
}),true);
this._current.pause();
}
return this;
},gotoPercent:function(_17,_18){
this.pause();
var _19=this.duration*_17;
this._current=null;
_4.some(this._animations,function(a,_1a){
if(_19<=a.duration){
this._current=a;
this._index=_1a;
return true;
}
_19-=a.duration;
return false;
},this);
if(this._current){
this._current.gotoPercent(_19/this._current.duration);
}
if(_18){
this.play();
}
return this;
},stop:function(_1b){
if(this._current){
if(_1b){
for(;this._index+1<this._animations.length;++this._index){
this._animations[this._index].stop(true);
}
this._current=this._animations[this._index];
}
var e=_5.after(this._current,"onStop",_1.hitch(this,function(arg){
this._fire("onStop",arguments);
e.remove();
}),true);
this._current.stop();
}
return this;
},status:function(){
return this._current?this._current.status():"stopped";
},destroy:function(){
this.stop();
if(this._onAnimateCtx){
this._onAnimateCtx.remove();
}
if(this._onEndCtx){
this._onEndCtx.remove();
}
}});
_1.extend(_10,_d);
_c.chain=function(_1c){
return new _10(_1c);
};
var _1d=function(_1e){
this._animations=_1e||[];
this._connects=[];
this._finished=0;
this.duration=0;
_4.forEach(_1e,function(a){
var _1f=a.duration;
if(a.delay){
_1f+=a.delay;
}
if(this.duration<_1f){
this.duration=_1f;
}
this._connects.push(_5.after(a,"onEnd",_1.hitch(this,"_onEnd"),true));
},this);
this._pseudoAnimation=new _6.Animation({curve:[0,1],duration:this.duration});
var _20=this;
_4.forEach(["beforeBegin","onBegin","onPlay","onAnimate","onPause","onStop","onEnd"],function(evt){
_20._connects.push(_5.after(_20._pseudoAnimation,evt,function(){
_20._fire(evt,arguments);
},true));
});
};
_1.extend(_1d,{_doAction:function(_21,_22){
_4.forEach(this._animations,function(a){
a[_21].apply(a,_22);
});
return this;
},_onEnd:function(){
if(++this._finished>this._animations.length){
this._fire("onEnd");
}
},_call:function(_23,_24){
var t=this._pseudoAnimation;
t[_23].apply(t,_24);
},play:function(_25,_26){
this._finished=0;
this._doAction("play",arguments);
this._call("play",arguments);
return this;
},pause:function(){
this._doAction("pause",arguments);
this._call("pause",arguments);
return this;
},gotoPercent:function(_27,_28){
var ms=this.duration*_27;
_4.forEach(this._animations,function(a){
a.gotoPercent(a.duration<ms?1:(ms/a.duration),_28);
});
this._call("gotoPercent",arguments);
return this;
},stop:function(_29){
this._doAction("stop",arguments);
this._call("stop",arguments);
return this;
},status:function(){
return this._pseudoAnimation.status();
},destroy:function(){
this.stop();
_4.forEach(this._connects,function(_2a){
_2a.remove();
});
}});
_1.extend(_1d,_d);
_c.combine=function(_2b){
return new _1d(_2b);
};
_c.wipeIn=function(_2c){
var _2d=_2c.node=_7.byId(_2c.node),s=_2d.style,o;
var _2e=_6.animateProperty(_1.mixin({properties:{height:{start:function(){
o=s.overflow;
s.overflow="hidden";
if(s.visibility=="hidden"||s.display=="none"){
s.height="1px";
s.display="";
s.visibility="";
return 1;
}else{
var _2f=_8.get(_2d,"height");
return Math.max(_2f,1);
}
},end:function(){
return _2d.scrollHeight;
}}}},_2c));
var _30=function(){
s.height="auto";
s.overflow=o;
};
_5.after(_2e,"onStop",_30,true);
_5.after(_2e,"onEnd",_30,true);
return _2e;
};
_c.wipeOut=function(_31){
var _32=_31.node=_7.byId(_31.node),s=_32.style,o;
var _33=_6.animateProperty(_1.mixin({properties:{height:{end:1}}},_31));
_5.after(_33,"beforeBegin",function(){
o=s.overflow;
s.overflow="hidden";
s.display="";
},true);
var _34=function(){
s.overflow=o;
s.height="auto";
s.display="none";
};
_5.after(_33,"onStop",_34,true);
_5.after(_33,"onEnd",_34,true);
return _33;
};
_c.slideTo=function(_35){
var _36=_35.node=_7.byId(_35.node),top=null,_37=null;
var _38=(function(n){
return function(){
var cs=_8.getComputedStyle(n);
var pos=cs.position;
top=(pos=="absolute"?n.offsetTop:parseInt(cs.top)||0);
_37=(pos=="absolute"?n.offsetLeft:parseInt(cs.left)||0);
if(pos!="absolute"&&pos!="relative"){
var ret=_9.position(n,true);
top=ret.y;
_37=ret.x;
n.style.position="absolute";
n.style.top=top+"px";
n.style.left=_37+"px";
}
};
})(_36);
_38();
var _39=_6.animateProperty(_1.mixin({properties:{top:_35.top||0,left:_35.left||0}},_35));
_5.after(_39,"beforeBegin",_38,true);
return _39;
};
return _c;
});


;define("dojo/request/iframe",["module","require","./watch","./util","./handlers","../_base/lang","../io-query","../query","../has","../dom","../dom-construct","../_base/window","../NodeList-dom"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
var _d=_1.id.replace(/[\/\.\-]/g,"_"),_e=_d+"_onload";
if(!_c.global[_e]){
_c.global[_e]=function(){
var _f=_10._currentDfd;
if(!_f){
_10._fireNextRequest();
return;
}
var _11=_f.response,_12=_11.options,_13=_a.byId(_12.form)||_f._tmpForm;
if(_13){
var _14=_f._contentToClean;
for(var i=0;i<_14.length;i++){
var key=_14[i];
for(var j=0;j<_13.childNodes.length;j++){
var _15=_13.childNodes[j];
if(_15.name===key){
_b.destroy(_15);
break;
}
}
}
_f._originalAction&&_13.setAttribute("action",_f._originalAction);
if(_f._originalMethod){
_13.setAttribute("method",_f._originalMethod);
_13.method=_f._originalMethod;
}
if(_f._originalTarget){
_13.setAttribute("target",_f._originalTarget);
_13.target=_f._originalTarget;
}
}
if(_f._tmpForm){
_b.destroy(_f._tmpForm);
delete _f._tmpForm;
}
_f._finished=true;
};
}
function _16(_17,_18,uri){
if(_c.global[_17]){
return _c.global[_17];
}
if(_c.global.frames[_17]){
return _c.global.frames[_17];
}
if(!uri){
if(_9("config-useXDomain")&&!_9("config-dojoBlankHtmlUrl")){
console.warn("dojo/request/iframe: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");
}
uri=(_9("config-dojoBlankHtmlUrl")||_2.toUrl("dojo/resources/blank.html"));
}
var _19=_b.place("<iframe id=\""+_17+"\" name=\""+_17+"\" src=\""+uri+"\" onload=\""+_18+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",_c.body());
_c.global[_17]=_19;
return _19;
};
function _1a(_1b,src,_1c){
var _1d=_c.global.frames[_1b.name];
if(_1d.contentWindow){
_1d=_1d.contentWindow;
}
try{
if(!_1c){
_1d.location=src;
}else{
_1d.location.replace(src);
}
}
catch(e){
console.log("dojo/request/iframe.setSrc: ",e);
}
};
function doc(_1e){
if(_1e.contentDocument){
return _1e.contentDocument;
}
var _1f=_1e.name;
if(_1f){
var _20=_c.doc.getElementsByTagName("iframe");
if(_1e.document&&_20[_1f].contentWindow&&_20[_1f].contentWindow.document){
return _20[_1f].contentWindow.document;
}else{
if(_c.doc.frames[_1f]&&_c.doc.frames[_1f].document){
return _c.doc.frames[_1f].document;
}
}
}
return null;
};
function _21(){
return _b.create("form",{name:_d+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},_c.body());
};
function _22(){
var dfd;
try{
if(_10._currentDfd||!_10._dfdQueue.length){
return;
}
do{
dfd=_10._currentDfd=_10._dfdQueue.shift();
}while(dfd&&(dfd.canceled||(dfd.isCanceled&&dfd.isCanceled()))&&_10._dfdQueue.length);
if(!dfd||dfd.canceled||(dfd.isCanceled&&dfd.isCanceled())){
_10._currentDfd=null;
return;
}
var _23=dfd.response,_24=_23.options,c2c=dfd._contentToClean=[],_25=_a.byId(_24.form),_26=_4.notify,_27=_24.data||null,_28;
if(!dfd._legacy&&_24.method==="POST"&&!_25){
_25=dfd._tmpForm=_21();
}else{
if(_24.method==="GET"&&_25&&_23.url.indexOf("?")>-1){
_28=_23.url.slice(_23.url.indexOf("?")+1);
_27=_6.mixin(_7.queryToObject(_28),_27);
}
}
if(_25){
if(!dfd._legacy){
var _29=_25;
do{
_29=_29.parentNode;
}while(_29&&_29!==_c.doc.documentElement);
if(!_29){
_25.style.position="absolute";
_25.style.left="-1000px";
_25.style.top="-1000px";
_c.body().appendChild(_25);
}
if(!_25.name){
_25.name=_d+"_form";
}
}
if(_27){
var _2a=function(_2b,_2c){
_b.create("input",{type:"hidden",name:_2b,value:_2c},_25);
c2c.push(_2b);
};
for(var x in _27){
var val=_27[x];
if(_6.isArray(val)&&val.length>1){
for(var i=0;i<val.length;i++){
_2a(x,val[i]);
}
}else{
if(!_25[x]){
_2a(x,val);
}else{
_25[x].value=val;
}
}
}
}
var _2d=_25.getAttributeNode("action"),_2e=_25.getAttributeNode("method"),_2f=_25.getAttributeNode("target");
if(_23.url){
dfd._originalAction=_2d?_2d.value:null;
if(_2d){
_2d.value=_23.url;
}else{
_25.setAttribute("action",_23.url);
}
}
if(!dfd._legacy){
dfd._originalMethod=_2e?_2e.value:null;
if(_2e){
_2e.value=_24.method;
}else{
_25.setAttribute("method",_24.method);
}
}else{
if(!_2e||!_2e.value){
if(_2e){
_2e.value=_24.method;
}else{
_25.setAttribute("method",_24.method);
}
}
}
dfd._originalTarget=_2f?_2f.value:null;
if(_2f){
_2f.value=_10._iframeName;
}else{
_25.setAttribute("target",_10._iframeName);
}
_25.target=_10._iframeName;
_26&&_26.emit("send",_23,dfd.promise.cancel);
_10._notifyStart(_23);
_25.submit();
}else{
var _30="";
if(_23.options.data){
_30=_23.options.data;
if(typeof _30!=="string"){
_30=_7.objectToQuery(_30);
}
}
var _31=_23.url+(_23.url.indexOf("?")>-1?"&":"?")+_30;
_26&&_26.emit("send",_23,dfd.promise.cancel);
_10._notifyStart(_23);
_10.setSrc(_10._frame,_31,true);
}
}
catch(e){
dfd.reject(e);
}
};
function _32(_33){
return !this.isFulfilled();
};
function _34(_35){
return !!this._finished;
};
function _36(_37,_38){
if(!_38){
try{
var _39=_37.options,doc=_10.doc(_10._frame),_3a=_39.handleAs;
if(_3a!=="html"){
if(_3a==="xml"){
if(doc.documentElement.tagName.toLowerCase()==="html"){
_8("a",doc.documentElement).orphan();
var _3b=doc.documentElement.innerText;
_3b=_3b.replace(/>\s+</g,"><");
_37.text=_6.trim(_3b);
}else{
_37.data=doc;
}
}else{
_37.text=doc.getElementsByTagName("textarea")[0].value;
}
_5(_37);
}else{
_37.data=doc;
}
}
catch(e){
_38=e;
}
}
if(_38){
this.reject(_38);
}else{
if(this._finished){
this.resolve(_37);
}else{
this.reject(new Error("Invalid dojo/request/iframe request state"));
}
}
};
function _3c(_3d){
this._callNext();
};
var _3e={method:"POST"};
function _10(url,_3f,_40){
var _41=_4.parseArgs(url,_4.deepCreate(_3e,_3f),true);
url=_41.url;
_3f=_41.options;
if(_3f.method!=="GET"&&_3f.method!=="POST"){
throw new Error(_3f.method+" not supported by dojo/request/iframe");
}
if(!_10._frame){
_10._frame=_10.create(_10._iframeName,_e+"();");
}
var dfd=_4.deferred(_41,null,_32,_34,_36,_3c);
dfd._callNext=function(){
if(!this._calledNext){
this._calledNext=true;
_10._currentDfd=null;
_10._fireNextRequest();
}
};
dfd._legacy=_40;
_10._dfdQueue.push(dfd);
_10._fireNextRequest();
_3(dfd);
return _40?dfd:dfd.promise;
};
_10.create=_16;
_10.doc=doc;
_10.setSrc=_1a;
_10._iframeName=_d+"_IoIframe";
_10._notifyStart=function(){
};
_10._dfdQueue=[];
_10._currentDfd=null;
_10._fireNextRequest=_22;
_4.addCommonMethods(_10,["GET","POST"]);
return _10;
});


;define("dojo/io/iframe",["../_base/config","../_base/json","../_base/kernel","../_base/lang","../_base/xhr","../sniff","../_base/window","../dom","../dom-construct","../query","require","../aspect","../request/iframe"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){
_3.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");
var _e=_d._iframeName;
_e=_e.substring(0,_e.lastIndexOf("_"));
var _f=_4.delegate(_d,{create:function(){
return _f._frame=_d.create.apply(_d,arguments);
},get:null,post:null,send:function(_10){
var _11;
var dfd=_5._ioSetArgs(_10,function(dfd){
_11&&_11.cancel();
},function(dfd){
var _12=null,_13=dfd.ioArgs;
try{
var _14=_13.handleAs;
if(_14==="xml"||_14==="html"){
_12=_11.response.data;
}else{
_12=_11.response.text;
if(_14==="json"){
_12=_2.fromJson(_12);
}else{
if(_14==="javascript"){
_12=_3.eval(_12);
}
}
}
}
catch(e){
_12=e;
}
return _12;
},function(_15,dfd){
dfd.ioArgs._hasError=true;
return _15;
});
var _16=dfd.ioArgs;
var _17="GET",_18=_8.byId(_10.form);
if(_10.method&&_10.method.toUpperCase()==="POST"&&_18){
_17="POST";
}
var _19={method:_17,handleAs:_10.handleAs==="json"||_10.handleAs==="javascript"?"text":_10.handleAs,form:_10.form,query:_18?null:_10.content,data:_18?_10.content:null,timeout:_10.timeout,ioArgs:_16};
if(_19.method){
_19.method=_19.method.toUpperCase();
}
if(_1.ioPublish&&_3.publish&&_16.args.ioPublish!==false){
var _1a=_c.after(_d,"_notifyStart",function(_1b){
if(_1b.options.ioArgs===_16){
_1a.remove();
_5._ioNotifyStart(dfd);
}
},true);
}
_11=_d(_16.url,_19,true);
_16._callNext=_11._callNext;
_11.then(function(){
dfd.resolve(dfd);
}).otherwise(function(_1c){
dfd.ioArgs.error=_1c;
dfd.reject(_1c);
});
return dfd;
},_iframeOnload:_7.global[_e+"_onload"]});
_4.setObject("dojo.io.iframe",_f);
return _f;
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["lconn.core"]=true;

;if(!dojo._hasResource["lconn.core.util.dojoPatches"]){
dojo._hasResource["lconn.core.util.dojoPatches"]=true;
dojo.provide("lconn.core.util.dojoPatches");
dijit._frames=new function(){
var _1=[];
this.pop=function(){
var _2;
if(_1.length){
_2=_1.pop();
_2.style.display="";
}else{
if(dojo.isIE){
var _3=dojo.config["dojoBlankHtmlUrl"]||(dojo.moduleUrl("dojo","resources/blank.html")+"")||"javascript:\"\"";
if(dojo.isIE>8){
_2=dojo.doc.createElement("iframe");
_2.setAttribute("src",_3);
_2.setAttribute("style","position: absolute; left: 0px; top: 0px;"+"z-index: -1; filter:Alpha(Opacity=\"0\");");
}else{
var _4="<iframe src='"+_3+"'"+" style='position: absolute; left: 0px; top: 0px;"+"z-index: -1; filter:Alpha(Opacity=\"0\");'>";
_2=dojo.doc.createElement(_4);
}
}else{
_2=dojo.create("iframe");
_2.src="javascript:\"\"";
_2.className="dijitBackgroundIframe";
dojo.style(_2,"opacity",0.1);
}
_2.tabIndex=-1;
if(!dijit.hasWaiRole(_2)){
dijit.setWaiRole(_2,"presentation");
}
}
return _2;
};
this.push=function(_5){
_5.style.display="none";
_1.push(_5);
};
}();
(function(){
if(typeof dojo.isEdge=="undefined"){
dojo.isEdge=false;
try{
var _6=navigator.appVersion+".";
if(_6.indexOf(" Edge/")>-1){
_6=_6.substring(_6.indexOf(" Edge/")+6);
_6=_6.substring(0,_6.indexOf("."));
_6=parseInt(_6,10);
dojo.isEdge=_6;
}
}
catch(e){
}
}
})();
}


;if(!dojo._hasResource["lconn.core.a11y"]){
dojo._hasResource["lconn.core.a11y"]=true;
dojo.provide("lconn.core.a11y");
dojo.addOnLoad(function(){
var _1=document.getElementsByTagName("body")[0];
if(dojo.hasClass(_1,"dijit_a11y")){
dojo.addClass(_1,"lotusImagesOff");
}
});
}


;if(!dojo._hasResource["lconn.core.config.features"]){
dojo._hasResource["lconn.core.config.features"]=true;
dojo.provide("lconn.core.config.features");
(function(){
"use strict";
lconn.core.config.features=function(_1){
var _2=window.gatekeeperConfig||{};
return _2[_1];
};
lconn.core.config.features.add=function(){
console.warn("lconn.core.config.features cannot be used to access dojo/has");
};
}());
}

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["dojox"]=true;

;define("dojox/main",["dojo/_base/kernel"],function(_1){
return _1.dojox;
});


;define("dojox/lang/functional/lambda",["../..","dojo/_base/lang","dojo/_base/array"],function(_1,_2,_3){
var df=_2.getObject("lang.functional",true,_1);
var _4={};
var _5="ab".split(/a*/).length>1?String.prototype.split:function(_6){
var r=this.split.call(this,_6),m=_6.exec(this);
if(m&&m.index==0){
r.unshift("");
}
return r;
};
var _7=function(s){
var _8=[],_9=_5.call(s,/\s*->\s*/m);
if(_9.length>1){
while(_9.length){
s=_9.pop();
_8=_9.pop().split(/\s*,\s*|\s+/m);
if(_9.length){
_9.push("(function("+_8.join(", ")+"){ return ("+s+"); })");
}
}
}else{
if(s.match(/\b_\b/)){
_8=["_"];
}else{
var l=s.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),r=s.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);
if(l||r){
if(l){
_8.push("$1");
s="$1"+s;
}
if(r){
_8.push("$2");
s=s+"$2";
}
}else{
var _a=s.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,"").match(/([a-z_$][a-z_$\d]*)/gi)||[],t={};
_3.forEach(_a,function(v){
if(!t.hasOwnProperty(v)){
_8.push(v);
t[v]=1;
}
});
}
}
}
return {args:_8,body:s};
};
var _b=function(a){
return a.length?function(){
var i=a.length-1,x=df.lambda(a[i]).apply(this,arguments);
for(--i;i>=0;--i){
x=df.lambda(a[i]).call(this,x);
}
return x;
}:function(x){
return x;
};
};
_2.mixin(df,{rawLambda:function(s){
return _7(s);
},buildLambda:function(s){
var l=_7(s);
return "function("+l.args.join(",")+"){return ("+l.body+");}";
},lambda:function(s){
if(typeof s=="function"){
return s;
}
if(s instanceof Array){
return _b(s);
}
if(_4.hasOwnProperty(s)){
return _4[s];
}
var l=_7(s);
return _4[s]=new Function(l.args,"return ("+l.body+");");
},clearLambdaCache:function(){
_4={};
}});
return df;
});


;define("dojox/lang/functional/object",["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(_1,_2,df){
var _3={};
_2.mixin(df,{keys:function(_4){
var t=[];
for(var i in _4){
if(!(i in _3)){
t.push(i);
}
}
return t;
},values:function(_5){
var t=[];
for(var i in _5){
if(!(i in _3)){
t.push(_5[i]);
}
}
return t;
},filterIn:function(_6,f,o){
o=o||_1.global;
f=df.lambda(f);
var t={},v,i;
for(i in _6){
if(!(i in _3)){
v=_6[i];
if(f.call(o,v,i,_6)){
t[i]=v;
}
}
}
return t;
},forIn:function(_7,f,o){
o=o||_1.global;
f=df.lambda(f);
for(var i in _7){
if(!(i in _3)){
f.call(o,_7[i],i,_7);
}
}
return o;
},mapIn:function(_8,f,o){
o=o||_1.global;
f=df.lambda(f);
var t={},i;
for(i in _8){
if(!(i in _3)){
t[i]=f.call(o,_8[i],i,_8);
}
}
return t;
}});
return df;
});


;if(!dojo._hasResource["lconn.core.config.htmlClass"]){
dojo._hasResource["lconn.core.config.htmlClass"]=true;
dojo.provide("lconn.core.config.htmlClass");


(function(_1,df,_2){
dojo.deprecated("lconn.core.config.htmlClass","Use the AMD module ic-core/config/htmlClass instead","6.0");
_1.mixin(_2,{get:function(){
var _3=[];
df.mapIn(_1.getObject("gatekeeperConfig"),function(_4,_5){
if(_4===true){
_3.push(_5);
}
});
return _3.sort().join(" ");
}});
dojo.addOnLoad(function(){
dojo.addClass(document.getElementsByTagName("html")[0],_2.get());
});
return _2;
}(dojo,dojox.lang.functional,lconn.core.config.htmlClass));
}


;if(!dojo._hasResource["lconn.core.MenuUtility"]){
dojo._hasResource["lconn.core.MenuUtility"]=true;
dojo.provide("lconn.core.MenuUtility");




dojo.declare("lconn.core.MenuUtility",null,{openMenu:function(_1,_2,_3,_4){
dojo.deprecated("lconn.core.MenuUtility","Use com.ibm.oneui.util.openAround","3.5");
if(_1){
_1=dojo.fixEvent(_1);
}
com.ibm.oneui.util.openAround(_2,_3,_4,_1);
},openMenuA11y:function(_5,_6){
dojo.deprecated("lconn.core.MenuUtility","Use com.ibm.oneui.util.openAround, this is handled by standard onclick events","3.5");
if(_5.keyCode==dojo.keys.ENTER){
this.openMenu(_5,_6);
}
}});
menuUtility=new lconn.core.MenuUtility();
lconn.core.MenuUtility.open=function(_7,e){
dojo.deprecated("lconn.core.MenuUtility","Use com.ibm.oneui.util.openAround","3.5");
menuUtility.openMenu(e,_7);
};
lconn.core.MenuUtility.openAround=function(_8,_9,_a){
dojo.deprecated("lconn.core.MenuUtility","Use com.ibm.oneui.util.openAround","3.5");
menuUtility.openMenu(null,_8,_9,_a);
};
lconn.core.MenuUtility.attachListeners=function(_b,_c,_d,_e){
var _d=_d||dojo.partial(lconn.core.MenuUtility.openAround,_b,_c);
dojo.connect(_c,"onclick",_d);
dojo.connect(_c,"onmousedown",function(){
_b.preventReopen=_b.isShowingNow||_b.wasShowing;
_b.wasShowing=false;
});
dojo.connect(_c,"onkeypress",function(e){
_b.wasShowing=_b.preventReopen=false;
if((e.charOrCode==dojo.keys.DOWN_ARROW)||(e.charCode==dojo.keys.SPACE&&_e)){
dojo.stopEvent(e);
_d();
}
});
_c=null;
};
}

dojo.provide("lconn.core.nls.strings")._built=true;
dojo.provide("lconn.core.nls.strings.en_us");
lconn.core.nls.strings.en_us={"rs_mobileBanner_title":"IBM Connections","rs_forumSettingCancel":"Cancel","rs_actUpdatedByDate":"Updated by ${0} ${1}","rs_copyTemplateMembers":"Use members from template","rs_personColon":"Person: ","rs_forumMessages":"${0} messages","rs_messagebox_close_btn_title":"Close","rs_startActivity":"Start an Activity","rs_jumpPage":"Jump to page ${0} of ${1}","rs_PersonExternal":"${0} (External User)","rs_tagDialogCloseTile":"Close","rs_shared":"Shared","rs_vmcancel":"Cancel","rs_tuneOut":"Mark as Tuned Out","rs_normalTemplate":"Mark as normal template","rs_docpicker_viewdetails_text":"View Details","rs_widgets_loading_error_title":"Unable to display the widget(s) in this community","rs_clearAll":"Clear all","rs_notificationConfirm":"The notification message was sent successfully. ","rs_group_browse_previous_page":"Previous Page","rs_advanced":"Advanced","rs_startFirstTopic":"Start the First Topic","rs_markComplete":"Mark Complete","rs_activityFormGoal":"Activity Goal","rs_externalLabel":"External","rs_typeToFilter":"Type to filter this list","rs_group_browse_groups":"Browse Groups","rs_vmsave":"Save","rs_favoriteTemplate":"Mark as Favorite Template","rs_viewAsCloudTitle":"List tags as a tag cloud","rs_prioritize":"Prioritize","rs_hide":"Hide","rs_deleteEntry":"Delete","rs_searchCommunityDirectory":"Community not listed? Use full search...","rs_customLangaugeLinkLabel":"Custom Language","rs_widget_loading_error_message":"Try again later and contact your system administrator if the problem persists.","rs_shadowText_searchDirectory":"Type to find person","rs_tagCloudViewAllTitle":"Browse all tags","rs_notifyColon":"Notify: ","rs_ok":"OK","rs_peopleLabel":"People","rs_forumTopics":"${0} topics","rs_group_browse_enter_string":"Type to find groups","rs_shadowText_searchPersonAndGroupDirectory":"Type to find person or group","rs_template":"Template","rs_viewAll":"View All","rs_vminvite":"Invite","rs_forumSettingNote":"Note: Topics display by default if there is only one forum.","rs_vmradioTwo":"Automatically add users to community","rs_tagCloudRelatedTagsDescription":"Add a related tag to further refine your search","rs_externalText":"This activity can have members from outside your organization.","rs_messageColon":"Message: ","rs_vmradioOne":"Send invitations to join the community","rs_topics":"topics","rs_activityWidgetTitle":"Activities","rs_notificationFail":"The notification message was not sent. Try again later and contact your system administrator if the problem persists.","rs_widget_misplacement_warning":"This app does not fit in this column. A community owner can move it to another column or remove it from the page.","rs_widget_title_change_title":"Change Title","rs_linkLess":"... [less]","rs_vmmessage":"Message:","rs_messagebox_info_icon_alt":"Information","rs_vmaddUser":"Create User","rs_medPri":"Medium Priority","rs_tagDialogPageInfo":"${0} - ${1} of ${2} tags","rs_vmgroupTypeAheadRoleLabel":" as Members ","rs_yesterday":"Yesterday","rs_forumSettingCommunityOverviewPage":"Community overview page:","rs_tagCloudNavigationLabel":"Tags","rs_group_name":"Group Name","rs_replies":"replies","rs_member_add_to_community":"Click to add member","rs_messagebox_warning_a11y_label":"Warning:","rs_listItem":"List item","rs_vmmainContentDesc":"Invite members to give them the opportunity to join in the community. Add members to automatically include them.","rs_widget_loading_error_title":"Unable to display the widget","rs_typeName":"Type in a Name","rs_activityFeedLink":"Feed for these activities","rs_pageLabel":"Page:","rs_forumSettingApplicationView":"Forum application default view:","rs_group_remove_name":"Click to remove group","rs_vmmainContentTitle":"Invite or Add Members","rs_activityWidgetBriefDescription":"Track community goals.  Create to-dos and share resources.","rs_group_browse_parent_group_label":"You are in:","rs_tagLoadingTags":"Loading Content","rs_vmradioSectionTitle":"Member Options:","rs_vmtwistyA":"Add an Optional Message","rs_vmtwistyB":"Remove additional text","rs_loading":"Loading...","rs_forumOpenQuestions":"Open Questions","rs_removeTagTitle":"Remove the tag ${0} from the selected filter tags","rs_vmtypeAheadLabel":"Name or Email: ","rs_edit":"Edit","rs_startFromTemplate":"Start Activity from this Template","rs_createPersonLink":"Create Person Link","rs_searchPersonAndGroupDirectory":"Person or group not listed? Use full search...","rs_notifyOthers":"Notify other people","rs_hideInfo":"Hide extra information","rs_embedfolder_message":" is a folder. We recommend selecting a file instead so that you can share files with community members","rs_vmgroupTypeAheadLabel":"Name: ","rs_inactivePerson":"${0} (inactive)","rs_messagebox_info_a11y_label":"Information:","rs_sharefile_invalid_request":"An error occurred while sharing the selected files.","rs_search":"Search","rs_pagepos":"${0} - ${1} of ${2}","rs_group_browse_remove_selection":"Remove nested group selection: ${0}","rs_tagCloudHelpAlt":"Get help with tags","rs_PersonExternalLabel":"External User","rs_tagCloudSeach":"Search","rs_mobileBanner_author":"IBM Collaboration Solutions","rs_sharefile_error_title":"Error","rs_labelColon":"Label: ","rs_widget_title_change_label":"Title:  ","rs_member_remove_group":"Remove ${0}","rs_member_groups":"Groups","rs_vmcheckboxLabel":"Send me a copy","rs_vmtextAreaStartText":"Say something...","rs_addTagTitle":"Filter by the tag ${0} with count ${1}","rs_messagebox_close_btn_alt":"Close","rs_forumSettingSubmit":"Submit","rs_highPri":"High Priority","rs_forumSortByTopicsAndReplies":"Topics and Replies","rs_personLink":"Person Link","rs_topic":"topic","rs_searchGroupDirectory":"Group not listed? Use full search...","rs_docpicker_download_title":"Download ${0}","rs_all_connections":"All Connections","rs_viewAsCloud":"Cloud","rs_mobileBanner_inGooglePlay":"In Google Play","rs_markIncomplete":"Restore","rs_errorPersists":"If the problem persists, contact your system administrator.","rs_noActivities":"There are no activities started for this community.","rs_tagCloudNoTags":"No tags yet","rs_tagsLabel":"Tags","rs_moreInfo":"Show more information about this Activity","rs_forumSortByDate":"Date","rs_noTopicsLoggedIn":"Ask a question, brainstorm, or simply share your ideas.","rs_a11y_warning":"Warning:","rs_mobileBanner_hide":"Hide","rs_forumSortByTopic":"Topics","rs_messagebox_error_icon_alt":"Error","rs_mobileBanner_inAppStore":"On the App Store","rs_member_remove_name":"Click to remove member","rs_tunedOutPri":"Tuned Out","rs_completedActivityLink":"Show completed Activities","rs_forumSortBy":"Sort by:","rs_noTemplate":"None","rs_viewAsCloudDescription":"Viewing tags as a tag cloud","rs_group_browse_cancel_button":"Cancel","rs_group_browse_paging":"Paging","rs_tagCloudRelatedTags":"Related Tags","rs_relatedTagTitle":"Add the tag ${0} with count ${1}","rs_member_members":"Members","rs_postedBy":"Latest post by","rs_browser_setting":"Browser Setting","rs_group_browse_group_typeahead_label":"Type a group name:","rs_messagebox_success_a11y_label":"Success:","rs_viewAsListDescription":"Viewing tags as a sequential list of tags","rs_forumSettingSave":"Save","rs_PersonPicture":"${0}\'s Picture","rs_numResults":"Showing ${0} results of ${1}","rs_removeFilter":"Remove","rs_defaultForumList":"Show forum list by default","rs_normalTags":"Active Tags","rs_docpicker_viewdetails_title":"View details of ${0}","rs_messagebox_error_a11y_label":"Error:","rs_group_browse_next_page":"Next Page","rs_viewAsListTitle":"List tags as a sequential list of tags","rs_group_browse_page_info":"${0} - ${1} of ${2}","rs_vmtaNoResults":"No Results found.","rs_noResults":"No Results found","rs_close":"Close","rs_empty_column_placeholder":"Drag app(s) here.","rs_noTopics":"There are no topics yet for this community.","rs_feedError":"Failed to load feed.","rs_tagCloudError":"There was an error","rs_select_scope":"Select search scope","rs_restore":"Restore","rs_more":"More","rs_docpicker_title":"Insert Link to Files","rs_actTagsDelim":", ","rs_activitiesUnavailable":"The Activities service is unavailable.","rs_feedOpenQuestions":"Feed for these open questions","rs_icfixlayout":{"dialog_title":"Reformat Contents","reformat_save":"Reformat and Save","warn_layout":"Your content exceeds the maximum display width.  Do you want to reformat automatically to fit the available space?","save_as_is":"Save as Is","button_label":"Reformat","cancel":"Cancel","warning":"Warning","remember_decision":"Remember my decision"},"rs_startTopic":"Start a Topic","rs_tagCloudSeachDesc":"Find a Tag","rs_linkMore":"... [more]","rs_manageForumSetting":"Manage Forum Settings","rs_replace":"Replace","rs_templateOptions":"Template options","rs_locked":"[Locked]","rs_attachedfile_filename":"Image ${0}","rs_forumSettingSaveAndClose":"Save and Close","rs_forumSettingConfirm":"Your changes for Forums have been saved.","rs_forumSettingError":"An error occurred. Contact your administrator.","rs_tagCloudNoTagsProfiles":"Search the directory. Tags associated with the profiles returned by the search will be displayed here.","rs_shadowText_searchCommunityDirectory":"Type to find community","rs_group_browse_find_groups":"Find Groups","rs_moveActivitySuccess":"\"${activityTitle}\" was moved successfully to the \"${destCommName}\" subcommunity.","rs_sharefile_constraint_violation":"An error occurred while sharing the selected files.","rs_removeActFromComm":"Remove from community","rs_aboutThisTemplate":"About This Template","rs_forumLastAddedPost":"Latest post by ${0}","rs_tagCloudSelectedTags":"Selected Tags","rs_at":"at","rs_group_browse_results_label":"Select a matching group:","rs_group_role":"Group Role","rs_mobileBanner_open":"Open","rs_quote":"Quote","rs_userContentTitle":"Enter Information","rs_shadowText_searchGroupDirectory":"Type to find group","rs_sharefile_sharing_intent_restriction":"The file can only be shared inside your organization.","rs_navNextLabel":"Next","rs_messagebox_success_icon_alt":"Success","rs_sortByReplies":"Sort by Replies","rs_PersonPictureExternal":"${0}\'s Picture (External User)","rs_linkpicker_label":"Link to Box","rs_docpicker_label":"Link to Files","rs_actUpdatedBy":"Updated by ${0}","rs_tomorrow":"Tomorrow","rs_pickCommunity":"Pick from Community List","rs_group_browse_next":"Next","rs_activityWidgetDescription":"Community activities can be used to collaborate and track progress on community projects or initiatives.","rs_activity":"Activity","rs_tagCloudNoRecentTags":"No recent tags","rs_mobileBanner_view":"View","rs_startFirstActivity":"Create Your First Activity","rs_group_browse_group_name":"Group name:","rs_iframepicker_label":"Embed from Box","rs_defaultTopicList":"Show topic list by default","rs_reply":"reply","rs_vmtypeAheadRoleLabel":" as ","rs_feedAnsweredQuestions":"Feed for these answered questions","rs_sharefile_access_denied":"This file was deleted or is no longer shared with you.","rs_filterListPrompt":"Type to filter this list","rs_group_add_to_community":"Click to add group","rs_tagCloudViewAll":"Browse","rs_noReplies":"No replies","rs_filterGroupLabel":"Select Group","rs_widget_title_change_direction":"Change the title for this ${0} app.","rs_formSettingHideMessage":"Hide this message","rs_jumpPageLabel":"Jump to page","rs_group_browse_group_no_groups":"This group does not contain any groups","rs_searchInputDefault":"Type to find a tag","rs_warning":"Warning","rs_forumUnAnsweredQuestion":"Unanswered question","rs_messagebox_warning_icon_alt":"Warning","rs_forumAnsweredQuestion":"Answered question","rs_searchDirectory":"Person not listed? Use full search...","rs_group_browse_add_button":"Add","rs_personExternalDesc":"This user has access to Files and Communities that are externally shared.","rs_searchInputTagSelected":"Type another tag","rs_widget_title_change_fail_message":{"default_message":"Unable to change title for this ${0} app.","title_too_long":"The title you entered is too long.","empty_new_title":"The title you entered cannot be empty."},"rs_viewAsList":"List","rs_tagDialogTitle":"All Tags","rs_noTopicsShort":"No topics","rs_member_no_results":"No results found","rs_actDue":"Due ${0}","rs_normalPri":"Normal Priority (Default)","rs_today":"Today","rs_sortbyTopicsAndReplies":"Sort by Topics and Replies","rs_actTags":"Tags: ","rs_group_browse_previous":"Previous","rs_vmtaHeader":"header","rs_forumSortByReplies":"Replies","rs_group_browse_page_info_alt":"Matching groups ${0} through ${1} of ${2}","rs_tagCloudToggleHint":"Click to hide or show","rs_copyActivityMembers":"Use members from activity","rs_navPrevLabel":"Previous","rs_vmback":"Back","rs_copyOf":"Copy of ${0}","rs_attachedfile_remove_alt":"Remove","rs_group_browse_group_selected":"Selected Group:","rs_group_browse_groups_dialog_title":"Browse Groups","rs_removeTag":"Remove the tag from the selected filter tags","rs_pageNumLabel":"Page Number","rs_feedreader_warning":"Warning: This link is meant for feed readers and may display incorrectly in your browser. Click OK to continue, or Cancel to return to page."};

;if(!dojo._hasResource["lconn.core.Res"]){
dojo._hasResource["lconn.core.Res"]=true;
dojo.provide("lconn.core.Res");




dojo.requireLocalization("lconn.core","strings");
dojo.declare("lconn.core.Res",[],{bundleFor:"lconn.core",resBundle:null,loadDefaultBundle:function(){
this.resBundle=dojo.i18n.getLocalization(this.bundleFor,"strings");
},loadBundle:function(_1){
this.resBundle=dojo.i18n.getLocalization(_1,"strings");
},getDefaultBundle:function(){
return dojo.i18n.getLocalization(this.bundleFor,"strings");
},getBundle:function(_2){
return dojo.i18n.getLocalization(_2,"strings");
},getStringFrom:function(_3,_4,_5){
var _6=dojo.i18n.getLocalization(_3,"strings")[_4];
if(_5==undefined){
return _6;
}else{
return dojo.string.substitute(_6,_5);
}
},getString:function(_7,_8){
var _9=dojo.i18n.getLocalization(this.bundleFor,"strings")[_7];
if(_8==undefined){
return _9;
}else{
return dojo.string.substitute(_9,_8);
}
}});
}


;if(!dojo._hasResource["com.ibm.oneui.util.Url"]){
dojo._hasResource["com.ibm.oneui.util.Url"]=true;
(function(){
dojo.provide("com.ibm.oneui.util.Url");
dojo.declare("com.ibm.oneui.util.Url",dojo._Url,{getQuery:function(){
if(!this.queryParameters){
this.queryParameters=_1(this.query);
}
return this.queryParameters;
},getQueryString:function(){
var _2=this.queryParameters;
if(_2){
this.query=_3(_2);
this.queryParameters=null;
}
return this.query;
},toString:function(){
var _4=[];
if(this.scheme){
_4.push(this.scheme);
_4.push(":");
}
if(this.authority){
_4.push("//");
_4.push(this.authority);
}
_4.push(this.path);
var _5=this.getQueryString();
if(_5){
if(_5.charAt(0)!="?"){
_4.push("?");
}
_4.push(_5);
}
if(this.fragment){
_4.push("#");
_4.push(this.fragment);
}
return _4.join("");
}});
function _1(_6){
var _7={};
if(!_6){
return _7;
}
if(_6.charAt(0)=="?"){
_6=_6.substring(1);
}
var _8=_6.split("&");
for(var i=0;i<_8.length;i++){
if(_8[i].length>0){
var _9=_8[i].indexOf("=");
if(_9==-1){
var _a=decodeURIComponent(_8[i]);
var _b=_7[_a];
if(dojo.isArray(_b)){
_b.push("");
}else{
if(_b){
_7[_a]=[_b,""];
}else{
_7[_a]="";
}
}
}else{
if(_9>0){
var _a=decodeURIComponent(_8[i].substring(0,_9));
var _c=decodeURIComponent(_8[i].substring(_9+1));
var _b=_7[_a];
if(dojo.isArray(_b)){
_b.push(_c);
}else{
if(_b){
_7[_a]=[_b,_c];
}else{
_7[_a]=_c;
}
}
}
}
}
}
return _7;
};
function _3(_d){
var _e=[];
for(var _f in _d){
var _10=_d[_f];
if(_10!==undefined&&_10!=null){
_f=encodeURIComponent(_f);
if(dojo.isArray(_10)){
for(var i=0;i<_10.length;i++){
if(_10[i]){
_e.push(_e.length==0?"?":"&");
_e.push(_f);
_e.push("=");
_e.push(encodeURIComponent(_10[i]));
}
}
}else{
_e.push(_e.length==0?"?":"&");
_e.push(_f);
_e.push("=");
_e.push(encodeURIComponent(_10));
}
}
}
return _e.join("");
};
com.ibm.oneui.util.Url.secure=((window.location.protocol||"http").replace(":","")=="https");
})();
}


;if(!dojo._hasResource["lconn.core.url"]){
dojo._hasResource["lconn.core.url"]=true;
dojo.provide("lconn.core.url");
dojo.provide("lconn.core.url.ProxyUrlHelper");




lconn.core.url.parse=function(_1,_2){
var l=arguments.length,u=null;
if(!_1){
return null;
}else{
if((typeof _1!="string"&&console.trace)||(_2&&typeof _2!="string"&&console.trace)){
throw "Arguments for URI must be a string";
}
}
_1=new dojo._Url(_1,_2);
_1.queryParameters=lconn.core.url.getRequestParameters(_1);
return _1;
};
lconn.core.url.write=function(_3){
if(!_3){
return null;
}
var _4="";
if(_3.scheme){
_4+=_3.scheme+":";
}
if(_3.authority){
_4+="//"+_3.authority;
}
_4+=_3.path;
if(_3.queryParameters){
_4+=lconn.core.url.writeParameters(_3.queryParameters);
}else{
if(_3.query){
_4+=((_3.query.charAt(0)!="?")?"?":"")+_3.query;
}
}
if(_3.fragment){
_4+="#"+_3.fragment;
}
return _4;
};
dojo._Url.prototype.toCanonicalString=function(){
return lconn.core.url.write(this);
};
lconn.core.url.rewrite=function(_5,p){
if(_5&&p){
_5=lconn.core.url.parse(_5);
dojo.mixin(_5.queryParameters,p);
_5=lconn.core.url.write(_5);
}
return _5;
};
lconn.core.url.splitQuery=function(_6){
var _7={};
if(!_6){
return _7;
}
if(_6.charAt(0)=="?"){
_6=_6.substring(1);
}
var _8=_6.split("&");
for(var i=0;i<_8.length;i++){
if(_8[i].length>0){
var _9=_8[i].indexOf("=");
if(_9==-1){
var _a=decodeURIComponent(_8[i]);
var _b=_7[_a];
if(dojo.isArray(_b)){
_b.push("");
}else{
if(_b){
_7[_a]=[_b,""];
}else{
_7[_a]="";
}
}
}else{
if(_9>0){
var _a=decodeURIComponent(_8[i].substring(0,_9));
var _c=decodeURIComponent(_8[i].substring(_9+1));
var _b=_7[_a];
if(dojo.isArray(_b)){
_b.push(_c);
}else{
if(_b){
_7[_a]=[_b,_c];
}else{
_7[_a]=_c;
}
}
}
}
}
}
return _7;
};
lconn.core.url.getRequestParameters=function(_d){
if(!_d){
return {};
}
if(typeof _d=="string"){
_d=new dojo._Url(_d);
}
return lconn.core.url.splitQuery(_d.query);
};
lconn.core.url.writeParameters=function(_e){
var _f=[];
for(var key in _e){
var _10=_e[key];
if(typeof _10!="undefined"&&_10!=null){
key=encodeURIComponent(key);
if(dojo.isArray(_10)){
for(var i=0;i<_10.length;i++){
if(_10[i]){
_f.push(_f.length==0?"?":"&");
_f.push(key);
_f.push("=");
_f.push(encodeURIComponent(_10[i]));
}
}
}else{
_f.push(_f.length==0?"?":"&");
_f.push(key);
_f.push("=");
_f.push(encodeURIComponent(_10));
}
}
}
return _f.join("");
};
lconn.core.url.getServiceUrl=function(_11,_12){
var _13=com.ibm.oneui.util.Url,_14=null;
if(!_11){
return null;
}else{
if(_13.secure||_12){
if(_11.secureEnabled&&_11.secureUrl){
_14=_11.secureUrl;
}else{
if(_11.url){
_14=_11.url;
}else{
return null;
}
}
}else{
if(_11.url){
_14=_11.url;
}else{
if(_11.secureEnabled&&_11.secureUrl){
_14=_11.secureUrl;
}else{
return null;
}
}
}
}
if(_14&&window.location.href&&window.location.href.indexOf("/org/")>0){
var _15=null;
var _16=null;
var _17=window.location.href;
if(_17.indexOf("://")>-1){
_16="/org/"+_17.split("/")[4];
}else{
_16="/org/"+_17.split("/")[2];
}
if(_14.indexOf("://")>-1){
domain=_14.split("/")[2];
}else{
domain=_14.split("/")[0];
}
_14=_14.replace(domain,domain+_16);
}
return new _13(_14);
};
lconn.core.url.ensureQualified=function(_18){
if(!_18){
throw "Null URL is not permitted";
}
return new dojo._Url(dojo.global.location.toString(),_18).toString();
};
lconn.core.url.ProxyUrlHelper=function(_19){
dojo.deprecated("lconn.core.url.ProxyUrlHelper","Will be removed","6.0");
this.proxyUrl=_19;
};
lconn.core.url.ProxyUrlHelper.prototype={getProxifiedURL:function(url){
dojo.deprecated("lconn.core.url.ProxyUrlHelper.getProxifiedURL(url)","Use com.ibm.oneui.util.proxy(url, proxyUrl?) instead","6.0");
return com.ibm.oneui.util.proxy(url,this.proxyUrl);
}};
lconn.core.url.canonicalize=function(url,_1a){
var _1b=lconn.core.url.parse(url);
var _1c=_1a||ibmConfig.serviceName;
switch(_1c){
case "wikis":
if(_1b.fragment&&_1b.fragment.indexOf("!")===0){
_1b.fragment=_1b.fragment.substr(1);
}
case "files":
if(_1b.fragment){
_1b.path+=_1b.fragment;
delete _1b.fragment;
}
break;
}
return _1b.toCanonicalString();
};
}


;if(!dojo._hasResource["lconn.core.LanguageSelector"]){
dojo._hasResource["lconn.core.LanguageSelector"]=true;
(function(){
dojo.provide("lconn.core.LanguageSelector");












var _1="BD";
function _2(_3){
var _4=0;
for(var _5 in _3){
if(_3.hasOwnProperty(_5)){
switch(_5){
case _1:
break;
default:
_4++;
}
}
}
return _4>1;
};
dojo.declare("lconn.core.LanguageSelector",null,{_jsonString:null,_selectorNode:null,_menu:null,_cookieProperties:null,COOKIE_NAME:null,constructor:function(_6,_7,_8,_9){
this._selectorNode=_6;
this._jsonString=_7;
this._cookieProperties=_9;
this.id=this._selectorNode.id;
this.COOKIE_NAME=lconn.core.LanguageSelector.COOKIE_NAME=_8;
if(_2(_7)){
this._setSelectorLabel();
dojo.connect(this._selectorNode,"onclick",dojo.hitch(this,"_openMenu"));
}
},_openMenu:function(_a){
try{
this._buildLanguageMenu();
this._attachLanguageMenu(this.id);
menuUtility.openMenu(null,this._menu.id,this._selectorNode);
dojo.stopEvent(_a);
}
catch(e){
console.log(e);
}
},_setSelectorLabel:function(){
var _b=dojo.cookie(this.COOKIE_NAME);
var _c=new lconn.core.Res();
_c.loadDefaultBundle();
this.strBundle=_c.resBundle;
var _d=" <img alt=\"\" role=\"presentation\" src=\""+dijit._Widget.prototype._blankGif+"\"  class=\"lotusArrow lotusDropDownSprite\"><span class=\"lotusAltText\">&#9660;</span>";
var _e="<span class=\"lotusAccess\">Language Selector</span>";
if(_b){
var _f=0;
var _10=this.strBundle.rs_customLangaugeLinkLabel+_e+_d;
for(var key in this._jsonString){
if(this._isCodeEqual(key,_b)){
_10=this._jsonString[key]+_e+_d;
break;
}else{
if(this._isCodeEqualOrMoreSpecific(key,_b)&&key.length>_f){
_10=this._jsonString[key]+_e+_d;
_f=key.length;
}
}
}
this._selectorNode.innerHTML=_10;
}else{
this._selectorNode.innerHTML=this.strBundle.rs_customLangaugeLinkLabel+_e+_d;
}
},_attachLanguageMenu:function(id){
var _11=dojo.byId(id);
dijit.setWaiState(_11,"owns",id+"_popup");
},_buildLanguageMenu:function(){
if(this._menu==null){
var _12=true;
this._menu=new dijit.Menu({"class":"lotusNavMenu",id:this.id+"_popup"});
for(var key in this._jsonString){
if(key!=_1){
this._menu.addChild(this._buildMenuItem(this._jsonString[key],key));
}else{
_12=false;
}
}
var res=new lconn.core.Res();
res.loadDefaultBundle();
this.strBundle=res.resBundle;
if(_12){
this._menu.addChild(this._buildMenuItem(this.strBundle.rs_browser_setting,_1));
}
this._menu.domNode.style.display="none";
dojo.body().appendChild(this._menu.domNode);
var _13=this;
dojo.connect(this._menu,"onItemClick",function(_14){
if((_14!=null)&&(typeof _14.language!="undefined")){
dojo.cookie(_13.COOKIE_NAME,_14.language,_13._cookieProperties);
var _15=null;
var _16=document.getElementById("REFRESH_URL");
if(_16){
_15=_16.getAttribute("href");
}
if(!_15){
_15=window.location.href;
}
var _17=_14.language;
if(_17==_1||!_17){
_17=null;
}
var url=lconn.core.url.parse(_15);
if(_17==null&&url.queryParameters.lang==null){
window.location.reload(true);
}else{
window.location=lconn.core.url.rewrite(_15,{lang:_17});
}
}
});
}
},_buildMenuItem:function(_18,_19){
var _1a=new dijit.MenuItem({label:_18,iconClass:"lotusHidden"});
_1a.attr("lang",_19);
_1a.language=_19;
return _1a;
},_isCodeEqualOrMoreSpecific:function(_1b,_1c){
var _1d=_1b.toLowerCase().replace(/-/,"_");
var _1e=_1c.toLowerCase().replace(/-/,"_");
if(_1d==_1e){
return true;
}
var _1f=_1d.length>0&&_1e.indexOf(_1d+"_")==0;
if(_1f){
var _20={zh:"zh_tw",pt:"pt_br"};
if(_20[_1d]==_1e){
return false;
}else{
return true;
}
}
return false;
},_isCodeEqual:function(_21,_22){
var _23=_21.toLowerCase().replace(/-/,"_");
var _24=_22.toLowerCase().replace(/-/,"_");
return _23===_24;
}});
})();
}


;dojo.mixin(dojo.provide("lconn.core.config.properties"),{"CORS.Trusted.Websites":"na.collabserv.com","DeploymentModel":"SmartCloud","LotusLive":"true","ccmMediaView":"enabled","com.ibm.connections.ecm.OAuthEnabled":"enabled","com.ibm.connections.set.cookies.httpOnly":"true","com.ibm.docs.types.edit":"xlsm","com.ibm.docs.types.view":"dot,dotx,ott,pot,potx,otp,xlt,xltx,ots","com.ibm.lconn.communities.catalog.enabled":"true","com.ibm.lconn.communities.includePublicRole":"true","com.ibm.lconn.core.web.styles.theme.default":"none","com.ibm.lconn.files.api.throttler.filesync":"50","com.ibm.lconn.files.platform.throttler.rendition":"4","com.ibm.lconn.homepage.noCustomize":"true","com.ibm.lconn.oauth.ui.enabled":"false","com.ibm.lconn.personcard.enable":"off","com.ibm.social.as.noNetwork":"true","filesMediaView":"enabled","ic.profiles.cloud.deployed":"true","lconn.core.WidgetPlacement.communities.freeLayout":"false","lconn.core.WidgetPlacement.communities.limitedDND":"true","lconn.core.WidgetPlacement.communities.useCRE":"true","lconn.core.WidgetPlacement.profiles.useCRE":"true","people.typeahead":"enabled","quickResultsEnabled":"true","shindig.config.container.overrides":"{\"gadgets.sso\" : {\"cookieDomain\" : \"apps.na.collabserv.com\",\"cookieNames\" : \"LtpaToken,LtpaToken2\",\"samlSpDomain\" : \"mail.notes.collabservdaily.swg.usma.ibm.com\", \"spnegoDomain\" : null, \"samlIdpCookieNames\" : \"LtpaToken,LtpaToken2,iwaSSL,iwaSSL2,Shimmer,BSSUISESSIONID,token,user_dc,user_lang,LLN2Failover,LLN2Cookie,BIGipServerDailyA-BSSUI-9080-fe,BIGipServerDailyA-WebSEAL-80-fe,BIGipServerDailyB-BSSUI-9080-fe,BIGipServerDailyB-WebSEAL-80-fe,BIGipServerSpimDev1-WebSEAL-80-fe,BIGipServerSpimDev1-BSSUI-9080-fe,PD-ID,PD-H-SESSION-ID\", \"samlIdpHeaderNames\" : \"iv-creds,iv-groups,iv-user,referer,user-agent,via,iv-user-l,ldap_personid,ldap_subscriberid,iv_server_name,ldap_orgname,app_password,ldap_customerid,ldap_orgid,eai_auth,bypass_ip_check,ldap_extid,x-shindig-st,ldap_username,pragma,cache-control,x-forwarded-for,Cookie,X-Forwarded-Host,X-Forwarded-Server,Connection\", \"samlIdpInitialURL\" : \"https://apps.collabservdaily.swg.usma.ibm.com/sps/idp/saml11/login\", \"replaceSamlIdpURL\" : true},\"iwidget.sso\" : {\"handlers\" : \"com.ibm.cre.gadgets.sso.SAMLSSOHANDLER\"}}","shindig.properties.override.shindig.bean.converter.atom-class":"com.ibm.lotus.shindig.social.core.util.legacy.BeanXStreamAtomConverter","shindig.properties.override.shindig.bean.converter.json-class":"com.ibm.lotus.shindig.protocol.conversion.legacy.BeanJsonConverter","shindig.properties.override.shindig.bean.converter.xml-class":"com.ibm.lotus.shindig.protocol.conversion.legacy.BeanXStreamConverter","shindig.properties.override.shindig.cache.cacheTTLwithoutVersion":"2592000","shindig.properties.override.shindig.content-rewrite.include-tags":"body,embed,input,link,script,style","shindig.properties.override.shindig.xstream081.configuration-class":"com.ibm.lotus.shindig.social.core.util.xstream.legacy.XStream081Configuration","visitorModelEnabled":"false"});


;if(!dojo._hasResource["lconn.core.globalization.config"]){
dojo._hasResource["lconn.core.globalization.config"]=true;
(function(){
dojo.provide("lconn.core.globalization.config");


var _1={DEFAULT:"default",LEFT_TO_RIGHT:"ltr",RIGHT_TO_LEFT:"rtl",CONTEXTUAL:"contextual"},_2={GREGORIAN:"gregorian",HEBREW:"hebrew",HIJRI:"hijri"},_3={BIDI_ENABLED:"bidiEnabled",TEXT_DIRECTION:"textDirection",CALENDAR:"calendar"},_4={};
_4[_3.BIDI_ENABLED]=false;
_4[_3.TEXT_DIRECTION]=_1.DEFAULT;
_4[_3.CALENDAR]=_2.GREGORIAN;
dojo.mixin(lconn.core.globalization.config,{SETTINGS_ENABLED_PROPERTY_NAME:"com.ibm.lconn.core.web.globalization.settings.enabled",TEXT_DIRECTION:_1,CALENDAR:_2,SETTINGS:_3,areSettingsEnabled:function(){
return lconn.core.config.properties[this.SETTINGS_ENABLED_PROPERTY_NAME]!==false;
},languageEnabled:false,defaults:_4});
})();
}


;define("dojo/DeferredList",["./_base/kernel","./_base/Deferred","./_base/array"],function(_1,_2,_3){
_1.DeferredList=function(_4,_5,_6,_7,_8){
var _9=[];
_2.call(this);
var _a=this;
if(_4.length===0&&!_5){
this.resolve([0,[]]);
}
var _b=0;
_3.forEach(_4,function(_c,i){
_c.then(function(_d){
if(_5){
_a.resolve([i,_d]);
}else{
_e(true,_d);
}
},function(_f){
if(_6){
_a.reject(_f);
}else{
_e(false,_f);
}
if(_7){
return null;
}
throw _f;
});
function _e(_10,_11){
_9[i]=[_10,_11];
_b++;
if(_b===_4.length){
_a.resolve(_9);
}
};
});
};
_1.DeferredList.prototype=new _2();
_1.DeferredList.prototype.gatherResults=function(_12){
var d=new _1.DeferredList(_12,false,true,false);
d.addCallback(function(_13){
var ret=[];
_3.forEach(_13,function(_14){
ret.push(_14[1]);
});
return ret;
});
return d;
};
return _1.DeferredList;
});


;dojo.mixin(dojo.provide("lconn.core.config.services"),{"activities":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/activities","url":"https://apps.na.collabserv.com/activities"},"blogs":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/blogs","url":"https://apps.na.collabserv.com/blogs"},"bookmarklet":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/bookmarklet","url":"https://apps.na.collabserv.com/connections/bookmarklet"},"bss":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/manage","url":"https://apps.na.collabserv.com/manage"},"communities":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/communities","url":"https://apps.na.collabserv.com/communities"},"deploymentConfig":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections","url":"https://apps.na.collabserv.com/connections"},"eventTracker":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/search","url":"https://apps.na.collabserv.com/search"},"extensionRegistry":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/appregistry","url":"https://apps.na.collabserv.com/appregistry"},"files":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/files","url":"https://apps.na.collabserv.com/files"},"files-wopi":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/wopi","url":"https://apps.na.collabserv.com/wopi"},"forums":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/forums","url":"https://apps.na.collabserv.com/forums"},"help":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/help","url":"https://apps.na.collabserv.com/help"},"homepage":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/homepage","url":"https://apps.na.collabserv.com/homepage"},"mediaGallery":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/news/widgets/lw","url":"https://apps.na.collabserv.com/news/widgets/lw"},"metrics":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/metricssc","url":"https://apps.na.collabserv.com/metricssc"},"microblogging":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/opensocial","url":"https://apps.na.collabserv.com/connections/opensocial"},"mobile":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/mobile","url":"https://apps.na.collabserv.com/mobile"},"news":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/news","url":"https://apps.na.collabserv.com/news"},"oauth":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/oauth","url":"https://apps.na.collabserv.com/connections/oauth"},"oauthprovider":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/oauth2","url":"https://apps.na.collabserv.com/oauth2"},"opengraph":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/opengraph","url":"https://apps.na.collabserv.com/connections/opengraph"},"opensocial":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/opensocial","url":"https://apps.na.collabserv.com/connections/opensocial"},"pushnotification":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/push","url":"https://apps.na.collabserv.com/push"},"rte":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/rte","url":"https://apps.na.collabserv.com/connections/rte"},"sand":{"enabled":true,"secureEnabled":true},"scprofiles":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/contacts/profiles","url":"https://apps.na.collabserv.com/contacts/profiles"},"search":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/search","url":"https://apps.na.collabserv.com/search"},"thumbnail":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/thumbnail","url":"https://apps.na.collabserv.com/connections/thumbnail"},"webresources":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/resources","url":"https://apps.na.collabserv.com/connections/resources"},"wikis":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/wikis","url":"https://apps.na.collabserv.com/wikis"}});
if(dojo.exists("filterByEnabledServices")){
lconn.core.config.services=filterByEnabledServices(lconn.core.config.services);
}


;if(!dojo._hasResource["lconn.core.auth"]){
dojo._hasResource["lconn.core.auth"]=true;
dojo.provide("lconn.core.auth");












(function(_1,_2){
var _3=dojo.getObject("ibmConfig.serviceName");
var _4=5000,_5=[],_6=[],_7={defaultApp:"${appSvcUrl}/core/login_redirect?redirect=${redirectUrl}",activities:"${appSvcUrl}/service/authredirect.jsp",blogs:"${appSvcUrl}/roller-ui/login-redirect.jsp?redirect=${redirectUrl}",communities:"${appSvcUrl}/service/html/login",dogear:"${appSvcUrl}/loginredirect?redirect=${redirectUrl}",files:"${appSvcUrl}/form/login_redirect?redirect=${redirectUrl}",forums:"${appSvcUrl}/auth/redirect",homepage:"${appSvcUrl}/web/login_redirect?redirectUrl=${redirectUrl}",metrics:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}",moderation:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}",news:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}",oauth:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}",profiles:"${appSvcUrl}/auth/loginRedirect.do",search:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}",wikis:"${appSvcUrl}/form/login_redirect?redirect=${redirectUrl}",webresources:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}"},_8=null,_9=null,_a=null;
function _b(_c,_d){
switch(_c){
case "activities":
_e("ActivitiesRedirect",_d.redirectUrl);
break;
case "communities":
_e("CommunitiesReqURL",_d.redirectUrl);
break;
case "forums":
_e("ForumReqURL",_d.redirectUrl);
break;
case "homepage":
_e("ConnectionsHomepageActivityStreamState",_d.redirectUrl);
break;
case "profiles":
_e("ProfilesReqURL",_d.redirectUrl);
break;
}
};
function _f(){
var _10=[];
if(!lconn.core.auth.isAuthenticated()){
dojo.forEach(_5,function(_11,i){
var dfd=_11();
if(dfd&&dfd instanceof dojo.Deferred){
_10.push(dfd);
}
});
}
return _10;
};
function _12(_13){
var _14=[];
if(_13||lconn.core.auth.isAuthenticated()){
dojo.forEach(_6,function(_15,i){
var dfd=_15();
if(dfd&&dfd instanceof dojo.Deferred){
_14.push(dfd);
}
});
}
return _14;
};
function _e(key,_16){
_2.cookie=key+"="+_16+"; path=/";
};
function _17(){
if(_3){
return _3;
}
var _18=dojo.byId("lotusBaseStylesheet");
if(_18){
var _19=dojo.attr(_18,"appName");
if(_19){
return _19;
}
}
return "news";
};
function _1a(_1b){
var _1c=_1.location.href;
var _1d=_17();
var _1e=lconn.core.config.services[_1d];
if(_1e){
_1c=(_1e.secureEnabled&&_1b!==false)?_1e.secureUrl:_1e.url;
}
var _1f=lconn.core.url.parse(_1c);
return _1f.toString();
};
function _20(){
var _21=null,_22=dojo.byId("userInfo");
if(_22){
_21=dojo.fromJson(_22.innerText);
}
return _21;
};
lconn.core.auth={addLoginHandler:function(_23){
_5.push(_23);
},addLogoutHandler:function(_24){
_6.push(_24);
},login:function(url){
var _25=new dojo.DeferredList(_f(),false);
var _26=url||lconn.core.auth.getLoginUrl();
_25.addBoth(function(_27){
_1.location.href=_26;
});
},logoutAndLogin:function(url){
_12(true);
var _28=lconn.core.auth.getLogoutUrl();
dojo.xhrPost({url:_28,handleAs:"text",handle:function(){
lconn.core.auth.login(url);
},secure:false,timeout:_4});
},logout:function(url){
var _29=new dojo.DeferredList(_12(),false);
var _2a=url||lconn.core.auth.getLogoutUrl("/");
_29.addBoth(function(_2b){
_1.location.href=_2a;
});
},getUser:function(_2c){
if(!this.isAuthenticated()){
return null;
}
_2c=_2c||_3;
if(!_a||dojo.config.isDebug){
_a=null;
switch(_2c){
case "activities":
if(dojo.exists("_oa_current_user")){
_a={displayName:_oa_current_user.name,id:_oa_current_user.userid,email:_oa_current_user.email,isExternal:_oa_current_user.isExternal,_native:_oa_current_user};
}
break;
case "blogs":
case "dogear":
if(dojo.exists("currentLogin")){
_a={displayName:currentLogin.name,id:currentLogin.extid,email:currentLogin.email,isExternal:currentLogin.isExternal,_native:currentLogin};
}
break;
case "communities":
var _2d;
if(dojo.exists("communityActionData")){
_2d=communityActionData;
}else{
if(dojo.exists("lconn.communities.bizCard.core.community")){
_2d=lconn.communities.bizCard.core.community;
}
}
if(_2d){
_a={displayName:_2d.userName,id:_2d.userUuid,email:_2d.userEmail,isExternal:_2d.userIsExternal,_native:_2d};
}else{
if(dojo.exists("lconnCurrentUser")){
_a=dojo.clone(lconnCurrentUser);
_a._native=lconnCurrentUser;
}
}
break;
case "forums":
if(dojo.exists("forumsUser")){
_a={displayName:forumsUser};
}
if(dojo.exists("forumsUserId")){
_a=_a||{};
_a.id=forumsUserId;
}
if(dojo.exists("forumsUserExternal")){
_a=_a||{};
_a.isExternal=forumsUserExternal==1;
}
break;
case "homepage":
case "news":
if(dojo.exists("lconn.homepage.userName")){
_a={displayName:lconn.homepage.userName};
}
if(dojo.exists("lconn.homepage.userEmail")){
_a=_a||{};
_a.email=lconn.homepage.userEmail;
}
if(dojo.exists("lconn.homepage.userExtId")){
_a=_a||{};
_a.id=lconn.homepage.userExtId;
}
if(dojo.exists("lconn.homepage.userIsExternal")){
_a=_a||{};
_a.isExternal=lconn.homepage.userIsExternal;
}
break;
case "profiles":
if(dojo.exists("profilesData.loggedInUser")){
_a={displayName:profilesData.loggedInUser.displayName,id:profilesData.loggedInUser.userid,email:profilesData.loggedInUser.email,isExternal:profilesData.loggedInUser.isExternal,_native:profilesData.loggedInUser};
}
break;
case "files":
case "wikis":
case "metrics":
case "moderation":
if(dojo.exists("pe.authenticatedUser")){
_a={displayName:pe.authenticatedUser.name,id:pe.authenticatedUser.id,email:pe.authenticatedUser.email,isExternal:pe.authenticatedUser.isExternal,_native:pe.authenticatedUser};
}else{
var _2e=_20();
if(_2e){
_a={displayName:_2e.name,email:_2e.email,id:_2e.id,isExternal:_2e.isExternal,_native:_2e};
}
}
break;
case "search":
if(dojo.exists("lconnCurrentUser")){
_a=dojo.clone(lconnCurrentUser);
_a._native=lconnCurrentUser;
}
break;
default:
if(dojo.exists("currentViewer")){
_a={displayName:currentViewer.displayName,id:currentViewer.id&&currentViewer.id.substring(currentViewer.id.lastIndexOf(":")+1),email:(dojo.filter(currentViewer.emails,function(e){
return e.primary;
})[0]||{}).value,isExternal:dojo.getObject("appData.connections.isExternal",false,currentViewer)==="true",orgId:dojo.getObject("appData.connections.organizationId",false,currentViewer)};
_a._native=currentViewer;
}else{
if(dojo.exists("icUser")){
_a=dojo.clone(icUser);
_a._native=icUser;
}
}
}
}
return _a;
},isAuthenticated:function(){
if(dojo.isFunction(_8)){
return _8();
}
if(_9===null){
switch(_3){
case "files":
case "wikis":
_9=dojo.getObject("pe.authenticatedUser");
if(!_9){
_9=_20()!==null;
}
if(_9){
break;
}
default:
var _2f=dojo.query("#headerUserName img")[0];
var _30=_2f&&_2f.alt!=="";
if(_30===undefined){
_9=null;
}else{
_9=_30;
}
}
}
return _9;
},setAuthCheck:function(cb){
if(dojo.isFunction(cb)){
_8=cb;
}
},getLogoutUrl:function(_31){
var _32=_1a(com.ibm.oneui.util.Url.secure);
var _33=_31||"/";
_32=_32+"/ibm_security_logout?logoutExitPage="+encodeURIComponent(_33);
return _32;
},getLoginUrl:function(url){
url=url||_1.location.href;
var _34=_17("default");
var u=lconn.core.url.parse(url);
if(u.fragment){
switch(_34){
case "activities":
u.fragment=u.fragment.replace(/,/g,"%2C");
break;
case "files":
case "metrics":
case "moderation":
case "wikis":
u.path+=u.fragment.indexOf("!")===0?u.fragment.substring(1):u.fragment;
delete u.fragment;
}
}
var _35=lconn.core.config.services[_34].secureUrl;
if(_35.charAt(_35.length-1)=="/"){
_35=_35.substring(0,_35.length-1);
}
var opt={appSvcUrl:_35,redirectUrl:u.toCanonicalString(),hashSegment:u.fragment||""};
_b(_34,opt);
opt.redirectUrl=encodeURIComponent(opt.redirectUrl);
return dojo.string.substitute(_7[_34],opt);
}};
lconn.core.auth.logoutAndlogin=lconn.core.auth.logoutAndLogin;
}(window,document));
}


;if(!dojo._hasResource["lconn.core.util.PreferenceCache"]){
dojo._hasResource["lconn.core.util.PreferenceCache"]=true;
(function(_1,_2){
var _3=dojo.provide("lconn.core.util.PreferenceCache");
var _4="icprefs",_5=false;
try{
_1.localStorage;
}
catch(e){
console.warn("Unable to access localStorage: "+e);
_5=true;
}
function _6(){
return dojo.fromJson(localStorage.getItem(_4))||{};
};
function _7(_8){
localStorage.setItem(_4,dojo.toJson(_8));
};
function _9(){
localStorage.removeItem(_4);
};
dojo.mixin(_3,{set:function(_a,_b){
if(_5){
return;
}
var o={};
o[_a]=_b;
_7(dojo.mixin(_6(),o));
},unset:function(_c){
if(_5){
return;
}
var p=_6();
delete p[_c];
_7(p);
},get:function(_d){
return _5?undefined:_6()[_d];
},clear:function(){
if(_5){
return;
}
_9();
}});
}(window,document));
}


;if(!dojo._hasResource["lconn.core.globalization.api"]){
dojo._hasResource["lconn.core.globalization.api"]=true;
(function(){
dojo.provide("lconn.core.globalization.api");












var _1=lconn.core.globalization.config,_2=lconn.core.util.PreferenceCache;
if(_1.areSettingsEnabled()){
var _3="globalization",_4=false;
function _5(_6,_7){
if(_6){
switch(_6.status){
case 500:
case 404:
dojo.publish("lconn/core/preferences/unavailable");
_4=true;
}
}
};
function _8(){
if(!lconn.core.auth.isAuthenticated()){
return {};
}
var _9=_a();
if(!_9&&!_4){
dojo.xhrGet({url:_b(),failOk:true,handleAs:"json",sync:true,handle:function(r,i){
if(r instanceof Error){
_5(r,i);
return;
}
_9=_c(r);
_d(r,i);
}});
}
return _9||{};
};
function _b(){
var _e=lconn.core.url.getServiceUrl(lconn.core.config.services.opensocial).toString()+"/rest/people/@me/@self?fields=userSettings.textDirection&fields=userSettings.bidiEnabled&fields=userSettings.calendar";
return com.ibm.oneui.util.proxy(_e);
};
function _f(){
_10();
if(!lconn.core.auth.isAuthenticated()){
return;
}
if(_a()){
return;
}
if(!_4){
dojo.xhrGet({url:_b(),handleAs:"json",timeout:3000}).addCallback(_d).addErrback(_5);
}
};
function _11(){
if(arguments[1]){
_12(arguments[1]);
}else{
_13();
}
};
var MAP={CTX:"contextual",DEF:"default",LTR:"ltr",RTL:"rtl",HEB:"hebrew",HIJ:"hijri",GRE:"gregorian","true":true,"false":false};
function map(_14){
var to={};
for(var _15 in _14){
if(_14.hasOwnProperty(_15)){
to[_15]=typeof MAP[_14[_15]]!=="undefined"?MAP[_14[_15]]:_14[_15];
}
}
return to;
};
function _c(_16){
return (_16&&_16.entry&&_16.entry.appData)?map(_16.entry.appData.userSettings):null;
};
function _a(){
return _2.get(_3);
};
function _12(_17){
if(!_17){
console.debug("Trying to store invalid preference:",_17);
return;
}
_2.set(_3,_17);
};
function _d(_18,_19){
_12(_c(_18));
};
var _1a=false;
function _10(){
if(!_1a){
dojo.subscribe("lconn/core/globalization/saved",_11);
dojo.subscribe("lconn/core/globalization/restored",_11);
lconn.core.auth.addLogoutHandler(_13);
lconn.core.auth.addLoginHandler(_13);
_1a=true;
}
};
function _13(){
_2.unset(_3);
};
function _1b(_1c){
var ret=_8()[_1c];
return typeof ret!=="undefined"?ret:_1.defaults[_1c];
};
dojo.mixin(lconn.core.globalization.api,{isBidiEnabled:function(){
return _1b(_1.SETTINGS.BIDI_ENABLED);
},getCalendar:function(){
return _1b(_1.SETTINGS.CALENDAR);
},getTextDirection:function(){
return _1b(_1.SETTINGS.TEXT_DIRECTION);
}});
dojo.addOnLoad(function(){
setTimeout(_f,100);
});
}
})();
}


;define("dojox/string/BidiComplex",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/sniff","dojo/keys"],function(_1,_2,_3,_4,_5,_6){
_1.experimental("dojox.string.BidiComplex");
var _7=_2.getObject("string.BidiComplex",true,dojox);
var _8=[];
_7.attachInput=function(_9,_a){
_9.alt=_a;
_4.connect(_9,"onkeydown",this,"_ceKeyDown");
_4.connect(_9,"onkeyup",this,"_ceKeyUp");
_4.connect(_9,"oncut",this,"_ceCutText");
_4.connect(_9,"oncopy",this,"_ceCopyText");
_9.value=_7.createDisplayString(_9.value,_9.alt);
};
_7.createDisplayString=function(_b,_c){
if(_c=="AT_USER"){
if(_b.charAt(0)=="@"){
_b="\u200e"+_b;
}
return _b.replace(/\s@/g," \u200e@");
}
_b=_7.stripSpecialCharacters(_b);
var _d=_7._parse(_b,_c);
var _e="\u202a"+_b;
var _f=1;
_3.forEach(_d,function(n){
if(n!=null){
var _10=_e.substring(0,n+_f);
var _11=_e.substring(n+_f,_e.length);
_e=_10+"\u200e"+_11;
_f++;
}
});
_e=_e+"\u202c";
return _e;
};
_7.stripSpecialCharacters=function(str){
return str.replace(/[\u200E\u200F\u202A-\u202E]/g,"");
};
_7._ceKeyDown=function(_12){
var _13=_5("ie")?_12.srcElement:_12.target;
_8=_13.value;
};
_7._ceKeyUp=function(_14){
var LRM="\u200e";
var _15=_5("ie")?_14.srcElement:_14.target;
var _16=_15.value;
var _17=_14.keyCode;
if((_17==_6.HOME)||(_17==_6.END)||(_17==_6.SHIFT)){
return;
}
var _18,_19;
var _1a=_7._getCaretPos(_14,_15);
if(_1a){
_18=_1a[0];
_19=_1a[1];
}
if(_5("ie")){
var _1b=_18,_1c=_19;
if(_17==_6.LEFT_ARROW){
if((_16.charAt(_19-1)==LRM)&&(_18==_19)){
_7._setSelectedRange(_15,_18-1,_19-1);
}
return;
}
if(_17==_6.RIGHT_ARROW){
if(_16.charAt(_19-1)==LRM){
_1c=_19+1;
if(_18==_19){
_1b=_18+1;
}
}
_7._setSelectedRange(_15,_1b,_1c);
return;
}
}else{
if(_17==_6.LEFT_ARROW){
if(_16.charAt(_19-1)==LRM){
_7._setSelectedRange(_15,_18-1,_19-1);
}
return;
}
if(_17==_6.RIGHT_ARROW){
if(_16.charAt(_19-1)==LRM){
_7._setSelectedRange(_15,_18+1,_19+1);
}
return;
}
}
var _1d=_7.createDisplayString(_16,_15.alt);
if(_16!=_1d){
window.status=_16+" c="+_19;
_15.value=_1d;
if((_17==_6.DELETE)&&(_1d.charAt(_19)==LRM)){
_15.value=_1d.substring(0,_19)+_1d.substring(_19+2,_1d.length);
}
if(_17==_6.DELETE){
_7._setSelectedRange(_15,_18,_19);
}else{
if(_17==_6.BACKSPACE){
if((_8.length>=_19)&&(_8.charAt(_19-1)==LRM)){
_7._setSelectedRange(_15,_18-1,_19-1);
}else{
_7._setSelectedRange(_15,_18,_19);
}
}else{
if(_15.value.charAt(_19)!=LRM){
_7._setSelectedRange(_15,_18+1,_19+1);
}
}
}
}
};
_7._processCopy=function(_1e,_1f,_20){
if(_1f==null){
if(_5("ie")){
var _21=document.selection.createRange();
_1f=_21.text;
}else{
_1f=_1e.value.substring(_1e.selectionStart,_1e.selectionEnd);
}
}
var _22=_7.stripSpecialCharacters(_1f);
if(_5("ie")){
window.clipboardData.setData("Text",_22);
}
return true;
};
_7._ceCopyText=function(_23){
if(_5("ie")){
_23.returnValue=false;
}
return _7._processCopy(_23,null,false);
};
_7._ceCutText=function(_24){
var ret=_7._processCopy(_24,null,false);
if(!ret){
return false;
}
if(_5("ie")){
document.selection.clear();
}else{
var _25=_24.selectionStart;
_24.value=_24.value.substring(0,_25)+_24.value.substring(_24.selectionEnd);
_24.setSelectionRange(_25,_25);
}
return true;
};
_7._getCaretPos=function(_26,_27){
if(_5("ie")){
var _28=0,_29=document.selection.createRange().duplicate(),_2a=_29.duplicate(),_2b=_29.text.length;
if(_27.type=="textarea"){
_2a.moveToElementText(_27);
}else{
_2a.expand("textedit");
}
while(_29.compareEndPoints("StartToStart",_2a)>0){
_29.moveStart("character",-1);
++_28;
}
return [_28,_28+_2b];
}
return [_26.target.selectionStart,_26.target.selectionEnd];
};
_7._setSelectedRange=function(_2c,_2d,_2e){
if(_5("ie")){
var _2f=_2c.createTextRange();
if(_2f){
if(_2c.type=="textarea"){
_2f.moveToElementText(_2c);
}else{
_2f.expand("textedit");
}
_2f.collapse();
_2f.moveEnd("character",_2e);
_2f.moveStart("character",_2d);
_2f.select();
}
}else{
_2c.selectionStart=_2d;
_2c.selectionEnd=_2e;
}
};
var _30=function(c){
return (c>="0"&&c<="9")||(c>"\xff");
};
var _31=function(c){
return (c>="A"&&c<="Z")||(c>="a"&&c<="z");
};
var _32=function(_33,i,_34){
while(i>0){
if(i==_34){
return false;
}
i--;
if(_30(_33.charAt(i))){
return true;
}
if(_31(_33.charAt(i))){
return false;
}
}
return false;
};
_7._parse=function(str,_35){
var _36=-1,_37=[];
var _38={FILE_PATH:"/\\:.",URL:"/:.?=&#",XPATH:"/\\:.<>=[]",EMAIL:"<>@.,;"}[_35];
switch(_35){
case "FILE_PATH":
case "URL":
case "XPATH":
_3.forEach(str,function(ch,i){
if(_38.indexOf(ch)>=0&&_32(str,i,_36)){
_36=i;
_37.push(i);
}
});
break;
case "EMAIL":
var _39=false;
_3.forEach(str,function(ch,i){
if(ch=="\""){
if(_32(str,i,_36)){
_36=i;
_37.push(i);
}
i++;
var i1=str.indexOf("\"",i);
if(i1>=i){
i=i1;
}
if(_32(str,i,_36)){
_36=i;
_37.push(i);
}
}
if(_38.indexOf(ch)>=0&&_32(str,i,_36)){
_36=i;
_37.push(i);
}
});
}
return _37;
};
return _7;
});


;if(!dojo._hasResource["lconn.core.globalization.bidiUtil"]){
dojo._hasResource["lconn.core.globalization.bidiUtil"]=true;
(function(){
dojo.provide("lconn.core.globalization.bidiUtil");






var w={};
w.LRM="\u200e";
w.RLM="\u200f";
w.LRE="\u202a";
w.RLE="\u202b";
w.PDF="\u202c";
w.enforceTextDirectionOnPage=function(_1){
if(lconn.core.globalization.config.areSettingsEnabled()&&lconn.core.globalization.api.isBidiEnabled()){
var _2=lconn.core.globalization.api.getTextDirection();
var _3="";
var _4="";
var ch="";
var i=0;
var t=_1?dojo.query(".bidiAware",_1):dojo.query(".bidiAware");
for(i=0;i<t.length;i++){
var _5=t[i];
if(_5.tagName=="INPUT"||_5.tagName=="TEXTAREA"||(_5.tagName=="DIV"&&_5.contentEditable=="true")){
dojo.connect(_5,"onkeyup",_5,function(){
w.inputRTLProcessing(this,_2);
});
this.inputRTLProcessing(_5,_2);
}else{
if(_5.tagName=="DIV"||_5.tagName=="H1"||_5.tagName=="H2"||_5.tagName=="H3"||_5.tagName=="H4"||_5.tagName=="B"||_5.tagName=="P"||_5.tagName=="SPAN"){
_5.style.direction=this.getTextDirection(_5.textContent,_2);
_5.dir=_5.style.direction;
_5.style.textAlign="inherit";
}else{
if(_5.tagName=="SELECT"){
this.enforceTextDirectionForSelect(_5,_2);
}else{
_5.dir=_5.style.direction=this.getTextDirection(_5.value||_5.text||_5.outerText||_5.innerHTML,_2);
if(_5.tagName=="A"){
var _4=_5.innerHTML;
var ch=_4.charAt(_4.length-1);
if((ch==w.LRM&&_5.dir==="rtl")||(ch==w.RLM&&_5.dir==="ltr")){
_5.innerHTML=_4.substr(0,_4.length-1);
}
}
}
}
}
}
t=_1?dojo.query(".url",_1):dojo.query(".url");
for(i=0;i<t.length;i++){
var _5=t[i];
if(_5.tagName=="A"){
if(_5.innerHTML.indexOf("@")==0||_5.innerHTML.indexOf("http")==0){
_5.dir="ltr";
}
}
}
var _6=_1?dojo.query(".bidiSTT_URL",_1):dojo.query(".bidiSTT_URL");
for(i=0;i<_6.length;i++){
if(_6[i].tagName=="INPUT"||_6[i].tagName=="TEXTAREA"){
dojox.string.BidiComplex.attachInput(_6[i],"URL");
}else{
_3=dojox.string.BidiComplex.createDisplayString(_6[i].innerHTML,"URL");
try{
_6[i].innerHTML=_3;
}
catch(ignore){
while(_6[i].firstChild){
_6[i].removeChild(_6[i].firstChild);
}
_6[i].appendChild(document.createTextNode(_3));
}
}
}
var _7=_1?dojo.query(".bidiSTT_EMAIL",_1):dojo.query(".bidiSTT_EMAIL");
for(i=0;i<_7.length;i++){
if(_7[i].tagName=="INPUT"||_7[i].tagName=="TEXTAREA"){
dojox.string.BidiComplex.attachInput(_7[i],"EMAIL");
}else{
_7[i].innerHTML=dojox.string.BidiComplex.createDisplayString(_7[i].innerHTML,"EMAIL");
}
}
var _8=_1?dojo.query(".bidiSTT_AT_USER",_1):dojo.query(".bidiSTT_AT_USER");
for(i=0;i<_8.length;i++){
if(_8[i].tagName=="INPUT"||_8[i].tagName=="TEXTAREA"){
dojox.string.BidiComplex.attachInput(_8[i],"AT_USER");
}else{
_3=dojox.string.BidiComplex.createDisplayString(_8[i].innerHTML,"AT_USER");
while(_8[i].firstChild){
_8[i].removeChild(_8[i].firstChild);
}
_8[i].appendChild(document.createTextNode(_3));
}
}
_8=_1?dojo.query(".bidiSTT_AT_USER1",_1):dojo.query(".bidiSTT_AT_USER1");
for(i=0;i<_8.length;i++){
if(_8[i].tagName=="INPUT"||_8[i].tagName=="TEXTAREA"){
dojox.string.BidiComplex.attachInput(_8[i],"AT_USER");
}else{
_8[i].innerHTML=w.enforceTextDirectionMultiLine(_8[i].innerHTML,"AT_USER");
}
}
var _9=(_6.length>0?_6[0].form:(_7.length>0?_7[0].form:null));
if(_9){
dojo.connect(_9,"onsubmit",_9,function(){
w.stripSpecialCharacters(_1);
});
}
var f=_1?dojo.query(".bidiFileInput",_1):dojo.query(".bidiFileInput");
for(i=0;i<f.length;i++){
var _5=f[i];
dojo.connect(_5,"onkeydown",_5,function(){
w.onFileKeyDown(this);
});
dojo.connect(_5,"onchange",_5,function(){
w.processChange(this);
});
dojo.connect(_5,"onfocus",_5,function(){
w.fileOnFocus(this);
});
dojo.connect(_5,"onmousedown",_5,function(){
w.onFileMouseDown(this);
});
var _a=dojo.byId("bidi_faked_"+_5.id);
if(_a){
dojo.connect(_a,"onfocus",_a,function(){
w.onfocus(this);
});
dojo.connect(_a,"onkeydown",_a,function(){
w.onFakeKeyDown(event,this);
});
dojo.connect(_a,"oncopy",_a,function(){
w.processCopy(this);
});
dojo.connect(_a,"onpaste",_a,function(){
return false;
});
dojo.connect(_a,"oncut",_a,function(){
return false;
});
}
}
}
};
w.inputRTLProcessing=function(_b,_c){
if(lconn.core.globalization.config.areSettingsEnabled()&&lconn.core.globalization.api.isBidiEnabled()&&_b!=null&&(_b.value!=""||_b.innerHTML!="")){
_c=this.getTextDirectionPref(_c);
if(_b.tagName=="INPUT"||_b.tagName=="TEXTAREA"||(_b.tagName=="DIV"&&_b.contentEditable=="true")&&(_b.value||_b.innerHTML)){
if(_c==lconn.core.globalization.config.TEXT_DIRECTION.CONTEXTUAL){
if(this.isRTLValue(_b.value||_b.innerHTML)){
_b.dir=_b.style.direction="rtl";
}else{
_b.dir=_b.style.direction="ltr";
}
}else{
if(_c==lconn.core.globalization.config.TEXT_DIRECTION.LEFT_TO_RIGHT){
_b.dir=_b.style.direction="ltr";
}else{
if(_c==lconn.core.globalization.config.TEXT_DIRECTION.RIGHT_TO_LEFT){
_b.dir=_b.style.direction="rtl";
}
}
}
if(dojo.hasClass(_b,"lotusLeft")&&_b.style.direction==="rtl"){
_b.style.textAlign="right";
}else{
if(dojo.hasClass(_b,"lotusRight")&&_b.style.direction==="ltr"){
_b.style.textAlign="left";
}
}
}
}
};
w.enforceTextDirectionForSelect=function(_d,_e){
if(lconn.core.globalization.config.areSettingsEnabled()&&lconn.core.globalization.api.isBidiEnabled()){
var _f=dojo.query("option",_d);
for(var i=0;i<_f.length;i++){
var _10=_f[i];
_10.text=this.enforceTextDirection(_10.text,_e);
}
}
};
w.enforceTextDirectionMultiLine=function(_11,_12){
if(typeof (_11)!="string"){
return _11;
}
var _13="\n";
if(_11.indexOf("<br>")>-1){
_13="<br>";
}
if(_11.indexOf("<BR>")>-1){
_13="<BR>";
}
var arr=_11.split(_13);
var _14="";
var str="";
for(var i=0;i<arr.length;i++){
str=arr[i];
str=this.enforceTextDirection(str);
if(typeof (_12)=="string"){
str=dojox.string.BidiComplex.createDisplayString(str,_12);
}
if(i>0){
_14=_14+_13;
}
_14=_14+str;
}
return _14;
};
w.enforceTextDirection=function(_15,_16){
_16=this.getTextDirectionPref(_16);
var _17=this.getTextDirection(_15,_16);
var _18=_15;
if(_17=="ltr"){
_18=this.LRE+_18+this.PDF;
}else{
if(_17=="rtl"){
_18=this.RLE+_18+this.PDF;
}
}
return _18;
};
w.getTextDirection=function(_19,_1a){
_1a=this.getTextDirectionPref(_1a);
var _1b="";
if(typeof (_19)!="undefined"){
if(_1a==lconn.core.globalization.config.TEXT_DIRECTION.CONTEXTUAL){
if(this.isRTLValue(_19)){
_1b="rtl";
}else{
_1b="ltr";
}
}else{
if(_1a==lconn.core.globalization.config.TEXT_DIRECTION.LEFT_TO_RIGHT){
_1b="ltr";
}else{
if(_1a==lconn.core.globalization.config.TEXT_DIRECTION.RIGHT_TO_LEFT){
_1b="rtl";
}
}
}
}
return _1b;
};
w.getTextDirectionPref=function(_1c){
var _1d="";
if(typeof (_1c)!="undefined"){
_1d=_1c;
}else{
if(lconn.core.globalization.config.areSettingsEnabled()&&lconn.core.globalization.api.isBidiEnabled()){
_1d=lconn.core.globalization.api.getTextDirection();
}
}
return _1d;
};
w.isRTLValue=function(_1e){
var i;
for(i=0;i<_1e.length;i++){
if(this.isBidiChar(_1e.charCodeAt(i))){
return true;
}else{
if(this.isLatinChar(_1e.charCodeAt(i))){
return false;
}
}
}
return false;
};
w.isBidiChar=function(c){
if(c>=1488&&c<=1535){
return true;
}else{
if(c>=1536&&c<=1631){
return true;
}else{
if(c>=1642&&c<=1775){
return true;
}else{
if(c>=1786&&c<=2047){
return true;
}else{
if(c>=64285&&c<=65023){
return true;
}else{
if(c>=65136&&c<=65276){
return true;
}else{
return false;
}
}
}
}
}
}
};
w.isLatinChar=function(c){
if((c>64&&c<91)||(c>96&&c<123)){
return true;
}else{
return false;
}
};
w.fakeOnFocus=function(obj){
this.setRelatedElements(obj);
};
w.fileOnFocus=function(obj){
this.setRelatedElements(obj);
obj.relatedElement.value=dojox.string.BidiComplex.createDisplayString(obj.value,"FILE_PATH");
};
w.processChange=function(obj){
obj.relatedElement.value=dojox.string.BidiComplex.createDisplayString(obj.value,"FILE_PATH");
obj.relatedElement.focus();
};
w.onFakeKeyDown=function(_1f,obj){
this.setRelatedElements(obj);
_1f=(_1f)?_1f:((window.event)?window.event:"");
var _20=_1f.keyCode;
if(_1f.altKey||_1f.ctrlKey||_20==VK_SHIFT){
return true;
}else{
if(!(_20==VK_HOME||_20==VK_END||_20==VK_LEFT||_20==VK_RIGHT)){
obj.relatedElement.focus();
return false;
}else{
return true;
}
}
};
w.onFileMouseDown=function(obj){
this.setRelatedElements(obj);
obj.relatedElement.focus();
return false;
};
w.onFileKeyDown=function(obj){
this.setRelatedElements(obj);
obj.relatedElement.focus();
return false;
};
w.setRelatedElements=function(obj){
if(obj.relatedElement){
return;
}
var _21=obj.parentNode.childNodes;
var _22;
for(var i=0;i<_21.length;i++){
if(obj.id=="bidi_faked_"+_21[i].id||_21[i].id=="bidi_faked_"+obj.id){
_22=_21[i];
break;
}
}
obj.relatedElement=_22;
_22.relatedElement=obj;
};
w.processCopy=function(obj){
var _23="";
try{
if(dojo.isIE){
var w=obj.document.parentWindow;
var e=w.event;
var _24=obj.document.selection.createRange();
_23=_24.text;
}else{
_23=obj.document.getSelection();
}
var _25=dojox.string.BidiComplex.stripSpecialCharacters(_23);
if(window.clipboardData){
window.clipboardData.setData("Text",_25);
e.returnValue=false;
}
}
catch(ex){
}
};
w.stripSpecialCharacters=function(_26){
var _27=_26?dojo.query(".bidiSTT_URL",_26):dojo.query(".bidiSTT_URL");
for(var i=0;i<_27.length;i++){
if(_27[i].tagName=="INPUT"||_27[i].tagName=="TEXTAREA"){
_27[i].value=dojox.string.BidiComplex.stripSpecialCharacters(_27[i].value);
}
}
var _28=_26?dojo.query(".bidiSTT_EMAIL",_26):dojo.query(".bidiSTT_EMAIL");
for(var i=0;i<_28.length;i++){
if(_28[i].tagName=="INPUT"||_28[i].tagName=="TEXTAREA"){
_28[i].value=dojox.string.BidiComplex.stripSpecialCharacters(_28[i].value);
}
}
};
w.substituteWithSTT=function(_29,_2a){
var _2b=this.isBidiChar(_29.charCodeAt(0));
var i;
if(_2b){
for(i=0;i<_2a.length;i++){
_2a[i]=this.RLM+dojox.string.BidiComplex.createDisplayString(_2a[i],"FILE_PATH")+this.RLM;
}
}
var _2c=dojo.string.substitute(_29,_2a);
if(_2b){
_2c=this.RLE+_2c+this.PDF;
}
return _2c;
};
lconn.core.globalization.bidiUtil=w;
})();
}


;if(!dojo._hasResource["lconn.core.util.html"]){
dojo._hasResource["lconn.core.util.html"]=true;
(function(){
dojo.provide("lconn.core.util.html");


var _1=lconn.core.util.html={getDirectionCode:function(){
return dojo._isBodyLtr()?"":"\u200f";
},destroyWidgets:function(el){
if(el&&el.nodeType!=11){
var _2=dojo.query("[widgetId]",el).map(dijit.byNode);
dojo.forEach(_2,function(w){
if(w){
w.destroyRecursive();
}
});
}
},removeChildren:function(el){
if(!el){
return;
}
lconn.core.util.html.destroyWidgets(el);
while(el.firstChild){
el.removeChild(el.firstChild);
}
},isEvent:function(e){
return (e&&(typeof e.target!="undefined"||typeof e.bubbles!="undefined"));
},append:function(el,_3){
var d=document;
if(dojo.isArray(_3)){
for(var i=0;i<_3.length;i++){
var c=_3[i];
el.appendChild((typeof c=="string")?d.createTextNode(c):c);
}
}else{
el.appendChild((typeof _3=="string")?d.createTextNode(_3):_3);
}
},createTable:function(d,_4){
var _5=d.createElement("table");
_5.cellPadding=_5.cellSpacing=0;
var _6=d.createElement("tbody");
var tr=d.createElement("tr");
var td=d.createElement("td");
if(_4){
td.appendChild(_4);
}
tr.appendChild(td);
_6.appendChild(tr);
_5.appendChild(_6);
return _5;
},countCells:function(tr,_7){
var td=tr.firstChild;
var c=0;
while(td){
if(_7==td){
break;
}
if(td.nodeName.toLowerCase()=="td"){
c+=(dojo.attr(td,"colSpan")||1);
}
td=td.nextSibling;
}
return c;
},formatFilename:function(s){
if(dojo._isBodyLtr()){
return lconn.core.util.html.encodeMultiSpaces(s);
}
return "\u202a"+lconn.core.util.html.encodeMultiSpaces(s)+"\u202c";
},breakString:function(s,d,el,_8){
if(!s){
return;
}
_8=_8||10;
var b=new RegExp("[^\\s]{"+(_8+1)+"}","g");
var r;
var _9=0,_a;
if(dojo.isIE||dojo.isWebKit){
while(r=b.exec(s)){
_a=--b.lastIndex;
var _b=s.charCodeAt(_a-1);
if(_b>=55296&&_b<56192){
_a++;
}
if(_b==3588){
_a++;
}
for(var i=0;i<s.length-2;i++){
if(s.charCodeAt(i)==3619&&s.charCodeAt(i+1)==3639&&s.charCodeAt(i+2)==3656){
_a=9;
break;
}else{
el.appendChild(d.createElement("wbr"));
}
}
el.appendChild(d.createTextNode(s.substring(_9,_a)));
_9=_a;
}
}else{
while(r=b.exec(s)){
_a=--b.lastIndex;
var _b=s.charCodeAt(_a-1);
if(_b>=55296&&_b<56192){
_a++;
}
if(_b==3588){
_a++;
}
for(var i=0;i<s.length-2;i++){
if(s.charCodeAt(i)==3619&&s.charCodeAt(i+1)==3639&&s.charCodeAt(i+2)==3656){
_a=9;
break;
}else{
el.appendChild(d.createElement("wbr"));
}
}
el.appendChild(d.createTextNode(s.substring(_9,_a)+"\u200b"));
_9=_a;
}
}
el.appendChild(d.createTextNode(s.substring(_a)));
return el;
},encodeHtmlAttribute:function(s){
return lconn.core.util.html.encodeHtml(s).replace(/\"/g,"&quot;");
},encodeHtml:function(s){
if(!s){
return "";
}
var e=lconn.core.util.html._encoder;
if(!e){
e=lconn.core.util.html._encoder=dojo.doc.createElement("div");
}
e.innerHTML="";
e.appendChild(dojo.doc.createTextNode(s));
return e.innerHTML;
},decodeHtml:function(s){
if(!s){
return "";
}
var e=lconn.core.util.html._encoder;
if(!e){
e=lconn.core.util.html._encoder=dojo.doc.createElement("div");
}
e.innerHTML=s;
return e.lastChild.nodeValue;
},getFrameDocument:function(_c){
var _d;
if(_c){
try{
if(dojo.isIE||dojo.isSafari>2){
_d=_c.contentWindow.document;
}else{
if(dojo.isSafari){
_d=_c.document;
}else{
_d=_c.contentWindow.document;
}
}
}
catch(e){
}
}
return _d;
},UNICODE_SPACE:/[\s\u3000]/g,UNICODE_DOUBLE_SPACE:/[\s\u3000]{2}/g,encodeSpaces:function(s){
if(!s){
return s;
}
return s.replace(lconn.core.util.html.UNICODE_SPACE,"\xa0");
},encodeMultiSpaces:function(s){
if(!s){
return s;
}
return s.replace(lconn.core.util.html.UNICODE_DOUBLE_SPACE," \xa0");
},htmlText:function(el){
if(!el){
return null;
}
var a=[];
for(var j=0;c=el.childNodes[j];j++){
if(c.nodeType==3){
a.push(c.nodeValue);
}
}
return a.length>0?a.join(""):null;
},SUBSTITUTION:/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,substitute:function(d,el,_e,_f,_10,_11,sub){
var re=sub||lconn.core.util.html.SUBSTITUTION;
el=el||d.createDocumentFragment();
var _12=0;
while(r=re.exec(_e)){
el.appendChild(d.createTextNode(_e.substring(_12,r.index)));
_12=r.index+r[0].length;
var key=r[1];
var _13=r[2];
var _14=dojo.getObject(key,false,_f);
if(typeof _14=="function"){
_14=_14.apply(_11||_f,[key,_13]);
}
if(_13){
_14=dojo.getObject(_13,false,_11)(_14);
}
if(_10){
_14=_10(_14,key);
}
if(typeof _14!="undefined"&&_14!=null){
if(_14.nodeType>0){
_14.style.direction=lconn.core.globalization.bidiUtil.getTextDirection(_14.textContent);
_14.dir=_14.style.direction;
_14.style.textAlign="inherit";
el.appendChild(_14);
}else{
_14=lconn.core.globalization.bidiUtil.enforceTextDirection(_14.toString());
el.appendChild(d.createTextNode(_14.toString()));
}
}
}
el.appendChild(d.createTextNode(_e.substring(_12)));
return el;
},EMBEDDED_URL_PATTERN:/(^|[\s])(([a-zA-Z]+:\/\/|www\.|mailto:)[^\s]+)/i,URL_PUNCTUATION_BACKTRACK:/[\.,\!;\:\'\"]+$/,createTextNode:function(d,el,_15,_16){
if(!_15){
return;
}
_15=dojo.trim(_15);
if(_15.length>0){
var _17=_15.split("\n");
dojo.forEach(_17,function(_18,i,arr){
var _19,_1a;
while(_19=lconn.core.util.html.EMBEDDED_URL_PATTERN.exec(_18)){
var _1b=_18.substring(0,_19.index)+_19[1];
var _1c=_19[2];
if(_1a=lconn.core.util.html.URL_PUNCTUATION_BACKTRACK.exec(_1c)){
_1c=_1c.substring(0,_1a.index);
}
_18=_18.substring(_1b.length+_1c.length);
var _1d=(_19[3]&&_19[3].toLowerCase()=="www.");
var _1e=(_19[3]&&_19[3].toLowerCase()=="mailto:");
var _1f=_1d?"http://"+_1c:_1c;
if(_1e){
_1c=_1c.substring(7);
}
if(_1b.length>0){
lconn.core.util.html.breakString(_1b,d,el,15);
}
var a=d.createElement("a");
a.href=_1f;
lconn.core.util.html.breakString(_1c,d,a,15);
el.appendChild(a);
}
if(_18.length>0){
lconn.core.util.html.breakString(_18,d,el,15);
}
if(i<arr.length-1){
el.appendChild(!_16?d.createElement("br"):d.createTextNode(" "));
}
});
}
},generateiWidgetEnablerCodeIfRequired:function(_20,doc){
if(_20.indexOf("mm_iWidget")>-1){
console.log("update generateiWidgetEnablerCodeIfRequired for MM1.1");
}
return null;
},evalScriptTag:function(tag){
if(tag.src){
var h=document.getElementsByTagName("head")[0];
var _21=document.createElement("SCRIPT");
_21.src=tag.src;
h.appendChild(_21);
}else{
if(tag.text&&tag.text.length>0){
if(window.execScript){
window.execScript(tag.text);
}else{
if(dojo.isSafari){
window.setTimeout(tag.text,0);
}else{
eval.call(window,tag.text);
}
}
}
}
},xhtmlToHtml:function(d,_22,_23,_24,ids){
if(!_22){
return;
}
if(!_24){
for(var i=0,a;a=_22.attributes[i];i++){
var n=a.nodeName.toLowerCase();
switch(n){
case "class":
_23.className=a.nodeValue;
break;
case "colspan":
_23.colSpan=a.nodeValue;
break;
case "style":
try{
_23.style.cssText=a.nodeValue;
}
catch(e){
}
break;
default:
if(n=="onclick"&&dojo.isIE){
_23.onclick=new Function(a.nodeValue);
}else{
_23.setAttribute(a.nodeName,a.nodeValue);
}
}
}
if(_23.id&&ids){
ids[_23.id]=_23;
}
}
var n=_22.nodeName.toLowerCase();
for(var i=0,x;x=_22.childNodes[i];i++){
switch(x.nodeType){
case 1:
var e=d.createElement(x.nodeName);
_23.appendChild(e);
lconn.core.util.html.xhtmlToHtml(d,x,e,false,ids);
break;
case 3:
switch(n){
case "script":
if(dojo.isIE){
_23.text=x.nodeValue;
}else{
_23.appendChild(d.createTextNode(x.nodeValue));
}
break;
case "style":
if(dojo.isIE){
_23.styleSheet.cssText=x.nodeValue;
}else{
_23.appendChild(d.createTextNode(x.nodeValue));
}
break;
default:
_23.appendChild(d.createTextNode(x.nodeValue));
break;
}
break;
}
}
},alert:function(msg){
alert(msg);
},confirm:function(msg,_25,_26){
var _27=confirm(msg);
if(_27&&_25){
_25();
}else{
if(!_27&&_26){
_26();
}
}
},checkFeedSubscription:function(msg,url,e){
if(dojo.isSafari<2||dojo.isChrome){
if(e){
dojo.stopEvent(e);
}
_1.confirm(msg,function(){
window.location=url;
});
}
},highlight:function(_28,key,_29,tag){
var _2a=_28.toLowerCase();
var _2b=key.toLowerCase();
tag=tag||"b";
var fn=_29?this.encodeHtml:function(s){
return s;
};
var _2c=0;
var _2d=null;
var _2e=_2b.split(/\s/);
var sbf=[];
for(var i=0;i<_2e.length;i++){
var s=_2e[i];
var _2d=_2a.indexOf(s,_2c);
if(_2d!=-1){
sbf.push(fn(_28.substring(_2c,_2d)));
sbf.push("<"+tag+">");
sbf.push(fn(_28.substring(_2d,_2d+s.length)));
sbf.push("</"+tag+">");
_2c=_2d+s.length;
}
}
sbf.push(fn(_28.substring(_2c)));
return sbf.join("");
}};
})();
}


;if(!dojo._hasResource["lconn.core.TypeAheadFormatMixin"]){
dojo._hasResource["lconn.core.TypeAheadFormatMixin"]=true;
dojo.provide("lconn.core.TypeAheadFormatMixin");




(function(_1,_2){
dojo.declare("lconn.core.TypeAheadFormatMixin",null,{formatItem:function(_3,_4){
return _4?_1.encodeHtml(_3):_3;
},formatItemHtml:function(_5){
return this.formatItem(_5,true);
},_getLabelFromItem:function(_6){
return _6;
},_setLabelForItem:function(_7,_8){
return _8;
},_getMenuLabelFromItem:function(_9){
var _a=this._getLabelFromItem(_9);
var _b=this.multipleValues?_2.trim(this.keyArr[this.keyIdx]):_2.trim(this.focusNode.value);
if(_9.type!=="-1"){
_a=_1.highlight(_a,_b,true);
}
_9=this._setLabelForItem(_9,_a);
return {html:true,label:_9};
}});
}(lconn.core.util.html,dojo.string));
}


;define("dojo/i18n!dojo/cldr/nls/number", {"scientificFormat":"#E0","decimalFormat-long":"000 trillion","exponential":"E","minusSign":"-","decimal":".","currencySpacing-beforeCurrency-currencyMatch":"[:^S:]","decimalFormat-short":"000T","currencySpacing-afterCurrency-currencyMatch":"[:^S:]","nan":"NaN","percentFormat":"#,##0%","list":";","percentSign":"%","currencySpacing-beforeCurrency-surroundingMatch":"[:digit:]","infinity":"\u221e","currencyFormat":"\xa4#,##0.00;(\xa4#,##0.00)","decimalFormat":"#,##0.###","superscriptingExponent":"\xd7","perMille":"\u2030","currencySpacing-beforeCurrency-insertBetween":"\xa0","currencySpacing-afterCurrency-insertBetween":"\xa0","plusSign":"+","currencySpacing-afterCurrency-surroundingMatch":"[:digit:]","group":","});

;define("dojo/number",["./_base/lang","./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(_1,_2,_3,_4,_5){
var _6={};
_1.setObject("dojo.number",_6);
_6.format=function(_7,_8){
_8=_1.mixin({},_8||{});
var _9=_2.normalizeLocale(_8.locale),_a=_2.getLocalization("dojo.cldr","number",_9);
_8.customs=_a;
var _b=_8.pattern||_a[(_8.type||"decimal")+"Format"];
if(isNaN(_7)||Math.abs(_7)==Infinity){
return null;
}
return _6._applyPattern(_7,_b,_8);
};
_6._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;
_6._applyPattern=function(_c,_d,_e){
_e=_e||{};
var _f=_e.customs.group,_10=_e.customs.decimal,_11=_d.split(";"),_12=_11[0];
_d=_11[(_c<0)?1:0]||("-"+_12);
if(_d.indexOf("%")!=-1){
_c*=100;
}else{
if(_d.indexOf("\u2030")!=-1){
_c*=1000;
}else{
if(_d.indexOf("\xa4")!=-1){
_f=_e.customs.currencyGroup||_f;
_10=_e.customs.currencyDecimal||_10;
_d=_d.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/,function(_13,_14,_15,_16){
var _17=["symbol","currency","displayName"][_15.length-1],_18=_e[_17]||_e.currency||"";
if(!_18){
return "";
}
return _14+_18+_16;
});
}else{
if(_d.indexOf("E")!=-1){
throw new Error("exponential notation not supported");
}
}
}
}
var _19=_6._numberPatternRE;
var _1a=_12.match(_19);
if(!_1a){
throw new Error("unable to find a number expression in pattern: "+_d);
}
if(_e.fractional===false){
_e.places=0;
}
return _d.replace(_19,_6._formatAbsolute(_c,_1a[0],{decimal:_10,group:_f,places:_e.places,round:_e.round}));
};
_6.round=function(_1b,_1c,_1d){
var _1e=10/(_1d||10);
return (_1e*+_1b).toFixed(_1c)/_1e;
};
if((0.9).toFixed()==0){
var _1f=_6.round;
_6.round=function(v,p,m){
var d=Math.pow(10,-p||0),a=Math.abs(v);
if(!v||a>=d){
d=0;
}else{
a/=d;
if(a<0.5||a>=0.95){
d=0;
}
}
return _1f(v,p,m)+(v>0?d:-d);
};
}
_6._formatAbsolute=function(_20,_21,_22){
_22=_22||{};
if(_22.places===true){
_22.places=0;
}
if(_22.places===Infinity){
_22.places=6;
}
var _23=_21.split("."),_24=typeof _22.places=="string"&&_22.places.indexOf(","),_25=_22.places;
if(_24){
_25=_22.places.substring(_24+1);
}else{
if(!(_25>=0)){
_25=(_23[1]||[]).length;
}
}
if(!(_22.round<0)){
_20=_6.round(_20,_25,_22.round);
}
var _26=String(Math.abs(_20)).split("."),_27=_26[1]||"";
if(_23[1]||_22.places){
if(_24){
_22.places=_22.places.substring(0,_24);
}
var pad=_22.places!==undefined?_22.places:(_23[1]&&_23[1].lastIndexOf("0")+1);
if(pad>_27.length){
_26[1]=_4.pad(_27,pad,"0",true);
}
if(_25<_27.length){
_26[1]=_27.substr(0,_25);
}
}else{
if(_26[1]){
_26.pop();
}
}
var _28=_23[0].replace(",","");
pad=_28.indexOf("0");
if(pad!=-1){
pad=_28.length-pad;
if(pad>_26[0].length){
_26[0]=_4.pad(_26[0],pad);
}
if(_28.indexOf("#")==-1){
_26[0]=_26[0].substr(_26[0].length-pad);
}
}
var _29=_23[0].lastIndexOf(","),_2a,_2b;
if(_29!=-1){
_2a=_23[0].length-_29-1;
var _2c=_23[0].substr(0,_29);
_29=_2c.lastIndexOf(",");
if(_29!=-1){
_2b=_2c.length-_29-1;
}
}
var _2d=[];
for(var _2e=_26[0];_2e;){
var off=_2e.length-_2a;
_2d.push((off>0)?_2e.substr(off):_2e);
_2e=(off>0)?_2e.slice(0,off):"";
if(_2b){
_2a=_2b;
delete _2b;
}
}
_26[0]=_2d.reverse().join(_22.group||",");
return _26.join(_22.decimal||".");
};
_6.regexp=function(_2f){
return _6._parseInfo(_2f).regexp;
};
_6._parseInfo=function(_30){
_30=_30||{};
var _31=_2.normalizeLocale(_30.locale),_32=_2.getLocalization("dojo.cldr","number",_31),_33=_30.pattern||_32[(_30.type||"decimal")+"Format"],_34=_32.group,_35=_32.decimal,_36=1;
if(_33.indexOf("%")!=-1){
_36/=100;
}else{
if(_33.indexOf("\u2030")!=-1){
_36/=1000;
}else{
var _37=_33.indexOf("\xa4")!=-1;
if(_37){
_34=_32.currencyGroup||_34;
_35=_32.currencyDecimal||_35;
}
}
}
var _38=_33.split(";");
if(_38.length==1){
_38.push("-"+_38[0]);
}
var re=_5.buildGroupRE(_38,function(_39){
_39="(?:"+_5.escapeString(_39,".")+")";
return _39.replace(_6._numberPatternRE,function(_3a){
var _3b={signed:false,separator:_30.strict?_34:[_34,""],fractional:_30.fractional,decimal:_35,exponent:false},_3c=_3a.split("."),_3d=_30.places;
if(_3c.length==1&&_36!=1){
_3c[1]="###";
}
if(_3c.length==1||_3d===0){
_3b.fractional=false;
}else{
if(_3d===undefined){
_3d=_30.pattern?_3c[1].lastIndexOf("0")+1:Infinity;
}
if(_3d&&_30.fractional==undefined){
_3b.fractional=true;
}
if(!_30.places&&(_3d<_3c[1].length)){
_3d+=","+_3c[1].length;
}
_3b.places=_3d;
}
var _3e=_3c[0].split(",");
if(_3e.length>1){
_3b.groupSize=_3e.pop().length;
if(_3e.length>1){
_3b.groupSize2=_3e.pop().length;
}
}
return "("+_6._realNumberRegexp(_3b)+")";
});
},true);
if(_37){
re=re.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(_3f,_40,_41,_42){
var _43=["symbol","currency","displayName"][_41.length-1],_44=_5.escapeString(_30[_43]||_30.currency||"");
if(!_44){
return "";
}
_40=_40?"[\\s\\xa0]":"";
_42=_42?"[\\s\\xa0]":"";
if(!_30.strict){
if(_40){
_40+="*";
}
if(_42){
_42+="*";
}
return "(?:"+_40+_44+_42+")?";
}
return _40+_44+_42;
});
}
return {regexp:re.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:_34,decimal:_35,factor:_36};
};
_6.parse=function(_45,_46){
var _47=_6._parseInfo(_46),_48=(new RegExp("^"+_47.regexp+"$")).exec(_45);
if(!_48){
return NaN;
}
var _49=_48[1];
if(!_48[1]){
if(!_48[2]){
return NaN;
}
_49=_48[2];
_47.factor*=-1;
}
_49=_49.replace(new RegExp("["+_47.group+"\\s\\xa0"+"]","g"),"").replace(_47.decimal,".");
return _49*_47.factor;
};
_6._realNumberRegexp=function(_4a){
_4a=_4a||{};
if(!("places" in _4a)){
_4a.places=Infinity;
}
if(typeof _4a.decimal!="string"){
_4a.decimal=".";
}
if(!("fractional" in _4a)||/^0/.test(_4a.places)){
_4a.fractional=[true,false];
}
if(!("exponent" in _4a)){
_4a.exponent=[true,false];
}
if(!("eSigned" in _4a)){
_4a.eSigned=[true,false];
}
var _4b=_6._integerRegexp(_4a),_4c=_5.buildGroupRE(_4a.fractional,function(q){
var re="";
if(q&&(_4a.places!==0)){
re="\\"+_4a.decimal;
if(_4a.places==Infinity){
re="(?:"+re+"\\d+)?";
}else{
re+="\\d{"+_4a.places+"}";
}
}
return re;
},true);
var _4d=_5.buildGroupRE(_4a.exponent,function(q){
if(q){
return "([eE]"+_6._integerRegexp({signed:_4a.eSigned})+")";
}
return "";
});
var _4e=_4b+_4c;
if(_4c){
_4e="(?:(?:"+_4e+")|(?:"+_4c+"))";
}
return _4e+_4d;
};
_6._integerRegexp=function(_4f){
_4f=_4f||{};
if(!("signed" in _4f)){
_4f.signed=[true,false];
}
if(!("separator" in _4f)){
_4f.separator="";
}else{
if(!("groupSize" in _4f)){
_4f.groupSize=3;
}
}
var _50=_5.buildGroupRE(_4f.signed,function(q){
return q?"[-+]":"";
},true);
var _51=_5.buildGroupRE(_4f.separator,function(sep){
if(!sep){
return "(?:\\d+)";
}
sep=_5.escapeString(sep);
if(sep==" "){
sep="\\s";
}else{
if(sep=="\xa0"){
sep="\\s\\xa0";
}
}
var grp=_4f.groupSize,_52=_4f.groupSize2;
if(_52){
var _53="(?:0|[1-9]\\d{0,"+(_52-1)+"}(?:["+sep+"]\\d{"+_52+"})*["+sep+"]\\d{"+grp+"})";
return ((grp-_52)>0)?"(?:"+_53+"|(?:0|[1-9]\\d{0,"+(grp-1)+"}))":_53;
}
return "(?:0|[1-9]\\d{0,"+(grp-1)+"}(?:["+sep+"]\\d{"+grp+"})*)";
},true);
return _50+_51;
};
return _6;
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.social.layout"]=true;

;if(!dojo._hasResource["com.ibm.social.layout.people"]){
dojo._hasResource["com.ibm.social.layout.people"]=true;
dojo.provide("com.ibm.social.layout.people");
com.ibm.social.layout.people={createLink:function(_1){
return null;
},createImage:function(_2,_3,_4){
return null;
},getImageUrl:function(_5,_6){
return null;
},isImageEnabled:function(){
return false;
}};
}

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["lotuslive.widgets"]=true;

;if(!dojo._hasResource["lotuslive.widgets.layout.people"]){
dojo._hasResource["lotuslive.widgets.layout.people"]=true;
(function(){
dojo.provide("lotuslive.widgets.layout.people");






dojo.requireLocalization("lconn.core","strings");
var _1="fn vcard";
var _2="fn";
var _3={className:_1};
var _4={className:"x-lconn-userid",style:{display:"none"}};
var _5={className:"email",style:{display:"none"}};
var _6="/view/";
var _7="/photo/";
var _8=dojo.i18n.getLocalization("lconn.core","strings");
var _9=(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif?etag=20160903.134200")).toString();
var _a={id:"userid",userid:"userid",uid:"uid",email:"email",dn:"distinguishedName",profileId:"key"};
function _b(_c){
for(var _d in _a){
if(_a[_d]==="userid"&&typeof _c[_d]!=="undefined"){
return encodeURIComponent(_c[_d]);
}
}
return null;
};
function _e(_f){
this.src=_f;
};
function _10(){
return dojo.getObject("gllConnectionsData.srvUrls.profiles")||(lconn.core.config.services.scprofiles?lconn.core.url.getServiceUrl(lconn.core.config.services.scprofiles).toString():"/contacts/profiles");
};
dojo.mixin(com.ibm.social.layout.people,{createLink:function(_11,_12,_13){
var _14=_10()+_6+_b(_11);
var a;
var _15=_11.name;
if(_11.state=="inactive"){
_15=dojo.string.substitute(_8.rs_inactivePerson,[_15]);
}
if(_13){
dojo.addClass(_13,_1);
if(_11.state=="inactive"){
dojo.addClass(_13,"lotusPersonInactive");
}else{
dojo.addClass(_13,"lotusPerson");
}
dojo.attr(_13,"href",_14);
a=_13;
if(dojo.query(dojo.byId("semtagmenu")).length>0){
a.setAttribute("aria-describedby","semtagmenu");
}
a.appendChild(_12?_12:dojo.doc.createTextNode(_15));
}else{
a=dojo.create("a",{href:_14});
dojo.addClass(a,_2);
if(_11.state=="inactive"){
dojo.addClass(a,"lotusPersonInactive");
}else{
dojo.addClass(a,"lotusPerson");
}
if(dojo.query(dojo.byId("semtagmenu")).length>0){
a.setAttribute("aria-describedby","semtagmenu");
}
a.appendChild(_12?_12:dojo.doc.createTextNode(_15));
}
if((_11.uid!=null)&&(_11.uid!="")){
var _16=dojo.create("span",_4,a);
_16.appendChild(dojo.doc.createTextNode(_11.uid));
}else{
if((_11.userid!=null)&&(_11.userid!="")){
var _16=dojo.create("span",_4,a);
_16.appendChild(dojo.doc.createTextNode(_11.userid));
}else{
if((_11.email!=null)&&(_11.email!="")){
var _17=dojo.create("span",_5,a);
_17.appendChild(dojo.doc.createTextNode(_11.email));
}
}
}
return a;
},createImage:function(_18,_19,_1a){
if(!_18){
console.log("Person parameter is null.");
return;
}
var _1b=(!dojo._postLoad&&_19>=0);
var src=this.getImageUrl(_18,_19);
var _1c=dojo.string.substitute(_8.rs_PersonPicture,[_18.name]);
var img=dojo.create("img",{src:_1b?_9:src,alt:_1a?_1c:"",style:(_19>=0)?{width:_19+"px",height:_19+"px"}:null});
if(_18.state=="inactive"){
dojo.addClass(img,"lotusDim");
}
if(_1b){
dojo.addOnLoad(dojo.hitch(img,_e,src));
}
var out=_1a?com.ibm.lconn.layout.people.createLink(_18,img):img;
out.title=_18.name;
return out;
},getImageUrl:function(_1d,_1e){
var _1f=_10()+_7+_b(_1d);
if(_1e>32){
_1f+="/1";
}
return _1f;
},isImageEnabled:function(){
return true;
},getProfileUrl:function(_20){
var _21=_10()+_6+_b(_20);
return _21;
}});
})();
}

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.lconn.layout"]=true;

;if(!dojo._hasResource["com.ibm.lconn.layout.people"]){
dojo._hasResource["com.ibm.lconn.layout.people"]=true;
(function(){
var _1=dojo.provide("com.ibm.lconn.layout.people");












dojo.requireLocalization("lconn.core","strings");
var _2=com.ibm.social.layout.people;
var _3="fn vcard";
var _4="fn";
var _5={className:"x-lconn-userid",style:{display:"none"}};
var _6={className:"email",style:{display:"none"}};
var _7="/html/profileView.do";
var _8="/photo2.do";
var _9=dojo.i18n.getLocalization("lconn.core","strings");
var _a=(dojo.isChrome>11||dojo.isIE>8||dojo.isFF>4)?true:null;
var _b=lconn.core.config.services.profiles;
var _c=(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif?etag=20160903.134200")).toString();
function _d(_e){
this.src=_e;
};
var _f={id:"userid",userid:"userid",uid:"uid",email:"email",dn:"distinguishedName",profileId:"key"};
function _10(_11,_12){
var key;
for(key in _f){
if(_f.hasOwnProperty(key)){
if(_11[key]){
_12[_f[key]]=_11[key];
break;
}
}
}
return _12;
};
if(_b){
var _13=com.ibm.oneui.util.Url.secure;
var url;
if(_13){
url=_b.secureUrl;
}else{
url=_b.url;
}
dojo.mixin(_1,{getProfileUrl:function(_14){
var _15=url+_7+lconn.core.url.writeParameters(_10(_14,{}));
return _15;
},createLink:function(_16,_17,_18){
var _19=this.getProfileUrl(_16);
var a;
var _1a=_16.name;
if(_16.state=="inactive"){
_1a=dojo.string.substitute(_9.rs_inactivePerson,[_1a]);
}
if(_18){
dojo.addClass(_18,_3);
if(_16.state=="inactive"){
dojo.addClass(_18,"lotusPersonInactive");
}else{
dojo.addClass(_18,"lotusPerson");
}
var _1b;
if(dojo.isIE===8){
_1b=_18.innerHTML;
}
dojo.attr(_18,"href",_19);
if(dojo.isIE===8){
_18.innerHTML=_1b;
}
a=_18;
a.appendChild(_17||dojo.doc.createTextNode(_1a));
}else{
a=dojo.create("a",{href:_19});
dojo.addClass(a,_4);
if(_16.state=="inactive"){
dojo.addClass(a,"lotusPersonInactive");
}else{
dojo.addClass(a,"lotusPerson");
}
a.appendChild(_17||dojo.doc.createTextNode(_1a));
}
if((_16.uid!=null)&&(_16.uid!="")){
dojo.create("span",_5,a).appendChild(dojo.doc.createTextNode(_16.uid));
}else{
if((_16.userid!=null)&&(_16.userid!="")){
dojo.create("span",_5,a).appendChild(dojo.doc.createTextNode(_16.userid));
}else{
if((_16.email!=null)&&(_16.email!="")){
dojo.create("span",_6,a).appendChild(dojo.doc.createTextNode(_16.email));
}
}
}
dojo.addClass(a,"bidiAware");
return a;
},createImage:function(_1c,_1d,_1e){
if(!_1c){
console.log("Person parameter is null.");
return;
}
var _1f=(!dojo._postLoad&&_1d>=0);
var src=this.getImageUrl(_1c,_1d);
var _20=dojo.string.substitute(_9.rs_PersonPicture,[_1c.name]);
var img=dojo.create("img",{src:_1f?_c:src,alt:_20,style:(_1d>=0)?{width:_1d+"px",height:_1d+"px"}:null});
if(_1c.state=="inactive"){
dojo.addClass(img,"lotusDim");
}
dojo.addClass(img,"usersRadius");
if(_1f){
dojo.addOnLoad(dojo.hitch(img,_d,src));
}
var out=_1e?_1.createLink(_1c,img):img;
out.title=_20;
return out;
},getImageUrl:function(_21,_22){
var _23={r:_a,small:(_22<=64)?true:null};
_10(_21,_23);
return url+_8+lconn.core.url.writeParameters(_23);
},isImageEnabled:function(){
return true;
}});
dojo.mixin(_2,_1);
}else{
com.ibm.lconn.layout.people=_2;
return null;
}
}());
}


;dojo.cache("lconn.core", "templates/bizcard.html", "<span class=\"vcard\" type=\"MentionsNode\" contenteditable=\"false\" data-mentions='{\"displayName\":\"${displayName}\",\"userId\":\"${userid}\",\"type\":\"PersonMentions\",\"hasSymbol\":\"${hasSymbol}\"}'><a class=\"fn url\" href=\"${url}\">${name}</a><span class=\"x-lconn-userid\" style=\"display:none\">${userid}</span></span>");

;if(!dojo._hasResource["lconn.core.util.text"]){
dojo._hasResource["lconn.core.util.text"]=true;
dojo.provide("lconn.core.util.text");










(function(_1){
var _2=/(mailto:|(([A-Za-z]{3,9}):\/\/))([-;:&=\+\$,\w]+@{1})?([-A-Za-z0-9\.]+)+:?(\d+)?((\/[-\+~%\/\.\w]+)?\??([-\+=&;%@\.\w]+)?#?([\w]+)?)?/gi;
var _3=/\r?\n/g,_4=/ {2}/g,_5=/@\{{2}([^|]+)\|([^|]+)(\|notify)?\}{2}/g,_6=/<span class="?vcard"?>\s*(?:<br\/?>)*\s*<span class="?fn"?>([^<>]+)<\/span>\s*(?:<br\/?>)*\s*<span class="?x-lconn-userid"?>([^<>]+)<\/span>\s*(?:<br\/?>)*\s*<\/span>/gi;
var _7={templatePath:dojo.moduleUrl("lconn.core","templates/bizcard.html")};
var _8=1024,_9=1024*_8,_a=1024*_9,_b=1024*_a;
lconn.core.util.text={CODE_MAP:[[128,1],[2048,2],[55296,3],[56320,4,56320,57343,2]],trimToByteLength:function(_c,_d){
var _e="...";
_d=_d-_e.length;
var _f=lconn.core.util.text.CODE_MAP;
if(_d<=0){
return "";
}
var i=0,_10=0,len=_c.length;
var _11=0;
while(i<len){
if(_11>=_d){
return _c.substring(0,_10)+_e;
}
var _12=_c.charCodeAt(i);
if(_12<_f[0][0]){
_11+=_f[0][1];
}else{
if(_12<_f[1][0]){
_11+=_f[1][1];
}else{
if(_12<_f[2][0]){
_11+=_f[2][1];
}else{
if(i<_f[3][0]){
if(i+1<len){
var b=_c.charCodeAt(i+1);
if(b>=_f[3][2]&&b<=_f[3][3]){
_11+=_f[3][1];
i++;
}else{
_11+=_f[3][4];
}
}else{
_11+=_f[3][4];
}
}
}
}
}
i++;
if(_11==_d){
return _c.substring(0,i)+_e;
}else{
if(_11>_d){
return _c.substring(0,_10)+_e;
}
}
_10=i;
}
return _c;
},getByteLength:function(str){
var _13=lconn.core.util.text.CODE_MAP;
var i=0,len=str.length;
var _14=0;
while(i<len){
var _15=str.charCodeAt(i);
if(_15<_13[0][0]){
_14+=_13[0][1];
}else{
if(_15<_13[1][0]){
_14+=_13[1][1];
}else{
if(_15<_13[2][0]){
_14+=_13[2][1];
}else{
if(i<_13[3][0]){
if(i+1<len){
var b=str.charCodeAt(i+1);
if(b>=_13[3][2]&&b<=_13[3][3]){
_14+=_13[3][1];
i++;
}else{
_14+=_13[3][4];
}
}else{
_14+=_13[3][4];
}
}
}
}
}
i++;
}
return _14;
},possessive:function(s){
if(s&&s[s.length-1]!="s"){
s+="'s";
}else{
s+="'";
}
return s;
},getExtension:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf(".");
if(i!=-1){
return s.substring(i+1).toLowerCase();
}
return "";
},trimExtension:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf(".");
if(i!=-1){
return s.substring(0,i);
}
return s;
},getFilename:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf("\\");
var j=s.lastIndexOf("/");
if(i==j){
return s;
}
i=Math.max(i,j);
return s.substring(i+1);
},trimToLength:function(s,_16,_17){
if(!s){
return "";
}
s=lconn.core.util.text.trimEnd(s);
var _18="...";
if(_17>0){
var _19=s.split(/[\s\u3000]/);
for(var i=0;i<_19.length;i++){
if(_19[i].length>_17){
var l=s.indexOf(_19[i])+_17;
if(l>_16){
break;
}
return lconn.core.util.text.trimEnd(s.substring(0,l-_18.length))+_18;
}
}
}
if(s.length>_16){
s=lconn.core.util.text.trimEnd(s.substring(0,_16-_18.length))+_18;
}
return s;
},trim:function(s){
if(!s){
return "";
}
var e=/^[\s\u3000]*(.*?)[\s\u3000]*$/.exec(s+"");
return e?e[1]:s;
},trimEnd:function(s){
if(!s){
return "";
}
s+="";
s=/^(.*?)[\s\u3000]*$/.exec(s)[1];
return s;
},parseInt:function(s,def){
if(typeof def=="undefined"){
def=0;
}
if(!s){
return def;
}
var a=parseInt(s);
return isNaN(a)?def:a;
},parseFloat:function(s,def){
if(typeof def=="undefined"){
def=0;
}
if(!s){
return def;
}
var a=parseFloat(s);
return isNaN(a)?def:a;
},formatSize:function(){
var nls,_1a;
if(arguments.length==2){
nls=arguments[0];
_1a=arguments[1];
}else{
_1a=arguments[0];
}
if(_1a===undefined||_1a===null||typeof _1a=="string"){
return _1a;
}
var nls=nls||lconn.core.util.text._SIZE;
if(!nls){
throw "Must pass nls to formatSize or set the lconn.core.util.text._SIZE property during init";
}
if(_1a>10*_b&&nls.TB){
return dojo.string.substitute(nls.TB,[dojo.number.format(Math.floor(_1a*10/_b)/10)]);
}else{
if(_1a>=1*_b&&nls.TB){
return dojo.string.substitute(nls.TB,[dojo.number.format(Math.floor(_1a*100/_b)/100)]);
}else{
if(_1a>10*_a){
return dojo.string.substitute(nls.GB,[dojo.number.format(Math.floor(_1a*10/_a)/10)]);
}else{
if(_1a>=1*_a){
return dojo.string.substitute(nls.GB,[dojo.number.format(Math.floor(_1a*100/_a)/100)]);
}else{
if(_1a>100*_9){
return dojo.string.substitute(nls.MB,[dojo.number.format(Math.floor(_1a/_9))]);
}else{
if(_1a>10*_9){
return dojo.string.substitute(nls.MB,[dojo.number.format(Math.floor(_1a*10/_9)/10)]);
}else{
if(_1a>=1*_9){
return dojo.string.substitute(nls.MB,[dojo.number.format(Math.floor(_1a*100/_9)/100)]);
}else{
if(_1a>1*1024){
return dojo.string.substitute(nls.KB,[dojo.number.format(Math.floor(_1a/1024))]);
}
}
}
}
}
}
}
}
return dojo.string.substitute(nls.KB,[dojo.number.format(_1a>0?1:0)]);
},length:function(s){
var ret=0;
var t=encodeURIComponent(s);
var _1b=0,_1c=0;
while(true){
_1c=t.indexOf("%",_1b);
if(_1c==-1){
ret+=(t.length-_1b);
break;
}else{
ret+=(_1c-_1b);
var _1d=parseInt(t.substr(_1c+1,2),16);
if(_1d<192){
ret+=1;
_1b=_1c+3;
}else{
if(_1d>=192&&_1d<224){
ret+=1;
_1b=_1c+6;
}else{
if(_1d>=224&&_1d<240){
ret+=1;
_1b=_1c+9;
}else{
if(_1d>=240&&_1d<248){
ret+=1;
_1b=_1c+12;
}else{
if(_1d>=248&&_1d<252){
ret+=1;
_1b=_1c+15;
}else{
if(_1d>=252){
ret+=1;
_1b=_1c+18;
}
}
}
}
}
}
}
}
return ret;
},lengthUtf8:function(s){
var _1e=0;
var _1f=s.length;
for(var i=0;i<_1f;i++){
var c=s.charCodeAt(i);
if(c<=127){
_1e++;
}else{
if(c<=2047){
_1e+=2;
}else{
if(c<=65535){
_1e+=3;
if((c>>11)==27){
_1e++;
i++;
}
}else{
_1e+=4;
}
}
}
}
return _1e;
},getCharIndexForUtf8Index:function(s,max){
var _20=0;
var _21=s.length;
for(var i=0;i<_21;i++){
var c=s.charCodeAt(i);
if(c<=127){
_20++;
}else{
if(c<=2047){
_20+=2;
}else{
if(c<=65535){
_20+=3;
if((c>>11)==27){
_20++;
i++;
}
}else{
_20+=4;
}
}
}
if(_20>max){
return i;
}
}
return -1;
},encodeHeaderUtf8:function(s){
return "=?UTF-8?Q?"+encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,"=$1")+"?=";
},uniquifyStringList:function(_22){
var _23={},_24=[];
if(_22&&_22.length>0){
for(var s in _22){
_23[s]=1;
}
for(var s in _23){
_24.push(s);
}
}
return _24;
},htmlify:function(str,_25){
var _26;
str=str.replace(_3,"<br>");
if(dojo.isIE==8){
while(str.indexOf("\\n")>-1){
str=str.replace("\\n","<BR>");
}
}
str=str.replace(_2,function(url){
var _27=_1.getProfileUrl("","");
if(url.indexOf(_27)==-1){
return "<a href=\""+url+"\">"+url+"</a>";
}
return url;
});
if(_25){
str=str.replace(_4," &nbsp;");
}
str=this.htmlifyMentions(str);
return str;
},htmlifyMentions:function(str){
var _28;
dojo.forEach([_5,_6],function(_29){
while(_28=_29.exec(str)){
var u=_28[0],_2a,_2b,_2c,_2d=true;
if(_29==_5){
_2d=!!_28[3];
_2c=_28[2];
_2a=_2d?"@"+_2c:_2c,_2b=_28[1];
}else{
_2a=_28[1];
_2d=_2a.indexOf("@")==0;
_2c=_2d?_2a.substring(1,_2a.length):_2a;
_2b=_28[2];
}
var _2e=com.ibm.lconn.layout.people.getProfileUrl({name:_2c,userid:_2b});
var l=dojo.string.substitute(dojo.cache("lconn.core","templates/bizcard.html"),{url:_2e,name:_2a,userid:_2b,displayName:_2c,hasSymbol:_2d});
if(dojo.config.isDebug){
l=dojo.trim(l.replace(/<!--[\s\S]*?-->/g,""));
}
_29.lastIndex+=l.length-u.length;
str=str.replace(u,l);
}
});
return str;
}};
})(com.ibm.lconn.layout.people);
}


;dojo.cache("lconn.core", "templates/ComboBox.html", "<span> <input type=\"text\" autocomplete=\"off\" ${nameAttrSetting} id=\"widget_${id}\" size=\"${size}\" dojoAttachEvent=\"onkeyup:_onKeyUp\" dojoAttachPoint=\"domNode,textbox,focusNode,comboNode,_popupStateNode\" waiRole=\"combobox\" waiState=\"haspopup-true,autocomplete-list,expanded-false\" /> <span style=\"display:none\" dojoAttachPoint=\"_buttonNode\"></span></span>");

;if(!dojo._hasResource["lconn.core.TypeAhead"]){
dojo._hasResource["lconn.core.TypeAhead"]=true;
dojo.provide("lconn.core.TypeAhead");










dojo.declare("lconn.core.TypeAhead",[dijit.form.ComboBox,lconn.core.TypeAheadFormatMixin],{size:"",templateString:null,templatePath:dojo.moduleUrl("lconn.core","templates/ComboBox.html"),getItem:function(){
return (this.item?this.item:null);
},minChars:1,maxChars:-1,multipleValues:true,token:"",hintText:null,lastSearch:null,autoComplete:false,submitFormOnKey:false,submitFormOnNonSelectingEnter:false,searchDelay:300,postCreate:function(){
this.connect(this,"_showResultList",this._fixPosition);
var _1=this.focusNode.style.fontFamily||"";
if(!this.downArrowNode){
this.downArrowNode=this.domNode.parentNode.appendChild(dojo.create("div",{style:{display:"none"}}));
}
this.dummyPopupNode=this.domNode.parentNode.appendChild(dojo.create("div",{id:this.id+"_dummypopup",style:{display:"none"}}));
dojo.attr(this.dummyPopupNode,"role","textbox");
dijit.setWaiState(this.domNode,"owns",this.dummyPopupNode.id);
this.inherited(arguments);
this.focusNode.style.fontFamily=_1;
this.updateHintText();
this.focusNode.style.direction=lconn.core.globalization.bidiUtil.getTextDirection(this.focusNode.value);
},_onFocus:function(_2){
this.updateHintText(null,true);
this.inherited(arguments);
if(dojo.isIE){
window.setTimeout("dijit.focus(dojo.byId('"+this.textbox.id+"'))",0);
}
},_trimKeys:function(){
if(this.maxChars>0){
var fn=this.focusNode;
var _3=((this.multipleValues)?fn.value.split(this.token):[fn.value]);
var _4=false;
for(var i=0;i<_3.length;i++){
if(lconn.core.util.text.getByteLength(_3[i])>this.maxChars){
var _5=_3[i];
_3[i]=lconn.core.util.text.trimToByteLength(_3[i],this.maxChars);
_4=true;
if(window.console){
console.log("lconn.core.TypeAhead key too long. Trimming '"+_5+"' to '"+_3[i]+"'.");
}
}
}
if(_4){
fn.value=_3.join((this.multipleValues)?this.token:"");
}
}
},_onBlur:function(_6){
this._trimKeys();
this.inherited(arguments);
if(dojo.isIE&&this.dropdownNode){
dojo.removeClass(this.dropdownNode,"lconnTypeAhead");
}
this.updateHintText();
},_hasAttr:function(_7,_8){
return dojo.isIE?_7.getAttribute(_8)!==null:_7.hasAttribute(_8);
},setValue:function(){
this.inherited(arguments);
this.updateHintText(arguments[0],false);
},updateHintText:function(_9,_a){
var _b=this.focusNode;
if(_9){
_b.title=this.hintText=_9;
}
if(this.hintText){
if(!this._focused&&(_b.value==""||!_b.hasInput)){
_b.hasInput=false;
_b.style.color="#666";
_b.value=this.hintText||"";
}else{
if(!_b.hasInput){
_b.hasInput=true;
_b.style.color="#000";
if(_b.value!=""){
_b.value="";
if(_a&&dojo.isFF){
setTimeout(function(){
dijit.focus(_b);
},1);
}
}
if(_a&&dojo.isIE){
try{
dijit.selectInputText(_b,0,0);
}
catch(e){
}
}
}
}
}
},_checkKeyLength:function(_c){
try{
if(this.maxChars>0){
var _d=this;
var _e=function(_f){
var k=_f.charOrCode;
var tk=_d.token;
if(_d.multipleValues&&tk.length==1&&tk==k){
return true;
}
var dk=dojo.keys;
for(dkname in dk){
if(dk[dkname]){
if(dkname!=="SPACE"&&dkname.indexOf("NUMPAD_")==-1&&k==dk[dkname]){
return true;
}
}
}
return false;
};
var _10=function(){
var fn=_d.focusNode;
var tk=_d.token;
var _11=_d._getCaretPos(_d.focusNode);
var _12=_d.getTextBoxValue();
if(_d.multipleValues&&tk.length>0){
_12=tk+_12+tk;
_12=_12.substring(0,_12.indexOf(tk,_11+tk.length));
_12=_12.substring(_12.lastIndexOf(tk)+tk.length);
}
return _12;
};
if(_e(_c)||lconn.core.util.text.getByteLength(_10())<this.maxChars){
return true;
}
if(_c.preventDefault){
_c.preventDefault();
}else{
_c.returnValue=false;
}
return false;
}
}
catch(e){
}
return true;
},_onKeyUp:function(evt){
this.inherited(arguments);
if(this.get("displayedValue").length<2){
this.lastSearch=null;
}
lconn.core.globalization.bidiUtil.inputRTLProcessing(this.textbox);
},_onKeyPress:function(_13){
},_onKey:function(evt){
if(!this._checkKeyLength(evt)){
return;
}
this.inherited(arguments);
if(evt.keyCode===dojo.keys.ENTER){
dijit.focus(this.domNode);
if(this.submitFormOnNonSelectingEnter){
if(this.searchTimer){
this.searchTimer.remove();
this.searchTimer=null;
}
this._lastQuery=null;
if(this._opened&&this._hideResultList){
this._hideResultList();
}
if(this._trimKeys){
this._trimKeys();
}
}else{
if(!this.submitFormOnKey){
dojo.stopEvent(evt);
}
}
}
},_numTokensPreceding:function(str,pos){
var _14=str.substring(0,pos);
var _15=_14.split(this.token).length-1;
return _15;
},_splitByToken:function _splitByToken(str){
var _16=[str];
if(this.token&&str.indexOf(this.token)!=-1){
str=str.replace(new RegExp(this.token+"+","g"),this.token);
str=str.replace(new RegExp("^"+this.token),"");
str=str.replace(new RegExp(this.token+"$"),"");
_16=str.split(this.token);
}
return _16;
},_autoCompleteText:function(_17){
var fn=this.focusNode;
var _18=this._getCaretPos(fn);
dijit.selectInputText(fn,fn.value.length);
var _19;
if(this.multipleValues){
_19=fn.value.split(this.token);
}else{
_19=[fn.value];
}
var _1a=0;
if(this.multipleValues){
_1a=this._numTokensPreceding(fn.value,_18);
}
if(this.multipleValues&&this.token!=" "&&_1a>0){
_17=" "+_17;
}
var _1b=this.ignoreCase?"toLowerCase":"substr";
if(dojo.string.trim(_17[_1b](0)).indexOf(dojo.string.trim(_19[_1a][_1b](0)))==0){
if(_18+1>fn.value.length||fn.value.charAt(_18)==this.token){
var end=_18+_17.length-_19[_1a].length;
if(_17!=this.NoResultsMessage&&_17!=this.searchDirectory&&_17.indexOf("**")==-1){
_19[_1a]=_17;
fn.value=_19.join(this.token);
dijit.selectInputText(fn,_18,end);
}else{
fn.value=this._currentInput;
}
}
}else{
if(_17!=this.NoResultsMessage&&_17!=this.searchDirectory&&_17.indexOf("**")==-1){
_19[_1a]=_17;
fn.value=_19.join(this.token);
var _1c=0;
for(var i=0;i<_1a;i++){
_1c+=_19[i].length;
}
_1c+=this.token.length*_1a;
dijit.selectInputText(fn,_1c,_1c+_17.length);
}else{
fn.value=this._currentInput;
}
}
},_openResultList:function(_1d,_1e){
this._fetchHandle=null;
if(!this.domNode||this.disabled||this.readOnly||(_1e.query!=this._lastQuery)){
return;
}
this._popupWidget.clearResultList();
if(!_1d.length&&(this.hideEmptyResults||_1e.hideEmptyResults)){
this._hideResultList();
return;
}
_1e._maxOptions=this._maxOptions;
var _1f=this._popupWidget.createOptions(_1d,_1e,dojo.hitch(this,"_getMenuLabelFromItem"));
this.results=_1d;
this._showResultList();
if(_1e.direction){
if(1==_1e.direction){
this._popupWidget.highlightFirstOption();
}else{
if(-1==_1e.direction){
this._popupWidget.highlightLastOption();
}
}
this._announceOption(this._popupWidget.getHighlightedOption());
}else{
if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_1e.query[this.searchAttr])){
this._announceOption(_1f[1]);
}
}
},_showResultList:function(){
this.inherited(arguments);
var fn=this.focusNode;
var pw=this._popupWidget;
dojo.style(pw.domNode,{"width":"auto"});
dojo.style(pw.domNode,{"width":(pw.domNode.offsetWidth+2)+"px"});
if(fn.offsetWidth>pw.domNode.offsetWidth){
dojo.style(pw.domNode,{"width":(fn.offsetWidth+"px")});
}
if(this._opened&&pw&&pw.id&&!dijit.getWaiState(fn,"activedescendant")){
dijit.setWaiState(fn,"activedescendant",pw.id);
}
if(dojo.isIE){
dojo.addClass(pw.domNode.parentNode,"lconnTypeAhead");
this.dropdownNode=pw.domNode.parentNode;
}
},_fixPosition:function(){
var _20=this.focusNode;
if(_20){
var _21=this._popupWidget.domNode;
var _22=dojo.position(_21,true);
var _23=dijit.getViewport().w;
if(_22.x+_21.parentNode.clientWidth>_23){
dojo.style(_21.parentNode,{left:(_23-_21.parentNode.clientWidth)+"px"});
}
}
dojo.publish("com/ibm/social/incontext/typeahead/onDisplayChange",[this._popupWidget]);
},_announceOption:function(_24){
if(!_24){
return;
}
var _25=this._getCaretPos(this.focusNode);
var _26;
if(_24==this._popupWidget.nextButton||_24==this._popupWidget.previousButton||_24==this._popupWidget.searchButton||_24==this._popupWidget.resultsNode){
_26=_24.innerHTML;
this.item=undefined;
this.value="";
}else{
var _27=this.dropDown.items[_24.getAttribute("item")];
_26=this.formatItem(_27);
if(!this.multipleValues){
this.attr("item",_27,false,_26);
}
}
if(this.multipleValues){
_25=_25||this.caretPos||this.focusNode.value.length;
var _28=this.focusNode.value;
if(this._currentInput){
_28=this._currentInput;
}
var _29=_28.split(this.token);
var _2a=this._numTokensPreceding(_28,_25);
var q=this._lastQuery;
if(this.multipleValues&&this.token!=" "&&_2a>0){
q=" "+q;
}
_29[_2a]=q;
this.focusNode.value=_29.join(this.token);
}else{
this.focusNode.value=this.focusNode.value.substring(0,_25);
}
this._setCaretPos(this.focusNode,_25);
dijit.setWaiState(this.focusNode,"activedescendant",dojo.attr(_24,"id"));
if(_24!=this._popupWidget.resultsNode){
this._autoCompleteText(_26);
}
},_selectOption:function(_2b){
if(!this.noUpdateOnSelect){
this._announceOption(_2b);
}
this._hideResultList();
this._setCaretPos(this.focusNode,this.focusNode.value.length);
this.onSelect(this.dropDown.items[_2b.getAttribute("item")]);
this._handleOnChange(this.value,true);
if(this.focusNode){
this.focusNode.removeAttribute("aria-activedescendant");
}
this.lastSearch=null;
},onSelect:function(_2c){
},_doSelect:function(tgt){
var _2d=this.formatItem(tgt.item);
if(this.multipleValues){
var _2e=this.keyArr[this.keyIdx];
this.keyArr[this.keyIdx]=(this.keyIdx!=0&&this.token!=" "?" ":"")+_2d;
_2d=this.keyArr.join(this.token);
var _2f=this.token+(this.token!=" "?" ":"");
if(_2d.length>=_2f.length&&_2d.substring(_2d.length-_2f.length)!=_2f){
_2d+=_2f;
}
}else{
this.item=tgt.item;
}
this.attr("value",_2d);
this._setCaretPos(this.focusNode,_2d.length);
},_startSearchAll:function(){
this._startSearch("");
},_startSearchFromInput:function(){
var _30=this._currentInput=this.focusNode.value;
var _31=_30;
if(this.multipleValues){
this.keyArr=_30.split(this.token);
this.caretPos=this._getCaretPos(this.focusNode);
this.keyIdx=this._numTokensPreceding(_30,this.caretPos);
_31=this.keyArr[this.keyIdx];
}
_31=dojo.string.trim(_31);
if(this.shouldStartSearch(_31)){
if(_31!=this.lastSearch){
this._startSearch(_31);
this.lastSearch=_31;
}
}else{
this._hideResultList();
}
},_hideResultList:function(){
this.closeDropDown();
},shouldStartSearch:function(_32){
var _33;
if(this.store&&this.store.shouldStartSearch){
_33=this.store.shouldStartSearch(_32);
}
if(typeof _33=="undefined"){
var _34=this.minChars;
if(_32.length>=_34){
return true;
}
var _35=0;
var _36=encodeURIComponent(_32);
for(var i=0;i<_36.length;i++){
_35++;
if(_35>=_34){
break;
}
if(_36.charAt(i)=="%"){
i+=2;
}
}
_33=_35>=_34;
}
return _33;
},_startSearch:function(key){
var _37=this.id+"_popup";
if(!this._popupWidget){
this._popupWidget=this.dropDown=new dijit.form._ComboBoxMenu({onChange:dojo.hitch(this,this._selectOption),id:_37});
dijit.setWaiRole(this._popupWidget.domNode,"listbox");
dijit.setWaiState(this._popupWidget.domNode,"live","polite");
this._popupWidget.domNode.style.listStyleType="none";
dijit.removeWaiState(this.focusNode,"activedescendant");
dijit.setWaiState(this.textbox,"owns",_37);
dojo.addClass(this._popupWidget.domNode,"lconnHighlight");
}else{
dijit.setWaiState(this.focusNode,"activedescendant",_37);
}
var _38=dojo.clone(this.query);
this._lastInput=key;
this._lastQuery=_38=key;
this.searchTimer=this.defer(dojo.hitch(this,function(_39,_3a){
this.searchTimer=null;
var _3b={queryOptions:{ignoreCase:this.ignoreCase,deep:true},query:_39,onComplete:dojo.hitch(this,"_openResultList"),onError:function(_3c){
_3a._fetchHandle=null;
console.error("dijit.form.ComboBox: "+_3c);
dojo.hitch(_3a,"_hideResultList")();
},start:0,count:this.pageSize};
dojo.mixin(_3b,_3a.fetchProperties);
this._fetchHandle=_3a.store.fetch(_3b);
var _3d=function(_3e,_3f){
_3e.start+=_3e.count*_3f;
_3e.direction=_3f;
this._fetchHandle=this.store.fetch(_3e);
};
this._nextSearch=this._popupWidget.onPage=dojo.hitch(this,_3d,this._fetchHandle);
},_38,this),this.searchDelay);
},getAttribute:function(_40){
if(this.item&&this.item[_40]){
return this.item[_40];
}else{
return "";
}
},getTextBoxValue:function(){
return this.focusNode.value;
}});
}


;if(!dojo._hasResource["lconn.core.TypeAheadDataStore"]){
dojo._hasResource["lconn.core.TypeAheadDataStore"]=true;
dojo.provide("lconn.core.TypeAheadDataStore");
dojo.declare("lconn.core.TypeAheadDataStore",null,{constructor:function(_1,_2){
this.queryParam=(_1.queryParam?_1.queryParam:_2.getAttribute("queryParam"));
this.url=(_1.url?_1.url:_2.getAttribute("url"));
},queryParam:"",maxQueryLength:255,cache:[],timeout:5000,clear:function(){
this.cache=[];
},fetch:function(_3){
var _4={};
this.searchDirectory=(_3.queryOptions.searchDirectory?true:false);
if(typeof this.cache[_3.query.toLowerCase()]=="object"){
_3.onComplete(this.cache[_3.query.toLowerCase()],_3);
return _3;
}
if(this.queryParam){
if(this.getUTF8Length(_3.query)>this.maxQueryLength){
var _5=this.getUTF8Substring(_3.query);
_4[this.queryParam]=_5;
}else{
_4[this.queryParam]=_3.query;
}
}
dojo.xhrGet({url:this.url,content:_4,handleAs:"json",timeout:this.timeout,load:dojo.hitch(this,function(_6){
this.cache[_3.query.toLowerCase()]=_6;
if(_3.onComplete){
_3.onComplete(_6,_3);
}
}),error:function(){
console.log("There was an error");
}});
return _3;
},getUTF8Length:function(_7){
var _8=0;
if(_7!=null){
for(var i=0;i<_7.length;i++){
var c=_7.charCodeAt(i);
if(c<127){
_8+=1;
}else{
if((128<=c)&&(c<=2047)){
_8+=2;
}else{
if((2048<=c)&&(c<=65535)){
_8+=3;
}
}
}
}
}
return _8;
},getUTF8Substring:function(_9){
var _a=_9;
var i=0;
while(this.getUTF8Length(_a)>this.maxQueryLength){
_a=_9.substring(0,_9.length-i);
i++;
}
return _a;
},getValue:function(_b,_c,_d){
return _b;
}});
}


;if(!dojo._hasResource["lconn.core.theme"]){
dojo._hasResource["lconn.core.theme"]=true;
(function(){
dojo.provide("lconn.core.theme");








var _1,_2,_3,_4,_5,_6,_7,_8;
var _9="_css_url_rewriter";
window[_9]=typeof window[_9]==="function"?window[_9]:function(_a){
return _a;
};
var _b="lotusBaseStylesheet",_c="lotusAppStylesheet",_d="lotusThemeStylesheet",_e="lotusSpritesStylesheet",_f="stylesheet";
var _10="com.ibm.lconn.core.web.styles.theme.default",_11="default",_12="hikari",_13="gen4";
function _14(){
return lconn.core.config.features("hikari-default-theme")?_12:(lconn.core.config.properties[_10]||_13);
};
function _15(){
var _16=dojo.byId(_b),_17=dojo.byId(_d),_18=dojo.byId(_e),_19=dojo.byId(_c);
if(!_5&&_16){
_7=dojo.attr(_16,"base")||dojo.attr(_16,"href").substr(0,dojo.attr(_16,"href").indexOf("_style"));
_5=new com.ibm.oneui.util.Url(_7);
_5.query=dojo.attr(_16,"query")||(_17?dojo.attr(_17,"href").substr(dojo.attr(_17,"href").indexOf("?")):"");
_4=_5.path;
_6=_1=dojo.attr(_16,"theme")||_14();
_2=dojo.attr(_16,"defaultTheme")||_1;
_3=dojo.attr(_16,"appName")||dojo.getObject("ibmConfig.serviceName");
_7+="com.ibm.lconn.core.styles.oneui"+(dojo.attr(_16,"oneui")||3)+"/";
_8="?etag="+encodeURIComponent(_5.getQuery().etag);
}
return {baseLink:_16,themeLink:_17,spritesLink:_18,appLink:_19};
};
function _1a(_1b){
if(_1b){
_1b.id="";
setTimeout(function(){
var _1c=_1b.parentNode;
if(_1c){
_1c.removeChild(_1b);
}
},1);
}
return _1b;
};
function _1d(){
return !dojo._isBodyLtr();
};
function _1e(){
return lconn.core.url.getServiceUrl(lconn.core.config.services.webresources);
};
function _1f(_20){
if(_20){
var _21={};
if(dojo.config.isDebug){
_21.debug=true;
}else{
_21.etag=encodeURIComponent(dojo.getObject("ibmConfig.versionStamp"));
}
_20=new com.ibm.oneui.util.Url(lconn.core.url.rewrite(_20,_21));
}
return window[_9](_20);
};
var _22=0;
function seq(){
return _22++;
};
function _23(_24,_25){
if(dojo.isIE>=9){
return document.createStyleSheet(_25.toString()).owningElement;
}else{
s=_24.cloneNode(true);
s.href=_25.toString();
return s;
}
};
dojo.mixin(lconn.core.theme,{addBaseStylesheet:function(){
_15();
if(!dojo.byId(_b)){
var _26=_1f(_1e()+"/web/_style?include=com.ibm.lconn.core.styles.oneui3/base/package3.css");
if(!dojo.config.isDebug){
_26.query+="&etag="+encodeURIComponent(dojo.getObject("ibmConfig.versionStamp"));
}
var _27=dojo.create("link",{id:_b,rel:_f,path:_26.path,query:_26.query,href:_26.toString()},dojo.query("head")[0]);
}
return this;
},addThemeStylesheet:function(_28){
_15();
_28=_28||_6;
if(!dojo.byId(_d)){
var _29=_1f(_1e()+"/web/_lconntheme/"+encodeURIComponent(_28)+".css?version=oneui3&rtl="+_1d());
var _2a=dojo.create("link",{id:_d,rel:_f,path:_29.path,query:_29.query,href:_29.toString()},dojo.query("head")[0]);
}else{
console.warn("Theme stylesheet '%s' already included in this page",_6);
}
return this;
},addAppStylesheet:function(_2b,_2c){
_15();
_2b=_2b||_3;
_2c=_2c||_6;
if(!dojo.byId(_c)){
var _2d=_1f(_1e()+"/web/_lconnappstyles/"+encodeURIComponent(_2c)+"/"+encodeURIComponent(_2b)+".css?version=oneui3&rtl="+_1d());
var _2e=dojo.create("link",{id:_c,rel:_f,path:_2d.path,query:_2d.query,href:_2d.toString()},dojo.query("head")[0]);
}else{
console.warn("Application stylesheet '%s' with theme '%s' already included in this page",_3,_6);
}
return this;
},addStylesheet:function(_2f,_30){
if(!_2f){
return;
}
_15();
_30=_30||_6;
if(1){
var _31=_1f(_1e()+"/web/_lconnappstyles/"+encodeURIComponent(_30)+"/"+encodeURIComponent(_2f)+".css?version=oneui3&rtl="+_1d());
var _32=dojo.create("link",{id:"lotusStylesheet_"+seq(),rel:_f,path:_31.path,query:_31.query,href:_31.toString()},dojo.query("head")[0]);
}
return this;
},addAllStylesheets:function(_33,_34){
this.addBaseStylesheet().addThemeStylesheet(_34).addAppStylesheet(_33,_34);
},getUrl:function(_35){
_15();
return _1f(_7+_35);
},switchTheme:function(_36,_37){
var _38=_15(),_39=_38.baseLink,_3a=_38.spritesLink;
if(!_36){
_36=_1;
}
if(_36===_11&&!_37){
_36=_14();
}
if(_36==_6||!_39){
return;
}
_6=_36;
var _3b=encodeURIComponent(_36);
if(_36){
_1a(dojo.byId(_d));
_5.path=_4+"_lconntheme/"+_3b+".css";
themeLink=_23(_39,_5);
themeLink.id=_d;
dojo.place(themeLink,_3a,"after");
if(_3){
_1a(dojo.byId(_c));
_5.path=_4+"_lconnappstyles/"+_3b+"/"+encodeURIComponent(_3)+".css";
appLink=_23(_39,_5);
appLink.id=_c;
dojo.place(appLink,themeLink,"after");
}
}
},getCurrentThemeId:function(){
_15();
return _6;
}});
})();
}


;if(!dojo._hasResource["lotuslive.widgets.theme"]){
dojo._hasResource["lotuslive.widgets.theme"]=true;
dojo.provide("lotuslive.widgets.theme");


(function(_1,_2){
var _3=lconn.core.theme,_4=_3.addStylesheet,_5=_3.getCurrentThemeId;
if(_2.getElementById("lotusThemeStylesheet")){
var _6=_2.getElementById("lotusThemeStylesheet");
_6.outerHTML="";
delete _6;
}
if(_2.getElementById("lotusAppStylesheet")){
var _6=_2.getElementById("lotusAppStylesheet");
_6.outerHTML="";
delete _6;
}
_3.addStylesheet=function(_7,_8){
if(_7==="activityStream"&&!_8){
if(typeof gllConnectionsData!=="undefined"){
var _9="/theming/theme/onprem/3/"+gllConnectionsData.userId+"/theming/"+gllConnectionsData.appName,_a=_2.getElementsByTagName("head")[0],_b=_2.createElement("link");
if(typeof (lconn)!="undefined"&&typeof (lconn.core)!="undefined"&&typeof (lconn.core.config)!="undefined"){
_9=_9+"/"+lconn.core.config.versionStamp;
}else{
_9=_9+"/null";
}
_b.type="text/css";
_b.rel="stylesheet";
_b.href=_9+"/"+_7;
if(_a.querySelectorAll("link[href*=onprem]").length>0){
_a.appendChild(_b);
}else{
dojo.subscribe("loadTheming",function(){
_a.appendChild(_b);
});
}
}
return;
}
_4.apply(this,arguments);
return this;
};
_3.getCurrentThemeId=function(){
var _c=dojo.cookie("themeId");
return _c?_c:_5.apply(this,arguments);
};
})(window,document);
}


;if(!dojo._hasResource["lconn.core.widget.MenuLauncher"]){
dojo._hasResource["lconn.core.widget.MenuLauncher"]=true;
dojo.provide("lconn.core.widget.MenuLauncher");


dojo.declare("lconn.core.widget.MenuLauncher",dijit._Widget,{hideDelay:1000,openDelay:0,preloadDelay:0,classActive:"lotusHover",activeParent:0,activateOnFocus:false,activateOnMouseOver:true,widthAdjust:0,orient:{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"},orientRTL:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"},buildRendering:function(){
this.domNode=this.popupStateNode=this.srcNodeRef;
var _1=this.activateOnMouseOver;
if(this.domNode.tagName==="LI"){
var _2=dojo.query(">a",this.domNode)[0];
if(_2&&!_2.onmouseover){
_1=false;
}
}
if(_1){
this.connect(this,"onMouseEnter","_delayOpen");
}
this.connect(this,"onMouseEnter","_delayOpen");
this.connect(this,"onMouseLeave","_delayClose");
if(this.activateOnFocus){
this.connect(this,"onFocus","_delayOpen");
this.connect(this,"onBlur","_closeMenu");
}else{
this.connect(this,"onClick","_onClick");
}
this.menuId=this.menuId||dojo.attr(this.domNode,"aria-owns")||dojo.attr(this.domNode,"aria-describedby")||(this.id?(this.id+"_popup"):dijit.getUniqueId("ml"));
this.externalContent=dojo.attr(this.domNode,"external-content");
delete this.srcNodeRef;
},decorateAria:function(){
dojo.attr(this.domNode,"aria-owns",this.menuId);
},whenInit:function(){
this.decorateAria();
var _3=this._initDfd;
if(!_3){
var _4=this._initMenu();
if(!(_4 instanceof dojo.Deferred)){
if(!this.menu){
throw "_initMenu must initialize this.menu or return a deferred";
}
_4=new dojo.Deferred();
_4.callback(this.menu);
}
_3=this._initDfd=_4;
_3.addCallback(this,"initFinal").addErrback(this,function(){
this._initDfd=null;
});
}
return _3;
},initFinal:function(){
var _5=this.menu;
_5._launcher=this;
dijit.popup.moveOffScreen(_5.domNode);
var _6=document.createElement("span");
_6.style.display="none";
dojo.attr(_6,"widgetId",_5.id);
dojo.body().appendChild(_6);
var _7=this.domNode;
for(var i=0;i<this.activeParent;i++){
_7=_7.parentNode;
}
this.activeNode=_7;
if(this.externalContent){
var _8=dijit.byId(this.externalContent);
this.connect(_8,"onMouseEnter","_openMenu");
this.connect(_8,"onMouseLeave","_delayClose");
this.connect(_8,"onClose","_closeMenu");
dojo.connect(this,"onOpen",dojo.hitch(this,function(){
dojo.style(this.menu.domNode,{padding:0});
var _9=dojo.position(dojo.byId(_8.bindto),true);
dojo.style(_8.domNode,{top:_9.y+"px",left:_9.x+"px",height:_9.h+"px",width:_9.w+"px",zIndex:2000});
_8.show(arguments);
}));
dojo.connect(this,"onClose",function(){
_8.hide();
});
}
this.connect(_5,"onMouseEnter","_openMenu");
this.connect(_5,"onMouseLeave","_delayClose");
},_initMenu:function(){
throw "Must override initMenu() to do dynamic loading";
},_onClick:function(e){
if(e){
dojo.stopEvent(e);
}
this._openMenu("click");
},_preloadMenu:function(){
this.whenInit().addCallback(this,function(){
var _a=this.menu;
var _b=dojo.getObject("dijit.layout.ContentPane");
if(_a._preload){
_a._preload();
}else{
if(_b&&_a instanceof _b){
if(_a.isLoaded||_a.isFailed||_a._xhrDfd){
return;
}
_a._load();
}
}
});
},_openMenu:function(_c){
this._shouldBeOpen=true;
this.whenInit().addCallback(this,function(){
if((!this._opened&&this._closing)||!this._shouldBeOpen){
return;
}
if(typeof _c!="string"){
_c=null;
}
this._delayEnd();
var _d=this.menu;
if(!_d){
return;
}
if(!this._opened){
if(_d.href&&!(_d.isLoaded||_d.isFailed)){
var _e=this;
var _f=dojo.connect(_d,"onLoad",function(){
dojo.disconnect(_f);
_e._openFinal(_c);
});
var _10=dojo.connect(_d,"onDownloadError",function(){
dojo.disconnect(_10);
_e._openFinal(_c);
});
this._preloadMenu();
return;
}else{
this._openFinal(_c);
}
}else{
this.onOpen(_c);
}
});
},_openFinal:function(_11){
if(!this._shouldBeOpen){
return;
}
if(typeof _11!="string"){
_11=null;
}
var _12=this.menu;
var _13=_12.domNode.style.width;
var _14=this;
if(lconn.core.widget.MenuLauncher._menu){
dijit.popup.close(lconn.core.widget.MenuLauncher._menu);
}
if(this.onBeforeOpen(_11)===true){
return;
}
dojo.addClass(this.activeNode,this.classActive);
dijit.popup.open({parent:this,popup:_12,around:this.domNode,orient:this.getOrient(),onExecute:function(){
_14._closeMenu(true);
},onCancel:function(){
_14._closeMenu(true);
},onClose:function(){
_14._delayEnd();
lconn.core.widget.MenuLauncher._menu=null;
_12.domNode.style.width=_13;
dijit.setWaiState(_12.domNode,"hidden","true");
if(_14.domNode){
dojo.removeClass(_14.activeNode,_14.classActive);
}
_14._opened=false;
_14.onClose();
}});
lconn.core.widget.MenuLauncher._menu=_12;
this._opened=true;
this.onOpen(_11);
},_closeMenu:function(_15){
this._delayEnd();
this._shouldBeOpen=false;
if(this._opened){
if(dojo.isIE){
setTimeout(dojo.hitch(this,"_closeMenuFinal",_15),0);
}else{
this._closeMenuFinal(_15);
}
}
},_closeMenuFinal:function(_16){
this._shouldBeOpen=false;
dijit.popup.close(this.menu);
if(_16){
dijit.focus(this.focusNode||this.domNode);
}
},getOrient:function(){
return this.isLeftToRight()?this.orient:this.orientRTL;
},_delayOpen:function(){
if(!this._opening){
this._delayEnd();
this._opening=setTimeout(dojo.hitch(this,"_openMenu","mouseover"),this.openDelay);
if(this.preloadDelay>0&&(!this.menu||!this.menu.isLoaded)){
this._preload=setTimeout(dojo.hitch(this,"_preloadMenu"),this.preloadDelay);
}
}
},_delayClose:function(){
if(!this._closing){
this._delayEnd();
this._closing=setTimeout(dojo.hitch(this,"_closeMenu",false),this.hideDelay);
}
},_delayEnd:function(){
try{
clearTimeout(this._opening);
}
catch(e){
}
try{
clearTimeout(this._closing);
}
catch(e){
}
try{
clearTimeout(this._preload);
}
catch(e){
}
this._closing=this._opening=this._preload=null;
},onBeforeOpen:function(_17){
return false;
},onOpen:function(_18){
if(_18=="click"&&!this.activateOnFocus){
this.focusMenu();
}
dijit.setWaiState(this.menu.domNode,"hidden","false");
},onClose:function(){
},focusMenu:function(){
var _19=this.menu;
if(_19.focus){
_19.focus();
}else{
_19._getFocusItems(_19.containerNode);
dijit.focus(_19._firstFocusItem);
}
}});
}


;define("dijit/_WidgetsInTemplateMixin",["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(_1,_2,_3,_4,_5){
return _3("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:false,widgetsInTemplate:true,contextRequire:null,_beforeFillContent:function(){
if(this.widgetsInTemplate){
var _6=this.domNode;
if(this.containerNode&&!this.searchContainerNode){
this.containerNode.stopParser=true;
}
_5.parse(_6,{noStart:!this._earlyTemplatedStartup,template:true,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(_4.hitch(this,function(_7){
this._startupWidgets=_7;
for(var i=0;i<_7.length;i++){
this._processTemplateNode(_7[i],function(n,p){
return n[p];
},function(_8,_9,_a){
if(_9 in _8){
return _8.connect(_8,_9,_a);
}else{
return _8.on(_9,_a,true);
}
});
}
if(this.containerNode&&this.containerNode.stopParser){
delete this.containerNode.stopParser;
}
}));
if(!this._startupWidgets){
throw new Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), "+"unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");
}
}
},_processTemplateNode:function(_b,_c,_d){
if(_c(_b,"dojoType")||_c(_b,"data-dojo-type")){
return true;
}
return this.inherited(arguments);
},startup:function(){
_1.forEach(this._startupWidgets,function(w){
if(w&&!w._started&&w.startup){
w.startup();
}
});
this._startupWidgets=null;
this.inherited(arguments);
}});
});


;define("dijit/_Templated",["./_WidgetBase","./_TemplatedMixin","./_WidgetsInTemplateMixin","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/kernel"],function(_1,_2,_3,_4,_5,_6,_7){
_6.extend(_1,{waiRole:"",waiState:""});
return _5("dijit._Templated",[_2,_3],{widgetsInTemplate:false,constructor:function(){
},_processNode:function(_8,_9){
var _a=this.inherited(arguments);
var _b=_9(_8,"waiRole");
if(_b){
_8.setAttribute("role",_b);
}
var _c=_9(_8,"waiState");
if(_c){
_4.forEach(_c.split(/\s*,\s*/),function(_d){
if(_d.indexOf("-")!=-1){
var _e=_d.split("-");
_8.setAttribute("aria-"+_e[0],_e[1]);
}
});
}
return _a;
}});
});

dojo.provide("com.ibm.oneui.controls.nls.MessageBox")._built=true;
dojo.provide("com.ibm.oneui.controls.nls.MessageBox.en_us");
com.ibm.oneui.controls.nls.MessageBox.en_us={"showMore":"Show More","SUCCESS":{"a11y_label":"Success:","icon_alt":"Success"},"SHARED_EXTERNAL":{"a11y_label":"Shared externally:","icon_alt":"Shared externally"},"showLess":"Show Less","ERROR":{"a11y_label":"Error:","icon_alt":"Error"},"common":{"close_btn_title":"Close","close_btn_alt":"Close"},"WARNING":{"a11y_label":"Warning:","icon_alt":"Warning"},"INFO":{"a11y_label":"Information:","icon_alt":"Information"}};

;dojo.cache("com.ibm.oneui", "controls/templates/MessageBox.html", "<div class=\"lotusMessage2\" role=\"alert\" aria-live=\"assertive\"> <img class=\"lotusIcon\" dojoAttachPoint=\"imgNode\" src=\"${_blankGif}\" alt=\"${_strings.icon_alt}\" /> <span class=\"lotusAltText\">${_strings.a11y_label}</span> <div class=\"lotusMessageBody\"><span dojoAttachPoint=\"msgBody\"></span> <a href=\"javascript:;\" class=\"${showMoreClass}\" dojoAttachPoint=\"showMoreNode\" dojoAttachEvent=\"onclick: showMoreLessClicked\">${messages.showMore}</a> <a href=\"javascript:;\" class=\"lotusHidden\" dojoAttachPoint=\"showLessNode\" dojoAttachEvent=\"onclick: showMoreLessClicked\">${messages.showLess}</a> <div dojoAttachPoint=\"showMoreMessageNode\" class=\"lotusHidden\">${msgMore}</div> </div> <a href=\"javascript:;\" class=\"lotusDelete lotusHidden\" dojoAttachPoint=\"closeBtn\" role=\"button\" title=\"${_strings.close_btn_title}\"> <img alt=\"\" src=\"${_blankGif}\" role=\"presentation\"/> <span class=\"lotusAltText\">X</span> </a></div>");

;if(!dojo._hasResource["com.ibm.oneui.controls.MessageBox"]){
dojo._hasResource["com.ibm.oneui.controls.MessageBox"]=true;
dojo.provide("com.ibm.oneui.controls.MessageBox");








dojo.requireLocalization("com.ibm.oneui.controls","MessageBox");
(function(_1,_2){
var _3={ERROR:0,WARNING:1,INFO:2,SUCCESS:3,SHARED_EXTERNAL:4};
var _4=dojo.i18n.getLocalization("com.ibm.oneui.controls","MessageBox");
dojo.declare("com.ibm.oneui.controls.MessageBox",[dijit._Widget,dijit._Templated],{type:_3.ERROR,canClose:false,msg:"",msgMore:"",showMoreClass:"lotusHidden",messages:_4,_strings:{},templatePath:dojo.moduleUrl("com.ibm.oneui","controls/templates/MessageBox.html"),msgBody:null,closeBtn:null,imgNode:null,showMoreMessageNode:null,showMoreNode:null,showLessNode:null,focusPostClose:null,buildRendering:function(){
var _5;
for(_5 in _3){
if(_3.hasOwnProperty(_5)){
if(this.type==_3[_5]){
this._strings=dojo.mixin({},this.messages[_5],this._strings);
}
}
}
this._strings=dojo.mixin({},this.messages["common"],this._strings);
if(this.srcNodeRef.id){
dijit.registry.remove(this.id);
this.id=dijit.registry.getUniqueId(this.declaredClass.replace(/\./g,"_"));
dijit.registry.add(this);
}
this.srcNodeRef=dojo.create("div",{},this.srcNodeRef);
if(this.msgMore){
this.showMoreClass="";
}
this.inherited(arguments);
switch(this.type){
case _3.ERROR:
dojo.addClass(this.imgNode,"lotusIconMsgError");
break;
case _3.WARNING:
dojo.addClass(this.imgNode,"lotusIconMsgWarning");
dojo.addClass(this.domNode,"lotusWarning");
break;
case _3.INFO:
dojo.addClass(this.imgNode,"lotusIconMsgInfo");
dojo.addClass(this.domNode,"lotusInfo");
break;
case _3.SHARED_EXTERNAL:
dojo.addClass(this.imgNode,"lconnIconMsgSharedExternal");
dojo.addClass(this.domNode,"lconnSharedExternal");
break;
default:
dojo.addClass(this.imgNode,"lotusIconMsgSuccess");
dojo.addClass(this.domNode,"lotusSuccess");
break;
}
if(this.msg){
var _6,m=this.msg,n=dojo.byId(m);
if(dojo.isFunction(m)){
_6=m.call(this,this.d||dojo.doc);
}else{
if(n&&n.nodeType){
_6=n;
}else{
if(dojo.isString(m)){
_6=dojo.doc.createTextNode(m);
}else{
console.warn("MessageBox: msg should be a string, a DOM node or an id of a DOM node, or a function returning a DOM node.");
_6=dojo._toDom("<!-- No message -->");
}
}
}
dojo.place(_6,this.msgBody,"only");
}
this.containerNode=this.domNode;
},postCreate:function(){
if(this.canClose){
dojo.removeClass(this.closeBtn,"lotusHidden");
this.connect(this.closeBtn,"onclick","close");
}
},close:function(e){
if(e){
dojo.stopEvent(e);
}
dojo.addClass(this.domNode,"lotusHidden");
if(this.focusPostClose){
setTimeout(dojo.partial(dijit.focus,this.focusPostClose),100);
}
this.onClose();
},onClose:function(){
dojo.publish("com/ibm/oneui/message/closed",[this]);
this.destroy();
},showMoreLessClicked:function(){
dojo.toggleClass(this.showMoreMessageNode,"lotusHidden");
dojo.toggleClass(this.showMoreNode,"lotusHidden");
dojo.toggleClass(this.showLessNode,"lotusHidden");
}});
dojo.mixin(com.ibm.oneui.controls.MessageBox,{TYPE:_3});
})(window,document);
}


;if(!dojo._hasResource["lconn.core.header"]){
dojo._hasResource["lconn.core.header"]=true;
(function(){
dojo.provide("lconn.core.header");












dojo.mixin(dojo.getObject("lconn.core.header",true),{initMenu:function(a,_1){
a._init=true;
var id=dojo.attr(a,"_lconn_menuid");
a.removeAttribute("_lconn_menuid");
var _2=new lconn.core.header.MenuLauncher({menuHref:dojo.attr(a,"src"),menuId:id,dialogTitle:dojo.attr(a,"aria-label"),focusNode:a,errorMessageText:dojo.attr(a,"errormessage")},a.parentNode);
_2[_1]();
},menuFocus:function(a){
if(!a._init){
this.initMenu(a,"onFocus");
}
},menuClick:function(a){
if(!a._init){
this.initMenu(a,"onClick");
}
},menuMouseover:function(a){
if(!a._init){
this.initMenu(a,"onMouseEnter");
}
},enableLanguageSelector:function(_3,_4,_5,_6,_7){
var _8=lconn.core.config.features;
if(_8("ui-language-setting")){
return;
}
var dj=dojo;
var _9={path:"/"};
var _a=_7==-1?0:(_7/86400);
if(_a>0){
_9.expires=_a;
}
var _b=_6;
if(_b&&_b!="."){
dj.require("lconn.core.url");
var _c=lconn.core.url.parse(window.location.href);
var _d=_c.host;
_9.domain=_b+_d.substring(_d.indexOf("."),_d.length);
}
_3=dojo.byId(_3);
if(!_3){
console.log("language selector node not present in header or footer");
return;
}
try{
dj.require("lconn.core.LanguageSelector");
var _e=_3.nextSibling;
while(_e){
if(_e.nodeType==1){
dojo.removeClass(_e,"lotusFirst");
}
_e=_e.nextSibling;
}
_3.innerHTML="<a id='headerLanguageSelectorMenu' href='javascript:;' role='button' aria-haspopup='true'></a>";
_3.style.display="";
new lconn.core.LanguageSelector(_3.firstChild,_4,_5,_9);
}
catch(e){
console.error("lconn/core/LanguageSelector.js unavailable ");
console.error(e);
}
},decorateUser:function(_f,_10,_11){
if(!_f||!_f.id||!_f.displayName){
return;
}
var hun=dojo.query("#headerUserName img")[0];
if(hun){
var img=com.ibm.lconn.layout.people.createImage({userid:_f.id,name:_f.displayName},26);
if(img){
dojo.place(img,hun,"replace");
}else{
dojo.addClass(hun,"otherPeople24 otherPeople24-NoPhotoPerson24");
hun.src=dojo.config.blankGif;
}
}
var lp=dojo.byId("lotusPerson");
if(lp){
dojo.removeClass(lp,"lotusHidden");
dojo.style(lp,"display","");
}
dojo.attr("headerUserName","src",dojo.string.substitute(_10.user_jsp,{username:_f.displayName,userId:_f.id}));
var hs=dojo.byId("headerSharebox");
if(hs){
dojo.removeClass(hs,"lotusHidden");
dojo.style(hs,"display","");
}
var ll=dojo.byId("logoutLink");
if(ll){
ll.replaceChild(document.createTextNode(_11.logout),ll.firstChild);
ll.href=_10.logout;
dojo.addClass(ll,"lotusHidden");
ll.style.display="none";
}
dojo.query("li",dojo.byId("headerMenuContainer")).forEach(function(el){
if(el.previousSibling){
dojo.removeClass(el,"lotusFirst");
}
});
var _12=dojo.byId("lotusBannerCommunitiesLink");
if(_12){
var _13=dijit.byId(dojo.attr(_12,"aria-owns"));
var _14=_10.communities_jsp;
if(_13){
_13.attr("href",_14);
}else{
dojo.attr(_12,"src",_14);
}
}
lconn.core.header.apps.updateBannerByRoles();
},switchTheme:lconn.core.theme.switchTheme});
dojo.declare("lconn.core.header.MenuLauncher",lconn.core.widget.MenuLauncher,{activeParent:0,_initMenuFinal:function(){
if(!dojo.getObject("lconn.core.header.Menu")){
var d=dojo;
d.provide("lconn.core.header.Menu");
dojo.declare("lconn.core.header.Menu",dijit.TooltipDialog,{autofocus:false,"class":"lotusNavMenu",isFailed:false,postCreate:function(){
this.inherited(arguments);
dijit.setWaiState(this.containerNode,"label",this.dialogTitle);
if(!this.errorMessageText){
var _15=dojo.i18n.getLocalization("dijit","loading");
if(_15){
this.errorMessageText=_15["errorState"];
}
}
this._strings=dojo.i18n.getLocalization("lconn.core","strings");
dijit.setWaiRole(this,"dialog");
},_attachTemplateNodes:function(){
this.inherited(arguments);
this.connect(this.domNode,"onmouseover","onMouseOver");
this.connect(this.domNode,"onmouseout","onMouseOut");
this.connect(this.domNode,"onclick","onMenuClick");
this.connect(this.domNode,"onclose","onClose");
},onClose:function(){
this.inherited(arguments);
if(this.domNode){
dojo.removeAttr(this.domNode.parentNode,"style");
}
},orient:function(_16,_17,_18){
this.domNode.className=this["class"]+" dijitTooltipAB"+(_18.charAt(1)=="L"?"Left":"Right");
var mb=dojo.marginBox(this.domNode);
var _19=false;
if(!this.isFailed){
var _1a=dojo.attr(this.domNode.parentNode,"dijitpopupparent");
if(_1a){
var _1b=dojo.byId(_1a);
if(_1b){
var _1c=dojo.attr(_1b,"external-content-style");
if(_1c){
var _1d="";
var _1e="";
var _1f=_1c.split(";");
for(var i=0;i<_1f.length;i++){
var _20=_1f[i].split(":");
if(_20[0]&&_20[1]){
if(_20[0]=="height"){
_1d=_20[1];
}
if(_20[0]=="width"){
_1e=_20[1];
}
}
}
if(_1d=="auto"&&_1e=="auto"){
_19=true;
}else{
if(_1d=="auto"){
dojo.marginBox(_16,{w:mb.w});
_19=true;
}else{
if(_1e=="auto"){
dojo.marginBox(_16,{h:mb.h});
_19=true;
}
}
}
}
}
}
}
if(!_19){
dojo.style(this.domNode,"height","");
dojo.style(this.domNode,"width","");
dojo.style(this.domNode.parentNode,"height","");
dojo.style(this.domNode.parentNode,"width","");
}
},onMenuClick:function(e){
var el=e.target;
for(var i=0;el&&i<5;i++){
if(el.nodeName.toLowerCase()=="a"){
if(dojo.isIE<9){
var _21=el.style;
_21.visibility="hidden";
setTimeout(function(){
_21.visibility="";
},1);
}
this.onCancel();
return;
}else{
el=el.parentNode;
}
}
},_onError:function(_22,err,_23){
this.inherited(arguments);
this.isFailed=true;
},onDownloadError:function(_24){
dojo.addClass(this.domNode,"lotusNavMenuError");
if(this.errorMessageText){
var _25=this.messageBox=new com.ibm.oneui.controls.MessageBox({canClose:false,_strings:{icon_alt:this._strings.rs_messagebox_warning_icon_alt,a11y_label:this._strings.rs_messagebox_warning_a11y_label},type:com.ibm.oneui.controls.MessageBox.TYPE.WARNING,msg:this.errorMessageText},dojo.create("div"));
this.errorMessage=_25.domNode;
}
return this.inherited(arguments);
},uninitialize:function(){
if(this._beingDestroyed&&this.messageBox){
this.messageBox.destroy();
}
this.inherited(arguments);
}});
}
this.menu=new lconn.core.header.Menu({widthAdjust:8,href:this.menuHref,dialogTitle:this.dialogTitle,id:this.menuId||undefined,errorMessageText:this.errorMessageText});
var _26=dojo.attr(this.focusNode,"onmenuloaded");
if(_26){
this.connect(this.menu,"onLoad",dojo.getObject(_26));
}
},_initMenu:function(){
return this._whenDialog().addCallback(this,"_initMenuFinal");
},_whenDialog:function(){
var dfd=this._dlgDfd;
if(!dfd){
var d=dojo;
d.require("dijit.Dialog");
dfd=this._dlgDfd=new dojo.Deferred();
dfd.callback();
}
return dfd;
}});
})();
}

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.lconn.socialmail"]=true;

;if(!dojo._hasResource["com.ibm.lconn.socialmail.gadget._NavigationHandler"]){
dojo._hasResource["com.ibm.lconn.socialmail.gadget._NavigationHandler"]=true;
(function(){
dojo.provide("com.ibm.lconn.socialmail.gadget._NavigationHandler");
var _1=1350900150611;
window.navHandlerVer=_1;
function _2(){
};
_2.prototype={gadget:null,commonContainer:null,notifySite:null,inboxSite:null,calendarSite:null,messageSite:null,currentSite:null,iContainer:null,messageDialog:null,hoverLoaded:null,debugRpc:null,headerMenu:null,focusedElement:null,bootedState:{badge:false,inbox:false,calendar:false,document:false},bootstrapCallbacks:{badge:[],inbox:[],calendar:[],document:[]},gadgetReady:{badge:false,inbox:false,calendar:false,document:false},gadgetReadyCallbacks:{badge:[],inbox:[],calendar:[],document:[]},calMinHeight:400,refreshCache:14400,gadgetIDs:null,setCalendarDisplay:function(el,_3){
if(el&&el.firstChild&&el.firstChild.id){
var _4=window.frames[el.firstChild.id];
if(_4&&_4.document.getElementsByTagName("table").length>0){
_4.document.getElementsByTagName("table")[0].style.display=_3;
}
}
},getSiteFromArea:function(cc,_5){
return cc.getSiteById(this.gadgetIDs[_5]);
},addBootstrapCallback:function(_6,_7){
this.bootstrapCallbacks[_6].push(_7);
this.runBootstrapCallbacks(_6);
},runBootstrapCallbacks:function(_8){
if(!this.bootedState[_8]){
return;
}
for(var _9=null;_9=this.bootstrapCallbacks[_8].shift();){
_9();
}
},handleIntermediateBootstrap:function(cc,_a){
if(_a.dataObject=="inbox"||_a.dataObject=="calendar"){
var _b=this.getSiteFromArea(cc,_a.dataObject);
this.addBootstrapCallback("badge",cre$.util.hitch(this,function(){
this.addGadgetReadyCallback(_a.dataObject,cre$.util.hitch(this,function(){
this.hoverLoaded[_a.dataObject]="ready";
if(this.headerMenu[_a.dataObject]){
if(this.debugRpc){
console.log("com.ibm.socpim.rpc.bootstrap - badge - "+_b.getId());
}
_b.rpcCall("com.ibm.socpim.rpc.bootstrap","","badge");
}
}));
}));
}
},handleBootstrap:function(cc,_c){
this.bootedState[_c.dataObject]=true;
this.runBootstrapCallbacks(_c.dataObject);
},handleGadgetReady:function(_d){
this.gadgetReady[_d]=true;
this.runGadgetReadyCallbacks(_d);
},addGadgetReadyCallback:function(_e,_f){
this.gadgetReadyCallbacks[_e].push(_f);
this.runGadgetReadyCallbacks(_e);
},runGadgetReadyCallbacks:function(_10){
if(!this.gadgetReady[_10]){
return;
}
for(var _11=null;_11=this.gadgetReadyCallbacks[_10].shift();){
_11();
}
},registerGadgetReadyHandler:function(cc,_12,_13){
var _14="com.ibm.socpim.navigateGadget_"+_12;
cc.addGadgetLifecycleCallback(_14,{onRender:cre$.util.hitch(this,function(_15,_16){
if(_16===_13){
cc.removeGadgetLifecycleCallback(_14);
this.handleGadgetReady(_12);
}
})});
},registerGadgetVisibilityController:function(cc,_17){
var _18=_17+"_visibilityController";
cc.addGadgetLifecycleCallback(_18,{onRender:cre$.util.hitch(this,function(_19,_1a){
if(_1a===_17){
cc.removeGadgetLifecycleCallback(_18);
this.showSiteContent(_17);
}
})});
},setOffsetPos:function(cc,_1b,_1c,_1d,_1e){
if(!_1b||!this.hoverLoaded||this.hoverLoaded[_1c]!=="loaded"||typeof _1b._offsetTop=="undefined"){
return;
}
cc.getSiteById(_1d).rpcCall("com.ibm.socpim.rpc","",{type:_1e,dataObject:{top:_1b._offsetTop}});
},setBorderExtents:function(cc,_1f,_20,_21,_22){
if(!_1f||!this.hoverLoaded||this.hoverLoaded[_20]!=="loaded"||typeof _1f._borderWidth=="undefined"){
return;
}
cc.getSiteById(_21).rpcCall("com.ibm.socpim.rpc","",{type:_22,dataObject:{b:_1f._borderWidth}});
},createElementForEEHandler:function(rel,_23,_24,_25,_26){
if(_24=="container/mail/preview/ee"&&_26.getId()==this.gadgetIDs.message){
var _27=document.getElementById(_26.getId()),_28=_27.parentElement,_29=document.getElementById(this.gadgetIDs.message),_2a=document.getElementById(this.gadgetIDs.messageEE);
var _2b=_26.container_.getSiteById(this.gadgetIDs.messageEE);
if(_2b){
_26.container_.closeGadget(_2b);
}
_29.style.height="auto";
_2a.style.display="block";
var _2c;
if(document.defaultView&&document.defaultView.getComputedStyle){
_2c=document.defaultView.getComputedStyle(_27);
}else{
_2c=_27.currentStyle;
}
var _2d=_27.offsetHeight+parseFloat(_2c.marginTop==="auto"?"0px":_2c.marginTop)+parseFloat(_2c.marginBottom==="auto"?"0px":_2c.marginBottom);
_2a.style.marginTop=_2d+"px";
var h=Math.abs(_28.offsetHeight-_2d)+"px";
_2a.style.height=h;
return _2a;
}
},destroyElementForEEHandler:function(_2e){
var id=_2e.getId(),_2f=document.getElementById(this.gadgetIDs.message),_30=document.getElementById(this.gadgetIDs.messageEE);
if(id==this.gadgetIDs.message){
var _31=_2e.container_.getSiteById(this.gadgetIDs.messageEE);
if(_31){
_2e.container_.closeGadget(_31);
}
}else{
if(id==this.gadgetIDs.messageEE){
_2f.style.height="";
_30.style.display="";
}
}
_2e.container_.closeGadget(_2e);
},saveFocusedElement:function(_32){
if(_32&&_32[0]==="mouseover"){
this.focusedElement=document.activeElement;
}
},restoreFocusedElement:function(){
if(this.focusedElement){
this.focusedElement.focus();
}
this.focusedElement=undefined;
},initialization:function(){
if(!this.commonContainer){
if(this.isDebug){
console.log("Initializing container");
}
if(!this.verifyExpectedData()){
return false;
}
this.generateSuffixToSiteIdsOnHeader();
if(!this.addSuffixToSiteIdsOnHeader()){
return false;
}
var _33=document.getElementById(this.gadgetIDs.badge);
_33.style.visibility="hidden";
this.iContainer=this.initContainer();
this.commonContainer=this.iContainer.getCommonContainer();
var _34=null;
this.hoverLoaded={inbox:false,calendar:false,badgeNotified:false};
this.debugRpc=(location.search.match(/[&\?]debugRpc=([^&]*)/i)||[])[1] in {"true":1,1:1};
this.headerMenu={inbox:null,calendar:null};
_34=this.getServiceUrl();
if(_34){
_34=_34.toString();
if(_34.search(/inbox\.xml/)===-1){
_34=_34+"/gadgets/inbox.xml";
}
}
this.gadget=_34;
var _35=this.getUrlParameter(window.location.href,"gadget");
if(this.isDebug&&_35&&_35!=""){
this.gadget=window.location.protocol+"//"+_35;
}
var _36=function(_37){
if(typeof (cre$)==="undefined"){
setTimeout(function(){
_36(_37);
},50);
}else{
_37.addLoginLogoutHandlers();
_37.iContainer.views.registerCreateElementForEEHandler("container/mail/preview/ee",cre$.util.hitch(_37,_37.createElementForEEHandler),cre$.util.hitch(_37,_37.destroyElementForEEHandler));
_37.commonContainer.then(function(cc){
osapi.container.GadgetHolder.prototype.createIframeAttributeMap=function(url,_38){
if(this.el_.id==_37.gadgetIDs.messageEE){
_38=_38||{};
_38["scrolling"]="auto";
}
return osapi.container.SiteHolder.prototype.createIframeAttributeMap.call(this,url,_38);
};
cc.preloadGadget(_37.gadget,function(){
if(_37.iContainer&&_37.iContainer.ICactions){
_37.iContainer.ICactions.registerNavigateGadgetHandler(cre$.util.hitch(_37,_37.navigateGadgetHandler));
}else{
cc.actions.registerNavigateGadgetHandler(cre$.util.hitch(_37,_37.navigateGadgetHandler));
}
var _39={};
var _3a=osapi.container.RenderParam;
_39[_3a.WIDTH]="15px";
_39[_3a.HEIGHT]=_37.isIE()?"0px":"15px";
_39[_3a.REFRESH]=_37.refreshCache;
_39[_3a.USER_PREFS]=_37.getUserPrefs();
var _3b={gadgetId:_37.gadgetIDs.badge,dynamicSiteIdSuffix:_37.dynamicSiteIdSuffix,currentUserId:_37.getUserId()};
if(!_37.notifySite){
_37.notifySite=cc.newGadgetSite(document.getElementById(_37.gadgetIDs.badge));
}
_37.registerGadgetReadyHandler(cc,"badge",_37.notifySite.getId());
cc.navigateGadget(_37.notifySite,_37.gadget,_3b,_39);
_37.iContainer.loadWidget({definitionUrl:_37.gadget,placement:_37.gadgetIDs.inbox,componentType:"gadget"});
_37.setBadgeAccessibilityAttributes();
});
cc.actions.addListener(cre$.util.hitch(_37,_37.onMessageOpen),"com.ibm.socpim.openDocument");
cc.actions.addListener(cre$.util.hitch(_37,_37.onMessageCompose),"com.ibm.socpim.mail.messageCompose");
cc.actions.addListener(cre$.util.hitch(_37,_37.onMessageClose),"com.ibm.socpim.closeDocument.sm");
_37.addBootstrapCallback("badge",function(){
setTimeout(function(){
_37.navigateInbox();
},100);
setTimeout(function(){
_37.navigateCalendar();
},150);
setTimeout(function(){
_37.navigateOpenMessage(_37.gadget,"Document");
},200);
});
_37.startupSettings();
cc.rpcRegister("com.ibm.socpim.rpc",function(_3c,_3d){
_37.debugRpc&&window.console&&console.log("com.ibm.socpim.rpc received: "+_3d.type+": "+(typeof _3d.dataObject=="object"&&(window.JSON||{}).stringify?JSON.stringify(_3d.dataObject):_3d.dataObject));
if(_3d.type=="com.ibm.socpim.bootstrap.beingloaded"){
_37.handleIntermediateBootstrap(cc,_3d);
}else{
if(_3d.type=="com.ibm.socpim.bootstrap.loaded"){
_37.handleBootstrap(cc,_3d);
_37.verifyVisibility(_3d.dataObject);
if(_3d.dataObject=="inbox"){
_37.hoverLoaded.inbox="loaded";
}else{
if(_3d.dataObject=="calendar"){
_37.hoverLoaded.calendar="loaded";
}else{
if(_3d.dataObject=="badge"){
var _3e=document.getElementById(_37.gadgetIDs.badge);
_3e.style.visibility="";
}else{
if(_3d.dataObject=="document"){
_37.messageSite.loaded=true;
}
}
}
}
var win=document.parentWindow||document.defaultView;
_37.commonContainer.then(function(cc){
if(_3d.dataObject=="inbox"||_3d.dataObject=="calendar"){
var _3f=(_3d.dataObject=="inbox")?_37.gadgetIDs.inbox:_37.gadgetIDs.calendar;
var _40=function(){
cc.getSiteById(_3f).rpcCall("com.ibm.socpim.rpc","",{type:"com.ibm.socpim.windowgeom",dataObject:{w:document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth||win.innerWidth,h:document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight||win.innerHeight}});
};
_40();
if(window.addEventListener){
window.addEventListener("resize",_40);
}else{
if(window.attachEvent){
window.attachEvent("onresize",_40);
}
}
}
});
if(_37.inboxSite){
_37.setOffsetPos(cc,_37.inboxSite,"inbox",_37.gadgetIDs.inbox,"com.ibm.socpim.mailoffsetpos");
_37.setBorderExtents(cc,_37.inboxSite,"inbox",_37.gadgetIDs.inbox,"com.ibm.socpim.mailborderextents");
}
if(_37.calendarSite){
_37.setOffsetPos(cc,_37.calendarSite,"calendar",_37.gadgetIDs.calendar,"com.ibm.socpim.calendaroffsetpos");
_37.setBorderExtents(cc,_37.calendarSite,"calendar",_37.gadgetIDs.calendar,"com.ibm.socpim.calendarborderextents");
}
}else{
if(_3d.type=="com.ibm.socpim.calendar.datepicker.visibility"){
_37.calendarSite._datepick=_3d.dataObject=="visible";
if(_37.calendarSite._currentHeight){
_37.calendarSite.domNode.style.height=_37.calendarSite.domNode.firstChild.style.height=Math.max(_3d.dataObject=="visible"?_37.calMinHeight:0,_37.calendarSite._currentHeight)+"px";
}
}
}
}
_37.extraRpcCalls(_3d);
});
});
}
};
_36(this);
}
},navigateGadgetHandler:function(_41,_42){
if(this.gadget===_41){
this.navigateGadgetHandlerCustomProperties();
var _43=osapi.container.actions.OptParam;
var _44=_42[_43.VIEW];
var _45=_42[_43.VIEW_TARGET];
if(_45=="container/mail/preview"){
this.navigateOpenMessage(_41,_44);
}
}
},navigateInbox:function(_46,_47){
if(!this.notifySite){
return;
}
if(!this.headerMenu.inbox&&_46){
this.headerMenu.inbox=this.getDropdownContainerId(_46);
if(this.inboxSite){
this.loadContainerDropdown(_46,_47);
if(this.hoverLoaded.inbox==="ready"){
this.commonContainer.then(cre$.util.hitch(this,function(cc){
if(this.debugRpc){
console.log("com.ibm.socpim.rpc.bootstrap - badge - sending to "+this.inboxSite.site.getId());
}
cc.getSiteById(this.inboxSite.site.getId()).rpcCall("com.ibm.socpim.rpc.bootstrap","","badge");
}));
}
}
}
if(!this.inboxSite){
this.commonContainer.then(cre$.util.hitch(this,function(cc){
this.inboxSite=this.generateGadgetSite({id:this.gadgetIDs.inbox,bindto:this.idMailLoadingSpinner,"class":this.classMailDropdown,hide:cre$.util.hitch(this,function(){
this.inboxSite.domNode.style.visibility="hidden";
this.inboxSite.domNode.style.zIndex=-1;
var _48={type:"com.ibm.socpim.MailDropDown",dataObject:"hidden"};
if(this.debugRpc){
console.log("com.ibm.socpim.rpc sending "+_48.type+": "+_48.dataObject+" to os-site-mail-notify");
}
cc.getSiteById(this.gadgetIDs.badge).rpcCall("com.ibm.socpim.rpc","",_48);
var _49=function(_4a){
if(_4a.hoverLoaded.inbox!=="loaded"){
setTimeout(function(){
_49(_4a);
},10);
}else{
if(_4a.debugRpc){
console.log("com.ibm.socpim.rpc sending "+_48.type+": "+_48.dataObject+" to os-site-mail-hover");
}
cc.getSiteById(_4a.gadgetIDs.inbox).rpcCall("com.ibm.socpim.rpc","",_48);
}
};
_49(this);
this.restoreFocusedElement();
}),show:cre$.util.hitch(this,function(){
this.saveFocusedElement(arguments[0]);
this.inboxSite.domNode.style.visibility="visible";
this.inboxSite.domNode.style.zIndex=2000;
if(typeof this.inboxSite._currentHeight!="undefined"){
this.setDropDownHeight(this.inboxSite,this.inboxSite._currentHeight,"inbox");
}
if(typeof this.inboxSite._offsetTop=="undefined"){
this.inboxSite._offsetTop=this.inboxSite.domNode.offsetTop;
this.setOffsetPos(cc,this.inboxSite,"inbox",this.gadgetIDs.inbox,"com.ibm.socpim.mailoffsetpos");
}
if(typeof this.inboxSite._borderWidth=="undefined"){
var _4b=document.getElementById(this.headerMenu.inbox);
if(_4b){
this.inboxSite._borderWidth=this.calculateBorderWidth(_4b);
this.setBorderExtents(cc,this.inboxSite,"inbox",this.gadgetIDs.inbox,"com.ibm.socpim.mailborderextents");
}
}
var _4c={type:"com.ibm.socpim.MailDropDown",dataObject:"visible"};
if(this.debugRpc){
console.log("com.ibm.socpim.rpc sending "+_4c.type+": "+_4c.dataObject+" to os-site-mail-notify");
}
cc.getSiteById(this.gadgetIDs.badge).rpcCall("com.ibm.socpim.rpc","",_4c);
var _4d=function(_4e){
if(_4e.hoverLoaded.inbox!=="loaded"){
setTimeout(function(){
_4d(_4e);
},10);
}else{
if(_4e.debugRpc){
console.log("com.ibm.socpim.rpc sending "+_4c.type+": "+_4c.dataObject+" to os-site-mail-hover");
}
cc.getSiteById(_4e.gadgetIDs.inbox).rpcCall("com.ibm.socpim.rpc","",_4c);
if(!_4e.hoverLoaded.badgeNotified){
if(_4e.debugRpc){
console.log("com.ibm.socpim.rpc.bootstrap sending to os-site-mail-notify");
}
cc.getSiteById(_4e.gadgetIDs.badge).rpcCall("com.ibm.socpim.rpc.bootstrap","",null);
_4e.hoverLoaded.badgeNotified=true;
}
if(!_4e.hoverLoaded.messagesNotified&&!!cc.getSiteById(_4e.gadgetIDs.message)){
if(_4e.debugRpc){
console.log("com.ibm.socpim.rpc.bootstrap sending to os-site-mail-hover-preview-messages");
}
cc.getSiteById(_4e.gadgetIDs.message).rpcCall("com.ibm.socpim.rpc.bootstrap","",null);
_4e.hoverLoaded.messagesNotified=true;
}
_4e.updateWarning(_4e.inboxSite);
}
};
_4d(this);
})});
document.getElementsByTagName("body")[0].appendChild(this.inboxSite.domNode);
var _4f={};
var _50=osapi.container.RenderParam;
_4f[_50.WIDTH]="100%";
_4f[_50.HEIGHT]="100%";
_4f[_50.VIEW]="HoverView";
_4f[_50.REFRESH]=this.refreshCache;
var _51={gadgetId:this.gadgetIDs.inbox,dynamicSiteIdSuffix:this.dynamicSiteIdSuffix,currentUserId:this.getUserId()};
_4f[_50.USER_PREFS]=this.getUserPrefs();
this.inboxSite.site=cc.newGadgetSite(this.inboxSite.domNode);
var _52=this.inboxSite.site.getId();
this.registerGadgetReadyHandler(cc,"inbox",_52);
this.registerGadgetVisibilityController(cc,_52);
cc.navigateGadget(this.inboxSite.site,this.gadget,_51,_4f,function(){
});
this.hideInboxWhileLoading();
})).then(cre$.util.hitch(this,function(){
if(_46){
this.loadContainerDropdown(_46,_47);
}
}));
}
this.currentSite="mail";
},navigateCalendar:function(_53,_54){
if(!this.notifySite){
return;
}
if(!this.headerMenu.calendar&&_53){
this.headerMenu.calendar=this.getDropdownContainerId(_53);
if(this.calendarSite){
this.loadContainerDropdown(_53,_54);
if(this.hoverLoaded.calendar==="ready"){
this.commonContainer.then(cre$.util.hitch(this,function(cc){
if(this.debugRpc){
console.log("com.ibm.socpim.rpc.bootstrap - badge - sending to "+this.calendarSite.site.getId());
}
cc.getSiteById(this.calendarSite.site.getId()).rpcCall("com.ibm.socpim.rpc.bootstrap","","badge");
}));
}
}
}
if(!this.calendarSite){
this.commonContainer.then(cre$.util.hitch(this,function(cc){
this.calendarSite=this.generateGadgetSite({id:this.gadgetIDs.calendar,bindto:this.idCalendarLoadingSpinner,"class":this.classCalendarDropdown,hide:cre$.util.hitch(this,function(){
this.calendarSite.domNode.style.visibility="hidden";
this.calendarSite.domNode.style.zIndex=-1;
var _55={type:"com.ibm.socpim.CalendarDropDown",dataObject:"hidden"};
var _56=function(_57){
if(_57.hoverLoaded.calendar!=="loaded"){
setTimeout(function(){
_56(_57);
},10);
}else{
if(_57.debugRpc){
console.log("com.ibm.socpim.rpc sending "+_55.type+": "+_55.dataObject+" to os-site-calendar-hover");
}
cc.getSiteById(_57.gadgetIDs.calendar).rpcCall("com.ibm.socpim.rpc","",_55);
}
};
_56(this);
this.setCalendarDisplay(this.calendarSite.domNode,"none");
this.restoreFocusedElement();
}),show:cre$.util.hitch(this,function(){
this.saveFocusedElement(arguments[0]);
this.calendarSite.domNode.style.visibility="visible";
this.calendarSite.domNode.style.zIndex=2000;
if(typeof this.calendarSite._currentHeight!="undefined"){
this.setDropDownHeight(this.calendarSite,this.calendarSite._currentHeight,"calendar");
}
if(typeof this.calendarSite._offsetTop=="undefined"){
this.calendarSite._offsetTop=this.calendarSite.domNode.offsetTop;
this.setOffsetPos(cc,this.calendarSite,"calendar",this.gadgetIDs.calendar,"com.ibm.socpim.calendaroffsetpos");
}
if(typeof this.calendarSite._borderWidth=="undefined"){
var _58=document.getElementById(this.headerMenu.calendar);
if(_58){
this.calendarSite._borderWidth=this.calculateBorderWidth(_58);
this.setBorderExtents(cc,this.calendarSite,"calendar",this.gadgetIDs.calendar,"com.ibm.socpim.calendarborderextents");
}
}
var _59={type:"com.ibm.socpim.CalendarDropDown",dataObject:"visible"};
var _5a=function(_5b){
if(_5b.hoverLoaded.calendar!=="loaded"){
setTimeout(function(){
_5a(_5b);
},10);
}else{
if(_5b.debugRpc){
console.log("com.ibm.socpim.rpc sending "+_59.type+": "+_59.dataObject+" to os-site-calendar-hover");
}
cc.getSiteById(_5b.gadgetIDs.calendar).rpcCall("com.ibm.socpim.rpc","",_59);
_5b.updateWarning(_5b.calendarSite);
}
};
_5a(this);
this.setCalendarDisplay(this.calendarSite.domNode,"table");
})});
document.getElementsByTagName("body")[0].appendChild(this.calendarSite.domNode);
var _5c={};
var _5d=osapi.container.RenderParam;
_5c[_5d.WIDTH]="100%";
_5c[_5d.HEIGHT]="100%";
_5c[_5d.VIEW]="CalendarHoverView";
_5c[_5d.REFRESH]=this.refreshCache;
var _5e={gadgetId:this.gadgetIDs.calendar,dynamicSiteIdSuffix:this.dynamicSiteIdSuffix,currentUserId:this.getUserId()};
_5c[_5d.USER_PREFS]=this.getUserPrefs();
this.calendarSite.site=cc.newGadgetSite(this.calendarSite.domNode);
var _5f=this.calendarSite.site.getId();
this.registerGadgetReadyHandler(cc,"calendar",_5f);
this.registerGadgetVisibilityController(cc,_5f);
cc.navigateGadget(this.calendarSite.site,this.gadget,_5e,_5c,function(){
});
this.hideCalendarWhileLoading();
})).then(cre$.util.hitch(this,function(){
if(_53){
this.loadContainerDropdown(_53,_54);
}
}));
}
this.currentSite="calendar";
},navigateOpenMessage:function(_60,_61){
this.closeCurrentSite();
if(!this.messageDialog){
if(!this.messageSite){
this.generateMessageSite();
}
this.generateMessageDialog();
this.commonContainer.then(cre$.util.hitch(this,function(cc){
var _62={};
var _63=osapi.container.RenderParam;
_62[_63.WIDTH]="100%";
_62[_63.HEIGHT]="100%";
_62[_63.VIEW]=_61;
_62[_63.REFRESH]=this.refreshCache;
var _64={gadgetId:this.gadgetIDs.message,dynamicSiteIdSuffix:this.dynamicSiteIdSuffix,currentUserId:this.getUserId()};
_62[_63.USER_PREFS]=this.getUserPrefs();
var _65=document.getElementById(this.gadgetIDs.message);
this.messageSite.site=cc.newGadgetSite(_65);
var _66=this.messageSite.site.getId();
this.registerGadgetReadyHandler(cc,"document",_66);
this.registerGadgetVisibilityController(cc,_66);
cc.navigateGadget(this.messageSite.site,_60,_64,_62,function(){
});
this.hideLightboxWhileLoading();
}));
this.messageDialog.domNode.style.visibility="hidden";
this.messageDialog.domNode.style.display="block";
this.messageDialog.domNode.style.top="-9999px";
}
},setDropDownHeight:function(_67,_68,_69){
if(!_67||!this.headerMenu||!this.headerMenu[_69]){
return;
}
var _6a=0;
if(_67._datepick){
_6a=this.calMinHeight;
}
_68=_68[0]?_68[0]:_68;
_68=parseInt(_68,10);
_67._currentHeight=_68;
var _6b=document.getElementById(this.headerMenu[_69]),_6c=document.getElementById(_67.bindto);
if(!_6b||!_6c){
return;
}
_6b.style.height=_68+"px";
_6c.style.height=_68+"px";
var mh=(typeof _6a!="undefined"?Math.max(_68,_6a):_68)+"px";
_67.domNode.style.height=mh;
_67.domNode.firstChild.style.height=mh;
},getPane:function(key){
return {inbox:this.inboxSite,calendar:this.calendarSite,document:this.messageSite,badge:this.notifySite}[key];
},handleCloseDocument:function(){
this.commonContainer.then(cre$.util.hitch(this,function(cc){
if(this.messageSite.loaded){
cc.actions.runAction("com.ibm.socpim.closeDocument");
}else{
this.onMessageClose();
}
}));
},verifyExpectedData:function(){
var _6d=true;
var _6e=["idMailListItem","idCalendarListItem","idMailLoadingSpinner","idCalendarLoadingSpinner","classBadge","classMailDropdown","classCalendarDropdown","generateSuffixToSiteIdsOnHeader","loadContainerDropdown","getDropdownContainerId","getServiceUrl","getUrlParameter","initContainer","addLoginLogoutHandlers","addAttribute","getUserPrefs","generateMessageSite","generateMessageDialog","calculateBorderWidth","getBadgeSpan","navigateGadgetHandlerCustomProperties","startupSettings","onMessageOpen","onMessageClose","onMessageCompose","generateGadgetSite","showSiteContent","hideInboxWhileLoading","hideCalendarWhileLoading","hideLightboxWhileLoading","setBadgeAccessibilityAttributes","showDialog","updateWarning","extraRpcCalls","verifyVisibility","closeCurrentSite","isIE","getUserId"];
var _6f="";
for(var _70=0;_70<_6e.length;_70++){
var _71=_6e[_70];
if(!this[_71]){
_6f+=("- "+_71+"\n");
}
}
if(_6f!==""){
alert("Contact your system administrator.\nMissing following fields/methods:\n"+_6f);
return false;
}
return true;
},addSuffixToSiteIdsOnHeader:function(){
var _72="";
if(!document.getElementById(this.idMailListItem)){
_72+="\nMissing element with id=\""+this.idMailListItem+"\"";
}
if(!document.getElementById(this.idCalendarListItem)){
_72+="\nMissing element with id=\""+this.idCalendarListItem+"\"";
}
var _73=this.getBadgeSpan();
if(!_73){
_72+="\nMissing element with class=\""+this.classBadge+"\"";
}
if(_72!==""){
alert("Contact your system administrator: "+_72);
return false;
}
this.addAttribute(document.getElementById(this.idMailListItem),"external-content",this.gadgetIDs.inbox);
this.addAttribute(document.getElementById(this.idCalendarListItem),"external-content",this.gadgetIDs.calendar);
this.addAttribute(_73,"id",this.gadgetIDs.badge);
return true;
}};
com.ibm.lconn.socialmail.gadget._NavigationHandler=_2;
})();
}


;define("dojox/uuid/_base",["dojo/_base/kernel","dojo/_base/lang"],function(_1){
_1.getObject("uuid",true,dojox);
dojox.uuid.NIL_UUID="00000000-0000-0000-0000-000000000000";
dojox.uuid.version={UNKNOWN:0,TIME_BASED:1,DCE_SECURITY:2,NAME_BASED_MD5:3,RANDOM:4,NAME_BASED_SHA1:5};
dojox.uuid.variant={NCS:"0",DCE:"10",MICROSOFT:"110",UNKNOWN:"111"};
dojox.uuid.assert=function(_2,_3){
if(!_2){
if(!_3){
_3="An assert statement failed.\n"+"The method dojox.uuid.assert() was called with a 'false' value.\n";
}
throw new Error(_3);
}
};
dojox.uuid.generateNilUuid=function(){
return dojox.uuid.NIL_UUID;
};
dojox.uuid.isValid=function(_4){
_4=_4.toString();
var _5=(_1.isString(_4)&&(_4.length==36)&&(_4==_4.toLowerCase()));
if(_5){
var _6=_4.split("-");
_5=((_6.length==5)&&(_6[0].length==8)&&(_6[1].length==4)&&(_6[2].length==4)&&(_6[3].length==4)&&(_6[4].length==12));
var _7=16;
for(var i in _6){
var _8=_6[i];
var _9=parseInt(_8,_7);
_5=_5&&isFinite(_9);
}
}
return _5;
};
dojox.uuid.getVariant=function(_a){
if(!dojox.uuid._ourVariantLookupTable){
var _b=dojox.uuid.variant;
var _c=[];
_c[0]=_b.NCS;
_c[1]=_b.NCS;
_c[2]=_b.NCS;
_c[3]=_b.NCS;
_c[4]=_b.NCS;
_c[5]=_b.NCS;
_c[6]=_b.NCS;
_c[7]=_b.NCS;
_c[8]=_b.DCE;
_c[9]=_b.DCE;
_c[10]=_b.DCE;
_c[11]=_b.DCE;
_c[12]=_b.MICROSOFT;
_c[13]=_b.MICROSOFT;
_c[14]=_b.UNKNOWN;
_c[15]=_b.UNKNOWN;
dojox.uuid._ourVariantLookupTable=_c;
}
_a=_a.toString();
var _d=_a.charAt(19);
var _e=16;
var _f=parseInt(_d,_e);
dojox.uuid.assert((_f>=0)&&(_f<=16));
return dojox.uuid._ourVariantLookupTable[_f];
};
dojox.uuid.getVersion=function(_10){
var _11="dojox.uuid.getVersion() was not passed a DCE Variant UUID.";
dojox.uuid.assert(dojox.uuid.getVariant(_10)==dojox.uuid.variant.DCE,_11);
_10=_10.toString();
var _12=_10.charAt(14);
var _13=16;
var _14=parseInt(_12,_13);
return _14;
};
dojox.uuid.getNode=function(_15){
var _16="dojox.uuid.getNode() was not passed a TIME_BASED UUID.";
dojox.uuid.assert(dojox.uuid.getVersion(_15)==dojox.uuid.version.TIME_BASED,_16);
_15=_15.toString();
var _17=_15.split("-");
var _18=_17[4];
return _18;
};
dojox.uuid.getTimestamp=function(_19,_1a){
var _1b="dojox.uuid.getTimestamp() was not passed a TIME_BASED UUID.";
dojox.uuid.assert(dojox.uuid.getVersion(_19)==dojox.uuid.version.TIME_BASED,_1b);
_19=_19.toString();
if(!_1a){
_1a=null;
}
switch(_1a){
case "string":
case String:
return dojox.uuid.getTimestamp(_19,Date).toUTCString();
break;
case "hex":
var _1c=_19.split("-");
var _1d=_1c[0];
var _1e=_1c[1];
var _1f=_1c[2];
_1f=_1f.slice(1);
var _20=_1f+_1e+_1d;
dojox.uuid.assert(_20.length==15);
return _20;
break;
case null:
case "date":
case Date:
var _21=3394248;
var _22=16;
var _23=_19.split("-");
var _24=parseInt(_23[0],_22);
var _25=parseInt(_23[1],_22);
var _26=parseInt(_23[2],_22);
var _27=_26&4095;
_27<<=16;
_27+=_25;
_27*=4294967296;
_27+=_24;
var _28=_27/10000;
var _29=60*60;
var _2a=_21;
var _2b=_2a*_29;
var _2c=_2b*1000;
var _2d=_28-_2c;
var _2e=new Date(_2d);
return _2e;
break;
default:
dojox.uuid.assert(false,"dojox.uuid.getTimestamp was not passed a valid returnType: "+_1a);
break;
}
};
return dojox.uuid;
});


;define("dojox/uuid",["dojox/uuid/_base"],function(_1){
return _1;
});


;define("dojox/uuid/generateRandomUuid",["./_base"],function(){
dojox.uuid.generateRandomUuid=function(){
var _1=16;
function _2(){
var _3=Math.floor((Math.random()%1)*Math.pow(2,32));
var _4=_3.toString(_1);
while(_4.length<8){
_4="0"+_4;
}
return _4;
};
var _5="-";
var _6="4";
var _7="8";
var a=_2();
var b=_2();
b=b.substring(0,4)+_5+_6+b.substring(5,8);
var c=_2();
c=_7+c.substring(1,4)+_5+c.substring(4,8);
var d=_2();
var _8=a+_5+b+_5+c+d;
_8=_8.toLowerCase();
return _8;
};
return dojox.uuid.generateRandomUuid;
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.lconn.gadget"]=true;

;if(!dojo._hasResource["com.ibm.lconn.gadget.container.Handle"]){
dojo._hasResource["com.ibm.lconn.gadget.container.Handle"]=true;
dojo.provide("com.ibm.lconn.gadget.container.Handle");
dojo.declare("com.ibm.lconn.gadget.container.Handle",null,{load:function(){
},unload:function(){
},refresh:function(){
if(this.getState()===com.ibm.lconn.gadget.container.Handle.LOADED){
this.unload();
this.load();
}
},getWidgetInfo:function(){
},getState:function(){
}});
dojo.mixin(com.ibm.lconn.gadget.container.Handle,{LOADING:"LOADING",LOADED:"LOADED",UNLOADED:"UNLOADED",ERROR:"ERROR",__factory__:function(_1,_2,_3){
}});
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.container.Accessor"]){
dojo._hasResource["com.ibm.lconn.gadget.container.Accessor"]=true;
dojo.provide("com.ibm.lconn.gadget.container.Accessor");


dojo.declare("com.ibm.lconn.gadget.container.Accessor",null,{getCommonContainer:function(){
},getIRuntime:function(){
}});
com.ibm.lconn.gadget.container.Accessor.__instance__=com.ibm.lconn.gadget.container.Accessor.__instance__||function(_1){
};
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.container.Topics"]){
dojo._hasResource["com.ibm.lconn.gadget.container.Topics"]=true;
dojo.provide("com.ibm.lconn.gadget.container.Topics");
com.ibm.lconn.gadget.container.Topics=(function(){
var _1={};
var _2="com/ibm/lconn/gadget/";
_1.GadgetWindow={};
_1.GadgetWindow.SITE_TOPIC_SET_TITLE="setTitle";
_1.GadgetWindow.AFTER_ADJUST_WIDTH="afterAdjustWidth";
_1.GadgetWindow.AFTER_ADJUST_HEIGHT="afterAdjustHeight";
_1.GadgetWindow.SET_PREFS="setPrefs";
_1.getSiteTopic=function(_3,_4){
return _2+"site/"+_3+"/"+_4;
};
_1.getLifecycleEventTopic=function(_5){
return _2+_5;
};
_1.getMasterLifecycleTopic=function(){
return _2+"lifecycle";
};
return _1;
})();
}


;if(!dojo._hasResource["lconn.core.util.jsonCompat"]){
dojo._hasResource["lconn.core.util.jsonCompat"]=true;
dojo.provide("lconn.core.util.jsonCompat");
var JSON;
if(!JSON){
JSON={};
}
(function(){
"use strict";
function f(n){
return n<10?"0"+n:n;
};
if(typeof Date.prototype.toJSON!=="function"){
Date.prototype.toJSON=function(_1){
return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null;
};
String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(_2){
return this.valueOf();
};
}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,_3=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,_4,_5,_6={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\"":"\\\"","\\":"\\\\"},_7;
function _8(_9){
_3.lastIndex=0;
return _3.test(_9)?"\""+_9.replace(_3,function(a){
var c=_6[a];
return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);
})+"\"":"\""+_9+"\"";
};
function _a(_b,_c){
var i,k,v,_d,_e=_4,_f,_10=_c[_b];
if(_10&&typeof _10==="object"&&typeof _10.toJSON==="function"){
_10=_10.toJSON(_b);
}
if(typeof _7==="function"){
_10=_7.call(_c,_b,_10);
}
switch(typeof _10){
case "string":
return _8(_10);
case "number":
return isFinite(_10)?String(_10):"null";
case "boolean":
case "null":
return String(_10);
case "object":
if(!_10){
return "null";
}
_4+=_5;
_f=[];
if(Object.prototype.toString.apply(_10)==="[object Array]"){
_d=_10.length;
for(i=0;i<_d;i+=1){
_f[i]=_a(i,_10)||"null";
}
v=_f.length===0?"[]":_4?"[\n"+_4+_f.join(",\n"+_4)+"\n"+_e+"]":"["+_f.join(",")+"]";
_4=_e;
return v;
}
if(_7&&typeof _7==="object"){
_d=_7.length;
for(i=0;i<_d;i+=1){
if(typeof _7[i]==="string"){
k=_7[i];
v=_a(k,_10);
if(v){
_f.push(_8(k)+(_4?": ":":")+v);
}
}
}
}else{
for(k in _10){
if(Object.prototype.hasOwnProperty.call(_10,k)){
v=_a(k,_10);
if(v){
_f.push(_8(k)+(_4?": ":":")+v);
}
}
}
}
v=_f.length===0?"{}":_4?"{\n"+_4+_f.join(",\n"+_4)+"\n"+_e+"}":"{"+_f.join(",")+"}";
_4=_e;
return v;
}
};
if(typeof JSON.stringify!=="function"){
JSON.stringify=function(_11,_12,_13){
var i;
_4="";
_5="";
if(typeof _13==="number"){
for(i=0;i<_13;i+=1){
_5+=" ";
}
}else{
if(typeof _13==="string"){
_5=_13;
}
}
_7=_12;
if(_12&&typeof _12!=="function"&&(typeof _12!=="object"||typeof _12.length!=="number")){
throw new Error("JSON.stringify");
}
return _a("",{"":_11});
};
}
if(typeof JSON.parse!=="function"){
JSON.parse=function(_14,_15){
var j;
function _16(_17,key){
var k,v,_18=_17[key];
if(_18&&typeof _18==="object"){
for(k in _18){
if(Object.prototype.hasOwnProperty.call(_18,k)){
v=_16(_18,k);
if(v!==undefined){
_18[k]=v;
}else{
delete _18[k];
}
}
}
}
return _15.call(_17,key,_18);
};
_14=String(_14);
cx.lastIndex=0;
if(cx.test(_14)){
_14=_14.replace(cx,function(a){
return "\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);
});
}
if(/^[\],:{}\s]*$/.test(_14.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){
j=eval("("+_14+")");
return typeof _15==="function"?_16({"":j},""):j;
}
throw new SyntaxError("JSON.parse");
};
}
}());
}

dojo.provide("com.ibm.social.gadget.nls.i18n")._built=true;
dojo.provide("com.ibm.social.gadget.nls.i18n.en_us");
com.ibm.social.gadget.nls.i18n.en_us={"This is a link to the profile of ${0}":"This is a link to the profile of ${0}","Photo of ${0}":"Photo of ${0}"};
if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.social.gadget"]=true;

;if(!dojo._hasResource["com.ibm.social.gadget.people.util.localizer"]){
dojo._hasResource["com.ibm.social.gadget.people.util.localizer"]=true;
dojo.provide("com.ibm.social.gadget.people.util.localizer");




dojo.requireLocalization("com.ibm.social.gadget","i18n");
(function(){
var _1=function(_2,_3){
var _4=dojo.i18n.getLocalization("com.ibm.social.gadget","i18n");
_1=function(_5,_6){
var _7=_4[_5];
return (_6)?dojo.string.substitute(_7,_6):_7;
};
return _1(_2,_3);
};
dojo.declare("",null,{constructor:function(){
dojo.i18n.getLocalization("com.ibm.social.gadget","i18n");
}});
dojo.declare("com.ibm.social.gadget.people.util.localizer",null,{getLocalizedString:function(_8,_9){
return _1(_8,_9);
}});
})();
}


;if(!dojo._hasResource["com.ibm.social.gadget.people._vcard_utils"]){
dojo._hasResource["com.ibm.social.gadget.people._vcard_utils"]=true;
dojo.provide("com.ibm.social.gadget.people._vcard_utils");






com.ibm.social.gadget.people._vcard_utils=(function(){
var _1=(typeof lconn.core.config.services.profiles==="undefined"&&typeof lconn.core.config.services.scprofiles==="undefined")&&!(dojo.getObject("gadgets.util.hasFeature")&&dojo.getObject("gadgets.util.hasFeature")("smartcloud3"));
var _2=dojo.declare("",[com.ibm.social.gadget.people.util.localizer],{finalize_plain_vcards:function(_3){
if(_1){
this.killLinks_(_3);
}else{
}
return _3;
},finalize_biz_vcards:function(_4){
dojo.query("a.fn",_4).forEach(function(_5){
_5.removeAttribute("title");
});
SemTagSvc.parseDom(null,_4);
return _4;
},killLinks_:function(_6){
dojo.query("a.fn",_6).forEach(function(_7){
_7.removeAttribute("href");
_7.removeAttribute("target");
_7.removeAttribute("title");
dojo.style(_7,{"textDecoration":"none","cursor":"default"});
});
},generateVcard:function(_8,_9,_a,_b){
_b=_b||{"inline":false};
var _c=lconn.core.url.getServiceUrl(lconn.core.config.services.profiles);
var _d=this.getLocalizedString("Photo of ${0}",[_9]);
var _e=this.getLocalizedString("This is a link to the profile of ${0}",[_9]);
var _f=_c+"/html/profileView.do?userid="+_8;
var _10=dojo.create("span",{className:"vcard"});
_10=dojo.place(_10,_a.refNode,_a.relPos);
var _11=dojo.create("a",{href:_f,title:_e,className:"fn url bidiAware",target:this.linkTarget,innerHTML:_9},_10);
dojo.create("span",{className:"photo",src:_c+"/photo.do?userid="+_8,alt:_d,style:{display:"none"}},_11);
dojo.create("span",{className:"x-lconn-userid",style:{display:"none"},innerHTML:_8},_10);
if(_b.inline&&typeof window.SemTagSvc!=="undefined"){
return this.finalize_biz_vcards(_10);
}else{
return this.finalize_plain_vcards(_10);
}
}});
return new _2();
})();
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.people_container"]){
dojo._hasResource["com.ibm.lconn.gadget.services.people_container"]=true;
dojo.provide("com.ibm.lconn.gadget.services.people_container");








com.ibm.lconn.gadget.services.people_container=(function(){
var _1=dojo.declare("",[com.ibm.social.gadget.people.util.localizer],{generateVcard:function(_2,_3,_4){
var _5=lconn.core.url.getServiceUrl(lconn.core.config.services.profiles);
var _6=this.getLocalizedString("Photo of ${0}",[_3]);
var _7=this.getLocalizedString("This is a link to the profile of ${0}",[_3]);
var _8=_5+"/html/profileView.do?userid="+_2;
var _9=dojo.create("span",{className:"vcard"});
_9=dojo.place(_9,_4.refNode,_4.relPos);
var _a=dojo.create("a",{href:_8,title:_7,className:"fn url",target:this.linkTarget,innerHTML:_3},_9);
dojo.create("span",{className:"photo",src:_5+"/photo.do?userid="+_2,alt:_6,style:{display:"none"}},_a);
dojo.create("span",{className:"x-lconn-userid",style:{display:"none"},innerHTML:_2},_9);
return _9;
}});
return new _1();
})();
}

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.social.sharebox"]=true;

;if(!dojo._hasResource["com.ibm.social.sharebox._dialog_utils"]){
dojo._hasResource["com.ibm.social.sharebox._dialog_utils"]=true;
dojo.provide("com.ibm.social.sharebox._dialog_utils");
if(!com.ibm.social.sharebox._dialog_utils.getInstance){
dojo.mixin(com.ibm.social.sharebox._dialog_utils,(function(){
var _1;
function _2(){
return {close:function(){
},displayMessage:function(_3,_4){
},displayMessageHtml:function(_5,_6){
},shareAddActivityEntry:function(_7){
},setDirty:function(_8,_9){
},setSubmitState:function(_a){
},onClose:function(){
},onForceResize:function(){
}};
};
return {getInstance:function(){
if(!_1){
_1=_2();
}
return _1;
}};
})());
}
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.resources.iRuntimeModule"]){
dojo._hasResource["com.ibm.lconn.gadget.resources.iRuntimeModule"]=true;
dojo.provide("com.ibm.lconn.gadget.resources.iRuntimeModule");






}


;if(!dojo._hasResource["com.ibm.lconn.gadget.container.Views"]){
dojo._hasResource["com.ibm.lconn.gadget.container.Views"]=true;
dojo.provide("com.ibm.lconn.gadget.container.Views");
dojo.declare("com.ibm.lconn.gadget.container.Views",null,{registerCreateElementGadgetHandler:function(_1,_2,_3){
},registerCreateElementForEEHandler:function(_4,_5,_6){
},registerCreateElementForUrlHandler:function(_7,_8,_9){
}});
dojo.mixin(com.ibm.lconn.gadget.container.Views,{__instance__:function(){
}});
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.util.domStore"]){
dojo._hasResource["com.ibm.lconn.gadget.util.domStore"]=true;
dojo.provide("com.ibm.lconn.gadget.util.domStore");
com.ibm.lconn.gadget.util.domStore=(function(){
var _1=[0],_2="data-iContainer-data-"+ +new Date();
return function(_3){
var _4=dojo.attr(_3,_2),_5=_1.length;
if(!_4){
_4=_5;
dojo.attr(_3,_2,_5);
_1[_4]={};
}
return {get:function(_6){
return _1[_4][_6];
},set:function(_7,_8){
_1[_4][_7]=_8;
return _8;
}};
};
})();
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.ViewHandler"]){
dojo._hasResource["com.ibm.lconn.gadget.services.ViewHandler"]=true;
dojo.provide("com.ibm.lconn.gadget.services.ViewHandler");


(function(_1,_2){
var _3="_____NULL_____";
var _4="data-iContainer-destroy-handler";
function _5(_6){
if(!_6||_6===""){
return _3;
}else{
return _6;
}
};
function _7(_8){
return _8.el_;
};
_1.declare("com.ibm.lconn.gadget.services.ViewHandler",null,{_registry:null,_handledMethod:null,constructor:function(_9){
this._registry={};
this._handledMethod=_9;
},registerHandler:function(_a,_b,_c){
_a=_5(_a);
var _d={"createHandler":_b,"destroyHandler":_c};
this._registry[_a]=_d;
},invokeCreate:function(_e,_f,_10){
_f=_5(_f);
var _11=this._registry,_12=_11[_f]||_11[_3];
_13=null;
if(_12){
var _13=_12.createHandler.apply(_e,_10);
_2(_13).set(_4,_12.destroyHandler);
return _13;
}else{
throw "Unknown view target for "+this._handledMethod+": "+_f;
}
}});
_1.mixin(com.ibm.lconn.gadget.services.ViewHandler,{invokeDestroy:function(_14,_15,_16){
var _17=_7(_15),_18=_2(_17).get(_4);
if(_18){
_18.apply(_14,_16);
}else{
throw "Could not find handler method";
}
}});
})(dojo,com.ibm.lconn.gadget.util.domStore);
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.ViewContainer"]){
dojo._hasResource["com.ibm.lconn.gadget.services.ViewContainer"]=true;
dojo.provide("com.ibm.lconn.gadget.services.ViewContainer");




(function(_1,_2,_3){
var _4=_1.declare("com.ibm.lconn.gadget.services.ViewContainer",[_2],{_createForGadgetRegistry:null,_createForEERegistry:null,_createForUrlRegistry:null,_container:null,constructor:function(){
this._createForGadgetRegistry=new _3("createElementForGadget");
this._createForEERegistry=new _3("createElementForEmbeddedExperience");
this._createForUrlRegistry=new _3("createElementForUrl");
},registerCreateElementGadgetHandler:function(_5,_6,_7){
return this._createForGadgetRegistry.registerHandler(_5,_6,_7);
},registerCreateElementForEEHandler:function(_8,_9,_a){
return this._createForEERegistry.registerHandler(_8,_9,_a);
},registerCreateElementForUrlHandler:function(_b,_c,_d){
return this._createForUrlRegistry.registerHandler(_b,_c,_d);
},bindContainer:function(_e){
this._container=_e;
},createElementForGadget:function(_f,rel,_10,_11,_12,_13){
return this._createForGadgetRegistry.invokeCreate(this._container,_11,arguments);
},createElementForEmbeddedExperience:function(rel,_14,_15,_16,_17){
return this._createForEERegistry.invokeCreate(this._container,_15,arguments);
},createElementForUrl:function(rel,_18,_19,_1a){
return this._createForUrlRegistry.invokeCreate(this._container,_18,arguments);
},destroyElement:function(_1b){
return _3.invokeDestroy(this._container,_1b,arguments);
}});
var _1c=new _4();
_2.__instance__=function(){
return _1c;
};
})(dojo,com.ibm.lconn.gadget.container.Views,com.ibm.lconn.gadget.services.ViewHandler);
}

dojo.provide("com.ibm.lconn.gadget.nls.gadgetDialogStrings")._built=true;
dojo.provide("com.ibm.lconn.gadget.nls.gadgetDialogStrings.en_us");
com.ibm.lconn.gadget.nls.gadgetDialogStrings.en_us={"cancel":{"a11y":"Cancel","label":"Cancel","tooltip":"Cancel"}};

;dojo.cache("com.ibm.lconn.gadget", "services/dialog/templates/GadgetDialog.html", "<div aria-live=\"assertive\"><div id=\"${id}_dialog\" role=\"dialog\" aria-labelledby=\"${gadgetNodeId}_title\"> <div class=\"lotusDialogBorder\"> <div class=\"lotusDialog\"> <div class=\"lotusDialogHeader\"> <h1 dojoAttachPoint=\"titleNode\" id=\"${gadgetNodeId}_title\" class=\"lotusHeading\">${gadgettitle}</h1> <a class=\"lotusDialogClose\" role=\"button\" href=\"javascript:;\" dojoAttachEvent=\"onclick:closeDialog\" title=\"${nlsCommon.rs_close}\"> <img alt=\"${nlsCommon.rs_close}\" src=\"${blankGif}\" /> <span class=\"lotusAltText\">${nlsCommon.rs_close}</span> </a> </div> <div class=\"lotusDialogContent\" id=\"${gadgetNodeId}\" dojoAttachPoint=\"gadgetNode\" style=\"padding-right:0px;padding-bottom:0px;overflow:auto;width:${gadgetwidth};height:${gadgetheight};\">gadget goes here</div> </div> </div></div></div>");

;if(!dojo._hasResource["com.ibm.lconn.gadget.services.dialog.GadgetDialog"]){
dojo._hasResource["com.ibm.lconn.gadget.services.dialog.GadgetDialog"]=true;
dojo.provide("com.ibm.lconn.gadget.services.dialog.GadgetDialog");










dojo.requireLocalization("com.ibm.lconn.gadget","gadgetDialogStrings");
dojo.requireLocalization("lconn.core","strings");
dojo.declare("com.ibm.lconn.gadget.services.dialog.GadgetDialog",[dijit._Widget,dijit._Templated],{blankGif:"",_extents:{"height":300,"width":700},nlsCommon:dojo.i18n.getLocalization("lconn.core","strings"),templatePath:dojo.moduleUrl("com.ibm.lconn.gadget","services/dialog/templates/GadgetDialog.html"),popup:null,_setExtentStyle:function(_1,_2){
var _3="gadget"+_1;
if((typeof (_2)!="undefined")&&(_2!=null)){
var _4=_2["modulePrefs"][_1];
if(_4!=0){
this._extents[_1]=_4;
}
}
this[_3]=this._extents[_1]+"px";
},constructor:function(_5){
var _6=function(_7,_8){
var _9="gadgettitle";
if(typeof _8!="undefined"){
var _a=_8["modulePrefs"]["title"];
this[_9]=_a!==""?_a:_7;
}else{
this[_9]=_7;
}
};
_6.apply(this,["Gadget Dialog",_5.gadget_metadata]);
this._setExtentStyle("width",_5.gadget_metadata);
this._setExtentStyle("height",_5.gadget_metadata);
this.inherited(arguments);
},postMixInProperties:function(){
this.blankGif=dojo.config.blankGif;
this.inherited(arguments);
this.nls=dojo.i18n.getLocalization("com.ibm.lconn.gadget","gadgetDialogStrings");
},postCreate:function(){
this._subscribeAll();
},_subscribeAll:function(){
var _b=com.ibm.lconn.gadget.container.Topics.getSiteTopic(this.gadgetNodeId,com.ibm.lconn.gadget.container.Topics.GadgetWindow.SITE_TOPIC_SET_TITLE);
this.subscribe(_b,"onGadgetTitleUpdated");
_b=com.ibm.lconn.gadget.container.Topics.getSiteTopic(this.gadgetNodeId,com.ibm.lconn.gadget.container.Topics.GadgetWindow.AFTER_ADJUST_WIDTH);
this.subscribe(_b,"onWidthUpdated");
_b=com.ibm.lconn.gadget.container.Topics.getSiteTopic(this.gadgetNodeId,com.ibm.lconn.gadget.container.Topics.GadgetWindow.AFTER_ADJUST_HEIGHT);
this.subscribe(_b,"onHeightUpdated");
_b=com.ibm.lconn.gadget.container.Topics.getLifecycleEventTopic(osapi.container.CallbackType.ON_RENDER);
this.subscribe(_b,"onGadgetLoaded");
},show:function(){
if(this.popup==null){
this.popup=new dijit.Dialog();
}
this.popup.attr({content:this.domNode,title:""});
this.popup.show();
},_updateStyles:function(){
this.popup.resize();
try{
dojo.style(this.gadgetNode,"overflow",null);
}
catch(e){
}
var _c=dojo.style(this.popup.containerNode,"height");
var _d=dojo.style(this.popup.containerNode,"width");
if(_c<this._extents["height"]){
dojo.style(this.gadgetNode,"height","auto");
dojo.style(this.popup.containerNode,"height","auto");
if(!dojo.isIE){
if(dojo.isSafari){
dojo.style(this.gadgetNode,"height",this._extents.height+"px");
}else{
dojo.style(this.gadgetNode,"height","auto");
}
dojo.style(this.popup.containerNode,"overflow","visible");
}else{
dojo.style(this.popup.containerNode,"height",(this._extents.height+67)+"px");
dojo.style(this.popup.containerNode,"overflow","visible");
}
}
if(_d<this._extents["width"]){
dojo.style(this.popup.containerNode,"width","auto");
if(!dojo.isIE){
dojo.style(this.gadgetNode,"width","auto");
dojo.style(this.popup.containerNode,"overflow","visible");
}else{
dojo.style(this.popup.containerNode,"width",(this._extents.width+25)+"px");
dojo.style(this.popup.containerNode,"overflow","visible");
}
}
},hide:function(){
this.popup.hide();
},destroy:function(){
this.inherited(arguments);
},onGadgetTitleUpdated:function(_e){
this.titleNode.innerHTML=_e;
},onWidthUpdated:function(_f){
this._extents.width=dojo.style(dojo.query("iframe",this.gadgetNode)[0],"width");
this._updateStyles();
},onHeightUpdated:function(_10){
this._extents.height=dojo.style(dojo.query("iframe",this.gadgetNode)[0],"height");
this._updateStyles();
},onGadgetLoaded:function(_11,_12){
if(dojo.isIE&&_12==this.gadgetNodeId){
if(_12===this.gadgetNodeId){
var _13=dojo.query("iframe",dojo.byId(_12))[0];
if(_13){
if(dojo.attr(_13,"scrolling")=="no"){
dojo.attr(_13,"scrolling","auto");
}
}
}
}
var _13=dojo.query("iframe",this.gadgetNode)[0];
if(_13){
dojo.style(_13,"maxHeight","300px");
dojo.style(this.gadgetNode,{"height":"auto","width":"auto"});
this._updateStyles();
if(dojo.query("iframe",this.gadgetNode).length>0){
dojo.query("iframe",this.gadgetNode)[0].setAttribute("role","presentation");
}
}
},closeDialog:function(){
this.hide();
}});
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.util.specHelper"]){
dojo._hasResource["com.ibm.lconn.gadget.util.specHelper"]=true;
dojo.provide("com.ibm.lconn.gadget.util.specHelper");






com.ibm.lconn.gadget.util.specHelper=(function(_1){
var _2={},_3=dojo.getObject("location",dojo.global).toString(),_4=function(){
},_5=dojo.global;
var _6=function(_7){
if(_7){
if(dojo.isString(_7)){
return function(){
(_5[_7]||_4).apply(null,arguments);
};
}else{
return _7;
}
}else{
return _4;
}
};
var _8=_2.nextDomId=function(){
return "gadget_"+dojox.uuid.generateRandomUuid();
};
var _9=function(_a){
var _b=_a.placement;
if(_b&&!dojo.isString(_b)){
if(!_b.id){
_b.id=_8();
}
}
};
var _c=function(_d){
return (_d&&_d.instanceData&&_d.instanceData.renderType&&_d.instanceData.renderType==="inline");
};
var _e=_2.isGadget=function(_f){
return (_f&&_f.componentType&&_f.componentType==="gadget");
};
var _10=_2.isEEGadget=function(_11){
return (_e(_11)&&_11.instanceData&&_11.instanceData.eeDataModel);
};
var _12=_2.isInlineEE=function(_13){
return (_10(_13)&&_c(_13));
};
var _14=_2.isInlineGadget=function(_15){
return (_e(_15)&&_c(_15));
};
var _16=_2.normalizeWidgetSpec=function(_17){
var _18=null,_19=null,_1a=null,_1b=null;
_17.definitionUrl=_1.parse(_3,_17.definitionUrl).toString();
_18=_17.instanceData||(_17.instanceData={});
if(_12(_17)){
throw "Inline EE gadgets are not permitted. Attempted to load: "+_17.definitionUrl;
}
if(_e(_17)){
_18=_17.instanceData||(_17.instanceData={});
_19=_18.renderParams||(_18.renderParams={});
var _1c=_19.userPrefs||(_19.userPrefs={});
if(lconn.core.globalization.api){
_1c["lconn.core.globalization.api.calendar"]=lconn.core.globalization.api.getCalendar();
_1c["lconn.core.globalization.api.textDirection"]=lconn.core.globalization.api.getTextDirection();
_1c["lconn.core.globalization.api.bidiEnabled"]=lconn.core.globalization.api.isBidiEnabled();
}
if(dojo.config.isDebug){
_19[com.ibm.lconn.gadget.container.Container.RenderParam.TEST_MODE]=true;
}
}
_9(_17);
_18.errback=_6(_17.errback);
return _17;
};
var _1d=_2.cloneSpec=function(_1e){
if(!_1e){
return _1e;
}
var _1f={};
for(var key in _1e){
if(key==="placement"){
var val=_1e[key];
if(!dojo.isString(val)){
val=dojo.byId(val).id;
}
_1f[key]=val;
}else{
_1f[key]=_1e[key];
}
}
return _1f;
};
return _2;
})(lconn.core.url);
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.util.trace"]){
dojo._hasResource["com.ibm.lconn.gadget.util.trace"]=true;
dojo.provide("com.ibm.lconn.gadget.util.trace");
com.ibm.lconn.gadget.util.trace=(function(){
var _1={},_2=dojo.global,_3=null,_4=null;
if(!_2.console){
_4={log:function(){
}};
}else{
_4=console;
}
if(dojo.isFunction(_4.log)&&_4.log.apply){
_3=function(_5){
return dojo.hitch(_4,_4[_5]);
};
}else{
_3=function(_6){
return function(){
_4[_6](Array.prototype.slice.call(arguments));
};
};
}
dojo.forEach(["log","debug","warn","error"],function(_7){
if(_2.console&&(_7!=="debug"||dojo.config.isDebug===true)){
_1[_7]=(_4[_7])?_3(_7):_3("log");
}else{
_1[_7]=function(){
};
}
});
_1.entering=function(_8,_9,_a){
if(!_a){
_1.debug("ENTER: "+_8+"."+_9);
}else{
_1.debug("ENTER: "+_8+"."+_9);
}
};
_1.exiting=function(_b,_c,_d){
if(!_d){
_1.debug("EXITING: "+_b+"."+_c);
}else{
_1.debug("EXITING: "+_b+"."+_c);
}
};
_1.throwing=function(_e,_f,_10){
if(!_10){
_1.debug("THOWING: "+_e+"."+_f);
}else{
_1.debug("THOWING: "+_e+"."+_f+" -- ERROR: "+dojo.toJson(_10));
}
};
return _1;
})();
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.viewModifications"]){
dojo._hasResource["com.ibm.lconn.gadget.services.viewModifications"]=true;
dojo.provide("com.ibm.lconn.gadget.services.viewModifications");














com.ibm.lconn.gadget.services.viewModifications=(function(_1,_2){
var _3={};
var _4=com.ibm.lconn.gadget.container.Views.__instance__();
var _5=com.ibm.lconn.gadget.util.specHelper.nextDomId;
var _6=function(_7,_8){
var _9=osapi.container.GadgetSite.prototype[_7];
osapi.container.GadgetSite.prototype[_7]=function(){
_9.apply(this,arguments);
var _a=com.ibm.lconn.gadget.container.Topics.getSiteTopic(this.getId(),com.ibm.lconn.gadget.container.Topics.GadgetWindow[_8]);
dojo.publish(_a,Array.prototype.slice.call(arguments,0));
};
};
_3.registerService=function(_b){
var _c=_b.views;
_4.bindContainer(_b);
_c.createElementForGadget=dojo.hitch(_4,"createElementForGadget");
_c.createElementForEmbeddedExperience=dojo.hitch(_4,"createElementForEmbeddedExperience");
_c.createElementForUrl=dojo.hitch(_4,"createElementForUrl");
_c.destroyElement=dojo.hitch(_4,"destroyElement");
_b.rpcRegister("requestNavigateTo",function(_d,_e,_f,_10){
var _11=_d.gs;
var _12=_11.currentGadgetHolder_.gadgetInfo_.url;
var _13=_11.currentGadgetHolder_.renderParams_||{};
_13.view=_e;
var _14={};
if(_f){
if(dojo.isObject(_f)){
dojo.mixin(_14,_f);
}else{
if(dojo.isString(_f)){
dojo.mixin(_14,_1.splitQuery(_f));
}else{
_2.log("opt_params passed to gadgets.views.requestNavigateTo could not be processed.",_f);
}
}
}
_b.navigateGadget(_11,_12,_14,_13,null);
});
_6("setHeight","AFTER_ADJUST_HEIGHT");
_6("setWidth","AFTER_ADJUST_WIDTH");
};
_4.registerCreateElementGadgetHandler(null,_15,_16);
_4.registerCreateElementForEEHandler(null,_17,_16);
_4.registerCreateElementForUrlHandler(null,_18,_16);
function _15(_19,rel,_1a,_1b,_1c,_1d){
var _1e=_1a||"default";
var _1f=_1b||"default";
switch(_1f.toLowerCase()){
case "modaldialog":
return _20(this,true,_1e,true,_19);
break;
default:
return _20(this,true,_1e,true,_19);
}
};
function _17(rel,_21,_22,_23,_24){
return _20(this,true,"embedded",true);
};
function _18(rel,_25,_26,_27){
return _17.apply(this,arguments);
};
function _16(_28){
_29(this,_28);
};
function _20(_2a,_2b,_2c,_2d,_2e,_2f){
var _30=_5();
var _31={"id":"gadget_dialog_"+_30,"gadgetNodeId":_30,"gadget_metadata":_2e};
var _32=new com.ibm.lconn.gadget.services.dialog.GadgetDialog(_31);
_32.closeDialog=function(){
var _33=dojo.attr(dojo.query("#"+_30+">iframe")[0],"id");
_16.call(_2a,_2a.getGadgetSiteByIframeId_(_33));
};
_32.show();
return _32.gadgetNode;
};
function _29(_34,_35){
var _36=_35.el_.id;
var _37="gadget_dialog_"+_36;
_34.closeGadget(_35);
var _38=dijit.byId(_37);
if(_38){
_38.hide();
_38.destroyRecursive();
}
};
return _3;
})(lconn.core.url,com.ibm.lconn.gadget.util.trace);
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.lifecycleModifications"]){
dojo._hasResource["com.ibm.lconn.gadget.services.lifecycleModifications"]=true;
dojo.provide("com.ibm.lconn.gadget.services.lifecycleModifications");
com.ibm.lconn.gadget.services.lifecycleModifications=(function(){
var _1={};
_1.registerService=function(_2){
var _3,_4,_5;
_3=com.ibm.lconn.gadget.container.Topics.getMasterLifecycleTopic();
_4={};
_5=function(_6,_7){
var _8=com.ibm.lconn.gadget.container.Topics.getLifecycleEventTopic(_6);
return function(){
dojo.publish(_8,arguments);
dojo.publish(_7,arguments);
};
};
for(var _9 in osapi.container.CallbackType){
_4[osapi.container.CallbackType[_9]]=_5(osapi.container.CallbackType[_9],_3);
}
_2.addGadgetLifecycleCallback("lconn_gadget_lifecycle_publisher",_4);
};
return _1;
})();
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.set_title"]){
dojo._hasResource["com.ibm.lconn.gadget.services.set_title"]=true;
dojo.provide("com.ibm.lconn.gadget.services.set_title");




com.ibm.lconn.gadget.services.set_title=(function(_1){
var _2={};
_2.registerService=function(_3){
_3.rpcRegister("set_title",function(_4,_5){
var _6,_7;
if(_4.gs&&_4.gs.id_){
var _8=com.ibm.lconn.gadget.container.Topics.getSiteTopic(_4.gs.id_,com.ibm.lconn.gadget.container.Topics.GadgetWindow.SITE_TOPIC_SET_TITLE);
dojo.publish(_8,[_5]);
_7=document.getElementById(_4.gs.id_);
if(_7.title){
_7.title=_5;
}
}else{
_1.log("looks like you're trying to set the title on an inline gadget, you need to use a better rpc call");
_1.log("try gadgets.rpc.call('', 'set_title', null, {'mid':__MODULE_ID__})");
}
});
};
return _2;
})(com.ibm.lconn.gadget.util.trace);
}

dojo.provide("com.ibm.lconn.gadget.nls.iframeDialogStrings")._built=true;
dojo.provide("com.ibm.lconn.gadget.nls.iframeDialogStrings.en_us");
com.ibm.lconn.gadget.nls.iframeDialogStrings.en_us={"dialogTitle":"OAuth Authorization"};

;if(!dojo._hasResource["com.ibm.lconn.gadget.services.dialog.IframeDialog"]){
dojo._hasResource["com.ibm.lconn.gadget.services.dialog.IframeDialog"]=true;
dojo.provide("com.ibm.lconn.gadget.services.dialog.IframeDialog");


dojo.requireLocalization("com.ibm.lconn.gadget","iframeDialogStrings");
dojo.declare("com.ibm.lconn.gadget.services.dialog.IframeDialog",null,{nls:dojo.i18n.getLocalization("com.ibm.lconn.gadget","iframeDialogStrings"),_w:500,_h:500,_url:"",_ifElement:null,_dialog:null,_wRegex:/width=(\d+)/,_hRegex:/height=(\d+)/,isAuto:null,constructor:function(_1,_2,_3){
this._url=_1;
this.isAuto=_3;
if(_2){
var _4,_5;
if(_4=_2.match(this._wRegex)){
this._w=_4[1];
}
if(_5=_2.match(this._hRegex)){
this._h=_5[1];
}
}
},init:function(_6,_7){
if(!this._dialog){
var _8=this._dialog=new dijit.Dialog({title:this.nls.dialogTitle,"class":"lcSharebox"});
var _9=document.createElement("div");
var _a="<iframe";
if(_6){
_a+=" id='"+_6+"'";
_a+=" name='"+_6+"'";
}
_a+="></iframe>";
_9.innerHTML=_a;
var _b=this._ifElement=_9.firstChild;
if(_7){
dojo.attr(_8.containerNode,"id",_7);
}
dojo.attr(_b,"src",this._url);
if(this._w){
_b.style.width=this._w+"px";
}
if(this._h){
_b.style.height=this._h+"px";
}
_8.attr("content",_b);
dojo.connect(_8,"onHide",this,"onClose");
}
},show:function(){
this._dialog.show();
},getWindow:function(){
return this._ifElement.contentWindow;
},hide:function(){
this._dialog.hide();
},destroy:function(){
this._dialog.destroyRecursive(false);
},onClose:function(){
}});
}

dojo.provide("com.ibm.social.ee.nls.socialEEStrings")._built=true;
dojo.provide("com.ibm.social.ee.nls.socialEEStrings.en_us");
com.ibm.social.ee.nls.socialEEStrings.en_us={"size":{"B":"${0} B","GB":"${0} GB","MB":"${0} MB","KB":"${0} KB"},"REPLIES_SUBMITTED":{"CONFIRM":"Your reply has been submitted for review and will be available when approved."},"DOWNLOAD_INFO":{"COUNT_SHORT":"${0}-${1}","COUNT":"${0}-${1} of ${2}","PAGE":"Page","ITEMS_PER_PAGE":" items per page.","SHOW_PEOPLE":"See who has downloaded...","ELLIPSIS":"...","NEXT":"Next","PREVIOUS":"Previous","NEXT_TOOLTIP":"Next page","VERSION":{"MONTH":"Version ${version} on ${date}","TODAY":"Version ${version} at ${time}","YESTERDAY":"Version ${version} yesterday","DAY":"Version ${version} on ${date}","YEAR":"Version ${version} on ${date}"},"PREVIOUS_TOOLTIP":"Previous page","FILE":{"ERROR":"Unable to load download information","V_LATEST":"You have downloaded the latest version of this file","V_OLDER":"You last downloaded version ${0} of this file","LOADING":"Loading...","EMPTY":"Anonymous users only"},"SHOW":"Show"},"EE_DIALOG":{"CONFIRM_CLOSE_MESSAGE":"Are you sure you want to abandon your changes? Press OK to continue or Cancel to return","ERROR_MSG_GENERIC":"Something went wrong.  Please try again.","ERROR_MSG_CONTENT_NOT_AVAILABLE":"The content for this item is not available.","TITLE_NI":"${author} invited you to join their network.","AUTHOR_TITLE":"View profile for ${author}","ERROR":"Error","ERROR_MSG_NOT_AVAILABLE":"This item has been deleted or is no longer available.","TITLE_SU":"${author} posted a message.","ERROR_MSG_NO_ACCESS":"You no longer have access to this item.","OPEN_LINK":"Open ${title}","CONFIRM_CLOSE_TITLE":"Confirm","CANCEL":"Cancel","ERROR_ALT_TEXT":"Error:","OK":"OK","LOADING":"Loading..."},"COMMENTS_SUBMITTED":{"OK":"OK","CONFIRM":"Your comment has been submitted for review and will be available when approved.","DIALOG_TITLE":"Submission Confirmation"},"FILE_SHARE_INFO":{"ADD":"Add","READERS_LABEL":"Readers: ","SHARE_WITH":"Share with:","COMMUNITY":"a Community","A11Y_READER_REMOVED":"Removed ${0} as a reader","READER_IF_PUBLIC":"Everyone (public)","INFO_SUCCESS":"The file was shared successfully.","ADD_TXT":"Add people or communities as readers","PLACEHOLDER":"Person name or email...","PERSON":"a Person","SELECT_USER_ERROR":"You must select at least one person or community to share with","SHOW_MORE":"Show more...","EDITORS_LABEL":"Editors: ","EMPTY_READERS":"None","NOT_LOGGED_IN_ERROR":"The file was not shared because you were not logged in.  Click \'Share\' to share the file.","TRIM_LONG_MESSAGE":"Shorten message?","SELF_REFERENCE_ERROR":"You cannot share with yourself.","TOOLTIP":"Give others access to this file","CANCEL_ERROR":"The file was not shared because the request was cancelled.  Click \'Share\' to try again.","ERROR_SHARING":"The file could not be shared.  Please try again later.","MESSAGE":"Message:","VISIBILITY_RESTRICTION_ERROR_SHARE":"A file that is restricted may not be made public.","OWNER_REFERENCE_ERROR":"You cannot share with the owner of the file.","ERROR":"Unable to load share information","OWNER_LABEL":"Owner: ","TIMEOUT_ERROR":"The file was not shared because the server could not be contacted.  Click \'Share\' to try again.","A11Y_READER_ADDED":"Selected ${0} as a reader","READER_IF_PUBLIC_TOOLTIP":"This file is public and visible to everyone","MAX_SHARES_ERROR":"The maximum number of shares has been exceeded.","REMOVE_ITEM_ALT":"Remove ${0}","MESSAGE_TXT":"Add an optional message","CANCEL":"Cancel","NO_MEMBERS":"None","SHARE_COMMUNITY_WARN":"Sharing with the public community \'${0}\' will make this file public.","WARN_LONG_MESSAGE":"The message is too long.","ACCESS_DENIED_ERROR":"You no longer have permission to share this file.","NOT_FOUND_ERROR":"The file has been deleted or is no longer visible to you and cannot be shared.","SHARE":"Share","ERROR_ACCESS_DENIED":"You do not have permission to view this file.  The file is not public and is not shared with you.","ERROR_NOT_FOUND":"The file you have requested has been deleted or moved. If someone sent you this link, check that it is correct."},"repost":{"title":"Repost this update to my followers or communities","msg_generic":"Something went wrong.  Please try again.","name":"Repost","msg_success":"The update was successfully reposted to your followers."},"authUser":{"error":"An error occurred retrieving the current user.  ${again}.","error_403":"You do not have permission to retrieve user information.","error_again":"Please try again","error_404":"Unable to find authenticated user."},"COMMENTS_DELETE":{"DIALOG_TITLE":"Delete Comment","CANCEL":"Cancel","TOOLTIP":"Delete Comment","NAME":"Delete Comment","OK":"OK"},"generic":{"visibility":{"pub":"Public","priv":"Private"},"comments":"Comments","untitled":"(Untitled)","action":{"created":"Created","updated":"Updated"},"timestamp":{"created":{"MONTH":"Created ${MMM} ${d}","TODAY":"Created today at ${time}","YESTERDAY":"Created yesterday at ${time}","DAY":"Created ${EEEE} at ${time}","TOMORROW":"Created ${MMM} ${d}, ${YYYY}","YEAR":"Created ${MMM} ${d}, ${YYYY}"},"updated":{"MONTH":"Updated ${MMM} ${d}","TODAY":"Updated today at ${time}","YESTERDAY":"Updated yesterday at ${time}","DAY":"Updated ${EEEE} at ${time}","TOMORROW":"Updated ${MMM} ${d}, ${YYYY}","YEAR":"Updated ${MMM} ${d}, ${YYYY}"}},"error":"Unable to retrieve data.","tags":"Tags:","titleTooltip":"Navigate to ${app}","tags_more":"and ${0} more","likes":"Likes"},"statusUpdate":{"notifications":{"POST_COMMENT":"${user} wrote:","USER_BOARD_POST":"${user} wrote on your board","STATUS_UPDATE":"${user} posted a message"},"error":"An error occurred.  ${again}.","error_404":"The status update no longer exists.","error_again":"Please try again","createdCompact":{"MONTH":"Created: ${MMM} ${d}","TODAY":"Created: Today at ${time}","YESTERDAY":"Created: Yesterday at ${time}","DAY":"Created: ${EEEE} at ${time}","TOMORROW":"Created: ${MMM} ${d}, ${YYYY}","YEAR":"Created: ${MMM} ${d}, ${YYYY}"}},"VERSIONS":{"REVERT_DESCRIPTION":"Restored from version ${0}","ERROR_REQUEST_UNKNOWN":"An unknown error has occurred.","DELETE_VERSION_SINGLE":"Delete version ${0}","ERROR_REQUEST_CANCELLED":"The request was canceled.","COUNT_SHORT":"${0}-${1}","PAGE":"Page","ITEMS_PER_PAGE":" items per page.","ELLIPSIS":"...","NEXT_TOOLTIP":"Next page","CONTENT":{"DOWNLOAD":"Download","VIEW_TOOLTIP":"View version ${0}","REVERT":{"WIDGET":"Restore this version","A11Y":"This button opens a dialog that allows the user to confirm restoring a file from a previous version. Confirming this action will result in a refresh of the contents on the page.","FULL":"Restore"},"DOWNLOAD_TOOLTIP":"Download this version (${0})","VIEW":"View","DELETE_TOOLTIP":"Delete version ${0}"},"NO_VERSIONS":"There are no versions","CREATE_VERSION_TOOLTIP":"Create a version of this file","ERROR_REQUEST_TIMEOUT":"The server could not be contacted.","PREVIOUS_TOOLTIP":"Previous page","LOADING":"Loading ..","DELETEERROR":"The version was not deleted due to an error.","REVERT_VERSION":"Restore version ${0}","REVERT":{"GENERIC_ERROR":"The version could not be restored because of an unknown error.  Click \'Restore\' again to try your request again.","ERROR_CANCEL":"The version was not restored because the request was canceled.  Click \'Restore\' again to try your request again.","ERROR_QUOTA_VIOLATION":"The version could not be restored because of space restrictions.","ERROR_NAME_EXISTS":"The version could not be restored because another file has the same name.","ERROR_MAX_CONTENT_SIZE":"The version could not be restored because it is larger than the maximum allowed file size of ${0}","ERROR_TIMEOUT":"The version was not restored because the server could not be contacted.  Click \'Restore\' again to try your request again.","ERROR_NOT_FOUND":"The version could not be restored because it has been deleted or is no longer visible to you.","ERROR_ACCESS_DENIED":"The version could not be restored because you are not an editor."},"ERROR":"Unable to load version information.","DELETE":{"GENERIC_ERROR":"The version could not be deleted because of an unknown error.  Click \'Delete\' again to try your request again.","ERROR_CANCEL":"The version was not deleted because the request was canceled.  Click \'Delete\' again to try your request again.","A11Y":"This button opens a dialog that allows the user to confirm the deletion of this version. Confirming this action will result in a refresh of the contents on the page.","ERROR_TIMEOUT":"The version was not deleted because the server could not be contacted.  Click \'Delete\' again to try your request again.","ERROR_NOT_FOUND":"The version could not be deleted because it has been already deleted or is no longer visible to you.","ERROR_ACCESS_DENIED":"The version could not be deleted because you are not an editor.","ERROR_NOT_LOGGED_IN":"You must be logged in to delete this version.  Click \'Delete\' to be prompted to log in.","FULL":"Delete"},"DELETE_ALL":"Delete all versions prior to version","DATE":{"RELATIVE_TIME":{"MONTH":"${date}","TODAY":"Today at ${time}","YESTERDAY":"Yesterday at ${time}","DAY":"${date}","YEAR":"${date_long}","FULL":"${date_long} ${time_long}"},"UPDATED":{"MONTH":"Updated ${date_short}","TODAY":"Updated today at ${time}","YESTERDAY":"Updated yesterday at ${time}","DAY":"Updated ${EEee} at ${time}","YEAR":"Updated ${date_short}","FULL":"${EEEE}, ${date_long} ${time_long}"},"AM":"AM","RELATIVE_TIME_L":{"MONTH":"${date_short} at ${time}","TODAY":"today at ${time}","YESTERDAY":"yesterday at ${time}","DAY":"${EEee} at ${time}","YEAR":"${date_short} at ${time}","FULL":"${EEEE}, ${date_long} ${time_long}"}},"INFO":"Version ${0} created ${1} by ","COUNT":"${0}-${1} of ${2}","VERSION_NUMBER":"Version ${0}","NEXT":"Next","CREATE_VERSION":"Create a new version","PREVIOUS":"Previous","DELETED":"Deleted","SHOW":"Show"},"forum":{"attachments":"${count} Attachments","error_403":"You do not have permission to view this forum. The forum is not public and is not shared with you.","error_404":"The forum no longer exists or you do not have sufficient permissions to access it.","QUESTION_NOT_ANSWERED":"This question has not been answered yet.","QUESTION_ANSWERED":"This question has been answered.","attachments_one":"${count} Attachment","error":"An error occurred.  ${again}.","error_again":"Please try again","readMore":"View full topic...","readMore_a11y":"Activating this link will open the ${name} forum topic in a new window.","readMore_tooltip":"Open the ${name} forum topic."},"THISCOMMENT":{"TAB_TITLE":"This Comment","REPLY_ACTION_TOOLTIP":"Reply to this comment","REPLY_ACTION":"Reply"},"blog":{"error_403":"You do not have permission to view this blog. The blog is not public and is not shared with you.","error_404":"The blog no longer exists or you do not have sufficient permissions to access it.","error":"An error occurred.  ${again}.","graduated":"Graduated","error_again":"Please try again","vote":{"LOADING":"Loading...","TEMPLATE_STRINGS":{"LIKES":"Voted"},"INLINE":{"RECOMMENDED_BYMANY":{"TEXT":"${recommendCount}","TOOLTIP":"${recommendCount} voted for this","READONLYTEXT":"${recommendCount}"},"UNRECOMMENDED":{"TEXT":"\x3ca class=\'lotusLikeAction\' role=\'button\' href=\'javascript:;\' id=\'TOGGLE_${id}\'\x3eVote\x3c/a\x3e","TOOLTIP":"Vote for this","READONLYTEXT":""},"RECOMMENDED_BYONE":{"TEXT":"${recommendCount}","TOOLTIP":"1 person voted for this","READONLYTEXT":"${recommendCount}"},"RECOMMENDED_BYNONE":{"TEXT":"${recommendCount}","TOOLTIP":"0 people voted for this","READONLYTEXT":"${recommendCount}"},"RECOMMENDED":{"TEXT":"\x3cspan class=\'lotusLikeDescription\'\x3eVoted\x3c/span\x3e \x3cspan class=\'lotusDivider\' role=\'presentation\'\x3e-\x3c/span\x3e \x3ca class=\'lotusLikeActions\' role=\'button\' aria-label=\'Voted - Undo\' href=\'javascript:;\' id=\'TOGGLE_${id}\'\x3eUndo\x3c/a\x3e","TOOLTIP":"Remove your vote from this","READONLYTEXT":"\x3cspan class=\'lotusLikeDescription\'\x3eVoted\x3c/span\x3e"}}},"readMore":" Read more ...","readMore_a11y":"Activating this link will open the ${name} blog entry in a new window.","readMore_tooltip":"Open the ${name} blog entry."},"MESSAGE":{"SUCCESS":"Confirmation","HIDE_DETAILS":"Hide details","ERROR":"Error","MORE_DETAILS":"More details","ERROR_ALT_TEXT":"Error:","DISMISS":"Hide this message","WARNING":"Warning","INFO":"Information"},"REPLIES":{"SHOW_FULL_REPLY_TOOLTIP":"Navigate to the original reply in the forum topic","PREV_COMMENTS":"Show More Replies","ADD_COMMENT":"Reply to this topic","REPLY_TITLE":"Re: ${0}","ERROR_CREATE_CANCEL":"Your reply could not be saved because the request was canceled.  Click \'Save\' to try again.","ERROR_CREATE_ACCESS_DENIED":"Your reply could not be saved because the topic has been deleted or is no longer visible to you.","ERROR_CREATE_NOT_FOUND":"Your reply could not be saved because the topic has been deleted or is no longer visible to you.","REPLY_ACTION":"Reply","THIS_TAB_TITLE":"This Reply","ERROR_NO_CONTENT":"Enter your reply and click \'Save.\'  If you no longer want to leave a reply click \'Cancel.\'","NAVIGATE_TO_REPLY":"Navigate to the parent reply","WARN_LONG_COMMENT":"The reply is too long.  ${shorten}","NAVIGATE_TO_TOPIC":"Navigate to the parent topic","REPLY_TO_REPLY":"In reponse to ${thisReply}","SHOW_FULL_REPLY":"View full reply","MODERATION_PENDING":"This reply is pending review.","SHOWING_RECENT_REPLIES":"Showing ${0} most recent replies","ARIA_LABEL":"Replies","THIS_ARIA_LABEL":"This Reply","REPLY_TO_TOPIC":"In response to ${thisTopic}","PLACEHOLDER_TXT":"Reply to this topic","ADD_COMMENT_TOOLTIP":"Reply to this forum topic","MODERATION_REMOVED":{"MONTH":"This reply was removed by ${user} on ${MMM} ${d}.","TODAY":"This reply was removed by ${user} today at ${time}.","YESTERDAY":"This reply was removed by ${user} yesterday at ${time}.","DAY":"This reply was removed by ${user} on ${EEEE} at ${time}.","TOMORROW":"This reply was removed by ${user} on ${MMM} ${d}, ${YYYY}.","YEAR":"This reply was removed by ${user} on ${MMM} ${d}, ${YYYY}."},"ERROR":"An error has occurred while retrieving the replies. ${again}","THIS_REPLY":"this reply","ERROR_CREATE_NOT_LOGGED_IN":"You must be logged in to create this reply.  Click \'Save\' to be prompted to log in.","ERROR_UNAUTHORIZED":"Your reply could not be saved because you are not authorized to leave a reply.","EMPTY":"There are no replies.","THIS_TOPIC":"this topic","TAB_TITLE":"Replies (${0})","REPLY_ACTION_TOOLTIP":"Reply to this post","ERROR_CREATE":"Your reply could not be saved.  Try again later.","ERROR_CREATE_TIMEOUT":"Your reply could not be saved because the server could not be contacted.  Click \'Save\' to try again.","MODERATION_REJECTED":{"MONTH":"This reply was rejected by ${user} on ${MMM} ${d}.","TODAY":"This reply was rejected by ${user} today at ${time}.","YESTERDAY":"This reply was rejected by ${user} yesterday at ${time}.","DAY":"This reply was rejected by ${user} on ${EEEE} at ${time}.","TOMORROW":"This reply was rejected by ${user} on ${MMM} ${d}, ${YYYY}.","YEAR":"This reply was rejected by ${user} on ${MMM} ${d}, ${YYYY}."},"COMMENT_DELETED":{"MONTH":"Reply deleted by ${user} on ${MMM} ${d}","TODAY":"Reply deleted by ${user} today at ${time}","YESTERDAY":"Reply deleted by ${user} yesterday at ${time}","DAY":"Reply deleted by ${user} on ${EEEE} at ${time}","TOMORROW":"Reply deleted by ${user} on ${MMM} ${d}, ${YYYY}","YEAR":"Reply deleted by ${user} on ${MMM} ${d}, ${YYYY}"},"TRIM_LONG_COMMENT":"Shorten reply?","MODERATION_QUARANTINED":"The post has been quarantined by the moderator.","REASON_FOR_DELETION":"Reason for deletion: ${reason}"},"login":{"error":"Your user name and/or password does not match any existing accounts. Please try again.","logIn":"Log In","welcome":"Login to IBM Connections","user":"User name:","password":"Password:"},"common":{"like_error":"Your like could not be saved. Please try again later.","ERROR_ALT":"Error","vote_error":"Your vote could not be saved. Please try again later.","inactiveIndicator":"(inactive)","more":{"label":"More","tooltip":"More Actions"},"inactiveUser":"${user} (inactive)","tags_more":"and ${0} more","PERSON_TITLE":"Open the profile of ${user}."},"ecm_file":{"error_403":"The file was deleted or is no longer shared with you.","error_preview":"The file is no longer available for preview.","error_404":"The file was deleted or is no longer shared with you.","draft_review_canceled":"The review was canceled and the draft is no longer shared with you. Your review is no longer requested.","draft_404_info":"The draft was deleted or is no longer shared with you. The published version is now the latest version of this file.","tooltip":"Open the ${name} file in the library","checkedout_you":"Checked out by you","checkedout_other":"Checked out by ${user}","switch_ee":"View draft","switch_ee_tooltip":"View the latest draft for this file"},"DATE":{"RELATIVE_TIME":{"MONTH":"${date_short}","TODAY":"Today at ${time}","YESTERDAY":"Yesterday at ${time}","TOMORROW":"${date_short}","DAY":"${EEee} at ${time}","YEAR":"${date_short}","FULL":"${EEEE}, ${date_long} ${time_long}"},"ADDED":{"MONTH":"Added ${date_long}","TODAY":"Added today at ${time}","YESTERDAY":"Added yesterday at ${time}","DAY":"Added ${EEee} at ${time}","YEAR":"Added ${date_long}","FULL":"${EEEE}, ${date_long} ${time_long}"},"TODAY":"today","YESTERDAY":"yesterday","COMPACT":{"MONTH":"${date_short}","TODAY":"Today","YESTERDAY":"Yesterday","TOMORROW":"Tomorrow","DAY":"${EEee}","YEAR":"${date_short}","FULL":"${EEEE}, ${date_long} ${time_long}"},"AM":"AM","FULL":"${EEEE}, ${date_long} ${time_long}","LAST_UPDATED":{"MONTH":"Last updated ${date_long}","TODAY":"Last updated today at ${time}","YESTERDAY":"Last updated yesterday at ${time}","DAY":"Last updated ${EEee} at ${time}","YEAR":"Last updated ${date_long}","FULL":"${EEEE}, ${date_long} ${time_long}"},"TODAY_U":"Today","YESTERDAY_U":"Yesterday","UPDATED":{"MONTH":"Updated ${date_long}","TODAY":"Updated today at ${time}","YESTERDAY":"Updated yesterday at ${time}","DAY":"Updated ${EEee} at ${time}","YEAR":"Updated ${date_long}","FULL":"${EEEE}, ${date_long} ${time_long}"},"RELATIVE_TIME_LONG":{"MONTH":"${date_long}","TODAY":"Today at ${time}","YESTERDAY":"Yesterday at ${time}","TOMORROW":"${date_long}","DAY":"${EEee} at ${time}","YEAR":"${date_long}","FULL":"${EEEE}, ${date_long} ${time_long}"},"DATE_ONLY":{"MONTH":"${date_short}","TODAY":"${date_short}","YESTERDAY":"${date_short}","TOMORROW":"${date_short}","DAY":"${date_short}","YEAR":"${date_short}","FULL":"${EEEE}, ${date_long}"},"MONTHS_ABBR":{"11":"DEC","0":"JAN","1":"FEB","2":"MAR","3":"APR","4":"MAY","5":"JUN","6":"JUL","7":"AUG","8":"SEP","9":"OCT","10":"NOV"},"PM":"PM","TIME_ONLY":{"MONTH":"${time}","TODAY":"${time}","YESTERDAY":"${time}","TOMORROW":"${time}","DAY":"${time}","YEAR":"${time}","FULL":"${time_long}"},"DATE_TIME":{"MONTH":"${date_short} at ${time}","TODAY":"${date_short} at ${time}","YESTERDAY":"${date_short} at ${time}","TOMORROW":"${date_short} at ${time}","DAY":"${date_short} at ${time}","YEAR":"${date_short} at ${time}","FULL":"${EEEE}, ${date_long} ${time_long}"}},"network":{"friendsInviteUpdatesDescription":"Receive updates about people you are following on the Home page and in an email summary.","error_404":"The network request no longer exists.","profile_title":"Open the profile of ${user}.","timestamp":{"created":{"MONTH":"${MMM} ${d}","TODAY":"Today at ${time}","YESTERDAY":"Yesterday at ${time}","DAY":"${EEEE} at ${time}","TOMORROW":"${MMM} ${d}, ${YYYY}","YEAR":"${MMM} ${d}, ${YYYY}"}},"error":"An error occurred.  ${again}.","error_again":"Please try again","messages":{"error":{"accept":"There was an error accepting the request.","ignore":"There was an error ignoring the request."},"success":{"accept":{"follow":"You are now network contacts and following ${user}.","nofollow":"You are now network contacts."},"ignore":{"follow":"You have ignored the invitation but are now following ${user}.","nofollow":"You have ignored the invitation."}}},"warning":"Warning","profile_a11y":"Activating this link will open the profile of ${user} in a new window."},"ecm_draft":{"error_403":"You cannot view this draft because it is not shared with you.","error_404":"The draft was deleted or is no longer shared with you.","draft_general_info":"The previous draft no longer exists and a newer draft is now the latest version.","tooltip":"Open the ${name} draft in the library","accept_info":"You approved this draft.","draft_review_request_info":"Your review is requested.","review_required_all":"Community Owners require all reviewers to review this draft.","switch_ee":"View published version","accept_success":"You have approved this draft.","approve":"Approve","reject_info":"You rejected this draft.","reviewers":"Reviewers","reviwers_addtl":"Additional Reviewers","switch_ee_tooltip":"View the published version of this file","review_additional_required":"All reviewers added by the draft submitter are required to review this draft.","accept_error":"There was an error approving this draft. Try again.","approve_tooltip":"Approve this draft","error_preview":"The draft is no longer available for preview.","review_required_any":"Community Owners require one reviewer to review this draft.","pending":"Pending","review":"Review","draft_review_404_require_info":"The previous draft no longer exists and the latest draft was submitted for review. Your review is required.","reject":"Reject","draft":"Draft","reject_success":"You have rejected this draft.","reject_tooltip":"Reject this draft","draft_tooltip":"Viewing draft","pending_rejected":"Review no longer needed because draft was rejected","reject_error":"There was an error rejecting this draft. Try again.","draft_review_404_request_info":"The previous draft no longer exists and the latest draft was submitted for review. Your review is requested.","draft_review_require_info":"Your review is required.","in_review":"Draft in Review","draft_review_404_general_info":"One of the reviewers has already voted. You are no longer requested to review this draft.","in_review_tooltip":"Viewing draft in Review","community_owners":"Community Owners","approved":"Approved","rejected":"Rejected","review_required_generic":"Community Owners require these reviewers to review this draft.","reivew_submitted_date":{"MONTH":"${user} submitted the draft for review on ${MMM} ${d}.","TODAY":"${user} submitted the draft for review today at ${time}.","YESTERDAY":"${user} submitted the draft for review yesterday at ${time}.","DAY":"${user} submitted the draft for review on ${EEEE} at ${time}.","TOMORROW":"${user} submitted the draft for review on ${MMM} ${d}, ${YYYY}.","YEAR":"${user} submitted the draft for review on ${MMM} ${d}, ${YYYY}."}},"COMMENTS":{"PREV_COMMENTS":"Show Previous Comments","ERROR_EDIT":"Your comment could not be updated.  Try again later.","DIALOG_TITLE":"Shorten Comment","ADD_COMMENT":"Add a Comment","PROFILE_TITLE":"Open the profile of ${user}.","ERROR_EDIT_TIMEOUT":"Your comment could not be updated because the server could not be contacted.  Click \'Post\' to try again.","FLAG_ITEM":{"ERROR_SAVING":"There was an error with processing the request. Try again later.","DESCRIPTION_LABEL":"Provide a reason for flagging this item (optional)","SUCCESS_SAVING":"Your flag has been submitted. A moderator will investigate shortly.","ACTION":"Flag as Inappropriate","TITLE":"Flag this item as inappropriate","BUSY":"Saving...","CANCEL":"Cancel","OK":"Save","EDITERROR":"The file\'s metadata was not edited due to an error","COMMENT":{"TITLE":"Flag this comment as inappropriate","A11Y":"This button opens a dialog that allows the user to flag this comment as inappropriate."}},"ERROR_CREATE_CANCEL":"Your comment could not be saved because the request was canceled.  Click \'Post\' to try again.","EDIT":"Edit","NAME":"Shorten Comment","DELETE_CONFIRM":"Are you sure you want to delete this comment?","ERROR_NO_CONTENT":"Enter your comment and click \'Post.\'  If you no longer want to leave a comment click \'Cancel.\'","WARN_LONG_COMMENT":"The comment is too long.  ${shorten}","ERROR_NO_CONTENT_EDIT":"Enter your comment and click \'Post.\'  If you no longer want to edit your comment click \'Cancel.\'","ERROR_EDIT_NOT_FOUND":"Your comment could not be updated because the item has been deleted or is no longer visible to you.","ERROR_EDIT_ACCESS_DENIED":"Your comment could not be updated because the item has been deleted or is no longer visible to you.","ARIA_LABEL":"Comments","COMMENT_CREATED_NOVERSION":{"MONTH":"${user} ${MMM} ${d}","TODAY":"${user} today at ${time}","YESTERDAY":"${user} yesterday at ${time}","DAY":"${user} ${EEEE} at ${time}","TOMORROW":"${user} ${MMM} ${d}, ${YYYY}","YEAR":"${user} ${MMM} ${d}, ${YYYY}"},"POST":"Post","ERROR_AGAIN_TITLE":"Try the request again for more comments.","ERROR_ADDTL":"An error occurred while retrieving additional comments. ${again}","SUBSCRIBE_TO_COMMENTS":"Subscribe to these comments","ADD_COMMENT_TOOLTIP":"Add a comment to this item","MODERATION_REMOVED":{"MONTH":"This comment was removed by ${user} on ${MMM} ${d}.","TODAY":"This comment was removed by ${user} today at ${time}.","YESTERDAY":"This comment was removed by ${user} yesterday at ${time}.","DAY":"This comment was removed by ${user} on ${EEEE} at ${time}.","TOMORROW":"This comment was removed by ${user} on ${MMM} ${d}, ${YYYY}.","YEAR":"This comment was removed by ${user} on ${MMM} ${d}, ${YYYY}."},"COMMENT_EDITED":{"MONTH":"${user} edited ${MMM} ${d} (version ${version})","TODAY":"${user} edited today at ${time} (version ${version})","YESTERDAY":"${user} edited yesterday at ${time} (version ${version})","DAY":"${user} edited ${EEEE} at ${time} (version ${version})","TOMORROW":"${user} edited ${MMM} ${d}, ${YYYY} (version ${version})","YEAR":"${user} edited ${MMM} ${d}, ${YYYY} (version ${version})"},"ERROR_AGAIN":"Try again.","DELETE":"Delete","EMPTY":"There are no comments.","EDIT_TOOLTIP":"Edit comment","DELETEREASON":"Reason for deleting this comment:","COMMENT_COUNT_MANY":"${0} comments","ERROR_ALT":"Error","ERROR_CREATE":"Your comment could not be saved.  Try again later.","ERROR_CREATE_TIMEOUT":"Your comment could not be saved because the server could not be contacted.  Click \'Post\' to try again.","ERROR_EDIT_NOT_LOGGED_IN":"You must be logged in to edit this comment.  Click \'Post\' to be prompted to log in.","ERROR_DELETE_ACCESS_DENIED":"Your comment could not be deleted because the item has been deleted or is no longer visible to you.","ERROR_DELETE_NOT_FOUND":"Your comment could not be deleted because the comment or item has been deleted or is no longer visible to you.","ACTION_NOT_SUPPORTED":"Unsupported Action","COMMENT_EDITED_NOVERSION":{"MONTH":"${user} edited ${MMM} ${d}","TODAY":"${user} edited today at ${time}","YESTERDAY":"${user} edited yesterday at ${time}","DAY":"${user} edited ${EEEE} at ${time}","TOMORROW":"${user} edited ${MMM} ${d}, ${YYYY}","YEAR":"${user} edited ${MMM} ${d}, ${YYYY}"},"SUBSCRIBE_TO_COMMENTS_TOOLTIP":"Follow changes to these comments through your feed reader","YES":"Yes","COMMENT_CREATED":{"MONTH":"${user} ${MMM} ${d} (version ${version})","TODAY":"${user} today at ${time} (version ${version})","YESTERDAY":"${user} yesterday at ${time} (version ${version})","DAY":"${user} ${EEEE} at ${time} (version ${version})","TOMORROW":"${user} ${MMM} ${d}, ${YYYY} (version ${version})","YEAR":"${user} ${MMM} ${d}, ${YYYY} (version ${version})"},"ERROR_CREATE_ACCESS_DENIED":"Your comment could not be saved because the item has been deleted or is no longer visible to you.","ERROR_CREATE_NOT_FOUND":"Your comment could not be saved because the item has been deleted or is no longer visible to you.","VIEW_COMMENTS_FILE":"View comments on this file","PROFILE_A11Y":"Activating this link will open the profile of ${user} in a new window.","DELETE_TOOLTIP":"Delete comment","SHOWMORE":"Read more...","COMMENT_LABEL":"Comment:","ERROR_DELETE_NOT_LOGGED_IN":"You must be logged in to delete this comment.  Click \'Delete\' to be prompted to log in.","OK":"OK","MODERATION_PENDING":"This comment is pending review.","ERROR_DELETE":"Your comment could not be deleted.  Try again later.","TOOLTIP":"Shorten Comment","COMMENT_CREATED_TIME":{"MONTH":"${MMM} ${d}","TODAY":"Today at ${time}","YESTERDAY":"Yesterday at ${time}","DAY":"${EEEE} at ${time}","TOMORROW":"${MMM} ${d}, ${YYYY}","YEAR":"${MMM} ${d}, ${YYYY}"},"ERROR_DELETE_TIMEOUT":"Your comment could not be deleted because the server could not be contacted.  Click \'Delete\' to try again.","PLACEHOLDER_TXT":"Add a comment","ERROR":"An error has occurred while retrieving the comments. ${again}","ERROR_CREATE_NOT_LOGGED_IN":"You must be logged in to create this comment.  Click \'Post\' to be prompted to log in.","ERROR_UNAUTHORIZED":"Your comment could not be saved because you are not authorized to leave a comment.","TAB_TITLE":"Comments (${0})","ERROR_GENERAL":"An error has occurred.","COMMENT_COUNT_ONE":"${0} comment","MODERATION_REJECTED":{"MONTH":"This comment was rejected by ${user} on ${MMM} ${d}.","TODAY":"This comment was rejected by ${user} today at ${time}.","YESTERDAY":"This comment was rejected by ${user} yesterday at ${time}.","DAY":"This comment was rejected by ${user} on ${EEEE} at ${time}.","TOMORROW":"This comment was rejected by ${user} on ${MMM} ${d}, ${YYYY}.","YEAR":"This comment was rejected by ${user} on ${MMM} ${d}, ${YYYY}."},"ERROR_DELETE_CANCEL":"Your comment could not be deleted because the request was canceled.  Click \'Delete\' to try again.","ERROR_EDIT_CANCEL":"Your comment could not be updated because the request was canceled.  Click \'Post\' to try again.","COMMENT_DELETED":{"MONTH":"Comment deleted by ${user} on ${MMM} ${d}","TODAY":"Comment deleted by ${user} today at ${time}","YESTERDAY":"Comment deleted by ${user} yesterday at ${time}","DAY":"Comment deleted by ${user} on ${EEEE} at ${time}","TOMORROW":"Comment deleted by ${user} on ${MMM} ${d}, ${YYYY}","YEAR":"Comment deleted by ${user} on ${MMM} ${d}, ${YYYY}"},"TRIM_LONG_COMMENT":"Shorten comment?","LINK":"Link","CANCEL":"Cancel","SAVE":"Save"},"HISTORY":{"ERROR_ADDTL":"An error occurred while retrieving additional updates. ${again}","ERROR_AGAIN_TITLE":"Try the request again for more updates.","PROFILE_TITLE":"Open the profile of ${user}.","ERROR":"An error has occurred while retrieving the updates. ${again}","ERROR_AGAIN":"Try again.","EMPTY":"Could not retrieve recent updates for this item. It has been deleted or you no longer have access to it.","TAB_TITLE":"Recent Updates","ERROR_ALT":"Error","MORE":"Show Previous Updates","SORTS":{"DATE_TOOLTIP_REVERSE":"Sort from least recent history to most recent updates","DATE_TOOLTIP":"Sort from most recent history to least recent updates","DATE":"Date"},"NO_HISTORY":"There are no recent updates.","TIMESTAMP":{"CREATED":{"MONTH":"${MMM} ${d}","TODAY":"Today at ${time}","YESTERDAY":"Yesterday at ${time}","DAY":"${EEEE} at ${time}","TOMORROW":"${MMM} ${d}, ${YYYY}","YEAR":"${MMM} ${d}, ${YYYY}"}},"SORT_BY":"Sort by\\:"},"UNSAVEDCHANGES":{"CONFIRM":"Are you sure you want to abandon your changes?  Press OK to continue or Cancel to return.","DIALOG_TITLE":"Confirm","CANCEL":"Cancel","TOOLTIP":"Confirm","NAME":"Confirm","OK":"OK"},"idea":{"readMore_a11y":"Activating this link will open the ${name} idea in a new window.","error_404":"We could not save your vote because you have either reached your voting limit or the idea is no longer available to you.","readMore_tooltip":"Open the ${name} idea."},"OAUTH":{"infoMsg":"Connections needs your authorization to access your data.","authorizeGadget":"${clickHere} to authorize this application to access your Connections information.","clickHere":"Click here","confirmAuthorization":"${clickHere} to confirm that you have authorized this application to access your Connections information.","continueBtnA11y":"Activating this link will open a new window that will allow you to authorize access to Connections.","welcomeHeader":"Welcome to Connections","continueBtnLabel":"Continue"},"OAUTH_FILENET":{"confirmAuthorization":"${clickHere} to confirm that you have authorized this application to access your Connections Library repository information.","infoMsg":"The Connections Library repository needs your authorization to access your data.","continueBtnA11y":"Activating this link will open a new window that will allow you to authorize access to the Connections Library repository.","authorizeGadget":"${clickHere} to authorize this application to access your Connections Library repository information."},"COMMENTS_SHORTEN":{"CONFIRM":"Shortening will remove the text beyond the comment limit.  Click \'OK\' to shorten or \'Cancel\' to edit the comment yourself.","DIALOG_TITLE":"Shorten Comment","CANCEL":"Cancel","TOOLTIP":"Shorten Comment","NAME":"Shorten Comment","OK":"OK"},"file":{"error_403":"You do not have permission to view this file. The file is not public and is not shared with you.","error_404":"The file no longer exists or you do not have sufficient permissions to access it.","profile_title":"Open the profile of ${user}.","tooltip":"Open ${name} in the Files application","notifications":{"USER_SHARED":"${user} wrote:","NO_CHANGE_SUMMARY":"${user} did not provide a change summary","COMMENTED":"${user} commented","CHANGE_SUMMARY":"${user} provided change summary"},"error":"An error occurred.  ${again}.","PREVIEW":{"TITLE":"Preview this file in a new window.","LINK":"Preview"},"download":{"DOWNLOAD_ALT":"Download","TOOLTIP":"Download this file (${size})"},"a11y_help":"Activating this link will open ${name} in a new window.","error_again":"Please try again","download_tooltip":"Download this file (${0})","about":{"ANYUPDATE_TIMESTAMP":"${date_long} ${time_long}","UPDATE_TIMESTAMP":"${date_long} ${time_long} by ${user}","CREATE_TIMESTAMP":"${date_long} ${time_long} by ${user}"},"profile_a11y":"Activating this link will open the profile of ${user} in a new window.","following":{"title":"Toggle whether you will receive updates about this file","remove":"Stop Following","add":"Follow File"},"timestamp":{"updatedCompact":{"MONTH":"Updated: ${MMM} ${d}","TODAY":"Updated: Today at ${time}","YESTERDAY":"Updated: Yesterday at ${time}","DAY":"Updated: ${EEEE} at ${time}","TOMORROW":"Updated: ${MMM} ${d}, ${YYYY}","YEAR":"Updated: ${MMM} ${d}, ${YYYY}"},"createdOther":{"MONTH":"${user} created on ${MMM} ${d}","TODAY":"${user} created today at ${time}","YESTERDAY":"${user} created yesterday at ${time}","DAY":"${user} created on ${EEEE} at ${time}","TOMORROW":"${user} created on ${MMM} ${d}, ${YYYY}","YEAR":"${user} created on ${MMM} ${d}, ${YYYY}"},"created":{"MONTH":"Created ${MMM} ${d}","TODAY":"Created today at ${time}","YESTERDAY":"Created yesterday at ${time}","DAY":"Created ${EEEE} at ${time}","TOMORROW":"Created ${MMM} ${d}, ${YYYY}","YEAR":"Created ${MMM} ${d}, ${YYYY}"},"createdCompact":{"MONTH":"Created: ${MMM} ${d}","TODAY":"Created: Today at ${time}","YESTERDAY":"Created: Yesterday at ${time}","DAY":"Created: ${EEEE} at ${time}","TOMORROW":"Created: ${MMM} ${d}, ${YYYY}","YEAR":"Created: ${MMM} ${d}, ${YYYY}"},"updated":{"MONTH":"Updated ${MMM} ${d}","TODAY":"Updated today at ${time}","YESTERDAY":"Updated yesterday at ${time}","DAY":"Updated ${EEEE} at ${time}","TOMORROW":"Updated ${MMM} ${d}, ${YYYY}","YEAR":"Updated ${MMM} ${d}, ${YYYY}"},"updatedOther":{"MONTH":"${user} updated on ${MMM} ${d}","TODAY":"${user} updated today at ${time}","YESTERDAY":"${user} updated yesterday at ${time}","DAY":"${user} updated on ${EEEE} at ${time}","TOMORROW":"${user} updated on ${MMM} ${d}, ${YYYY}","YEAR":"${user} updated on ${MMM} ${d}, ${YYYY}"}},"TAGS":"Tags:","share":{"label":"Share","title":"Give others access to this file"}}};

;dojo.cache("com.ibm.lconn.gadget", "services/dialog/templates/OAuthErrorDialog.html", "<div id=\"${id}_dialog\" role=\"dialog\" aria-labelledby=\"${id}_title\" class=\"lotusDialog\"> <div class=\"lotusDialogBorder\"> <div class=\"lotusDialog\"> <div class=\"lotusDialogHeader\"> <a class=\"lotusDialogClose\" href=\"javascript:;\" dojoAttachEvent=\"onclick:closeDialog\" title=\"${nls.MESSAGE.DISMISS}\"> <img alt=\"${nls.MESSAGE.DISMISS}\" src=\"${blankGif}\" /> <span class=\"lotusAltText\">${nls.MESSAGE.DISMISS}</span> </a> </div> <div class=\"lotusDialogContent\" id=\"${id}_dialog_content\"> <div class=\"lotusMessage2\" role=\"alert\"> <img class=\"lotusIcon lotusIconMsgError\" src=\"${blankGif}\" alt=\"${nls.MESSAGE.ERROR_ALT_TEXT}\" /> <span class=\"lotusAltText\">${nls.MESSAGE.ERROR_ALT_TEXT}</span> <div class=\"lotusMessageBody\">${errorMessage}</div> </div> </div> </div> </div></div>");

;if(!dojo._hasResource["com.ibm.lconn.gadget.services.dialog.OAuthErrorDialog"]){
dojo._hasResource["com.ibm.lconn.gadget.services.dialog.OAuthErrorDialog"]=true;
dojo.provide("com.ibm.lconn.gadget.services.dialog.OAuthErrorDialog");






dojo.requireLocalization("com.ibm.social.ee","socialEEStrings");
dojo.declare("com.ibm.lconn.gadget.services.dialog.OAuthErrorDialog",[dijit._Widget,dijit._Templated],{widgetsInTemplate:true,nls:dojo.i18n.getLocalization("com.ibm.social.ee","socialEEStrings"),templatePath:dojo.moduleUrl("com.ibm.lconn.gadget","services/dialog/templates/OAuthErrorDialog.html"),blankGif:null,errorMessage:null,dialog:null,constructor:function(){
var _1=this.nls.network;
this.blankGif=dojo.config.blankGif;
this.errorMessage=dojo.replace(_1.error,{again:_1.error_again},/\$\{([^\}]+)\}/g);
this.dialog=new dijit.Dialog();
},show:function(){
this.dialog.show();
this.dialog.attr({content:this.domNode});
},closeDialog:function(){
this.dialog.destroy();
this.dialog=null;
this.destroy();
}});
}


;dojo.mixin(dojo.provide("com.ibm.lconn.gadget.config.settings"),{"developer":{"allowIntranetProxyAccess":false,"allowSSOFeature":false,"enabled":false},"security":{"allowUrlCheckPattern":"","authErrorRetryIntervalSec":300,"containerTokenCheckSec":7200,"containerTokenTTLSec":43200,"featureAdminEnabled":true,"gadgetTokenTTLSec":64800,"preloadJS":false,"preloadJSSafari":true,"ssoDomain":"apps.na.collabserv.com","transientErrorRetryIntervalSec":60,"urlWhitelistEnabled":true,"whiteListEnabled":true}});


;if(!dojo._hasResource["lconn.core.util.LCDeferred"]){
dojo._hasResource["lconn.core.util.LCDeferred"]=true;
dojo.provide("lconn.core.util.LCDeferred");
(function(){
var _1=function(){
};
var _2=Object.freeze||function(){
};
lconn.core.util.LCDeferred=function(_3){
var _4,_5,_6,_7,_8;
var _9=(this.promise={});
function _a(_b){
dojo.deprecated("lconn.core.util.LCDeferred","Use dojo.Deferred instead","5.0");
if(!_5){
_4=_b;
_5=true;
_c();
}
};
function _c(){
var _d;
while(!_d&&_8){
var _e=_8;
_8=_8.next;
if((_d=(_e.progress==_1))){
_5=false;
}
var _f=(_6?_e.error:_e.resolved);
if(_f){
try{
var _10=_f(_4);
if(_10&&typeof _10.then==="function"){
_10.then(dojo.hitch(_e.deferred,"resolve"),dojo.hitch(_e.deferred,"reject"));
continue;
}
var _11=_d&&_10===undefined;
if(_d&&!_11){
_6=_10 instanceof Error;
}
_e.deferred[_11&&_6?"reject":"resolve"](_11?_4:_10);
}
catch(e){
_e.deferred.reject(e);
}
}else{
if(_6){
_e.deferred.reject(_4);
}else{
_e.deferred.resolve(_4);
}
}
}
};
this.resolve=this.callback=function(_12){
this.fired=0;
this.results=[_12,null];
_a(_12);
};
this.reject=this.errback=function(_13){
_6=true;
this.fired=1;
_a(_13);
this.results=[null,_13];
if(!_13||_13.log!==false){
(dojo.config.deferredOnError||function(x){
console.error(x);
})(_13);
}
};
this.progress=function(_14){
var _15=_8;
while(_15){
var _16=_15.progress;
_16&&_16(_14);
_15=_15.next;
}
};
this.addCallbacks=function(_17,_18){
this.then(_17,_18,_1);
return this;
};
this.then=_9.then=function(_19,_1a,_1b){
var _1c=_1b==_1?this:new lconn.core.util.LCDeferred(_9.cancel);
var _1d={resolved:_19,error:_1a,progress:_1b,deferred:_1c};
if(_8){
_7=_7.next=_1d;
}else{
_8=_7=_1d;
}
if(_5){
_c();
}
return _1c.promise;
};
var _1e=this;
this.cancel=_9.cancel=function(){
if(!_5){
var _1f=_3&&_3(_1e);
if(!_5){
if(!(_1f instanceof Error)){
_1f=new Error(_1f);
}
_1f.log=false;
_1e.reject(_1f);
}
}
};
_2(_9);
};
dojo.extend(lconn.core.util.LCDeferred,{addCallback:function(_20){
return this.addCallbacks(dojo.hitch.apply(dojo,arguments));
},addErrback:function(_21){
return this.addCallbacks(null,dojo.hitch.apply(dojo,arguments));
},addBoth:function(_22){
var _23=dojo.hitch.apply(dojo,arguments);
return this.addCallbacks(_23,_23);
},fired:-1});
})();
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.TokenRefreshHandler"]){
dojo._hasResource["com.ibm.lconn.gadget.services.TokenRefreshHandler"]=true;
dojo.provide("com.ibm.lconn.gadget.services.TokenRefreshHandler");
















com.ibm.lconn.gadget.services.TokenRefreshHandler=(function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
var _a={};
var _b=_8.security;
var _c="X-LConn-Auth",_d="X-IC-CRE-User",_e="X-IC-CRE-Request-Origin",_f="X-Update-Nonce",_10="X-IC-Container-Token";
var _11=_4.opensocial,_12=_3.parse(_1.getObject("location",_1.global).toString(),_11?_6(_3.getServiceUrl(_11).toString()):"");
var _13=_1.global.location;
_7.debug("Container token refresh TTL is: "+_b.containerTokenTTLSec);
_7.debug("Container token check: "+_b.containerTokenCheckSec);
function _14(_15,_16){
return _15&&_15.userId===_16.userId;
};
function _17(_18){
_7.debug("Invalidating current token data");
var _19=_18.sites_;
for(var _1a in _19){
var _1b=_19[_1a];
if(_1b instanceof osapi.container.GadgetSite){
var _1c=_1b.getActiveSiteHolder();
var _1d=_18.service_.getCachedGadgetMetadata(_1c.getUrl());
_1d[osapi.container.MetadataResponse.NEEDS_TOKEN_REFRESH]=true;
}
}
};
function _1e(_1f){
var c=document.cookie,_20="(?:^|; )"+_1.regexp.escapeString(_1f)+"=([^;]*)",_21,_22=new RegExp(_20),res,_23=[],i;
_21=c.match(new RegExp(_20,"g"));
if(_21&&_21.length>0){
i=_21.length;
while(i--){
res=_21[i];
_23.push(decodeURIComponent(res.match(_22)[1]));
}
}
return _23;
};
function _24(_25,_26){
var _27,_28,_29;
var _2a=false,_2b=null,_2c;
var _2d=_13.hostname;
var i,c;
if(_26){
i=_26.length;
while(i--){
_27=_26[i];
if((c=_27.indexOf("$"))>0&&c<_27.length-1){
_29=_27.substring(0,c);
_28=_27.substring(c+1);
_2c=_14(_25,{userId:_28,isAuth:(_28.indexOf("anonymous")!==0)});
if((_2d.indexOf(_29)+_29.length)===_2d.length){
if(_2b===null||_29===_2d){
if(_2b===_29){
_2a=_2a||_2c;
}else{
_2b=_29;
_2a=_2c;
}
}
}
}
}
}
return _2a;
};
function _2e(_2f){
var _30=_1e(_10);
if(!_24(_2f,_30)){
_7.debug("Must be in proxy situation, not getting container token cookie back from server.");
var _31=_13.hostname+"$"+_2f.userId;
_1.cookie(_10,_31,{path:"/"});
}
};
_a=_1.declare("",[],{_userData:null,_lastUpdate:null,_containerToken:null,_commonContainer:null,getContainerToken:function(_32){
var _33=this,_34=new _5(),p=_32?_32:com.ibm.lconn.gadget.container.iContainer2.getIRuntime();
if(typeof (window["__isgadget"])=="undefined"){
p.then(function(){
if(typeof (window["shindig"])==="undefined"){
console.error("FATAL: shindig is undefined, returning");
return;
}
var _35=(typeof (window["user"])!=="undefined"?window["user"]:null),_36=(typeof (window["userid"])!=="undefined"?window["userid"]:null),u=(_35?_35:_36),_37=shindig.sha1();
u=(u?u:(_2?_2.getUser():null));
if(u){
_37.update(u);
u=_37.digestString();
}else{
u=(new Date()).valueOf();
}
var _38=[_12.toString(),"/common/tokenRefresh?type=container&token=","&u=",u].join("");
var _39={};
_39[_f]="check";
_39[_e]=_13.href;
_1.xhrGet({url:_38,handleAs:"json",headers:_39,sync:false,load:_1.hitch(_33,"_creTokenDataHandlerLoad",_34),error:_1.hitch(_33,"_creTokenDataHandlerError",_34)});
});
}
return _34;
},_getCachedToken:function(){
var now=new Date().getTime();
var _3a=_1e(_10);
var _3b=this._containerToken;
var _3c=this._lastUpdate;
if(_3c){
_3c+=(_b.containerTokenTTLSec*1000);
}
if(!_24(this._userData,_3a)){
return false;
}else{
if((_3b&&_3b.token)&&(_3c&&now<_3c)){
return _3b.token;
}else{
return false;
}
}
},_creTokenDataHandlerLoad:function(_3d,_3e,_3f){
_7.debug("SUCCESS: Load token: %o",_3e);
var _40=this._parseUserData(_3f);
_2e(_40);
_3d.callback({creToken:_3e.containerToken,userData:_40});
if(!this._userData){
this._lastUpdate=new Date().getTime();
this._containerToken=_3e.containerToken;
this._userData=_40;
}
},_parseUserData:function(_41){
var _42=("true"===_41.xhr.getResponseHeader(_c));
var _43=_41.xhr.getResponseHeader(_d);
if(!_43){
_42=false;
_43="anonymous_12cb0bb53b1e82f9abb84c4bc1a21f1ed371c5165ff8a629e88547b6b9d368f5";
_7.warn("No X-IC-CRE-User header, switching to anon user");
}
return {isAuth:_42,userId:_43};
},_creTokenDataHandlerError:function(_44,_45,_46){
_7.error("ERROR: "+_45);
_44.errback(_45);
},_clearTokenData:function(_47){
this._invalidateGadgetTokens();
},tokenRefresh:function(_48){
var _49=this,_4a=this._getCachedToken();
if(!_4a){
this.getContainerToken().then(function(_4b){
if((!_4b)||(!_4b.creToken)||(!_4b.userData)||(!_4b.userData.userId)){
var _4c,_4d=_b.transientErrorRetryIntervalSec;
_7.debug("data: "+_4b);
_7.debug("data.creToken: "+_4b.creToken);
_7.debug("data.userData: "+_4b.userData);
_7.debug("data.userData.userId: "+_4b.userData.userId);
_7.warn("Error while refreshing container token - bad data.  Will retry in: "+_4d+" seconds");
_48(_4c,_4d);
return;
}
_49._containerToken=_4b.creToken;
_49._lastUpdate=new Date().getTime();
if(!_14(_49._userData,_4b.userData)){
_17(_49._commonContainer);
_49._userData=_4b.userData;
_48(_4b.creToken.token,_b.containerTokenCheckSec);
_49._commonContainer.refreshTokens_();
cre$.internalutil.setCREContainerToken(_4b.creToken);
}else{
_7.debug("Token refresh success %o",_4b);
_48(_4b.creToken.token,_b.containerTokenCheckSec);
cre$.internalutil.setCREContainerToken(_4b.creToken);
}
},function(_4e){
var _4f,_50=_b.transientErrorRetryIntervalSec;
_7.warn("Error while refreshing container token.  Will retry in: "+_50+" seconds");
_48(_4f,_50);
});
}else{
_48(_4a,_b.containerTokenCheckSec);
}
},setCommonContainer:function(_51){
this._commonContainer=_51;
},logoutHandler:function(){
_1.cookie(_10,_9,{expires:-1,domain:_b.ssoDomain,path:"/"});
_1.cookie(_10,_9,{expires:-1,path:"/"});
}});
return _a;
})(dojo,lconn.core.auth,lconn.core.url,lconn.core.config.services,lconn.core.util.LCDeferred,com.ibm.oneui.util.proxy,com.ibm.lconn.gadget.util.trace,com.ibm.lconn.gadget.config.settings);
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.tokenRefreshService"]){
dojo._hasResource["com.ibm.lconn.gadget.services.tokenRefreshService"]=true;
dojo.provide("com.ibm.lconn.gadget.services.tokenRefreshService");






com.ibm.lconn.gadget.services.tokenRefreshService=(function(_1,_2,_3){
var _4={};
var _5=new _2();
_4.getContainerToken=function(p){
return _5.getContainerToken(p);
};
_4.getTokenRefresher=function(){
return _1.hitch(_5,"tokenRefresh");
};
_4.registerService=function(_6){
_5.setCommonContainer(_6);
};
_3.addLogoutHandler(function(){
_5.logoutHandler();
});
return _4;
})(dojo,com.ibm.lconn.gadget.services.TokenRefreshHandler,lconn.core.auth);
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.oauthPopupDialog"]){
dojo._hasResource["com.ibm.lconn.gadget.services.oauthPopupDialog"]=true;
dojo.provide("com.ibm.lconn.gadget.services.oauthPopupDialog");










com.ibm.lconn.gadget.services.oauthPopupDialog.registerService=function(_1){
var _2={};
var _3=com.ibm.lconn.gadget.services.tokenRefreshService,_4=lconn.core.auth;
var _5=com.ibm.lconn.gadget.util.trace;
var _6={AUTHORIZE_SUCCESS:"authorize_success",AUTHORIZE_REJECTED:"authorize_rejected",AUTHORIZE_SERVER_ERROR:"authorize_server_error",AUTO_AUTHORIZE_REJECTED:"auto_authorize_rejected"};
_1.rpcRegister("_ic_oauth_dialog_status",function(_7,_8){
if(!_8.status){
return;
}
var _9=_8.status,_a=_8.message,_b=_2[_7.f].handler,_c=_2[_7.f].dialog;
if(_b===undefined){
return;
}
switch(_9){
case _6.AUTHORIZE_SUCCESS:
_b();
break;
case _6.AUTHORIZE_REJECTED:
_b();
break;
case _6.AUTHORIZE_SERVER_ERROR:
if(_c.isAuto){
_b(true);
}else{
_c.show();
}
break;
case _6.AUTO_AUTHORIZE_REJECTED:
if(_c.isAuto){
_b(true);
}else{
_c.show();
}
break;
}
if(_a){
console.log(_a);
}
});
var _d={};
_1.setupNonGadgetRpcEndpoint();
_1.rpcRegister("_ic_oauth_dialog_open",function(_e,_f,_10,pid,_11){
var _12=_e[osapi.container.GadgetSite.RPC_ARG_KEY];
var _13=_12.getId();
var _14=null;
function _15(_16){
_12.rpcCall("_ic_oauth_dialog_closed",function(){
},{isAutoFail:_16,pids:_d[_13]});
delete (_d[_13]);
if(_14){
delete _2[_14];
}
};
function _17(){
var _18=["_ic_oauth_dialog_status","__ack","__cb","gadgets.rpc.config","gadgets.rpc.register","gadgets.rpc.unregister","gadgets.rpc.registerDefault","gadgets.rpc.unregisterDefault","gadgets.rpc.forceParentVerifiable","gadgets.rpc.call","gadgets.rpc.getRelayUrl","gadgets.rpc.setRelayUrl","gadgets.rpc.setAuthToken","gadgets.rpc.setupReceiver","gadgets.rpc.getAuthToken","gadgets.rpc.removeReceiver","gadgets.rpc.getRelayChannel","gadgets.rpc.receive","gadgets.rpc.receiveSameDomain","gadgets.rpc.getOrigin","gadgets.rpc.getTargetOrigin"],ifd=new com.ibm.lconn.gadget.services.dialog.IframeDialog(_f,_10,_11),_19=com.ibm.lconn.gadget.util.specHelper.nextDomId(),_1a=com.ibm.lconn.gadget.util.specHelper.nextDomId();
gadgets.rpc.setUpRpcIdsForNonGadgetIframe(_19,_1a,_f,_18);
ifd.init(_19,_1a);
if(!_11){
ifd.show();
}
_14=_19;
var _1b=function(_1c){
ifd.destroy();
_15(_1c);
};
dojo.connect(ifd,"onClose",_1b);
_2[_19]={window:ifd.getWindow(),handler:_1b,dialog:ifd};
};
if(!_d[_13]){
_d[_13]=[pid];
_3.getContainerToken().then(function(_1d){
var _1e=_1d.userData;
if(!_1e.isAuth){
_4.login();
}else{
_17();
}
},function(_1f){
_5.error("Error checking user authentication: "+_1f);
var _20=new com.ibm.lconn.gadget.services.dialog.OAuthErrorDialog();
_20.startup();
_20.show();
_15(_11);
});
}else{
_d[_13].push(pid);
}
});
};
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.sso_reauth_callback"]){
dojo._hasResource["com.ibm.lconn.gadget.services.sso_reauth_callback"]=true;
dojo.provide("com.ibm.lconn.gadget.services.sso_reauth_callback");




com.ibm.lconn.gadget.services.sso_reauth_callback.registerService=function(_1){
_1.rpcRegister("_cre_sso_reauth_cb",function(_2){
com.ibm.lconn.gadget.util.trace.log("_cre_sso_reauth_cb rpc service fired with arguments",arguments);
com.ibm.lconn.gadget.util.trace.log("redirecting to login...");
lconn.core.auth.logoutAndlogin();
});
};
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.fake_handleRpcMethod"]){
dojo._hasResource["com.ibm.lconn.gadget.services.fake_handleRpcMethod"]=true;
dojo.provide("com.ibm.lconn.gadget.services.fake_handleRpcMethod");


com.ibm.lconn.gadget.services.fake_handleRpcMethod=(function(_1){
var _2={},_3="osapi._handleRpcMethod called - method not implemented in this container. arguments : ";
_2.registerService=function(_4){
_4.rpcRegister("osapi._handleGadgetRpcMethod",function(){
_1.debug(_3,arguments);
});
};
return _2;
})(com.ibm.lconn.gadget.util.trace);
}


;dojo.mixin(dojo.provide("lconn.core.config"),{"deploymentId":"com.ibm.lc.8a2bb217-3578-407b-9a86-fffce8aba623","enableEmail":true,"languageSensitivity":true,"multiTenantEnabled":true,"sessionCookies":["JSESSIONID"],"versionStamp":"20160903.134200"});


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.urlSecurityService"]){
dojo._hasResource["com.ibm.lconn.gadget.services.urlSecurityService"]=true;
dojo.provide("com.ibm.lconn.gadget.services.urlSecurityService");










com.ibm.lconn.gadget.services.urlSecurityService=(function(_1,_2,_3,_4,_5,_6){
var _7={},_8=_3.security.urlWhitelistEnabled,_9=_3.security.allowUrlCheckPattern;
opensocialUrl_=_2.getServiceUrl(_6.opensocial),errorPage_=opensocialUrl_+"/ic/errors/errorMini.jsp";
if(_9){
_9=new RegExp(_3.security.allowUrlCheckPattern,"i");
}else{
_9={"test":function(){
return false;
}};
}
function _a(_b,_c,_d){
if(_e(_c)){
return this.navigateUrlNoSecurity.apply(this,arguments);
}else{
_4.warn("Blocking access to url: "+_c+".  URL does not match whitelist.");
var _f=Array.prototype.slice.call(arguments);
_f[1]=errorPage_;
return this.navigateUrlNoSecurity.apply(this,_f);
}
};
function _e(url){
if(!_8){
return true;
}
return url&&url.indexOf("..")===-1&&_9.test(url);
};
_7.registerService=function(_10){
_10.navigateUrlNoSecurity=_10.navigateUrl;
_10.navigateUrl=_a;
};
return _7;
})(dojo,lconn.core.url,com.ibm.lconn.gadget.config.settings,com.ibm.lconn.gadget.util.trace,com.ibm.lconn.gadget.services.dialog.UrlAccessDeniedDialog,lconn.core.config.services);
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.container.ICActions"]){
dojo._hasResource["com.ibm.lconn.gadget.container.ICActions"]=true;
dojo.provide("com.ibm.lconn.gadget.container.ICActions");
dojo.declare("com.ibm.lconn.gadget.container.ICActions",null,{registerNavigateGadgetHandler:function(_1){
},registerService:function(_2){
}});
dojo.mixin(com.ibm.lconn.gadget.container.ICActions,{__instance__:function(){
}});
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.services.ICActionsContainer"]){
dojo._hasResource["com.ibm.lconn.gadget.services.ICActionsContainer"]=true;
dojo.provide("com.ibm.lconn.gadget.services.ICActionsContainer");


(function(_1,_2){
var _3=_1.declare("com.ibm.lconn.gadget.services.ICActionsContainer",[_2],{_renderGadgetInContainer:null,constructor:function(){
this._renderGadgetInContainer=[];
},registerService:function(_4){
_4.actions.registerNavigateGadgetHandler(_1.hitch(this,this.handleGadgetSelection));
},registerNavigateGadgetHandler:function(_5){
if(typeof _5==="function"){
this._renderGadgetInContainer.push(_5);
}
},handleGadgetSelection:function(_6,_7){
_1.forEach(this._renderGadgetInContainer,function(_8){
_8(_6,_7);
});
}});
var _9=new _3();
_2.__instance__=function(){
return _9;
};
})(dojo,com.ibm.lconn.gadget.container.ICActions);
}


;if(!dojo._hasResource["lconn.core.util.LCDeferredList"]){
dojo._hasResource["lconn.core.util.LCDeferredList"]=true;
dojo.provide("lconn.core.util.LCDeferredList");


(function(_1,_2){
lconn.core.util.LCDeferredList=function(_3,_4,_5,_6,_7){
var _8=[];
_2.call(this);
var _9=this;
if(_3.length===0&&!_4){
this.resolve([0,[]]);
}
var _a=0;
_1.forEach(_3,function(_b,i){
_b.then(function(_c){
if(_4){
_9.resolve([i,_c]);
}else{
_d(true,_c);
}
},function(_e){
if(_5){
_9.reject(_e);
}else{
_d(false,_e);
}
if(_6){
return null;
}
throw _e;
});
function _d(_f,_10){
_8[i]=[_f,_10];
_a++;
if(_a===_3.length){
_9.resolve(_8);
}
};
});
};
lconn.core.util.LCDeferredList.prototype=new _1.Deferred();
lconn.core.util.LCDeferredList.prototype.gatherResults=function(_11){
var d=new lconn.core.util.LCDeferredList(_11,false,true,false);
d.addCallback(function(_12){
var ret=[];
_1.forEach(_12,function(_13){
ret.push(_13[1]);
});
return ret;
});
return d;
};
return lconn.core.util.LCDeferredList;
}(dojo,lconn.core.util.LCDeferred));
}


;dojo.provide("lconn.core.util.amdLoader");
lconn.core.util.amdLoader=(function(_1){
var _2,_3,_4;
var _5="2.0.2",_6=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,_7=/require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,_8=/\.js$/,_9=/^\.\//,_a=Object.prototype.toString,ap=Array.prototype,_b=ap.slice,_c=ap.splice,_d=!!(typeof window!=="undefined"&&navigator&&document),_e=!_d&&typeof importScripts!=="undefined",_f=_d&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,_10="_",_11=typeof opera!=="undefined"&&opera.toString()==="[object Opera]",_12={},cfg={},_13=[],_14=false,req,s,_15,_16,_17,src,_18,_19,_1a,_1b;
function _1c(it){
return _a.call(it)==="[object Function]";
};
function _1d(it){
return _a.call(it)==="[object Array]";
};
function _1e(ary,_1f){
if(ary){
var i;
for(i=0;i<ary.length;i+=1){
if(ary[i]&&_1f(ary[i],i,ary)){
break;
}
}
}
};
function _20(ary,_21){
if(ary){
var i;
for(i=ary.length-1;i>-1;i-=1){
if(ary[i]&&_21(ary[i],i,ary)){
break;
}
}
}
};
function _22(obj,_23){
return obj.hasOwnProperty(_23);
};
function _24(obj,_25){
var _26;
for(_26 in obj){
if(obj.hasOwnProperty(_26)){
if(_25(obj[_26],_26)){
break;
}
}
}
};
function _27(_28,_29,_2a,_2b){
if(_29){
_24(_29,function(_2c,_2d){
if(_2a||!_22(_28,_2d)){
if(_2b&&typeof _2c!=="string"){
if(!_28[_2d]){
_28[_2d]={};
}
_27(_28[_2d],_2c,_2a,_2b);
}else{
_28[_2d]=_2c;
}
}
});
}
return _28;
};
function _2e(obj,fn){
return function(){
return fn.apply(obj,arguments);
};
};
function _2f(){
return document.getElementsByTagName("script");
};
function _30(_31){
if(!_31){
return _31;
}
var g=_1;
_1e(_31.split("."),function(_32){
g=g[_32];
});
return g;
};
function _33(_34,_35,_36){
return function(){
var _37=_b.call(arguments,0),_38;
if(_36&&_1c((_38=_37[_37.length-1]))){
_38.__requireJsBuild=true;
}
_37.push(_35);
return _34.apply(null,_37);
};
};
function _39(req,_3a,_3b){
_1e([["toUrl"],["undef"],["defined","requireDefined"],["specified","requireSpecified"]],function(_3c){
var _3d=_3c[1]||_3c[0];
req[_3c[0]]=_3a?_33(_3a[_3d],_3b):function(){
var ctx=_12[_10];
return ctx[_3d].apply(ctx,arguments);
};
});
};
function _3e(id,msg,err,_3f){
var e=new Error(msg+"\nhttp://requirejs.org/docs/errors.html#"+id);
e.requireType=id;
e.requireModules=_3f;
if(err){
e.originalError=err;
}
return e;
};
if(typeof _3!=="undefined"){
return;
}
if(typeof _4!=="undefined"){
if(_1c(_4)){
return;
}
cfg=_4;
_4=undefined;
}
if(typeof _2!=="undefined"&&!_1c(_2)){
cfg=_2;
_2=undefined;
}
function _40(_41){
var _42={waitSeconds:60,baseUrl:"./",paths:{},pkgs:{},shim:{}},_43={},_44={},_45=[],_46={},_47={},_48=1,_49=1,_4a=[],_4b,_4c,_4d,_4e,_4f;
function _50(ary){
var i,_51;
for(i=0;ary[i];i+=1){
_51=ary[i];
if(_51==="."){
ary.splice(i,1);
i-=1;
}else{
if(_51===".."){
if(i===1&&(ary[2]===".."||ary[0]==="..")){
break;
}else{
if(i>0){
ary.splice(i-1,2);
i-=2;
}
}
}
}
}
};
function _52(_53,_54,_55){
var _56=_54&&_54.split("/"),map=_42.map,_57=map&&map["*"],_58,_59,_5a,_5b,i,j,_5c,_5d;
if(_53&&_53.charAt(0)==="."){
if(_54){
if(_42.pkgs[_54]){
_56=[_54];
}else{
_56=_56.slice(0,_56.length-1);
}
_53=_56.concat(_53.split("/"));
_50(_53);
_59=_42.pkgs[(_58=_53[0])];
_53=_53.join("/");
if(_59&&_53===_58+"/"+_59.main){
_53=_58;
}
}else{
if(_53.indexOf("./")===0){
_53=_53.substring(2);
}
}
}
if(_55&&(_56||_57)&&map){
_5b=_53.split("/");
for(i=_5b.length;i>0;i-=1){
_5c=_5b.slice(0,i).join("/");
if(_56){
for(j=_56.length;j>0;j-=1){
_5a=map[_56.slice(0,j).join("/")];
if(_5a){
_5a=_5a[_5c];
if(_5a){
_5d=_5a;
break;
}
}
}
}
if(!_5d&&_57&&_57[_5c]){
_5d=_57[_5c];
}
if(_5d){
_5b.splice(0,i,_5d);
_53=_5b.join("/");
break;
}
}
}
return _53;
};
function _5e(_5f){
if(_d){
_1e(_2f(),function(_60){
if(_60.getAttribute("data-requiremodule")===_5f&&_60.getAttribute("data-requirecontext")===_4d.contextName){
_60.parentNode.removeChild(_60);
return true;
}
});
}
};
function _61(id){
var _62=_42.paths[id];
if(_62&&_1d(_62)&&_62.length>1){
_5e(id);
_62.shift();
_4d.undef(id);
_4d.require([id]);
return true;
}
};
function _63(_64,_65,_66,_67){
var _68=_64?_64.indexOf("!"):-1,_69=null,_6a=_65?_65.name:null,_6b=_64,_6c=true,_6d="",url,_6e,_6f;
if(!_64){
_6c=false;
_64="_@r"+(_48+=1);
}
if(_68!==-1){
_69=_64.substring(0,_68);
_64=_64.substring(_68+1,_64.length);
}
if(_69){
_69=_52(_69,_6a,_67);
_6e=_46[_69];
}
if(_64){
if(_69){
if(_6e&&_6e.normalize){
_6d=_6e.normalize(_64,function(_70){
return _52(_70,_6a,_67);
});
}else{
_6d=_52(_64,_6a,_67);
}
}else{
_6d=_52(_64,_6a,_67);
url=_4d.nameToUrl(_64,null,_65);
}
}
_6f=_69&&!_6e&&!_66?"_unnormalized"+(_49+=1):"";
return {prefix:_69,name:_6d,parentMap:_65,unnormalized:!!_6f,url:url,originalName:_6b,isDefine:_6c,id:(_69?_69+"!"+_6d:_6d)+_6f};
};
function _71(_72){
var id=_72.id,mod=_43[id];
if(!mod){
mod=_43[id]=new _4d.Module(_72);
}
return mod;
};
function on(_73,_74,fn){
var id=_73.id,mod=_43[id];
if(_22(_46,id)&&(!mod||mod.defineEmitComplete)){
if(_74==="defined"){
fn(_46[id]);
}
}else{
_71(_73).on(_74,fn);
}
};
function _75(err,_76){
var ids=err.requireModules,_77=false;
if(_76){
_76(err);
}else{
_1e(ids,function(id){
var mod=_43[id];
if(mod){
mod.error=err;
if(mod.events.error){
_77=true;
mod.emit("error",err);
}
}
});
if(!_77){
req.onError(err);
}
}
};
function _78(){
if(_13.length){
_c.apply(_45,[_45.length-1,0].concat(_13));
_13=[];
}
};
function _79(mod,_7a,_7b){
var _7c=mod&&mod.map,_7d=_33(_7b||_4d.require,_7c,_7a);
_39(_7d,_4d,_7c);
_7d.isBrowser=_d;
return _7d;
};
_4e={"require":function(mod){
return _79(mod);
},"exports":function(mod){
mod.usingExports=true;
if(mod.map.isDefine){
return (mod.exports=_46[mod.map.id]={});
}
},"module":function(mod){
return (mod.module={id:mod.map.id,uri:mod.map.url,config:function(){
return (_42.config&&_42.config[mod.map.id])||{};
},exports:_46[mod.map.id]});
}};
function _7e(id){
delete _43[id];
_1e(_4a,function(mod,i){
if(mod.map.id===id){
_4a.splice(i,1);
if(!mod.defined){
_4d.waitCount-=1;
}
return true;
}
});
};
function _7f(mod,_80){
var id=mod.map.id,_81=mod.depMaps,_82;
if(!mod.inited){
return;
}
if(_80[id]){
return mod;
}
_80[id]=true;
_1e(_81,function(_83){
var _84=_83.id,_85=_43[_84];
if(!_85){
return;
}
if(!_85.inited||!_85.enabled){
_82=null;
delete _80[id];
return true;
}
return (_82=_7f(_85,_27({},_80)));
});
return _82;
};
function _86(mod,_87,_88){
var id=mod.map.id,_89=mod.depMaps;
if(!mod.inited||!mod.map.isDefine){
return;
}
if(_87[id]){
return _46[id];
}
_87[id]=mod;
_1e(_89,function(_8a){
var _8b=_8a.id,_8c=_43[_8b],_8d;
if(_4e[_8b]){
return;
}
if(_8c){
if(!_8c.inited||!_8c.enabled){
_88[id]=true;
return;
}
_8d=_86(_8c,_87,_88);
if(!_88[_8b]){
mod.defineDepById(_8b,_8d);
}
}
});
mod.check(true);
return _46[id];
};
function _8e(mod){
mod.check();
};
function _8f(){
var _90=_42.waitSeconds*1000,_91=_90&&(_4d.startTime+_90)<new Date().getTime(),_92=[],_93=false,_94=true,map,_95,err,_96;
if(_4b){
return;
}
_4b=true;
_24(_43,function(mod){
map=mod.map;
_95=map.id;
if(!mod.enabled){
return;
}
if(!mod.error){
if(!mod.inited&&_91){
if(_61(_95)){
_96=true;
_93=true;
}else{
_92.push(_95);
_5e(_95);
}
}else{
if(!mod.inited&&mod.fetched&&map.isDefine){
_93=true;
if(!map.prefix){
return (_94=false);
}
}
}
}
});
if(_91&&_92.length){
err=_3e("timeout","Load timeout for modules: "+_92,null,_92);
err.contextName=_4d.contextName;
return _75(err);
}
if(_94){
_1e(_4a,function(mod){
if(mod.defined){
return;
}
var _97=_7f(mod,{}),_98={};
if(_97){
_86(_97,_98,{});
_24(_98,_8e);
}
});
_24(_43,_8e);
}
if((!_91||_96)&&_93){
if((_d||_e)&&!_4f){
_4f=setTimeout(function(){
_4f=0;
_8f();
},50);
}
}
_4b=false;
};
_4c=function(map){
this.events=_44[map.id]||{};
this.map=map;
this.shim=_42.shim[map.id];
this.depExports=[];
this.depMaps=[];
this.depMatched=[];
this.pluginMaps={};
this.depCount=0;
};
_4c.prototype={init:function(_99,_9a,_9b,_9c){
_9c=_9c||{};
if(this.inited){
return;
}
this.factory=_9a;
if(_9b){
this.on("error",_9b);
}else{
if(this.events.error){
_9b=_2e(this,function(err){
this.emit("error",err);
});
}
}
this.depMaps=_99&&_99.slice(0);
this.depMaps.rjsSkipMap=_99.rjsSkipMap;
this.errback=_9b;
this.inited=true;
this.ignore=_9c.ignore;
if(_9c.enabled||this.enabled){
this.enable();
}else{
this.check();
}
},defineDepById:function(id,_9d){
var i;
_1e(this.depMaps,function(map,_9e){
if(map.id===id){
i=_9e;
return true;
}
});
return this.defineDep(i,_9d);
},defineDep:function(i,_9f){
if(!this.depMatched[i]){
this.depMatched[i]=true;
this.depCount-=1;
this.depExports[i]=_9f;
}
},fetch:function(){
if(this.fetched){
return;
}
this.fetched=true;
_4d.startTime=(new Date()).getTime();
var map=this.map;
if(this.shim){
_79(this,true)(this.shim.deps||[],_2e(this,function(){
return map.prefix?this.callPlugin():this.load();
}));
}else{
return map.prefix?this.callPlugin():this.load();
}
},load:function(){
var url=this.map.url;
if(!_47[url]){
_47[url]=true;
_4d.load(this.map.id,url);
}
},check:function(_a0){
if(!this.enabled||this.enabling){
return;
}
var id=this.map.id,_a1=this.depExports,_a2=this.exports,_a3=this.factory,err,_a4;
if(!this.inited){
this.fetch();
}else{
if(this.error){
this.emit("error",this.error);
}else{
if(!this.defining){
this.defining=true;
if(this.depCount<1&&!this.defined){
if(_1c(_a3)){
if(this.events.error){
try{
_a2=_4d.execCb(id,_a3,_a1,_a2);
}
catch(e){
err=e;
}
}else{
_a2=_4d.execCb(id,_a3,_a1,_a2);
}
if(this.map.isDefine){
_a4=this.module;
if(_a4&&_a4.exports!==undefined&&_a4.exports!==this.exports){
_a2=_a4.exports;
}else{
if(_a2===undefined&&this.usingExports){
_a2=this.exports;
}
}
}
if(err){
err.requireMap=this.map;
err.requireModules=[this.map.id];
err.requireType="define";
return _75((this.error=err));
}
}else{
_a2=_a3;
}
this.exports=_a2;
if(this.map.isDefine&&!this.ignore){
_46[id]=_a2;
if(req.onResourceLoad){
req.onResourceLoad(_4d,this.map,this.depMaps);
}
}
delete _43[id];
this.defined=true;
_4d.waitCount-=1;
if(_4d.waitCount===0){
_4a=[];
}
}
this.defining=false;
if(!_a0){
if(this.defined&&!this.defineEmitted){
this.defineEmitted=true;
this.emit("defined",this.exports);
this.defineEmitComplete=true;
}
}
}
}
}
},callPlugin:function(){
var map=this.map,id=map.id,_a5=_63(map.prefix,null,false,true);
on(_a5,"defined",_2e(this,function(_a6){
var _a7=this.map.name,_a8=this.map.parentMap?this.map.parentMap.name:null,_a9,_aa,_ab;
if(this.map.unnormalized){
if(_a6.normalize){
_a7=_a6.normalize(_a7,function(_ac){
return _52(_ac,_a8,true);
})||"";
}
_aa=_63(map.prefix+"!"+_a7,this.map.parentMap,false,true);
on(_aa,"defined",_2e(this,function(_ad){
this.init([],function(){
return _ad;
},null,{enabled:true,ignore:true});
}));
_ab=_43[_aa.id];
if(_ab){
if(this.events.error){
_ab.on("error",_2e(this,function(err){
this.emit("error",err);
}));
}
_ab.enable();
}
return;
}
_a9=_2e(this,function(_ae){
this.init([],function(){
return _ae;
},null,{enabled:true});
});
_a9.error=_2e(this,function(err){
this.inited=true;
this.error=err;
err.requireModules=[id];
_24(_43,function(mod){
if(mod.map.id.indexOf(id+"_unnormalized")===0){
_7e(mod.map.id);
}
});
_75(err);
});
_a9.fromText=function(_af,_b0){
var _b1=_14;
if(_b1){
_14=false;
}
_71(_63(_af));
req.exec(_b0);
if(_b1){
_14=true;
}
_4d.completeLoad(_af);
};
_a6.load(map.name,_79(map.parentMap,true,function(_b2,cb){
_b2.rjsSkipMap=true;
return _4d.require(_b2,cb);
}),_a9,_42);
}));
_4d.enable(_a5,this);
this.pluginMaps[_a5.id]=_a5;
},enable:function(){
this.enabled=true;
if(!this.waitPushed){
_4a.push(this);
_4d.waitCount+=1;
this.waitPushed=true;
}
this.enabling=true;
_1e(this.depMaps,_2e(this,function(_b3,i){
var id,mod,_b4;
if(typeof _b3==="string"){
_b3=_63(_b3,(this.map.isDefine?this.map:this.map.parentMap),false,!this.depMaps.rjsSkipMap);
this.depMaps[i]=_b3;
_b4=_4e[_b3.id];
if(_b4){
this.depExports[i]=_b4(this);
return;
}
this.depCount+=1;
on(_b3,"defined",_2e(this,function(_b5){
this.defineDep(i,_b5);
this.check();
}));
if(this.errback){
on(_b3,"error",this.errback);
}
}
id=_b3.id;
mod=_43[id];
if(!_4e[id]&&mod&&!mod.enabled){
_4d.enable(_b3,this);
}
}));
_24(this.pluginMaps,_2e(this,function(_b6){
var mod=_43[_b6.id];
if(mod&&!mod.enabled){
_4d.enable(_b6,this);
}
}));
this.enabling=false;
this.check();
},on:function(_b7,cb){
var cbs=this.events[_b7];
if(!cbs){
cbs=this.events[_b7]=[];
}
cbs.push(cb);
},emit:function(_b8,evt){
_1e(this.events[_b8],function(cb){
cb(evt);
});
if(_b8==="error"){
delete this.events[_b8];
}
}};
function _b9(_ba){
_71(_63(_ba[0],null,true)).init(_ba[1],_ba[2]);
};
function _bb(_bc,_bd,_be,_bf){
if(_bc.detachEvent&&!_11){
if(_bf){
_bc.detachEvent(_bf,_bd);
}
}else{
_bc.removeEventListener(_be,_bd,false);
}
};
function _c0(evt){
var _c1=evt.currentTarget||evt.srcElement;
_bb(_c1,_4d.onScriptLoad,"load","onreadystatechange");
_bb(_c1,_4d.onScriptError,"error");
return {node:_c1,id:_c1&&_c1.getAttribute("data-requiremodule")};
};
return (_4d={config:_42,contextName:_41,registry:_43,defined:_46,urlFetched:_47,waitCount:0,defQueue:_45,Module:_4c,makeModuleMap:_63,configure:function(cfg){
if(cfg.baseUrl){
if(cfg.baseUrl.charAt(cfg.baseUrl.length-1)!=="/"){
cfg.baseUrl+="/";
}
}
var _c2=_42.pkgs,_c3=_42.shim,_c4=_42.paths,map=_42.map;
_27(_42,cfg,true);
_42.paths=_27(_c4,cfg.paths,true);
if(cfg.map){
_42.map=_27(map||{},cfg.map,true,true);
}
if(cfg.shim){
_24(cfg.shim,function(_c5,id){
if(_1d(_c5)){
_c5={deps:_c5};
}
if(_c5.exports&&!_c5.exports.__buildReady){
_c5.exports=_4d.makeShimExports(_c5.exports);
}
_c3[id]=_c5;
});
_42.shim=_c3;
}
if(cfg.packages){
_1e(cfg.packages,function(_c6){
var _c7;
_c6=typeof _c6==="string"?{name:_c6}:_c6;
_c7=_c6.location;
_c2[_c6.name]={name:_c6.name,location:_c7||_c6.name,main:(_c6.main||"main").replace(_9,"").replace(_8,"")};
});
_42.pkgs=_c2;
}
_24(_43,function(mod,id){
mod.map=_63(id);
});
if(cfg.deps||cfg.callback){
_4d.require(cfg.deps||[],cfg.callback);
}
},makeShimExports:function(_c8){
var _c9;
if(typeof _c8==="string"){
_c9=function(){
return _30(_c8);
};
_c9.exports=_c8;
return _c9;
}else{
return function(){
return _c8.apply(_1,arguments);
};
}
},requireDefined:function(id,_ca){
return _22(_46,_63(id,_ca,false,true).id);
},requireSpecified:function(id,_cb){
id=_63(id,_cb,false,true).id;
return _22(_46,id)||_22(_43,id);
},require:function(_cc,_cd,_ce,_cf){
var _d0,id,map,_d1,_d2;
if(typeof _cc==="string"){
if(_1c(_cd)){
return _75(_3e("requireargs","Invalid require call"),_ce);
}
if(req.get){
return req.get(_4d,_cc,_cd);
}
_d0=_cc;
_cf=_cd;
map=_63(_d0,_cf,false,true);
id=map.id;
if(!_22(_46,id)){
return _75(_3e("notloaded","Module name \""+id+"\" has not been loaded yet for context: "+_41));
}
return _46[id];
}
if(_ce&&!_1c(_ce)){
_cf=_ce;
_ce=undefined;
}
if(_cd&&!_1c(_cd)){
_cf=_cd;
_cd=undefined;
}
_78();
while(_45.length){
_d2=_45.shift();
if(_d2[0]===null){
return _75(_3e("mismatch","Mismatched anonymous define() module: "+_d2[_d2.length-1]));
}else{
_b9(_d2);
}
}
_d1=_71(_63(null,_cf));
_d1.init(_cc,_cd,_ce,{enabled:true});
_8f();
return _4d.require;
},undef:function(id){
var map=_63(id,null,true),mod=_43[id];
delete _46[id];
delete _47[map.url];
delete _44[id];
if(mod){
if(mod.events.defined){
_44[id]=mod.events;
}
_7e(id);
}
},enable:function(_d3,_d4){
var mod=_43[_d3.id];
if(mod){
_71(_d3).enable();
}
},completeLoad:function(_d5){
var _d6=_42.shim[_d5]||{},_d7=_d6.exports&&_d6.exports.exports,_d8,_d9,mod;
_78();
while(_45.length){
_d9=_45.shift();
if(_d9[0]===null){
_d9[0]=_d5;
if(_d8){
break;
}
_d8=true;
}else{
if(_d9[0]===_d5){
_d8=true;
}
}
_b9(_d9);
}
mod=_43[_d5];
if(!_d8&&!_46[_d5]&&mod&&!mod.inited){
if(_42.enforceDefine&&(!_d7||!_30(_d7))){
if(_61(_d5)){
return;
}else{
return _75(_3e("nodefine","No define call for "+_d5,null,[_d5]));
}
}else{
_b9([_d5,(_d6.deps||[]),_d6.exports]);
}
}
_8f();
},toUrl:function(_da,_db){
var _dc=_da.lastIndexOf("."),ext=null;
if(_dc!==-1){
ext=_da.substring(_dc,_da.length);
_da=_da.substring(0,_dc);
}
return _4d.nameToUrl(_da,ext,_db);
},nameToUrl:function(_dd,ext,_de){
var _df,_e0,pkg,_e1,_e2,i,_e3,url,_e4;
_dd=_52(_dd,_de&&_de.id,true);
if(req.jsExtRegExp.test(_dd)){
url=_dd+(ext||"");
}else{
_df=_42.paths;
_e0=_42.pkgs;
_e2=_dd.split("/");
for(i=_e2.length;i>0;i-=1){
_e3=_e2.slice(0,i).join("/");
pkg=_e0[_e3];
_e4=_df[_e3];
if(_e4){
if(_1d(_e4)){
_e4=_e4[0];
}
_e2.splice(0,i,_e4);
break;
}else{
if(pkg){
if(_dd===pkg.name){
_e1=pkg.location+"/"+pkg.main;
}else{
_e1=pkg.location;
}
_e2.splice(0,i,_e1);
break;
}
}
}
url=_e2.join("/")+(ext||".js");
url=(url.charAt(0)==="/"||url.match(/^[\w\+\.\-]+:/)?"":_42.baseUrl)+url;
}
return _42.urlArgs?url+((url.indexOf("?")===-1?"?":"&")+_42.urlArgs):url;
},load:function(id,url){
req.load(_4d,id,url);
},execCb:function(_e5,_e6,_e7,_e8){
return _e6.apply(_e8,_e7);
},onScriptLoad:function(evt){
if(evt.type==="load"||(_f.test((evt.currentTarget||evt.srcElement).readyState))){
_18=null;
var _e9=_c0(evt);
_4d.completeLoad(_e9.id);
}
},onScriptError:function(evt){
var _ea=_c0(evt);
if(!_61(_ea.id)){
return _75(_3e("scripterror","Script error",evt,[_ea.id]));
}
}});
};
req=_4=function(_eb,_ec,_ed,_ee){
var _ef=_10,_f0,_f1;
if(!_1d(_eb)&&typeof _eb!=="string"){
_f1=_eb;
if(_1d(_ec)){
_eb=_ec;
_ec=_ed;
_ed=_ee;
}else{
_eb=[];
}
}
if(_f1&&_f1.context){
_ef=_f1.context;
}
_f0=_12[_ef];
if(!_f0){
_f0=_12[_ef]=req.s.newContext(_ef);
}
if(_f1){
_f0.configure(_f1);
}
return _f0.require(_eb,_ec,_ed);
};
req.config=function(_f2){
return req(_f2);
};
if(!_2){
_2=req;
}
req.version=_5;
req.jsExtRegExp=/^\/|:|\?|\.js$/;
req.isBrowser=_d;
s=req.s={contexts:_12,newContext:_40};
req({});
_39(req);
if(_d){
_15=s.head=document.getElementsByTagName("head")[0];
_16=document.getElementsByTagName("base")[0];
if(_16){
_15=s.head=_16.parentNode;
}
}
req.onError=function(err){
throw err;
};
req.load=function(_f3,_f4,url){
var _f5=(_f3&&_f3.config)||{},_f6;
if(_d){
_f6=_f5.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");
_f6.type=_f5.scriptType||"text/javascript";
_f6.charset="utf-8";
_f6.setAttribute("data-requirecontext",_f3.contextName);
_f6.setAttribute("data-requiremodule",_f4);
if(_f6.attachEvent&&!(_f6.attachEvent.toString&&_f6.attachEvent.toString().indexOf("[native code")<0)&&!_11){
_14=true;
_f6.attachEvent("onreadystatechange",_f3.onScriptLoad);
}else{
_f6.addEventListener("load",_f3.onScriptLoad,false);
_f6.addEventListener("error",_f3.onScriptError,false);
}
_f6.src=url;
_19=_f6;
if(_16){
_15.insertBefore(_f6,_16);
}else{
_15.appendChild(_f6);
}
_19=null;
return _f6;
}else{
if(_e){
importScripts(url);
_f3.completeLoad(_f4);
}
}
};
function _f7(){
if(_18&&_18.readyState==="interactive"){
return _18;
}
_20(_2f(),function(_f8){
if(_f8.readyState==="interactive"){
return (_18=_f8);
}
});
return _18;
};
if(_d){
_20(_2f(),function(_f9){
if(!_15){
_15=_f9.parentNode;
}
_17=_f9.getAttribute("data-main");
if(_17){
src=_17.split("/");
_1a=src.pop();
_1b=src.length?src.join("/")+"/":"./";
if(!cfg.baseUrl){
cfg.baseUrl=_1b;
}
_17=_1a.replace(_8,"");
cfg.deps=cfg.deps?cfg.deps.concat(_17):[_17];
return true;
}
});
}
_3=function(_fa,_fb,_fc){
var _fd,_fe;
if(typeof _fa!=="string"){
_fc=_fb;
_fb=_fa;
_fa=null;
}
if(!_1d(_fb)){
_fc=_fb;
_fb=[];
}
if(!_fb.length&&_1c(_fc)){
if(_fc.length){
_fc.toString().replace(_6,"").replace(_7,function(_ff,dep){
_fb.push(dep);
});
_fb=(_fc.length===1?["require"]:["require","exports","module"]).concat(_fb);
}
}
if(_14){
_fd=_19||_f7();
if(_fd){
if(!_fa){
_fa=_fd.getAttribute("data-requiremodule");
}
_fe=_12[_fd.getAttribute("data-requirecontext")];
}
}
(_fe?_fe.defQueue:_13).push([_fa,_fb,_fc]);
};
_3.amd={jQuery:true};
req.exec=function(text){
return eval(text);
};
req(cfg);
return {require:_2,requirejs:_4,define:_3};
}(dojo.global));


;if(!dojo._hasResource["com.ibm.lconn.gadget.container._Accessor"]){
dojo._hasResource["com.ibm.lconn.gadget.container._Accessor"]=true;
dojo.provide("com.ibm.lconn.gadget.container._Accessor");














































(function init_com_ibm_lconn_gadget_container__Accessor(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
var _c=null;
var _d=lconn.core.util.amdLoader.require;
var _e=_7.security;
var _f=_1.global.location;
var _10="X-IC-Preload";
var _11=(function(){
var _12=navigator.appName;
var _13=navigator.userAgent.indexOf("Safari");
return (_13!==-1||_12==="Safari");
})();
var _14=(_1.config.locale||""),_15=_14.substr(0,Math.min(_14.length,2)),_16=_14.substr(Math.min(_14.length,3),Math.min(_14.length,5));
var _17=(function(){
var _18={"pt":"br","zh":"tw"};
var _19={"zh":"zh-cn","he":"iw","id":"in","nb":"no"};
var _1a=_15;
if(_18[_15]&&_18[_15]==_16){
_1a=_1a+"-"+_16;
}
_1a=_19[_1a]||_1a;
if(!_1a){
_1a="en";
}
return _1a;
})();
var _1b=_4.opensocial,_1c=_2.parse(_f.toString(),_1b?_9(_2.getServiceUrl(_1b).toString()):"");
if(!_1.config.blankGif){
(function configBlankGif_(){
var _1d=_4.webresources,_1e=_2.parse(_f.toString(),_9(_2.getServiceUrl(_1d).toString()));
_1.config.blankGif=_1e.toString()+"/web/com.ibm.lconn.core.styles.oneui3/images/blank.gif";
})();
}
var _1f=this;
function _20(){
var _21=new _5();
var _22=_3.versionStamp||"";
var _23=(_17&&_17!=="")?"cre.messages."+_17+":":"",_24="&_ic_versionStamp="+_22,_25=(_1.config.isDebug?"&debug=1&noCache=1":_24),_26=_1c.toString()+"/gadgets/js/cre.iruntime:cre.iwidget.event:cre.wire:cre.iwidget:cre.iwidget.itemset:"+"cre.util.stringify:cre.service.event:cre.osgadget:"+_23+"core:container:rpc:pubsub-2:views:embedded-experiences:open-views:selection:actions:viewenhancements:shared-script-frame:"+"cre.service.people:ibm.connections.sharedialog:com.ibm.connections.sharedialog:"+"com.ibm.connections.ee:ibm.connections.ee:container.nongadget:shindig.sha1:"+"open-views.js?c=1"+_25;
if(!_1.global.cre$){
_8.debug("_Accessor.loadCreJs_ loading CRE JS from: "+_26);
setTimeout(_1.hitch(_1f,function(){
_d([_26],function(){
_8.debug("_Accessor.loadCreJs_ SUCCESS: Load CRE JS");
_21.resolve();
_8.debug("_Accessor.__instance__ Exit load");
},function(_27){
_8.error("_Accessor.loadCreJs_ ERROR: ",_27);
_21.errback(_27);
});
}),0);
}else{
_8.debug("_Accessor.loadCreJs_ SUCCESS: Load CRE JS via JS Bridge");
_21.resolve();
}
return _21;
};
var _28=["window.osapi.container.Container","window.osapi.container.Service","window.__CONTAINER_URI"];
window.__IC_iContainer2_AsyncDependenciesInit=new _5();
window._chkIC_Accessor_AsyncDependencies_=function(){
var _29=false;
try{
for(var i=_28.length;i--;){
if(typeof (eval(_28[i]))==="undefined"){
throw ("undefined leaf node");
}
}
_29=true;
}
catch(e){
}
if(_29){
window.__IC_iContainer2_AsyncDependenciesInit.resolve();
}else{
setTimeout("window._chkIC_Accessor_AsyncDependencies_()",50);
}
};
function _2a(_2b){
var loc=_f;
cre$.config.SCHEME=loc.protocol.substring(0,loc.protocol.length-1);
cre$.config.HOST=loc.hostname;
cre$.config.PORT=(loc.port&&loc.port!=="")?loc.port:"";
cre$.config.CONTEXT_ROOT=_1c.path;
cre$.config.locales=[_17];
cre$.config.MAX_TOKEN_TTL=_e.gadgetTokenTTLSec;
};
function _2c(_2d){
var cc={},CC=osapi.container.ContainerConfig;
cc[osapi.container.ServiceConfig.API_HOST]=[_1c.scheme,"://",_1c.authority].join("");
cc[osapi.container.ServiceConfig.API_PATH]=_1c.path+"/rpc";
cc[CC.TOKEN_REFRESH_INTERVAL]=_e.gadgetTokenTTLSec*1000;
cc[CC.GET_CONTAINER_TOKEN]=_b.getTokenRefresher();
cc[CC.GET_LANGUAGE]=function(){
return _15;
};
cc[CC.GET_COUNTRY]=function(){
return _16;
};
cc[CC.SET_PREFERENCES]=function(_2e,_2f,_30){
var _31=_a.getSiteTopic(_2f,_a.GadgetWindow.SET_PREFS);
_1.publish(_31,[{"siteId":_2e,"gadgetUrl":_2f,"preferences":_30}]);
};
if(_1.config.isDebug){
cc[CC.RENDER_DEBUG]=true;
cc[CC.RENDER_TEST]=true;
}
return cc;
};
function _32(_33){
com.ibm.lconn.gadget.services.viewModifications.registerService(_33);
com.ibm.lconn.gadget.services.set_title.registerService(_33);
com.ibm.lconn.gadget.services.lifecycleModifications.registerService(_33);
com.ibm.lconn.gadget.services.oauthPopupDialog.registerService(_33);
com.ibm.lconn.gadget.services.sso_reauth_callback.registerService(_33);
com.ibm.lconn.gadget.services.fake_handleRpcMethod.registerService(_33);
_b.registerService(_33);
com.ibm.lconn.gadget.container.ICActions.__instance__().registerService(_33);
com.ibm.lconn.gadget.services.urlSecurityService.registerService(_33);
};
var _34=_1.declare("",[com.ibm.lconn.gadget.container.Accessor],{_commonContainerPromise:null,_iRuntimePromise:null,constructor:function(_35,_36){
_8.entering("com.ibm.lconn.gadget.container._Accessor.prototype","constructor",arguments);
this._commonContainerPromise=new _5();
this._iRuntimePromise=new _5();
_35.then(_1.hitch(this,"_loadComplete",_36),_1.hitch(this,"_loadError"));
_8.exiting("com.ibm.lconn.gadget.container._Accessor.prototype","constructor",arguments);
},getCommonContainer:function(){
return this._commonContainerPromise;
},getIRuntime:function(){
return this._iRuntimePromise;
},fakeOpen:function(){
var _37={"id":"0",eventType:"PRELOAD"};
var _38=_4.webresources,_39=_2.parse(_f.toString(),_9(_2.getServiceUrl(_38).toString()));
var _3a=_39.toString();
var _3b=_3a+"/web/com.ibm.social.ee/ConnectionsEE.xml";
var c=document.getElementsByTagName("body")[0];
var div=_1.create("div",{id:dijit.getUniqueId("fake")},c);
div.style.display="none";
var def=[{definitionUrl:_3b,mode:"preload",placement:_1.attr(div,"id"),componentType:"gadget",instanceData:{renderParams:{},viewParams:{},eeDataModel:{context:_37}}}];
if(cre$&&cre$.iRuntime){
cre$.iRuntime.loadWidgets(def).then(function(){
_8.debug("_Accessor.fakeOpen preload done");
_1.cookie(_10,"true",{path:"/"});
},function(_3c){
_8.error("_Accessor.fakeOpen ERROR: ",_3c);
});
}
},_loadComplete:function(_3d,_3e){
_8.entering("com.ibm.lconn.gadget.container._Accessor.prototype","_loadComplete");
_2a(_3d);
var _3f=_2c(_3d);
window._chkIC_Accessor_AsyncDependencies_();
window.__IC_iContainer2_AsyncDependenciesInit.then(_1.hitch(this,function(){
setTimeout(_1.hitch(this,function(){
var _40=_3e[0][1];
var _41=new osapi.container.Container(_3f);
_1.global.__CONTAINER="default";
_32(_41);
cre$.internalutil.setCREContainerToken(_40.creToken);
_41.updateContainerSecurityToken(null,cre$.internalutil.getCREContainerToken().token,_e.containerTokenCheckSec);
cre$.iRuntime.setCommonContainer(_41,{configSecurityToken:false,configInlineOAH:true});
this._commonContainerPromise.resolve(_41);
this._iRuntimePromise.resolve(cre$.iRuntime);
if((_e.preloadJS)||(_11&&(_e.preloadJSSafari))){
var _42=this.getCookieVals_(_10);
if(!_42||(!_42.length>0)){
this.fakeOpen();
}
}
}),10);
}));
_8.exiting("com.ibm.lconn.gadget.container._Accessor.prototype","_loadComplete");
},getCookieVals_:function(_43){
var c=document.cookie,_44="(?:^|; )"+_1.regexp.escapeString(_43)+"=([^;]*)",_45,_46=new RegExp(_44),res,_47=[],i;
_45=c.match(new RegExp(_44,"g"));
if(_45&&_45.length>0){
i=_45.length;
while(i--){
res=_45[i];
_47.push(decodeURIComponent(res.match(_46)[1]));
}
}
return _47;
},_loadError:function(_48){
_8.error("_Accessor.prototype._loadError called.",_48);
this._commonContainerPromise.errback(_48);
this._iRuntimePromise.errback(_48);
}});
_1.mixin(com.ibm.lconn.gadget.container.Accessor,{__instance__:function(_49){
_8.entering("com.ibm.lconn.gadget.container._Accessor","__instance__");
if(_c===null){
var _4a=_20(),_4b=_b.getContainerToken(_4a);
_c=new _34(new _6([_4b,_4a]),_49);
}else{
_8.debug("_Accessor.__instance__ Already called, skipping re-init");
}
_8.exiting("com.ibm.lconn.gadget.container._Accessor","__instance__");
return _c;
}});
})(dojo,lconn.core.url,lconn.core.config,lconn.core.config.services,lconn.core.util.LCDeferred,lconn.core.util.LCDeferredList,com.ibm.lconn.gadget.config.settings,com.ibm.lconn.gadget.util.trace,com.ibm.oneui.util.proxy,com.ibm.lconn.gadget.container.Topics,com.ibm.lconn.gadget.services.tokenRefreshService);
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.container.Container"]){
dojo._hasResource["com.ibm.lconn.gadget.container.Container"]=true;
dojo.provide("com.ibm.lconn.gadget.container.Container");




dojo.declare("com.ibm.lconn.gadget.container.Container",null,{loadWidget:function(_1){
},preloadWidgets:function(_2){
},loadWidgets:function(_3){
},unloadWidgets:function(_4){
},getGadgetInfo:function(_5){
}});
com.ibm.lconn.gadget.container.Container.__instance__=com.ibm.lconn.gadget.container.Container.__instance__||function(_6){
};
com.ibm.lconn.gadget.container.Container.RenderParam={TEST_MODE:"testmode"};
}


;if(!dojo._hasResource["lconn.core.util.promises"]){
dojo._hasResource["lconn.core.util.promises"]=true;
dojo.provide("lconn.core.util.promises");




(function(_1,d,_2,_3){
_1.iFaceClass=d.declare("",null,{then:function(){
},cancel:function(){
}});
_1.isPromiseLike=function(_4){
if(_4&&(_4.then&&d.isFunction(_4.then))){
return true;
}else{
return false;
}
};
_1.deferredToPromise=function(_5){
if(_1.isPromiseLike(_5)){
return _5;
}else{
var p=new _2();
_5.addCallback(p,"callback");
_5.addErrback(p,"errback");
return p;
}
};
})(lconn.core.util.promises,dojo,lconn.core.util.LCDeferred,lconn.core.util.LCDeferredList);
}


;if(!dojo._hasResource["lconn.core.util.LCChainedDeferred"]){
dojo._hasResource["lconn.core.util.LCChainedDeferred"]=true;
dojo.provide("lconn.core.util.LCChainedDeferred");




(function(d,_1,_2){
d.declare("lconn.core.util.LCChainedDeferred",_1.iFaceClass,{_promiseChain:null,_deferred:null,_errored:false,constructor:function(_3){
this._deferred=new _2();
this._promiseChain=_3;
this._hitch();
},then:function(cb,_4){
return this._deferred.then(cb,_4);
},cancel:function(){
if(this._promiseChain.cancel){
return this._promiseChain.cancel.apply(this._promiseChain,arguments);
}
this._errback.apply(this,arguments);
},_errback:function(){
this._errored=true;
var _5=this._deferred;
_5.errback.apply(_5.errback,arguments);
},_callback:function(_6){
if(!this._errored){
if(_1.isPromiseLike(_6)){
this._promiseChain=_6;
this._hitch();
}else{
this._deferred.callback(_6);
}
}
},_hitch:function(){
this._promiseChain.then(dojo.hitch(this,"_callback"),dojo.hitch(this,"_errback"));
}});
}(dojo,lconn.core.util.promises,lconn.core.util.LCDeferred));
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.container._Handle"]){
dojo._hasResource["com.ibm.lconn.gadget.container._Handle"]=true;
dojo.provide("com.ibm.lconn.gadget.container._Handle");












(function(_1,_2,_3,_4,_5,_6){
function _7(_8){
if(_8){
if(_1.isString(_8)){
return _8;
}else{
return _1.attr(_8,"id");
}
}
return null;
};
var _9=_1.declare("",_2,{_accessor:null,_widgetSpec:null,_promise:null,_state:_2.UNLOADED,_originalPlacement:null,constructor:function(_a,_b,_c){
this._accessor=_a;
this._widgetSpec=_b;
this._originalPlacement=this._widgetSpec.placement;
if(_c){
this._state=_2.LOADING;
this._promise=_c;
_c.then(_1.hitch(this,"_loaded"),_1.hitch(this,this._failLoad));
}
},load:function(){
if(this._state===_2.UNLOADED){
this._state=_2.LOADING;
this._widgetSpec.placement=this._originalPlacement;
this._promise=this._withRuntime(_1.hitch(this,"_loading"),_1.hitch(this,"_failLoad"));
}
},_loading:function(_d){
alert("UNIMPLEMENTED: _loading()");
},_loaded:function(_e){
alert("UNIMPLEMENTED: _loaded()");
},_failLoad:function(){
this._state=_2.ERROR;
_3.error("_WidgetHandleBase - "+this._widgetSpec.componentType+" failed to load (%o): ",this._widgetSpec.definitionUrl);
this._widgetSpec.instanceData.errback.apply(null,arguments);
},unload:function(){
var _f=this._state;
if(_f===_2.LOADING||_f===_2.LOADED){
this._promise.then(_1.hitch(this,"_unload"),_1.hitch(this,"_failUnload"));
}
},_unload:function(_10){
alert("UNIMPLEMENTED: _unload()");
},_failUnload:function(){
this._state=_2.ERROR;
_3.error("_WidgetHandleBase - "+this._widgetSpec.componentType+" failed to load (%o): ",this._widgetSpec.definitionUrl);
},getState:function(){
return this._state;
},open:function(){
_3.log("open() is deprecated, use load() method instead.");
this.load();
},close:function(){
_3.log("close() is deprecated, use unload() method instead.");
this.unload();
}});
var _11=_1.declare("",[_9],{_widgetId:null,_loading:function(_12){
return _12.loadWidgets([_4.cloneSpec(this._widgetSpec)]).then(_1.hitch(this,"_loaded",_12),_1.hitch(this,"_failLoad"));
},_loaded:function(_13){
_3.debug("_WidgetHandleImpl - %s loaded successfully: %o",this._widgetSpec.componentType,this._widgetSpec.definitionUrl);
var _14=_7(this._widgetSpec.placement);
this._widgetId=_13.getWidgetIdByDomId(_14);
if(this._widgetId==null){
this._widgetId=this._originalPlacement;
}
this._state=_2.LOADED;
return _13;
},_unload:function(_15){
var wid=this._widgetId;
if(this._widgetId){
if(this._widgetSpec.componentType=="gadget"){
var w=_15.getWidgetIdByDomId(wid);
wid=(w!=null?w:wid);
}
_15.unLoadWidgets([wid],false);
this._widgetId=null;
this._promise=null;
this._state=_2.UNLOADED;
}
},getWidgetInfo:function(){
var _16=this._state,_17=this;
if(_16===_2.LOADING||_16===_2.LOADED){
return this._promise.then(function(_18){
return _18.getWidgetById(_17._widgetId);
});
}else{
var _19="Unable to call getWidgetInfo() when widget handle is not in loaded state.  State of handle is:  "+this._state;
_3.debug(_19);
var _1a=new _6();
_1a.reject(_19);
return (_1a);
}
},_withRuntime:function(_1b,_1c){
return new _5(this._accessor.getIRuntime().then(_1b,_1c));
}});
var _1d=_1.declare("",[_9],{_gadgetSite:null,_withRuntime:function(_1e,_1f){
return new _5(this._accessor.getCommonContainer().then(_1e,_1f));
},_execCallback:function(){
try{
var _20=this._widgetSpec.instanceData||{},_21=_20.callback;
if(_21){
if(_1.isString(_21)){
_21=_1.global[_21];
if(_21){
_21();
}
}else{
_21();
}
}
}
catch(e){
}
}});
var _22=_1.declare("",[_1d],{_placement:null,_loading:function(cc){
var _23=this._widgetSpec,_24=_23.instanceData||{},_25=_24.renderParams||{},_26=_24.viewParams||{},_27=new _6();
this._placement=_23.placement;
var _28=this._gadgetSite||(this._gadgetSite=cc.newGadgetSite(_1.byId(_23.placement)));
var _29=_4.isInlineGadget(_23),_2a=(_29?cc.inline:cc);
if(!_25[osapi.container.RenderParam.VIEW]){
_25[osapi.container.RenderParam.VIEW]="home";
}
_2a.navigateGadget(_28,_23.definitionUrl,_26,_25,_1.hitch(this,"_loaded",cc,_27));
return _27;
},_loaded:function(cc,_2b,_2c){
if(_2c.error){
_2b.errback(_2c.error);
this._failLoad(_2c.error);
}else{
this._state=_2.LOADED;
_2b.callback(cc);
this._execCallback(_2c);
}
},_unload:function(cc){
cc.closeGadget(this._gadgetSite);
if(this._placement!=null){
this._widgetSpec.placement=this._placement;
}
this._gadgetSite=null;
this._state=_2.UNLOADED;
return null;
}});
var _2d=_1.declare("",[_1d],{_loading:function(cc){
var _2e=this._widgetSpec,_2f=_2e.instanceData||{},_30={},_31=_2f.eeDataModel||{},_32=new _6();
var _33=osapi.container.ee.RenderParam;
if(_2e.definitionUrl){
_30[_33.GADGET_RENDER_PARAMS]=_2f.renderParams||{};
_30[_33.GADGET_VIEW_PARAMS]=_2f.viewParams||{};
_31.gadget=_2e.definitionUrl;
}else{
_30[_33.URL_RENDER_PARAMS]=_2f.renderParams||{};
}
cc.ee.navigate(_1.byId(_2e.placement),_31,_30,_1.hitch(this,"_loaded",cc,_32));
return _32;
},_loaded:function(cc,_34,_35,_36){
if(_36&&_36.error){
_34.errback(_36.error);
this._failLoad(_36.error);
}else{
this._state=_2.LOADED;
this._gadgetSite=_35;
_34.callback(cc);
this._execCallback(_36);
}
},_unload:function(cc){
cc.ee.close(this._gadgetSite);
this._gadgetSite=null;
this._state=_2.UNLOADED;
return null;
}});
_2.__factory__=function(_37,_38,_39){
if(_4.isInlineEE(_38)){
throw "Inline EE gadgets are not permitted. Attempted to load: ";
}
if(!_39&&_4.isGadget(_38)){
if(_4.isEEGadget(_38)){
return new _2d(_37,_38);
}else{
return new _22(_37,_38);
}
}else{
return new _11(_37,_38,_39);
}
};
})(dojo,com.ibm.lconn.gadget.container.Handle,com.ibm.lconn.gadget.util.trace,com.ibm.lconn.gadget.util.specHelper,lconn.core.util.LCChainedDeferred,lconn.core.util.LCDeferred);
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.container._Container"]){
dojo._hasResource["com.ibm.lconn.gadget.container._Container"]=true;
dojo.provide("com.ibm.lconn.gadget.container._Container");




















(function init_com_ibm_lconn_gadget_container_Container(_1,_2,_3){
var _4=null,_5=_2.normalizeWidgetSpec,_6=_2.cloneSpec;
var _7=dojo.declare("",com.ibm.lconn.gadget.container.Container,{_accessor:null,constructor:function(_8){
this._accessor=_8;
},loadWidgets:function(_9){
_1.debug("Container's loadWidgets called");
var _a=this._accessor;
if(_9&&dojo.isArray(_9)){
var _b=_9.length,_c=null;
var _d=[];
var _e=[];
var _f=[];
while(_b--){
_d[_b]=_6(_5(_9[_b]));
_1.debug("_CONTAINER 1 widgetSpecs[idx].placement:  ",_9[_b].placement);
}
function _10(_11,_12){
dojo.forEach(_12,function(_13,i){
var id=null;
if(_13.widgetObject.domId){
id=_13.widgetObject.domId;
}else{
id=_13.widgetObject.getDomId();
}
var _14=_f[id];
if(_13.isError()){
var err=_13.getError();
_1.error("Error (",_13.getError().message,") while loading widget: ",_13);
_14.errback(_13.getError());
}else{
_14.callback(_11);
}
});
};
function _15(_16){
_1.error("Error while loading widgets: ",_9);
dojo.forEach(_16,function(_17,i){
var _18=_f[i];
_18.errback(_16);
});
};
function _19(_1a){
if(_1a&&_1a.id){
return _1a.id;
}
if(dojo.isString(_1a)){
return _1a;
}
return null;
};
dojo.forEach(_9,function(_1b){
var _1c=new lconn.core.util.LCDeferred();
_f[_19(_1b.placement)]=_1c;
_e.push(_3.__factory__(_a,_1b,_1c));
});
_a.getIRuntime().then(function(_1d){
var _1e=dojo.hitch(null,_10,_1d);
_1d.loadWidgets(_d).then(_1e,_1e);
},_15);
return _e;
}else{
throw ("parameter must be an array: "+_9);
}
},loadWidget:function(_1f){
return this.loadWidgets([_1f])[0];
},preloadWidgets:function(_20){
if(_20&&dojo.isArray(_20)&&_20.length>0){
var idx=_20.length,_21=null;
while(idx--){
_5(_20[idx]);
}
return new lconn.core.util.LCChainedDeferred(this._accessor.getIRuntime().then(function(_22){
return _22.preloadWidgets(_20);
},function(_23){
_1.error("Error (",_23,") while preloading widgets: ",_20);
}));
}else{
var _21=new lconn.core.util.LCDeferred();
_21.errback("WidgetSpecs is empty, undefined or a non-array type.");
return _21;
}
},unloadWidgets:function(_24){
_1.debug("Container's unloadWidgets called");
this._accessor.getIRuntime().then(function(_25){
return _25.unLoadWidgets(_24,false);
},function(_26){
_1.error("Error (",_26,") while unloading widgets: ",_24);
});
},getGadgetInfo:function(url){
var _27=new lconn.core.util.LCDeferred();
return new lconn.core.util.LCChainedDeferred(this._accessor.getCommonContainer().then(dojo.hitch(this,function(cc){
cc.preloadGadget(url,dojo.hitch(this,this._cb,_27,url));
return (_27);
}),dojo.hitch(this,function(_28){
_1.error("Error (",_28,") while getting gadget metadata:  ",url);
_27.resolve(null);
})));
},_cb:function(_29,url,_2a){
if(_29!=null){
_29.resolve(_2a[url]);
}else{
_1.error("Error while getting gadget metadata");
_29.resolve(null);
}
}});
dojo.mixin(com.ibm.lconn.gadget.container.Container,{__instance__:function(_2b){
if(!_4){
_4=new _7(_2b);
}
return _4;
}});
})(com.ibm.lconn.gadget.util.trace,com.ibm.lconn.gadget.util.specHelper,com.ibm.lconn.gadget.container.Handle);
}


;if(!dojo._hasResource["com.ibm.lconn.gadget.container.iContainer2"]){
dojo._hasResource["com.ibm.lconn.gadget.container.iContainer2"]=true;
dojo.provide("com.ibm.lconn.gadget.container.iContainer2");


















(function init_com_ibm_lconn_gadget_container_iContainer2(){
var _1=com.ibm.lconn.gadget.container.iContainer2,_2=com.ibm.lconn.gadget.container.Container,_3=com.ibm.lconn.gadget.container.Accessor,_4=null,_5=null,_6=com.ibm.lconn.gadget.util.trace,_7=null,_8=new (dojo.declare("",null,{constructor:function(){
}}))();
_7=function(_9,_a){
var _b,_c,_d=_1;
for(var i=0,_e=_9.length;i<_e;i++){
_c=_9[i];
for(_b in _c){
if(!_8[_b]&&dojo.isFunction(_c[_b])){
_d[_b]=_a(_b);
}
}
}
};
_7([_3.prototype,_2.prototype],function(_f){
return function(){
var _10=arguments,_11=_1.init();
return _11[_f].apply(null,_10);
};
});
dojo.mixin(_1,{init:function(_12){
_6.entering("com.ibm.lconn.gadget.container.iContainer","init",_12);
_4=_3.__instance__(_12);
_5=_2.__instance__(_4);
_6.debug("Accessor: "+_4);
_6.debug("Container: "+_5);
_1.init=function(){
return _1;
};
_7([_3.prototype],function(_13){
return dojo.hitch(_4,_13);
});
_7([_2.prototype],function(_14){
return dojo.hitch(_5,_14);
});
_6.exiting("com.ibm.lconn.gadget.container.iContainer","init",_12);
return _1;
},views:com.ibm.lconn.gadget.container.Views.__instance__(),ICactions:com.ibm.lconn.gadget.container.ICActions.__instance__()});
if(dojo.global.__iContainer_skip_init__){
_6.debug("Defering iContainer init.");
}else{
dojo.ready(function(){
var _15=dojo.global.__iContainer_defer_init__;
if(_15&&_15.then){
var _16=this;
_15.then(dojo.hitch(_16,function(){
_1.init();
}));
}else{
_1.init();
}
});
}
})();
}


;define("dijit/layout/_LayoutWidget",["dojo/_base/lang","../_Widget","../_Container","../_Contained","../Viewport","dojo/_base/declare","dojo/dom-class","dojo/dom-geometry","dojo/dom-style"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
return _6("dijit.layout._LayoutWidget",[_2,_3,_4],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,_setTitleAttr:null,buildRendering:function(){
this.inherited(arguments);
_7.add(this.domNode,"dijitContainer");
},startup:function(){
if(this._started){
return;
}
this.inherited(arguments);
var _a=this.getParent&&this.getParent();
if(!(_a&&_a.isLayoutContainer)){
this.resize();
this.own(_5.on("resize",_1.hitch(this,"resize")));
}
},resize:function(_b,_c){
var _d=this.domNode;
if(_b){
_8.setMarginBox(_d,_b);
}
var mb=_c||{};
_1.mixin(mb,_b||{});
if(!("h" in mb)||!("w" in mb)){
mb=_1.mixin(_8.getMarginBox(_d),mb);
}
var cs=_9.getComputedStyle(_d);
var me=_8.getMarginExtents(_d,cs);
var be=_8.getBorderExtents(_d,cs);
var bb=(this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)});
var pe=_8.getPadExtents(_d,cs);
this._contentBox={l:_9.toPixelValue(_d,cs.paddingLeft),t:_9.toPixelValue(_d,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};
this.layout();
},layout:function(){
},_setupChild:function(_e){
var _f=this.baseClass+"-child "+(_e.baseClass?this.baseClass+"-"+_e.baseClass:"");
_7.add(_e.domNode,_f);
},addChild:function(_10,_11){
this.inherited(arguments);
if(this._started){
this._setupChild(_10);
}
},removeChild:function(_12){
var cls=this.baseClass+"-child"+(_12.baseClass?" "+this.baseClass+"-"+_12.baseClass:"");
_7.remove(_12.domNode,cls);
this.inherited(arguments);
}});
});


;define("dijit/dijit",["./main","./_base","dojo/parser","./_Widget","./_TemplatedMixin","./_Container","./layout/_LayoutWidget","./form/_FormWidget","./form/_FormValueWidget"],function(_1){
return _1;
});


;if(!dojo._hasResource["com.ibm.lconn.socialmail.gadget.NavigationHandler"]){
dojo._hasResource["com.ibm.lconn.socialmail.gadget.NavigationHandler"]=true;
dojo.provide("com.ibm.lconn.socialmail.gadget.NavigationHandler");




















var NavigationHandler;
function extend(_1,_2){
for(var k in _2){
if(_2.hasOwnProperty(k)){
_1[k]=_2[k];
}
}
return _1;
};
dojo.declare("com.ibm.lconn.socialmail.gadget.NavigationHandler",null,{constructor:function(){
if(!NavigationHandler){
function _3(){
};
_3.prototype=new com.ibm.lconn.socialmail.gadget._NavigationHandler();
var _4={idMailListItem:"lotusBannerMail",idCalendarListItem:"lotusBannerCalendar",idMailLoadingSpinner:"os-site-mail-hover-loading",idCalendarLoadingSpinner:"os-site-calendar-hover-loading",classBadge:"os-site-mail-notify",classMailDropdown:"os-site-mail-hover",classCalendarDropdown:"os-site-calendar-hover",classDisplayNone:"dijitDisplayNone",topics:[],classHidden:"dijitHidden",classLightboxContainer:"cm-preview-site-container",classLightboxMessage:"os-site os-site-mail-hover-preview-messages",classLightboxMessageEE:"os-site os-site-mail-hover-preview-messages-ee",classLightboxDialog:"mailMessageDialog",classCloseIconLightboxRtl:"dijitDialogRtl",generateSuffixToSiteIdsOnHeader:function(){
this.dynamicSiteIdSuffix=dojox.uuid.generateRandomUuid();
this.gadgetIDs={badge:"os-site-mail-notify"+this.dynamicSiteIdSuffix,inbox:"os-site-mail-hover"+this.dynamicSiteIdSuffix,calendar:"os-site-calendar-hover"+this.dynamicSiteIdSuffix,message:"os-site-mail-hover-preview-messages"+this.dynamicSiteIdSuffix,messageEE:"os-site-mail-hover-preview-messages-ee"+this.dynamicSiteIdSuffix};
},loadContainerDropdown:function(_5,_6){
if(_6.type==="mouseover"){
lconn.core.header.menuMouseover(_5);
}else{
if(_6.type==="click"){
lconn.core.header.menuClick(_5);
}else{
if(_6.type==="focus"){
lconn.core.header.menuFocus(_5);
}
}
}
},getDropdownContainerId:function(_7){
return dojo.attr(_7,"_lconn_menuid");
},getServiceUrl:function(){
var _8=null;
var _9=lconn.core.config.services.connectionsmail;
if(_9){
_8=lconn.core.url.getServiceUrl(_9);
}
return _8;
},getUrlParameter:function(_a,_b){
return lconn.core.url.parse(_a).queryParameters[_b];
},initContainer:function(){
var _c=dojo.getObject("com.ibm.lconn.gadget.container.iContainer2");
if(_c){
_c.init();
}
return _c;
},addLoginLogoutHandlers:function(){
lconn.core.auth.addLoginHandler(cre$.util.hitch(this,this.clearCache));
lconn.core.auth.addLogoutHandler(cre$.util.hitch(this,this.clearCache));
},addAttribute:function(_d,_e,_f){
return dojo.attr(_d,_e,_f);
},removeAttribute:function(_10,_11){
return dojo.removeAttr(_10,_11);
},hasClass:function(_12,_13){
return dojo.hasClass(_12,_13);
},addClass:function(_14,_15){
dojo.addClass(_14,_15);
},getUserPrefs:function(){
return {calendar:lconn.core.globalization.api.getCalendar(),textDirection:lconn.core.globalization.api.getTextDirection(),bidiEnabled:lconn.core.globalization.api.isBidiEnabled()};
},generateMessageSite:function(){
this.messageSite=new dijit.layout.ContentPane({content:"<div class=\""+this.classLightboxContainer+"\">"+"<div id=\""+this.gadgetIDs.message+"\" class=\""+this.classLightboxMessage+"\"></div>"+"<div id=\""+this.gadgetIDs.messageEE+"\" class=\""+this.classLightboxMessageEE+"\"></div>"+"</div>"});
},generateMessageDialog:function(){


this.messageDialog=new dijit.Dialog({content:this.messageSite,draggable:false});
this.addClass(this.messageDialog.domNode,this.classLightboxDialog);
this.messageDialog.closeButtonNode&&this.messageDialog.closeButtonNode.setAttribute("role","button");
var _16=this;
var _17=this.messageDialog.hide;
this.messageDialog.hide=function(){
if(!this.closeConfirmed){
_16.handleCloseDocument();
return;
}
_17.apply(this,arguments);
};
var _18=520,_19=740;
this.messageDialog._singleChild=true;
this.messageDialog._size=function(){
if(this._singleChild){
if(this._singleChildOriginalStyle){
this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle;
}
delete this._singleChildOriginalStyle;
}else{
this.containerNode.style.width="auto";
this.containerNode.style.height="auto";
}
var bb=dojo.position(this.containerNode);


var _1a=dijit.getViewport();
if(bb.w>=_1a.w||bb.h>=_1a.h){
var w=Math.min(bb.w,Math.floor(_1a.w*0.75)),h=Math.min(bb.h,Math.floor(_1a.h*0.75));
w=w<_19?_19:w;
h=h<_18?_18:h;
if(this._singleChild&&this._singleChild.resize){
this._singleChildOriginalStyle=this._singleChild.domNode.style.cssText;
this._singleChild.resize({w:w,h:h});
}else{
this.containerNode.style.width=w+"px";
this.containerNode.style.height=h+"px";
this.containerNode.style.overflow="auto";
this.containerNode.style.position="relative";
}
}else{
if(this._singleChild&&this._singleChild.resize){
this._singleChild.resize();
}
}
};
this.messageDialog._position=function(){
if(!dojo.hasClass(dojo.body(),"dojoMove")){
var _1b=this.domNode;


var _1c=dijit.getViewport();
p=this._relativePosition,bb=p?null:dojo.position(_1b),l=Math.floor(_1c.l+(p?p.x:(_1c.w-bb.w)/2)),t=Math.floor(_1c.t+(p?p.y:(_1c.h-bb.h)/2));
l=l>0?l:5;
t=t>0?t:5;
if(t>_1c.t){
_1b.style.top=t+"px";
}
if(l>_1c.l){
_1b.style.left=l+"px";
}
if(!!dojo.isIE&&!dojo._isBodyLtr()&&!!dijit._underlay&&!!dijit._underlay.domNode){
_1b.style.left=Math.floor((_1c.w-bb.w)/2)+"px";
dijit._underlay.domNode.style.left="0px";
}
}
};
},calculateBorderWidth:function(_1d){
return (dojo.marginBox(_1d).h-dojo.contentBox(_1d).h)/2;
},getBadgeSpan:function(){
var _1e=dojo.query("."+this.classBadge);
if(_1e.length>0){
return _1e[0];
}
return;
},navigateGadgetHandlerCustomProperties:function(){
this.addClass(document.getElementsByTagName("body")[0],"lotusui30dojo");
},clearCache:function(){
var _1f=new dojo.Deferred();
var _20=cre$.util.hitch(_1f,"callback");
var _21=5000;
this.commonContainer.then(cre$.util.hitch(this,function(cc){
var _22=[];
var _23="com.ibm.socpim.rpc.cleanup";
var _24=["badge","inbox","calendar","message"];
cre$.util.forEach(_24,cre$.util.hitch(this,function(_25,_26){
if(_26==0&&this.notifySite||_26==1&&this.inboxSite||_26==2&&this.calendarSite||_26==3&&this.messageSite){
var _27=new lconn.core.util.LCDeferred();
_22.push(_27);
var _28=this.getSiteFromArea(cc,_25);
this.debugRpc&&console.log("calling "+_23+": "+_25);
_28.rpcCall(_23,cre$.util.hitch(_27,"resolve"),_28);
}
}));
new lconn.core.util.LCDeferredList(_22).then(_20,_20);
}),_20);
setTimeout(_20,_21);
return _1f;
},startupSettings:function(){
var _29=com.ibm.lconn.gadget.container.Topics.getSiteTopic(this.gadgetIDs.message,com.ibm.lconn.gadget.container.Topics.GadgetWindow.SITE_TOPIC_SET_TITLE);
this.topics.push(dojo.subscribe(_29,cre$.util.hitch(this,function(){
this.updateDialogTitle(arguments[0]?arguments[0]:arguments);
})));
var _2a=com.ibm.lconn.gadget.container.Topics.getSiteTopic(this.gadgetIDs.inbox,com.ibm.lconn.gadget.container.Topics.GadgetWindow.AFTER_ADJUST_HEIGHT);
this.topics.push(dojo.subscribe(_2a,cre$.util.hitch(this,function(){
this.setDropDownHeight(this.getPane("inbox"),arguments,"inbox");
})));
var _2b=com.ibm.lconn.gadget.container.Topics.getSiteTopic(this.gadgetIDs.calendar,com.ibm.lconn.gadget.container.Topics.GadgetWindow.AFTER_ADJUST_HEIGHT);
this.topics.push(dojo.subscribe(_2b,cre$.util.hitch(this,function(){
this.setDropDownHeight(this.getPane("calendar"),arguments,"calendar");
})));
},onMessageOpen:function(id,_2c){
this.closeCurrentSite();
this.messageDialog.closeConfirmed=false;
this.messageDialog.domNode.style.visibility="";
this.messageDialog.show();
},onMessageClose:function(id,_2d){
this.messageDialog.closeConfirmed=true;
this.messageDialog.hide();
},onMessageCompose:function(id,_2e){
this.inboxSite.onClose();
this.messageDialog.closeConfirmed=false;
this.messageDialog.domNode.style.visibility="";
this.messageDialog.show();
},generateGadgetSite:function(_2f){
return new dijit.layout.ContentPane(_2f);
},showSiteContent:function(_30){
var _31=document.getElementById(_30);
if(_31){
var _32=_31.getElementsByTagName("iframe")[0];
if(_32){
_32.style.visibility="";
}
}
},hideInboxWhileLoading:function(){
var _33=this.inboxSite&&this.inboxSite.containerNode.getElementsByTagName("iframe")[0];
if(_33){
_33.style.visibility="hidden";
}
},hideCalendarWhileLoading:function(){
var _34=this.calendarSite&&this.calendarSite.containerNode.getElementsByTagName("iframe")[0];
if(_34){
_34.style.visibility="hidden";
_34.allowTransparency="true";
}
},hideLightboxWhileLoading:function(){
var _35=this.messageSite&&this.messageSite.containerNode.getElementsByTagName("iframe")[0];
if(_35){
_35.style.visibility="hidden";
dojo.place("<table id=\""+(this.messageSite.progressId="messageSiteProgress")+"\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tr><td>&nbsp;</td></tr></table>",_35,"before");
}
},setBadgeAccessibilityAttributes:function(){
var _36=this.notifySite&&this.notifySite.el_.firstChild;
if(_36){
_36.setAttribute("title","Unread messages");
_36.setAttribute("tabindex","-1");
_36.setAttribute("role","presentation");
}
},showDialog:function(){
this.removeAttribute(this.messageDialog.domNode,"aria-labelledby");
this.addAttribute(this.messageSite.domNode,"role","dialog");
if(this.isIE()){
this.messageDialog.containerNode.style.overflowY="auto";
}
this.messageDialog.domNode.style.visibility="";
this.messageDialog.show();
if(dijit._underlay&&dijit._underlay.bgIframe&&dijit._underlay.bgIframe.iframe){
var _37=dijit._underlay.bgIframe.iframe;
_37.setAttribute("role","presentation");
_37.setAttribute("title","Background");
_37.contentWindow.document.write("<html><head><title>Background</title></head><body></body></html>");
}
if(this.messageDialog.titleNode){
this.addClass(this.messageDialog.titleNode,this.classHidden);
}
},updateDialogTitle:function(_38){
if(!!this.messageDialog&&!!this.messageSite&&!!_38){
this.addAttribute(this.messageDialog.domNode,"title",_38);
this.addAttribute(this.messageDialog.domNode,"aria-label",_38);
if(document.documentElement.dir==="rtl"){
this.addClass(this.messageDialog.domNode,this.classCloseIconLightboxRtl);
}
this.addAttribute(this.messageSite.domNode,"title",_38);
this.addAttribute(this.messageSite.domNode,"aria-label",_38);
var _39=this.messageDialog.containerNode.getElementsByTagName("iframe")[0];
if(_39){
this.addAttribute(_39,"title",_38);
}
}
},updateWarning:function(_3a){
var _3b=_3a.domNode.getElementsByTagName("iframe")[0];
var _3c=_3b.contentWindow.document.getElementById("warningMsgDropdown");
if(_3c){
this.removeAttribute(_3c,"role");
var _3d=_3c.innerHTML;
dojo.empty(_3c);
dojo.html.set(_3c,_3d);
this.addAttribute(_3c,"role","alert");
}
},extraRpcCalls:function(_3e){
if(_3e.type=="com.ibm.socpim.MailDropDown"){
if(_3e.dataObject=="hidden"&&this.hoverLoaded.inbox){
this.inboxSite.onClose(true);
}
}else{
if(_3e.type=="com.ibm.socpim.CalendarDropDown"){
if(_3e.dataObject=="hidden"&&this.hoverLoaded.calendar){
this.calendarSite.onClose(true);
}
}
}
if(_3e.type=="com.ibm.socpim.calendarview.height"){
this.setDropDownHeight(this.getPane("calendar"),_3e.dataObject,"calendar");
}else{
if(_3e.type=="com.ibm.socpim.messagelist.height"){
this.setDropDownHeight(this.getPane("inbox"),_3e.dataObject,"inbox");
}else{
if(_3e.type=="com.ibm.socpim.a11y.dialog"){
if(!!_3e.dataObject&&_3e.dataObject["name"]=="pageTitle"){
this.updateDialogTitle(_3e.dataObject["value"]);
}
}
}
}
},verifyVisibility:function(_3f){
var _40=this.getPane(_3f);
var _41=document.getElementById(_40.progressId);
if(_41){
this.addClass(_41,"dijitDisplayNone");
}
var _42=_40&&_40.containerNode&&_40.containerNode.getElementsByTagName("iframe")[0];
if(_42){
_42.style.visibility="";
}
},closeCurrentSite:function(){
if(this.currentSite=="mail"){
this.inboxSite.onClose();
}else{
this.calendarSite.onClose();
}
},isIE:function(){
return this.hasClass(document.getElementsByTagName("body")[0].parentNode,"dj_ie");
},getUserId:function(){
return (lconn.core.auth.getUser()||{}).id;
}};
extend(_3.prototype,_4);
NavigationHandler=new _3();
if(dojo.config.isDebug){
NavigationHandler.isDebug=true;
}
NavigationHandler.initialization();
var _43=dijit.popup.open;
dijit.popup.open=function(_44){
if(_44&&_44.popup&&(_44.popup.id==="lconnheadermenu-mail"||_44.popup.id==="lconnheadermenu-calendar")){
_44.maxHeight=Infinity;
}
_43.apply(this,arguments);
};
}
},navigateInbox:function(_45,_46){
var _47=(_46.type==="focus"&&!lconn.core.widget.MenuLauncher.prototype.activateOnFocus);
if(!_47){
NavigationHandler.navigateInbox(_45,_46);
}
},navigateCalendar:function(_48,_49){
var _4a=(_49.type==="focus"&&!lconn.core.widget.MenuLauncher.prototype.activateOnFocus);
if(!_4a){
NavigationHandler.navigateCalendar(_48,_49);
}
},destroy:function(_4b,_4c){
for(var _4d=null;_4d=(NavigationHandler.topics||[]).pop();){
_4d.remove();
}
}});
}


;define("dojox/validate/regexp",["dojo/_base/lang","dojo/regexp","dojox/main"],function(_1,_2,_3){
var _4=_1.getObject("validate.regexp",true,_3);
_4=_3.validate.regexp={ipAddress:function(_5){
_5=(typeof _5=="object")?_5:{};
if(typeof _5.allowDottedDecimal!="boolean"){
_5.allowDottedDecimal=true;
}
if(typeof _5.allowDottedHex!="boolean"){
_5.allowDottedHex=true;
}
if(typeof _5.allowDottedOctal!="boolean"){
_5.allowDottedOctal=true;
}
if(typeof _5.allowDecimal!="boolean"){
_5.allowDecimal=true;
}
if(typeof _5.allowHex!="boolean"){
_5.allowHex=true;
}
if(typeof _5.allowIPv6!="boolean"){
_5.allowIPv6=true;
}
if(typeof _5.allowHybrid!="boolean"){
_5.allowHybrid=true;
}
var _6="((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])";
var _7="(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]";
var _8="(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]";
var _9="(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|"+"4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])";
var _a="0[xX]0*[\\da-fA-F]{1,8}";
var _b="([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}";
var _c="([\\da-fA-F]{1,4}\\:){6}"+"((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])";
var a=[];
if(_5.allowDottedDecimal){
a.push(_6);
}
if(_5.allowDottedHex){
a.push(_7);
}
if(_5.allowDottedOctal){
a.push(_8);
}
if(_5.allowDecimal){
a.push(_9);
}
if(_5.allowHex){
a.push(_a);
}
if(_5.allowIPv6){
a.push(_b);
}
if(_5.allowHybrid){
a.push(_c);
}
var _d="";
if(a.length>0){
_d="("+a.join("|")+")";
}
return _d;
},host:function(_e){
_e=(typeof _e=="object")?_e:{};
if(typeof _e.allowIP!="boolean"){
_e.allowIP=true;
}
if(typeof _e.allowLocal!="boolean"){
_e.allowLocal=false;
}
if(typeof _e.allowPort!="boolean"){
_e.allowPort=true;
}
if(typeof _e.allowNamed!="boolean"){
_e.allowNamed=false;
}
var _f="(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)";
var _10="(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)";
var _11=_e.allowPort?"(\\:\\d+)?":"";
var _12="((?:"+_f+"\\.)+"+_10+"\\.?)";
if(_e.allowIP){
_12+="|"+_4.ipAddress(_e);
}
if(_e.allowLocal){
_12+="|localhost";
}
if(_e.allowNamed){
_12+="|^[^-][a-zA-Z0-9_-]*";
}
return "("+_12+")"+_11;
},url:function(_13){
_13=(typeof _13=="object")?_13:{};
if(!("scheme" in _13)){
_13.scheme=[true,false];
}
var _14=_2.buildGroupRE(_13.scheme,function(q){
if(q){
return "(https?|ftps?)\\://";
}
return "";
});
var _15="(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?";
return _14+_4.host(_13)+_15;
},emailAddress:function(_16){
_16=(typeof _16=="object")?_16:{};
if(typeof _16.allowCruft!="boolean"){
_16.allowCruft=false;
}
_16.allowPort=false;
var _17="([!#-'*+\\-\\/-9=?A-Z^-~]+[.])*[!#-'*+\\-\\/-9=?A-Z^-~]+";
var _18=_17+"@"+_4.host(_16);
if(_16.allowCruft){
_18="<?(mailto\\:)?"+_18+">?";
}
return _18;
},emailAddressList:function(_19){
_19=(typeof _19=="object")?_19:{};
if(typeof _19.listSeparator!="string"){
_19.listSeparator="\\s;,";
}
var _1a=_4.emailAddress(_19);
var _1b="("+_1a+"\\s*["+_19.listSeparator+"]\\s*)*"+_1a+"\\s*["+_19.listSeparator+"]?\\s*";
return _1b;
},numberFormat:function(_1c){
_1c=(typeof _1c=="object")?_1c:{};
if(typeof _1c.format=="undefined"){
_1c.format="###-###-####";
}
var _1d=function(_1e){
return _2.escapeString(_1e,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d");
};
return _2.buildGroupRE(_1c.format,_1d);
},ca:{postalCode:function(){
return "([A-Z][0-9][A-Z] [0-9][A-Z][0-9])";
},province:function(){
return "(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)";
}},us:{state:function(_1f){
_1f=(typeof _1f=="object")?_1f:{};
if(typeof _1f.allowTerritories!="boolean"){
_1f.allowTerritories=true;
}
if(typeof _1f.allowMilitary!="boolean"){
_1f.allowMilitary=true;
}
var _20="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|"+"NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";
var _21="AS|FM|GU|MH|MP|PW|PR|VI";
var _22="AA|AE|AP";
if(_1f.allowTerritories){
_20+="|"+_21;
}
if(_1f.allowMilitary){
_20+="|"+_22;
}
return "("+_20+")";
}}};
return _4;
});


;define("dojox/validate/_base",["dojo/_base/lang","dojo/regexp","dojo/number","./regexp"],function(_1,_2,_3,_4){
var _5=_1.getObject("dojox.validate",true);
_5.isText=function(_6,_7){
_7=(typeof _7=="object")?_7:{};
if(/^\s*$/.test(_6)){
return false;
}
if(typeof _7.length=="number"&&_7.length!=_6.length){
return false;
}
if(typeof _7.minlength=="number"&&_7.minlength>_6.length){
return false;
}
if(typeof _7.maxlength=="number"&&_7.maxlength<_6.length){
return false;
}
return true;
};
_5._isInRangeCache={};
_5.isInRange=function(_8,_9){
_8=_3.parse(_8,_9);
if(isNaN(_8)){
return false;
}
_9=(typeof _9=="object")?_9:{};
var _a=(typeof _9.max=="number")?_9.max:Infinity,_b=(typeof _9.min=="number")?_9.min:-Infinity,_c=(typeof _9.decimal=="string")?_9.decimal:".",_d=_5._isInRangeCache,_e=_8+"max"+_a+"min"+_b+"dec"+_c;
if(typeof _d[_e]!="undefined"){
return _d[_e];
}
_d[_e]=!(_8<_b||_8>_a);
return _d[_e];
};
_5.isNumberFormat=function(_f,_10){
var re=new RegExp("^"+_4.numberFormat(_10)+"$","i");
return re.test(_f);
};
_5.isValidLuhn=function(_11){
var sum=0,_12,_13;
if(!_1.isString(_11)){
_11=String(_11);
}
_11=_11.replace(/[- ]/g,"");
_12=_11.length%2;
for(var i=0;i<_11.length;i++){
_13=parseInt(_11.charAt(i));
if(i%2==_12){
_13*=2;
}
if(_13>9){
_13-=9;
}
sum+=_13;
}
return !(sum%10);
};
return _5;
});


;define("dojox/validate/web",["./_base","./regexp"],function(_1,_2){
_1.isIpAddress=function(_3,_4){
var re=new RegExp("^"+_2.ipAddress(_4)+"$","i");
return re.test(_3);
};
_1.isUrl=function(_5,_6){
var re=new RegExp("^"+_2.url(_6)+"$","i");
return re.test(_5);
};
_1.isEmailAddress=function(_7,_8){
var re=new RegExp("^"+_2.emailAddress(_8)+"$","i");
return re.test(_7);
};
_1.isEmailAddressList=function(_9,_a){
var re=new RegExp("^"+_2.emailAddressList(_a)+"$","i");
return re.test(_9);
};
_1.getEmailAddressList=function(_b,_c){
if(!_c){
_c={};
}
if(!_c.listSeparator){
_c.listSeparator="\\s;,";
}
if(_1.isEmailAddressList(_b,_c)){
return _b.split(new RegExp("\\s*["+_c.listSeparator+"]\\s*"));
}
return [];
};
return _1;
});


;define("dojox/data/QueryReadStore",["dojo","dojox","dojo/data/util/sorter","dojo/string"],function(_1,_2){
return _1.declare("dojox.data.QueryReadStore",null,{url:"",requestMethod:"get",_className:"dojox.data.QueryReadStore",_items:[],_lastServerQuery:null,_numRows:-1,lastRequestHash:null,doClientPaging:false,doClientSorting:false,_itemsByIdentity:null,_identifier:null,_features:{"dojo.data.api.Read":true,"dojo.data.api.Identity":true},_labelAttr:"label",constructor:function(_3){
_1.mixin(this,_3);
},getValue:function(_4,_5,_6){
this._assertIsItem(_4);
if(!_1.isString(_5)){
throw new Error(this._className+".getValue(): Invalid attribute, string expected!");
}
if(!this.hasAttribute(_4,_5)){
if(_6){
return _6;
}
}
return _4.i[_5];
},getValues:function(_7,_8){
this._assertIsItem(_7);
var _9=[];
if(this.hasAttribute(_7,_8)){
_9.push(_7.i[_8]);
}
return _9;
},getAttributes:function(_a){
this._assertIsItem(_a);
var _b=[];
for(var i in _a.i){
_b.push(i);
}
return _b;
},hasAttribute:function(_c,_d){
return this.isItem(_c)&&typeof _c.i[_d]!="undefined";
},containsValue:function(_e,_f,_10){
var _11=this.getValues(_e,_f);
var len=_11.length;
for(var i=0;i<len;i++){
if(_11[i]==_10){
return true;
}
}
return false;
},isItem:function(_12){
if(_12){
return typeof _12.r!="undefined"&&_12.r==this;
}
return false;
},isItemLoaded:function(_13){
return this.isItem(_13);
},loadItem:function(_14){
if(this.isItemLoaded(_14.item)){
return;
}
},fetch:function(_15){
_15=_15||{};
if(!_15.store){
_15.store=this;
}
var _16=this;
var _17=function(_18,_19){
if(_19.onError){
var _1a=_19.scope||_1.global;
_19.onError.call(_1a,_18,_19);
}
};
var _1b=function(_1c,_1d,_1e){
var _1f=_1d.abort||null;
var _20=false;
var _21=_1d.start?_1d.start:0;
if(_16.doClientPaging==false){
_21=0;
}
var _22=_1d.count?(_21+_1d.count):_1c.length;
_1d.abort=function(){
_20=true;
if(_1f){
_1f.call(_1d);
}
};
var _23=_1d.scope||_1.global;
if(!_1d.store){
_1d.store=_16;
}
if(_1d.onBegin){
_1d.onBegin.call(_23,_1e,_1d);
}
if(_1d.sort&&_16.doClientSorting){
_1c.sort(_1.data.util.sorter.createSortFunction(_1d.sort,_16));
}
if(_1d.onItem){
for(var i=_21;(i<_1c.length)&&(i<_22);++i){
var _24=_1c[i];
if(!_20){
_1d.onItem.call(_23,_24,_1d);
}
}
}
if(_1d.onComplete&&!_20){
var _25=null;
if(!_1d.onItem){
_25=_1c.slice(_21,_22);
}
_1d.onComplete.call(_23,_25,_1d);
}
};
this._fetchItems(_15,_1b,_17);
return _15;
},getFeatures:function(){
return this._features;
},close:function(_26){
},getLabel:function(_27){
if(this._labelAttr&&this.isItem(_27)){
return this.getValue(_27,this._labelAttr);
}
return undefined;
},getLabelAttributes:function(_28){
if(this._labelAttr){
return [this._labelAttr];
}
return null;
},_xhrFetchHandler:function(_29,_2a,_2b,_2c){
_29=this._filterResponse(_29);
if(_29.label){
this._labelAttr=_29.label;
}
var _2d=_29.numRows||-1;
this._items=[];
_1.forEach(_29.items,function(e){
this._items.push({i:e,r:this});
},this);
var _2e=_29.identifier;
this._itemsByIdentity={};
if(_2e){
this._identifier=_2e;
var i;
for(i=0;i<this._items.length;++i){
var _2f=this._items[i].i;
var _30=_2f[_2e];
if(!this._itemsByIdentity[_30]){
this._itemsByIdentity[_30]=_2f;
}else{
throw new Error(this._className+":  The json data as specified by: ["+this.url+"] is malformed.  Items within the list have identifier: ["+_2e+"].  Value collided: ["+_30+"]");
}
}
}else{
this._identifier=Number;
for(i=0;i<this._items.length;++i){
this._items[i].n=i;
}
}
_2d=this._numRows=(_2d===-1)?this._items.length:_2d;
_2b(this._items,_2a,_2d);
this._numRows=_2d;
},_fetchItems:function(_31,_32,_33){
var _34=_31.serverQuery||_31.query||{};
if(!this.doClientPaging){
_34.start=_31.start||0;
if(_31.count){
_34.count=_31.count;
}
}
if(!this.doClientSorting&&_31.sort){
var _35=[];
_1.forEach(_31.sort,function(_36){
if(_36&&_36.attribute){
_35.push((_36.descending?"-":"")+_36.attribute);
}
});
_34.sort=_35.join(",");
}
if(this.doClientPaging&&this._lastServerQuery!==null&&_1.toJson(_34)==_1.toJson(this._lastServerQuery)){
this._numRows=(this._numRows===-1)?this._items.length:this._numRows;
_32(this._items,_31,this._numRows);
}else{
var _37=this.requestMethod.toLowerCase()=="post"?_1.xhrPost:_1.xhrGet;
var _38=_37({url:this.url,handleAs:"json-comment-optional",content:_34,failOk:true});
_31.abort=function(){
_38.cancel();
};
_38.addCallback(_1.hitch(this,function(_39){
this._xhrFetchHandler(_39,_31,_32,_33);
}));
_38.addErrback(function(_3a){
_33(_3a,_31);
});
this.lastRequestHash=new Date().getTime()+"-"+String(Math.random()).substring(2);
this._lastServerQuery=_1.mixin({},_34);
}
},_filterResponse:function(_3b){
return _3b;
},_assertIsItem:function(_3c){
if(!this.isItem(_3c)){
throw new Error(this._className+": Invalid item argument.");
}
},_assertIsAttribute:function(_3d){
if(typeof _3d!=="string"){
throw new Error(this._className+": Invalid attribute argument ('"+_3d+"').");
}
},fetchItemByIdentity:function(_3e){
if(this._itemsByIdentity){
var _3f=this._itemsByIdentity[_3e.identity];
if(!(_3f===undefined)){
if(_3e.onItem){
var _40=_3e.scope?_3e.scope:_1.global;
_3e.onItem.call(_40,{i:_3f,r:this});
}
return;
}
}
var _41=function(_42,_43){
var _44=_3e.scope?_3e.scope:_1.global;
if(_3e.onError){
_3e.onError.call(_44,_42);
}
};
var _45=function(_46,_47){
var _48=_3e.scope?_3e.scope:_1.global;
try{
var _49=null;
if(_46&&_46.length==1){
_49=_46[0];
}
if(_3e.onItem){
_3e.onItem.call(_48,_49);
}
}
catch(error){
if(_3e.onError){
_3e.onError.call(_48,error);
}
}
};
var _4a={serverQuery:{id:_3e.identity}};
this._fetchItems(_4a,_45,_41);
},getIdentity:function(_4b){
var _4c=null;
if(this._identifier===Number){
_4c=_4b.n;
}else{
_4c=_4b.i[this._identifier];
}
return _4c;
},getIdentityAttributes:function(_4d){
return [this._identifier];
}});
});


;define("dojo/i18n!bhc/nls/PeopleTypeAhead", {"nextPage":"Next","inviteVisitor":"Invite as a visitor","groupTotalSize":"${totalNum} Members","suspendedUser":"Inactive","previousPage":"Previous","unselectableTitle":"This action is not applicable to this group because it has more than ${totalNum} members.","expandGroupDefaultError":"Internal server error for expanding this group.","expandGroupWithNoEmail":"The following people are not on the list because they have missing or invalid email addresses: ${memberNames}.","showMore":"Show ${num} more results","next":"Next Choices","owner":"Owner:","noResults":"No search results found.","previous":"Previous Choices","pagination":"Showing ${start} to ${end} matches of total ${totalNum}","pageInfo":"Showing ${start} - ${end} of ${totalNum} total"});
if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["bhc"]=true;

;define("bhc/data/resources/AbstractResourceAdapter",["dojo/_base/declare","dojo/_base/lang"],function(_1,_2){
return _1("bhc.data.resources.AbstractResourceAdapter",null,{displayPriority:-1,resourceUrl:"",requestOpts:{},constructor:function(_3){
_2.mixin(this,_3);
},setRequestContent:function(_4){
this.requestOpts.query=_4.serverQuery;
},parseResponse:function(_5){
if(_5){
var _6=_5.items;
for(var i=0;i<_6.length;i++){
_6[i].displayPriority=this.displayPriority;
}
}
return _5;
},onItemSelect:function(_7,_8){
}});
});


;define("bhc/data/resources/PeopleAdapter",["dojo/_base/declare","bhc/data/resources/AbstractResourceAdapter"],function(_1,_2){
return _1("bhc.data.resources.PeopleAdapter",_2,{displayPriority:2,resourceUrl:"",requestOpts:{method:"GET",handleAs:"json"}});
});


;define("bhc/data/resources/PersonalGroupAdapter",["dojo/_base/declare","dojo/_base/lang","dojo/string","dojo/request/xhr","dojo/json","bhc/data/resources/AbstractResourceAdapter"],function(_1,_2,_3,_4,_5,_6){
return _1("bhc.data.resources.PersonalGroupAdapter",_6,{displayPriority:1,resourceUrl:"/mycontacts/api/groups/@me",fetchGroupMembersUrl:"/mycontacts/api/groups/@me/{groupId}/people",internalOnly:true,hasEmail:true,maxGroupExpansion:20,nls:{},requestOpts:{method:"GET",handleAs:"json"},setRequestContent:function(_7){
_7.serverQuery={filterValue:_7.query.f,filterOp:"contains",filterBy:"search"};
this.inherited(arguments);
},parseResponse:function(_8){
var _9={identifier:"i",numRows:0,items:[]};
if(_8){
var _a=_8.entry;
for(var i=0;i<_a.length;i++){
var _b=_a[i];
if(_b.status==0&&!_b.referenceTo){
_9.numRows+=1;
_9.items.push({"i":_b.id,"e":(_b.size>=0)?_3.substitute(this.nls.groupTotalSize,{totalNum:_b.size}):"","f":_b.title,"j":"","s":"0","p":"/connections/resources/web/ic-contacts/images/roundGroup.png","c":"","o":_b.orgId,"displayPriority":this.displayPriority,"isPersonalGroup":true,"size":_b.size||0});
}
}
}
return _9;
},onItemSelect:function(_c,_d){
var _e=_c.i;
var _f=this.fetchGroupMembersUrl.replace("{groupId}",_e.i);
_4.get(_f,{handleAs:"json",query:{count:23,internalOnly:this.internalOnly,hasEmail:this.hasEmail,maxGroupExpansion:this.maxGroupExpansion,includeSubgroups:true}}).then(_2.hitch(this,function(res){
var _10=[];
var _11=[];
var _12=null;
var _13=res.entry;
for(var i=0;i<_13.length;i++){
var c=_13[i];
if(this.hasEmail&&!c.email&&!c.primaryemail){
_11.push(c.displayName||c.name);
}else{
if(c.groupItemType=="profile"){
_10.push({i:{f:c.name,e:c.email,i:"u_"+c.id,o:c.orgId}});
}else{
_10.push({i:{f:c.displayName,e:c.primaryemail,i:"c_"+c.id,o:c.orgId}});
}
}
}
if(this.hasEmail&&_11.length>0){
_12={status:405,message:_3.substitute(this.nls.expandGroupWithNoEmail,{memberNames:_11.join(",")})};
}
_d(_c,_10,_12);
}),_2.hitch(this,function(err){
var res=_5.parse(err.response.text);
var _14={status:res.status,message:(res&&res.message)||this.nls.expandGroupDefaultError};
_d(_c,[],_14);
}));
}});
});


;define("bhc/data/resources/SuperPeopleFinderAdapter",["dojo/_base/declare","bhc/data/resources/AbstractResourceAdapter"],function(_1,_2){
return _1("bhc.data.resources.SuperPeopleFinderAdapter",_2,{displayPriority:1,resourceUrl:"/mycontacts/api/people/typeahead",resourceUrlWithOrg:"/org/{orgId}/mycontacts/api/people/typeahead",emailRequired:false,visitOrgID:"",includeContacts:true,internalOnly:false,requestOpts:{method:"GET",handleAs:"json"},setRequestContent:function(_3){
var _4=_3.query.f||"";
var _5=100;
if(_4.length==3){
_5=200;
}else{
if(_4.length>3){
_5=500;
}
}
var _6=1;
var _7=2;
var _8=16;
var _9=1;
if(this.includeContacts){
_9=_9|_7;
}
if(this.internalOnly){
_9=_9|_8;
}
_3.serverQuery={highlight:false,query:_4,pageSize:_5,scope:_9};
if(this.visitOrgID){
this.resourceUrl=this.resourceUrlWithOrg.replace("{orgId}",this.visitOrgID);
}
this.inherited(arguments);
},parseResponse:function(_a){
var _b={identifier:"i",numRows:0,items:[]};
var _c=[];
if(_a&&_a.persons&&_a.persons.length>0){
var _d=this.mergeItems(_a.persons);
for(var i=0;i<_d.length;i++){
var _e=_d[i];
switch(_e.userType){
case "VISITOR":
if(this.internalOnly){
continue;
}
case "CONTACT":
case "EMPLOYEE":
if(this.emailRequired&&!_e.email){
continue;
}
var id=(_e.userType=="CONTACT")?("c_"+_e.id):("u_"+_e.id);
_b.items.push({"i":id,"e":_e.email,"f":_e.name||_e.email||_e.jobResponsibility||_e.organizationTitle,"j":_e.jobResponsibility,"s":0,"p":_e.photoUrl,"c":_e.organizationTitle,"o":"","displayPriority":this.displayPriority});
break;
}
_b.numRows+=1;
}
}
return _b;
},mergeItems:function(_f){
var _10=[];
var _11={};
for(var i=0;i<_f.length;i++){
var _12=_f[i];
if(!_11[_12.email]||this.getPeopleTypeaheadPriority(_12.userType)>this.getPeopleTypeaheadPriority(_11[_12.email].userType)){
if(!_12.email){
_10.push(_12);
}else{
_11[_12.email]=_12;
}
}
}
for(var key in _11){
_10.push(_11[key]);
}
return _10;
},getPeopleTypeaheadPriority:function(_13){
var _14=0;
switch(_13){
case "EMPLOYEE":
case "VISITOR":
_14=2;
break;
case "CONTACT":
_14=1;
break;
}
return _14;
}});
});


;define("bhc/data/PeopleStore",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/cookie","dojo/request/xhr","dojo/DeferredList","dojox/data/QueryReadStore","dojo/i18n!bhc/nls/PeopleTypeAhead","bhc/data/resources/PeopleAdapter","bhc/data/resources/PersonalGroupAdapter","bhc/data/resources/SuperPeopleFinderAdapter"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
return _1("bhc.data.PeopleStore",[_8],{_parameters:{},doClientPaging:true,dataResources:[],emailRequired:false,visitOrgID:"",includeContacts:true,includePersonalGroup:false,enableSuperPeopleFinder:false,maxGroupExpansion:20,internalOnly:false,resultData:{},constructor:function(_d){
this.enableSuperPeopleFinder=_2.getObject("gatekeeperConfig.contacts-super-pf-api");
_2.mixin(this,_d);
this._extractBaseUrlAndParameters(_d);
if(!this.visitOrgID){
var _e=_4.global.location.href;
var _f=_e.match(/.*\/org\/([\w]*)\/.*/);
if(_f&&_f[1]){
this.visitOrgID=_f[1];
}
}
this.enableAdapterPattern=this.includePersonalGroup||this.enableSuperPeopleFinder;
if(this.enableAdapterPattern){
this.initialResources();
this.setInternalOnly(this.internalOnly);
}
},initialResources:function(){
this.dataResources=[];
if(this.enableSuperPeopleFinder){
var _10=new _c({visitOrgID:this.visitOrgID,internalOnly:this.internalOnly,includeContacts:this.includeContacts,emailRequired:this.emailRequired});
this.dataResources.push(_10);
}else{
var _11=new _a({resourceUrl:this.url});
this.dataResources.push(_11);
}
if(this.includePersonalGroup){
var _12=this.personalGroupAdapter=new _b({nls:_9,maxGroupExpansion:this.maxGroupExpansion,internalOnly:this.internalOnly});
this.dataResources.push(_12);
}
},_filterResponse:function(_13){
_3.forEach(_13.items,function(o){
o.f=o.f.replace(/&lt;/g,"<");
});
return _13;
},fetch:function(_14){
_14.serverQuery=this._parameters;
_14.serverQuery.search_text=_14.query.f;
return this.inherited(arguments);
},_fetchItems:function(_15,_16,_17){
if(!this.enableAdapterPattern){
this.inherited(arguments);
return;
}
var _18=_15.serverQuery||_15.query||{};
if(!this.doClientPaging){
_18.start=_15.start||0;
if(_15.count){
_18.count=_15.count;
}
}
if(!this.doClientSorting&&_15.sort){
var _19=[];
dojo.forEach(_15.sort,function(_1a){
if(_1a&&_1a.attribute){
_19.push((_1a.descending?"-":"")+_1a.attribute);
}
});
_18.sort=_19.join(",");
}
if(this.doClientPaging&&this._lastServerQuery!==null&&dojo.toJson(_18)==dojo.toJson(this._lastServerQuery)){
this._numRows=(this._numRows===-1)?this._items.length:this._numRows;
_16(this._items,_15,this._numRows);
}else{
var _1b=[];
for(var i=0;i<this.dataResources.length;i++){
var dr=this.dataResources[i];
dr.setRequestContent(_15);
var _1c=_6(dr.resourceUrl,dr.requestOpts);
_1b.push(_1c);
}
var dfd=new _7(_1b);
_15.abort=function(){
dfd.cancel();
};
dfd.addCallback(_2.hitch(this,function(_1d){
var _1e=this.resultData={identifier:"i"};
for(var i=0;i<this.dataResources.length;i++){
if(_1d[i][0]){
var _1f=this.dataResources[i].parseResponse(_1d[i][1]);
_1e=this.mergeResourceResults(_1e,_1f);
}
}
this._xhrFetchHandler(_1e,_15,_16,_17);
}));
dfd.addErrback(function(_20){
_17(_20,_15);
});
this.lastRequestHash=new Date().getTime()+"-"+String(Math.random()).substring(2);
this._lastServerQuery=_2.mixin({},_18);
}
},mergeResourceResults:function(_21,_22){
_21=_21||{};
if(_22){
_21.numRows=(_21.numRows||0)+(_22.numRows||0);
_21.items=(_21.items||[]).concat(_22.items||[]);
_21.items.sort(function(_23,_24){
return (_23.displayPriority||-1)-(_24.displayPriority||-1);
});
}
return _21;
},_extractBaseUrlAndParameters:function(_25){
var r,o=[];
if(!_25.url){
throw "URL is missing";
}
r=_25.url.split("?");
delete _25["url"];
if(r.length>2){
throw "Unable to determine the base URL";
}
this.url=r[0];
this._parameters.token=this.token?this.token:_5("token");
if(!this._parameters.token){
throw "Token is missing";
}
_2.mixin(o,this._parameters);
if(r.length==2){
_3.forEach(r[1].split("&"),function(p){
var r=p.split("=");
if(r.length>2){
throw "Unable to determine the actual value of the current parameter";
}
this._parameters[r[0]]=r[1]?r[1]:"";
},this);
}
if(this._parameters.intent=="internal"){
this.internalOnly=true;
}
if(this._parameters.contacts=="false"){
this.includeContacts=false;
}
if(this._parameters.strict=="true"){
this.emailRequired=true;
}
},setInternalOnly:function(_26){
if(this.enableAdapterPattern){
this.internalOnly=!!_26;
for(var i=0;i<this.dataResources.length;i++){
this.dataResources[i].internalOnly=!!_26;
}
}
this._parameters.intent=_26?"internal":"external";
this._lastServerQuery=null;
},fetchItemByIdentity:function(i){
return this._itemsByIdentity&&this._itemsByIdentity[i]?this._itemsByIdentity[i]:null;
},fetchItemByEmail:function(e){
var _27=null;
for(var key in this._itemsByIdentity){
if(this._itemsByIdentity.hasOwnProperty(key)&&this._itemsByIdentity[key].e==e){
_27=this._itemsByIdentity[key];
}
}
return _27;
}});
});


;define("dojo/text!bhc/templates/PeopleTypeAheadMenu.html", '<!-- Copyright IBM Corp. 2007, 2014 All Rights Reserved. -->\n<div class="dijitReset dijitMenu bhcPeopleTypeAheadMenu">\n	<div class="listDescription" data-dojo-attach-point="listDescription"></div>\n	<div class="noResultsMessage" data-dojo-attach-point="noResultsMessage"></div>\n	<div class="containerNode" data-dojo-attach-point="containerNode" style="overflow: auto; overflow-x: hidden;" role="listbox" aria-label="Search Results" onkeypress="return true;" onkeydown="return true;">\n		<div class="dijitMenuItem dijitMenuPreviousButton" data-dojo-attach-point="previousButton" tabindex="-1"></div>\n		<div class="dijitMenuItem dijitMenuNextButton" data-dojo-attach-point="nextButton" tabindex="-1"></div>\n	</div>\n	<div class="listPaginationInfo" data-dojo-attach-point=listPaginationInfo></div>\n</div>');

;define("bhc/PeopleTypeAheadMenu",["dojo/_base/declare","dojo/_base/array","dojo/string","dojo/dom-construct","dojo/query","dojo/dom-class","dijit/form/_ComboBoxMenu","dojo/text!./templates/PeopleTypeAheadMenu.html","dojo/i18n!./nls/PeopleTypeAhead","dojo/NodeList-dom"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
return _1("bhc.PeopleTypeAheadMenu",[_7],{templateString:_8.replace(/(<!--.*-->|\n|\r|\t)/gm,""),maxGroupExpansion:20,postMixInProperties:function(){
this.inherited(arguments);
this._messages=_9;
this._messages["previousMessage"]=this._messages["previousPage"];
this._messages["nextMessage"]=this._messages["nextPage"];
this._messages["InviteVisitor"]=this._messages["inviteVisitor"];
},_isValidEmail:function(_a){
var _b=/^\S+@\S+\.\S+$/;
return _b.test(_a);
},postCreate:function(){
this.inherited(arguments);
this.hasGKVisitorModel=false;
if(this.hasGKVisitorModel){
this.visitorModelEnabled=false;
this.visitorModelInviteDiv=document.createElement("div");
this.visitorModelInviteDiv.setAttribute("id","inviteVisitorButtonId");
this.visitorModelInviteDiv.setAttribute("class","dijitMenuItem dijitMenuInviteVisitorButton");
this.visitorModelInviteDiv.setAttribute("data-dojo-attach-point","inviteVisitorButton");
this.visitorModelInviteDiv.setAttribute("tabindex","-1");
this.visitorModelInviteDiv.innerHTML=this._messages["InviteVisitor"];
this.visitorModelInviteSpan=document.createElement("span");
this.visitorModelInviteSpan.setAttribute("class","lotusui30 lconnIconListSharedExternal");
this.visitorModelInviteDiv.appendChild(this.visitorModelInviteSpan);
}
this.noResultsMessage.innerHTML=this._messages["noResults"];
this.noResultsMessage.id=this.id+"_noResultsMessage";
this.listDescription.id=this.id+"_listDescription";
if(this.headerMessage){
this.containerNode.setAttribute("aria-describedby",this.listDescription.id);
this.listDescription.innerHTML=this.headerMessage;
}else{
_4.destroy(this.listDescription);
}
},_createOption:function(_c){
var o=this.inherited(arguments);
o.setAttribute("aria-posinset",_c.posinset);
o.setAttribute("aria-setsize",_c.setsize);
o.setAttribute("tabindex","-1");
if(_c.i.s==2){
this._addTag(o,this._messages["suspendedUser"]);
}
if(_c.i.isPersonalGroup&&_c.i.size&&_c.i.size>this.maxGroupExpansion){
_6.add(o,"unselectable");
o.title=_3.substitute(this._messages["unselectableTitle"],{totalNum:this.maxGroupExpansion});
}
return o;
},createOptions:function(_d,_e){
var _f=_e.start+1;
var to=_f+_d.length-1;
var _10=_d.total;
this.disableNoResultsMode();
for(var i=0,m=_d.length;i<m;i++){
_d[i].posinset=_f+i;
_d[i].setsize=_10;
}
this.paginationInfo={"start":_f,"end":to,"totalNum":_10};
if(_f>1||_10>to){
this.listPaginationInfo.innerHTML=_3.substitute(this._messages["pagination"],this.paginationInfo);
this.listPaginationInfo.style.display="";
}else{
this.listPaginationInfo.innerHTML="";
this.listPaginationInfo.style.display="none";
}
this.domNode.style.width="";
this.inherited(arguments);
_5(this.containerNode.lastChild.previousSibling).addClass("lastOption");
},onHover:function onHover_$4(_11){
if(!this.isSelectable(_11)){
this._setSelectedAttr(_11);
}
},onSelect:function(_12){
if(!this.isSelectable(_12)){
_6.add(_12,"dijitMenuItemSelected");
}
},onClick:function(_13){
if(!this.isSelectable(_13)){
this.inherited(arguments);
}
},isSelectable:function(_14){
return _6.contains(_14,"unselectable");
},onUnhover:function(_15){
},enableNoResultsMode:function(){
if(this.hasGKVisitorModel&&this.liveAddMemberInstance!=null){
this.visitorModelEnabled=true;
if(this.visitorModelEnabled){
var _16=this.containerNode.childNodes;
for(var i=0;i<_16.length;i++){
if(_16[i].nodeName.toLowerCase()=="div"&&_16[i].id!=this.visitorModelInviteDiv.id){
_16[i].style.display="none";
}
}
if(this.liveAddMemberInstance.showVisitorOption!="undefined"&&this.liveAddMemberInstance.showVisitorOption!=null&&this.liveAddMemberInstance.showVisitorOption){
this.containerNode.appendChild(this.visitorModelInviteDiv);
}
this.visitorModelInviteDiv.style.display="";
if(this._isValidEmail(this.liveAddMemberInstance.typeAhead_W._lastInput)){
this.visitorModelInviteDiv.style.opacity="1";
}else{
this.visitorModelInviteDiv.style.opacity="0.3";
}
}
}else{
_4.destroy(this.containerNode);
}
this.noResultsMessage.style.display="";
this.listPaginationInfo.style.display="none";
if(this.headerMessage){
this.listDescription.style.display="none";
}
},disableNoResultsMode:function(){
this.domNode.insertBefore(this.containerNode,this.listPaginationInfo);
this.containerNode.appendChild(this.previousButton);
this.containerNode.appendChild(this.nextButton);
this.buildRendering();
if(this.hasGKVisitorModel&&this.visitorModelEnabled){
this.visitorModelInviteDiv.style.display="none";
}
this.noResultsMessage.style.display="none";
this.listPaginationInfo.style.display="";
if(this.headerMessage){
this.listDescription.style.display="";
}
},_lockCKEditorFocusManager:function(){
if(typeof CKEDITOR!="undefined"){
for(var i in CKEDITOR.instances){
CKEDITOR.focusManager(CKEDITOR.instances[i]).lock();
}
}
},_unlockCKEditorFocusManager:function(){
if(typeof CKEDITOR!="undefined"){
for(var i in CKEDITOR.instances){
CKEDITOR.focusManager(CKEDITOR.instances[i]).unlock();
}
}
},_addTag:function(_17,_18){
_4.create("span",{"innerHTML":_18},_5(".bhcPeopleTypeAheadUserTags",_17)[0]);
},_onMouseUp:function(evt){
evt.preventDefault();
},_onMouseDown:function(evt){
if(!textUtils.isIE11){
evt.preventDefault();
}
},_onClick:function(evt){
if(evt.target==this.previousButton||evt.target.parentNode==this.previousButton){
this.onPage(-1);
}else{
if(evt.target==this.nextButton||evt.target.parentNode==this.nextButton){
this.onPage(1);
}else{
if(evt.target==this.noResponseOption||evt.target.parentNode==this.noResponseOption||evt.target==this.headerOption||evt.target.parentNode==this.headerOption){
}else{
this.inherited("_onClick",arguments);
}
}
}
}});
});


;define("dojo/text!bhc/templates/PeopleTypeAhead.html", '<!-- Copyright IBM Corp. 2007, 2014 All Rights Reserved. -->\n<div class="bhcBizCardFloat lotusLeft"><img class="bhcBizCardImg" src="${p}" alt=""></div>\n<div class="bhcBizCardText lotusLeft">\n	<div class="bhcBizCardEllipsis"><span class="bhcPeopleTypeAheadUserName">${f}</span></div>\n	<div class="bhcBizCardEllipsis">${o}</div>\n	<div class="bhcBizCardEllipsis">${e}</div>\n	<div style="display: none; position: absolute"><span class="bhcPeopleTypeAheadUserTags"></span></div>\n</div>\n<div style="clear:both"></div>');

;define("bhc/PeopleTypeAhead",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/query","dojo/keys","dojo/string","dojo/on","dojo/dom-geometry","dojo/dom-style","dojox/validate/web","dijit/form/ComboBox","bhc/data/PeopleStore","bhc/PeopleTypeAheadMenu","dojo/text!./templates/PeopleTypeAhead.html","dojo/NodeList-dom"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){
return _1("bhc.PeopleTypeAhead",[_c],{lconn_core_instance:null,hasDownArrow:false,inline:false,multi:true,searchAttr:"f",valueAttr:"e",pageSize:6,queryExpr:"${0}",searchDelay:500,optionTemplate:_f.replace(/(<!--.*-->|\n|\r|\t)/gm,""),helpText:"",headerMessage:"",visitOrgID:"",includeContacts:true,includePersonalGroup:false,maxGroupExpansion:20,internalOnly:false,constructor:function(_10){
if(typeof gllConnectionsData!=="undefined"&&gllConnectionsData.isVersePreview){
this.setValueAttr("i");
}
_2.mixin(this,_10);
this.includePersonalGroup=_2.getObject("gatekeeperConfig.contacts-group-typeahead");
if(!this.store){
if(!this.url){
throw "URL is missing and store was not provided";
}
this.store=new _d({"url":this.url,visitOrgID:this.visitOrgID,includePersonalGroup:this.includePersonalGroup,maxGroupExpansion:this.maxGroupExpansion,includeContacts:this.includeContacts,internalOnly:this.internalOnly});
}
},postMixInProperties:function(){
if(!this.hasDownArrow){
this.baseClass="dijitTextBox";
}
this.inherited(arguments);
},buildRendering:function(){
this.inherited("buildRendering",arguments);
if(this.srcNodeRef&&this.srcNodeRef.nodeName.toLowerCase()=="textarea"){
this.srcNodeRef.setAttribute("name",this.name?this.name:this.id);
this.srcNodeRef.setAttribute("role","textbox");
this.srcNodeRef.setAttribute("aria-haspopup","true");
this.srcNodeRef.setAttribute("aria-autocomplete","list");
this.domNode=this.srcNodeRef;
this.focusNode=this.srcNodeRef;
this.textbox=this.srcNodeRef;
_5(this.srcNodeRef).addClass("dijitReset typeaheadInput");
}else{
_5(this.focusNode.parentNode).addClass(this.inline?"typeaheadInputInline":"typeaheadInput");
}
},postCreate:function(){
this.inherited(arguments);
this._setHasDownArrowAttr(this.hasDownArrow);
if(this.helpText){
this.focusNode.value=this.helpText;
_8.once(this.focusNode,"focus",function(){
this.value="";
});
}
},_startSearch:function(key){
if(this.multi){
var r=key.split(",");
key=_7.trim(r[r.length-1]);
}
if(key.length>=2){
if(!this.dropDown){
this.dropDown=new _e({"onChange":_2.hitch(this,this._selectOption),"headerMessage":this.headerMessage,maxGroupExpansion:this.maxGroupExpansion,"liveAddMemberInstance":this.lconn_core_instance});
this._popupWidget=this.dropDown;
}
if(this.searchTimer){
this.searchTimer=clearTimeout(this.searchTimer);
}
if(document.activeElement!=this.focusNode){
this.alternativeReferenceNode=_5("a[dojoattachpoint=linkNode]",document.activeElement)[0]||null;
}
this.inherited(arguments);
}else{
if(this._opened){
this.closeDropDown(true);
}
}
},_announceOption:function(_11){
if(_11){
var v=this.focusNode.value;
if(document.activeElement!=this.focusNode){
document.activeElement.setAttribute("aria-activedescendant",_11.id);
}
this.inherited(arguments);
if(_11.id=="inviteVisitorButtonId"){
this.selectedItem=_11;
}else{
this.selectedItem=this.item;
}
this.focusNode.value=v;
}
},_autoCompleteText:function(){
},openDropDown:function(){
this.inherited(arguments);
this._isShowingNow=this._opened;
if(this._opened){
this.domNode.removeAttribute("aria-owns");
this.dropDown._popupWrapper.setAttribute("aria-label","People TypeAhead Menu");
if(this.store._items.length>0){
this.dropDown.highlightFirstOption();
this._announceOption(this.dropDown.selected);
}
}
},setValueAttr:function(arg){
this.valueAttr=(arg.length===1&&arg.match(/[a-z]/i))?arg:this.valueAttr;
},closeDropDown:function(){
if(this.searchTimer){
this.searchTimer=clearTimeout(this.searchTimer);
}
this.inherited(arguments);
if(this.dropDown&&this.dropDown._popupWrapper){
this.dropDown._popupWrapper.style.overflowY="";
if(this.borderStyle){
this.dropDown._popupWrapper.style.border="none";
this.dropDown.domNode.style.border=this.borderStyle;
delete this.borderStyle;
}
}
this.focusNode.removeAttribute("aria-activedescendant");
this._isShowingNow=this._opened;
},_openResultList:function(_12){
var _13;
this.results=_12;
if(_12.length>0){
this.inherited(arguments);
this.dropDown._popupWrapper.setAttribute("role","region");
if(this.externalAddButton){
this.externalAddButton.setAttribute("aria-disabled","true");
this._toggleStyles(this.externalAddButton,"lconnSprite-iconAddRating16","lconnSprite-iconPaletteAdd16-Hover");
dojo.style(this.externalAddButton,"cursor","auto");
}
}else{
this.dropDown.enableNoResultsMode();
this._showResultList();
this.dropDown._popupWrapper.setAttribute("role","alert");
this.dropDown._popupWrapper.setAttribute("aria-label","");
if(this.externalAddButton&&this._isValidEmail(this._lastInput)){
this.externalAddButton.setAttribute("aria-disabled","false");
this._toggleStyles(this.externalAddButton,"lconnSprite-iconPaletteAdd16-Hover","lconnSprite-iconAddRating16");
dojo.style(this.externalAddButton,"cursor","pointer");
}else{
this.externalAddButton.setAttribute("aria-disabled","true");
this._toggleStyles(this.externalAddButton,"lconnSprite-iconAddRating16","lconnSprite-iconPaletteAdd16-Hover");
dojo.style(this.externalAddButton,"cursor","auto");
}
}
_13=_5("iframe",this.dropDown._popupWrapper)[0];
_13&&_13.parentNode.removeChild(_13);
if(this._opened){
this._showTags();
this._fixPosition();
}
},_isValidEmail:function(_14){
var _15=/^\S+@\S+\.\S+$/;
return _15.test(_14);
},_toggleStyles:function(_16,_17,_18){
if(!dojo.hasClass(_16,_18)){
dojo.removeClass(_16,_17);
dojo.addClass(_16,_18);
}
},_getMenuLabelFromItem:function(_19){
var _1a=new RegExp("("+this._lastInput.replace(/</g,"&lt;").replace(/\s+/g,"|")+")","ig");
var _1b=_7.substitute(_f,{"p":_19.i.p,"f":_19.i.f.replace(/</g,"&lt;").replace(_1a,"<b>$1</b>"),"o":_19.i.j||_19.i.c||"","e":_19.i.e?_19.i.e.replace(_1a,"<b>$1</b>"):""});
return {html:true,label:_1b};
},_onKey:function(e){
var _1c=false;
var _1d=this.dropDown;
var _1e=_1d?_1d.getHighlightedOption():null;
var _1f=_1e?parseInt(_1e.getAttribute("aria-posinset")):null;
if(_1f!==null){
var _20=_1d.paginationInfo;
switch(e.keyCode){
case _6.DOWN_ARROW:
if(_1f==_20.end&&_1f<_20.totalNum){
_1c=true;
_1d.onPage(1);
}else{
if(_1f==_20.totalNum){
_1c=true;
}
}
break;
case _6.UP_ARROW:
if(_1f==_20.start&&_1f>1){
_1c=true;
_1d.onPage(-1);
}else{
if(_1f==1){
_1c=true;
}
}
break;
case _6.PAGE_DOWN:
if(Math.ceil(_1f/this.pageSize)<Math.ceil(_20.totalNum/this.pageSize)){
_1d.onPage(1);
}
_1c=true;
break;
case _6.PAGE_UP:
if(_1f>this.pageSize){
_1d.onPage(-1);
_1d.highlightFirstOption();
this._announceOption(_1d.getHighlightedOption());
}
_1c=true;
break;
case 188:
this._selectOption(_1e);
_1c=true;
break;
default:
break;
}
}
if(!_1c){
this.inherited(arguments);
if(dojo.isIE==8&&e.keyCode==229){
_8.emit(this.textbox,"input",{bubbles:true,cancelable:false,keyCode:229});
}
}else{
e.stopPropagation();
e.preventDefault();
}
},_selectOption:function(){
this.inherited(arguments);
this.onSelectOption();
},newStore:function(){
return this.store;
},setInternalOnly:function(_21){
if(!this.store){
throw "No store available";
}
this.store.setInternalOnly(_21);
if(this.externalAddButton){
this.externalAddButton.style.display=_21?"none":"inline";
}
},setHeaderMessage:function(_22){
this.headerMessage=_22;
},clearHeaderMessage:function(){
this.headerMessage="";
},getValueItems:function(){
var o={"contacts":[],"users":[],"emails":[]};
var r=this.focusNode.value.split(",");
_3.forEach(r,function(v){
if(v){
var i=_b.isEmailAddress(v)?this.store.fetchItemByEmail(v):this.store.fetchItemByIdentity(v);
if(typeof gllConnectionsData!=="undefined"&&gllConnectionsData.isVersePreview&&i){
delete i.e;
}
if(i){
var t=i.i[0]=="u"?o.users:(i.i[0]=="c"?o.contacts:null);
if(t){
t.push({"i":i.i.substring(2),"e":i.e,"f":i.f,"o":i.o});
}
}else{
if(_b.isEmailAddress(v)){
o.emails.push(v);
}
}
}
},this);
return o;
},getItem:function(){
var i,m,r=null,o=this.getValueItems();
var _23=o.users;
var _24=o.contacts;
var _25=o.emails;
for(i=0,m=_23.length;i<m;i++){
r={"userid":_23[i].i,"name":_23[i].f,"type":0,"members":_23[i].e,"ext":{"orgId":_23[i].o}};
}
for(i=0,m=_24.length;i<m;i++){
this.textBoxValue=_24[i].f+"<"+_24[i].e+">";
}
for(i=0,m=_25.length;i<m;i++){
this.textBoxValue=_25[i];
}
return r;
},_hideResultList:function(){
this.closeDropDown();
},_onKeyPress:function(e){
this._onKey(e);
},onSelectOption:function(){
if(this.selectedItem.id!=="inviteVisitorButtonId"){
var _26=this.selectedItem.i;
if(this.includePersonalGroup&&_26.isPersonalGroup){
var _27=this.store.personalGroupAdapter;
_27.onItemSelect(this.selectedItem,this.onSelect);
}else{
var m=this.focusNode.value.lastIndexOf(",");
this.focusNode.value=this.multi?((m>0?this.focusNode.value.substring(0,m+1):"")+this.selectedItem.i[this.valueAttr||this.searchAttr]+", "):this.selectedItem.i[this.valueAttr||this.searchAttr];
}
setTimeout(_2.hitch(this,"onSelect",this.selectedItem,[this.selectedItem]),0);
}
},onSelect:function(_28,_29,_2a){
},_fixPosition:function(){
if(this.alternativeReferenceNode){
var _2b=this.dropDown._popupWrapper;
var _2c=_9.position(_2b,true);
var _2d=_9.position(this.alternativeReferenceNode,true);
if(_2c.y>_2d.y&&_2c.y<_2d.y+_2d.h){
_2b.style.top=(_2d.y+_2d.h)+"px";
}
if(_2c.y<_2d.y&&_2c.y+_2c.h>_2d.y){
var _2e=_2c.y+_2c.h-_2d.y;
if(_9.position(_2b,false).y-_2e>0){
_2b.style.top=(_2c.y-_2e)+"px";
}else{
var _2f=_2b.style.overflowY!="scroll"?_a.getComputedStyle(this.dropDown.domNode):_a.getComputedStyle(_2b);
var _30=_2f.borderLeftWidth+" "+_2f.borderLeftStyle+" "+_2f.borderLeftColor;
_2b.style.height=(_2c.h-_2e-(parseInt(_2f.borderTopWidth)+parseInt(_2f.borderBottomWidth)))+"px";
if(_2b.style.overflowY!="scroll"){
this.borderStyle=_30;
_2b.style.overflowY="scroll";
_2b.style.border=this.borderStyle;
this.dropDown.domNode.style.border="none";
}
}
}
}
},_showTags:function(){
var w=_9.position(this.dropDown.domNode).w;
this.dropDown.domNode.style.width="";
_3.forEach(_5(".bhcPeopleTypeAheadUserTags",this.containerNode),function(o){
var n1=o.parentNode,n2=n1.parentNode,w,p;
n1.style.display="block";
if((w=_9.position(o).w+(p=_9.position(_5(".bhcPeopleTypeAheadUserName",n2)[0],true)).w)>_9.position(n2).w){
n2.style.width=w+"px";
}
n1.style.lineHeight=p.h+"px";
n1.style.top=(p.y-this.y)+"px";
if(this.d=="rtl"){
n1.style.left="0";
}else{
n1.style.right="0";
}
},_2.mixin(_9.position(this.dropDown.domNode,true),{"d":_4.body().dir}));
if(w>_9.position(this.dropDown.domNode).w){
this.dropDown.domNode.style.width=(w-2)+"px";
}
}});
});


;define("dijit/layout/LayoutContainer",["dojo/_base/array","dojo/_base/declare","dojo/dom-class","dojo/dom-style","dojo/_base/lang","../_WidgetBase","./_LayoutWidget","./utils"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9=_2("dijit.layout.LayoutContainer",_7,{design:"headline",baseClass:"dijitLayoutContainer",startup:function(){
if(this._started){
return;
}
_1.forEach(this.getChildren(),this._setupChild,this);
this.inherited(arguments);
},_setupChild:function(_a){
this.inherited(arguments);
var _b=_a.region;
if(_b){
_3.add(_a.domNode,this.baseClass+"Pane");
}
},_getOrderedChildren:function(){
var _c=_1.map(this.getChildren(),function(_d,_e){
return {pane:_d,weight:[_d.region=="center"?Infinity:0,_d.layoutPriority,(this.design=="sidebar"?1:-1)*(/top|bottom/.test(_d.region)?1:-1),_e]};
},this);
_c.sort(function(a,b){
var aw=a.weight,bw=b.weight;
for(var i=0;i<aw.length;i++){
if(aw[i]!=bw[i]){
return aw[i]-bw[i];
}
}
return 0;
});
return _1.map(_c,function(w){
return w.pane;
});
},layout:function(){
_8.layoutChildren(this.domNode,this._contentBox,this._getOrderedChildren());
},addChild:function(_f,_10){
this.inherited(arguments);
if(this._started){
this.layout();
}
},removeChild:function(_11){
this.inherited(arguments);
if(this._started){
this.layout();
}
_3.remove(_11.domNode,this.baseClass+"Pane");
_4.set(_11.domNode,{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});
_4.set(_11.domNode,/top|bottom/.test(_11.region)?"width":"height","auto");
}});
_9.ChildWidgetProperties={region:"",layoutAlign:"",layoutPriority:0};
_5.extend(_6,_9.ChildWidgetProperties);
return _9;
});


;define("dijit/layout/BorderContainer",["dojo/_base/array","dojo/cookie","dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/touch","../_WidgetBase","../_Widget","../_TemplatedMixin","./LayoutContainer","./utils"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,on,_a,_b,_c,_d,_e,_f){
var _10=_3("dijit.layout._Splitter",[_c,_d],{live:true,templateString:"<div class=\"dijitSplitter\" data-dojo-attach-event=\"onkeydown:_onKeyDown,press:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse\" tabIndex=\"0\" role=\"separator\"><div class=\"dijitSplitterThumb\"></div></div>",constructor:function(){
this._handlers=[];
},postMixInProperties:function(){
this.inherited(arguments);
this.horizontal=/top|bottom/.test(this.region);
this._factor=/top|left/.test(this.region)?1:-1;
this._cookieName=this.container.id+"_"+this.region;
},buildRendering:function(){
this.inherited(arguments);
_4.add(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));
if(this.container.persist){
var _11=_2(this._cookieName);
if(_11){
this.child.domNode.style[this.horizontal?"height":"width"]=_11;
}
}
},_computeMaxSize:function(){
var dim=this.horizontal?"h":"w",_12=_6.getMarginBox(this.child.domNode)[dim],_13=_1.filter(this.container.getChildren(),function(_14){
return _14.region=="center";
})[0];
var _15=_6.getContentBox(_13.domNode)[dim]-10;
return Math.min(this.child.maxSize,_12+_15);
},_startDrag:function(e){
if(!this.cover){
this.cover=_5.place("<div class=dijitSplitterCover></div>",this.child.domNode,"after");
}
_4.add(this.cover,"dijitSplitterCoverActive");
if(this.fake){
_5.destroy(this.fake);
}
if(!(this._resize=this.live)){
(this.fake=this.domNode.cloneNode(true)).removeAttribute("id");
_4.add(this.domNode,"dijitSplitterShadow");
_5.place(this.fake,this.domNode,"after");
}
_4.add(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active");
if(this.fake){
_4.remove(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");
}
var _16=this._factor,_17=this.horizontal,_18=_17?"pageY":"pageX",_19=e[_18],_1a=this.domNode.style,dim=_17?"h":"w",_1b=_7.getComputedStyle(this.child.domNode),_1c=_6.getMarginBox(this.child.domNode,_1b)[dim],max=this._computeMaxSize(),min=Math.max(this.child.minSize,_6.getPadBorderExtents(this.child.domNode,_1b)[dim]+10),_1d=this.region,_1e=_1d=="top"||_1d=="bottom"?"top":"left",_1f=parseInt(_1a[_1e],10),_20=this._resize,_21=_9.hitch(this.container,"_layoutChildren",this.child.id),de=this.ownerDocument;
this._handlers=this._handlers.concat([on(de,_a.move,this._drag=function(e,_22){
var _23=e[_18]-_19,_24=_16*_23+_1c,_25=Math.max(Math.min(_24,max),min);
if(_20||_22){
_21(_25);
}
_1a[_1e]=_23+_1f+_16*(_25-_24)+"px";
}),on(de,"dragstart",function(e){
e.stopPropagation();
e.preventDefault();
}),on(this.ownerDocumentBody,"selectstart",function(e){
e.stopPropagation();
e.preventDefault();
}),on(de,_a.release,_9.hitch(this,"_stopDrag"))]);
e.stopPropagation();
e.preventDefault();
},_onMouse:function(e){
var o=(e.type=="mouseover"||e.type=="mouseenter");
_4.toggle(this.domNode,"dijitSplitterHover",o);
_4.toggle(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",o);
},_stopDrag:function(e){
try{
if(this.cover){
_4.remove(this.cover,"dijitSplitterCoverActive");
}
if(this.fake){
_5.destroy(this.fake);
}
_4.remove(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow");
this._drag(e);
this._drag(e,true);
}
finally{
this._cleanupHandlers();
delete this._drag;
}
if(this.container.persist){
_2(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365});
}
},_cleanupHandlers:function(){
var h;
while(h=this._handlers.pop()){
h.remove();
}
},_onKeyDown:function(e){
this._resize=true;
var _26=this.horizontal;
var _27=1;
switch(e.keyCode){
case _26?_8.UP_ARROW:_8.LEFT_ARROW:
_27*=-1;
case _26?_8.DOWN_ARROW:_8.RIGHT_ARROW:
break;
default:
return;
}
var _28=_6.getMarginSize(this.child.domNode)[_26?"h":"w"]+this._factor*_27;
this.container._layoutChildren(this.child.id,Math.max(Math.min(_28,this._computeMaxSize()),this.child.minSize));
e.stopPropagation();
e.preventDefault();
},destroy:function(){
this._cleanupHandlers();
delete this.child;
delete this.container;
delete this.cover;
delete this.fake;
this.inherited(arguments);
}});
var _29=_3("dijit.layout._Gutter",[_c,_d],{templateString:"<div class=\"dijitGutter\" role=\"presentation\"></div>",postMixInProperties:function(){
this.inherited(arguments);
this.horizontal=/top|bottom/.test(this.region);
},buildRendering:function(){
this.inherited(arguments);
_4.add(this.domNode,"dijitGutter"+(this.horizontal?"H":"V"));
}});
var _2a=_3("dijit.layout.BorderContainer",_e,{gutters:true,liveSplitters:true,persist:false,baseClass:"dijitBorderContainer",_splitterClass:_10,postMixInProperties:function(){
if(!this.gutters){
this.baseClass+="NoGutter";
}
this.inherited(arguments);
},_setupChild:function(_2b){
this.inherited(arguments);
var _2c=_2b.region,ltr=_2b.isLeftToRight();
if(_2c=="leading"){
_2c=ltr?"left":"right";
}
if(_2c=="trailing"){
_2c=ltr?"right":"left";
}
if(_2c){
if(_2c!="center"&&(_2b.splitter||this.gutters)&&!_2b._splitterWidget){
var _2d=_2b.splitter?this._splitterClass:_29;
if(_9.isString(_2d)){
_2d=_9.getObject(_2d);
}
var _2e=new _2d({id:_2b.id+"_splitter",container:this,child:_2b,region:_2c,live:this.liveSplitters});
_2e.isSplitter=true;
_2b._splitterWidget=_2e;
var _2f=_2c=="bottom"||_2c==(this.isLeftToRight()?"right":"left");
_5.place(_2e.domNode,_2b.domNode,_2f?"before":"after");
_2e.startup();
}
}
},layout:function(){
this._layoutChildren();
},removeChild:function(_30){
var _31=_30._splitterWidget;
if(_31){
_31.destroy();
delete _30._splitterWidget;
}
this.inherited(arguments);
},getChildren:function(){
return _1.filter(this.inherited(arguments),function(_32){
return !_32.isSplitter;
});
},getSplitter:function(_33){
return _1.filter(this.getChildren(),function(_34){
return _34.region==_33;
})[0]._splitterWidget;
},resize:function(_35,_36){
if(!this.cs||!this.pe){
var _37=this.domNode;
this.cs=_7.getComputedStyle(_37);
this.pe=_6.getPadExtents(_37,this.cs);
this.pe.r=_7.toPixelValue(_37,this.cs.paddingRight);
this.pe.b=_7.toPixelValue(_37,this.cs.paddingBottom);
_7.set(_37,"padding","0px");
}
this.inherited(arguments);
},_layoutChildren:function(_38,_39){
if(!this._borderBox||!this._borderBox.h){
return;
}
var _3a=[];
_1.forEach(this._getOrderedChildren(),function(_3b){
_3a.push(_3b);
if(_3b._splitterWidget){
_3a.push(_3b._splitterWidget);
}
});
var dim={l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h};
_f.layoutChildren(this.domNode,dim,_3a,_38,_39);
},destroyRecursive:function(){
_1.forEach(this.getChildren(),function(_3c){
var _3d=_3c._splitterWidget;
if(_3d){
_3d.destroy();
}
delete _3c._splitterWidget;
});
this.inherited(arguments);
}});
_2a.ChildWidgetProperties={splitter:false,minSize:0,maxSize:Infinity};
_9.mixin(_2a.ChildWidgetProperties,_e.ChildWidgetProperties);
_9.extend(_b,_2a.ChildWidgetProperties);
_2a._Splitter=_10;
_2a._Gutter=_29;
return _2a;
});


;define("dijit/ToolbarSeparator",["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(_1,_2,_3,_4){
return _1("dijit.ToolbarSeparator",[_3,_4],{templateString:"<div class=\"dijitToolbarSeparator dijitInline\" role=\"presentation\"></div>",buildRendering:function(){
this.inherited(arguments);
_2.setSelectable(this.domNode,false);
},isFocusable:function(){
return false;
}});
});


;define("dijit/Toolbar",["require","dojo/_base/declare","dojo/has","dojo/keys","dojo/ready","./_Widget","./_KeyNavContainer","./_TemplatedMixin","./ToolbarSeparator"],function(_1,_2,_3,_4,_5,_6,_7,_8){
return _2("dijit.Toolbar",[_6,_8,_7],{templateString:"<div class=\"dijit\" role=\"toolbar\" tabIndex=\"${tabIndex}\" data-dojo-attach-point=\"containerNode\">"+"</div>",baseClass:"dijitToolbar",_onLeftArrow:function(){
this.focusPrev();
},_onRightArrow:function(){
this.focusNext();
}});
});


;define("dijit/_editor/_Plugin",["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(_1,_2,_3,_4,_5){
var _6=_2("dijit._editor._Plugin",_4,{constructor:function(_7){
this.params=_7||{};
_3.mixin(this,this.params);
this._attrPairNames={};
},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:true,buttonClass:_5,disabled:false,getLabel:function(_8){
return this.editor.commands[_8];
},_initButton:function(){
if(this.command.length){
var _9=this.getLabel(this.command),_a=this.editor,_b=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);
if(!this.button){
var _c=_3.mixin({label:_9,ownerDocument:_a.ownerDocument,dir:_a.dir,lang:_a.lang,showLabel:false,iconClass:_b,dropDown:this.dropDown,tabIndex:"-1"},this.params||{});
delete _c.name;
this.button=new this.buttonClass(_c);
}
}
if(this.get("disabled")&&this.button){
this.button.set("disabled",this.get("disabled"));
}
},destroy:function(){
if(this.dropDown){
this.dropDown.destroyRecursive();
}
this.inherited(arguments);
},connect:function(o,f,tf){
this.own(_1.connect(o,f,this,tf));
},updateState:function(){
var e=this.editor,c=this.command,_d,_e;
if(!e||!e.isLoaded||!c.length){
return;
}
var _f=this.get("disabled");
if(this.button){
try{
_e=!_f&&e.queryCommandEnabled(c);
if(this.enabled!==_e){
this.enabled=_e;
this.button.set("disabled",!_e);
}
if(_e){
if(typeof this.button.checked=="boolean"){
_d=e.queryCommandState(c);
if(this.checked!==_d){
this.checked=_d;
this.button.set("checked",e.queryCommandState(c));
}
}
}
}
catch(e){
console.log(e);
}
}
},setEditor:function(_10){
this.editor=_10;
this._initButton();
if(this.button&&this.useDefaultCommand){
if(this.editor.queryCommandAvailable(this.command)){
this.own(this.button.on("click",_3.hitch(this.editor,"execCommand",this.command,this.commandArg)));
}else{
this.button.domNode.style.display="none";
}
}
this.own(this.editor.on("NormalizedDisplayChanged",_3.hitch(this,"updateState")));
},setToolbar:function(_11){
if(this.button){
_11.addChild(this.button);
}
},set:function(_12,_13){
if(typeof _12==="object"){
for(var x in _12){
this.set(x,_12[x]);
}
return this;
}
var _14=this._getAttrNames(_12);
if(this[_14.s]){
var _15=this[_14.s].apply(this,Array.prototype.slice.call(arguments,1));
}else{
this._set(_12,_13);
}
return _15||this;
},get:function(_16){
var _17=this._getAttrNames(_16);
return this[_17.g]?this[_17.g]():this[_16];
},_setDisabledAttr:function(_18){
this._set("disabled",_18);
this.updateState();
},_getAttrNames:function(_19){
var apn=this._attrPairNames;
if(apn[_19]){
return apn[_19];
}
var uc=_19.charAt(0).toUpperCase()+_19.substr(1);
return (apn[_19]={s:"_set"+uc+"Attr",g:"_get"+uc+"Attr"});
},_set:function(_1a,_1b){
this[_1a]=_1b;
}});
_6.registry={};
return _6;
});


;define("dijit/_editor/range",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(_1,_2,_3){
var _4={getIndex:function(_5,_6){
var _7=[],_8=[];
var _9=_5;
var _a,n;
while(_5!=_6){
var i=0;
_a=_5.parentNode;
while((n=_a.childNodes[i++])){
if(n===_5){
--i;
break;
}
}
_7.unshift(i);
_8.unshift(i-_a.childNodes.length);
_5=_a;
}
if(_7.length>0&&_9.nodeType==3){
n=_9.previousSibling;
while(n&&n.nodeType==3){
_7[_7.length-1]--;
n=n.previousSibling;
}
n=_9.nextSibling;
while(n&&n.nodeType==3){
_8[_8.length-1]++;
n=n.nextSibling;
}
}
return {o:_7,r:_8};
},getNode:function(_b,_c){
if(!_3.isArray(_b)||_b.length==0){
return _c;
}
var _d=_c;
_1.every(_b,function(i){
if(i>=0&&i<_d.childNodes.length){
_d=_d.childNodes[i];
}else{
_d=null;
return false;
}
return true;
});
return _d;
},getCommonAncestor:function(n1,n2,_e){
_e=_e||n1.ownerDocument.body;
var _f=function(n){
var as=[];
while(n){
as.unshift(n);
if(n!==_e){
n=n.parentNode;
}else{
break;
}
}
return as;
};
var _10=_f(n1);
var _11=_f(n2);
var m=Math.min(_10.length,_11.length);
var com=_10[0];
for(var i=1;i<m;i++){
if(_10[i]===_11[i]){
com=_10[i];
}else{
break;
}
}
return com;
},getAncestor:function(_12,_13,_14){
_14=_14||_12.ownerDocument.body;
while(_12&&_12!==_14){
var _15=_12.nodeName.toUpperCase();
if(_13.test(_15)){
return _12;
}
_12=_12.parentNode;
}
return null;
},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(_16,_17,_18){
_18=_18||_16.ownerDocument.body;
_17=_17||_4.BlockTagNames;
var _19=null,_1a;
while(_16&&_16!==_18){
var _1b=_16.nodeName.toUpperCase();
if(!_19&&_17.test(_1b)){
_19=_16;
}
if(!_1a&&(/^(?:BODY|TD|TH|CAPTION)$/).test(_1b)){
_1a=_16;
}
_16=_16.parentNode;
}
return {blockNode:_19,blockContainer:_1a||_16.ownerDocument.body};
},atBeginningOfContainer:function(_1c,_1d,_1e){
var _1f=false;
var _20=(_1e==0);
if(!_20&&_1d.nodeType==3){
if(/^[\s\xA0]+$/.test(_1d.nodeValue.substr(0,_1e))){
_20=true;
}
}
if(_20){
var _21=_1d;
_1f=true;
while(_21&&_21!==_1c){
if(_21.previousSibling){
_1f=false;
break;
}
_21=_21.parentNode;
}
}
return _1f;
},atEndOfContainer:function(_22,_23,_24){
var _25=false;
var _26=(_24==(_23.length||_23.childNodes.length));
if(!_26&&_23.nodeType==3){
if(/^[\s\xA0]+$/.test(_23.nodeValue.substr(_24))){
_26=true;
}
}
if(_26){
var _27=_23;
_25=true;
while(_27&&_27!==_22){
if(_27.nextSibling){
_25=false;
break;
}
_27=_27.parentNode;
}
}
return _25;
},adjacentNoneTextNode:function(_28,_29){
var _2a=_28;
var len=(0-_28.length)||0;
var _2b=_29?"nextSibling":"previousSibling";
while(_2a){
if(_2a.nodeType!=3){
break;
}
len+=_2a.length;
_2a=_2a[_2b];
}
return [_2a,len];
},create:function(win){
win=win||window;
if(win.getSelection){
return win.document.createRange();
}else{
return new _2c();
}
},getSelection:function(_2d,_2e){
if(_2d.getSelection){
return _2d.getSelection();
}else{
var s=new ie.selection(_2d);
if(!_2e){
s._getCurrentSelection();
}
return s;
}
}};
if(!window.getSelection){
var ie=_4.ie={cachedSelection:{},selection:function(_2f){
this._ranges=[];
this.addRange=function(r,_30){
this._ranges.push(r);
if(!_30){
r._select();
}
this.rangeCount=this._ranges.length;
};
this.removeAllRanges=function(){
this._ranges=[];
this.rangeCount=0;
};
var _31=function(){
var r=_2f.document.selection.createRange();
var _32=_2f.document.selection.type.toUpperCase();
if(_32=="CONTROL"){
return new _2c(ie.decomposeControlRange(r));
}else{
return new _2c(ie.decomposeTextRange(r));
}
};
this.getRangeAt=function(i){
return this._ranges[i];
};
this._getCurrentSelection=function(){
this.removeAllRanges();
var r=_31();
if(r){
this.addRange(r,true);
this.isCollapsed=r.collapsed;
}else{
this.isCollapsed=true;
}
};
},decomposeControlRange:function(_33){
var _34=_33.item(0),_35=_33.item(_33.length-1);
var _36=_34.parentNode,_37=_35.parentNode;
var _38=_4.getIndex(_34,_36).o[0];
var _39=_4.getIndex(_35,_37).o[0]+1;
return [_36,_38,_37,_39];
},getEndPoint:function(_3a,end){
var _3b=_3a.duplicate();
_3b.collapse(!end);
var _3c="EndTo"+(end?"End":"Start");
var _3d=_3b.parentElement();
var _3e,_3f,_40;
if(_3d.childNodes.length>0){
_1.every(_3d.childNodes,function(_41,i){
var _42;
if(_41.nodeType!=3){
_3b.moveToElementText(_41);
if(_3b.compareEndPoints(_3c,_3a)>0){
if(_40&&_40.nodeType==3){
_3e=_40;
_42=true;
}else{
_3e=_3d;
_3f=i;
return false;
}
}else{
if(i==_3d.childNodes.length-1){
_3e=_3d;
_3f=_3d.childNodes.length;
return false;
}
}
}else{
if(i==_3d.childNodes.length-1){
_3e=_41;
_42=true;
}
}
if(_42&&_3e){
var _43=_4.adjacentNoneTextNode(_3e)[0];
if(_43){
_3e=_43.nextSibling;
}else{
_3e=_3d.firstChild;
}
var _44=_4.adjacentNoneTextNode(_3e);
_43=_44[0];
var _45=_44[1];
if(_43){
_3b.moveToElementText(_43);
_3b.collapse(false);
}else{
_3b.moveToElementText(_3d);
}
_3b.setEndPoint(_3c,_3a);
_3f=_3b.text.length-_45;
return false;
}
_40=_41;
return true;
});
}else{
_3e=_3d;
_3f=0;
}
if(!end&&_3e.nodeType==1&&_3f==_3e.childNodes.length){
var _46=_3e.nextSibling;
if(_46&&_46.nodeType==3){
_3e=_46;
_3f=0;
}
}
return [_3e,_3f];
},setEndPoint:function(_47,_48,_49){
var _4a=_47.duplicate(),_4b,len;
if(_48.nodeType!=3){
if(_49>0){
_4b=_48.childNodes[_49-1];
if(_4b){
if(_4b.nodeType==3){
_48=_4b;
_49=_4b.length;
}else{
if(_4b.nextSibling&&_4b.nextSibling.nodeType==3){
_48=_4b.nextSibling;
_49=0;
}else{
_4a.moveToElementText(_4b.nextSibling?_4b:_48);
var _4c=_4b.parentNode;
var _4d=_4c.insertBefore(_4b.ownerDocument.createTextNode(" "),_4b.nextSibling);
_4a.collapse(false);
_4c.removeChild(_4d);
}
}
}
}else{
_4a.moveToElementText(_48);
_4a.collapse(true);
}
}
if(_48.nodeType==3){
var _4e=_4.adjacentNoneTextNode(_48);
var _4f=_4e[0];
len=_4e[1];
if(_4f){
_4a.moveToElementText(_4f);
_4a.collapse(false);
if(_4f.contentEditable!="inherit"){
len++;
}
}else{
_4a.moveToElementText(_48.parentNode);
_4a.collapse(true);
_4a.move("character",1);
_4a.move("character",-1);
}
_49+=len;
if(_49>0){
if(_4a.move("character",_49)!=_49){
console.error("Error when moving!");
}
}
}
return _4a;
},decomposeTextRange:function(_50){
var _51=ie.getEndPoint(_50);
var _52=_51[0],_53=_51[1];
var _54=_51[0],_55=_51[1];
if(_50.htmlText.length){
if(_50.htmlText==_50.text){
_55=_53+_50.text.length;
}else{
_51=ie.getEndPoint(_50,true);
_54=_51[0],_55=_51[1];
}
}
return [_52,_53,_54,_55];
},setRange:function(_56,_57,_58,_59,_5a,_5b){
var _5c=ie.setEndPoint(_56,_57,_58);
_56.setEndPoint("StartToStart",_5c);
if(!_5b){
var end=ie.setEndPoint(_56,_59,_5a);
}
_56.setEndPoint("EndToEnd",end||_5c);
return _56;
}};
var _2c=_4.W3CRange=_2(null,{constructor:function(){
if(arguments.length>0){
this.setStart(arguments[0][0],arguments[0][1]);
this.setEnd(arguments[0][2],arguments[0][3]);
}else{
this.commonAncestorContainer=null;
this.startContainer=null;
this.startOffset=0;
this.endContainer=null;
this.endOffset=0;
this.collapsed=true;
}
},_updateInternal:function(){
if(this.startContainer!==this.endContainer){
this.commonAncestorContainer=_4.getCommonAncestor(this.startContainer,this.endContainer);
}else{
this.commonAncestorContainer=this.startContainer;
}
this.collapsed=(this.startContainer===this.endContainer)&&(this.startOffset==this.endOffset);
},setStart:function(_5d,_5e){
_5e=parseInt(_5e);
if(this.startContainer===_5d&&this.startOffset==_5e){
return;
}
delete this._cachedBookmark;
this.startContainer=_5d;
this.startOffset=_5e;
if(!this.endContainer){
this.setEnd(_5d,_5e);
}else{
this._updateInternal();
}
},setEnd:function(_5f,_60){
_60=parseInt(_60);
if(this.endContainer===_5f&&this.endOffset==_60){
return;
}
delete this._cachedBookmark;
this.endContainer=_5f;
this.endOffset=_60;
if(!this.startContainer){
this.setStart(_5f,_60);
}else{
this._updateInternal();
}
},setStartAfter:function(_61,_62){
this._setPoint("setStart",_61,_62,1);
},setStartBefore:function(_63,_64){
this._setPoint("setStart",_63,_64,0);
},setEndAfter:function(_65,_66){
this._setPoint("setEnd",_65,_66,1);
},setEndBefore:function(_67,_68){
this._setPoint("setEnd",_67,_68,0);
},_setPoint:function(_69,_6a,_6b,ext){
var _6c=_4.getIndex(_6a,_6a.parentNode).o;
this[_69](_6a.parentNode,_6c.pop()+ext);
},_getIERange:function(){
var r=(this._body||this.endContainer.ownerDocument.body).createTextRange();
ie.setRange(r,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);
return r;
},getBookmark:function(){
this._getIERange();
return this._cachedBookmark;
},_select:function(){
var r=this._getIERange();
r.select();
},deleteContents:function(){
var s=this.startContainer,r=this._getIERange();
if(s.nodeType===3&&!this.startOffset){
this.setStartBefore(s);
}
r.pasteHTML("");
this.endContainer=this.startContainer;
this.endOffset=this.startOffset;
this.collapsed=true;
},cloneRange:function(){
var r=new _2c([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);
r._body=this._body;
return r;
},detach:function(){
this._body=null;
this.commonAncestorContainer=null;
this.startContainer=null;
this.startOffset=0;
this.endContainer=null;
this.endOffset=0;
this.collapsed=true;
}});
}
_3.setObject("dijit.range",_4);
return _4;
});


;define("dijit/_editor/html",["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(_1,_2,_3){
var _4={};
_2.setObject("dijit._editor.html",_4);
var _5=_4.escapeXml=function(_6,_7){
_6=_6.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");
if(!_7){
_6=_6.replace(/'/gm,"&#39;");
}
return _6;
};
_4.getNodeHtml=function(_8){
var _9=[];
_4.getNodeHtmlHelper(_8,_9);
return _9.join("");
};
_4.getNodeHtmlHelper=function(_a,_b){
switch(_a.nodeType){
case 1:
var _c=_a.nodeName.toLowerCase();
if(!_c||_c.charAt(0)=="/"){
return "";
}
_b.push("<",_c);
var _d=[],_e={};
var _f;
if(_3("dom-attributes-explicit")||_3("dom-attributes-specified-flag")){
var i=0;
while((_f=_a.attributes[i++])){
var n=_f.name;
if(n.substr(0,3)!=="_dj"&&(!_3("dom-attributes-specified-flag")||_f.specified)&&!(n in _e)){
var v=_f.value;
if(n=="src"||n=="href"){
if(_a.getAttribute("_djrealurl")){
v=_a.getAttribute("_djrealurl");
}
}
if(_3("ie")===8&&n==="style"){
v=v.replace("HEIGHT:","height:").replace("WIDTH:","width:");
}
_d.push([n,v]);
_e[n]=v;
}
}
}else{
var _10=/^input$|^img$/i.test(_a.nodeName)?_a:_a.cloneNode(false);
var s=_10.outerHTML;
var _11=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;
var _12=s.match(_11);
s=s.substr(0,s.indexOf(">"));
_1.forEach(_12,function(_13){
if(_13){
var idx=_13.indexOf("=");
if(idx>0){
var key=_13.substring(0,idx);
if(key.substr(0,3)!="_dj"){
if(key=="src"||key=="href"){
if(_a.getAttribute("_djrealurl")){
_d.push([key,_a.getAttribute("_djrealurl")]);
return;
}
}
var val,_14;
switch(key){
case "style":
val=_a.style.cssText.toLowerCase();
break;
case "class":
val=_a.className;
break;
case "width":
if(_c==="img"){
_14=/width=(\S+)/i.exec(s);
if(_14){
val=_14[1];
}
break;
}
case "height":
if(_c==="img"){
_14=/height=(\S+)/i.exec(s);
if(_14){
val=_14[1];
}
break;
}
default:
val=_a.getAttribute(key);
}
if(val!=null){
_d.push([key,val.toString()]);
}
}
}
}
},this);
}
_d.sort(function(a,b){
return a[0]<b[0]?-1:(a[0]==b[0]?0:1);
});
var j=0;
while((_f=_d[j++])){
_b.push(" ",_f[0],"=\"",(typeof _f[1]==="string"?_5(_f[1],true):_f[1]),"\"");
}
switch(_c){
case "br":
case "hr":
case "img":
case "input":
case "base":
case "meta":
case "area":
case "basefont":
_b.push(" />");
break;
case "script":
_b.push(">",_a.innerHTML,"</",_c,">");
break;
default:
_b.push(">");
if(_a.hasChildNodes()){
_4.getChildrenHtmlHelper(_a,_b);
}
_b.push("</",_c,">");
}
break;
case 4:
case 3:
_b.push(_5(_a.nodeValue,true));
break;
case 8:
_b.push("<!--",_5(_a.nodeValue,true),"-->");
break;
default:
_b.push("<!-- Element not recognized - Type: ",_a.nodeType," Name: ",_a.nodeName,"-->");
}
};
_4.getChildrenHtml=function(_15){
var _16=[];
_4.getChildrenHtmlHelper(_15,_16);
return _16.join("");
};
_4.getChildrenHtmlHelper=function(dom,_17){
if(!dom){
return;
}
var _18=dom["childNodes"]||dom;
var _19=!_3("ie")||_18!==dom;
var _1a,i=0;
while((_1a=_18[i++])){
if(!_19||_1a.parentNode==dom){
_4.getNodeHtmlHelper(_1a,_17);
}
}
};
return _4;
});


;define("dijit/_editor/RichText",["dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/query","dojo/domReady","dojo/sniff","dojo/topic","dojo/_base/unload","dojo/_base/url","dojo/window","../_Widget","../_CssStateMixin","../selection","./range","./html","../focus","../main"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,on,_e,_f,has,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,_1a){
var _1b=_3("dijit._editor.RichText",[_14,_15],{constructor:function(_1c){
this.contentPreFilters=[];
this.contentPostFilters=[];
this.contentDomPreFilters=[];
this.contentDomPostFilters=[];
this.editingAreaStyleSheets=[];
this.events=[].concat(this.events);
this._keyHandlers={};
if(_1c&&_d.isString(_1c.value)){
this.value=_1c.value;
}
this.onLoadDeferred=new _4();
},baseClass:"dijitEditor",inheritWidth:false,focusOnLoad:false,name:"",styleSheets:"",height:"300px",minHeight:"1em",isClosed:true,isLoaded:false,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:false,disableSpellCheck:false,postCreate:function(){
if("textarea"===this.domNode.tagName.toLowerCase()){
console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");
}
this.contentPreFilters=[_d.trim,_d.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);
if(has("mozilla")){
this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters);
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters);
}
if(has("webkit")){
this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters);
this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters);
}
if(has("ie")||has("trident")){
this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters);
this.contentDomPostFilters=[_d.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);
}
this.contentDomPostFilters=[_d.hitch(this,"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);
this.inherited(arguments);
_10.publish(_1a._scopeName+"._editor.RichText::init",this);
},startup:function(){
this.inherited(arguments);
this.open();
this.setupDefaultShortcuts();
},setupDefaultShortcuts:function(){
var _1d=_d.hitch(this,function(cmd,arg){
return function(){
return !this.execCommand(cmd,arg);
};
});
var _1e={b:_1d("bold"),i:_1d("italic"),u:_1d("underline"),a:_1d("selectall"),s:function(){
this.save(true);
},m:function(){
this.isTabIndent=!this.isTabIndent;
},"1":_1d("formatblock","h1"),"2":_1d("formatblock","h2"),"3":_1d("formatblock","h3"),"4":_1d("formatblock","h4"),"\\":_1d("insertunorderedlist")};
if(!has("ie")){
_1e.Z=_1d("redo");
}
var key;
for(key in _1e){
this.addKeyHandler(key,true,false,_1e[key]);
}
},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:false,_localizeEditorCommands:function(){
if(_1b._editorCommandsLocalized){
this._local2NativeFormatNames=_1b._local2NativeFormatNames;
this._native2LocalFormatNames=_1b._native2LocalFormatNames;
return;
}
_1b._editorCommandsLocalized=true;
_1b._local2NativeFormatNames={};
_1b._native2LocalFormatNames={};
this._local2NativeFormatNames=_1b._local2NativeFormatNames;
this._native2LocalFormatNames=_1b._native2LocalFormatNames;
var _1f=["div","p","pre","h1","h2","h3","h4","h5","h6","ol","ul","address"];
var _20="",_21,i=0;
while((_21=_1f[i++])){
if(_21.charAt(1)!=="l"){
_20+="<"+_21+"><span>content</span></"+_21+"><br/>";
}else{
_20+="<"+_21+"><li>content</li></"+_21+"><br/>";
}
}
var _22={position:"absolute",top:"0px",zIndex:10,opacity:0.01};
var div=_8.create("div",{style:_22,innerHTML:_20});
this.ownerDocumentBody.appendChild(div);
var _23=_d.hitch(this,function(){
var _24=div.firstChild;
while(_24){
try{
this.selection.selectElement(_24.firstChild);
var _25=_24.tagName.toLowerCase();
this._local2NativeFormatNames[_25]=document.queryCommandValue("formatblock");
this._native2LocalFormatNames[this._local2NativeFormatNames[_25]]=_25;
_24=_24.nextSibling.nextSibling;
}
catch(e){
}
}
_8.destroy(div);
});
this.defer(_23);
},open:function(_26){
if(!this.onLoadDeferred||this.onLoadDeferred.fired>=0){
this.onLoadDeferred=new _4();
}
if(!this.isClosed){
this.close();
}
_10.publish(_1a._scopeName+"._editor.RichText::open",this);
if(arguments.length===1&&_26.nodeName){
this.domNode=_26;
}
var dn=this.domNode;
var _27;
if(_d.isString(this.value)){
_27=this.value;
dn.innerHTML="";
}else{
if(dn.nodeName&&dn.nodeName.toLowerCase()=="textarea"){
var ta=(this.textarea=dn);
this.name=ta.name;
_27=ta.value;
dn=this.domNode=this.ownerDocument.createElement("div");
dn.setAttribute("widgetId",this.id);
ta.removeAttribute("widgetId");
dn.cssText=ta.cssText;
dn.className+=" "+ta.className;
_8.place(dn,ta,"before");
var _28=_d.hitch(this,function(){
_a.set(ta,{display:"block",position:"absolute",top:"-1000px"});
if(has("ie")){
var s=ta.style;
this.__overflow=s.overflow;
s.overflow="hidden";
}
});
if(has("ie")){
this.defer(_28,10);
}else{
_28();
}
if(ta.form){
var _29=ta.value;
this.reset=function(){
var _2a=this.getValue();
if(_2a!==_29){
this.replaceValue(_29);
}
};
on(ta.form,"submit",_d.hitch(this,function(){
_6.set(ta,"disabled",this.disabled);
ta.value=this.getValue();
}));
}
}else{
_27=_18.getChildrenHtml(dn);
dn.innerHTML="";
}
}
this.value=_27;
if(dn.nodeName&&dn.nodeName==="LI"){
dn.innerHTML=" <br>";
}
this.header=dn.ownerDocument.createElement("div");
dn.appendChild(this.header);
this.editingArea=dn.ownerDocument.createElement("div");
dn.appendChild(this.editingArea);
this.footer=dn.ownerDocument.createElement("div");
dn.appendChild(this.footer);
if(!this.name){
this.name=this.id+"_AUTOGEN";
}
if(this.name!==""&&(!_2["useXDomain"]||_2["allowXdRichTextSave"])){
var _2b=_5.byId(_1a._scopeName+"._editor.RichText.value");
if(_2b&&_2b.value!==""){
var _2c=_2b.value.split(this._SEPARATOR),i=0,dat;
while((dat=_2c[i++])){
var _2d=dat.split(this._NAME_CONTENT_SEP);
if(_2d[0]===this.name){
this.value=_2d[1];
_2c=_2c.splice(i,1);
_2b.value=_2c.join(this._SEPARATOR);
break;
}
}
}
if(!_1b._globalSaveHandler){
_1b._globalSaveHandler={};
_11.addOnUnload(function(){
var id;
for(id in _1b._globalSaveHandler){
var f=_1b._globalSaveHandler[id];
if(_d.isFunction(f)){
f();
}
}
});
}
_1b._globalSaveHandler[this.id]=_d.hitch(this,"_saveContent");
}
this.isClosed=false;
var ifr=(this.editorObject=this.iframe=this.ownerDocument.createElement("iframe"));
ifr.id=this.id+"_iframe";
ifr.style.border="none";
ifr.style.width="100%";
if(this._layoutMode){
ifr.style.height="100%";
}else{
if(has("ie")>=7){
if(this.height){
ifr.style.height=this.height;
}
if(this.minHeight){
ifr.style.minHeight=this.minHeight;
}
}else{
ifr.style.height=this.height?this.height:this.minHeight;
}
}
ifr.frameBorder=0;
ifr._loadFunc=_d.hitch(this,function(w){
this.window=w;
this.document=w.document;
this.selection=new _16.SelectionManager(w);
if(has("ie")){
this._localizeEditorCommands();
}
this.onLoad(this.get("value"));
});
var src=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'"),s;
if(has("ie")<11){
s="javascript:document.open();try{parent.window;}catch(e){document.domain=\""+document.domain+"\";}"+"document.write('"+src+"');document.close()";
}else{
s="javascript: '"+src+"'";
}
if(has("ie")==9){
this.editingArea.appendChild(ifr);
ifr.src=s;
}else{
ifr.setAttribute("src",s);
this.editingArea.appendChild(ifr);
}
if(dn.nodeName==="LI"){
dn.lastChild.style.marginTop="-1.2em";
}
_7.add(this.domNode,this.baseClass);
},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){
var _2e=_a.getComputedStyle(this.domNode);
var _2f="<div id='dijitEditorBody'></div>";
var _30=[_2e.fontWeight,_2e.fontSize,_2e.fontFamily].join(" ");
var _31=_2e.lineHeight;
if(_31.indexOf("px")>=0){
_31=parseFloat(_31)/parseFloat(_2e.fontSize);
}else{
if(_31.indexOf("em")>=0){
_31=parseFloat(_31);
}else{
_31="normal";
}
}
var _32="";
var _33=this;
this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(_34){
_34=_34.replace(/^;/ig,"")+";";
var s=_34.split(":")[0];
if(s){
s=_d.trim(s);
s=s.toLowerCase();
var i;
var sC="";
for(i=0;i<s.length;i++){
var c=s.charAt(i);
switch(c){
case "-":
i++;
c=s.charAt(i).toUpperCase();
default:
sC+=c;
}
}
_a.set(_33.domNode,sC,"");
}
_32+=_34+";";
});
var _35=_e("label[for=\""+this.id+"\"]");
var _36="";
if(_35.length){
_36=_35[0].innerHTML;
}else{
if(this["aria-label"]){
_36=this["aria-label"];
}else{
if(this["aria-labelledby"]){
_36=_5.byId(this["aria-labelledby"]).innerHTML;
}
}
}
this.iframe.setAttribute("title",_36);
return ["<!DOCTYPE html>",this.isLeftToRight()?"<html lang='"+this.lang+"'>\n<head>\n":"<html dir='rtl' lang='"+this.lang+"'>\n<head>\n",_36?"<title>"+_36+"</title>":"","<meta http-equiv='Content-Type' content='text/html'>\n","<style>\n","\tbody,html {\n","\t\tbackground:transparent;\n","\t\tpadding: 1px 0 0 0;\n","\t\tmargin: -1px 0 0 0;\n","\t}\n","\tbody,html,#dijitEditorBody { outline: none; }","html { height: 100%; width: 100%; overflow: hidden; }\n",this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n","\t\ttop:0px;\n","\t\tleft:0px;\n","\t\tright:0px;\n","\t\tfont:",_30,";\n",((this.height||has("opera"))?"":"\t\tposition: fixed;\n"),"\t\tline-height:",_31,";\n","\t}\n","\tp{ margin: 1em 0; }\n","\tli > ul:-moz-first-node, li > ol:-moz-first-node{ padding-top: 1.2em; }\n",(has("ie")||has("trident")?"":"\tli{ min-height:1.2em; }\n"),"</style>\n",this._applyEditingAreaStyleSheets(),"\n","</head>\n<body role='main' ","onload='try{frameElement && frameElement._loadFunc(window,document)}catch(e){document.domain=\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style='"+_32+"'>",_2f,"</body>\n</html>"].join("");
},_applyEditingAreaStyleSheets:function(){
var _37=[];
if(this.styleSheets){
_37=this.styleSheets.split(";");
this.styleSheets="";
}
_37=_37.concat(this.editingAreaStyleSheets);
this.editingAreaStyleSheets=[];
var _38="",i=0,url,_39=_13.get(this.ownerDocument);
while((url=_37[i++])){
var _3a=(new _12(_39.location,url)).toString();
this.editingAreaStyleSheets.push(_3a);
_38+="<link rel=\"stylesheet\" type=\"text/css\" href=\""+_3a+"\"/>";
}
return _38;
},addStyleSheet:function(uri){
var url=uri.toString(),_3b=_13.get(this.ownerDocument);
if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){
url=(new _12(_3b.location,url)).toString();
}
if(_1.indexOf(this.editingAreaStyleSheets,url)>-1){
return;
}
this.editingAreaStyleSheets.push(url);
this.onLoadDeferred.then(_d.hitch(this,function(){
if(this.document.createStyleSheet){
this.document.createStyleSheet(url);
}else{
var _3c=this.document.getElementsByTagName("head")[0];
var _3d=this.document.createElement("link");
_3d.rel="stylesheet";
_3d.type="text/css";
_3d.href=url;
_3c.appendChild(_3d);
}
}));
},removeStyleSheet:function(uri){
var url=uri.toString(),_3e=_13.get(this.ownerDocument);
if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){
url=(new _12(_3e.location,url)).toString();
}
var _3f=_1.indexOf(this.editingAreaStyleSheets,url);
if(_3f===-1){
return;
}
delete this.editingAreaStyleSheets[_3f];
_e("link[href=\""+url+"\"]",this.window.document).orphan();
},disabled:false,_mozSettingProps:{"styleWithCSS":false},_setDisabledAttr:function(_40){
_40=!!_40;
this._set("disabled",_40);
if(!this.isLoaded){
return;
}
var _41=has("ie")&&(this.isLoaded||!this.focusOnLoad);
if(_41){
this.editNode.unselectable="on";
}
this.editNode.contentEditable=!_40;
this.editNode.tabIndex=_40?"-1":this.tabIndex;
if(_41){
this.defer(function(){
if(this.editNode){
this.editNode.unselectable="off";
}
});
}
if(has("mozilla")&&!_40&&this._mozSettingProps){
var ps=this._mozSettingProps;
var n;
for(n in ps){
if(ps.hasOwnProperty(n)){
try{
this.document.execCommand(n,false,ps[n]);
}
catch(e2){
}
}
}
}
this._disabledOK=true;
},onLoad:function(_42){
if(!this.window.__registeredWindow){
this.window.__registeredWindow=true;
this._iframeRegHandle=_19.registerIframe(this.iframe);
}
this.editNode=this.document.body.firstChild;
var _43=this;
this.beforeIframeNode=_8.place("<div tabIndex=-1></div>",this.iframe,"before");
this.afterIframeNode=_8.place("<div tabIndex=-1></div>",this.iframe,"after");
this.iframe.onfocus=this.document.onfocus=function(){
_43.editNode.focus();
};
this.focusNode=this.editNode;
var _44=this.events.concat(this.captureEvents);
var ap=this.iframe?this.document:this.editNode;
this.own.apply(this,_1.map(_44,function(_45){
var _46=_45.toLowerCase().replace(/^on/,"");
return on(ap,_46,_d.hitch(this,_45));
},this));
this.own(on(ap,"mouseup",_d.hitch(this,"onClick")));
if(has("ie")){
this.own(on(this.document,"mousedown",_d.hitch(this,"_onIEMouseDown")));
this.editNode.style.zoom=1;
}
if(has("webkit")){
this._webkitListener=this.own(on(this.document,"mouseup",_d.hitch(this,"onDisplayChanged")))[0];
this.own(on(this.document,"mousedown",_d.hitch(this,function(e){
var t=e.target;
if(t&&(t===this.document.body||t===this.document)){
this.defer("placeCursorAtEnd");
}
})));
}
if(has("ie")){
try{
this.document.execCommand("RespectVisibilityInDesign",true,null);
}
catch(e){
}
}
this.isLoaded=true;
this.set("disabled",this.disabled);
var _47=_d.hitch(this,function(){
this.setValue(_42);
if(this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()){
this.onLoadDeferred.resolve(true);
}
this.onDisplayChanged();
if(this.focusOnLoad){
_f(_d.hitch(this,"defer","focus",this.updateInterval));
}
this.value=this.getValue(true);
});
if(this.setValueDeferred){
this.setValueDeferred.then(_47);
}else{
_47();
}
},onKeyDown:function(e){
if(e.keyCode===_c.SHIFT||e.keyCode===_c.ALT||e.keyCode===_c.META||e.keyCode===_c.CTRL){
return true;
}
if(e.keyCode===_c.TAB&&this.isTabIndent){
e.stopPropagation();
e.preventDefault();
if(this.queryCommandEnabled((e.shiftKey?"outdent":"indent"))){
this.execCommand((e.shiftKey?"outdent":"indent"));
}
}
if(e.keyCode==_c.TAB&&!this.isTabIndent&&!e.ctrlKey&&!e.altKey){
if(e.shiftKey){
this.beforeIframeNode.focus();
}else{
this.afterIframeNode.focus();
}
return true;
}
if(has("ie")<9&&e.keyCode===_c.BACKSPACE&&this.document.selection.type==="Control"){
e.stopPropagation();
e.preventDefault();
this.execCommand("delete");
}
if(has("ff")){
if(e.keyCode===_c.PAGE_UP||e.keyCode===_c.PAGE_DOWN){
if(this.editNode.clientHeight>=this.editNode.scrollHeight){
e.preventDefault();
}
}
}
var _48=this._keyHandlers[e.keyCode],_49=arguments;
if(_48&&!e.altKey){
_1.some(_48,function(h){
if(!(h.shift^e.shiftKey)&&!(h.ctrl^(e.ctrlKey||e.metaKey))){
if(!h.handler.apply(this,_49)){
e.preventDefault();
}
return true;
}
},this);
}
this.defer("onKeyPressed",1);
return true;
},onKeyUp:function(){
},setDisabled:function(_4a){
_b.deprecated("dijit.Editor::setDisabled is deprecated","use dijit.Editor::attr(\"disabled\",boolean) instead",2);
this.set("disabled",_4a);
},_setValueAttr:function(_4b){
this.setValue(_4b);
},_setDisableSpellCheckAttr:function(_4c){
if(this.document){
_6.set(this.document.body,"spellcheck",!_4c);
}else{
this.onLoadDeferred.then(_d.hitch(this,function(){
_6.set(this.document.body,"spellcheck",!_4c);
}));
}
this._set("disableSpellCheck",_4c);
},addKeyHandler:function(key,_4d,_4e,_4f){
if(typeof key=="string"){
key=key.toUpperCase().charCodeAt(0);
}
if(!_d.isArray(this._keyHandlers[key])){
this._keyHandlers[key]=[];
}
this._keyHandlers[key].push({shift:_4e||false,ctrl:_4d||false,handler:_4f});
},onKeyPressed:function(){
this.onDisplayChanged();
},onClick:function(e){
this.onDisplayChanged(e);
},_onIEMouseDown:function(){
if(!this.focused&&!this.disabled){
this.focus();
}
},_onBlur:function(e){
if(has("ie")||has("trident")){
this.defer(function(){
if(!_19.curNode){
this.ownerDocumentBody.focus();
}
});
}
this.inherited(arguments);
var _50=this.getValue(true);
if(_50!==this.value){
this.onChange(_50);
}
this._set("value",_50);
},_onFocus:function(e){
if(!this.disabled){
if(!this._disabledOK){
this.set("disabled",false);
}
this.inherited(arguments);
}
},blur:function(){
if(!has("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus){
this.window.document.documentElement.focus();
}else{
if(this.ownerDocumentBody.focus){
this.ownerDocumentBody.focus();
}
}
},focus:function(){
if(!this.isLoaded){
this.focusOnLoad=true;
return;
}
if(has("ie")<9){
this.iframe.fireEvent("onfocus",document.createEventObject());
}else{
this.editNode.focus();
}
},updateInterval:200,_updateTimer:null,onDisplayChanged:function(){
if(this._updateTimer){
this._updateTimer.remove();
}
this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval);
},onNormalizedDisplayChanged:function(){
delete this._updateTimer;
},onChange:function(){
},_normalizeCommand:function(cmd,_51){
var _52=cmd.toLowerCase();
if(_52==="formatblock"){
if(has("safari")&&_51===undefined){
_52="heading";
}
}else{
if(_52==="hilitecolor"&&!has("mozilla")){
_52="backcolor";
}
}
return _52;
},_qcaCache:{},queryCommandAvailable:function(_53){
var ca=this._qcaCache[_53];
if(ca!==undefined){
return ca;
}
return (this._qcaCache[_53]=this._queryCommandAvailable(_53));
},_queryCommandAvailable:function(_54){
var ie=1;
var _55=1<<1;
var _56=1<<2;
var _57=1<<3;
function _58(_59){
return {ie:Boolean(_59&ie),mozilla:Boolean(_59&_55),webkit:Boolean(_59&_56),opera:Boolean(_59&_57)};
};
var _5a=null;
switch(_54.toLowerCase()){
case "bold":
case "italic":
case "underline":
case "subscript":
case "superscript":
case "fontname":
case "fontsize":
case "forecolor":
case "hilitecolor":
case "justifycenter":
case "justifyfull":
case "justifyleft":
case "justifyright":
case "delete":
case "selectall":
case "toggledir":
_5a=_58(_55|ie|_56|_57);
break;
case "createlink":
case "unlink":
case "removeformat":
case "inserthorizontalrule":
case "insertimage":
case "insertorderedlist":
case "insertunorderedlist":
case "indent":
case "outdent":
case "formatblock":
case "inserthtml":
case "undo":
case "redo":
case "strikethrough":
case "tabindent":
_5a=_58(_55|ie|_57|_56);
break;
case "blockdirltr":
case "blockdirrtl":
case "dirltr":
case "dirrtl":
case "inlinedirltr":
case "inlinedirrtl":
_5a=_58(ie);
break;
case "cut":
case "copy":
case "paste":
_5a=_58(ie|_55|_56|_57);
break;
case "inserttable":
_5a=_58(_55|ie);
break;
case "insertcell":
case "insertcol":
case "insertrow":
case "deletecells":
case "deletecols":
case "deleterows":
case "mergecells":
case "splitcell":
_5a=_58(ie|_55);
break;
default:
return false;
}
return ((has("ie")||has("trident"))&&_5a.ie)||(has("mozilla")&&_5a.mozilla)||(has("webkit")&&_5a.webkit)||(has("opera")&&_5a.opera);
},execCommand:function(_5b,_5c){
var _5d;
if(this.focused){
this.focus();
}
_5b=this._normalizeCommand(_5b,_5c);
if(_5c!==undefined){
if(_5b==="heading"){
throw new Error("unimplemented");
}else{
if(_5b==="formatblock"&&(has("ie")||has("trident"))){
_5c="<"+_5c+">";
}
}
}
var _5e="_"+_5b+"Impl";
if(this[_5e]){
_5d=this[_5e](_5c);
}else{
_5c=arguments.length>1?_5c:null;
if(_5c||_5b!=="createlink"){
_5d=this.document.execCommand(_5b,false,_5c);
}
}
this.onDisplayChanged();
return _5d;
},queryCommandEnabled:function(_5f){
if(this.disabled||!this._disabledOK){
return false;
}
_5f=this._normalizeCommand(_5f);
var _60="_"+_5f+"EnabledImpl";
if(this[_60]){
return this[_60](_5f);
}else{
return this._browserQueryCommandEnabled(_5f);
}
},queryCommandState:function(_61){
if(this.disabled||!this._disabledOK){
return false;
}
_61=this._normalizeCommand(_61);
try{
return this.document.queryCommandState(_61);
}
catch(e){
return false;
}
},queryCommandValue:function(_62){
if(this.disabled||!this._disabledOK){
return false;
}
var r;
_62=this._normalizeCommand(_62);
if((has("ie")||has("trident"))&&_62==="formatblock"){
r=this._native2LocalFormatNames[this.document.queryCommandValue(_62)];
}else{
if(has("mozilla")&&_62==="hilitecolor"){
var _63;
try{
_63=this.document.queryCommandValue("styleWithCSS");
}
catch(e){
_63=false;
}
this.document.execCommand("styleWithCSS",false,true);
r=this.document.queryCommandValue(_62);
this.document.execCommand("styleWithCSS",false,_63);
}else{
r=this.document.queryCommandValue(_62);
}
}
return r;
},_sCall:function(_64,_65){
return this.selection[_64].apply(this.selection,_65);
},placeCursorAtStart:function(){
this.focus();
var _66=false;
if(has("mozilla")){
var _67=this.editNode.firstChild;
while(_67){
if(_67.nodeType===3){
if(_67.nodeValue.replace(/^\s+|\s+$/g,"").length>0){
_66=true;
this.selection.selectElement(_67);
break;
}
}else{
if(_67.nodeType===1){
_66=true;
var tg=_67.tagName?_67.tagName.toLowerCase():"";
if(/br|input|img|base|meta|area|basefont|hr|link/.test(tg)){
this.selection.selectElement(_67);
}else{
this.selection.selectElementChildren(_67);
}
break;
}
}
_67=_67.nextSibling;
}
}else{
_66=true;
this.selection.selectElementChildren(this.editNode);
}
if(_66){
this.selection.collapse(true);
}
},placeCursorAtEnd:function(){
this.focus();
var _68=false;
if(has("mozilla")){
var _69=this.editNode.lastChild;
while(_69){
if(_69.nodeType===3){
if(_69.nodeValue.replace(/^\s+|\s+$/g,"").length>0){
_68=true;
this.selection.selectElement(_69);
break;
}
}else{
if(_69.nodeType===1){
_68=true;
this.selection.selectElement(_69.lastChild||_69);
break;
}
}
_69=_69.previousSibling;
}
}else{
_68=true;
this.selection.selectElementChildren(this.editNode);
}
if(_68){
this.selection.collapse(false);
}
},getValue:function(_6a){
if(this.textarea){
if(this.isClosed||!this.isLoaded){
return this.textarea.value;
}
}
return this.isLoaded?this._postFilterContent(null,_6a):this.value;
},_getValueAttr:function(){
return this.getValue(true);
},setValue:function(_6b){
if(!this.isLoaded){
this.onLoadDeferred.then(_d.hitch(this,function(){
this.setValue(_6b);
}));
return;
}
if(this.textarea&&(this.isClosed||!this.isLoaded)){
this.textarea.value=_6b;
}else{
_6b=this._preFilterContent(_6b);
var _6c=this.isClosed?this.domNode:this.editNode;
_6c.innerHTML=_6b;
this._preDomFilterContent(_6c);
}
this.onDisplayChanged();
this._set("value",this.getValue(true));
},replaceValue:function(_6d){
if(this.isClosed){
this.setValue(_6d);
}else{
if(this.window&&this.window.getSelection&&!has("mozilla")){
this.setValue(_6d);
}else{
if(this.window&&this.window.getSelection){
_6d=this._preFilterContent(_6d);
this.execCommand("selectall");
this.execCommand("inserthtml",_6d);
this._preDomFilterContent(this.editNode);
}else{
if(this.document&&this.document.selection){
this.setValue(_6d);
}
}
}
}
this._set("value",this.getValue(true));
},_preFilterContent:function(_6e){
var ec=_6e;
_1.forEach(this.contentPreFilters,function(ef){
if(ef){
ec=ef(ec);
}
});
return ec;
},_preDomFilterContent:function(dom){
dom=dom||this.editNode;
_1.forEach(this.contentDomPreFilters,function(ef){
if(ef&&_d.isFunction(ef)){
ef(dom);
}
},this);
},_postFilterContent:function(dom,_6f){
var ec;
if(!_d.isString(dom)){
dom=dom||this.editNode;
if(this.contentDomPostFilters.length){
if(_6f){
dom=_d.clone(dom);
}
_1.forEach(this.contentDomPostFilters,function(ef){
dom=ef(dom);
});
}
ec=_18.getChildrenHtml(dom);
}else{
ec=dom;
}
if(!_d.trim(ec.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length){
ec="";
}
_1.forEach(this.contentPostFilters,function(ef){
ec=ef(ec);
});
return ec;
},_saveContent:function(){
var _70=_5.byId(_1a._scopeName+"._editor.RichText.value");
if(_70){
if(_70.value){
_70.value+=this._SEPARATOR;
}
_70.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(true);
}
},escapeXml:function(str,_71){
str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");
if(!_71){
str=str.replace(/'/gm,"&#39;");
}
return str;
},getNodeHtml:function(_72){
_b.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",2);
return _18.getNodeHtml(_72);
},getNodeChildrenHtml:function(dom){
_b.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);
return _18.getChildrenHtml(dom);
},close:function(_73){
if(this.isClosed){
return;
}
if(!arguments.length){
_73=true;
}
if(_73){
this._set("value",this.getValue(true));
}
if(this.interval){
clearInterval(this.interval);
}
if(this._webkitListener){
this._webkitListener.remove();
delete this._webkitListener;
}
if(has("ie")){
this.iframe.onfocus=null;
}
this.iframe._loadFunc=null;
if(this._iframeRegHandle){
this._iframeRegHandle.remove();
delete this._iframeRegHandle;
}
if(this.textarea){
var s=this.textarea.style;
s.position="";
s.left=s.top="";
if(has("ie")){
s.overflow=this.__overflow;
this.__overflow=null;
}
this.textarea.value=this.value;
_8.destroy(this.domNode);
this.domNode=this.textarea;
}else{
this.domNode.innerHTML=this.value;
}
delete this.iframe;
_7.remove(this.domNode,this.baseClass);
this.isClosed=true;
this.isLoaded=false;
delete this.editNode;
delete this.focusNode;
if(this.window&&this.window._frameElement){
this.window._frameElement=null;
}
this.window=null;
this.document=null;
this.editingArea=null;
this.editorObject=null;
},destroy:function(){
if(!this.isClosed){
this.close(false);
}
if(this._updateTimer){
this._updateTimer.remove();
}
this.inherited(arguments);
if(_1b._globalSaveHandler){
delete _1b._globalSaveHandler[this.id];
}
},_removeMozBogus:function(_74){
return _74.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"");
},_removeWebkitBogus:function(_75){
_75=_75.replace(/\sclass="webkit-block-placeholder"/gi,"");
_75=_75.replace(/\sclass="apple-style-span"/gi,"");
_75=_75.replace(/<meta charset=\"utf-8\" \/>/gi,"");
return _75;
},_normalizeFontStyle:function(_76){
return _76.replace(/<(\/)?strong([ \>])/gi,"<$1b$2").replace(/<(\/)?em([ \>])/gi,"<$1i$2");
},_preFixUrlAttributes:function(_77){
return _77.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2");
},_browserQueryCommandEnabled:function(_78){
if(!_78){
return false;
}
var _79=has("ie")<9?this.document.selection.createRange():this.document;
try{
return _79.queryCommandEnabled(_78);
}
catch(e){
return false;
}
},_createlinkEnabledImpl:function(){
var _7a=true;
if(has("opera")){
var sel=this.window.getSelection();
if(sel.isCollapsed){
_7a=true;
}else{
_7a=this.document.queryCommandEnabled("createlink");
}
}else{
_7a=this._browserQueryCommandEnabled("createlink");
}
return _7a;
},_unlinkEnabledImpl:function(){
var _7b=true;
if(has("mozilla")||has("webkit")){
_7b=this.selection.hasAncestorElement("a");
}else{
_7b=this._browserQueryCommandEnabled("unlink");
}
return _7b;
},_inserttableEnabledImpl:function(){
var _7c=true;
if(has("mozilla")||has("webkit")){
_7c=true;
}else{
_7c=this._browserQueryCommandEnabled("inserttable");
}
return _7c;
},_cutEnabledImpl:function(){
var _7d=true;
if(has("webkit")){
var sel=this.window.getSelection();
if(sel){
sel=sel.toString();
}
_7d=!!sel;
}else{
_7d=this._browserQueryCommandEnabled("cut");
}
return _7d;
},_copyEnabledImpl:function(){
var _7e=true;
if(has("webkit")){
var sel=this.window.getSelection();
if(sel){
sel=sel.toString();
}
_7e=!!sel;
}else{
_7e=this._browserQueryCommandEnabled("copy");
}
return _7e;
},_pasteEnabledImpl:function(){
var _7f=true;
if(has("webkit")){
return true;
}else{
_7f=this._browserQueryCommandEnabled("paste");
}
return _7f;
},_inserthorizontalruleImpl:function(_80){
if(has("ie")){
return this._inserthtmlImpl("<hr>");
}
return this.document.execCommand("inserthorizontalrule",false,_80);
},_unlinkImpl:function(_81){
if((this.queryCommandEnabled("unlink"))&&(has("mozilla")||has("webkit"))){
var a=this.selection.getAncestorElement("a");
this.selection.selectElement(a);
return this.document.execCommand("unlink",false,null);
}
return this.document.execCommand("unlink",false,_81);
},_hilitecolorImpl:function(_82){
var _83;
var _84=this._handleTextColorOrProperties("hilitecolor",_82);
if(!_84){
if(has("mozilla")){
this.document.execCommand("styleWithCSS",false,true);
console.log("Executing color command.");
_83=this.document.execCommand("hilitecolor",false,_82);
this.document.execCommand("styleWithCSS",false,false);
}else{
_83=this.document.execCommand("hilitecolor",false,_82);
}
}
return _83;
},_backcolorImpl:function(_85){
if(has("ie")){
_85=_85?_85:null;
}
var _86=this._handleTextColorOrProperties("backcolor",_85);
if(!_86){
_86=this.document.execCommand("backcolor",false,_85);
}
return _86;
},_forecolorImpl:function(_87){
if(has("ie")){
_87=_87?_87:null;
}
var _88=false;
_88=this._handleTextColorOrProperties("forecolor",_87);
if(!_88){
_88=this.document.execCommand("forecolor",false,_87);
}
return _88;
},_inserthtmlImpl:function(_89){
_89=this._preFilterContent(_89);
var rv=true;
if(has("ie")<9){
var _8a=this.document.selection.createRange();
if(this.document.selection.type.toUpperCase()==="CONTROL"){
var n=_8a.item(0);
while(_8a.length){
_8a.remove(_8a.item(0));
}
n.outerHTML=_89;
}else{
_8a.pasteHTML(_89);
}
_8a.select();
}else{
if(has("trident")<8){
var _8a;
var _8b=_17.getSelection(this.window);
if(_8b&&_8b.rangeCount&&_8b.getRangeAt){
_8a=_8b.getRangeAt(0);
_8a.deleteContents();
var div=_8.create("div");
div.innerHTML=_89;
var _8c,_8d;
var n=this.document.createDocumentFragment();
while((_8c=div.firstChild)){
_8d=n.appendChild(_8c);
}
_8a.insertNode(n);
if(_8d){
_8a=_8a.cloneRange();
_8a.setStartAfter(_8d);
_8a.collapse(false);
_8b.removeAllRanges();
_8b.addRange(_8a);
}
}
}else{
if(has("mozilla")&&!_89.length){
this.selection.remove();
}else{
rv=this.document.execCommand("inserthtml",false,_89);
}
}
}
return rv;
},_boldImpl:function(_8e){
var _8f=false;
if(has("ie")||has("trident")){
this._adaptIESelection();
_8f=this._adaptIEFormatAreaAndExec("bold");
}
if(!_8f){
_8f=this.document.execCommand("bold",false,_8e);
}
return _8f;
},_italicImpl:function(_90){
var _91=false;
if(has("ie")||has("trident")){
this._adaptIESelection();
_91=this._adaptIEFormatAreaAndExec("italic");
}
if(!_91){
_91=this.document.execCommand("italic",false,_90);
}
return _91;
},_underlineImpl:function(_92){
var _93=false;
if(has("ie")||has("trident")){
this._adaptIESelection();
_93=this._adaptIEFormatAreaAndExec("underline");
}
if(!_93){
_93=this.document.execCommand("underline",false,_92);
}
return _93;
},_strikethroughImpl:function(_94){
var _95=false;
if(has("ie")||has("trident")){
this._adaptIESelection();
_95=this._adaptIEFormatAreaAndExec("strikethrough");
}
if(!_95){
_95=this.document.execCommand("strikethrough",false,_94);
}
return _95;
},_superscriptImpl:function(_96){
var _97=false;
if(has("ie")||has("trident")){
this._adaptIESelection();
_97=this._adaptIEFormatAreaAndExec("superscript");
}
if(!_97){
_97=this.document.execCommand("superscript",false,_96);
}
return _97;
},_subscriptImpl:function(_98){
var _99=false;
if(has("ie")||has("trident")){
this._adaptIESelection();
_99=this._adaptIEFormatAreaAndExec("subscript");
}
if(!_99){
_99=this.document.execCommand("subscript",false,_98);
}
return _99;
},_fontnameImpl:function(_9a){
var _9b;
if(has("ie")||has("trident")){
_9b=this._handleTextColorOrProperties("fontname",_9a);
}
if(!_9b){
_9b=this.document.execCommand("fontname",false,_9a);
}
return _9b;
},_fontsizeImpl:function(_9c){
var _9d;
if(has("ie")||has("trident")){
_9d=this._handleTextColorOrProperties("fontsize",_9c);
}
if(!_9d){
_9d=this.document.execCommand("fontsize",false,_9c);
}
return _9d;
},_insertorderedlistImpl:function(_9e){
var _9f=false;
if(has("ie")||has("trident")){
_9f=this._adaptIEList("insertorderedlist",_9e);
}
if(!_9f){
_9f=this.document.execCommand("insertorderedlist",false,_9e);
}
return _9f;
},_insertunorderedlistImpl:function(_a0){
var _a1=false;
if(has("ie")||has("trident")){
_a1=this._adaptIEList("insertunorderedlist",_a0);
}
if(!_a1){
_a1=this.document.execCommand("insertunorderedlist",false,_a0);
}
return _a1;
},getHeaderHeight:function(){
return this._getNodeChildrenHeight(this.header);
},getFooterHeight:function(){
return this._getNodeChildrenHeight(this.footer);
},_getNodeChildrenHeight:function(_a2){
var h=0;
if(_a2&&_a2.childNodes){
var i;
for(i=0;i<_a2.childNodes.length;i++){
var _a3=_9.position(_a2.childNodes[i]);
h+=_a3.h;
}
}
return h;
},_isNodeEmpty:function(_a4,_a5){
if(_a4.nodeType===1){
if(_a4.childNodes.length>0){
return this._isNodeEmpty(_a4.childNodes[0],_a5);
}
return true;
}else{
if(_a4.nodeType===3){
return (_a4.nodeValue.substring(_a5)==="");
}
}
return false;
},_removeStartingRangeFromRange:function(_a6,_a7){
if(_a6.nextSibling){
_a7.setStart(_a6.nextSibling,0);
}else{
var _a8=_a6.parentNode;
while(_a8&&_a8.nextSibling==null){
_a8=_a8.parentNode;
}
if(_a8){
_a7.setStart(_a8.nextSibling,0);
}
}
return _a7;
},_adaptIESelection:function(){
var _a9=_17.getSelection(this.window);
if(_a9&&_a9.rangeCount&&!_a9.isCollapsed){
var _aa=_a9.getRangeAt(0);
var _ab=_aa.startContainer;
var _ac=_aa.startOffset;
while(_ab.nodeType===3&&_ac>=_ab.length&&_ab.nextSibling){
_ac=_ac-_ab.length;
_ab=_ab.nextSibling;
}
var _ad=null;
while(this._isNodeEmpty(_ab,_ac)&&_ab!==_ad){
_ad=_ab;
_aa=this._removeStartingRangeFromRange(_ab,_aa);
_ab=_aa.startContainer;
_ac=0;
}
_a9.removeAllRanges();
_a9.addRange(_aa);
}
},_adaptIEFormatAreaAndExec:function(_ae){
var _af=_17.getSelection(this.window);
var doc=this.document;
var rs,ret,_b0,txt,_b1,_b2,_b3,_b4;
if(_ae&&_af&&_af.isCollapsed){
var _b5=this.queryCommandValue(_ae);
if(_b5){
var _b6=this._tagNamesForCommand(_ae);
_b0=_af.getRangeAt(0);
var fs=_b0.startContainer;
if(fs.nodeType===3){
var _b7=_b0.endOffset;
if(fs.length<_b7){
ret=this._adjustNodeAndOffset(rs,_b7);
fs=ret.node;
_b7=ret.offset;
}
}
var _b8;
while(fs&&fs!==this.editNode){
var _b9=fs.tagName?fs.tagName.toLowerCase():"";
if(_1.indexOf(_b6,_b9)>-1){
_b8=fs;
break;
}
fs=fs.parentNode;
}
if(_b8){
rs=_b0.startContainer;
var _ba=doc.createElement(_b8.tagName);
_8.place(_ba,_b8,"after");
if(rs&&rs.nodeType===3){
var _bb,_bc;
var _bd=_b0.endOffset;
if(rs.length<_bd){
ret=this._adjustNodeAndOffset(rs,_bd);
rs=ret.node;
_bd=ret.offset;
}
txt=rs.nodeValue;
_b1=doc.createTextNode(txt.substring(0,_bd));
var _be=txt.substring(_bd,txt.length);
if(_be){
_b2=doc.createTextNode(_be);
}
_8.place(_b1,rs,"before");
if(_b2){
_b3=doc.createElement("span");
_b3.className="ieFormatBreakerSpan";
_8.place(_b3,rs,"after");
_8.place(_b2,_b3,"after");
_b2=_b3;
}
_8.destroy(rs);
var _bf=_b1.parentNode;
var _c0=[];
var _c1;
while(_bf!==_b8){
var tg=_bf.tagName;
_c1={tagName:tg};
_c0.push(_c1);
var _c2=doc.createElement(tg);
if(_bf.style){
if(_c2.style){
if(_bf.style.cssText){
_c2.style.cssText=_bf.style.cssText;
_c1.cssText=_bf.style.cssText;
}
}
}
if(_bf.tagName==="FONT"){
if(_bf.color){
_c2.color=_bf.color;
_c1.color=_bf.color;
}
if(_bf.face){
_c2.face=_bf.face;
_c1.face=_bf.face;
}
if(_bf.size){
_c2.size=_bf.size;
_c1.size=_bf.size;
}
}
if(_bf.className){
_c2.className=_bf.className;
_c1.className=_bf.className;
}
if(_b2){
_bb=_b2;
while(_bb){
_bc=_bb.nextSibling;
_c2.appendChild(_bb);
_bb=_bc;
}
}
if(_c2.tagName==_bf.tagName){
_b3=doc.createElement("span");
_b3.className="ieFormatBreakerSpan";
_8.place(_b3,_bf,"after");
_8.place(_c2,_b3,"after");
}else{
_8.place(_c2,_bf,"after");
}
_b1=_bf;
_b2=_c2;
_bf=_bf.parentNode;
}
if(_b2){
_bb=_b2;
if(_bb.nodeType===1||(_bb.nodeType===3&&_bb.nodeValue)){
_ba.innerHTML="";
}
while(_bb){
_bc=_bb.nextSibling;
_ba.appendChild(_bb);
_bb=_bc;
}
}
var _c3;
if(_c0.length){
_c1=_c0.pop();
var _c4=doc.createElement(_c1.tagName);
if(_c1.cssText&&_c4.style){
_c4.style.cssText=_c1.cssText;
}
if(_c1.className){
_c4.className=_c1.className;
}
if(_c1.tagName==="FONT"){
if(_c1.color){
_c4.color=_c1.color;
}
if(_c1.face){
_c4.face=_c1.face;
}
if(_c1.size){
_c4.size=_c1.size;
}
}
_8.place(_c4,_ba,"before");
while(_c0.length){
_c1=_c0.pop();
var _c5=doc.createElement(_c1.tagName);
if(_c1.cssText&&_c5.style){
_c5.style.cssText=_c1.cssText;
}
if(_c1.className){
_c5.className=_c1.className;
}
if(_c1.tagName==="FONT"){
if(_c1.color){
_c5.color=_c1.color;
}
if(_c1.face){
_c5.face=_c1.face;
}
if(_c1.size){
_c5.size=_c1.size;
}
}
_c4.appendChild(_c5);
_c4=_c5;
}
_b4=doc.createTextNode(".");
_b3.appendChild(_b4);
_c4.appendChild(_b4);
_c3=_17.create(this.window);
_c3.setStart(_b4,0);
_c3.setEnd(_b4,_b4.length);
_af.removeAllRanges();
_af.addRange(_c3);
this.selection.collapse(false);
_b4.parentNode.innerHTML="";
}else{
_b3=doc.createElement("span");
_b3.className="ieFormatBreakerSpan";
_b4=doc.createTextNode(".");
_b3.appendChild(_b4);
_8.place(_b3,_ba,"before");
_c3=_17.create(this.window);
_c3.setStart(_b4,0);
_c3.setEnd(_b4,_b4.length);
_af.removeAllRanges();
_af.addRange(_c3);
this.selection.collapse(false);
_b4.parentNode.innerHTML="";
}
if(!_ba.firstChild){
_8.destroy(_ba);
}
return true;
}
}
return false;
}else{
_b0=_af.getRangeAt(0);
rs=_b0.startContainer;
if(rs&&rs.nodeType===3){
var _b7=_b0.startOffset;
if(rs.length<_b7){
ret=this._adjustNodeAndOffset(rs,_b7);
rs=ret.node;
_b7=ret.offset;
}
txt=rs.nodeValue;
_b1=doc.createTextNode(txt.substring(0,_b7));
var _be=txt.substring(_b7);
if(_be!==""){
_b2=doc.createTextNode(txt.substring(_b7));
}
_b3=doc.createElement("span");
_b4=doc.createTextNode(".");
_b3.appendChild(_b4);
if(_b1.length){
_8.place(_b1,rs,"after");
}else{
_b1=rs;
}
_8.place(_b3,_b1,"after");
if(_b2){
_8.place(_b2,_b3,"after");
}
_8.destroy(rs);
var _c3=_17.create(this.window);
_c3.setStart(_b4,0);
_c3.setEnd(_b4,_b4.length);
_af.removeAllRanges();
_af.addRange(_c3);
doc.execCommand(_ae);
_8.place(_b3.firstChild,_b3,"before");
_8.destroy(_b3);
_c3.setStart(_b4,0);
_c3.setEnd(_b4,_b4.length);
_af.removeAllRanges();
_af.addRange(_c3);
this.selection.collapse(false);
_b4.parentNode.innerHTML="";
return true;
}
}
}else{
return false;
}
},_adaptIEList:function(_c6){
var _c7=_17.getSelection(this.window);
if(_c7.isCollapsed){
if(_c7.rangeCount&&!this.queryCommandValue(_c6)){
var _c8=_c7.getRangeAt(0);
var sc=_c8.startContainer;
if(sc&&sc.nodeType==3){
if(!_c8.startOffset){
var _c9="ul";
if(_c6==="insertorderedlist"){
_c9="ol";
}
var _ca=this.document.createElement(_c9);
var li=_8.create("li",null,_ca);
_8.place(_ca,sc,"before");
li.appendChild(sc);
_8.create("br",null,_ca,"after");
var _cb=_17.create(this.window);
_cb.setStart(sc,0);
_cb.setEnd(sc,sc.length);
_c7.removeAllRanges();
_c7.addRange(_cb);
this.selection.collapse(true);
return true;
}
}
}
}
return false;
},_handleTextColorOrProperties:function(_cc,_cd){
var _ce=_17.getSelection(this.window);
var doc=this.document;
var rs,ret,_cf,txt,_d0,_d1,_d2,_d3;
_cd=_cd||null;
if(_cc&&_ce&&_ce.isCollapsed){
if(_ce.rangeCount){
_cf=_ce.getRangeAt(0);
rs=_cf.startContainer;
if(rs&&rs.nodeType===3){
var _d4=_cf.startOffset;
if(rs.length<_d4){
ret=this._adjustNodeAndOffset(rs,_d4);
rs=ret.node;
_d4=ret.offset;
}
txt=rs.nodeValue;
_d0=doc.createTextNode(txt.substring(0,_d4));
var _d5=txt.substring(_d4);
if(_d5!==""){
_d1=doc.createTextNode(txt.substring(_d4));
}
_d2=doc.createElement("span");
_d3=doc.createTextNode(".");
_d2.appendChild(_d3);
var _d6=doc.createElement("span");
_d2.appendChild(_d6);
if(_d0.length){
_8.place(_d0,rs,"after");
}else{
_d0=rs;
}
_8.place(_d2,_d0,"after");
if(_d1){
_8.place(_d1,_d2,"after");
}
_8.destroy(rs);
var _d7=_17.create(this.window);
_d7.setStart(_d3,0);
_d7.setEnd(_d3,_d3.length);
_ce.removeAllRanges();
_ce.addRange(_d7);
if(has("webkit")){
var _d8="color";
if(_cc==="hilitecolor"||_cc==="backcolor"){
_d8="backgroundColor";
}
_a.set(_d2,_d8,_cd);
this.selection.remove();
_8.destroy(_d6);
_d2.innerHTML="&#160;";
this.selection.selectElement(_d2);
this.focus();
}else{
this.execCommand(_cc,_cd);
_8.place(_d2.firstChild,_d2,"before");
_8.destroy(_d2);
_d7.setStart(_d3,0);
_d7.setEnd(_d3,_d3.length);
_ce.removeAllRanges();
_ce.addRange(_d7);
this.selection.collapse(false);
_d3.parentNode.removeChild(_d3);
}
return true;
}
}
}
return false;
},_adjustNodeAndOffset:function(_d9,_da){
while(_d9.length<_da&&_d9.nextSibling&&_d9.nextSibling.nodeType===3){
_da=_da-_d9.length;
_d9=_d9.nextSibling;
}
return {"node":_d9,"offset":_da};
},_tagNamesForCommand:function(_db){
if(_db==="bold"){
return ["b","strong"];
}else{
if(_db==="italic"){
return ["i","em"];
}else{
if(_db==="strikethrough"){
return ["s","strike"];
}else{
if(_db==="superscript"){
return ["sup"];
}else{
if(_db==="subscript"){
return ["sub"];
}else{
if(_db==="underline"){
return ["u"];
}
}
}
}
}
}
return [];
},_stripBreakerNodes:function(_dc){
if(!this.isLoaded){
return;
}
_e(".ieFormatBreakerSpan",_dc).forEach(function(b){
while(b.firstChild){
_8.place(b.firstChild,b,"before");
}
_8.destroy(b);
});
return _dc;
},_stripTrailingEmptyNodes:function(_dd){
function _de(_df){
return (/^(p|div|br)$/i.test(_df.nodeName)&&_df.children.length==0&&/^[\s\xA0]*$/.test(_df.textContent||_df.innerText||""))||(_df.nodeType===3&&/^[\s\xA0]*$/.test(_df.nodeValue));
};
while(_dd.lastChild&&_de(_dd.lastChild)){
_8.destroy(_dd.lastChild);
}
return _dd;
},_setTextDirAttr:function(_e0){
this._set("textDir",_e0);
this.onLoadDeferred.then(_d.hitch(this,function(){
this.editNode.dir=_e0;
}));
}});
return _1b;
});


;define("dijit/_editor/plugins/EnterKeyHandling",["dojo/_base/declare","dojo/dom-construct","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","../_Plugin","../RichText","../range"],function(_1,_2,_3,_4,on,_5,_6,_7,_8,_9,_a){
return _1("dijit._editor.plugins.EnterKeyHandling",_8,{blockNodeForEnter:"BR",constructor:function(_b){
if(_b){
if("blockNodeForEnter" in _b){
_b.blockNodeForEnter=_b.blockNodeForEnter.toUpperCase();
}
_4.mixin(this,_b);
}
},setEditor:function(_c){
if(this.editor===_c){
return;
}
this.editor=_c;
if(this.blockNodeForEnter=="BR"){
this.editor.customUndo=true;
_c.onLoadDeferred.then(_4.hitch(this,function(d){
this.own(on(_c.document,"keydown",_4.hitch(this,function(e){
if(e.keyCode==_3.ENTER){
var ne=_4.mixin({},e);
ne.shiftKey=true;
if(!this.handleEnterKey(ne)){
e.stopPropagation();
e.preventDefault();
}
}
})));
if(_5("ie")>=9&&_5("ie")<=10){
this.own(on(_c.document,"paste",_4.hitch(this,function(e){
setTimeout(_4.hitch(this,function(){
var r=this.editor.document.selection.createRange();
r.move("character",-1);
r.select();
r.move("character",1);
r.select();
}),0);
})));
}
return d;
}));
}else{
if(this.blockNodeForEnter){
var h=_4.hitch(this,"handleEnterKey");
_c.addKeyHandler(13,0,0,h);
_c.addKeyHandler(13,0,1,h);
this.own(this.editor.on("KeyPressed",_4.hitch(this,"onKeyPressed")));
}
}
},onKeyPressed:function(){
if(this._checkListLater){
if(this.editor.selection.isCollapsed()){
var _d=this.editor.selection.getAncestorElement("LI");
if(!_d){
_9.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);
var _e=this.editor.selection.getAncestorElement(this.blockNodeForEnter);
if(_e){
_e.innerHTML=this.bogusHtmlContent;
if(_5("ie")<=9){
var r=this.editor.document.selection.createRange();
r.move("character",-1);
r.select();
}
}else{
console.error("onKeyPressed: Cannot find the new block node");
}
}else{
if(_5("mozilla")){
if(_d.parentNode.parentNode.nodeName=="LI"){
_d=_d.parentNode.parentNode;
}
}
var fc=_d.firstChild;
if(fc&&fc.nodeType==1&&(fc.nodeName=="UL"||fc.nodeName=="OL")){
_d.insertBefore(fc.ownerDocument.createTextNode("\xa0"),fc);
var _f=_a.create(this.editor.window);
_f.setStart(_d.firstChild,0);
var _10=_a.getSelection(this.editor.window,true);
_10.removeAllRanges();
_10.addRange(_f);
}
}
}
this._checkListLater=false;
}
if(this._pressedEnterInBlock){
if(this._pressedEnterInBlock.previousSibling){
this.removeTrailingBr(this._pressedEnterInBlock.previousSibling);
}
delete this._pressedEnterInBlock;
}
},bogusHtmlContent:"&#160;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(e){
var _11,_12,_13,_14,_15,_16,doc=this.editor.document,br,rs,txt;
if(e.shiftKey){
var _17=this.editor.selection.getParentElement();
var _18=_a.getAncestor(_17,this.blockNodes);
if(_18){
if(_18.tagName=="LI"){
return true;
}
_11=_a.getSelection(this.editor.window);
_12=_11.getRangeAt(0);
if(!_12.collapsed){
_12.deleteContents();
_11=_a.getSelection(this.editor.window);
_12=_11.getRangeAt(0);
}
if(_a.atBeginningOfContainer(_18,_12.startContainer,_12.startOffset)){
br=doc.createElement("br");
_13=_a.create(this.editor.window);
_18.insertBefore(br,_18.firstChild);
_13.setStartAfter(br);
_11.removeAllRanges();
_11.addRange(_13);
}else{
if(_a.atEndOfContainer(_18,_12.startContainer,_12.startOffset)){
_13=_a.create(this.editor.window);
br=doc.createElement("br");
_18.appendChild(br);
_18.appendChild(doc.createTextNode("\xa0"));
_13.setStart(_18.lastChild,0);
_11.removeAllRanges();
_11.addRange(_13);
}else{
rs=_12.startContainer;
if(rs&&rs.nodeType==3){
txt=rs.nodeValue;
_14=doc.createTextNode(txt.substring(0,_12.startOffset));
_15=doc.createTextNode(txt.substring(_12.startOffset));
_16=doc.createElement("br");
if(_15.nodeValue==""&&_5("webkit")){
_15=doc.createTextNode("\xa0");
}
_2.place(_14,rs,"after");
_2.place(_16,_14,"after");
_2.place(_15,_16,"after");
_2.destroy(rs);
_13=_a.create(this.editor.window);
_13.setStart(_15,0);
_11.removeAllRanges();
_11.addRange(_13);
return false;
}
return true;
}
}
}else{
_11=_a.getSelection(this.editor.window);
if(_11.rangeCount){
_12=_11.getRangeAt(0);
if(_12&&_12.startContainer){
if(!_12.collapsed){
_12.deleteContents();
_11=_a.getSelection(this.editor.window);
_12=_11.getRangeAt(0);
}
rs=_12.startContainer;
if(rs&&rs.nodeType==3){
var _19=_12.startOffset;
if(rs.length<_19){
ret=this._adjustNodeAndOffset(rs,_19);
rs=ret.node;
_19=ret.offset;
}
txt=rs.nodeValue;
_14=doc.createTextNode(txt.substring(0,_19));
_15=doc.createTextNode(txt.substring(_19));
_16=doc.createElement("br");
if(!_15.length){
_15=doc.createTextNode("\xa0");
}
if(_14.length){
_2.place(_14,rs,"after");
}else{
_14=rs;
}
_2.place(_16,_14,"after");
_2.place(_15,_16,"after");
_2.destroy(rs);
_13=_a.create(this.editor.window);
_13.setStart(_15,0);
_13.setEnd(_15,_15.length);
_11.removeAllRanges();
_11.addRange(_13);
this.editor.selection.collapse(true);
}else{
var _1a;
if(_12.startOffset>=0){
_1a=rs.childNodes[_12.startOffset];
}
var _16=doc.createElement("br");
var _15=doc.createTextNode("\xa0");
if(!_1a){
rs.appendChild(_16);
rs.appendChild(_15);
}else{
_2.place(_16,_1a,"before");
_2.place(_15,_16,"after");
}
_13=_a.create(this.editor.window);
_13.setStart(_15,0);
_13.setEnd(_15,_15.length);
_11.removeAllRanges();
_11.addRange(_13);
this.editor.selection.collapse(true);
}
}
}else{
_9.prototype.execCommand.call(this.editor,"inserthtml","<br>");
}
}
return false;
}
var _1b=true;
_11=_a.getSelection(this.editor.window);
_12=_11.getRangeAt(0);
if(!_12.collapsed){
_12.deleteContents();
_11=_a.getSelection(this.editor.window);
_12=_11.getRangeAt(0);
}
var _1c=_a.getBlockAncestor(_12.endContainer,null,this.editor.editNode);
var _1d=_1c.blockNode;
if((this._checkListLater=(_1d&&(_1d.nodeName=="LI"||_1d.parentNode.nodeName=="LI")))){
if(_5("mozilla")){
this._pressedEnterInBlock=_1d;
}
if(/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(_1d.innerHTML)){
_1d.innerHTML="";
if(_5("webkit")){
_13=_a.create(this.editor.window);
_13.setStart(_1d,0);
_11.removeAllRanges();
_11.addRange(_13);
}
this._checkListLater=false;
}
return true;
}
if(!_1c.blockNode||_1c.blockNode===this.editor.editNode){
try{
_9.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);
}
catch(e2){
}
_1c={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),blockContainer:this.editor.editNode};
if(_1c.blockNode){
if(_1c.blockNode!=this.editor.editNode&&(!(_1c.blockNode.textContent||_1c.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)){
this.removeTrailingBr(_1c.blockNode);
return false;
}
}else{
_1c.blockNode=this.editor.editNode;
}
_11=_a.getSelection(this.editor.window);
_12=_11.getRangeAt(0);
}
var _1e=doc.createElement(this.blockNodeForEnter);
_1e.innerHTML=this.bogusHtmlContent;
this.removeTrailingBr(_1c.blockNode);
var _1f=_12.endOffset;
var _20=_12.endContainer;
if(_20.length<_1f){
var ret=this._adjustNodeAndOffset(_20,_1f);
_20=ret.node;
_1f=ret.offset;
}
if(_a.atEndOfContainer(_1c.blockNode,_20,_1f)){
if(_1c.blockNode===_1c.blockContainer){
_1c.blockNode.appendChild(_1e);
}else{
_2.place(_1e,_1c.blockNode,"after");
}
_1b=false;
_13=_a.create(this.editor.window);
_13.setStart(_1e,0);
_11.removeAllRanges();
_11.addRange(_13);
if(this.editor.height){
_7.scrollIntoView(_1e);
}
}else{
if(_a.atBeginningOfContainer(_1c.blockNode,_12.startContainer,_12.startOffset)){
_2.place(_1e,_1c.blockNode,_1c.blockNode===_1c.blockContainer?"first":"before");
if(_1e.nextSibling&&this.editor.height){
_13=_a.create(this.editor.window);
_13.setStart(_1e.nextSibling,0);
_11.removeAllRanges();
_11.addRange(_13);
_7.scrollIntoView(_1e.nextSibling);
}
_1b=false;
}else{
if(_1c.blockNode===_1c.blockContainer){
_1c.blockNode.appendChild(_1e);
}else{
_2.place(_1e,_1c.blockNode,"after");
}
_1b=false;
if(_1c.blockNode.style){
if(_1e.style){
if(_1c.blockNode.style.cssText){
_1e.style.cssText=_1c.blockNode.style.cssText;
}
}
}
rs=_12.startContainer;
var _21;
if(rs&&rs.nodeType==3){
var _22,_23;
_1f=_12.endOffset;
if(rs.length<_1f){
ret=this._adjustNodeAndOffset(rs,_1f);
rs=ret.node;
_1f=ret.offset;
}
txt=rs.nodeValue;
_14=doc.createTextNode(txt.substring(0,_1f));
_15=doc.createTextNode(txt.substring(_1f,txt.length));
_2.place(_14,rs,"before");
_2.place(_15,rs,"after");
_2.destroy(rs);
var _24=_14.parentNode;
while(_24!==_1c.blockNode){
var tg=_24.tagName;
var _25=doc.createElement(tg);
if(_24.style){
if(_25.style){
if(_24.style.cssText){
_25.style.cssText=_24.style.cssText;
}
}
}
if(_24.tagName==="FONT"){
if(_24.color){
_25.color=_24.color;
}
if(_24.face){
_25.face=_24.face;
}
if(_24.size){
_25.size=_24.size;
}
}
_22=_15;
while(_22){
_23=_22.nextSibling;
_25.appendChild(_22);
_22=_23;
}
_2.place(_25,_24,"after");
_14=_24;
_15=_25;
_24=_24.parentNode;
}
_22=_15;
if(_22.nodeType==1||(_22.nodeType==3&&_22.nodeValue)){
_1e.innerHTML="";
}
_21=_22;
while(_22){
_23=_22.nextSibling;
_1e.appendChild(_22);
_22=_23;
}
}
_13=_a.create(this.editor.window);
var _26;
var _27=_21;
if(this.blockNodeForEnter!=="BR"){
while(_27){
_26=_27;
_23=_27.firstChild;
_27=_23;
}
if(_26&&_26.parentNode){
_1e=_26.parentNode;
_13.setStart(_1e,0);
_11.removeAllRanges();
_11.addRange(_13);
if(this.editor.height){
_7.scrollIntoView(_1e);
}
if(_5("mozilla")){
this._pressedEnterInBlock=_1c.blockNode;
}
}else{
_1b=true;
}
}else{
_13.setStart(_1e,0);
_11.removeAllRanges();
_11.addRange(_13);
if(this.editor.height){
_7.scrollIntoView(_1e);
}
if(_5("mozilla")){
this._pressedEnterInBlock=_1c.blockNode;
}
}
}
}
return _1b;
},_adjustNodeAndOffset:function(_28,_29){
while(_28.length<_29&&_28.nextSibling&&_28.nextSibling.nodeType==3){
_29=_29-_28.length;
_28=_28.nextSibling;
}
return {"node":_28,"offset":_29};
},removeTrailingBr:function(_2a){
var _2b=/P|DIV|LI/i.test(_2a.tagName)?_2a:this.editor.selection.getParentOfType(_2a,["P","DIV","LI"]);
if(!_2b){
return;
}
if(_2b.lastChild){
if((_2b.childNodes.length>1&&_2b.lastChild.nodeType==3&&/^[\s\xAD]*$/.test(_2b.lastChild.nodeValue))||_2b.lastChild.tagName=="BR"){
_2.destroy(_2b.lastChild);
}
}
if(!_2b.childNodes.length){
_2b.innerHTML=this.bogusHtmlContent;
}
}});
});


;define("dojo/i18n!dijit/_editor/nls/commands", {"bold":"Bold","justifyCenter":"Align Center","selectAll":"Select All","superscript":"Superscript","foreColor":"Foreground Color","subscript":"Subscript","paste":"Paste","unlink":"Remove Link","insertTable":"Insert/Edit Table","systemShortcut":"The \"${0}\" action is only available in your browser using a keyboard shortcut. Use ${1}.","createLink":"Create Link","toggleDir":"Toggle Direction","removeFormat":"Remove Format","viewSource":"View HTML Source","tabIndent":"Tab Indent","insertImage":"Insert Image","appleKey":"\u2318${0}","toggleTableBorder":"Toggle Table Border","delete":"Delete","indent":"Indent","plainFormatBlock":"Paragraph Style","print":"Print","italic":"Italic","insertOrderedList":"Numbered List","justifyLeft":"Align Left","insertUnorderedList":"Bullet List","justifyFull":"Justify","cut":"Cut","underline":"Underline","newPage":"New Page","tableProp":"Table Property","strikethrough":"Strikethrough","outdent":"Outdent","formatBlock":"Paragraph Style","insertHorizontalRule":"Horizontal Rule","fullScreen":"Toggle Full Screen","htmlToggle":"HTML Source","deleteTable":"Delete Table","undo":"Undo","justifyRight":"Align Right","fontSize":"Font Size","hiliteColor":"Background Color","ctrlKey":"ctrl+${0}","copy":"Copy","fontName":"Font Name","redo":"Redo"});

;define("dijit/Editor",["require","dojo/_base/array","dojo/_base/declare","dojo/Deferred","dojo/i18n","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/string","dojo/topic","./_Container","./Toolbar","./ToolbarSeparator","./layout/_LayoutWidget","./form/ToggleButton","./_editor/_Plugin","./_editor/plugins/EnterKeyHandling","./_editor/html","./_editor/range","./_editor/RichText","./main","dojo/i18n!./_editor/nls/commands"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19){
var _1a=_3("dijit.Editor",_18,{plugins:null,extraPlugins:null,constructor:function(){
if(!_b.isArray(this.plugins)){
this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",_15];
}
this._plugins=[];
this._editInterval=this.editActionInterval*1000;
if(_c("ie")||_c("trident")){
this.events.push("onBeforeDeactivate");
this.events.push("onBeforeActivate");
}
},postMixInProperties:function(){
this.setValueDeferred=new _4();
this.inherited(arguments);
},postCreate:function(){
this.inherited(arguments);
this._steps=this._steps.slice(0);
this._undoedSteps=this._undoedSteps.slice(0);
if(_b.isArray(this.extraPlugins)){
this.plugins=this.plugins.concat(this.extraPlugins);
}
this.commands=_5.getLocalization("dijit._editor","commands",this.lang);
if(_c("webkit")){
_9.set(this.domNode,"KhtmlUserSelect","none");
}
},startup:function(){
this.inherited(arguments);
if(!this.toolbar){
this.toolbar=new _10({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id});
this.header.appendChild(this.toolbar.domNode);
}
_2.forEach(this.plugins,this.addPlugin,this);
this.setValueDeferred.resolve(true);
_7.add(this.iframe.parentNode,"dijitEditorIFrameContainer");
_7.add(this.iframe,"dijitEditorIFrame");
_6.set(this.iframe,"allowTransparency",true);
this.toolbar.startup();
this.onNormalizedDisplayChanged();
},destroy:function(){
_2.forEach(this._plugins,function(p){
if(p&&p.destroy){
p.destroy();
}
});
this._plugins=[];
this.toolbar.destroyRecursive();
delete this.toolbar;
this.inherited(arguments);
},addPlugin:function(_1b,_1c){
var _1d=_b.isString(_1b)?{name:_1b}:_b.isFunction(_1b)?{ctor:_1b}:_1b;
if(!_1d.setEditor){
var o={"args":_1d,"plugin":null,"editor":this};
if(_1d.name){
if(_14.registry[_1d.name]){
o.plugin=_14.registry[_1d.name](_1d);
}else{
_e.publish(_19._scopeName+".Editor.getPlugin",o);
}
}
if(!o.plugin){
try{
var pc=_1d.ctor||_b.getObject(_1d.name)||_1(_1d.name);
if(pc){
o.plugin=new pc(_1d);
}
}
catch(e){
throw new Error(this.id+": cannot find plugin ["+_1d.name+"]");
}
}
if(!o.plugin){
throw new Error(this.id+": cannot find plugin ["+_1d.name+"]");
}
_1b=o.plugin;
}
if(arguments.length>1){
this._plugins[_1c]=_1b;
}else{
this._plugins.push(_1b);
}
_1b.setEditor(this);
if(_b.isFunction(_1b.setToolbar)){
_1b.setToolbar(this.toolbar);
}
},resize:function(_1e){
if(_1e){
_12.prototype.resize.apply(this,arguments);
}
},layout:function(){
var _1f=(this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+_8.getPadBorderExtents(this.iframe.parentNode).h+_8.getMarginExtents(this.iframe.parentNode).h));
this.editingArea.style.height=_1f+"px";
if(this.iframe){
this.iframe.style.height="100%";
}
this._layoutMode=true;
},_onIEMouseDown:function(e){
var _20;
var b=this.document.body;
var _21=b.clientWidth;
var _22=b.clientHeight;
var _23=b.clientLeft;
var _24=b.offsetWidth;
var _25=b.offsetHeight;
var _26=b.offsetLeft;
if(/^rtl$/i.test(b.dir||"")){
if(_21<_24&&e.x>_21&&e.x<_24){
_20=true;
}
}else{
if(e.x<_23&&e.x>_26){
_20=true;
}
}
if(!_20){
if(_22<_25&&e.y>_22&&e.y<_25){
_20=true;
}
}
if(!_20){
delete this._cursorToStart;
delete this._savedSelection;
if(e.target.tagName=="BODY"){
this.defer("placeCursorAtEnd");
}
this.inherited(arguments);
}
},onBeforeActivate:function(){
this._restoreSelection();
},onBeforeDeactivate:function(e){
if(this.customUndo){
this.endEditing(true);
}
if(e.target.tagName!="BODY"){
this._saveSelection();
}
},customUndo:true,editActionInterval:3,beginEditing:function(cmd){
if(!this._inEditing){
this._inEditing=true;
this._beginEditing(cmd);
}
if(this.editActionInterval>0){
if(this._editTimer){
this._editTimer.remove();
}
this._editTimer=this.defer("endEditing",this._editInterval);
}
},_steps:[],_undoedSteps:[],execCommand:function(cmd){
if(this.customUndo&&(cmd=="undo"||cmd=="redo")){
return this[cmd]();
}else{
if(this.customUndo){
this.endEditing();
this._beginEditing();
}
var r=this.inherited(arguments);
if(this.customUndo){
this._endEditing();
}
return r;
}
},_pasteImpl:function(){
return this._clipboardCommand("paste");
},_cutImpl:function(){
return this._clipboardCommand("cut");
},_copyImpl:function(){
return this._clipboardCommand("copy");
},_clipboardCommand:function(cmd){
var r;
try{
r=this.document.execCommand(cmd,false,null);
if(_c("webkit")&&!r){
throw {};
}
}
catch(e){
var sub=_d.substitute,_27={cut:"X",copy:"C",paste:"V"};
alert(sub(this.commands.systemShortcut,[this.commands[cmd],sub(this.commands[_c("mac")?"appleKey":"ctrlKey"],[_27[cmd]])]));
r=false;
}
return r;
},queryCommandEnabled:function(cmd){
if(this.customUndo&&(cmd=="undo"||cmd=="redo")){
return cmd=="undo"?(this._steps.length>1):(this._undoedSteps.length>0);
}else{
return this.inherited(arguments);
}
},_moveToBookmark:function(b){
var _28=b.mark;
var _29=b.mark;
var col=b.isCollapsed;
var r,_2a,_2b,sel;
if(_29){
if(_c("ie")<9||(_c("ie")===9&&_c("quirks"))){
if(_b.isArray(_29)){
_28=[];
_2.forEach(_29,function(n){
_28.push(_17.getNode(n,this.editNode));
},this);
this.selection.moveToBookmark({mark:_28,isCollapsed:col});
}else{
if(_29.startContainer&&_29.endContainer){
sel=_17.getSelection(this.window);
if(sel&&sel.removeAllRanges){
sel.removeAllRanges();
r=_17.create(this.window);
_2a=_17.getNode(_29.startContainer,this.editNode);
_2b=_17.getNode(_29.endContainer,this.editNode);
if(_2a&&_2b){
r.setStart(_2a,_29.startOffset);
r.setEnd(_2b,_29.endOffset);
sel.addRange(r);
}
}
}
}
}else{
sel=_17.getSelection(this.window);
if(sel&&sel.removeAllRanges){
sel.removeAllRanges();
r=_17.create(this.window);
_2a=_17.getNode(_29.startContainer,this.editNode);
_2b=_17.getNode(_29.endContainer,this.editNode);
if(_2a&&_2b){
r.setStart(_2a,_29.startOffset);
r.setEnd(_2b,_29.endOffset);
sel.addRange(r);
}
}
}
}
},_changeToStep:function(_2c,to){
this.setValue(to.text);
var b=to.bookmark;
if(!b){
return;
}
this._moveToBookmark(b);
},undo:function(){
var ret=false;
if(!this._undoRedoActive){
this._undoRedoActive=true;
this.endEditing(true);
var s=this._steps.pop();
if(s&&this._steps.length>0){
this.focus();
this._changeToStep(s,this._steps[this._steps.length-1]);
this._undoedSteps.push(s);
this.onDisplayChanged();
delete this._undoRedoActive;
ret=true;
}
delete this._undoRedoActive;
}
return ret;
},redo:function(){
var ret=false;
if(!this._undoRedoActive){
this._undoRedoActive=true;
this.endEditing(true);
var s=this._undoedSteps.pop();
if(s&&this._steps.length>0){
this.focus();
this._changeToStep(this._steps[this._steps.length-1],s);
this._steps.push(s);
this.onDisplayChanged();
ret=true;
}
delete this._undoRedoActive;
}
return ret;
},endEditing:function(_2d){
if(this._editTimer){
this._editTimer=this._editTimer.remove();
}
if(this._inEditing){
this._endEditing(_2d);
this._inEditing=false;
}
},_getBookmark:function(){
var b=this.selection.getBookmark();
var tmp=[];
if(b&&b.mark){
var _2e=b.mark;
if(_c("ie")<9||(_c("ie")===9&&_c("quirks"))){
var sel=_17.getSelection(this.window);
if(!_b.isArray(_2e)){
if(sel){
var _2f;
if(sel.rangeCount){
_2f=sel.getRangeAt(0);
}
if(_2f){
b.mark=_2f.cloneRange();
}else{
b.mark=this.selection.getBookmark();
}
}
}else{
_2.forEach(b.mark,function(n){
tmp.push(_17.getIndex(n,this.editNode).o);
},this);
b.mark=tmp;
}
}
try{
if(b.mark&&b.mark.startContainer){
tmp=_17.getIndex(b.mark.startContainer,this.editNode).o;
b.mark={startContainer:tmp,startOffset:b.mark.startOffset,endContainer:b.mark.endContainer===b.mark.startContainer?tmp:_17.getIndex(b.mark.endContainer,this.editNode).o,endOffset:b.mark.endOffset};
}
}
catch(e){
b.mark=null;
}
}
return b;
},_beginEditing:function(){
if(this._steps.length===0){
this._steps.push({"text":_16.getChildrenHtml(this.editNode),"bookmark":this._getBookmark()});
}
},_endEditing:function(){
var v=_16.getChildrenHtml(this.editNode);
this._undoedSteps=[];
this._steps.push({text:v,bookmark:this._getBookmark()});
},onKeyDown:function(e){
if(!_c("ie")&&!this.iframe&&e.keyCode==_a.TAB&&!this.tabIndent){
this._saveSelection();
}
if(!this.customUndo){
this.inherited(arguments);
return;
}
var k=e.keyCode;
if(e.ctrlKey&&!e.shiftKey&&!e.altKey){
if(k==90||k==122){
e.stopPropagation();
e.preventDefault();
this.undo();
return;
}else{
if(k==89||k==121){
e.stopPropagation();
e.preventDefault();
this.redo();
return;
}
}
}
this.inherited(arguments);
switch(k){
case _a.ENTER:
case _a.BACKSPACE:
case _a.DELETE:
this.beginEditing();
break;
case 88:
case 86:
if(e.ctrlKey&&!e.altKey&&!e.metaKey){
this.endEditing();
if(e.keyCode==88){
this.beginEditing("cut");
}else{
this.beginEditing("paste");
}
this.defer("endEditing",1);
break;
}
default:
if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.keyCode<_a.F1||e.keyCode>_a.F15)){
this.beginEditing();
break;
}
case _a.ALT:
this.endEditing();
break;
case _a.UP_ARROW:
case _a.DOWN_ARROW:
case _a.LEFT_ARROW:
case _a.RIGHT_ARROW:
case _a.HOME:
case _a.END:
case _a.PAGE_UP:
case _a.PAGE_DOWN:
this.endEditing(true);
break;
case _a.CTRL:
case _a.SHIFT:
case _a.TAB:
break;
}
},_onBlur:function(){
this.inherited(arguments);
this.endEditing(true);
},_saveSelection:function(){
try{
this._savedSelection=this._getBookmark();
}
catch(e){
}
},_restoreSelection:function(){
if(this._savedSelection){
delete this._cursorToStart;
if(this.selection.isCollapsed()){
this._moveToBookmark(this._savedSelection);
}
delete this._savedSelection;
}
},onClick:function(){
this.endEditing(true);
this.inherited(arguments);
},replaceValue:function(_30){
if(!this.customUndo){
this.inherited(arguments);
}else{
if(this.isClosed){
this.setValue(_30);
}else{
this.beginEditing();
if(!_30){
_30="&#160;";
}
this.setValue(_30);
this.endEditing();
}
}
},_setDisabledAttr:function(_31){
this.setValueDeferred.then(_b.hitch(this,function(){
if((!this.disabled&&_31)||(!this._buttonEnabledPlugins&&_31)){
_2.forEach(this._plugins,function(p){
p.set("disabled",true);
});
}else{
if(this.disabled&&!_31){
_2.forEach(this._plugins,function(p){
p.set("disabled",false);
});
}
}
}));
this.inherited(arguments);
},_setStateClass:function(){
try{
this.inherited(arguments);
if(this.document&&this.document.body){
_9.set(this.document.body,"color",_9.get(this.iframe,"color"));
}
}
catch(e){
}
}});
function _32(_33){
return new _14({command:_33.name});
};
function _34(_35){
return new _14({buttonClass:_13,command:_35.name});
};
_b.mixin(_14.registry,{"undo":_32,"redo":_32,"cut":_32,"copy":_32,"paste":_32,"insertOrderedList":_32,"insertUnorderedList":_32,"indent":_32,"outdent":_32,"justifyCenter":_32,"justifyFull":_32,"justifyLeft":_32,"justifyRight":_32,"delete":_32,"selectAll":_32,"removeFormat":_32,"unlink":_32,"insertHorizontalRule":_32,"bold":_34,"italic":_34,"underline":_34,"strikethrough":_34,"subscript":_34,"superscript":_34,"|":function(){
return new _14({setEditor:function(_36){
this.editor=_36;
this.button=new _11({ownerDocument:_36.ownerDocument});
}});
}});
return _1a;
});


;define("dijit/_editor/plugins/AlwaysShowToolbar",["dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","../_Plugin"],function(_1,_2,_3,_4,_5,on,_6,_7,_8){
return _1("dijit._editor.plugins.AlwaysShowToolbar",_8,{_handleScroll:true,setEditor:function(e){
if(!e.iframe){
console.log("Port AlwaysShowToolbar plugin to work with Editor without iframe");
return;
}
this.editor=e;
e.onLoadDeferred.then(_5.hitch(this,this.enable));
},enable:function(d){
this._updateHeight();
this.own(on(window,"scroll",_5.hitch(this,"globalOnScrollHandler")),this.editor.on("NormalizedDisplayChanged",_5.hitch(this,"_updateHeight")));
return d;
},_updateHeight:function(){
var e=this.editor;
if(!e.isLoaded){
return;
}
if(e.height){
return;
}
var _9=_4.getMarginSize(e.editNode).h;
if(_6("opera")){
_9=e.editNode.scrollHeight;
}
if(!_9){
_9=_4.getMarginSize(e.document.body).h;
}
if(this._fixEnabled){
_9+=_4.getMarginSize(this.editor.header).h;
}
if(_9==0){
console.debug("Can not figure out the height of the editing area!");
return;
}
if(_6("ie")<=7&&this.editor.minHeight){
var _a=parseInt(this.editor.minHeight);
if(_9<_a){
_9=_a;
}
}
if(_9!=this._lastHeight){
this._lastHeight=_9;
_4.setMarginBox(e.iframe,{h:this._lastHeight});
}
},_lastHeight:0,globalOnScrollHandler:function(){
var _b=_6("ie")<7;
if(!this._handleScroll){
return;
}
var _c=this.editor.header;
if(!this._scrollSetUp){
this._scrollSetUp=true;
this._scrollThreshold=_4.position(_c,true).y;
}
var _d=_4.docScroll(this.editor.ownerDocument).y;
var s=_c.style;
if(_d>this._scrollThreshold&&_d<this._scrollThreshold+this._lastHeight){
if(!this._fixEnabled){
var _e=_4.getMarginSize(_c);
this.editor.iframe.style.marginTop=_e.h+"px";
if(_b){
s.left=_4.position(_c).x;
if(_c.previousSibling){
this._IEOriginalPos=["after",_c.previousSibling];
}else{
if(_c.nextSibling){
this._IEOriginalPos=["before",_c.nextSibling];
}else{
this._IEOriginalPos=["last",_c.parentNode];
}
}
this.editor.ownerDocumentBody.appendChild(_c);
_2.add(_c,"dijitIEFixedToolbar");
}else{
s.position="fixed";
s.top="0px";
}
_4.setMarginBox(_c,{w:_e.w});
s.zIndex=2000;
this._fixEnabled=true;
}
var _f=(this.height)?parseInt(this.editor.height):this.editor._lastHeight;
s.display=(_d>this._scrollThreshold+_f)?"none":"";
}else{
if(this._fixEnabled){
this.editor.iframe.style.marginTop="";
s.position="";
s.top="";
s.zIndex="";
s.display="";
if(_b){
s.left="";
_2.remove(_c,"dijitIEFixedToolbar");
if(this._IEOriginalPos){
_3.place(_c,this._IEOriginalPos[1],this._IEOriginalPos[0]);
this._IEOriginalPos=null;
}else{
_3.place(_c,this.editor.iframe,"before");
}
}
s.width="";
this._fixEnabled=false;
}
}
},destroy:function(){
this._IEOriginalPos=null;
this._handleScroll=false;
this.inherited(arguments);
if(_6("ie")<7){
_2.remove(this.editor.header,"dijitIEFixedToolbar");
}
}});
});


;define("dojo/colors",["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(_1,_2,_3,_4){
var _5={};
_2.setObject("dojo.colors",_5);
var _6=function(m1,m2,h){
if(h<0){
++h;
}
if(h>1){
--h;
}
var h6=6*h;
if(h6<1){
return m1+(m2-m1)*h6;
}
if(2*h<1){
return m2;
}
if(3*h<2){
return m1+(m2-m1)*(2/3-h)*6;
}
return m1;
};
_1.colorFromRgb=_3.fromRgb=function(_7,_8){
var m=_7.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);
if(m){
var c=m[2].split(/\s*,\s*/),l=c.length,t=m[1],a;
if((t=="rgb"&&l==3)||(t=="rgba"&&l==4)){
var r=c[0];
if(r.charAt(r.length-1)=="%"){
a=_4.map(c,function(x){
return parseFloat(x)*2.56;
});
if(l==4){
a[3]=c[3];
}
return _3.fromArray(a,_8);
}
return _3.fromArray(c,_8);
}
if((t=="hsl"&&l==3)||(t=="hsla"&&l==4)){
var H=((parseFloat(c[0])%360)+360)%360/360,S=parseFloat(c[1])/100,L=parseFloat(c[2])/100,m2=L<=0.5?L*(S+1):L+S-L*S,m1=2*L-m2;
a=[_6(m1,m2,H+1/3)*256,_6(m1,m2,H)*256,_6(m1,m2,H-1/3)*256,1];
if(l==4){
a[3]=c[3];
}
return _3.fromArray(a,_8);
}
}
return null;
};
var _9=function(c,_a,_b){
c=Number(c);
return isNaN(c)?_b:c<_a?_a:c>_b?_b:c;
};
_3.prototype.sanitize=function(){
var t=this;
t.r=Math.round(_9(t.r,0,255));
t.g=Math.round(_9(t.g,0,255));
t.b=Math.round(_9(t.b,0,255));
t.a=_9(t.a,0,1);
return this;
};
_5.makeGrey=_3.makeGrey=function(g,a){
return _3.fromArray([g,g,g,a]);
};
_2.mixin(_3.named,{"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"blanchedalmond":[255,235,205],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"oldlace":[253,245,230],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"whitesmoke":[245,245,245],"yellowgreen":[154,205,50]});
return _3;
});


;define("dijit/_editor/plugins/TextColor",["require","dojo/colors","dojo/_base/declare","dojo/_base/lang","../_Plugin","../../form/DropDownButton"],function(_1,_2,_3,_4,_5,_6){
var _7=_3("dijit._editor.plugins.TextColor",_5,{buttonClass:_6,colorPicker:"dijit/ColorPalette",useDefaultCommand:false,_initButton:function(){
this.command=this.name;
this.inherited(arguments);
var _8=this;
this.button.loadDropDown=function(_9){
function _a(_b){
_8.button.dropDown=new _b({dir:_8.editor.dir,ownerDocument:_8.editor.ownerDocument,value:_8.value,onChange:function(_c){
_8.editor.execCommand(_8.command,_c);
},onExecute:function(){
_8.editor.execCommand(_8.command,this.get("value"));
}});
_9();
};
if(typeof _8.colorPicker=="string"){
_1([_8.colorPicker],_a);
}else{
_a(_8.colorPicker);
}
};
},updateState:function(){
var _d=this.editor;
var _e=this.command;
if(!_d||!_d.isLoaded||!_e.length){
return;
}
if(this.button){
var _f=this.get("disabled");
this.button.set("disabled",_f);
if(_f){
return;
}
var _10;
try{
_10=_d.queryCommandValue(_e)||"";
}
catch(e){
_10="";
}
}
if(_10==""){
_10="#000000";
}
if(_10=="transparent"){
_10="#ffffff";
}
if(typeof _10=="string"){
if(_10.indexOf("rgb")>-1){
_10=_2.fromRgb(_10).toHex();
}
}else{
_10=((_10&255)<<16)|(_10&65280)|((_10&16711680)>>>16);
_10=_10.toString(16);
_10="#000000".slice(0,7-_10.length)+_10;
}
this.value=_10;
var _11=this.button.dropDown;
if(_11&&_11.get&&_10!==_11.get("value")){
_11.set("value",_10,false);
}
}});
_5.registry["foreColor"]=function(_12){
return new _7(_12);
};
_5.registry["hiliteColor"]=function(_13){
return new _7(_13);
};
return _7;
});


;define("dojo/text!dijit/templates/ColorPalette.html", '<div class="dijitInline dijitColorPalette" role="grid">\n	<table data-dojo-attach-point="paletteTableNode" class="dijitPaletteTable" cellSpacing="0" cellPadding="0" role="presentation">\n		<tbody data-dojo-attach-point="gridNode"></tbody>\n	</table>\n</div>\n');

;define("dijit/_PaletteMixin",["dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/keys","dojo/_base/lang","dojo/on","./_CssStateMixin","./a11yclick","./focus","./typematic"],function(_1,_2,_3,_4,_5,_6,on,_7,_8,_9,_a){
var _b=_1("dijit._PaletteMixin",_7,{defaultTimeout:500,timeoutChangeRate:0.9,value:"",_selectedCell:-1,tabIndex:"0",cellClass:"dijitPaletteCell",dyeClass:null,_dyeFactory:function(_c){
var _d=typeof this.dyeClass=="string"?_6.getObject(this.dyeClass):this.dyeClass;
return new _d(_c);
},_preparePalette:function(_e,_f){
this._cells=[];
var url=this._blankGif;
this.own(on(this.gridNode,_8,_6.hitch(this,"_onCellClick")));
for(var row=0;row<_e.length;row++){
var _10=_4.create("tr",{tabIndex:"-1",role:"row"},this.gridNode);
for(var col=0;col<_e[row].length;col++){
var _11=_e[row][col];
if(_11){
var _12=this._dyeFactory(_11,row,col,_f[_11]);
var _13=_4.create("td",{"class":this.cellClass,tabIndex:"-1",title:_f[_11],role:"gridcell"},_10);
_12.fillCell(_13,url);
_13.idx=this._cells.length;
this._cells.push({node:_13,dye:_12});
}
}
}
this._xDim=_e[0].length;
this._yDim=_e.length;
var _14={UP_ARROW:-this._xDim,DOWN_ARROW:this._xDim,RIGHT_ARROW:this.isLeftToRight()?1:-1,LEFT_ARROW:this.isLeftToRight()?-1:1};
for(var key in _14){
this.own(_a.addKeyListener(this.domNode,{keyCode:_5[key],ctrlKey:false,altKey:false,shiftKey:false},this,function(){
var _15=_14[key];
return function(_16){
this._navigateByKey(_15,_16);
};
}(),this.timeoutChangeRate,this.defaultTimeout));
}
},postCreate:function(){
this.inherited(arguments);
this._setCurrent(this._cells[0].node);
},focus:function(){
_9.focus(this._currentFocus);
},_onCellClick:function(evt){
var _17=evt.target;
while(_17.tagName!="TD"){
if(!_17.parentNode||_17==this.gridNode){
return;
}
_17=_17.parentNode;
}
var _18=this._getDye(_17).getValue();
this._setCurrent(_17);
_9.focus(_17);
this._setValueAttr(_18,true);
evt.stopPropagation();
evt.preventDefault();
},_setCurrent:function(_19){
if("_currentFocus" in this){
_2.set(this._currentFocus,"tabIndex","-1");
}
this._currentFocus=_19;
if(_19){
_2.set(_19,"tabIndex",this.tabIndex);
}
},_setValueAttr:function(_1a,_1b){
if(this._selectedCell>=0){
_3.remove(this._cells[this._selectedCell].node,this.cellClass+"Selected");
}
this._selectedCell=-1;
if(_1a){
for(var i=0;i<this._cells.length;i++){
if(_1a==this._cells[i].dye.getValue()){
this._selectedCell=i;
_3.add(this._cells[i].node,this.cellClass+"Selected");
break;
}
}
}
this._set("value",this._selectedCell>=0?_1a:null);
if(_1b||_1b===undefined){
this.onChange(_1a);
}
},onChange:function(){
},_navigateByKey:function(_1c,_1d){
if(_1d==-1){
return;
}
var _1e=this._currentFocus.idx+_1c;
if(_1e<this._cells.length&&_1e>-1){
var _1f=this._cells[_1e].node;
this._setCurrent(_1f);
this.defer(_6.hitch(_9,"focus",_1f));
}
},_getDye:function(_20){
return this._cells[_20.idx].dye;
}});
return _b;
});


;define("dojo/i18n!dojo/nls/colors", {"tomato":"tomato","seagreen":"sea green","palegreen":"pale green","gainsboro":"gainsboro","goldenrod":"goldenrod","white":"white","orange":"orange","coral":"coral","palegoldenrod":"pale goldenrod","bisque":"bisque","chocolate":"chocolate","lightgoldenrodyellow":"light goldenrod yellow","limegreen":"lime green","lightsteelblue":"light steel blue","saddlebrown":"saddle brown","dodgerblue":"dodger blue","mediumorchid":"medium orchid","blue":"blue","teal":"teal","gold":"gold","deeppink":"deep pink","gray":"gray","darkturquoise":"dark turquoise","mistyrose":"misty rose","salmon":"salmon","lightblue":"light blue","maroon":"maroon","darkmagenta":"dark magenta","yellow":"yellow","lightgray":"light gray","violet":"violet","mediumspringgreen":"medium spring green","mediumseagreen":"medium sea green","azure":"azure","deepskyblue":"deep sky blue","red":"red","powderblue":"powder blue","orchid":"orchid","steelblue":"steel blue","navajowhite":"navajo white","ivory":"ivory","magenta":"magenta","mediumaquamarine":"medium aquamarine","aqua":"aqua","darkslateblue":"dark slate blue","darkslategray":"dark slate gray","cadetblue":"cadet blue","darkblue":"dark blue","indigo":"indigo","fuchsia":"fuchsia","darkgray":"dark gray","aliceblue":"alice blue","lightcoral":"light coral","cornflowerblue":"cornflower blue","crimson":"crimson","grey":"gray","papayawhip":"papaya whip","whitesmoke":"white smoke","wheat":"wheat","dimgray":"dim gray","lemonchiffon":"lemon chiffon","lightgrey":"light gray","peru":"peru","burlywood":"burlywood","ghostwhite":"ghost white","linen":"linen","honeydew":"honeydew","skyblue":"sky blue","khaki":"khaki","green":"green","lightsalmon":"light salmon","forestgreen":"forest green","lightyellow":"light yellow","silver":"silver","yellowgreen":"yellow green","springgreen":"spring green","indianred":"indian red","turquoise":"turquoise","cyan":"cyan","darkorange":"dark orange","lightskyblue":"light sky blue","lightslategray":"light slate gray","lightseagreen":"light sea green","midnightblue":"midnight blue","brown":"brown","greenyellow":"green-yellow","paleturquoise":"pale turquoise","lightcyan":"light cyan","oldlace":"old lace","seashell":"seashell","darkslategrey":"dark slate gray","hotpink":"hot pink","darkkhaki":"dark khaki","mediumturquoise":"medium turquoise","darkgreen":"dark green","mediumblue":"medium blue","transparent":"transparent","darkgrey":"dark gray","chartreuse":"chartreuse","blueviolet":"blue-violet","moccasin":"moccasin","darkred":"dark red","mintcream":"mint cream","darksalmon":"dark salmon","dimgrey":"dim gray","darkgoldenrod":"dark goldenrod","antiquewhite":"antique white","mediumpurple":"medium purple","sienna":"sienna","slateblue":"slate blue","darkviolet":"dark violet","peachpuff":"peach puff","pink":"pink","lawngreen":"lawn green","slategray":"slate gray","aquamarine":"aquamarine","blanchedalmond":"blanched almond","snow":"snow","darkseagreen":"dark sea green","olivedrab":"olive drab","lightpink":"light pink","thistle":"thistle","plum":"plum","floralwhite":"floral white","darkcyan":"dark cyan","darkorchid":"dark orchid","lavenderblush":"lavender blush","mediumslateblue":"medium slate blue","tan":"tan","lightslategrey":"light slate gray","orangered":"orange red","lightgreen":"light green","rosybrown":"rosy brown","navy":"navy","purple":"purple","lavender":"lavender","palevioletred":"pale violet-red","firebrick":"fire brick","lime":"lime","olive":"olive","mediumvioletred":"medium violet-red","royalblue":"royal blue","sandybrown":"sandy brown","beige":"beige","slategrey":"slate gray","cornsilk":"cornsilk","darkolivegreen":"dark olive green","black":"black"});

;define("dijit/ColorPalette",["require","dojo/text!./templates/ColorPalette.html","./_Widget","./_TemplatedMixin","./_PaletteMixin","./hccss","dojo/i18n","dojo/_base/Color","dojo/_base/declare","dojo/dom-construct","dojo/string","dojo/i18n!dojo/nls/colors","dojo/colors"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
var _c=_9("dijit.ColorPalette",[_3,_4,_5],{palette:"7x10",_palettes:{"7x10":[["white","seashell","cornsilk","lemonchiffon","lightyellow","palegreen","paleturquoise","lightcyan","lavender","plum"],["lightgray","pink","bisque","moccasin","khaki","lightgreen","lightseagreen","lightskyblue","cornflowerblue","violet"],["silver","lightcoral","sandybrown","orange","palegoldenrod","chartreuse","mediumturquoise","skyblue","mediumslateblue","orchid"],["gray","red","orangered","darkorange","yellow","limegreen","darkseagreen","royalblue","slateblue","mediumorchid"],["dimgray","crimson","chocolate","coral","gold","forestgreen","seagreen","blue","blueviolet","darkorchid"],["darkslategray","firebrick","saddlebrown","sienna","olive","green","darkcyan","mediumblue","darkslateblue","darkmagenta"],["black","darkred","maroon","brown","darkolivegreen","darkgreen","midnightblue","navy","indigo","purple"]],"3x4":[["white","lime","green","blue"],["silver","yellow","fuchsia","navy"],["gray","red","purple","black"]]},templateString:_2,baseClass:"dijitColorPalette",_dyeFactory:function(_d,_e,_f,_10){
return new this._dyeClass(_d,_e,_f,_10);
},buildRendering:function(){
this.inherited(arguments);
this._dyeClass=_9(_c._Color,{palette:this.palette});
this._preparePalette(this._palettes[this.palette],_7.getLocalization("dojo","colors",this.lang));
}});
_c._Color=_9("dijit._Color",_8,{template:"<span class='dijitInline dijitPaletteImg'>"+"<img src='${blankGif}' alt='${alt}' title='${title}' class='dijitColorPaletteSwatch' style='background-color: ${color}'/>"+"</span>",hcTemplate:"<span class='dijitInline dijitPaletteImg' style='position: relative; overflow: hidden; height: 12px; width: 14px;'>"+"<img src='${image}' alt='${alt}' title='${title}' style='position: absolute; left: ${left}px; top: ${top}px; ${size}'/>"+"</span>",_imagePaths:{"7x10":_1.toUrl("dijit/themes/a11y/colors7x10.png?etag=Z6uJWzG"),"3x4":_1.toUrl("dijit/themes/a11y/colors3x4.png?etag=Z6uJWzG")},constructor:function(_11,row,col,_12){
this._title=_12;
this._row=row;
this._col=col;
this.setColor(_8.named[_11]);
},getValue:function(){
return this.toHex();
},fillCell:function(_13,_14){
var _15=_b.substitute(_6("highcontrast")?this.hcTemplate:this.template,{color:this.toHex(),blankGif:_14,alt:this._title,title:this._title,image:this._imagePaths[this.palette].toString(),left:this._col*-20-5,top:this._row*-20-5,size:this.palette=="7x10"?"height: 145px; width: 206px":"height: 64px; width: 86px"});
_a.place(_15,_13);
}});
return _c;
});


;define("dojo/text!dijit/templates/TreeNode.html", '<div class="dijitTreeNode" role="presentation"\n	><div data-dojo-attach-point="rowNode" class="dijitTreeRow" role="presentation"\n		><span data-dojo-attach-point="expandoNode" class="dijitInline dijitTreeExpando" role="presentation"></span\n		><span data-dojo-attach-point="expandoNodeText" class="dijitExpandoText" role="presentation"></span\n		><span data-dojo-attach-point="contentNode"\n			class="dijitTreeContent" role="presentation">\n			<span role="presentation" class="dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point="iconNode"></span\n			><span data-dojo-attach-point="labelNode,focusNode" class="dijitTreeLabel" role="treeitem"\n				   tabindex="-1" aria-selected="false" id="${id}_label"></span>\n		</span\n	></div>\n	<div data-dojo-attach-point="containerNode" class="dijitTreeNodeContainer" role="presentation"\n		 style="display: none;" aria-labelledby="${id}_label"></div>\n</div>\n');

;define("dojo/text!dijit/templates/Tree.html", '<div role="tree">\n	<div class="dijitInline dijitTreeIndent" style="position: absolute; top: -9999px" data-dojo-attach-point="indentDetector"></div>\n	<div class="dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point="rootLoadingIndicator"></div>\n	<div data-dojo-attach-point="containerNode" class="dijitTreeContainer" role="presentation">\n	</div>\n</div>\n');

;define("dijit/tree/TreeStoreModel",["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(_1,_2,_3,_4){
return _3("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:false,constructor:function(_5){
_4.mixin(this,_5);
this.connects=[];
var _6=this.store;
if(!_6.getFeatures()["dojo.data.api.Identity"]){
throw new Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");
}
if(_6.getFeatures()["dojo.data.api.Notification"]){
this.connects=this.connects.concat([_2.after(_6,"onNew",_4.hitch(this,"onNewItem"),true),_2.after(_6,"onDelete",_4.hitch(this,"onDeleteItem"),true),_2.after(_6,"onSet",_4.hitch(this,"onSetItem"),true)]);
}
},destroy:function(){
var h;
while(h=this.connects.pop()){
h.remove();
}
},getRoot:function(_7,_8){
if(this.root){
_7(this.root);
}else{
this.store.fetch({query:this.query,onComplete:_4.hitch(this,function(_9){
if(_9.length!=1){
throw new Error("dijit.tree.TreeStoreModel: root query returned "+_9.length+" items, but must return exactly one");
}
this.root=_9[0];
_7(this.root);
}),onError:_8});
}
},mayHaveChildren:function(_a){
return _1.some(this.childrenAttrs,function(_b){
return this.store.hasAttribute(_a,_b);
},this);
},getChildren:function(_c,_d,_e){
var _f=this.store;
if(!_f.isItemLoaded(_c)){
var _10=_4.hitch(this,arguments.callee);
_f.loadItem({item:_c,onItem:function(_11){
_10(_11,_d,_e);
},onError:_e});
return;
}
var _12=[];
for(var i=0;i<this.childrenAttrs.length;i++){
var _13=_f.getValues(_c,this.childrenAttrs[i]);
_12=_12.concat(_13);
}
var _14=0;
if(!this.deferItemLoadingUntilExpand){
_1.forEach(_12,function(_15){
if(!_f.isItemLoaded(_15)){
_14++;
}
});
}
if(_14==0){
_d(_12);
}else{
_1.forEach(_12,function(_16,idx){
if(!_f.isItemLoaded(_16)){
_f.loadItem({item:_16,onItem:function(_17){
_12[idx]=_17;
if(--_14==0){
_d(_12);
}
},onError:_e});
}
});
}
},isItem:function(_18){
return this.store.isItem(_18);
},fetchItemByIdentity:function(_19){
this.store.fetchItemByIdentity(_19);
},getIdentity:function(_1a){
return this.store.getIdentity(_1a);
},getLabel:function(_1b){
if(this.labelAttr){
return this.store.getValue(_1b,this.labelAttr);
}else{
return this.store.getLabel(_1b);
}
},newItem:function(_1c,_1d,_1e){
var _1f={parent:_1d,attribute:this.childrenAttrs[0]},_20;
if(this.newItemIdAttr&&_1c[this.newItemIdAttr]){
this.fetchItemByIdentity({identity:_1c[this.newItemIdAttr],scope:this,onItem:function(_21){
if(_21){
this.pasteItem(_21,null,_1d,true,_1e);
}else{
_20=this.store.newItem(_1c,_1f);
if(_20&&(_1e!=undefined)){
this.pasteItem(_20,_1d,_1d,false,_1e);
}
}
}});
}else{
_20=this.store.newItem(_1c,_1f);
if(_20&&(_1e!=undefined)){
this.pasteItem(_20,_1d,_1d,false,_1e);
}
}
},pasteItem:function(_22,_23,_24,_25,_26){
var _27=this.store,_28=this.childrenAttrs[0];
if(_23){
_1.forEach(this.childrenAttrs,function(_29){
if(_27.containsValue(_23,_29,_22)){
if(!_25){
var _2a=_1.filter(_27.getValues(_23,_29),function(x){
return x!=_22;
});
_27.setValues(_23,_29,_2a);
}
_28=_29;
}
});
}
if(_24){
if(typeof _26=="number"){
var _2b=_27.getValues(_24,_28).slice();
_2b.splice(_26,0,_22);
_27.setValues(_24,_28,_2b);
}else{
_27.setValues(_24,_28,_27.getValues(_24,_28).concat(_22));
}
}
},onChange:function(){
},onChildrenChange:function(){
},onDelete:function(){
},onNewItem:function(_2c,_2d){
if(!_2d){
return;
}
this.getChildren(_2d.item,_4.hitch(this,function(_2e){
this.onChildrenChange(_2d.item,_2e);
}));
},onDeleteItem:function(_2f){
this.onDelete(_2f);
},onSetItem:function(_30,_31){
if(_1.indexOf(this.childrenAttrs,_31)!=-1){
this.getChildren(_30,_4.hitch(this,function(_32){
this.onChildrenChange(_30,_32);
}));
}else{
this.onChange(_30);
}
}});
});


;define("dijit/tree/ForestStoreModel",["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(_1,_2,_3,_4,_5){
return _2("dijit.tree.ForestStoreModel",_5,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(_6){
this.root={store:this,root:true,id:_6.rootId,label:_6.rootLabel,children:_6.rootChildren};
},mayHaveChildren:function(_7){
return _7===this.root||this.inherited(arguments);
},getChildren:function(_8,_9,_a){
if(_8===this.root){
if(this.root.children){
_9(this.root.children);
}else{
this.store.fetch({query:this.query,onComplete:_4.hitch(this,function(_b){
this.root.children=_b;
_9(_b);
}),onError:_a});
}
}else{
this.inherited(arguments);
}
},isItem:function(_c){
return (_c===this.root)?true:this.inherited(arguments);
},fetchItemByIdentity:function(_d){
if(_d.identity==this.root.id){
var _e=_d.scope||_3.global;
if(_d.onItem){
_d.onItem.call(_e,this.root);
}
}else{
this.inherited(arguments);
}
},getIdentity:function(_f){
return (_f===this.root)?this.root.id:this.inherited(arguments);
},getLabel:function(_10){
return (_10===this.root)?this.root.label:this.inherited(arguments);
},newItem:function(_11,_12,_13){
if(_12===this.root){
this.onNewRootItem(_11);
return this.store.newItem(_11);
}else{
return this.inherited(arguments);
}
},onNewRootItem:function(){
},pasteItem:function(_14,_15,_16,_17,_18){
if(_15===this.root){
if(!_17){
this.onLeaveRoot(_14);
}
}
this.inherited(arguments,[_14,_15===this.root?null:_15,_16===this.root?null:_16,_17,_18]);
if(_16===this.root){
this.onAddToRoot(_14);
}
},onAddToRoot:function(_19){
console.log(this,": item ",_19," added to root");
},onLeaveRoot:function(_1a){
console.log(this,": item ",_1a," removed from root");
},_requeryTop:function(){
var _1b=this.root.children||[];
this.store.fetch({query:this.query,onComplete:_4.hitch(this,function(_1c){
this.root.children=_1c;
if(_1b.length!=_1c.length||_1.some(_1b,function(_1d,idx){
return _1c[idx]!=_1d;
})){
this.onChildrenChange(this.root,_1c);
}
})});
},onNewItem:function(_1e,_1f){
this._requeryTop();
this.inherited(arguments);
},onDeleteItem:function(_20){
if(_1.indexOf(this.root.children,_20)!=-1){
this._requeryTop();
}
this.inherited(arguments);
},onSetItem:function(_21,_22,_23,_24){
this._requeryTop();
this.inherited(arguments);
}});
});


;define("dijit/tree/_dndContainer",["dojo/aspect","dojo/_base/declare","dojo/dom-class","dojo/_base/lang","dojo/on","dojo/touch"],function(_1,_2,_3,_4,on,_5){
return _2("dijit.tree._dndContainer",null,{constructor:function(_6,_7){
this.tree=_6;
this.node=_6.domNode;
_4.mixin(this,_7);
this.containerState="";
_3.add(this.node,"dojoDndContainer");
this.events=[on(this.node,_5.enter,_4.hitch(this,"onOverEvent")),on(this.node,_5.leave,_4.hitch(this,"onOutEvent")),_1.after(this.tree,"_onNodeMouseEnter",_4.hitch(this,"onMouseOver"),true),_1.after(this.tree,"_onNodeMouseLeave",_4.hitch(this,"onMouseOut"),true),on(this.node,"dragstart, selectstart",function(_8){
_8.preventDefault();
})];
},destroy:function(){
var h;
while(h=this.events.pop()){
h.remove();
}
this.node=this.parent=null;
},onMouseOver:function(_9){
this.current=_9;
},onMouseOut:function(){
this.current=null;
},_changeState:function(_a,_b){
var _c="dojoDnd"+_a;
var _d=_a.toLowerCase()+"State";
_3.replace(this.node,_c+_b,_c+this[_d]);
this[_d]=_b;
},_addItemClass:function(_e,_f){
_3.add(_e,"dojoDndItem"+_f);
},_removeItemClass:function(_10,_11){
_3.remove(_10,"dojoDndItem"+_11);
},onOverEvent:function(){
this._changeState("Container","Over");
},onOutEvent:function(){
this._changeState("Container","");
}});
});


;define("dijit/tree/_dndSelector",["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/dnd/common","dojo/dom","dojo/mouse","dojo/on","dojo/touch","../a11yclick","./_dndContainer"],function(_1,_2,_3,_4,_5,_6,_7,on,_8,_9,_a){
return _2("dijit.tree._dndSelector",_a,{constructor:function(){
this.selection={};
this.anchor=null;
this.events.push(on(this.tree.domNode,_8.press,_4.hitch(this,"onMouseDown")),on(this.tree.domNode,_8.release,_4.hitch(this,"onMouseUp")),on(this.tree.domNode,_8.move,_4.hitch(this,"onMouseMove")),on(this.tree.domNode,_9.press,_4.hitch(this,"onClickPress")),on(this.tree.domNode,_9.release,_4.hitch(this,"onClickRelease")));
},singular:false,getSelectedTreeNodes:function(){
var _b=[],_c=this.selection;
for(var i in _c){
_b.push(_c[i]);
}
return _b;
},selectNone:function(){
this.setSelection([]);
return this;
},destroy:function(){
this.inherited(arguments);
this.selection=this.anchor=null;
},addTreeNode:function(_d,_e){
this.setSelection(this.getSelectedTreeNodes().concat([_d]));
if(_e){
this.anchor=_d;
}
return _d;
},removeTreeNode:function(_f){
var _10=_1.filter(this.getSelectedTreeNodes(),function(_11){
return !_6.isDescendant(_11.domNode,_f.domNode);
});
this.setSelection(_10);
return _f;
},isTreeNodeSelected:function(_12){
return _12.id&&!!this.selection[_12.id];
},setSelection:function(_13){
var _14=this.getSelectedTreeNodes();
_1.forEach(this._setDifference(_14,_13),_4.hitch(this,function(_15){
_15.setSelected(false);
if(this.anchor==_15){
delete this.anchor;
}
delete this.selection[_15.id];
}));
_1.forEach(this._setDifference(_13,_14),_4.hitch(this,function(_16){
_16.setSelected(true);
this.selection[_16.id]=_16;
}));
this._updateSelectionProperties();
},_setDifference:function(xs,ys){
_1.forEach(ys,function(y){
y.__exclude__=true;
});
var ret=_1.filter(xs,function(x){
return !x.__exclude__;
});
_1.forEach(ys,function(y){
delete y["__exclude__"];
});
return ret;
},_updateSelectionProperties:function(){
var _17=this.getSelectedTreeNodes();
var _18=[],_19=[];
_1.forEach(_17,function(_1a){
var ary=_1a.getTreePath();
_19.push(_1a);
_18.push(ary);
},this);
var _1b=_1.map(_19,function(_1c){
return _1c.item;
});
this.tree._set("paths",_18);
this.tree._set("path",_18[0]||[]);
this.tree._set("selectedNodes",_19);
this.tree._set("selectedNode",_19[0]||null);
this.tree._set("selectedItems",_1b);
this.tree._set("selectedItem",_1b[0]||null);
},onClickPress:function(e){
if(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(e.target,this.current)){
return;
}
if(e.type=="mousedown"&&_7.isLeft(e)){
e.preventDefault();
}
var _1d=e.type=="keydown"?this.tree.focusedChild:this.current;
if(!_1d){
return;
}
var _1e=_5.getCopyKeyState(e),id=_1d.id;
if(!this.singular&&!e.shiftKey&&this.selection[id]){
this._doDeselect=true;
return;
}else{
this._doDeselect=false;
}
this.userSelect(_1d,_1e,e.shiftKey);
},onClickRelease:function(e){
if(!this._doDeselect){
return;
}
this._doDeselect=false;
this.userSelect(e.type=="keyup"?this.tree.focusedChild:this.current,_5.getCopyKeyState(e),e.shiftKey);
},onMouseMove:function(){
this._doDeselect=false;
},onMouseDown:function(){
},onMouseUp:function(){
},_compareNodes:function(n1,n2){
if(n1===n2){
return 0;
}
if("sourceIndex" in document.documentElement){
return n1.sourceIndex-n2.sourceIndex;
}else{
if("compareDocumentPosition" in document.documentElement){
return n1.compareDocumentPosition(n2)&2?1:-1;
}else{
if(document.createRange){
var r1=doc.createRange();
r1.setStartBefore(n1);
var r2=doc.createRange();
r2.setStartBefore(n2);
return r1.compareBoundaryPoints(r1.END_TO_END,r2);
}else{
throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
}
}
}
},userSelect:function(_1f,_20,_21){
if(this.singular){
if(this.anchor==_1f&&_20){
this.selectNone();
}else{
this.setSelection([_1f]);
this.anchor=_1f;
}
}else{
if(_21&&this.anchor){
var cr=this._compareNodes(this.anchor.rowNode,_1f.rowNode),_22,end,_23=this.anchor;
if(cr<0){
_22=_23;
end=_1f;
}else{
_22=_1f;
end=_23;
}
var _24=[];
while(_22!=end){
_24.push(_22);
_22=this.tree._getNext(_22);
}
_24.push(end);
this.setSelection(_24);
}else{
if(this.selection[_1f.id]&&_20){
this.removeTreeNode(_1f);
}else{
if(_20){
this.addTreeNode(_1f,true);
}else{
this.setSelection([_1f]);
this.anchor=_1f;
}
}
}
}
},getItem:function(key){
var _25=this.selection[key];
return {data:_25,type:["treeNode"]};
},forInSelectedItems:function(f,o){
o=o||_3.global;
for(var id in this.selection){
f.call(o,this.getItem(id),id,this);
}
}});
});


;define("dijit/Tree",["dojo/_base/array","dojo/aspect","dojo/cookie","dojo/_base/declare","dojo/Deferred","dojo/promise/all","dojo/dom","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/errors/create","dojo/fx","dojo/has","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/topic","dojo/touch","dojo/when","./a11yclick","./focus","./registry","./_base/manager","./_Widget","./_TemplatedMixin","./_Container","./_Contained","./_CssStateMixin","./_KeyNavMixin","dojo/text!./templates/TreeNode.html","dojo/text!./templates/Tree.html","./tree/TreeStoreModel","./tree/ForestStoreModel","./tree/_dndSelector"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,on,_11,_12,_13,_14,_15,_16,_17,_18,_19,_1a,_1b,_1c,_1d,_1e,_1f,_20,_21,_22){
var _23=true;
try{
window.localStorage;
}
catch(e){
console.warn("Unable to access localStorage: "+e);
_23=false;
}
function _24(d){
return _10.delegate(d.promise||d,{addCallback:function(_25){
this.then(_25);
},addErrback:function(_26){
this.otherwise(_26);
}});
};
var _27=_4("dijit._TreeNode",[_18,_19,_1a,_1b,_1c],{item:null,isTreeNode:true,label:"",_setLabelAttr:function(val){
this.labelNode[this.labelType=="html"?"innerHTML":"innerText" in this.labelNode?"innerText":"textContent"]=val;
this._set("label",val);
if(_d("dojo-bidi")){
this.applyTextDir(this.labelNode);
}
},labelType:"text",isExpandable:null,isExpanded:false,state:"NotLoaded",templateString:_1e,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){
this.inherited(arguments);
this._setExpando();
this._updateItemClasses(this.item);
if(this.isExpandable){
this.labelNode.setAttribute("aria-expanded",this.isExpanded);
}
this.setSelected(false);
},_setIndentAttr:function(_28){
var _29=(Math.max(_28,0)*this.tree._nodePixelIndent)+"px";
_a.set(this.domNode,"backgroundPosition",_29+" 0px");
_a.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",_29);
_1.forEach(this.getChildren(),function(_2a){
_2a.set("indent",_28+1);
});
this._set("indent",_28);
},markProcessing:function(){
this.state="Loading";
this._setExpando(true);
},unmarkProcessing:function(){
this._setExpando(false);
},_updateItemClasses:function(_2b){
var _2c=this.tree,_2d=_2c.model;
if(_2c._v10Compat&&_2b===_2d.root){
_2b=null;
}
this._applyClassAndStyle(_2b,"icon","Icon");
this._applyClassAndStyle(_2b,"label","Label");
this._applyClassAndStyle(_2b,"row","Row");
this.tree._startPaint(true);
},_applyClassAndStyle:function(_2e,_2f,_30){
var _31="_"+_2f+"Class";
var _32=_2f+"Node";
var _33=this[_31];
this[_31]=this.tree["get"+_30+"Class"](_2e,this.isExpanded);
_8.replace(this[_32],this[_31]||"",_33||"");
_a.set(this[_32],this.tree["get"+_30+"Style"](_2e,this.isExpanded)||{});
},_updateLayout:function(){
var _34=this.getParent(),_35=!_34||!_34.rowNode||_34.rowNode.style.display=="none";
_8.toggle(this.domNode,"dijitTreeIsRoot",_35);
_8.toggle(this.domNode,"dijitTreeIsLast",!_35&&!this.getNextSibling());
},_setExpando:function(_36){
var _37=["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"],_38=["*","-","+","*"],idx=_36?0:(this.isExpandable?(this.isExpanded?1:2):3);
_8.replace(this.expandoNode,_37[idx],_37);
this.expandoNodeText.innerHTML=_38[idx];
},expand:function(){
if(this._expandDeferred){
return _24(this._expandDeferred);
}
if(this._collapseDeferred){
this._collapseDeferred.cancel();
delete this._collapseDeferred;
}
this.isExpanded=true;
this.labelNode.setAttribute("aria-expanded","true");
if(this.tree.showRoot||this!==this.tree.rootNode){
this.containerNode.setAttribute("role","group");
}
_8.add(this.contentNode,"dijitTreeContentExpanded");
this._setExpando();
this._updateItemClasses(this.item);
if(this==this.tree.rootNode&&this.tree.showRoot){
this.tree.domNode.setAttribute("aria-expanded","true");
}
var _39=_c.wipeIn({node:this.containerNode,duration:_17.defaultDuration});
var def=(this._expandDeferred=new _5(function(){
_39.stop();
}));
_2.after(_39,"onEnd",function(){
def.resolve(true);
},true);
_39.play();
return _24(def);
},collapse:function(){
if(this._collapseDeferred){
return _24(this._collapseDeferred);
}
if(this._expandDeferred){
this._expandDeferred.cancel();
delete this._expandDeferred;
}
this.isExpanded=false;
this.labelNode.setAttribute("aria-expanded","false");
if(this==this.tree.rootNode&&this.tree.showRoot){
this.tree.domNode.setAttribute("aria-expanded","false");
}
_8.remove(this.contentNode,"dijitTreeContentExpanded");
this._setExpando();
this._updateItemClasses(this.item);
var _3a=_c.wipeOut({node:this.containerNode,duration:_17.defaultDuration});
var def=(this._collapseDeferred=new _5(function(){
_3a.stop();
}));
_2.after(_3a,"onEnd",function(){
def.resolve(true);
},true);
_3a.play();
return _24(def);
},indent:0,setChildItems:function(_3b){
var _3c=this.tree,_3d=_3c.model,_3e=[];
var _3f=_3c.focusedChild;
var _40=this.getChildren();
_1.forEach(_40,function(_41){
_1a.prototype.removeChild.call(this,_41);
},this);
this.defer(function(){
_1.forEach(_40,function(_42){
if(!_42._destroyed&&!_42.getParent()){
_3c.dndController.removeTreeNode(_42);
function _43(_44){
var id=_3d.getIdentity(_44.item),ary=_3c._itemNodesMap[id];
if(ary.length==1){
delete _3c._itemNodesMap[id];
}else{
var _45=_1.indexOf(ary,_44);
if(_45!=-1){
ary.splice(_45,1);
}
}
_1.forEach(_44.getChildren(),_43);
};
_43(_42);
if(_3c.persist){
var _46=_1.map(_42.getTreePath(),function(_47){
return _3c.model.getIdentity(_47);
}).join("/");
for(var _48 in _3c._openedNodes){
if(_48.substr(0,_46.length)==_46){
delete _3c._openedNodes[_48];
}
}
_3c._saveExpandedNodes();
}
if(_3c.lastFocusedChild&&!_7.isDescendant(_3c.lastFocusedChild,_3c.domNode)){
delete _3c.lastFocusedChild;
}
if(_3f&&!_7.isDescendant(_3f,_3c.domNode)){
_3c.focus();
}
_42.destroyRecursive();
}
});
});
this.state="Loaded";
if(_3b&&_3b.length>0){
this.isExpandable=true;
_1.forEach(_3b,function(_49){
var id=_3d.getIdentity(_49),_4a=_3c._itemNodesMap[id],_4b;
if(_4a){
for(var i=0;i<_4a.length;i++){
if(_4a[i]&&!_4a[i].getParent()){
_4b=_4a[i];
_4b.set("indent",this.indent+1);
break;
}
}
}
if(!_4b){
_4b=this.tree._createTreeNode({item:_49,tree:_3c,isExpandable:_3d.mayHaveChildren(_49),label:_3c.getLabel(_49),labelType:(_3c.model&&_3c.model.labelType)||"text",tooltip:_3c.getTooltip(_49),ownerDocument:_3c.ownerDocument,dir:_3c.dir,lang:_3c.lang,textDir:_3c.textDir,indent:this.indent+1});
if(_4a){
_4a.push(_4b);
}else{
_3c._itemNodesMap[id]=[_4b];
}
}
this.addChild(_4b);
if(this.tree.autoExpand||this.tree._state(_4b)){
_3e.push(_3c._expandNode(_4b));
}
},this);
_1.forEach(this.getChildren(),function(_4c){
_4c._updateLayout();
});
}else{
this.isExpandable=false;
}
if(this._setExpando){
this._setExpando(false);
}
this._updateItemClasses(this.item);
var def=_6(_3e);
this.tree._startPaint(def);
return _24(def);
},getTreePath:function(){
var _4d=this;
var _4e=[];
while(_4d&&_4d!==this.tree.rootNode){
_4e.unshift(_4d.item);
_4d=_4d.getParent();
}
_4e.unshift(this.tree.rootNode.item);
return _4e;
},getIdentity:function(){
return this.tree.model.getIdentity(this.item);
},removeChild:function(_4f){
this.inherited(arguments);
var _50=this.getChildren();
if(_50.length==0){
this.isExpandable=false;
this.collapse();
}
_1.forEach(_50,function(_51){
_51._updateLayout();
});
},makeExpandable:function(){
this.isExpandable=true;
this._setExpando(false);
},setSelected:function(_52){
this.labelNode.setAttribute("aria-selected",_52?"true":"false");
_8.toggle(this.rowNode,"dijitTreeRowSelected",_52);
},focus:function(){
_15.focus(this.focusNode);
}});
if(_d("dojo-bidi")){
_27.extend({_setTextDirAttr:function(_53){
if(_53&&((this.textDir!=_53)||!this._created)){
this._set("textDir",_53);
this.applyTextDir(this.labelNode);
_1.forEach(this.getChildren(),function(_54){
_54.set("textDir",_53);
},this);
}
}});
}
var _55=_4("dijit.Tree",[_18,_1d,_19,_1c],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:true,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:false,openOnDblClick:false,templateString:_1f,persist:false,autoExpand:false,dndController:_22,dndParams:["onDndDrop","itemCreator","onDndCancel","checkAcceptance","checkItemAcceptance","dragThreshold","betweenThreshold"],onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(_56,_57){
_11.publish(this.id,_10.mixin({tree:this,event:_56},_57||{}));
},postMixInProperties:function(){
this.tree=this;
if(this.autoExpand){
this.persist=false;
}
this._itemNodesMap={};
if(!this.cookieName&&this.id){
this.cookieName=this.id+"SaveStateCookie";
}
this.expandChildrenDeferred=new _5();
this.pendingCommandsPromise=this.expandChildrenDeferred.promise;
this.inherited(arguments);
},postCreate:function(){
this._initState();
var _58=this;
this.own(on(this.containerNode,on.selector(".dijitTreeNode",_12.enter),function(evt){
_58._onNodeMouseEnter(_16.byNode(this),evt);
}),on(this.containerNode,on.selector(".dijitTreeNode",_12.leave),function(evt){
_58._onNodeMouseLeave(_16.byNode(this),evt);
}),on(this.containerNode,on.selector(".dijitTreeRow",_14.press),function(evt){
_58._onNodePress(_16.getEnclosingWidget(this),evt);
}),on(this.containerNode,on.selector(".dijitTreeRow",_14),function(evt){
_58._onClick(_16.getEnclosingWidget(this),evt);
}),on(this.containerNode,on.selector(".dijitTreeRow","dblclick"),function(evt){
_58._onDblClick(_16.getEnclosingWidget(this),evt);
}));
if(!this.model){
this._store2model();
}
this.own(_2.after(this.model,"onChange",_10.hitch(this,"_onItemChange"),true),_2.after(this.model,"onChildrenChange",_10.hitch(this,"_onItemChildrenChange"),true),_2.after(this.model,"onDelete",_10.hitch(this,"_onItemDelete"),true));
this.inherited(arguments);
if(this.dndController){
if(_10.isString(this.dndController)){
this.dndController=_10.getObject(this.dndController);
}
var _59={};
for(var i=0;i<this.dndParams.length;i++){
if(this[this.dndParams[i]]){
_59[this.dndParams[i]]=this[this.dndParams[i]];
}
}
this.dndController=new this.dndController(this,_59);
}
this._load();
this.onLoadDeferred=_24(this.pendingCommandsPromise);
this.onLoadDeferred.then(_10.hitch(this,"onLoad"));
},_store2model:function(){
this._v10Compat=true;
_e.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");
var _5a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};
if(this.params.mayHaveChildren){
_5a.mayHaveChildren=_10.hitch(this,"mayHaveChildren");
}
if(this.params.getItemChildren){
_5a.getChildren=_10.hitch(this,function(_5b,_5c,_5d){
this.getItemChildren((this._v10Compat&&_5b===this.model.root)?null:_5b,_5c,_5d);
});
}
this.model=new _21(_5a);
this.showRoot=Boolean(this.label);
},onLoad:function(){
},_load:function(){
this.model.getRoot(_10.hitch(this,function(_5e){
var rn=(this.rootNode=this.tree._createTreeNode({item:_5e,tree:this,isExpandable:true,label:this.label||this.getLabel(_5e),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1}));
if(!this.showRoot){
rn.rowNode.style.display="none";
this.domNode.setAttribute("role","presentation");
this.domNode.removeAttribute("aria-expanded");
this.domNode.removeAttribute("aria-multiselectable");
if(this["aria-label"]){
rn.containerNode.setAttribute("aria-label",this["aria-label"]);
this.domNode.removeAttribute("aria-label");
}else{
if(this["aria-labelledby"]){
rn.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]);
this.domNode.removeAttribute("aria-labelledby");
}
}
rn.labelNode.setAttribute("role","presentation");
rn.containerNode.setAttribute("role","tree");
rn.containerNode.setAttribute("aria-expanded","true");
rn.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular);
}else{
this.domNode.setAttribute("aria-multiselectable",!this.dndController.singular);
this.rootLoadingIndicator.style.display="none";
}
this.containerNode.appendChild(rn.domNode);
var _5f=this.model.getIdentity(_5e);
if(this._itemNodesMap[_5f]){
this._itemNodesMap[_5f].push(rn);
}else{
this._itemNodesMap[_5f]=[rn];
}
rn._updateLayout();
this._expandNode(rn).then(_10.hitch(this,function(){
if(!this._destroyed){
this.rootLoadingIndicator.style.display="none";
this.expandChildrenDeferred.resolve(true);
}
}));
}),_10.hitch(this,function(err){
console.error(this,": error loading root: ",err);
}));
},getNodesByItem:function(_60){
if(!_60){
return [];
}
var _61=_10.isString(_60)?_60:this.model.getIdentity(_60);
return [].concat(this._itemNodesMap[_61]);
},_setSelectedItemAttr:function(_62){
this.set("selectedItems",[_62]);
},_setSelectedItemsAttr:function(_63){
var _64=this;
return this.pendingCommandsPromise=this.pendingCommandsPromise.always(_10.hitch(this,function(){
var _65=_1.map(_63,function(_66){
return (!_66||_10.isString(_66))?_66:_64.model.getIdentity(_66);
});
var _67=[];
_1.forEach(_65,function(id){
_67=_67.concat(_64._itemNodesMap[id]||[]);
});
this.set("selectedNodes",_67);
}));
},_setPathAttr:function(_68){
if(_68.length){
return _24(this.set("paths",[_68]).then(function(_69){
return _69[0];
}));
}else{
return _24(this.set("paths",[]).then(function(_6a){
return _6a[0];
}));
}
},_setPathsAttr:function(_6b){
var _6c=this;
function _6d(_6e,_6f){
var _70=_6e.shift();
var _71=_1.filter(_6f,function(_72){
return _72.getIdentity()==_70;
})[0];
if(!!_71){
if(_6e.length){
return _6c._expandNode(_71).then(function(){
return _6d(_6e,_71.getChildren());
});
}else{
return _71;
}
}else{
throw new _55.PathError("Could not expand path at "+_70);
}
};
return _24(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){
return _6(_1.map(_6b,function(_73){
_73=_1.map(_73,function(_74){
return _10.isString(_74)?_74:_6c.model.getIdentity(_74);
});
if(_73.length){
return _6d(_73,[_6c.rootNode]);
}else{
throw new _55.PathError("Empty path");
}
}));
}).then(function setNodes(_75){
_6c.set("selectedNodes",_75);
return _6c.paths;
}));
},_setSelectedNodeAttr:function(_76){
this.set("selectedNodes",[_76]);
},_setSelectedNodesAttr:function(_77){
this.dndController.setSelection(_77);
},expandAll:function(){
var _78=this;
function _79(_7a){
return _78._expandNode(_7a).then(function(){
var _7b=_1.filter(_7a.getChildren()||[],function(_7c){
return _7c.isExpandable;
});
return _6(_1.map(_7b,_79));
});
};
return _24(_79(this.rootNode));
},collapseAll:function(){
var _7d=this;
function _7e(_7f){
var _80=_1.filter(_7f.getChildren()||[],function(_81){
return _81.isExpandable;
}),_82=_6(_1.map(_80,_7e));
if(!_7f.isExpanded||(_7f==_7d.rootNode&&!_7d.showRoot)){
return _82;
}else{
return _82.then(function(){
return _7d._collapseNode(_7f);
});
}
};
return _24(_7e(this.rootNode));
},mayHaveChildren:function(){
},getItemChildren:function(){
},getLabel:function(_83){
return this.model.getLabel(_83);
},getIconClass:function(_84,_85){
return (!_84||this.model.mayHaveChildren(_84))?(_85?"dijitFolderOpened":"dijitFolderClosed"):"dijitLeaf";
},getLabelClass:function(){
},getRowClass:function(){
},getIconStyle:function(){
},getLabelStyle:function(){
},getRowStyle:function(){
},getTooltip:function(){
return "";
},_onDownArrow:function(evt,_86){
var _87=this._getNext(_86);
if(_87&&_87.isTreeNode){
this.focusNode(_87);
}
},_onUpArrow:function(evt,_88){
var _89=_88.getPreviousSibling();
if(_89){
_88=_89;
while(_88.isExpandable&&_88.isExpanded&&_88.hasChildren()){
var _8a=_88.getChildren();
_88=_8a[_8a.length-1];
}
}else{
var _8b=_88.getParent();
if(!(!this.showRoot&&_8b===this.rootNode)){
_88=_8b;
}
}
if(_88&&_88.isTreeNode){
this.focusNode(_88);
}
},_onRightArrow:function(evt,_8c){
if(_8c.isExpandable&&!_8c.isExpanded){
this._expandNode(_8c);
}else{
if(_8c.hasChildren()){
_8c=_8c.getChildren()[0];
if(_8c&&_8c.isTreeNode){
this.focusNode(_8c);
}
}
}
},_onLeftArrow:function(evt,_8d){
if(_8d.isExpandable&&_8d.isExpanded){
this._collapseNode(_8d);
}else{
var _8e=_8d.getParent();
if(_8e&&_8e.isTreeNode&&!(!this.showRoot&&_8e===this.rootNode)){
this.focusNode(_8e);
}
}
},focusLastChild:function(){
var _8f=this._getLast();
if(_8f&&_8f.isTreeNode){
this.focusNode(_8f);
}
},_getFirst:function(){
return this.showRoot?this.rootNode:this.rootNode.getChildren()[0];
},_getLast:function(){
var _90=this.rootNode;
while(_90.isExpanded){
var c=_90.getChildren();
if(!c.length){
break;
}
_90=c[c.length-1];
}
return _90;
},_getNext:function(_91){
if(_91.isExpandable&&_91.isExpanded&&_91.hasChildren()){
return _91.getChildren()[0];
}else{
while(_91&&_91.isTreeNode){
var _92=_91.getNextSibling();
if(_92){
return _92;
}
_91=_91.getParent();
}
return null;
}
},childSelector:".dijitTreeRow",isExpandoNode:function(_93,_94){
return _7.isDescendant(_93,_94.expandoNode)||_7.isDescendant(_93,_94.expandoNodeText);
},_onNodePress:function(_95,e){
this.focusNode(_95);
},__click:function(_96,e,_97,_98){
var _99=e.target,_9a=this.isExpandoNode(_99,_96);
if(_96.isExpandable&&(_97||_9a)){
this._onExpandoClick({node:_96});
}else{
this._publish("execute",{item:_96.item,node:_96,evt:e});
this[_98](_96.item,_96,e);
this.focusNode(_96);
}
e.stopPropagation();
e.preventDefault();
},_onClick:function(_9b,e){
this.__click(_9b,e,this.openOnClick,"onClick");
},_onDblClick:function(_9c,e){
this.__click(_9c,e,this.openOnDblClick,"onDblClick");
},_onExpandoClick:function(_9d){
var _9e=_9d.node;
this.focusNode(_9e);
if(_9e.isExpanded){
this._collapseNode(_9e);
}else{
this._expandNode(_9e);
}
},onClick:function(){
},onDblClick:function(){
},onOpen:function(){
},onClose:function(){
},_getNextNode:function(_9f){
_e.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");
return this._getNext(_9f);
},_getRootOrFirstNode:function(){
_e.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");
return this._getFirst();
},_collapseNode:function(_a0){
if(_a0._expandNodeDeferred){
delete _a0._expandNodeDeferred;
}
if(_a0.state=="Loading"){
return;
}
if(_a0.isExpanded){
var ret=_a0.collapse();
this.onClose(_a0.item,_a0);
this._state(_a0,false);
this._startPaint(ret);
return ret;
}
},_expandNode:function(_a1){
if(_a1._expandNodeDeferred){
return _a1._expandNodeDeferred;
}
var _a2=this.model,_a3=_a1.item,_a4=this;
if(!_a1._loadDeferred){
_a1.markProcessing();
_a1._loadDeferred=new _5();
_a2.getChildren(_a3,function(_a5){
_a1.unmarkProcessing();
_a1.setChildItems(_a5).then(function(){
_a1._loadDeferred.resolve(_a5);
});
},function(err){
console.error(_a4,": error loading "+_a1.label+" children: ",err);
_a1._loadDeferred.reject(err);
});
}
var def=_a1._loadDeferred.then(_10.hitch(this,function(){
var _a6=_a1.expand();
this.onOpen(_a1.item,_a1);
this._state(_a1,true);
return _a6;
}));
this._startPaint(def);
return def;
},focusNode:function(_a7){
var _a8=this.domNode.scrollLeft;
this.focusChild(_a7);
this.domNode.scrollLeft=_a8;
},_onNodeMouseEnter:function(){
},_onNodeMouseLeave:function(){
},_onItemChange:function(_a9){
var _aa=this.model,_ab=_aa.getIdentity(_a9),_ac=this._itemNodesMap[_ab];
if(_ac){
var _ad=this.getLabel(_a9),_ae=this.getTooltip(_a9);
_1.forEach(_ac,function(_af){
_af.set({item:_a9,label:_ad,tooltip:_ae});
_af._updateItemClasses(_a9);
});
}
},_onItemChildrenChange:function(_b0,_b1){
var _b2=this.model,_b3=_b2.getIdentity(_b0),_b4=this._itemNodesMap[_b3];
if(_b4){
_1.forEach(_b4,function(_b5){
_b5.setChildItems(_b1);
});
}
},_onItemDelete:function(_b6){
var _b7=this.model,_b8=_b7.getIdentity(_b6),_b9=this._itemNodesMap[_b8];
if(_b9){
_1.forEach(_b9,function(_ba){
this.dndController.removeTreeNode(_ba);
var _bb=_ba.getParent();
if(_bb){
_bb.removeChild(_ba);
}
if(this.lastFocusedChild&&!_7.isDescendant(this.lastFocusedChild,this.domNode)){
delete this.lastFocusedChild;
}
if(this.focusedChild&&!_7.isDescendant(this.focusedChild,this.domNode)){
this.focus();
}
_ba.destroyRecursive();
},this);
delete this._itemNodesMap[_b8];
}
},_initState:function(){
this._openedNodes={};
if(this.persist&&this.cookieName){
var _bc=_23?localStorage.getItem(this.cookieName):_3(this.cookieName);
if(_bc){
_1.forEach(_bc.split(","),function(_bd){
this._openedNodes[_bd]=true;
},this);
}
}
},_state:function(_be,_bf){
if(!this.persist){
return false;
}
var _c0=_1.map(_be.getTreePath(),function(_c1){
return this.model.getIdentity(_c1);
},this).join("/");
if(arguments.length===1){
return this._openedNodes[_c0];
}else{
if(_bf){
this._openedNodes[_c0]=true;
}else{
delete this._openedNodes[_c0];
}
this._saveExpandedNodes();
}
},_saveExpandedNodes:function(){
if(this.persist&&this.cookieName){
var ary=[];
for(var id in this._openedNodes){
ary.push(id);
}
if(_23){
localStorage.setItem(this.cookieName,ary.join(","));
}else{
_3(this.cookieName,ary.join(","),{expires:365});
}
}
},destroy:function(){
if(this._curSearch){
this._curSearch.timer.remove();
delete this._curSearch;
}
if(this.rootNode){
this.rootNode.destroyRecursive();
}
if(this.dndController&&!_10.isString(this.dndController)){
this.dndController.destroy();
}
this.rootNode=null;
this.inherited(arguments);
},destroyRecursive:function(){
this.destroy();
},resize:function(_c2){
if(_c2){
_9.setMarginBox(this.domNode,_c2);
}
this._nodePixelIndent=_9.position(this.tree.indentDetector).w||this._nodePixelIndent;
this.expandChildrenDeferred.then(_10.hitch(this,function(){
this.rootNode.set("indent",this.showRoot?0:-1);
this._adjustWidths();
}));
},_outstandingPaintOperations:0,_startPaint:function(p){
this._outstandingPaintOperations++;
if(this._adjustWidthsTimer){
this._adjustWidthsTimer.remove();
delete this._adjustWidthsTimer;
}
var oc=_10.hitch(this,function(){
this._outstandingPaintOperations--;
if(this._outstandingPaintOperations<=0&&!this._adjustWidthsTimer&&this._started){
this._adjustWidthsTimer=this.defer("_adjustWidths");
}
});
_13(p,oc,oc);
},_adjustWidths:function(){
if(this._adjustWidthsTimer){
this._adjustWidthsTimer.remove();
delete this._adjustWidthsTimer;
}
this.containerNode.style.width="auto";
this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%";
},_createTreeNode:function(_c3){
return new _27(_c3);
},focus:function(){
if(this.lastFocusedChild){
this.focusNode(this.lastFocusedChild);
}else{
this.focusFirstChild();
}
}});
if(_d("dojo-bidi")){
_55.extend({_setTextDirAttr:function(_c4){
if(_c4&&this.textDir!=_c4){
this._set("textDir",_c4);
this.rootNode.set("textDir",_c4);
}
}});
}
_55.PathError=_b("TreePathError");
_55._TreeNode=_27;
return _55;
});


;define("dojox/encoding/digests/_base",["dojo/_base/lang"],function(_1){
var _2=_1.getObject("dojox.encoding.digests",true);
_2.outputTypes={Base64:0,Hex:1,String:2,Raw:3};
_2.addWords=function(a,b){
var l=(a&65535)+(b&65535);
var m=(a>>16)+(b>>16)+(l>>16);
return (m<<16)|(l&65535);
};
var _3=8;
var _4=(1<<_3)-1;
_2.stringToWord=function(s){
var wa=[];
for(var i=0,l=s.length*_3;i<l;i+=_3){
wa[i>>5]|=(s.charCodeAt(i/_3)&_4)<<(i%32);
}
return wa;
};
_2.wordToString=function(wa){
var s=[];
for(var i=0,l=wa.length*32;i<l;i+=_3){
s.push(String.fromCharCode((wa[i>>5]>>>(i%32))&_4));
}
return s.join("");
};
_2.wordToHex=function(wa){
var h="0123456789abcdef",s=[];
for(var i=0,l=wa.length*4;i<l;i++){
s.push(h.charAt((wa[i>>2]>>((i%4)*8+4))&15)+h.charAt((wa[i>>2]>>((i%4)*8))&15));
}
return s.join("");
};
_2.wordToBase64=function(wa){
var p="=",_5="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=[];
for(var i=0,l=wa.length*4;i<l;i+=3){
var t=(((wa[i>>2]>>8*(i%4))&255)<<16)|(((wa[i+1>>2]>>8*((i+1)%4))&255)<<8)|((wa[i+2>>2]>>8*((i+2)%4))&255);
for(var j=0;j<4;j++){
if(i*8+j*6>wa.length*32){
s.push(p);
}else{
s.push(_5.charAt((t>>6*(3-j))&63));
}
}
}
return s.join("");
};
_2.stringToUtf8=function(_6){
var _7="";
var i=-1;
var x,y;
while(++i<_6.length){
x=_6.charCodeAt(i);
y=i+1<_6.length?_6.charCodeAt(i+1):0;
if(55296<=x&&x<=56319&&56320<=y&&y<=57343){
x=65536+((x&1023)<<10)+(y&1023);
i++;
}
if(x<=127){
_7+=String.fromCharCode(x);
}else{
if(x<=2047){
_7+=String.fromCharCode(192|((x>>>6)&31),128|(x&63));
}else{
if(x<=65535){
_7+=String.fromCharCode(224|((x>>>12)&15),128|((x>>>6)&63),128|(x&63));
}else{
if(x<=2097151){
_7+=String.fromCharCode(240|((x>>>18)&7),128|((x>>>12)&63),128|((x>>>6)&63),128|(x&63));
}
}
}
}
}
return _7;
};
return _2;
});


;define("dojox/encoding/digests/SHA1",["./_base"],function(_1){
var _2=8,_3=(1<<_2)-1;
function R(n,c){
return (n<<c)|(n>>>(32-c));
};
function FT(t,b,c,d){
if(t<20){
return (b&c)|((~b)&d);
}
if(t<40){
return b^c^d;
}
if(t<60){
return (b&c)|(b&d)|(c&d);
}
return b^c^d;
};
function KT(t){
return (t<20)?1518500249:(t<40)?1859775393:(t<60)?-1894007588:-899497514;
};
function _4(x,_5){
x[_5>>5]|=128<<(24-_5%32);
x[((_5+64>>9)<<4)+15]=_5;
var w=new Array(80),a=1732584193,b=-271733879,c=-1732584194,d=271733878,e=-1009589776;
for(var i=0;i<x.length;i+=16){
var _6=a,_7=b,_8=c,_9=d,_a=e;
for(var j=0;j<80;j++){
if(j<16){
w[j]=x[i+j];
}else{
w[j]=R(w[j-3]^w[j-8]^w[j-14]^w[j-16],1);
}
var t=_1.addWords(_1.addWords(R(a,5),FT(j,b,c,d)),_1.addWords(_1.addWords(e,w[j]),KT(j)));
e=d;
d=c;
c=R(b,30);
b=a;
a=t;
}
a=_1.addWords(a,_6);
b=_1.addWords(b,_7);
c=_1.addWords(c,_8);
d=_1.addWords(d,_9);
e=_1.addWords(e,_a);
}
return [a,b,c,d,e];
};
function _b(_c,_d){
var wa=_e(_d);
if(wa.length>16){
wa=_4(wa,_d.length*_2);
}
var _f=new Array(16),_10=new Array(16);
for(var i=0;i<16;i++){
_f[i]=wa[i]^909522486;
_10[i]=wa[i]^1549556828;
}
var _11=_4(_f.concat(_e(_c)),512+_c.length*_2);
return _4(_10.concat(_11),512+160);
};
function _e(s){
var wa=[];
for(var i=0,l=s.length*_2;i<l;i+=_2){
wa[i>>5]|=(s.charCodeAt(i/_2)&_3)<<(32-_2-i%32);
}
return wa;
};
function _12(wa){
var h="0123456789abcdef",s=[];
for(var i=0,l=wa.length*4;i<l;i++){
s.push(h.charAt((wa[i>>2]>>((3-i%4)*8+4))&15),h.charAt((wa[i>>2]>>((3-i%4)*8))&15));
}
return s.join("");
};
function _13(wa){
var s=[];
for(var i=0,l=wa.length*32;i<l;i+=_2){
s.push(String.fromCharCode((wa[i>>5]>>>(32-_2-i%32))&_3));
}
return s.join("");
};
function _14(wa){
var p="=",tab="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=[];
for(var i=0,l=wa.length*4;i<l;i+=3){
var t=(((wa[i>>2]>>8*(3-i%4))&255)<<16)|(((wa[i+1>>2]>>8*(3-(i+1)%4))&255)<<8)|((wa[i+2>>2]>>8*(3-(i+2)%4))&255);
for(var j=0;j<4;j++){
if(i*8+j*6>wa.length*32){
s.push(p);
}else{
s.push(tab.charAt((t>>6*(3-j))&63));
}
}
}
return s.join("");
};
_1.SHA1=function(_15,_16){
var out=_16||_1.outputTypes.Base64;
var wa=_4(_e(_15),_15.length*_2);
switch(out){
case _1.outputTypes.Raw:
return wa;
case _1.outputTypes.Hex:
return _12(wa);
case _1.outputTypes.String:
return _13(wa);
default:
return _14(wa);
}
};
_1.SHA1._hmac=function(_17,key,_18){
var out=_18||_1.outputTypes.Base64;
var wa=_b(_17,key);
switch(out){
case _1.outputTypes.Raw:
return wa;
case _1.outputTypes.Hex:
return _12(wa);
case _1.outputTypes.String:
return _13(wa);
default:
return _14(wa);
}
};
return _1.SHA1;
});


;define("bhc/Sanitize",["dojo/_base/declare","dojo","dojox/validate/web"],function(_1,_2,_3){
var _4=_1("bhc.Sanitize",[],{});
bhc.Sanitize.sanitize=function(_5,_6){
var _7=(_6)?document.createElement("pre"):document.createElement("span");
var _8=document.createTextNode(_5);
_7.appendChild(_8);
return _7.innerHTML;
};
bhc.Sanitize.isSafeLink=function(_9){
var _a=!(/^javascript:/i).test(_9)&&!(/^data:/i).test(_9);
if(dojox.validate&&typeof dojox.validate.isUrl=="function"){
_a=_a&&dojox.validate.isUrl(_9.split("?")[0]);
}else{
setTimeout("bhc.Sanitize.isSafeLink(sLink)",300);
}
return _a;
};
return _4;
});


;define("bhc/_Widget",["dojo/_base/declare","dojo/_base/lang","dijit/_Widget","bhc/Sanitize"],function(_1,_2,_3){
return _1("bhc._Widget",[_3],{create:function(_4,_5){
if(dojo.isIE==8&&_4["type"]&&_5&&typeof _5.nodeName=="string"&&_5.nodeName.toUpperCase()=="INPUT"){
delete _4["type"];
}
for(var _6 in _4){
var _7=_4[_6];
if(_2.isString(_7)){
_4[_6]=bhc.Sanitize.sanitize(_7);
}
}
this.inherited("create",arguments);
}});
});


;define("dojo/i18n!bhc/nls/Announcement", {"altPreviousAnn":"Previous Announcement","annCountMsg":"Announcement ${count} of ${total}","altOneAnn":"Announcement","altNextAnn":"Next Announcement","waiLabelNewWindow":"(This link opens a new window)","actionMore":"More","actionLess":"Less"});

;define("bhc/Announcement",["dojo/_base/declare","dojo","bhc/_Widget","dijit/_Templated","dojo/i18n!bhc/nls/Announcement"],function(_1,_2,_3,_4,_5){
return _1("bhc.Announcement",[_3,_4],{templatePath:_2.moduleUrl("bhc","templates/Announcement.html"),url:"",bundle:null,bundleMore:"",bundleAltPrev:"",bundleAltNext:"",bundleAltInfo:"",imgClassPrev:"bhcNoticePevious",imgClassNext:"bhcNoticeNext",total:0,count:0,expandedClass:"bhcNoticeSummaryExpanded",announcements:null,postMixInProperties:function(){
this.bundle=_5;
this.url="/announcements/announcement?";
this.bundleMore=this.bundle["actionMore"];
this.bundleAltPrev=this.bundle["altPreviousAnn"];
this.bundleAltNext=this.bundle["altNextAnn"];
this.bundleAltInfo=this.bundle["altOneAnn"];
if(document.getElementsByTagName("html")[0].dir.toLowerCase()==="rtl"){
this.imgClassPrev="bhcNoticeNext";
this.imgClassNext="bhcNoticePevious";
}
this.inherited("postMixInProperties",arguments);
},postCreate:function(){
this.inherited("postCreate",arguments);
this.getAnnouncements();
},getAnnouncements:function(){
_2.xhrGet({url:this.url,load:_2.hitch(this,"onLoad"),error:_2.hitch(this,"onLoadError"),preventCache:true,handleAs:"json",headers:{"CSRF_TOKEN":_2.cookie("token")}});
},onLoad:function(_6){
this.total=_6.data.length;
this.announcements=_6.data;
if(this.total>0){
this.render();
}
},onLoadError:function(){
console.debug("onLoadError",arguments);
},render:function(){
if(this.total>=1){
this.count=1;
}
if(this.total>1){
this.infoImgNode.title=this.infoImgNode.alt=_2.string.substitute(this.bundle["annCountMsg"],{total:this.total,count:this.count});
this.pickerTextNode.innerHTML=_2.string.substitute(this.bundle["annCountMsg"],{total:this.total,count:"<span class=\"bhcNoticeEmphasis\"  id=\""+this.id+"annCounter\">"+this.count+"</span>"});
var _7=_2.byId(this.id+"_arrowPrev");
_2.connect(_7,"onclick",_2.hitch(this,this.navigate,false));
_7=_2.byId(this.id+"_arrowNext");
_2.connect(_7,"onclick",_2.hitch(this,this.navigate,true));
_7.style.display=this.pickerNode.style.display="";
}else{
this.infoImgNode.title=this.infoImgNode.alt=this.bundleAltInfo;
}
this.titleNode.innerHTML=bhc.Sanitize.sanitize(this.announcements[0].title);
_2.connect(this.moreNode,"onclick",_2.hitch(this,this.showMore));
this.messageNode.innerHTML=bhc.Sanitize.sanitize(this.announcements[0].message);
this.containerNode.style.display="";
},navigate:function(_8){
if(_8){
this.count++;
if(this.count>this.total){
this.count=1;
}
}else{
if(this.count>1){
this.count--;
}else{
this.count=this.total;
}
}
var _9=this.announcements[this.count-1];
if(_9){
this.titleNode.innerHTML=bhc.Sanitize.sanitize(_9.title);
this.messageNode.innerHTML=bhc.Sanitize.sanitize(_9.message);
_2.byId(this.id+"annCounter").innerHTML=this.count;
this.infoImgNode.title=this.infoImgNode.alt=_2.string.substitute(this.bundle["annCountMsg"],{total:this.total,count:this.count});
}
_2.removeClass(this.summaryNode,this.expandedClass);
this.moreNode.innerHTML=this.bundle["actionMore"];
},showMore:function(){
var _a=_2.hasClass(this.summaryNode,this.expandedClass);
var _b=this.announcements[this.count-1];
if(_a){
this.messageNode.innerHTML=bhc.Sanitize.sanitize(_b.message);
this.pickerNode.style.marginBottom="-5px";
}else{
var _c=bhc.Sanitize.isSafeLink(_b.link);
var _d=[this.getFormattedMessage(_b.message)],n=1;
if(_b.link){
_d[n++]="<br/>"+(_c?"<p id=\"newWindowInfo"+n+"\" style=\"display: none;\">"+this.bundle["altOneAnn"]+"&nbsp;"+this.bundle["waiLabelNewWindow"]+"</p> <a target=\"_blank\" href=\""+_b.link+"\" aria-describedby=\"newWindowInfo"+n+"\">"+bhc.Sanitize.sanitize(_b.linkTitle)+"</a>":"<span title=\""+(_c?bhc.Sanitize.sanitize(_b.link):"")+"\">"+bhc.Sanitize.sanitize(_b.linkTitle)+"</span>");
}
this.messageNode.innerHTML=_d.join("");
this.pickerNode.style.marginBottom="0px";
}
_2.toggleClass(this.summaryNode,this.expandedClass);
this.moreNode.innerHTML=(_a?this.bundle["actionMore"]:this.bundle["actionLess"]);
},getFormattedMessage:function(_e){
return bhc.Sanitize.sanitize(_e,true).replace(/\n/g,"<br/>");
}});
});


;if(!dojo._hasResource["lotuslive.widgets.common"]){
dojo._hasResource["lotuslive.widgets.common"]=true;
dojo.provide("lotuslive.widgets.common");






























lotuslive.widgets.common={_loadScript:function(_1){
var _2=document.createElement("script");
_2.type="text/javascript";
_2.src=_1;
document.getElementsByTagName("head")[0].appendChild(_2);
},_buildUrl:function(_3,_4){
var _5=_3.charAt(_3.length-1);
if(_5!="/"){
_3=_3+"/";
}
var _6=gllConnectionsData.appName;
if(_6&&_6.length>0){
_3=_3+_6;
}
if(_4){
_3=_3+"/ocsBanner";
}
_3=_3+"?oneui=3";
return _3;
},loadNavbar:function(){
var _7=gllConnectionsData.srvUrls["sc-navbar"].toString();
if(_7&&_7.length>0){
_7=this._buildUrl(_7,true);
_7=_7+"&cre=true";
var _8=gllConnectionsData.visitorOrgName;
var _9=gllConnectionsData.visitorOrgId;
if(typeof _8!=="undefined"&&_8!=null&&_8!="null"&&_8.length>0){
_7=_7+"&orgName="+encodeURIComponent(_8);
}
if(typeof _9!=="undefined"&&_9!=null&&_9!="null"&&_9.length>0){
_7=_7+"&orgId="+encodeURIComponent(_9);
}
var _a=gllConnectionsData.srvUrls["sc-help"].toString();
if(_a&&_a.length>0){
_7=_7+"&helpURL="+encodeURIComponent(_a);
}
this._loadScript(_7);
document.getElementById("ocsBanner").parentNode.parentNode.removeAttribute("role");
}
},loadFooter:function(){
var _b=gllConnectionsData.srvUrls["sc-footer"].toString();
if(_b&&_b.length>0){
_b=this._buildUrl(_b,false);
_b=_b+"&elemId=footer";
if((gllConnectionsData.appName=="homepage")||(gllConnectionsData.appName=="profiles")||/\/community\/updates/.test(window.location)){
_b=_b+"&noHub=true";
}
this._loadScript(_b);
}
},loadTheming:function(){
var _c="/theming/theme/onprem/3/"+gllConnectionsData.userId+"/theming/"+gllConnectionsData.appName;
if(typeof (lconn)!="undefined"&&typeof (lconn.core)!="undefined"&&typeof (lconn.core.config)!="undefined"){
_c=_c+"/"+lconn.core.config.versionStamp;
}
var _d;
var _e=document.getElementsByTagName("html")[0].getAttribute("dir")||document.getElementsByTagName("html")[0].dir;
if(_e=="rtl"){
_d=gllConnectionsData.srvUrls["sc-bidi-theme"].toString();
}else{
_d=gllConnectionsData.srvUrls["sc-theme"].toString();
}
var _f=[_c,_d];
var _10=document.getElementsByTagName("head")[0];
for(var i=0;i<_f.length;i++){
var _11=document.createElement("link");
_11.type="text/css";
_11.rel="stylesheet";
_11.href=_f[i];
_10.appendChild(_11);
}
dojo.publish("loadTheming");
},loadAnnouncement:function(){
if(gllConnectionsData.appName=="homepage"){
var _12=document.createElement("div");
_12.id="sc_home_announcement";
var _13=dojo.byId("lotusFrame");
_13.insertBefore(_12,_13.firstChild);
new bhc.Announcement({id:_12.id},_12);
}
}};
}


;if(!dojo._hasResource["lconn.core.locale"]){
dojo._hasResource["lconn.core.locale"]=true;
(function(){
dojo.provide("lconn.core.locale");
function _1(_2,_3){
return _2.getLocale().split("-")[_3]||"";
};
dojo.mixin(lconn.core.locale,{getLocale:function(){
return dojo.locale;
},getLanguage:function(){
return _1(this,0);
},getCountry:function(){
return _1(this,1);
},getVariant:function(){
return _1(this,2);
},toJavaLocale:function(){
var _4,_5=this.getLanguage(),_6=this.getCountry();
if(_5==="pt"&&!_6){
_6="pt";
}else{
if(_5==="he"){
_5="iw";
}else{
if(_5==="nb"){
_5="no";
}
}
}
_4=_5;
if(_6){
_4+="_"+_6.toUpperCase();
}
return _4;
}});
})();
}


;dojo.cache("lconn.core", "widget/templates/MobileAppBanner.html", "<div class=\"lconnMobileAppBanner ${cssClass}\"> <div class=\"lconnMobileAppBanner_Container\"> <a href=\"javascript:;\" class=\"lotusClose\" role=\"button\" dojoAttachEvent=\"onclick:hide\" aria-label=\"${strings.hide}\"><span aria-hidden=\"true\">&#215;</span> <span class=\"lotusAccess\">X</span> </a><span class=\"lotusIcon\" style=\"background-image: url(${iconUrl});\"></span> <div class=\"lotusInfo\"> <strong>${strings.title}</strong> <span>${strings.author}</span> <span>${strings.onStore}</span> </div> <a href=\"${url}\" class=\"lotusBtn\"><span>${strings.view}</span> </a> </div></div>");

;if(!dojo._hasResource["lconn.core.widget.MobileAppBanner"]){
dojo._hasResource["lconn.core.widget.MobileAppBanner"]=true;
dojo.provide("lconn.core.widget.MobileAppBanner");










dojo.requireLocalization("lconn.core","strings");
(function(_1){
var _2=6,_3="mobileAppBanner";
function _4(){
var _5=_1.get(_3);
return !(!_5||!_5.hidden||(_5.showNext<=new Date().getTime()));
};
function _6(){
var _7=dojo.isFunction(dojo.getObject("getUserAgent"))?getUserAgent():navigator.userAgent.toLowerCase();
return _7.indexOf("android")>-1;
};
function _8(){
return (dojo.isIos<_2||_6())&&!_4();
};
var _9="apple-itunes-app",_a="google-play-app",_b="450533489",_c="com.ibm.lotus.connections.mobile",_d="http://a1.mzstatic.com/us/r30/Purple/v4/9b/2a/ad/9b2aadc2-34c8-c6af-142a-a5a3502f5503/mzl.mojupiyz.175x175-75.jpg",_e="https://lh5.ggpht.com/TmIAKR3Y_0i895u5_NNUoKfZHA6uQ9aClhyQKkbyKeWetyh0ETyD7SscX6deEM3jdcY=w170-rw",_f="https://itunes.apple.com/${lang}/app/id${app_id}",_10="https://play.google.com/store/apps/details?id=${app_id}";
var _11;
function _12(){
var el=dojo.query("meta[name="+(dojo.isIos?_9:_a)+"]")[0];
if(el){
var _13=el.getAttribute("content",0).split(",");
dojo.map(_13,function(val){
val=dojo.trim(val).split("=");
if(val[0]==="app-id"){
_11=val[1];
}
});
if(_11){
_12=function(){
return _11;
};
return _11;
}
}
return dojo.isIOS?_b:_c;
};
function _14(){
var _15=dojo.isIos?_f:_10;
return dojo.string.substitute(_15,{lang:lconn.core.locale.getCountry()||lconn.core.locale.getLanguage(),app_id:_12()});
};
function _16(){
return dojo.isIos?_d:_e;
};
function _17(){
var _18=dojo.query(".lotusFrame")[0];
if(!_18){
throw "This widget requires a lotusFrame element on the page";
}
return dojo.create("div",{},_18,"before");
};
var nls=dojo.i18n.getLocalization("lconn.core","strings");
dojo.declare("lconn.core.widget.MobileAppBanner",[dijit._Widget,dijit._Templated],{templatePath:dojo.moduleUrl("lconn.core","widget/templates/MobileAppBanner.html"),postMixInProperties:function(){
this.strings=this.strings||{onStore:dojo.isIos?nls.rs_mobileBanner_inAppStore:nls.rs_mobileBanner_inGooglePlay,title:nls.rs_mobileBanner_title,author:nls.rs_mobileBanner_author,view:nls.rs_mobileBanner_view,open:nls.rs_mobileBanner_open,hide:nls.rs_mobileBanner_hide};
this.cssClass=dojo.isIos?"ios":"android";
this.url=_14();
this.iconUrl=_16();
if(!this.srcNodeRef){
this.srcNodeRef=_17();
}
},buildRendering:function(){
if(_8()){
this.inherited(arguments);
}
},hide:function(){
dojo.addClass(this.domNode,"lotusHidden");
_1.set(_3,{hidden:true,showNext:new Date().getTime()+6*30*3600*1000});
}});
lconn.core.widget.MobileAppBanner.isEnabled=_8;
lconn.core.widget.MobileAppBanner.isHidden=_4;
lconn.core.widget.MobileAppBanner.unhide=function(){
_1.unset(_3);
};
}(lconn.core.util.PreferenceCache));
}


;define("dojo/i18n!ic-as/nls/activitystream", {"backToTopText":"Back to top","filterLibraries":"Libraries","markRead":"Mark read","feedLinkText":"Feed for these entries","ariaNotificationCenter":"Notification Center - View updates related to your content and notifications you have received","updatesForUser":"Updates for user","notificationPopupGeneric":"You have ${0} new notifications","commentRemoveConfirmMessageText":"Are you sure you want to delete this comment?","linkToPersonText":"This is a link to the profile of ${0}","unLikeError":"An error occurred when unliking this item.","errorShowMore":"Show more","ariaShowMore":"Show more activity stream items","hideAdditionalComments":"Hide Additional Comments...","trendDescription":"A trend is a keyword that is generated by the system to make it easier to perform search in Status Updates. Click a trend to display search results that have been assigned that keyword.","filterPeople":"People","filterWikis":"Wikis","commentText":"Comment","noDescriptionAriaLabel":"item","repostMsgErrorResGeneric":"You are not authorized to repost this message.","imageNotAvailable":"Preview currently not available","ariaASViews":"Activity stream views","ariaAddCommentText":"Add a comment","showMoreText":"Show more","filterMyNetwork":"My Network","commentRemoveConfirmText":"Delete","notificationsTitle":"Notifications","savedText":"Saved","logInText":"Log in","errorShowLess":"Show less","ariaShowLess":"Show less activity stream items","downloadError":"Download Error","ariaNewNotification":"New notification title. ${0}","asSearchShadowtext":"Search this stream","viewAllUpdates":"View all updates","timeToday":"Today at ${time}","replyAriaLabelSameDay":"${0} wrote a reply at ${1}","photoOfText":"Photo of ${0}","viewFilterLabel":"Sub View:","errorRetrieveComments":"An error occurred retrieving previous comments.","filterBlogs":"Blogs","filterFromMe":"From Me","asSearch":"Search","statusRemoveCancelText":"Cancel","trendHelp":"Trending Help","commentPosted":"Your comment has been posted.","errorRetrieveCommentsDeleted":"An error occurred retrieving previous comments. Item may have been deleted.","relatedTrends":"Related Trends","errorAlt":"Error:","showLessText":"Show less","ariaNewsItemRegion":"Activity Stream","externalApplication":"External Application","commentCancelText":"Cancel","loadingText":"Loading...","commentLengthExceeded":"The comment is too long to be posted. Please amend the comment and try again.","asSearchLabel":"Search the current stream","filterAriaDescription":"Select a filter to change the type of items shown on the Activity Stream","showActionsDescription":"Show Actions","sizeGB":"${0} GB","ariaPlayVideo":"Play Video","ariaVideoArea":"Video area, press ENTER to access video controllers","removeHashtag":"Remove the hashtag ${0} from the selected filter tags.","timeYear":"${MMM} ${d}, ${YYYY}","statusRemoveConfirmMessageText":"Are you sure you want to delete this message?","showMoreActions":"More...","charactersRemaining":"Characters Remaining","openEEAltText":"\x3e\x3e","likeError":"An error occurred when liking this item.","eventFromText":"Event from ${0}","relatedTrendsDesc":"Add a related trend to further refine your search","removeGeneric":"Remove","openEEText":"Show more details about this item","trendTitle":"Trending","singleCommentText":"Show comment","noContentText":"There are no updates to display.","allNotifications":"All Notifications","ariaFilterMention":"Mentions","commentRemoveConfirmationMsg":"Comment has been successfully deleted.","savedSuccessText":"Successfully Saved","filterCommunitiesIFollow":"Communities I Follow","addCommentText":"Add a comment...","writeCommentText":"Write something...","filterAriaLabel":"Filter activity stream","linkToAriaLabel":"View item in new window on ${0} page. ","markUnread":"Mark unread","opensInNewWindow":"This link will open on a new window.","viewSaved":"Saved","logInCommentText":"Log in to comment","filterMyUpdates":"My Updates","tagsText":"Tags: ${0}","updatesFromSender":"Updates from Sender","commentRemoveCancelText":"Cancel","commentSessionTimedOut":"You have been automatically logged out of the server due to inactivity. Copy any text you have entered to your clipboard so you won\'t lose it, then \x3ca href : \'\'${0}\'\'\x3elog in\x3c/a\x3e to start over.","selectedTrends":"Selected Trends","timeTomorrow":"Tomorrow at ${time}","repostMsgSuccess":"The update was successfully reposted to your followers.","asSearchGlobalView":"View search results from all your content","moreCommentsAriaLabel":"Comments for ${0} . Use more details to show all ${1} comments.","externalUsersStatusUpdatesMsg":"Status Updates might be seen by people external to your organization.","filterAll":"All","likesText":"${0} likes","noNewNotifications":"You haven\'t received any notifications in the past week.","filterForums":"Forums","invalidASConfig":"There is an error with the configuration for the Updates stream. Please contact your administrator.","loadingNotifications":"Loading...","asSearchBarCancel":"Cancel the Search and return to main view","statusRemoveConfirmationMsg":"Message has been successfully deleted.","statusRemoveConfirmText":"Delete","sizeKB":"${0} KB","selectedLabel":"Selected","repostText":"Repost","ariaMultipleMentions":"${0} were mentioned","asSearchBarOpen":"Open the search bar to Search the current view","expandTrend":"Expand the Trends filter","ariaActionsToolbar":"Item Actions","showPreviousComments":"Show Previous Comments...","newNotifications":"${0} new notifications","okText":"OK","ariaBackToTop":"Back to top of activity stream items","notificationsSettings":"Settings","noUser":"No User was found for this email address: ${0}","msgCloseAlt":"Close message","openEEDescription":"Press the enter key to show more details about this item","timeYesterday":"Yesterday at ${time}","moreCommentsText":"${0} more comments","publicText":"Public","viewMyNotifications":"My Notifications","seeAllNotifications":"See All","commentRemoveErrorMsg":"Comment could not be deleted at this time. Try again or contact an administrator.","closeText":"close","asTitle":"Connections Updates","relatedTrendTitle":"Add the trend \'\'${0}\'\'","viewRecentUpdates":"Recent Updates","markAllRead":"Mark all read","returnMainView":"Return","privateText":"Private","filterMention":"@Mentions","filterPeopleIFollow":"People I Follow","errorText":"Error","sizeMB":"${0} MB","feedErrorText":"There has been an error retrieving your news feed.","matchingAllOf":"Matching all of:","attachFile":"Add a File","removeFileAttachment":"Remove file attachment","statusRemoveText":"Delete this Message","ariaCommentText":"Write something","likeText":"1 like","filterBookmarks":"Bookmarks","closeTrendHelp":"Close Trending Help","commentsCounter":"${0} of ${1}","repostMsgFail":"There was an error reposting this message.","commentPostText":"Post","notificationPopupSingleGeneric":"You have 1 new notification","ariaSeeAllNotifications":"Click here to go to the My Notifications View in Homepage","repostMsgErrorRestricted":"This message cannot be reposted as the ${0} community is now a Restricted Community.","removeNewsItemText":"Delete this item ","removeTrend":"Remove the trend \'\'${0}\'\' from the selected filter trends","deleteCommentText":"Delete comment","filterProfiles":"Profiles","allCommentsText":"Show all ${0} comments ","itemErrorText":"An error occurred displaying an item in your feed.","filterActivities":"Activities","downloadErrorMessage":"The file could not be downloaded. It may have been deleted, or you may not have access to it.","logInRepostText":"Log in to repost","timeDay":"${EEEE} at ${time}","statusRemoveErrorMsg":"Message could not be deleted at this time. Try again or contact an administrator.","commentRemoveText":"Delete this Comment","selectFilter":"Select a filter","noTrends":"No trends yet","markAllReadDetails":"Click here to mark all notifications read.","ariaShowMoreLabel":"This button is used to display content that has been hidden for display purposes. Not relevant for assistive technology users.","updatesFor":"Updates for ${0}","filterTwoLabel":"Show:","replyAriaLabel":"${0} wrote a reply on ${1}","ariaNotificationsSettings":"Click here to go to the notifications settings page","filterForMe":"For Me","viewDiscover":"Discover","filterCommunities":"Communities","externalUsersCommentsMsg":"Comments might be seen by people external to your organization.","externalUsersItemMsg":"Shared externally","filterTags":"Tags","timeMonth":"${MMM} ${d}","oneMoreCommentsText":"1 more comment","filterMyNetworkAndPeopleIFollow":"My Network and People I Follow","filterOneLabel":"Filter By:","commentAriaLabel":"${0} wrote a comment on ${1}","commentNotPermittedText":"You are not authorized to make comments on this message.","viewStatusUpdates":"Status Updates","listTags":"${0} and ${1} more","commentsAriaLabel":"Comments for ${0}","filterFiles":"Files","filterStatusUpdates":"Status Updates","viewImFollowing":"I\'m Following","mention":"@${0}","commentAriaLabelSameDay":"${0} wrote a comment at ${1}","hashtagTitle":" Click here to search for the tag ${0}. ","updatesFromContact":"Updates from Contact","collapseTrend":"Collapse the Trends filter","fromText":"From: ${0}","commentFailureText":"Attempt to add comment text has failed. Please refresh your page and try again.","ariaSingleMention":"${0} was mentioned","viewActionRequired":"Action Required","matching":"Matching:"});
if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["ic-as"]=true;

;define("dojo/text!ic-as/notification/view/templates/NotificationsFlyout.html", '<div class="icBanner-notif-center lotusHidden" role="dialog" id="notificationsFlyout" aria-labelledby="arialabelNotificationsFlyout">\n	<span aria-hidden="true" class="lotusHidden" id="arialabelNotificationsFlyout">${strings.ariaNotificationCenter}</span>\n    <div class="icBanner-popover-inner">\n        <div id="headerPopupNode" class="icBanner-popover-header" data-dojo-attach-point="headerNode"><div class="header-left">${strings.viewMyNotifications}</div>\n        	<div class="header-right">\n				<span tabindex="0" data-dojo-attach-point="readAllAction" title="${strings.markAllRead}" role="button" class="icBanner-popover-notificationReadAll lotusHidden">\n					${strings.markAllRead}\n				</span>\n				<span id="separator" class="icBanner-popover-notificationSeparator">|</span>\n                <a class="icBanner-popover-notificationSettings" tabindex="0" href="${settingsUrl}" title="${strings.notificationsSettings}" target="_blank" data-dojo-attach-point="settingsLink">\n                    ${!strings.notificationsSettings}\n                </a>\n            </div>           \n        </div>\n        <div class="icBanner-popover-content" data-dojo-attach-event="onscroll: checkScroll" data-dojo-attach-point="contentNode">\n            <div class="icBanner-popover-newNotifications lotusHidden">${newNotifications}</div>\n            <div data-dojo-attach-point="notificationItem">\n            </div>\n            <div data-dojo-attach-point="loadingNode" class="lotusLoading icBanner-popover-loader lotusHidden"></div>\n        </div>\n       \n        <div class="icBanner-popover-footer">\n            <ul class="l-icFloatList">                \n                <li class="lotusFirst"><a class="icBanner-footer-link" tabindex="0" aria-describedby="ariaNotificationCenterSeeAll" data-dojo-attach-point="seeAllLink" href="${allNotificationsUrl}" target="_blank">${strings.seeAllNotifications}</a></li> \n            </ul>\n            <span class="lotusAccess" id="ariaNotificationCenterSeeAll">${strings.ariaSeeAllNotifications}</span>\n            <div class="l-icClear"></div>\n        </div>\n    </div>\n</div>');

;define("dojox/lang/functional/array",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","./lambda"],function(_1,_2,_3,df){
var _4={};
_2.mixin(df,{filter:function(a,f,o){
if(typeof a=="string"){
a=a.split("");
}
o=o||_1.global;
f=df.lambda(f);
var t=[],v,i,n;
if(_2.isArray(a)){
for(i=0,n=a.length;i<n;++i){
v=a[i];
if(f.call(o,v,i,a)){
t.push(v);
}
}
}else{
if(typeof a.hasNext=="function"&&typeof a.next=="function"){
for(i=0;a.hasNext();){
v=a.next();
if(f.call(o,v,i++,a)){
t.push(v);
}
}
}else{
for(i in a){
if(!(i in _4)){
v=a[i];
if(f.call(o,v,i,a)){
t.push(v);
}
}
}
}
}
return t;
},forEach:function(a,f,o){
if(typeof a=="string"){
a=a.split("");
}
o=o||_1.global;
f=df.lambda(f);
var i,n;
if(_2.isArray(a)){
for(i=0,n=a.length;i<n;f.call(o,a[i],i,a),++i){
}
}else{
if(typeof a.hasNext=="function"&&typeof a.next=="function"){
for(i=0;a.hasNext();f.call(o,a.next(),i++,a)){
}
}else{
for(i in a){
if(!(i in _4)){
f.call(o,a[i],i,a);
}
}
}
}
return o;
},map:function(a,f,o){
if(typeof a=="string"){
a=a.split("");
}
o=o||_1.global;
f=df.lambda(f);
var t,n,i;
if(_2.isArray(a)){
t=new Array(n=a.length);
for(i=0;i<n;t[i]=f.call(o,a[i],i,a),++i){
}
}else{
if(typeof a.hasNext=="function"&&typeof a.next=="function"){
t=[];
for(i=0;a.hasNext();t.push(f.call(o,a.next(),i++,a))){
}
}else{
t=[];
for(i in a){
if(!(i in _4)){
t.push(f.call(o,a[i],i,a));
}
}
}
}
return t;
},every:function(a,f,o){
if(typeof a=="string"){
a=a.split("");
}
o=o||_1.global;
f=df.lambda(f);
var i,n;
if(_2.isArray(a)){
for(i=0,n=a.length;i<n;++i){
if(!f.call(o,a[i],i,a)){
return false;
}
}
}else{
if(typeof a.hasNext=="function"&&typeof a.next=="function"){
for(i=0;a.hasNext();){
if(!f.call(o,a.next(),i++,a)){
return false;
}
}
}else{
for(i in a){
if(!(i in _4)){
if(!f.call(o,a[i],i,a)){
return false;
}
}
}
}
}
return true;
},some:function(a,f,o){
if(typeof a=="string"){
a=a.split("");
}
o=o||_1.global;
f=df.lambda(f);
var i,n;
if(_2.isArray(a)){
for(i=0,n=a.length;i<n;++i){
if(f.call(o,a[i],i,a)){
return true;
}
}
}else{
if(typeof a.hasNext=="function"&&typeof a.next=="function"){
for(i=0;a.hasNext();){
if(f.call(o,a.next(),i++,a)){
return true;
}
}
}else{
for(i in a){
if(!(i in _4)){
if(f.call(o,a[i],i,a)){
return true;
}
}
}
}
}
return false;
}});
return df;
});


;define("dojox/lang/functional",["./functional/lambda","./functional/array","./functional/object"],function(df){
return df;
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["ic-core"]=true;

;define("ic-core/config/features",["dojo/has","dojox/lang/functional"],function(_1,_2){
"use strict";
var _3=window.gatekeeperConfig||{};
_2.forIn(_3,function(_4,_5){
_1.add(_5,_4);
});
return _1;
});


;define("dojo/text!ic-as/notification/view/templates/NotificationsItem.html", '<div class="icNotification-post asLinkContainer" tabindex="0" data-dojo-attach-event="onmouseover: _onFocus, onfocus: _onFocus, onmouseout: _onBlur, onblur: _onBlur,  onclick: onClick, onkeypress: _onKeyPress" role="article" aria-label="${ariaSummary} ${timeString}">\n        <div class="icNotification-post-inner">\n            <img class="icNote-authorImg" data-dojo-attach-point="authorImage" src="" alt="">\n            <div class="icNote-body selected" data-dojo-attach-point="notificationContent">\n                <div class="icNote-message">\n                <div class="icNote-title">${!activityTitle}</div>            \n                    <span title="${strings.markUnread}" data-dojo-attach-point="bluedot" role="button" tabindex="0" class="bluedot lotusHidden"></span>\n              		<span data-dojo-attach-point="highContrastTextRead" role="button" tabindex="0" class="lotusHidden">${strings.markUnread}</span>\n              		<span data-dojo-attach-point="highContrastTextUnread" role="button" tabindex="0" class="lotusHidden">${strings.markRead}</span>\n                </div>\n                <div class="icNote-summary">${!activitySummary}</div>\n                <div class="icNote-time"><abbr class="timeago" data-dojo-attach-point="timeagoNode" title="${time}">${timeString}</abbr></div>\n            </div>\n        </div>\n</div>');

;define("dojo/i18n!ic-core/ext/timeago/nls/Timeago", {"timeMonth":"${MMMM} ${d}","timeYesterday":"Yesterday","now":"Just now","AMPM":{"AM":"AM","PM":"PM"},"numbers":[],"timeYear":"${MMMM} ${d}, ${YYYY}","timeAgo":"%d ago","minutes":"%dm","hours":"%dh","timeDay":"${EEEE}","timeHover":"${MMMM} ${d}, ${h}:${mm} ${a}"});

;define("dojox/date/hebrew/numerals",["../..","dojo/_base/lang","dojo/_base/array"],function(_1,_2,_3){
var _4=_2.getObject("date.hebrew.numerals",true,_1);
var _5="\u05d0\u05d1\u05d2\u05d3\u05d4\u05d5\u05d6\u05d7\u05d8";
var _6="\u05d9\u05db\u05dc\u05de\u05e0\u05e1\u05e2\u05e4\u05e6";
var _7="\u05e7\u05e8\u05e9\u05ea";
var _8=function(_9,_a){
_9=_9.replace("\u05d9\u05d4","\u05d8\u05d5").replace("\u05d9\u05d5","\u05d8\u05d6");
if(!_a){
var _b=_9.length;
if(_b>1){
_9=_9.substr(0,_b-1)+"\""+_9.charAt(_b-1);
}else{
_9+="\u05f3";
}
}
return _9;
};
var _c=function(_d){
var _e=0;
_3.forEach(_d,function(ch){
var i;
if((i=_5.indexOf(ch))!=-1){
_e+=++i;
}else{
if((i=_6.indexOf(ch))!=-1){
_e+=10*++i;
}else{
if((i=_7.indexOf(ch))!=-1){
_e+=100*++i;
}
}
}
});
return _e;
};
var _f=function(num){
var str="",n=4,j=9;
while(num){
if(num>=n*100){
str+=_7.charAt(n-1);
num-=n*100;
continue;
}else{
if(n>1){
n--;
continue;
}else{
if(num>=j*10){
str+=_6.charAt(j-1);
num-=j*10;
}else{
if(j>1){
j--;
continue;
}else{
if(num>0){
str+=_5.charAt(num-1);
num=0;
}
}
}
}
}
}
return str;
};
_4.getYearHebrewLetters=function(_10){
var rem=_10%1000;
return _8(_f(rem));
};
_4.parseYearHebrewLetters=function(_11){
return _c(_11)+5000;
};
_4.getDayHebrewLetters=function(day,_12){
return _8(_f(day),_12);
};
_4.parseDayHebrewLetters=function(day){
return _c(day);
};
_4.getMonthHebrewLetters=function(_13){
return _8(_f(_13+1));
};
_4.parseMonthHebrewLetters=function(_14){
var _15=_4.parseDayHebrewLetters(_14)-1;
if(_15==-1||_15>12){
throw new Error("The month name is incorrect , month = "+_15);
}
return _15;
};
return _4;
});


;define("dojox/date/hebrew/Date",["dojo/_base/lang","dojo/_base/declare","./numerals"],function(_1,_2,_3){
var _4=_2("dojox.date.hebrew.Date",null,{_MONTH_LENGTH:[[30,30,30],[29,29,30],[29,30,30],[29,29,29],[30,30,30],[30,30,30],[29,29,29],[30,30,30],[29,29,29],[30,30,30],[29,29,29],[30,30,30],[29,29,29]],_MONTH_START:[[0,0,0],[30,30,30],[59,59,60],[88,89,90],[117,118,119],[147,148,149],[147,148,149],[176,177,178],[206,207,208],[235,236,237],[265,266,267],[294,295,296],[324,325,326],[353,354,355]],_LEAP_MONTH_START:[[0,0,0],[30,30,30],[59,59,60],[88,89,90],[117,118,119],[147,148,149],[177,178,179],[206,207,208],[236,237,238],[265,266,267],[295,296,297],[324,325,326],[354,355,356],[383,384,385]],_GREGORIAN_MONTH_COUNT:[[31,31,0,0],[28,29,31,31],[31,31,59,60],[30,30,90,91],[31,31,120,121],[30,30,151,152],[31,31,181,182],[31,31,212,213],[30,30,243,244],[31,31,273,274],[30,30,304,305],[31,31,334,335]],_date:0,_month:0,_year:0,_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_day:0,constructor:function(){
var _5=arguments.length;
if(!_5){
this.fromGregorian(new Date());
}else{
if(_5==1){
var _6=arguments[0];
if(typeof _6=="number"){
_6=new Date(_6);
}
if(_6 instanceof Date){
this.fromGregorian(_6);
}else{
if(_6==""){
this._year=this._month=this._date=this._hours=this._minutes=this._seconds=this._milliseconds=NaN;
}else{
this._year=_6._year;
this._month=_6._month;
this._date=_6._date;
this._hours=_6._hours;
this._minutes=_6._minutes;
this._seconds=_6._seconds;
this._milliseconds=_6._milliseconds;
}
}
}else{
if(_5>=3){
this._year+=arguments[0];
this._month+=arguments[1];
this._date+=arguments[2];
if(this._month>12){
console.warn("the month is incorrect , set 0  "+this._month+"   "+this._year);
this._month=0;
}
this._hours+=arguments[3]||0;
this._minutes+=arguments[4]||0;
this._seconds+=arguments[5]||0;
this._milliseconds+=arguments[6]||0;
}
}
}
this._setDay();
},getDate:function(){
return this._date;
},getDateLocalized:function(_7){
return (_7||dojo.locale).match(/^he(?:-.+)?$/)?_3.getDayHebrewLetters(this._date):this.getDate();
},getMonth:function(){
return this._month;
},getFullYear:function(){
return this._year;
},getHours:function(){
return this._hours;
},getMinutes:function(){
return this._minutes;
},getSeconds:function(){
return this._seconds;
},getMilliseconds:function(){
return this._milliseconds;
},setDate:function(_8){
_8=+_8;
var _9;
if(_8>0){
while(_8>(_9=this.getDaysInHebrewMonth(this._month,this._year))){
_8-=_9;
this._month++;
if(this._month>=13){
this._year++;
this._month-=13;
}
}
}else{
while(_8<=0){
_9=this.getDaysInHebrewMonth((this._month-1)>=0?(this._month-1):12,((this._month-1)>=0)?this._year:this._year-1);
this._month--;
if(this._month<0){
this._year--;
this._month+=13;
}
_8+=_9;
}
}
this._date=_8;
this._setDay();
return this;
},setFullYear:function(_a,_b,_c){
this._year=_a=+_a;
if(!this.isLeapYear(_a)&&this._month==5){
this._month++;
}
if(_b!==undefined){
this.setMonth(_b);
}
if(_c!==undefined){
this.setDate(_c);
}
var _d=this.getDaysInHebrewMonth(this._month,this._year);
if(_d<this._date){
this._date=_d;
}
this._setDay();
return this;
},setMonth:function(_e){
_e=+_e;
if(!this.isLeapYear(this._year)&&_e==5){
_e++;
}
if(_e>=0){
while(_e>12){
this._year++;
_e-=13;
if(!this.isLeapYear(this._year)&&_e>=5){
_e++;
}
}
}else{
while(_e<0){
this._year--;
_e+=(!this.isLeapYear(this._year)&&_e<-7)?12:13;
}
}
this._month=_e;
var _f=this.getDaysInHebrewMonth(this._month,this._year);
if(_f<this._date){
this._date=_f;
}
this._setDay();
return this;
},setHours:function(){
var _10=arguments.length;
var _11=0;
if(_10>=1){
_11=+arguments[0];
}
if(_10>=2){
this._minutes=+arguments[1];
}
if(_10>=3){
this._seconds=+arguments[2];
}
if(_10==4){
this._milliseconds=+arguments[3];
}
while(_11>=24){
this._date++;
var _12=this.getDaysInHebrewMonth(this._month,this._year);
if(this._date>_12){
this._month++;
if(!this.isLeapYear(this._year)&&this._month==5){
this._month++;
}
if(this._month>=13){
this._year++;
this._month-=13;
}
this._date-=_12;
}
_11-=24;
}
this._hours=_11;
this._setDay();
return this;
},_addMinutes:function(_13){
_13+=this._minutes;
this.setMinutes(_13);
this.setHours(this._hours+parseInt(_13/60));
return this;
},_addSeconds:function(_14){
_14+=this._seconds;
this.setSeconds(_14);
this._addMinutes(parseInt(_14/60));
return this;
},_addMilliseconds:function(_15){
_15+=this._milliseconds;
this.setMilliseconds(_15);
this._addSeconds(parseInt(_15/1000));
return this;
},setMinutes:function(_16){
this._minutes=_16%60;
return this;
},setSeconds:function(_17){
this._seconds=_17%60;
return this;
},setMilliseconds:function(_18){
this._milliseconds=_18%1000;
return this;
},_setDay:function(){
var day=this._startOfYear(this._year);
if(this._month!=0){
day+=(this.isLeapYear(this._year)?this._LEAP_MONTH_START:this._MONTH_START)[this._month||0][this._yearType(this._year)];
}
day+=this._date-1;
this._day=(day+1)%7;
},toString:function(){
return isNaN(this._date)?"Invalid Date":this._date+", "+this._month+", "+this._year+"  "+this._hours+":"+this._minutes+":"+this._seconds;
},getDaysInHebrewMonth:function(_19,_1a){
var _1b=(_19==1||_19==2)?this._yearType(_1a):0;
return (!this.isLeapYear(this._year)&&_19==5)?0:this._MONTH_LENGTH[_19][_1b];
},_yearType:function(_1c){
var _1d=this._handleGetYearLength(Number(_1c));
if(_1d>380){
_1d-=30;
}
var _1e=_1d-353;
if(_1e<0||_1e>2){
throw new Error("Illegal year length "+_1d+" in year "+_1c);
}
return _1e;
},_handleGetYearLength:function(_1f){
return this._startOfYear(_1f+1)-this._startOfYear(_1f);
},_startOfYear:function(_20){
var _21=Math.floor((235*_20-234)/19),_22=_21*(12*1080+793)+11*1080+204,day=_21*29+Math.floor(_22/(24*1080));
_22%=24*1080;
var wd=day%7;
if(wd==2||wd==4||wd==6){
day+=1;
wd=day%7;
}
if(wd==1&&_22>15*1080+204&&!this.isLeapYear(_20)){
day+=2;
}else{
if(wd==0&&_22>21*1080+589&&this.isLeapYear(_20-1)){
day+=1;
}
}
return day;
},isLeapYear:function(_23){
var x=(_23*12+17)%19;
return x>=((x<0)?-7:12);
},fromGregorian:function(_24){
var _25=(!isNaN(_24))?this._computeHebrewFields(_24):NaN;
this._year=(!isNaN(_24))?_25[0]:NaN;
this._month=(!isNaN(_24))?_25[1]:NaN;
this._date=(!isNaN(_24))?_25[2]:NaN;
this._hours=_24.getHours();
this._milliseconds=_24.getMilliseconds();
this._minutes=_24.getMinutes();
this._seconds=_24.getSeconds();
if(!isNaN(_24)){
this._setDay();
}
return this;
},_computeHebrewFields:function(_26){
var _27=this._getJulianDayFromGregorianDate(_26),d=_27-347997,m=Math.floor((d*24*1080)/(29*24*1080+12*1080+793)),_28=Math.floor((19*m+234)/235)+1,ys=this._startOfYear(_28),_29=(d-ys);
while(_29<1){
_28--;
ys=this._startOfYear(_28);
_29=d-ys;
}
var _2a=this._yearType(_28),_2b=this.isLeapYear(_28)?this._LEAP_MONTH_START:this._MONTH_START,_2c=0;
while(_29>_2b[_2c][_2a]){
_2c++;
}
_2c--;
var _2d=_29-_2b[_2c][_2a];
return [_28,_2c,_2d];
},toGregorian:function(){
var _2e=this._year||0,_2f=this._month||0,_30=this._date||0,day=this._startOfYear(_2e);
if(_2f!=0){
day+=(this.isLeapYear(_2e)?this._LEAP_MONTH_START:this._MONTH_START)[_2f][this._yearType(_2e)];
}
var _31=(_30+day+347997),_32=_31-1721426;
var rem=[];
var _33=this._floorDivide(_32,146097,rem),_34=this._floorDivide(rem[0],36524,rem),n4=this._floorDivide(rem[0],1461,rem),n1=this._floorDivide(rem[0],365,rem),_35=400*_33+100*_34+4*n4+n1,_36=rem[0];
if(_34==4||n1==4){
_36=365;
}else{
++_35;
}
var _37=!(_35%4)&&(_35%100||!(_35%400)),_38=0,_39=_37?60:59;
if(_36>=_39){
_38=_37?1:2;
}
var _3a=Math.floor((12*(_36+_38)+6)/367);
var _3b=_36-this._GREGORIAN_MONTH_COUNT[_3a][_37?3:2]+1;
return new Date(_35,_3a,_3b,this._hours,this._minutes,this._seconds,this._milliseconds);
},_floorDivide:function(_3c,_3d,_3e){
if(_3c>=0){
_3e[0]=(_3c%_3d);
return Math.floor(_3c/_3d);
}
var _3f=Math.floor(_3c/_3d);
_3e[0]=_3c-(_3f*_3d);
return _3f;
},getDay:function(){
var _40=this._year,_41=this._month,_42=this._date,day=this._startOfYear(_40);
if(_41!=0){
day+=(this.isLeapYear(_40)?this._LEAP_MONTH_START:this._MONTH_START)[_41][this._yearType(_40)];
}
day+=_42-1;
return (day+1)%7;
},_getJulianDayFromGregorianDate:function(_43){
var _44=_43.getFullYear(),_45=_43.getMonth(),d=_43.getDate(),_46=!(_44%4)&&(_44%100||!(_44%400)),y=_44-1;
var _47=365*y+Math.floor(y/4)-Math.floor(y/100)+Math.floor(y/400)+1721426-1;
if(_45>0){
_47+=this._GREGORIAN_MONTH_COUNT[_45][_46?3:2];
}
_47+=d;
return _47;
}});
_4.prototype.valueOf=function(){
return this.toGregorian().valueOf();
};
return _4;
});


;define("dojox/date/hebrew",["..","dojo/_base/lang","dojo/date","./hebrew/Date"],function(_1,_2,dd,_3){
var _4=_2.getObject("date.hebrew",true,_1);
_4.getDaysInMonth=function(_5){
return _5.getDaysInHebrewMonth(_5.getMonth(),_5.getFullYear());
};
_4.compare=function(_6,_7,_8){
if(_6 instanceof _3){
_6=_6.toGregorian();
}
if(_7 instanceof _3){
_7=_7.toGregorian();
}
return dd.compare.apply(null,arguments);
};
_4.add=function(_9,_a,_b){
var _c=new _3(_9);
switch(_a){
case "day":
_c.setDate(_9.getDate()+_b);
break;
case "weekday":
var _d=_9.getDay();
var _e=0;
if(_b<0&&_d==6){
_d=5;
_e=-1;
}
if((_d+_b)<5&&(_d+_b)>=0){
_c.setDate(_9.getDate()+_b+_e);
}else{
var _f=(_b>0)?5:-1;
var _10=(_b>0)?2:-2;
if(_b>0&&(_d==5||_d==6)){
_e=4-_d;
_d=4;
}
var _11=_d+_b-_f;
var _12=parseInt(_11/5);
var _13=_11%5;
_c.setDate(_9.getDate()-_d+_10+_12*7+_e+_13+_f);
}
break;
case "year":
_c.setFullYear(_9.getFullYear()+_b);
break;
case "week":
_b*=7;
_c.setDate(_9.getDate()+_b);
break;
case "month":
var _14=_9.getMonth(),_15=_14+_b;
if(!_9.isLeapYear(_9.getFullYear())){
if(_14<5&&_15>=5){
_15++;
}else{
if(_14>5&&_15<=5){
_15--;
}
}
}
_c.setMonth(_15);
break;
case "hour":
_c.setHours(_9.getHours()+_b);
break;
case "minute":
_c._addMinutes(_b);
break;
case "second":
_c._addSeconds(_b);
break;
case "millisecond":
_c._addMilliseconds(_b);
break;
}
return _c;
};
_4.difference=function(_16,_17,_18){
_17=_17||new _3();
_18=_18||"day";
var _19=_17.getFullYear()-_16.getFullYear();
var _1a=1;
switch(_18){
case "weekday":
var _1b=Math.round(_4.difference(_16,_17,"day"));
var _1c=parseInt(_4.difference(_16,_17,"week"));
var mod=_1b%7;
if(mod==0){
_1b=_1c*5;
}else{
var adj=0;
var _1d=_16.getDay();
var _1e=_17.getDay();
_1c=parseInt(_1b/7);
mod=_1b%7;
var _1f=new _3(_16);
_1f.setDate(_1f.getDate()+(_1c*7));
var _20=_1f.getDay();
if(_1b>0){
switch(true){
case _1d==5:
adj=-1;
break;
case _1d==6:
adj=0;
break;
case _1e==5:
adj=-1;
break;
case _1e==6:
adj=-2;
break;
case (_20+mod)>5:
adj=-2;
}
}else{
if(_1b<0){
switch(true){
case _1d==5:
adj=0;
break;
case _1d==6:
adj=1;
break;
case _1e==5:
adj=2;
break;
case _1e==6:
adj=1;
break;
case (_20+mod)<0:
adj=2;
}
}
}
_1b+=adj;
_1b-=(_1c*2);
}
_1a=_1b;
break;
case "year":
_1a=_19;
break;
case "month":
var _21=(_17.toGregorian()>_16.toGregorian())?_17:_16;
var _22=(_17.toGregorian()>_16.toGregorian())?_16:_17;
var _23=_21.getMonth();
var _24=_22.getMonth();
if(_19==0){
_1a=(!_17.isLeapYear(_17.getFullYear())&&_21.getMonth()>5&&_22.getMonth()<=5)?(_21.getMonth()-_22.getMonth()-1):(_21.getMonth()-_22.getMonth());
}else{
_1a=(!_22.isLeapYear(_22.getFullYear())&&_24<6)?(13-_24-1):(13-_24);
_1a+=(!_21.isLeapYear(_21.getFullYear())&&_23>5)?(_23-1):_23;
var i=_22.getFullYear()+1;
var e=_21.getFullYear();
for(i;i<e;i++){
_1a+=_22.isLeapYear(i)?13:12;
}
}
if(_17.toGregorian()<_16.toGregorian()){
_1a=-_1a;
}
break;
case "week":
_1a=parseInt(_4.difference(_16,_17,"day")/7);
break;
case "day":
_1a/=24;
case "hour":
_1a/=60;
case "minute":
_1a/=60;
case "second":
_1a/=1000;
case "millisecond":
_1a*=_17.toGregorian().getTime()-_16.toGregorian().getTime();
}
return Math.round(_1a);
};
return _4;
});


;define("dojox/date/islamic/Date",["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(_1,_2,dd){
var _3=_2("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){
var _4=arguments.length;
if(!_4){
this.fromGregorian(new Date());
}else{
if(_4==1){
var _5=arguments[0];
if(typeof _5=="number"){
_5=new Date(_5);
}
if(_5 instanceof Date){
this.fromGregorian(_5);
}else{
if(_5==""){
this._date=new Date("");
}else{
this._year=_5._year;
this._month=_5._month;
this._date=_5._date;
this._hours=_5._hours;
this._minutes=_5._minutes;
this._seconds=_5._seconds;
this._milliseconds=_5._milliseconds;
}
}
}else{
if(_4>=3){
this._year+=arguments[0];
this._month+=arguments[1];
this._date+=arguments[2];
this._hours+=arguments[3]||0;
this._minutes+=arguments[4]||0;
this._seconds+=arguments[5]||0;
this._milliseconds+=arguments[6]||0;
}
}
}
},getDate:function(){
return this._date;
},getMonth:function(){
return this._month;
},getFullYear:function(){
return this._year;
},getDay:function(){
return this.toGregorian().getDay();
},getHours:function(){
return this._hours;
},getMinutes:function(){
return this._minutes;
},getSeconds:function(){
return this._seconds;
},getMilliseconds:function(){
return this._milliseconds;
},setDate:function(_6){
_6=parseInt(_6);
if(_6>0&&_6<=this.getDaysInIslamicMonth(this._month,this._year)){
this._date=_6;
}else{
var _7;
if(_6>0){
for(_7=this.getDaysInIslamicMonth(this._month,this._year);_6>_7;_6-=_7,_7=this.getDaysInIslamicMonth(this._month,this._year)){
this._month++;
if(this._month>=12){
this._year++;
this._month-=12;
}
}
this._date=_6;
}else{
for(_7=this.getDaysInIslamicMonth((this._month-1)>=0?(this._month-1):11,((this._month-1)>=0)?this._year:this._year-1);_6<=0;_7=this.getDaysInIslamicMonth((this._month-1)>=0?(this._month-1):11,((this._month-1)>=0)?this._year:this._year-1)){
this._month--;
if(this._month<0){
this._year--;
this._month+=12;
}
_6+=_7;
}
this._date=_6;
}
}
return this;
},setFullYear:function(_8){
this._year=+_8;
},setMonth:function(_9){
this._year+=Math.floor(_9/12);
if(_9>0){
this._month=Math.floor(_9%12);
}else{
this._month=Math.floor(((_9%12)+12)%12);
}
},setHours:function(){
var _a=arguments.length;
var _b=0;
if(_a>=1){
_b=parseInt(arguments[0]);
}
if(_a>=2){
this._minutes=parseInt(arguments[1]);
}
if(_a>=3){
this._seconds=parseInt(arguments[2]);
}
if(_a==4){
this._milliseconds=parseInt(arguments[3]);
}
while(_b>=24){
this._date++;
var _c=this.getDaysInIslamicMonth(this._month,this._year);
if(this._date>_c){
this._month++;
if(this._month>=12){
this._year++;
this._month-=12;
}
this._date-=_c;
}
_b-=24;
}
this._hours=_b;
},_addMinutes:function(_d){
_d+=this._minutes;
this.setMinutes(_d);
this.setHours(this._hours+parseInt(_d/60));
return this;
},_addSeconds:function(_e){
_e+=this._seconds;
this.setSeconds(_e);
this._addMinutes(parseInt(_e/60));
return this;
},_addMilliseconds:function(_f){
_f+=this._milliseconds;
this.setMilliseconds(_f);
this._addSeconds(parseInt(_f/1000));
return this;
},setMinutes:function(_10){
this._minutes=_10%60;
return this;
},setSeconds:function(_11){
this._seconds=_11%60;
return this;
},setMilliseconds:function(_12){
this._milliseconds=_12%1000;
return this;
},toString:function(){
if(isNaN(this._date)){
return "Invalidate Date";
}else{
var x=new Date();
x.setHours(this._hours);
x.setMinutes(this._minutes);
x.setSeconds(this._seconds);
x.setMilliseconds(this._milliseconds);
return this._month+" "+this._date+" "+this._year+" "+x.toTimeString();
}
},toGregorian:function(){
var _13=this._year;
var _14=this._month;
var _15=this._date;
var _16=_15+Math.ceil(29.5*_14)+(_13-1)*354+Math.floor((3+(11*_13))/30)+this._ISLAMIC_EPOCH-1;
var wjd=Math.floor(_16-0.5)+0.5,_17=wjd-this._GREGORIAN_EPOCH,_18=Math.floor(_17/146097),dqc=this._mod(_17,146097),_19=Math.floor(dqc/36524),_1a=this._mod(dqc,36524),_1b=Math.floor(_1a/1461),_1c=this._mod(_1a,1461),_1d=Math.floor(_1c/365),_1e=(_18*400)+(_19*100)+(_1b*4)+_1d;
if(!(_19==4||_1d==4)){
_1e++;
}
var _1f=this._GREGORIAN_EPOCH+(365*(_1e-1))+Math.floor((_1e-1)/4)-(Math.floor((_1e-1)/100))+Math.floor((_1e-1)/400);
var _20=wjd-_1f;
var tjd=(this._GREGORIAN_EPOCH-1)+(365*(_1e-1))+Math.floor((_1e-1)/4)-(Math.floor((_1e-1)/100))+Math.floor((_1e-1)/400)+Math.floor((739/12)+((dd.isLeapYear(new Date(_1e,3,1))?-1:-2))+1);
var _21=((wjd<tjd)?0:(dd.isLeapYear(new Date(_1e,3,1))?1:2));
var _22=Math.floor((((_20+_21)*12)+373)/367);
var _23=(this._GREGORIAN_EPOCH-1)+(365*(_1e-1))+Math.floor((_1e-1)/4)-(Math.floor((_1e-1)/100))+Math.floor((_1e-1)/400)+Math.floor((((367*_22)-362)/12)+((_22<=2)?0:(dd.isLeapYear(new Date(_1e,(_22-1),1))?-1:-2))+1);
var day=(wjd-_23)+1;
var _24=new Date(_1e,(_22-1),day,this._hours,this._minutes,this._seconds,this._milliseconds);
return _24;
},fromGregorian:function(_25){
var _26=new Date(_25);
var _27=_26.getFullYear(),_28=_26.getMonth(),_29=_26.getDate();
var _2a=(this._GREGORIAN_EPOCH-1)+(365*(_27-1))+Math.floor((_27-1)/4)+(-Math.floor((_27-1)/100))+Math.floor((_27-1)/400)+Math.floor((((367*(_28+1))-362)/12)+(((_28+1)<=2)?0:(dd.isLeapYear(_26)?-1:-2))+_29);
_2a=Math.floor(_2a)+0.5;
var _2b=_2a-this._ISLAMIC_EPOCH;
var _2c=Math.floor((30*_2b+10646)/10631);
var _2d=Math.ceil((_2b-29-this._yearStart(_2c))/29.5);
_2d=Math.min(_2d,11);
var _2e=Math.ceil(_2b-this._monthStart(_2c,_2d))+1;
this._date=_2e;
this._month=_2d;
this._year=_2c;
this._hours=_26.getHours();
this._minutes=_26.getMinutes();
this._seconds=_26.getSeconds();
this._milliseconds=_26.getMilliseconds();
this._day=_26.getDay();
return this;
},valueOf:function(){
return this.toGregorian().valueOf();
},_yearStart:function(_2f){
return (_2f-1)*354+Math.floor((3+11*_2f)/30);
},_monthStart:function(_30,_31){
return Math.ceil(29.5*_31)+(_30-1)*354+Math.floor((3+11*_30)/30);
},_civilLeapYear:function(_32){
return (14+11*_32)%30<11;
},getDaysInIslamicMonth:function(_33,_34){
var _35=0;
_35=29+((_33+1)%2);
if(_33==11&&this._civilLeapYear(_34)){
_35++;
}
return _35;
},_mod:function(a,b){
return a-(b*Math.floor(a/b));
}});
_3.getDaysInIslamicMonth=function(_36){
return new _3().getDaysInIslamicMonth(_36.getMonth(),_36.getFullYear());
};
return _3;
});


;define("dojox/date/islamic",["..","dojo/_base/lang","dojo/date","./islamic/Date"],function(_1,_2,dd,_3){
var _4=_2.getObject("date.islamic",true,_1);
_4.getDaysInMonth=function(_5){
return _5.getDaysInIslamicMonth(_5.getMonth(),_5.getFullYear());
};
_4.compare=function(_6,_7,_8){
if(_6 instanceof _3){
_6=_6.toGregorian();
}
if(_7 instanceof _3){
_7=_7.toGregorian();
}
return dd.compare.apply(null,arguments);
};
_4.add=function(_9,_a,_b){
var _c=new _3(_9);
switch(_a){
case "day":
_c.setDate(_9.getDate()+_b);
break;
case "weekday":
var _d=_9.getDay();
if(((_d+_b)<5)&&((_d+_b)>0)){
_c.setDate(_9.getDate()+_b);
}else{
var _e=0,_f=0;
if(_d==5){
_d=4;
_f=(_b>0)?-1:1;
}else{
if(_d==6){
_d=4;
_f=(_b>0)?-2:2;
}
}
var add=(_b>0)?(5-_d-1):-_d;
var _10=_b-add;
var div=parseInt(_10/5);
if(_10%5!=0){
_e=(_b>0)?2:-2;
}
_e=_e+div*7+_10%5+add;
_c.setDate(_9.getDate()+_e+_f);
}
break;
case "year":
_c.setFullYear(_9.getFullYear()+_b);
break;
case "week":
_b*=7;
_c.setDate(_9.getDate()+_b);
break;
case "month":
var _11=_9.getMonth();
_c.setMonth(_11+_b);
break;
case "hour":
_c.setHours(_9.getHours()+_b);
break;
case "minute":
_c._addMinutes(_b);
break;
case "second":
_c._addSeconds(_b);
break;
case "millisecond":
_c._addMilliseconds(_b);
break;
}
return _c;
};
_4.difference=function(_12,_13,_14){
_13=_13||new _3();
_14=_14||"day";
var _15=_13.getFullYear()-_12.getFullYear();
var _16=1;
switch(_14){
case "weekday":
var _17=Math.round(_4.difference(_12,_13,"day"));
var _18=parseInt(_4.difference(_12,_13,"week"));
var mod=_17%7;
if(mod==0){
_17=_18*5;
}else{
var adj=0;
var _19=_12.getDay();
var _1a=_13.getDay();
_18=parseInt(_17/7);
mod=_17%7;
var _1b=new _3(_12);
_1b.setDate(_1b.getDate()+(_18*7));
var _1c=_1b.getDay();
if(_17>0){
switch(true){
case _19==5:
adj=-1;
break;
case _19==6:
adj=0;
break;
case _1a==5:
adj=-1;
break;
case _1a==6:
adj=-2;
break;
case (_1c+mod)>5:
adj=-2;
}
}else{
if(_17<0){
switch(true){
case _19==5:
adj=0;
break;
case _19==6:
adj=1;
break;
case _1a==5:
adj=2;
break;
case _1a==6:
adj=1;
break;
case (_1c+mod)<0:
adj=2;
}
}
}
_17+=adj;
_17-=(_18*2);
}
_16=_17;
break;
case "year":
_16=_15;
break;
case "month":
var _1d=(_13.toGregorian()>_12.toGregorian())?_13:_12;
var _1e=(_13.toGregorian()>_12.toGregorian())?_12:_13;
var _1f=_1d.getMonth();
var _20=_1e.getMonth();
if(_15==0){
_16=_1d.getMonth()-_1e.getMonth();
}else{
_16=12-_20;
_16+=_1f;
var i=_1e.getFullYear()+1;
var e=_1d.getFullYear();
for(i;i<e;i++){
_16+=12;
}
}
if(_13.toGregorian()<_12.toGregorian()){
_16=-_16;
}
break;
case "week":
_16=parseInt(_4.difference(_12,_13,"day")/7);
break;
case "day":
_16/=24;
case "hour":
_16/=60;
case "minute":
_16/=60;
case "second":
_16/=1000;
case "millisecond":
_16*=_13.toGregorian().getTime()-_12.toGregorian().getTime();
}
return Math.round(_16);
};
return _4;
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["ic-ui"]=true;

;define("ic-ui/util/Url",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/_base/url"],function(_1,_2,_3,_4){
function _5(_6){
var _7={};
if(!_6){
return _7;
}
if(_6.charAt(0)=="?"){
_6=_6.substring(1);
}
var i,_8=_6.split("&"),_9,_a,_b,_c;
for(i=0;i<_8.length;i++){
if(_8[i].length>0){
_9=_8[i].indexOf("=");
if(_9==-1){
_a=decodeURIComponent(_8[i]);
_b=_7[_a];
if(_3.isArray(_b)){
_b.push("");
}else{
if(_b){
_7[_a]=[_b,""];
}else{
_7[_a]="";
}
}
}else{
if(_9>0){
_a=decodeURIComponent(_8[i].substring(0,_9));
_c=decodeURIComponent(_8[i].substring(_9+1));
_b=_7[_a];
if(_3.isArray(_b)){
_b.push(_c);
}else{
if(_b){
_7[_a]=[_b,_c];
}else{
_7[_a]=_c;
}
}
}
}
}
}
return _7;
};
function _d(_e){
var _f,_10,i,out=[];
for(_f in _e){
if(_e.hasOwnProperty(_f)){
_10=_e[_f];
if(_10!==undefined&&_10!=null){
_f=encodeURIComponent(_f);
if(_3.isArray(_10)){
for(i=0;i<_10.length;i++){
if(_10[i]){
out.push(out.length==0?"?":"&");
out.push(_f);
out.push("=");
out.push(encodeURIComponent(_10[i]));
}
}
}else{
out.push(out.length==0?"?":"&");
out.push(_f);
out.push("=");
out.push(encodeURIComponent(_10));
}
}
}
}
return out.join("");
};
var Url=_2("com.ibm.oneui.util.Url",_4,{getQuery:function(){
if(!this.queryParameters){
this.queryParameters=_5(this.query);
}
return this.queryParameters;
},getQueryString:function(){
var _11=this.queryParameters;
if(_11){
this.query=_d(_11);
this.queryParameters=null;
}
return this.query;
},toString:function(){
var uri=[];
if(this.scheme){
uri.push(this.scheme);
uri.push(":");
}
if(this.authority){
uri.push("//");
uri.push(this.authority);
}
uri.push(this.path);
var _12=this.getQueryString();
if(_12){
if(_12.charAt(0)!="?"){
uri.push("?");
}
uri.push(_12);
}
if(this.fragment){
uri.push("#");
uri.push(this.fragment);
}
return uri.join("");
}});
Url.secure=((window.location.protocol||"http").replace(":","")=="https");
return Url;
});


;define("ic-core/config",[],function(){
return {"deploymentId":"com.ibm.lc.8a2bb217-3578-407b-9a86-fffce8aba623","enableEmail":true,"languageSensitivity":true,"multiTenantEnabled":true,"sessionCookies":["JSESSIONID"],"versionStamp":"20160903.134200"};
});


;define("ic-core/config/services",[],function(){
var _1={"activities":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/activities","url":"https://apps.na.collabserv.com/activities"},"blogs":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/blogs","url":"https://apps.na.collabserv.com/blogs"},"bookmarklet":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/bookmarklet","url":"https://apps.na.collabserv.com/connections/bookmarklet"},"bss":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/manage","url":"https://apps.na.collabserv.com/manage"},"communities":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/communities","url":"https://apps.na.collabserv.com/communities"},"deploymentConfig":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections","url":"https://apps.na.collabserv.com/connections"},"eventTracker":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/search","url":"https://apps.na.collabserv.com/search"},"extensionRegistry":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/appregistry","url":"https://apps.na.collabserv.com/appregistry"},"files":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/files","url":"https://apps.na.collabserv.com/files"},"files-wopi":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/wopi","url":"https://apps.na.collabserv.com/wopi"},"forums":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/forums","url":"https://apps.na.collabserv.com/forums"},"help":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/help","url":"https://apps.na.collabserv.com/help"},"homepage":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/homepage","url":"https://apps.na.collabserv.com/homepage"},"mediaGallery":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/news/widgets/lw","url":"https://apps.na.collabserv.com/news/widgets/lw"},"metrics":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/metricssc","url":"https://apps.na.collabserv.com/metricssc"},"microblogging":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/opensocial","url":"https://apps.na.collabserv.com/connections/opensocial"},"mobile":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/mobile","url":"https://apps.na.collabserv.com/mobile"},"news":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/news","url":"https://apps.na.collabserv.com/news"},"oauth":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/oauth","url":"https://apps.na.collabserv.com/connections/oauth"},"oauthprovider":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/oauth2","url":"https://apps.na.collabserv.com/oauth2"},"opengraph":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/opengraph","url":"https://apps.na.collabserv.com/connections/opengraph"},"opensocial":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/opensocial","url":"https://apps.na.collabserv.com/connections/opensocial"},"pushnotification":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/push","url":"https://apps.na.collabserv.com/push"},"rte":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/rte","url":"https://apps.na.collabserv.com/connections/rte"},"sand":{"enabled":true,"secureEnabled":true},"scprofiles":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/contacts/profiles","url":"https://apps.na.collabserv.com/contacts/profiles"},"search":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/search","url":"https://apps.na.collabserv.com/search"},"thumbnail":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/thumbnail","url":"https://apps.na.collabserv.com/connections/thumbnail"},"webresources":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/connections/resources","url":"https://apps.na.collabserv.com/connections/resources"},"wikis":{"enabled":true,"secureEnabled":true,"secureUrl":"https://apps.na.collabserv.com/wikis","url":"https://apps.na.collabserv.com/wikis"}};
if(dojo.exists("filterByEnabledServices")){
_1=filterByEnabledServices(_1);
}
return _1;
});


;define("ic-core/util/Url",["dojo/_base/url","dojo/_base/declare"],function(_1,_2){
var _3=_2("lconn.core.util.Url",_1,{getQuery:function(){
if(!this.queryParameters){
this.queryParameters=_4(this.query);
}
return this.queryParameters;
},getQueryString:function(){
var _5=this.queryParameters;
if(_5){
this.query=_6(_5);
this.queryParameters=null;
}
return this.query;
},toString:function(){
var _7=[];
if(this.scheme){
_7.push(this.scheme);
_7.push(":");
}
if(this.authority){
_7.push("//");
_7.push(this.authority);
}
_7.push(this.path);
var _8=this.getQueryString();
if(_8){
if(_8.charAt(0)!="?"){
_7.push("?");
}
_7.push(_8);
}
if(this.fragment){
_7.push("#");
_7.push(this.fragment);
}
return _7.join("");
}});
function _4(_9){
var _a={};
if(!_9){
return _a;
}
if(_9.charAt(0)=="?"){
_9=_9.substring(1);
}
var _b=_9.split("&");
for(var i=0;i<_b.length;i++){
if(_b[i].length>0){
var _c=_b[i].indexOf("=");
if(_c==-1){
var _d=decodeURIComponent(_b[i]);
var _e=_a[_d];
if(dojo.isArray(_e)){
_e.push("");
}else{
if(_e){
_a[_d]=[_e,""];
}else{
_a[_d]="";
}
}
}else{
if(_c>0){
var _d=decodeURIComponent(_b[i].substring(0,_c));
var _f=decodeURIComponent(_b[i].substring(_c+1));
var _e=_a[_d];
if(dojo.isArray(_e)){
_e.push(_f);
}else{
if(_e){
_a[_d]=[_e,_f];
}else{
_a[_d]=_f;
}
}
}
}
}
}
return _a;
};
function _6(map){
var out=[];
for(var key in map){
var _10=map[key];
if(_10!==undefined&&_10!=null){
key=encodeURIComponent(key);
if(dojo.isArray(_10)){
for(var i=0;i<_10.length;i++){
if(_10[i]){
out.push(out.length==0?"?":"&");
out.push(key);
out.push("=");
out.push(encodeURIComponent(_10[i]));
}
}
}else{
out.push(out.length==0?"?":"&");
out.push(key);
out.push("=");
out.push(encodeURIComponent(_10));
}
}
}
return out.join("");
};
_3.secure=((window.location.protocol||"http").replace(":","")=="https");
return _3;
});


;define("ic-core/url",["ic-core/util/Url"],function(_1){
var _2=(window.location.protocol||"http").replace(":","")=="https";
function _3(_4,_5){
var l=arguments.length,u=null;
if(!_4){
return null;
}else{
if((typeof _4!="string"&&console.trace)||(_5&&typeof _5!="string"&&console.trace)){
throw "Arguments for URI must be a string";
}
}
_4=new dojo._Url(_4,_5);
_4.queryParameters=_6(_4);
return _4;
};
function _7(_8){
if(!_8){
return null;
}
var _9="";
if(_8.scheme){
_9+=_8.scheme+":";
}
if(_8.authority){
_9+="//"+_8.authority;
}
_9+=_8.path;
if(_8.queryParameters){
_9+=_a(_8.queryParameters);
}else{
if(_8.query){
_9+=((_8.query.charAt(0)!="?")?"?":"")+_8.query;
}
}
if(_8.fragment){
_9+="#"+_8.fragment;
}
return _9;
};
dojo._Url.prototype.toCanonicalString=function(){
return _7(this);
};
function _b(_c,p){
if(_c&&p){
_c=_3(_c);
dojo.mixin(_c.queryParameters,p);
_c=_7(_c);
}
return _c;
};
function _d(_e){
var _f={};
if(!_e){
return _f;
}
if(_e.charAt(0)=="?"){
_e=_e.substring(1);
}
var _10=_e.split("&");
for(var i=0;i<_10.length;i++){
if(_10[i].length>0){
var _11=_10[i].indexOf("=");
if(_11==-1){
var key=decodeURIComponent(_10[i]);
var _12=_f[key];
if(dojo.isArray(_12)){
_12.push("");
}else{
if(_12){
_f[key]=[_12,""];
}else{
_f[key]="";
}
}
}else{
if(_11>0){
var key=decodeURIComponent(_10[i].substring(0,_11));
var _13=decodeURIComponent(_10[i].substring(_11+1));
var _12=_f[key];
if(dojo.isArray(_12)){
_12.push(_13);
}else{
if(_12){
_f[key]=[_12,_13];
}else{
_f[key]=_13;
}
}
}
}
}
}
return _f;
};
function _6(uri){
if(!uri){
return {};
}
if(typeof uri=="string"){
uri=new dojo._Url(uri);
}
return _d(uri.query);
};
function _a(map){
var out=[];
for(var key in map){
var _14=map[key];
if(typeof _14!="undefined"&&_14!=null){
key=encodeURIComponent(key);
if(dojo.isArray(_14)){
for(var i=0;i<_14.length;i++){
if(_14[i]){
out.push(out.length==0?"?":"&");
out.push(key);
out.push("=");
out.push(encodeURIComponent(_14[i]));
}
}
}else{
out.push(out.length==0?"?":"&");
out.push(key);
out.push("=");
out.push(encodeURIComponent(_14));
}
}
}
return out.join("");
};
function _15(_16,_17){
var _18=null;
if(!_16){
return null;
}else{
if(_2||_17){
if(_16.secureEnabled&&_16.secureUrl){
_18=_16.secureUrl;
}else{
if(_16.url){
_18=_16.url;
}else{
return null;
}
}
}else{
if(_16.url){
_18=_16.url;
}else{
if(_16.secureEnabled&&_16.secureUrl){
_18=_16.secureUrl;
}else{
return null;
}
}
}
}
return new _1(_18);
};
function _19(_1a){
if(!_1a){
throw "Null URL is not permitted";
}
return new dojo._Url(dojo.global.location.toString(),_1a).toString();
};
function _1b(url,_1c){
var _1d=_3(url);
var _1e=_1c||ibmConfig.serviceName;
switch(_1e){
case "wikis":
if(_1d.fragment&&_1d.fragment.indexOf("!")===0){
_1d.fragment=_1d.fragment.substr(1);
}
case "files":
if(_1d.fragment){
_1d.path+=_1d.fragment;
delete _1d.fragment;
}
break;
}
return _1d.toCanonicalString();
};
return {parse:_3,write:_7,rewrite:_b,splitQuery:_d,getRequestParameters:_6,writeParameters:_a,ensureQualified:_19,getServiceUrl:_15,canonicalize:_1b,secure:_2};
});


;define("ic-core/auth",["dojo","dojo/query","dojo/Deferred","dojo/_base/array","dojo/_base/config","dojo/DeferredList","dojo/_base/lang","dojo/dom","dojo/_base/json","dojo/dom-attr","dojo/request","dojo/string","ic-ui/util/Url","ic-core/config","ic-core/config/services","ic-core/url"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){
var _11=_7.getObject("ibmConfig.serviceName");
var _12=5000,_13=[],_14=[],_15={defaultApp:"${appSvcUrl}/core/login_redirect?redirect=${redirectUrl}",activities:"${appSvcUrl}/service/authredirect.jsp",blogs:"${appSvcUrl}/roller-ui/login-redirect.jsp?redirect=${redirectUrl}",communities:"${appSvcUrl}/service/html/login",dogear:"${appSvcUrl}/loginredirect?redirect=${redirectUrl}",files:"${appSvcUrl}/form/login_redirect?redirect=${redirectUrl}",forums:"${appSvcUrl}/auth/redirect",homepage:"${appSvcUrl}/web/login_redirect?redirectUrl=${redirectUrl}",metrics:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}",moderation:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}",news:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}",oauth:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}",profiles:"${appSvcUrl}/auth/loginRedirect.do",search:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}",wikis:"${appSvcUrl}/form/login_redirect?redirect=${redirectUrl}",webresources:"${appSvcUrl}/login_redirect?redirect=${redirectUrl}"},_16=null,_17=null,_18=null;
function _19(key,_1a){
document.cookie=key+"="+_1a+"; path=/";
};
function _1b(_1c,opt){
switch(_1c){
case "activities":
_19("ActivitiesRedirect",opt.redirectUrl);
break;
case "communities":
_19("CommunitiesReqURL",opt.redirectUrl);
break;
case "forums":
_19("ForumReqURL",opt.redirectUrl);
break;
case "homepage":
_19("ConnectionsHomepageActivityStreamState",opt.redirectUrl);
break;
case "profiles":
_19("ProfilesReqURL",opt.redirectUrl);
break;
}
};
function _1d(){
var _1e=[];
if(!_1f.isAuthenticated()){
_4.forEach(_13,function(_20,i){
var dfd=_20();
if(dfd&&dfd instanceof _3){
_1e.push(dfd);
}
});
}
return _1e;
};
function _21(_22){
var _23=[];
if(_22||_1f.isAuthenticated()){
_4.forEach(_14,function(_24,i){
var dfd=_24();
if(dfd&&dfd instanceof _3){
_23.push(dfd);
}
});
}
return _23;
};
function _25(){
if(_11){
return _11;
}
var _26=_8.byId("lotusBaseStylesheet");
if(_26){
var _27=_a.get(_26,"appName");
if(_27){
return _27;
}
}
return "news";
};
function _28(_29){
var _2a=window.location.href;
var _2b=_25();
var _2c=_f[_2b];
if(_2c){
_2a=(_2c.secureEnabled&&_29!==false)?_2c.secureUrl:_2c.url;
}
var _2d=_10.parse(_2a);
return _2d.toString();
};
function _2e(){
var _2f=null,_30=_8.byId("userInfo");
if(_30){
_2f=_9.fromJson(_30.innerText);
}
return _2f;
};
var _1f=_7.mixin(_7.getObject("lconn.core.auth",true),{addLoginHandler:function(_31){
_13.push(_31);
},addLogoutHandler:function(_32){
_14.push(_32);
},login:function(url){
var _33=new _6(_1d(),false);
var _34=url||_1f.getLoginUrl();
_33.addBoth(function(_35){
window.location.href=_34;
});
},logoutAndLogin:function(url){
_21(true);
var _36=_1f.getLogoutUrl();
_b(_36,{method:"POST",handleAs:"text",secure:false,timeout:_12}).then(function(){
_1f.login(url);
},function(){
_1f.login(url);
});
},logout:function(url){
var _37=new _6(_21(),false);
var _38=url||_1f.getLogoutUrl("/");
_37.addBoth(function(_39){
window.location.href=_38;
});
},getUser:function(_3a){
if(!this.isAuthenticated()){
return null;
}
_3a=_3a||_11;
if(!_18||_5.isDebug){
_18=null;
switch(_3a){
case "activities":
if(_7.exists("_oa_current_user")){
_18={displayName:_oa_current_user.name,id:_oa_current_user.userid,email:_oa_current_user.email,isExternal:_oa_current_user.isExternal,_native:_oa_current_user};
}
break;
case "blogs":
case "dogear":
if(_7.exists("currentLogin")){
_18={displayName:currentLogin.name,id:currentLogin.extid,email:currentLogin.email,isExternal:currentLogin.isExternal,_native:currentLogin};
}
break;
case "communities":
var _3b;
if(_7.exists("communityActionData")){
_3b=communityActionData;
}else{
if(_7.exists("lconn.communities.bizCard.core.community")){
_3b=lconn.communities.bizCard.core.community;
}
}
if(_3b){
_18={displayName:_3b.userName,id:_3b.userUuid,email:_3b.userEmail,isExternal:_3b.userIsExternal,_native:_3b};
}else{
if(_7.exists("lconnCurrentUser")){
_18=_7.clone(lconnCurrentUser);
_18._native=lconnCurrentUser;
}
}
break;
case "forums":
if(_7.exists("forumsUser")){
_18={displayName:forumsUser};
}
if(_7.exists("forumsUserId")){
_18=_18||{};
_18.id=forumsUserId;
}
if(_7.exists("forumsUserExternal")){
_18=_18||{};
_18.isExternal=forumsUserExternal==1;
}
break;
case "homepage":
case "news":
if(_7.exists("lconn.homepage.userName")){
_18={displayName:lconn.homepage.userName};
}
if(_7.exists("lconn.homepage.userEmail")){
_18=_18||{};
_18.email=lconn.homepage.userEmail;
}
if(_7.exists("lconn.homepage.userExtId")){
_18=_18||{};
_18.id=lconn.homepage.userExtId;
}
if(_7.exists("lconn.homepage.userIsExternal")){
_18=_18||{};
_18.isExternal=lconn.homepage.userIsExternal;
}
break;
case "profiles":
if(_7.exists("profilesData.loggedInUser")){
_18={displayName:profilesData.loggedInUser.displayName,id:profilesData.loggedInUser.userid,email:profilesData.loggedInUser.email,isExternal:profilesData.loggedInUser.isExternal,_native:profilesData.loggedInUser};
}
break;
case "files":
case "wikis":
case "metrics":
case "moderation":
if(_7.exists("pe.authenticatedUser")){
_18={displayName:pe.authenticatedUser.name,id:pe.authenticatedUser.id,email:pe.authenticatedUser.email,isExternal:pe.authenticatedUser.isExternal,_native:pe.authenticatedUser};
}else{
var _3c=_2e();
if(_3c){
_18={displayName:_3c.name,email:_3c.email,id:_3c.id,isExternal:_3c.isExternal,_native:_3c};
}
}
break;
case "search":
if(_7.exists("lconnCurrentUser")){
_18=_7.clone(lconnCurrentUser);
_18._native=lconnCurrentUser;
}
break;
default:
if(_7.exists("currentViewer")){
_18={displayName:currentViewer.displayName,id:currentViewer.id&&currentViewer.id.substring(currentViewer.id.lastIndexOf(":")+1),email:(_4.filter(currentViewer.emails,function(e){
return e.primary;
})[0]||{}).value,isExternal:_7.getObject("appData.connections.isExternal",false,currentViewer)==="true",orgId:_7.getObject("appData.connections.organizationId",false,currentViewer)};
_18._native=currentViewer;
}else{
if(_7.exists("icUser")){
_18=_7.clone(icUser);
_18._native=icUser;
}
}
}
}
return _18;
},isAuthenticated:function(){
if(_7.isFunction(_16)){
return _16();
}
if(_17===null){
switch(_11){
case "files":
case "wikis":
_17=_7.getObject("pe.authenticatedUser");
if(!_17){
_17=_2e()!==null;
}
if(_17){
break;
}
default:
var _3d=_2("#headerUserName img")[0];
var _3e=_3d&&_3d.alt!=="";
if(_3e===undefined){
_17=null;
}else{
_17=_3e;
}
}
}
return _17;
},setAuthCheck:function(cb){
if(_7.isFunction(cb)){
_16=cb;
}
},getLogoutUrl:function(_3f){
var _40=_28(_d.secure);
var _41=_3f||"/";
_40=_40+"/ibm_security_logout?logoutExitPage="+encodeURIComponent(_41);
return _40;
},getLoginUrl:function(url){
url=url||window.location.href;
var _42=_25("default");
var u=_10.parse(url);
if(u.fragment){
switch(_42){
case "activities":
u.fragment=u.fragment.replace(/,/g,"%2C");
break;
case "files":
case "metrics":
case "moderation":
case "wikis":
u.path+=u.fragment.indexOf("!")===0?u.fragment.substring(1):u.fragment;
delete u.fragment;
}
}
var _43=_f[_42].secureUrl;
if(_43.charAt(_43.length-1)=="/"){
_43=_43.substring(0,_43.length-1);
}
var opt={appSvcUrl:_43,redirectUrl:u.toCanonicalString(),hashSegment:u.fragment||""};
_1b(_42,opt);
opt.redirectUrl=encodeURIComponent(opt.redirectUrl);
return _c.substitute(_15[_42],opt);
}});
_1f.logoutAndlogin=_1f.logoutAndLogin;
return _1f;
});


;define("ic-core/config/properties",[],function(){
return {"CORS.Trusted.Websites":"na.collabserv.com","DeploymentModel":"SmartCloud","LotusLive":"true","ccmMediaView":"enabled","com.ibm.connections.ecm.OAuthEnabled":"enabled","com.ibm.connections.set.cookies.httpOnly":"true","com.ibm.docs.types.edit":"xlsm","com.ibm.docs.types.view":"dot,dotx,ott,pot,potx,otp,xlt,xltx,ots","com.ibm.lconn.communities.catalog.enabled":"true","com.ibm.lconn.communities.includePublicRole":"true","com.ibm.lconn.core.web.styles.theme.default":"none","com.ibm.lconn.files.api.throttler.filesync":"50","com.ibm.lconn.files.platform.throttler.rendition":"4","com.ibm.lconn.homepage.noCustomize":"true","com.ibm.lconn.oauth.ui.enabled":"false","com.ibm.lconn.personcard.enable":"off","com.ibm.social.as.noNetwork":"true","filesMediaView":"enabled","ic.profiles.cloud.deployed":"true","lconn.core.WidgetPlacement.communities.freeLayout":"false","lconn.core.WidgetPlacement.communities.limitedDND":"true","lconn.core.WidgetPlacement.communities.useCRE":"true","lconn.core.WidgetPlacement.profiles.useCRE":"true","people.typeahead":"enabled","quickResultsEnabled":"true","shindig.config.container.overrides":"{\"gadgets.sso\" : {\"cookieDomain\" : \"apps.na.collabserv.com\",\"cookieNames\" : \"LtpaToken,LtpaToken2\",\"samlSpDomain\" : \"mail.notes.collabservdaily.swg.usma.ibm.com\", \"spnegoDomain\" : null, \"samlIdpCookieNames\" : \"LtpaToken,LtpaToken2,iwaSSL,iwaSSL2,Shimmer,BSSUISESSIONID,token,user_dc,user_lang,LLN2Failover,LLN2Cookie,BIGipServerDailyA-BSSUI-9080-fe,BIGipServerDailyA-WebSEAL-80-fe,BIGipServerDailyB-BSSUI-9080-fe,BIGipServerDailyB-WebSEAL-80-fe,BIGipServerSpimDev1-WebSEAL-80-fe,BIGipServerSpimDev1-BSSUI-9080-fe,PD-ID,PD-H-SESSION-ID\", \"samlIdpHeaderNames\" : \"iv-creds,iv-groups,iv-user,referer,user-agent,via,iv-user-l,ldap_personid,ldap_subscriberid,iv_server_name,ldap_orgname,app_password,ldap_customerid,ldap_orgid,eai_auth,bypass_ip_check,ldap_extid,x-shindig-st,ldap_username,pragma,cache-control,x-forwarded-for,Cookie,X-Forwarded-Host,X-Forwarded-Server,Connection\", \"samlIdpInitialURL\" : \"https://apps.collabservdaily.swg.usma.ibm.com/sps/idp/saml11/login\", \"replaceSamlIdpURL\" : true},\"iwidget.sso\" : {\"handlers\" : \"com.ibm.cre.gadgets.sso.SAMLSSOHANDLER\"}}","shindig.properties.override.shindig.bean.converter.atom-class":"com.ibm.lotus.shindig.social.core.util.legacy.BeanXStreamAtomConverter","shindig.properties.override.shindig.bean.converter.json-class":"com.ibm.lotus.shindig.protocol.conversion.legacy.BeanJsonConverter","shindig.properties.override.shindig.bean.converter.xml-class":"com.ibm.lotus.shindig.protocol.conversion.legacy.BeanXStreamConverter","shindig.properties.override.shindig.cache.cacheTTLwithoutVersion":"2592000","shindig.properties.override.shindig.content-rewrite.include-tags":"body,embed,input,link,script,style","shindig.properties.override.shindig.xstream081.configuration-class":"com.ibm.lotus.shindig.social.core.util.xstream.legacy.XStream081Configuration","visitorModelEnabled":"false"};
});


;define("ic-core/globalization/config",["dojo/_base/lang","ic-core/config","ic-core/config/properties"],function(_1,_2,_3){
var _4={DEFAULT:"default",LEFT_TO_RIGHT:"ltr",RIGHT_TO_LEFT:"rtl",CONTEXTUAL:"contextual"},_5={GREGORIAN:"gregorian",HEBREW:"hebrew",HIJRI:"hijri"},_6={BIDI_ENABLED:"bidiEnabled",TEXT_DIRECTION:"textDirection",CALENDAR:"calendar"},_7={};
_7[_6.BIDI_ENABLED]=false;
_7[_6.TEXT_DIRECTION]=_4.DEFAULT;
_7[_6.CALENDAR]=_5.GREGORIAN;
return {SETTINGS_ENABLED_PROPERTY_NAME:"com.ibm.lconn.core.web.globalization.settings.enabled",TEXT_DIRECTION:_4,CALENDAR:_5,SETTINGS:_6,areSettingsEnabled:function(){
return _3[this.SETTINGS_ENABLED_PROPERTY_NAME]!==false;
},languageEnabled:false,defaults:_7};
});


;define("ic-core/util/PreferenceCache",["dojo/_base/lang","dojo/json"],function(_1,_2){
var _3="icprefs",_4=false;
try{
window.localStorage;
}
catch(e){
console.warn("Unable to access localStorage: "+e);
_4=true;
}
function _5(){
return _2.parse(localStorage.getItem(_3))||{};
};
function _6(_7){
localStorage.setItem(_3,_2.stringify(_7));
};
function _8(){
localStorage.removeItem(_3);
};
return {set:function(_9,_a){
if(_4){
return;
}
var o={};
o[_9]=_a;
_6(_1.mixin(_5(),o));
},unset:function(_b){
if(_4){
return;
}
var p=_5();
delete p[_b];
_6(p);
},get:function(_c){
return _4?undefined:_5()[_c];
},clear:function(){
if(_4){
return;
}
_8();
}};
});


;define("ic-core/globalization/api",["dojo","dojo/_base/lang","dojo/request","dojo/topic","ic-core/auth","ic-core/config","ic-core/config/services","ic-core/globalization/config","ic-core/url","ic-core/util/PreferenceCache","dojo/domReady!"],function(_1,_2,_3,_4,_5,_6,_7,_6,_8,_9){
var _a={},_b=_6,_c=_9;
if(_b.areSettingsEnabled()){
var _d="globalization",_e=false;
function _f(_10,_11){
if(_10){
switch(_10.status){
case 500:
case 404:
_4.publish("ic-core/preferences/unavailable");
_e=true;
}
}
};
function _12(){
if(!_5.isAuthenticated()){
return {};
}
var _13=_14();
if(!_13&&!_e){
_3(_15(),{method:"GET",failOk:true,handleAs:"json",sync:true}).then(function(r,i){
if(r instanceof Error){
_f(r,i);
return;
}
_13=_16(r);
_17(r,i);
});
}
return _13||{};
};
function _15(){
var _18=_8.getServiceUrl(_7.opensocial).toString();
return _18+"/rest/people/@me/@self?fields=userSettings.textDirection&fields=userSettings.bidiEnabled&fields=userSettings.calendar";
};
function _19(){
_1a();
if(!_5.isAuthenticated()){
return;
}
if(_14()){
return;
}
if(!_e){
_3(_15(),{method:"GET",handleAs:"json",timeout:3000}).then(_17,_f);
}
};
function _1b(){
if(arguments[1]){
_1c(arguments[1]);
}else{
_1d();
}
};
var MAP={CTX:"contextual",DEF:"default",LTR:"ltr",RTL:"rtl",HEB:"hebrew",HIJ:"hijri",GRE:"gregorian","true":true,"false":false};
function map(_1e){
var to={};
for(var _1f in _1e){
if(_1e.hasOwnProperty(_1f)){
to[_1f]=typeof MAP[_1e[_1f]]!=="undefined"?MAP[_1e[_1f]]:_1e[_1f];
}
}
return to;
};
function _16(_20){
return (_20&&_20.entry&&_20.entry.appData)?map(_20.entry.appData.userSettings):null;
};
function _14(){
return _c.get(_d);
};
function _1c(_21){
if(!_21){
console.debug("Trying to store invalid preference:",_21);
return;
}
_c.set(_d,_21);
};
function _17(_22,_23){
_1c(_16(_22));
};
var _24=false;
function _1a(){
if(!_24){
_4.subscribe("ic-core/globalization/saved",_1b);
_4.subscribe("ic-core/globalization/restored",_1b);
_5.addLogoutHandler(_1d);
_5.addLoginHandler(_1d);
_24=true;
}
};
function _1d(){
_c.unset(_d);
};
function _25(_26){
var ret=_12()[_26];
return typeof ret!=="undefined"?ret:_b.defaults[_26];
};
_2.mixin(_a,{isBidiEnabled:function(){
return _25(_b.SETTINGS.BIDI_ENABLED);
},getCalendar:function(){
return _25(_b.SETTINGS.CALENDAR);
},getTextDirection:function(){
return _25(_b.SETTINGS.TEXT_DIRECTION);
}});
setTimeout(_19,100);
}
return _a;
});


;define("ic-core/globalization/BidiDateUtil",["dojo/date","dojo/date/locale","dojox/date/hebrew","dojox/date/islamic","./api","./config"],function(_1,_2,_3,_4,_5,_6){
var _7=_6.CALENDAR,di=_4,il=di.locale,dh=_3,hl=dh.locale,dg=_1,gl=dg.locale;
function _8(){
return _5.getCalendar();
};
var _9={isHijri:function(){
return _8()==_7.HIJRI;
},isHebrew:function(){
return _8()==_7.HEBREW;
},isGregorian:function(){
return _8()==_7.GREGORIAN;
},getDateComponent:function(_a,_b,_c){
if(this.isHijri()){
return il.getNames(_a,_b);
}
if(this.isHebrew()){
return hl.getNames(_a,_b,null,null,_c||this.fromGregorian());
}
return gl.getNames(_a,_b);
},fromGregorian:function(d){
d=d!==undefined?new Date(d):new Date();
var _d;
if(this.isHijri()){
_d=new di.Date();
return _d.fromGregorian(d);
}
if(this.isHebrew()){
_d=new dh.Date();
return _d.fromGregorian(d);
}
return d;
},formatBidiDate:function(d,_e){
d=d!==undefined?new Date(d):new Date();
var _f;
if(this.isHijri()){
_f=new di.Date();
return il.format(_f.fromGregorian(d),_e);
}
if(this.isHebrew()){
_f=new dh.Date();
return hl.format(_f.fromGregorian(d),_e);
}
return gl.format(d,_e);
},getCalendar:_8,getBundle:function(_10){
if(this.isHijri()){
return il._getIslamicBundle()[_10];
}
if(this.isHebrew()){
return hl._getHebrewBundle()[_10];
}
return gl._getGregorianBundle()[_10];
}};
return _9;
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["ic-incontext"]=true;

;define("ic-incontext/util/DateFormat",["dojo","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/date/locale","dojo/has","dojo/string","ic-core/globalization/BidiDateUtil"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9=_8;
var _a=_2("com.ibm.social.incontext.util.DateFormat",null,{MILLS_IN_DAY:86400000,USE_MED_DATE_FOR_SHORT:{"pl":true},constructor:function(_b,_c){
this.dt=_b||new Date();
if(_c){
for(var _d in _c){
this[_d]=_c[_d];
}
}
this._transform=_4.hitch(this,this.substitute);
},nls:function(){
if(!this._nls){
throw "Resource bundle must be set to com.ibm.social.incontext.util.DateFormat.prototype._nls prior to use";
}
return this._nls;
},substitute:function(_e,_f){
_e=this[_f];
if(typeof _e=="function"){
_e=_e.apply(this,[]);
}
if(typeof _e=="undefined"||_e===null){
_e="${"+_f+"}";
}
return _e;
},toTimestamp:function(){
return this.format(this.nls().DATE.FULL);
},format:function(s){
return _7.substitute(s,null,this._transform);
},formatByAge:function(_10){
_10=_10||this.nls().DATE.RELATIVE_TIME;
var _11=this.delta();
if(_11<7&&_11>=-1){
if(_11>=2){
return this.format(_10.DAY);
}else{
if(_11==1){
return this.format(_10.YESTERDAY);
}else{
if(_11===0){
return this.format(_10.TODAY);
}else{
if(_11==-1&&_10.TOMORROW){
return this.format(_10.TOMORROW);
}
}
}
}
}else{
if(new Date().getFullYear()==this.dt.getFullYear()){
return this.format(_10.MONTH);
}
}
return this.format(_10.YEAR);
},formatByAgeToHtml:function(_12,d){
var _13=this.formatByAge(_12);
var _14=d.createElement("SPAN");
_14.appendChild(d.createTextNode(_13?_13:this.dt.toString()));
_14.title=(_12&&_12.FULL)?this.format(_12.FULL):this.format(this.nls().DATE.RELATIVE_TIME.FULL);
return _14;
},delta:function(){
if(typeof this._delta!="undefined"){
return this._delta;
}
this._delta=_a.delta(this.dt,new Date());
return this._delta;
},getDays:function(){
if(!this._days){
_a.prototype._days=_5.getNames("days","wide");
}
return this._days;
},getDaysAbbr:function(){
if(!this._daysAbbr){
_a.prototype._daysAbbr=_5.getNames("days","abbr");
}
return this._daysAbbr;
},getMonths:function(){
if(!this._months){
_a.prototype._months=_5.getNames("months","abbr");
}
if(_9.isGregorian()){
return this._months;
}else{
return _9.getDateComponent("months","abbr");
}
},getMonthsWide:function(){
if(!this._monthsWide){
_a.prototype._monthsWide=_5.getNames("months","wide");
}
if(_9.isGregorian()){
return this._monthsWide;
}else{
return _9.getDateComponent("months","wide");
}
},getMonthsShort:function(){
if(!this._monthsShort){
_a.prototype._monthsShort=this.nls().DATE.MONTHS_ABBR;
}
if(_9.isGregorian()){
return this._monthsShort;
}else{
return _9.getDateComponent("months","abbr");
}
},Z:function(){
if(!this._Z){
var _15="-";
var _16=this.dt.getTimezoneOffset();
if(_16<0){
_16=Math.abs(_16);
_15="+";
}
var _17=Math.floor(_16/60);
_16%=60;
if(_17<10){
_17="0"+_17;
}
if(_16<10){
_16="0"+_16;
}
_15+=_17+""+_16;
this._Z=_15;
}
return this._Z;
},ZZZZ_REGEX:/\(([^\)]+)\)/,ZZZZ:function(){
if(!this._ZZ){
if(_6("ie")){
var _18=this.dt.toString().split(" ");
this._ZZ=(_18.length>2)?_18[_18.length-2]:this.Z();
}else{
var r=this.ZZZZ_REGEX.exec(this.dt.toString());
this._ZZ=r?r[1]:this.Z();
}
}
return this._ZZ;
},YYYY:function(){
if(_9.isGregorian()){
return this.dt.getFullYear();
}else{
return _9.fromGregorian(this.dt).getFullYear();
}
},EEE:function(_19){
var day=this.dt.getDay();
if(_19>0){
day=(day+7-_19)%7;
}
return this.getDaysAbbr()[day];
},EEEE:function(_1a){
var day=this.dt.getDay();
if(_1a>0){
day=(day+7-_1a)%7;
}
return this.getDays()[day];
},EEee:function(_1b){
var _1c=this.delta()+(_1b?_1b:0);
return (_1c===0)?this.nls().DATE.TODAY_U:(_1c==1)?this.nls().DATE.YESTERDAY_U:this.EEEE(_1b);
},eeEE:function(_1d){
var _1e=this.delta()+(_1d?_1d:0);
return (_1e===0)?this.nls().DATE.TODAY:(_1e==1)?this.nls().DATE.YESTERDAY:this.EEEE(_1d);
},MMMM:function(){
if(_9.isGregorian()){
return this.getMonthsWide()[this.dt.getMonth()];
}else{
return this.getMonthsWide()[_9.fromGregorian(this.dt).getMonth()];
}
},MMM:function(){
if(_9.isGregorian()){
return this.getMonths()[this.dt.getMonth()];
}else{
return this.getMonths()[_9.fromGregorian(this.dt).getMonth()];
}
},MM:function(){
if(_9.isGregorian()){
var i=this.dt.getMonth()+1;
}else{
var i=_9.fromGregorian(this.dt).getMonth()+1;
}
return (i>9)?i:("0"+i);
},Mmm:function(){
if(_9.isGregorian()){
return this.dt.getMonthsShort()[this.dt.getMonth()];
}else{
return this.getMonthsShort()[_9.fromGregorian(this.dt).getMonth()];
}
},d:function(){
if(_9.isGregorian()){
return this.dt.getDate();
}else{
return _9.fromGregorian(this.dt).getDate();
}
},dd:function(){
if(_9.isGregorian()){
var i=this.dt.getDate();
}else{
var i=_9.fromGregorian(this.dt).getDate();
}
return (i>9)?i:("0"+i);
},a:function(){
return this.dt.getHours()<12?this.nls().DATE.AM:this.nls().DATE.PM;
},HH:function(){
var i=this.dt.getHours();
return (i>9)?i:("0"+i);
},h:function(){
var _1f=this.dt.getHours();
if(_1f>12){
_1f-=12;
}else{
if(_1f===0){
_1f=12;
}
}
return _1f;
},hh:function(){
var _20=this.h();
return (_20>9)?_20:("0"+_20);
},mm:function(){
var _21=this.dt.getMinutes();
return (_21<10)?"0"+_21:_21;
},ss:function(){
var _22=this.dt.getSeconds();
return (_22<10)?"0"+_22:_22;
},date:function(){
if(_9.isGregorian()){
return _5.format(this.dt,{selector:"date",formatLength:"short",locale:djConfig.locale});
}else{
return _9.formatBidiDate(this.dt,{selector:"date",formatLength:"short",locale:djConfig.locale});
}
},date_long:function(){
if(_9.isGregorian()){
return _5.format(this.dt,{selector:"date",formatLength:"long",locale:djConfig.locale});
}else{
return _9.formatBidiDate(this.dt,{selector:"date",formatLength:"long",locale:djConfig.locale});
}
},date_short:function(){
if(_9.isGregorian()){
return _5.format(this.dt,{selector:"date",formatLength:this.USE_MED_DATE_FOR_SHORT[_3.locale]?"medium":"short",locale:_1.locale});
}else{
return _9.formatBidiDate(this.dt,{selector:"date",formatLength:this.USE_MED_DATE_FOR_SHORT[_3.locale]?"medium":"short",locale:_1.locale});
}
},time:function(){
return _5.format(this.dt,{selector:"time",formatLength:"short",locale:djConfig.locale});
},time_long:function(){
return _5.format(this.dt,{selector:"time",formatLength:"long",locale:djConfig.locale});
}});
_a.delta=function(_23,to){
var _24=_23.getTime();
var _25=new Date(to.getTime());
_25.setHours(0);
_25.setMinutes(0);
_25.setSeconds(0);
_25.setMilliseconds(0);
var _26=_25.getTime()-_24;
var _27=Math.ceil(_26/(com.ibm.social.incontext.util.DateFormat.prototype.MILLS_IN_DAY));
return _27;
};
return _a;
});


;define("ic-incontext/util/date",["dojo","dojo/_base/declare","dojo/_base/kernel","dojo/date/locale","dojo/has","dojo/string","ic-core/globalization/BidiDateUtil","./DateFormat"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9={REPLACE:/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,MILLS_IN_DAY:86400000,toTimestamp:function(_a,_b){
return _a.format(_a,_b.FULL,_b);
},formatByAge:function(_c,_d,_e){
var _f=new Date();
var qud=_9;
var _10=qud.delta(_c,_f);
if(_10<7&&_10>=-1){
if(_10>=2){
return qud.format(_c,_d.DAY,_e);
}else{
if(_10==1){
return qud.format(_c,_d.YESTERDAY,_e);
}else{
if(_10===0){
return qud.format(_c,_d.TODAY,_e);
}else{
if(_10==-1&&_d.TOMORROW){
return qud.format(_c,_d.TOMORROW,_e);
}
}
}
}
}else{
if(_f.getFullYear()==_c.getFullYear()){
return qud.format(_c,_d.MONTH,_e);
}
}
return qud.format(_c,_d.YEAR,_e);
},format:function(_11,_12,nls){
var qud=_9;
var re=qud.REPLACE;
re.lastIndex=0;
var _13=_12.replace(re,function(_14,key,_15){
var f=qud[key];
var s=f?f(_11,nls):"${"+key+"}";
return s;
});
return _13;
},delta:function(_16,nls){
return _8.delta(_16,new Date());
},getDays:function(){
var qud=_9;
if(!qud._days){
qud._days=_4.getNames("days","wide");
}
return qud._days;
},getDaysAbbr:function(){
var qud=_9;
if(!qud._daysAbbr){
qud._daysAbbr=_4.getNames("days","abbr");
}
return qud._daysAbbr;
},getMonths:function(){
var qud=_9;
if(!qud._months){
qud._months=_4.getNames("months","abbr");
}
if(_7.isGregorian()){
return qud._months;
}else{
return _7.getDateComponent("months","abbr");
}
},getMonthsWide:function(){
var qud=_9;
if(!qud._monthsWide){
qud._monthsWide=_4.getNames("months","wide");
}
if(_7.isGregorian()){
return qud._monthsWide;
}else{
return _7.getDateComponent("months","wide");
}
},Z:function(_17,nls){
var _18="-";
var _19=_17.getTimezoneOffset();
if(_19<0){
_19=Math.abs(_19);
_18="+";
}
var _1a=Math.floor(_19/60);
_19%=60;
if(_1a<10){
_1a="0"+_1a;
}
if(_19<10){
_19="0"+_19;
}
_18+=_1a+""+_19;
return _18;
},ZZZZ_REGEX:/\(([^\)]+)\)/,ZZZZ:function(_1b,nls){
var _1c;
var qud=_9;
if(_5("ie")){
var _1d=_1b.toString().split(" ");
_1c=(_1d.length>2)?_1d[_1d.length-2]:qud.Z(_1b,nls);
}else{
var re=qud.ZZZZ_REGEX;
re.lastIndex=0;
var r=re.exec(_1b.toString());
_1c=r?r[1]:qud.Z(_1b,nls);
}
return _1c;
},YYYY:function(_1e,nls){
if(_7.isGregorian()){
return _1e.getFullYear();
}else{
return _7.fromGregorian(_1e).getFullYear();
}
},EEE:function(_1f,nls,_20){
var day=_9.dt.getDay();
if(_20>0){
day=(day+7-_20)%7;
}
return _9.getDaysAbbr()[day];
},EEEE:function(_21,nls,_22){
var day=_21.getDay();
if(_22>0){
day=(day+7-_22)%7;
}
return _9.getDays()[day];
},EEee:function(_23,nls,_24){
var _25=_23.delta(_23)+(_24?_24:0);
return (_25===0)?nls.TODAY_U:(_25==1)?nls.YESTERDAY_U:_9.EEEE(_23,nls,_24);
},eeEE:function(_26,nls,_27){
var _28=_26.delta(_26)+(_27?_27:0);
return (_28===0)?nls.TODAY:(_28==1)?nls.YESTERDAY:_9.EEEE(_26,nls,_27);
},MMMM:function(_29,nls){
if(_7.isGregorian()){
return _9.getMonthsWide()[_29.getMonth()];
}else{
return _9.getMonthsWide()[_7.fromGregorian(_29).getMonth()];
}
},MMM:function(_2a,nls){
if(_7.isGregorian()){
return _9.getMonths()[_2a.getMonth()];
}else{
return _9.getMonths()[_7.fromGregorian(_2a).getMonth()];
}
},MM:function(_2b,nls){
if(_7.isGregorian()){
var i=_2b.getMonth()+1;
}else{
var i=_7.fromGregorian(_2b).getMonth()+1;
}
return (i>9)?i:("0"+i);
},Mmm:function(_2c,nls){
if(_7.isGregorian()){
return nls.MONTHS_ABBR[_2c.getMonth()];
}else{
return _9.getMonths()[_7.fromGregorian(_2c).getMonth()];
}
},d:function(_2d,nls){
if(_7.isGregorian()){
return _2d.getDate();
}else{
return _7.fromGregorian(_2d).getDate();
}
},dd:function(_2e,nls){
if(_7.isGregorian()){
var i=_9.getDate();
}else{
var i=_7.fromGregorian(_2e).getDate();
}
return (i>9)?i:("0"+i);
},a:function(_2f,nls){
return _2f.getHours()<12?nls.AM:nls.PM;
},HH:function(_30,nls){
var i=_30.getHours();
return (i>9)?i:("0"+i);
},h:function(_31,nls){
var _32=_31.getHours();
if(_32>12){
_32-=12;
}else{
if(_32===0){
_32=12;
}
}
return _32;
},hh:function(_33,nls){
var _34=_9.h(_33,nls);
return (_34>9)?_34:("0"+_34);
},mm:function(_35,nls){
var _36=_35.getMinutes();
return (_36<10)?"0"+_36:_36;
},ss:function(_37,nls){
var _38=_37.getSeconds();
return (_38<10)?"0"+_38:_38;
},date:function(_39,nls){
if(_7.isGregorian()){
return _4.format(_39,{selector:"date",formatLength:"short",locale:djConfig.locale});
}else{
return _7.formatBidiDate(_39,{selector:"date",formatLength:"short",locale:djConfig.locale});
}
},date_short:function(_3a,nls){
if(_7.isGregorian()){
return _4.format(_3a,{selector:"date",formatLength:_8.prototype.USE_MED_DATE_FOR_SHORT[djConfig.locale]?"medium":"short",locale:djConfig.locale});
}else{
return _7.formatBidiDate(_3a,{selector:"date",formatLength:_8.prototype.USE_MED_DATE_FOR_SHORT[djConfig.locale]?"medium":"short",locale:djConfig.locale});
}
},date_long:function(_3b,nls){
if(_7.isGregorian()){
return _4.format(_3b,{selector:"date",formatLength:"long",locale:djConfig.locale});
}else{
return _7.formatBidiDate(_3b,{selector:"date",formatLength:"long",locale:djConfig.locale});
}
},time:function(_3c,nls){
return _4.format(_3c,{selector:"time",formatLength:"short",locale:djConfig.locale});
},time_long:function(_3d,nls){
return _4.format(_3d,{selector:"time",formatLength:"long",locale:djConfig.locale});
}};
return _9;
});


;define("ic-core/ext/timeago/Timeago",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dojo/i18n!./nls/Timeago","dijit/_Templated","dijit/_Widget","dijit/registry","ic-incontext/util/date"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
var _a=_2("lconn.core.ext.timeago.Timeago",_7,{settings:{refreshMillis:60000,secRefreshMillis:5000,allowFuture:false,strings:{}},dayInMillis:24*60*60*1000,interval:null,postCreate:function(){
this.settings.strings=_5;
this.refresh();
if(this.timeout&&this.id&&_8){
this.interval=setInterval(_3.hitch(this,function(){
var _b=_8.byId(this.id);
if(_b){
_b.refresh();
}
}),this.timeout);
}else{
clearInterval(this.interval);
}
},inWords:function(_c){
var $l=this.settings.strings;
var _d=$l.prefixAgo;
var _e=$l.timeAgo;
if(this.settings.allowFuture){
if(_c<0){
_d=$l.prefixFromNow;
_e=$l.suffixFromNow;
}
_c=Math.abs(_c);
}else{
if(_c<0){
_c=1;
}
}
var _f=_c/1000;
var _10=_f/60;
var _11=_10/60;
var _12=_11/24;
var _13=_12/365;
function _14(_15,_16){
var _17=_3.isFunction(_15)?_15(_16,_c):_15;
var _18=($l.numbers&&$l.numbers[_16])||_16;
return _17.replace(/%d/i,_18);
};
var _19=_f<45&&$l.now||_10<60&&_14($l.minutes,Math.round(_10))||_11<24&&_14($l.hours,Math.round(_11))||_11<48&&_14($l.day,1)||_12<30&&_14($l.days,Math.floor(_12))||_12<60&&_14($l.month,1)||_12<365&&_14($l.months,Math.floor(_12/30))||_13<2&&_14($l.year,1)||_14($l.years,Math.floor(_13));
return _f<45?_19:_14(_e,_19);
},parse:function(_1a){
if(!_1a){
return new Date();
}
var s=_3.trim(_1a);
s=s.replace(/\.\d\d\d+/,"");
s=s.replace(/-/,"/").replace(/-/,"/");
s=s.replace(/T/," ").replace(/Z/," UTC");
s=s.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");
return new Date(s);
},datetime:function(){
var _1b=this.domNode.tagName.toLowerCase()==="time";
var _1c=_1b?_4.get(this.domNode,"datetime"):_4.get(this.domNode,"title");
return this.parse(_1c);
},refresh:function(){
var _1d=this.prepareData();
if(!isNaN(_1d.datetime)){
var _1e=this.distance(_1d.datetime);
if(_1e<this.dayInMillis){
this.domNode.innerHTML=this.inWords(this.distance(_1d.datetime));
}else{
var _1f=this.settings.strings;
this.domNode.innerHTML=_9.formatByAge(_1d.datetime,{DAY:_1f.timeDay,MONTH:_1f.timeMonth,YEAR:_1f.timeYear,YESTERDAY:_1f.timeYesterday},{AM:"AM",PM:"PM"});
}
}
if(this.distance(_1d.datetime)<45000){
this.timeout=this.settings.secRefreshMillis;
}else{
if(this.timeout==this.settings.secRefreshMillis){
this.timeout=this.settings.refreshMillis;
clearInterval(this.interval);
this.interval=setInterval(_3.hitch(this,function(){
var _20=_8.byId(this.id);
if(_20){
_20.refresh();
}
}),this.timeout);
}else{
this.timeout=this.settings.refreshMillis;
}
}
return;
},prepareData:function(){
if(!this.timeago){
this.timeago={datetime:this.datetime()};
var _21=_9.format(this.timeago.datetime,this.settings.strings.timeHover,this.settings.strings.AMPM);
if(_21.length>0){
_4.set(this.domNode,"title",_21);
}
}
return this.timeago;
},distance:function(_22){
return (new Date().getTime()-_22.getTime());
},dayDelta:function(_23){
}});
return _a;
});


;define("dojo/i18n!ic-incontext/nls/socialInContextCoreStrings", {"COMMUNITYSEARCH":{"NO_RESULTS":"No results for \'${0}\'","SHARE_LINK":"Share with a community...","SOURCE":"a Community","HINT_TEXT":"Type community name"},"USERSEARCH":{"SEARCH_USERS_BUTTON":"Search","PERSON_SOURCE":"a Person","GROUP_HINT_TEXT":"Group name...","USER_EMAIL":"E-mail","INACTIVE":"(inactive)","ERROR_LINK":"Search for People","TITLE_BLURB":"Need to find someone\'s files?  Enter their name or e-mail address in the search field, below.  As you type, we\'ll show you a list of possible matches. If you can\'t find the person you are searching for in the list, just click the Search button to see a list of all the possible matches in the directory.","NO_MATCHES":"No matches","SEARCH_DIRECTORY":"Person not listed? Use full search...","NO_RESULTS":"No results for \'${0}\'","TITLE":"Search Results","QUERY_TOO_SHORT":"Enter a longer search query to view results","PERSON_HINT_TEXT":"Person name or email...","GROUP_SOURCE":"a Group","LOADING":"Loading...","USER_NAME":"Name"},"VIDEO_PREVIEW":{"ARIA_VIDEO_DOWNLOAD":"Your video may take a few minutes to download","ARIA_NO_DESCRIPTION":"No description available ","FLASH_VIDEO_ERROR":"Failed to play flash video, this may be due to an flash been disabled, you can download the video directly through the icon below","VIDEO_LOADING":"The video is loading...","ARIA_VIDEO_PREVIEW":"Video Preview {0}","ARIA_VIDEO_TITLE":"Play ${0}","HTML5_VIDEO_ERROR":"Failed to play html5 video, this may be due to an unsupported browser, you can download the video directly through the icon below"},"COMMUNITYSELECTOR":{"TITLE":"Community:","REMOVE_LINK":"Remove ${0}"},"GENERAL":{"LOADING":"Loading..."},"DIALOG":{"CANCEL":"Cancel","OK":"OK","CHANGED_CLOSE_MESSAGE":"Are you sure you want to abandon your changes? Press OK to continue or Cancel to return","CHANGED_CLOSE_TITLE":"Confirm"}});

;define("dojox/html/entities",["dojo/_base/lang"],function(_1){
var _2=_1.getObject("dojox.html.entities",true);
var _3=function(_4,_5){
var _6,_7;
if(_5._encCache&&_5._encCache.regexp&&_5._encCache.mapper&&_5.length==_5._encCache.length){
_6=_5._encCache.mapper;
_7=_5._encCache.regexp;
}else{
_6={};
_7=["["];
var i;
for(i=0;i<_5.length;i++){
_6[_5[i][0]]="&"+_5[i][1]+";";
_7.push(_5[i][0]);
}
_7.push("]");
_7=new RegExp(_7.join(""),"g");
_5._encCache={mapper:_6,regexp:_7,length:_5.length};
}
_4=_4.replace(_7,function(c){
return _6[c];
});
return _4;
};
var _8=function(_9,_a){
var _b,_c;
if(_a._decCache&&_a._decCache.regexp&&_a._decCache.mapper&&_a.length==_a._decCache.length){
_b=_a._decCache.mapper;
_c=_a._decCache.regexp;
}else{
_b={};
_c=["("];
var i;
for(i=0;i<_a.length;i++){
var e="&"+_a[i][1]+";";
if(i){
_c.push("|");
}
_b[e]=_a[i][0];
_c.push(e);
}
_c.push(")");
_c=new RegExp(_c.join(""),"g");
_a._decCache={mapper:_b,regexp:_c,length:_a.length};
}
_9=_9.replace(_c,function(c){
return _b[c];
});
return _9;
};
_2.html=[["&","amp"],["\"","quot"],["<","lt"],[">","gt"],["\xa0","nbsp"]];
_2.latin=[["\xa1","iexcl"],["\xa2","cent"],["\xa3","pound"],["\u20ac","euro"],["\xa4","curren"],["\xa5","yen"],["\xa6","brvbar"],["\xa7","sect"],["\xa8","uml"],["\xa9","copy"],["\xaa","ordf"],["\xab","laquo"],["\xac","not"],["\xad","shy"],["\xae","reg"],["\xaf","macr"],["\xb0","deg"],["\xb1","plusmn"],["\xb2","sup2"],["\xb3","sup3"],["\xb4","acute"],["\xb5","micro"],["\xb6","para"],["\xb7","middot"],["\xb8","cedil"],["\xb9","sup1"],["\xba","ordm"],["\xbb","raquo"],["\xbc","frac14"],["\xbd","frac12"],["\xbe","frac34"],["\xbf","iquest"],["\xc0","Agrave"],["\xc1","Aacute"],["\xc2","Acirc"],["\xc3","Atilde"],["\xc4","Auml"],["\xc5","Aring"],["\xc6","AElig"],["\xc7","Ccedil"],["\xc8","Egrave"],["\xc9","Eacute"],["\xca","Ecirc"],["\xcb","Euml"],["\xcc","Igrave"],["\xcd","Iacute"],["\xce","Icirc"],["\xcf","Iuml"],["\xd0","ETH"],["\xd1","Ntilde"],["\xd2","Ograve"],["\xd3","Oacute"],["\xd4","Ocirc"],["\xd5","Otilde"],["\xd6","Ouml"],["\xd7","times"],["\xd8","Oslash"],["\xd9","Ugrave"],["\xda","Uacute"],["\xdb","Ucirc"],["\xdc","Uuml"],["\xdd","Yacute"],["\xde","THORN"],["\xdf","szlig"],["\xe0","agrave"],["\xe1","aacute"],["\xe2","acirc"],["\xe3","atilde"],["\xe4","auml"],["\xe5","aring"],["\xe6","aelig"],["\xe7","ccedil"],["\xe8","egrave"],["\xe9","eacute"],["\xea","ecirc"],["\xeb","euml"],["\xec","igrave"],["\xed","iacute"],["\xee","icirc"],["\xef","iuml"],["\xf0","eth"],["\xf1","ntilde"],["\xf2","ograve"],["\xf3","oacute"],["\xf4","ocirc"],["\xf5","otilde"],["\xf6","ouml"],["\xf7","divide"],["\xf8","oslash"],["\xf9","ugrave"],["\xfa","uacute"],["\xfb","ucirc"],["\xfc","uuml"],["\xfd","yacute"],["\xfe","thorn"],["\xff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];
_2.encode=function(_d,m){
if(_d){
if(!m){
_d=_3(_d,_2.html);
_d=_3(_d,_2.latin);
}else{
_d=_3(_d,m);
}
}
return _d;
};
_2.decode=function(_e,m){
if(_e){
if(!m){
_e=_8(_e,_2.html);
_e=_8(_e,_2.latin);
}else{
_e=_8(_e,m);
}
}
return _e;
};
return _2;
});


;define("dojo/i18n!ic-core/nls/strings", {"rs_mobileBanner_title":"IBM Connections","rs_forumSettingCancel":"Cancel","rs_actUpdatedByDate":"Updated by ${0} ${1}","rs_copyTemplateMembers":"Use members from template","rs_personColon":"Person: ","rs_forumMessages":"${0} messages","rs_messagebox_close_btn_title":"Close","rs_startActivity":"Start an Activity","rs_jumpPage":"Jump to page ${0} of ${1}","rs_PersonExternal":"${0} (External User)","rs_tagDialogCloseTile":"Close","rs_shared":"Shared","rs_vmcancel":"Cancel","rs_tuneOut":"Mark as Tuned Out","rs_normalTemplate":"Mark as normal template","rs_docpicker_viewdetails_text":"View Details","rs_widgets_loading_error_title":"Unable to display the widget(s) in this community","rs_clearAll":"Clear all","rs_notificationConfirm":"The notification message was sent successfully. ","rs_group_browse_previous_page":"Previous Page","rs_advanced":"Advanced","rs_startFirstTopic":"Start the First Topic","rs_markComplete":"Mark Complete","rs_activityFormGoal":"Activity Goal","rs_externalLabel":"External","rs_typeToFilter":"Type to filter this list","rs_group_browse_groups":"Browse Groups","rs_vmsave":"Save","rs_favoriteTemplate":"Mark as Favorite Template","rs_viewAsCloudTitle":"List tags as a tag cloud","rs_prioritize":"Prioritize","rs_hide":"Hide","rs_deleteEntry":"Delete","rs_searchCommunityDirectory":"Community not listed? Use full search...","rs_customLangaugeLinkLabel":"Custom Language","rs_widget_loading_error_message":"Try again later and contact your system administrator if the problem persists.","rs_shadowText_searchDirectory":"Type to find person","rs_tagCloudViewAllTitle":"Browse all tags","rs_notifyColon":"Notify: ","rs_ok":"OK","rs_peopleLabel":"People","rs_forumTopics":"${0} topics","rs_group_browse_enter_string":"Type to find groups","rs_shadowText_searchPersonAndGroupDirectory":"Type to find person or group","rs_template":"Template","rs_viewAll":"View All","rs_vminvite":"Invite","rs_forumSettingNote":"Note: Topics display by default if there is only one forum.","rs_vmradioTwo":"Automatically add users to community","rs_tagCloudRelatedTagsDescription":"Add a related tag to further refine your search","rs_externalText":"This activity can have members from outside your organization.","rs_messageColon":"Message: ","rs_vmradioOne":"Send invitations to join the community","rs_topics":"topics","rs_activityWidgetTitle":"Activities","rs_notificationFail":"The notification message was not sent. Try again later and contact your system administrator if the problem persists.","rs_widget_misplacement_warning":"This app does not fit in this column. A community owner can move it to another column or remove it from the page.","rs_widget_title_change_title":"Change Title","rs_linkLess":"... [less]","rs_vmmessage":"Message:","rs_messagebox_info_icon_alt":"Information","rs_vmaddUser":"Create User","rs_medPri":"Medium Priority","rs_tagDialogPageInfo":"${0} - ${1} of ${2} tags","rs_vmgroupTypeAheadRoleLabel":" as Members ","rs_yesterday":"Yesterday","rs_forumSettingCommunityOverviewPage":"Community overview page:","rs_tagCloudNavigationLabel":"Tags","rs_group_name":"Group Name","rs_replies":"replies","rs_member_add_to_community":"Click to add member","rs_messagebox_warning_a11y_label":"Warning:","rs_listItem":"List item","rs_vmmainContentDesc":"Invite members to give them the opportunity to join in the community. Add members to automatically include them.","rs_widget_loading_error_title":"Unable to display the widget","rs_typeName":"Type in a Name","rs_activityFeedLink":"Feed for these activities","rs_pageLabel":"Page:","rs_forumSettingApplicationView":"Forum application default view:","rs_group_remove_name":"Click to remove group","rs_vmmainContentTitle":"Invite or Add Members","rs_activityWidgetBriefDescription":"Track community goals.  Create to-dos and share resources.","rs_group_browse_parent_group_label":"You are in:","rs_tagLoadingTags":"Loading Content","rs_vmradioSectionTitle":"Member Options:","rs_vmtwistyA":"Add an Optional Message","rs_vmtwistyB":"Remove additional text","rs_loading":"Loading...","rs_forumOpenQuestions":"Open Questions","rs_removeTagTitle":"Remove the tag ${0} from the selected filter tags","rs_vmtypeAheadLabel":"Name or Email: ","rs_edit":"Edit","rs_startFromTemplate":"Start Activity from this Template","rs_createPersonLink":"Create Person Link","rs_searchPersonAndGroupDirectory":"Person or group not listed? Use full search...","rs_notifyOthers":"Notify other people","rs_hideInfo":"Hide extra information","rs_vmgroupTypeAheadLabel":"Name: ","rs_inactivePerson":"${0} (inactive)","rs_messagebox_info_a11y_label":"Information:","rs_sharefile_invalid_request":"An error occurred while sharing the selected files.","rs_search":"Search","rs_pagepos":"${0} - ${1} of ${2}","rs_group_browse_remove_selection":"Remove nested group selection: ${0}","rs_tagCloudHelpAlt":"Get help with tags","rs_PersonExternalLabel":"External User","rs_tagCloudSeach":"Search","rs_mobileBanner_author":"IBM Collaboration Solutions","rs_sharefile_error_title":"Error","rs_labelColon":"Label: ","rs_widget_title_change_label":"Title:  ","rs_member_remove_group":"Remove ${0}","rs_member_groups":"Groups","rs_vmcheckboxLabel":"Send me a copy","rs_vmtextAreaStartText":"Say something...","rs_addTagTitle":"Filter by the tag ${0} with count ${1}","rs_messagebox_close_btn_alt":"Close","rs_forumSettingSubmit":"Submit","rs_highPri":"High Priority","rs_forumSortByTopicsAndReplies":"Topics and Replies","rs_personLink":"Person Link","rs_topic":"topic","rs_searchGroupDirectory":"Group not listed? Use full search...","rs_docpicker_download_title":"Download ${0}","rs_all_connections":"All Connections","rs_viewAsCloud":"Cloud","rs_mobileBanner_inGooglePlay":"In Google Play","rs_markIncomplete":"Restore","rs_errorPersists":"If the problem persists, contact your system administrator.","rs_noActivities":"There are no activities started for this community.","rs_tagCloudNoTags":"No tags yet","rs_tagsLabel":"Tags","rs_moreInfo":"Show more information about this Activity","rs_forumSortByDate":"Date","rs_noTopicsLoggedIn":"Ask a question, brainstorm, or simply share your ideas.","rs_a11y_warning":"Warning:","rs_mobileBanner_hide":"Hide","rs_forumSortByTopic":"Topics","rs_messagebox_error_icon_alt":"Error","rs_mobileBanner_inAppStore":"On the App Store","rs_member_remove_name":"Click to remove member","rs_tunedOutPri":"Tuned Out","rs_completedActivityLink":"Show completed Activities","rs_forumSortBy":"Sort by:","rs_noTemplate":"None","rs_viewAsCloudDescription":"Viewing tags as a tag cloud","rs_group_browse_cancel_button":"Cancel","rs_group_browse_paging":"Paging","rs_tagCloudRelatedTags":"Related Tags","rs_relatedTagTitle":"Add the tag ${0} with count ${1}","rs_member_members":"Members","rs_postedBy":"Latest post by","rs_browser_setting":"Browser Setting","rs_group_browse_group_typeahead_label":"Type a group name:","rs_messagebox_success_a11y_label":"Success:","rs_viewAsListDescription":"Viewing tags as a sequential list of tags","rs_forumSettingSave":"Save","rs_PersonPicture":"${0}\'s Picture","rs_numResults":"Showing ${0} results of ${1}","rs_removeFilter":"Remove","rs_defaultForumList":"Show forum list by default","rs_normalTags":"Active Tags","rs_docpicker_viewdetails_title":"View details of ${0}","rs_messagebox_error_a11y_label":"Error:","rs_group_browse_next_page":"Next Page","rs_viewAsListTitle":"List tags as a sequential list of tags","rs_group_browse_page_info":"${0} - ${1} of ${2}","rs_vmtaNoResults":"No Results found.","rs_noResults":"No Results found","rs_close":"Close","rs_empty_column_placeholder":"Drag app(s) here.","rs_noTopics":"There are no topics yet for this community.","rs_feedError":"Failed to load feed.","rs_tagCloudError":"There was an error","rs_select_scope":"Select search scope","rs_restore":"Restore","rs_more":"More","rs_docpicker_title":"Insert Link to Files","rs_actTagsDelim":", ","rs_activitiesUnavailable":"The Activities service is unavailable.","rs_feedOpenQuestions":"Feed for these open questions","rs_icfixlayout":{"dialog_title":"Reformat Contents","reformat_save":"Reformat and Save","warn_layout":"Your content exceeds the maximum display width.  Do you want to reformat automatically to fit the available space?","save_as_is":"Save as Is","button_label":"Reformat","cancel":"Cancel","warning":"Warning","remember_decision":"Remember my decision"},"rs_startTopic":"Start a Topic","rs_tagCloudSeachDesc":"Find a Tag","rs_linkMore":"... [more]","rs_manageForumSetting":"Manage Forum Settings","rs_replace":"Replace","rs_templateOptions":"Template options","rs_locked":"[Locked]","rs_attachedfile_filename":"Image ${0}","rs_forumSettingSaveAndClose":"Save and Close","rs_forumSettingConfirm":"Your changes for Forums have been saved.","rs_forumSettingError":"An error occurred. Contact your administrator.","rs_tagCloudNoTagsProfiles":"Search the directory. Tags associated with the profiles returned by the search will be displayed here.","rs_shadowText_searchCommunityDirectory":"Type to find community","rs_group_browse_find_groups":"Find Groups","rs_moveActivitySuccess":"\"${activityTitle}\" was moved successfully to the \"${destCommName}\" subcommunity.","rs_sharefile_constraint_violation":"An error occurred while sharing the selected files.","rs_removeActFromComm":"Remove from community","rs_aboutThisTemplate":"About This Template","rs_forumLastAddedPost":"Latest post by ${0}","rs_tagCloudSelectedTags":"Selected Tags","rs_at":"at","rs_group_browse_results_label":"Select a matching group:","rs_group_role":"Group Role","rs_mobileBanner_open":"Open","rs_quote":"Quote","rs_userContentTitle":"Enter Information","rs_shadowText_searchGroupDirectory":"Type to find group","rs_sharefile_sharing_intent_restriction":"The file can only be shared inside your organization.","rs_navNextLabel":"Next","rs_messagebox_success_icon_alt":"Success","rs_sortByReplies":"Sort by Replies","rs_PersonPictureExternal":"${0}\'s Picture (External User)","rs_docpicker_label":"Link to Files","rs_actUpdatedBy":"Updated by ${0}","rs_tomorrow":"Tomorrow","rs_pickCommunity":"Pick from Community List","rs_group_browse_next":"Next","rs_activityWidgetDescription":"Community activities can be used to collaborate and track progress on community projects or initiatives.","rs_activity":"Activity","rs_tagCloudNoRecentTags":"No recent tags","rs_mobileBanner_view":"View","rs_startFirstActivity":"Create Your First Activity","rs_group_browse_group_name":"Group name:","rs_defaultTopicList":"Show topic list by default","rs_reply":"reply","rs_vmtypeAheadRoleLabel":" as ","rs_feedAnsweredQuestions":"Feed for these answered questions","rs_sharefile_access_denied":"This file was deleted or is no longer shared with you.","rs_filterListPrompt":"Type to filter this list","rs_group_add_to_community":"Click to add group","rs_tagCloudViewAll":"Browse","rs_noReplies":"No replies","rs_filterGroupLabel":"Select Group","rs_widget_title_change_direction":"Change the title for this ${0} app.","rs_formSettingHideMessage":"Hide this message","rs_jumpPageLabel":"Jump to page","rs_group_browse_group_no_groups":"This group does not contain any groups","rs_searchInputDefault":"Type to find a tag","rs_warning":"Warning","rs_forumUnAnsweredQuestion":"Unanswered question","rs_messagebox_warning_icon_alt":"Warning","rs_forumAnsweredQuestion":"Answered question","rs_searchDirectory":"Person not listed? Use full search...","rs_group_browse_add_button":"Add","rs_personExternalDesc":"This user has access to Files and Communities that are externally shared.","rs_searchInputTagSelected":"Type another tag","rs_widget_title_change_fail_message":{"default_message":"Unable to change title for this ${0} app.","title_too_long":"The title you entered is too long.","empty_new_title":"The title you entered cannot be empty."},"rs_viewAsList":"List","rs_tagDialogTitle":"All Tags","rs_noTopicsShort":"No topics","rs_member_no_results":"No results found","rs_actDue":"Due ${0}","rs_normalPri":"Normal Priority (Default)","rs_today":"Today","rs_sortbyTopicsAndReplies":"Sort by Topics and Replies","rs_actTags":"Tags: ","rs_group_browse_previous":"Previous","rs_vmtaHeader":"header","rs_forumSortByReplies":"Replies","rs_group_browse_page_info_alt":"Matching groups ${0} through ${1} of ${2}","rs_tagCloudToggleHint":"Click to hide or show","rs_copyActivityMembers":"Use members from activity","rs_navPrevLabel":"Previous","rs_vmback":"Back","rs_copyOf":"Copy of ${0}","rs_attachedfile_remove_alt":"Remove","rs_group_browse_group_selected":"Selected Group:","rs_group_browse_groups_dialog_title":"Browse Groups","rs_removeTag":"Remove the tag from the selected filter tags","rs_pageNumLabel":"Page Number","rs_feedreader_warning":"Warning: This link is meant for feed readers and may display incorrectly in your browser. Click OK to continue, or Cancel to return to page."});

;define("dojo/text!ic-ui/templates/DialogUtil.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="lotusDialogBorder">\n	<div class="lotusDialog" style="zoom: 1" role="dialog"\n		aria-labelledby="${titleID}" aria-describedby="${contentID}"\n		waistate="${titleID}">\n		<div class="lotusDialogHeader">\n			<h1 class="lotusHeading">\n				<span id="${titleID}" class="title"></span>\n			</h1>\n			<a class="lotusDialogClose" role="button" href="javascript:;"\n				title="${rs_close}"><img src="${blankGif}" alt="${rs_close}"\n				aria-label="${rs_close}" /><span class="lotusAltText">X</span>\n			</a>\n		</div>\n		<div id="${contentID}" class="lotusDialogContent" role="presentation"></div>\n		<div class="lotusDialogFooter" role="presentation">\n			<input type="button" class="lotusFormButton submit" /> <input\n				type="button" class="lotusFormButton cancel" />\n		</div>\n	</div>\n</div>\n');

;define("dojox/uuid/generateTimeBasedUuid",["dojo/_base/lang","./_base"],function(_1){
dojox.uuid.generateTimeBasedUuid=function(_2){
var _3=dojox.uuid.generateTimeBasedUuid._generator.generateUuidString(_2);
return _3;
};
dojox.uuid.generateTimeBasedUuid.isValidNode=function(_4){
var _5=16;
var _6=parseInt(_4,_5);
var _7=_1.isString(_4)&&_4.length==12&&isFinite(_6);
return _7;
};
dojox.uuid.generateTimeBasedUuid.setNode=function(_8){
dojox.uuid.assert((_8===null)||this.isValidNode(_8));
this._uniformNode=_8;
};
dojox.uuid.generateTimeBasedUuid.getNode=function(){
return this._uniformNode;
};
dojox.uuid.generateTimeBasedUuid._generator=new function(){
this.GREGORIAN_CHANGE_OFFSET_IN_HOURS=3394248;
var _9=null;
var _a=null;
var _b=null;
var _c=0;
var _d=null;
var _e=null;
var _f=16;
function _10(_11){
_11[2]+=_11[3]>>>16;
_11[3]&=65535;
_11[1]+=_11[2]>>>16;
_11[2]&=65535;
_11[0]+=_11[1]>>>16;
_11[1]&=65535;
dojox.uuid.assert((_11[0]>>>16)===0);
};
function _12(x){
var _13=new Array(0,0,0,0);
_13[3]=x%65536;
x-=_13[3];
x/=65536;
_13[2]=x%65536;
x-=_13[2];
x/=65536;
_13[1]=x%65536;
x-=_13[1];
x/=65536;
_13[0]=x;
return _13;
};
function _14(_15,_16){
dojox.uuid.assert(_1.isArray(_15));
dojox.uuid.assert(_1.isArray(_16));
dojox.uuid.assert(_15.length==4);
dojox.uuid.assert(_16.length==4);
var _17=new Array(0,0,0,0);
_17[3]=_15[3]+_16[3];
_17[2]=_15[2]+_16[2];
_17[1]=_15[1]+_16[1];
_17[0]=_15[0]+_16[0];
_10(_17);
return _17;
};
function _18(_19,_1a){
dojox.uuid.assert(_1.isArray(_19));
dojox.uuid.assert(_1.isArray(_1a));
dojox.uuid.assert(_19.length==4);
dojox.uuid.assert(_1a.length==4);
var _1b=false;
if(_19[0]*_1a[0]!==0){
_1b=true;
}
if(_19[0]*_1a[1]!==0){
_1b=true;
}
if(_19[0]*_1a[2]!==0){
_1b=true;
}
if(_19[1]*_1a[0]!==0){
_1b=true;
}
if(_19[1]*_1a[1]!==0){
_1b=true;
}
if(_19[2]*_1a[0]!==0){
_1b=true;
}
dojox.uuid.assert(!_1b);
var _1c=new Array(0,0,0,0);
_1c[0]+=_19[0]*_1a[3];
_10(_1c);
_1c[0]+=_19[1]*_1a[2];
_10(_1c);
_1c[0]+=_19[2]*_1a[1];
_10(_1c);
_1c[0]+=_19[3]*_1a[0];
_10(_1c);
_1c[1]+=_19[1]*_1a[3];
_10(_1c);
_1c[1]+=_19[2]*_1a[2];
_10(_1c);
_1c[1]+=_19[3]*_1a[1];
_10(_1c);
_1c[2]+=_19[2]*_1a[3];
_10(_1c);
_1c[2]+=_19[3]*_1a[2];
_10(_1c);
_1c[3]+=_19[3]*_1a[3];
_10(_1c);
return _1c;
};
function _1d(_1e,_1f){
while(_1e.length<_1f){
_1e="0"+_1e;
}
return _1e;
};
function _20(){
var _21=Math.floor((Math.random()%1)*Math.pow(2,32));
var _22=_21.toString(_f);
while(_22.length<8){
_22="0"+_22;
}
return _22;
};
this.generateUuidString=function(_23){
if(_23){
dojox.uuid.assert(dojox.uuid.generateTimeBasedUuid.isValidNode(_23));
}else{
if(dojox.uuid.generateTimeBasedUuid._uniformNode){
_23=dojox.uuid.generateTimeBasedUuid._uniformNode;
}else{
if(!_9){
var _24=32768;
var _25=Math.floor((Math.random()%1)*Math.pow(2,15));
var _26=(_24|_25).toString(_f);
_9=_26+_20();
}
_23=_9;
}
}
if(!_a){
var _27=32768;
var _28=Math.floor((Math.random()%1)*Math.pow(2,14));
_a=(_27|_28).toString(_f);
}
var now=new Date();
var _29=now.valueOf();
var _2a=_12(_29);
if(!_d){
var _2b=_12(60*60);
var _2c=_12(dojox.uuid.generateTimeBasedUuid._generator.GREGORIAN_CHANGE_OFFSET_IN_HOURS);
var _2d=_18(_2c,_2b);
var _2e=_12(1000);
_d=_18(_2d,_2e);
_e=_12(10000);
}
var _2f=_2a;
var _30=_14(_d,_2f);
var _31=_18(_30,_e);
if(now.valueOf()==_b){
_31[3]+=_c;
_10(_31);
_c+=1;
if(_c==10000){
while(now.valueOf()==_b){
now=new Date();
}
}
}else{
_b=now.valueOf();
_c=1;
}
var _32=_31[2].toString(_f);
var _33=_31[3].toString(_f);
var _34=_1d(_32,4)+_1d(_33,4);
var _35=_31[1].toString(_f);
_35=_1d(_35,4);
var _36=_31[0].toString(_f);
_36=_1d(_36,3);
var _37="-";
var _38="1";
var _39=_34+_37+_35+_37+_38+_36+_37+_a+_37+_23;
_39=_39.toLowerCase();
return _39;
};
}();
return dojox.uuid.generateTimeBasedUuid;
});


;define("ic-ui/DialogUtil",["dijit/Dialog","dojo/_base/config","dojo/_base/lang","dojo/dom-class","dojo/on","dojo/query","dojo/string","dojo/i18n","dojo/i18n!ic-core/nls/strings","dojo/text!./templates/DialogUtil.html","dojox/uuid","dojox/uuid/generateTimeBasedUuid"],function(_1,_2,_3,_4,on,_5,_6,_7,_8,_9,_a,_b){
var _c={};
var _d=[];
function _e(){
var _f=_d;
var top;
while(_f.length>0&&!_f[_f.length-1].open){
top=_f.pop();
top.destroyRecursive();
top=null;
}
var _10=(_2.blankGif||dojo.moduleUrl("dojo","resources/blank.gif"));
var _11=_6.substitute(_9,_3.mixin(_3.clone(_8),{blankGif:_10,titleID:_b(),contentID:_b()}));
var d=new _1();
d.containerNode.innerHTML=_11;
d.closeBtn=_5(".lotusDialogClose",d.containerNode)[0];
d.lotusTitleNode=_5("h1 .title",d.containerNode)[0];
d.lotusContentNode=_5(".lotusDialogContent",d.containerNode)[0];
d.lotusFooterNode=_5(".lotusDialogFooter",d.containerNode)[0];
d.lotusSubmitNode=_5(".lotusDialogFooter .submit",d.containerNode)[0];
d.lotusCancelNode=_5(".lotusDialogFooter .cancel",d.containerNode)[0];
d.lotusBorderNode=_5(".lotusDialogBorder",d.containerNode)[0];
d.connect(d.closeBtn,"onclick","onCancel");
d.connect(d.lotusCancelNode,"onclick","onCancel");
_f.push(d);
return _f[_f.length-1];
};
_c.alert=function(_12,_13,_14){
var d=_e();
d.lotusTitleNode.innerHTML=_12;
d.lotusContentNode.innerHTML=_13;
d.lotusCancelNode.style.display="none";
d.titleBar.style.display="none";
d.lotusSubmitNode.value=_8.rs_ok;
d.lotusSubmitNode.onclick=function(){
d.hide();
if(_14){
_14();
}
};
d.show();
};
_c.prompt=function(_15,_16,_17,_18,_19,_1a){
var d=_e(_15);
d.lotusTitleNode.innerHTML=_15;
d.lotusContentNode.innerHTML=_16;
d.lotusSubmitNode.value=_17;
d.lotusCancelNode.value=_18;
d.lotusCancelNode.style.display="";
d.lotusSubmitNode.onclick=function(){
d.hide();
if(_19){
_19(true);
}
};
on(d,"onCancel",null,function(){
if(_19){
_19(false);
}
});
d.titleBar.style.display="none";
if(_1a){
_4.add(d.lotusBorderNode,_1a);
}
d.show();
};
_c.popupForm=function(_1b,_1c,_1d,_1e,_1f,_20){
var d=_e(_1b);
d.lotusTitleNode.innerHTML=_1b;
d.lotusContentNode.innerHTML="";
d.lotusContentNode.appendChild(_1c);
d.lotusSubmitNode.value=_1d;
d.lotusCancelNode.value=_1e;
d.lotusCancelNode.style.display="";
if(_1f){
d.lotusSubmitNode.onclick=_1f;
}
if(_20){
d.connect(d,"onCancel",_3.hitch(null,_20));
}
d.titleBar.style.display="none";
d.show();
return {_dialog:d,hide:function(){
d.hide();
},disableSubmit:function(){
_4.add(d.lotusSubmitNode,"lotusBtnDisabled");
d.lotusSubmitNode.disabled="disabled";
d.lotusSubmitNode.value=_8.rs_loading;
},enableSubmit:function(){
_4.remove(d.lotusSubmitNode,"lotusBtnDisabled");
d.lotusSubmitNode.disabled="";
d.lotusSubmitNode.value=_1d;
}};
};
return _c;
});


;define("ic-core/DialogUtil",["dojo/_base/kernel","ic-ui/DialogUtil"],function(_1,_2){
_1.deprecated("ic-core/DialogUtil","Use ic-ui/DialogUtil instead","5.0");
return _2;
});


;define("ic-incontext/util/text",["dojo","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/dom-construct","dojo/has","dojo/number","dojo/string"],function(_1,_2,_3,_4,_5,_6,_7,_8){
return _3.mixin(_3.getObject("com.ibm.social.incontext.util.text",true),{possessive:function(s){
if(s&&s[s.length-1]!="s"){
s+="'s";
}else{
s+="'";
}
return s;
},getExtension:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf(".");
if(i!=-1){
return s.substring(i+1).toLowerCase();
}
return "";
},trimExtension:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf(".");
if(i!=-1){
return s.substring(0,i);
}
return s;
},getFilename:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf("\\");
var j=s.lastIndexOf("/");
if(i==j){
return s;
}
i=Math.max(i,j);
return s.substring(i+1);
},trimToLength:function(s,_9,_a){
if(!s){
return "";
}
s=this.trimEnd(s);
var _b="...";
if(_a>0){
var _c=s.split(/[\s\u3000]/);
for(var i=0;i<_c.length;i++){
if(_c[i].length>_a){
var l=s.indexOf(_c[i])+_a;
if(l>_9){
break;
}
return this.trimEnd(s.substring(0,l-_b.length))+_b;
}
}
}
if(s.length>_9){
s=this.trimEnd(s.substring(0,_9-_b.length))+_b;
}
return s;
},trim:function(s){
if(!s){
return "";
}
var e=/^[\s\u3000]*(.*?)[\s\u3000]*$/.exec(s+"");
return e?e[1]:s;
},trimEnd:function(s){
if(!s){
return "";
}
s+="";
s=/^(.*?)[\s\u3000]*$/.exec(s)[1];
return s;
},parseInt:function(s,_d){
if(typeof _d=="undefined"){
_d=0;
}
if(!s){
return _d;
}
var a=parseInt(s);
return isNaN(a)?_d:a;
},parseFloat:function(s,_e){
if(typeof _e=="undefined"){
_e=0;
}
if(!s){
return _e;
}
var a=parseFloat(s);
return isNaN(a)?_e:a;
},formatSize:function(){
var _f,_10;
if(arguments.length==2){
_f=arguments[0];
_10=arguments[1];
}else{
_10=arguments[0];
}
if(typeof _10=="undefined"||_10==null||typeof _10=="string"){
return _10;
}
var _f=_f||this._SIZE;
if(!_f){
throw "Must pass nls to formatSize or set the com.ibm.social.incontext.util.text._SIZE property during init";
}
if(_10>10*1024*1024*1024){
return _8.substitute(_f.GB,[_7.format(Math.floor(_10*10/(1024*1024*1024))/10)]);
}else{
if(_10>=1*1024*1024*1024){
return _8.substitute(_f.GB,[_7.format(Math.floor(_10*100/(1024*1024*1024))/100)]);
}else{
if(_10>100*1024*1024){
return _8.substitute(_f.MB,[_7.format(Math.floor(_10/(1024*1024)))]);
}else{
if(_10>10*1024*1024){
return _8.substitute(_f.MB,[_7.format(Math.floor(_10*10/(1024*1024))/10)]);
}else{
if(_10>=1*1024*1024){
return _8.substitute(_f.MB,[_7.format(Math.floor(_10*100/(1024*1024))/100)]);
}else{
if(_10>1*1024){
return _8.substitute(_f.KB,[_7.format(Math.floor(_10/1024))]);
}
}
}
}
}
}
return _8.substitute(_f.KB,[_7.format(_10>0?1:0)]);
},lengthUtf8:function(s){
var _11=0;
var _12=s.length;
for(var i=0;i<_12;i++){
var c=s.charCodeAt(i);
if(c<=127){
_11++;
}else{
if(c<=2047){
_11+=2;
}else{
if(c<=65535){
_11+=3;
if((c>>11)==27){
_11++;
i++;
}
}else{
_11+=4;
}
}
}
}
return _11;
},getCharIndexForUtf8Index:function(s,max){
var _13=0;
var _14=s.length;
for(var i=0;i<_14;i++){
var c=s.charCodeAt(i);
if(c<=127){
_13++;
}else{
if(c<=2047){
_13+=2;
}else{
if(c<=65535){
_13+=3;
if((c>>11)==27){
_13++;
i++;
}
}else{
_13+=4;
}
}
}
if(_13>max){
return i;
}
}
return -1;
},encodeHeaderUtf8:function(s){
return "=?UTF-8?Q?"+encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,"=$1")+"?=";
},decodeSpecialHtmlChars:function(_15){
if(!_15){
return "";
}
var _16=_4.doc.createElement("textarea");
_16.innerHTML=_15.replace(/</g,"&lt;").replace(/>/g,"&gt;");
return _16.value;
},base64Encode:function(_17){
var _18=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];
if(!_17){
return "";
}
var _19=this.getUTF8ByteArray(_17);
var _1a="";
var _1b=0;
var _1c=0;
for(;_1b<_19.length-2;_1b+=3){
_1a+=_18[_19[_1b]>>>2&63];
_1c++;
_1a+=_18[_19[_1b+1]>>>4&15|_19[_1b]<<4&63];
_1c++;
_1a+=_18[_19[_1b+2]>>>6&3|_19[_1b+1]<<2&63];
_1c++;
_1a+=_18[_19[_1b+2]&63];
_1c++;
}
if(_1b<_19.length){
_1a+=_18[_19[_1b]>>>2&63];
_1c++;
if(_1b<_19.length-1){
_1a+=_18[_19[_1b+1]>>>4&15|_19[_1b]<<4&63];
_1c++;
_1a+=_18[_19[_1b+1]<<2&63];
_1c++;
}else{
_1a+=_18[_19[_1b]<<4&63];
_1c++;
}
}
var _1d=Math.floor(((_19.length+2)/3)*4-1);
if(_1d%4==1){
_1d--;
}else{
if(_1d%4==3){
_1d++;
}
}
for(;_1c<_1d;_1c++){
_1a+="=";
}
return _1a;
},getUTF8ByteArray:function(str){
if(!str){
return [];
}
var _1e=[];
for(var i=0;i<str.length;i++){
var _1f=str.charCodeAt(i);
if(_1f>=0&&_1f<128){
_1e[_1e.length]=_1f;
}else{
if(_1f>=128&&_1f<2048){
_1e[_1e.length]=192|((_1f>>>6)&31);
_1e[_1e.length]=128|(_1f&63);
}else{
if(_1f>=2048&&_1f<65536){
_1e[_1e.length]=224|((_1f>>>12)&15);
_1e[_1e.length]=128|((_1f>>>6)&63);
_1e[_1e.length]=128|(_1f&63);
}else{
if(_1f>=65536&&_1f<=1114111){
_1e[_1e.length]=240|((_1f>>>18)&7);
_1e[_1e.length]=128|((_1f>>>12)&63);
_1e[_1e.length]=128|((_1f>>>6)&63);
_1e[_1e.length]=128|(_1f&63);
}else{
_1e[_1e.length]=-1;
}
}
}
}
}
return _1e;
},breakString:function(s,d,el,_20,_21){
if(!s){
return;
}
var _22=5;
var _23=function(el,s){
if(!s){
return;
}
if(_21){
var br=/\n/g;
if(br.test(s)){
var _24;
while((_24=s.indexOf("\n"))!=-1){
if(_24>0){
el.appendChild(d.createTextNode(s.substring(0,_24)));
}
_5.create("br",{},el);
s=s.substring(_24+1);
}
if(s){
el.appendChild(d.createTextNode(s));
}
}else{
el.appendChild(d.createTextNode(s));
}
}else{
el.appendChild(d.createTextNode(s));
}
};
_20=_20||10;
var b=new RegExp("[^\\s]{"+(_20+1)+",}","g");
var _25=/\s*(\S*)$/;
var r;
var _26=0,end,tmp,_27,_28,_29,i,_2a,_2b,_2c,str,_2d,_2e;
var _2f=(_6("ie")||_6("webkit"))?"":"\u200b";
while(r=b.exec(s)){
end=b.lastIndex;
tmp=s.substring(_26,end);
_27=_25.exec(tmp)[1];
_23(el,s.substring(_26,end-_27.length));
_28=Math.floor(_27.length/_20);
_29=0;
_2b=_27.length%_20;
if(_2b&&_2b<_22){
_28--;
_29=_20-(_22-(_27.length%_20));
}
var _2a=0;
var _30=0;
for(i=0;i<_28;i++){
_2e=_2a+_20-_30;
_30=0;
_2d=_27.charCodeAt(_2e-1);
if(_2d>=55296&&_2d<56192){
_30=1;
}
_2c=!(i===_28-1&&!_29&&!_2b);
str=_27.substring(_2a,_2e+_30);
_23(el,str+(_2c?_2f:""));
if(!_2f&&_2c){
el.appendChild(d.createElement("wbr"));
}
_2a+=str.length;
}
if(_29){
_2a=_27.length-_22-_29;
_2e=_2a+_29;
_2a+=_30;
_30=0;
_2d=_27.charCodeAt(_2e-1);
if(_2d>=55296&&_2d<56192){
_30=1;
}
str=_27.substring(_2a,_2e+_30);
_23(el,str+_2f);
if(!_2f){
el.appendChild(d.createElement("wbr"));
}
}
if(_2b){
if(_29){
_23(el,_27.substring(_27.length-_22+_30,_27.length));
}else{
_23(el,_27.substring(_27.length-_2b+_30,_27.length));
}
}
_26=end;
}
_23(el,s.substring(end));
},breakStringHTML:function(el,len){
var _31=this;
var _32=[];
_32.push(el);
if(!len){
len=10;
}
while(_32.length){
var _33=_32.pop();
var _34=[];
_2.forEach(_33.childNodes,function(_35){
_34.push(_35);
});
_2.forEach(_34,function(_36){
if(_36.nodeType==3){
var _37=_5.create("span");
_31.breakString(_36.nodeValue,_4.doc,_37,len);
var _38=[];
_2.forEach(_37.childNodes,function(_39){
_38.push(_39);
});
_2.forEach(_38,function(_3a){
_36.parentNode.insertBefore(_3a,_36);
});
_36.parentNode.removeChild(_36);
}else{
if((_36.nodeType==1)&&(_36.childNodes.length>0)){
_32.push(_36);
}
}
});
}
}});
});


;define("ic-incontext/util/html",["dojo","dojo/_base/declare","dojo/_base/window","dojo/_base/array","dojo/dom-construct","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/i18n!ic-incontext/nls/socialInContextCoreStrings","dojo/_base/lang","dojo/dom-class","dojo/has","dojo/query","dojo/_base/config","dojox/html/entities","dijit/registry","ic-core/DialogUtil","ic-incontext/util/text","lconn/core/globalization/bidiUtil"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13){
return _a.mixin(_a.getObject("com.ibm.social.incontext.util.html",true),{getDirectionCode:function(){
return _7._isBodyLtr()?"":"\u200f";
},destroyWidgets:function(el){
if(el&&el.nodeType!=11){
var _14=_d("[widgetId]",el).map(_10.byNode);
_4.forEach(_14,function(w){
if(w){
w.destroyRecursive();
}
});
}
},removeChildren:function(el){
this.destroyWidgets(el);
while(el.firstChild){
el.removeChild(el.firstChild);
}
},isEvent:function(e){
return (e&&(typeof e.target!="undefined"||typeof e.bubbles!="undefined"));
},append:function(el,_15){
var d=document;
if(_a.isArray(_15)){
for(var i=0;i<_15.length;i++){
var c=_15[i];
el.appendChild((typeof c=="string")?d.createTextNode(c):c);
}
}else{
el.appendChild((typeof _15=="string")?d.createTextNode(_15):_15);
}
},createTable:function(d,_16){
var _17=d.createElement("table");
_17.cellPadding=_17.cellSpacing=0;
var _18=d.createElement("tbody");
var tr=d.createElement("tr");
var td=d.createElement("td");
if(_16){
td.appendChild(_16);
}
tr.appendChild(td);
_18.appendChild(tr);
_17.appendChild(_18);
return _17;
},countCells:function(tr,_19){
var td=tr.firstChild;
var c=0;
while(td){
if(_19==td){
break;
}
if(td.nodeName.toLowerCase()=="td"){
c+=(_6.get(td,"colSpan")||1);
}
td=td.nextSibling;
}
return c;
},formatFilename:function(s){
if(_7._isBodyLtr()){
return this.encodeMultiSpaces(s);
}
return "\u202a"+this.encodeMultiSpaces(s)+"\u202c";
},encodeHtmlAttribute:function(s){
return this.encodeHtml(s).replace(/\"/g,"&quot;");
},encodeHtml:function(s){
if(!s){
return "";
}
var e=this._encoder;
if(!e){
e=this._encoder=_3.doc.createElement("div");
}
e.innerHTML="";
e.appendChild(_3.doc.createTextNode(s));
return e.innerHTML;
},decodeHtml:function(s){
if(!s){
return "";
}
var e=this._decoder;
if(!e){
e=this._decoder=_5.create("div");
}
e.innerHTML=s;
return _c("ie")?e.innerText:e.textContent;
},getFrameDocument:function(_1a){
var _1b;
if(_1a){
try{
if(_c("ie")||_c("safari")>2){
_1b=_1a.contentWindow.document;
}else{
if(_c("safari")){
_1b=_1a.document;
}else{
_1b=_1a.contentWindow.document;
}
}
}
catch(e){
}
}
return _1b;
},UNICODE_SPACE:/[\s\u3000]/g,UNICODE_DOUBLE_SPACE:/[\s\u3000]{2}/g,encodeSpaces:function(s){
if(!s){
return s;
}
return s.replace(this.UNICODE_SPACE,"\xa0");
},encodeMultiSpaces:function(s){
if(!s){
return s;
}
return s.replace(this.UNICODE_DOUBLE_SPACE," \xa0");
},htmlText:function(el){
if(!el){
return null;
}
var a=[];
for(var j=0,c;c=el.childNodes[j];j++){
if(c.nodeType==3){
a.push(c.nodeValue);
}
}
return a.length>0?a.join(""):null;
},SUBSTITUTION:/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,substitute:function(d,el,_1c,map,_1d,_1e){
var re=this.SUBSTITUTION;
el=el||d.createDocumentFragment();
var _1f=0,r;
while(r=re.exec(_1c)){
el.appendChild(d.createTextNode(_1c.substring(_1f,r.index)));
_1f=r.index+r[0].length;
var key=r[1];
var _20=r[2];
var _21=_a.getObject(key,false,map);
if(typeof _21=="function"){
_21=_21.apply(_1e||map,[key,_20]);
}
if(_20){
_21=_a.getObject(_20,false,_1e)(_21);
}
if(_1d){
_21=_1d(_21,key);
}
if(typeof _21!="undefined"&&_21!==null){
if(_21.nodeType>0){
_21.style.direction=_13.getTextDirection(_21.textContent);
_21.dir=_21.style.direction;
_21.style.textAlign="inherit";
el.appendChild(_21);
}else{
_21=_13.enforceTextDirection(_21.toString());
el.appendChild(d.createTextNode(_21.toString()));
}
}
}
el.appendChild(d.createTextNode(_1c.substring(_1f)));
return el;
},EMBEDDED_URL_PATTERN:/(^|[\s])(([a-zA-Z]+:\/\/|www\.|mailto:)[^\s]+)/i,URL_PUNCTUATION_BACKTRACK:/[\.,\!\-;\:\'\"]+$/,createTextNode:function(d,el,_22,_23){
if(!_22){
return;
}
_22=_a.trim(_22);
if(_22.length>0){
var _24=_22.split("\n"),i;
for(i=0;i<_24.length;i++){
var _22=_24[i],_25,_26;
while(_25=this.EMBEDDED_URL_PATTERN.exec(_22)){
var _27=_22.substring(0,_25.index)+_25[1];
var _28=_25[2];
if(_26=this.URL_PUNCTUATION_BACKTRACK.exec(_28)){
_28=_28.substring(0,_26.index);
}
_22=_22.substring(_27.length+_28.length);
var _29=(_25[3]&&_25[3].toLowerCase()=="www.");
var _2a=(_25[3]&&_25[3].toLowerCase()=="mailto:");
var _2b=_29?"http://"+_28:_28;
if(_2a){
_28=_28.substring(7);
}
if(_27.length>0){
_12.breakString(_27,d,el,15);
}
var a=d.createElement("a");
a.href=_2b;
a.target="_blank";
_12.breakString(_28,d,a,15);
el.appendChild(a);
}
if(_22.length>0){
_12.breakString(_22,d,el,15);
}
if(i!=(_24.length-1)){
el.appendChild(!_23?d.createElement("br"):d.createTextNode(" "));
}
}
}
},generateiWidgetEnablerCodeIfRequired:function(_2c,doc){
if(_2c.indexOf("mm_iWidget")>-1){
console.log("update generateiWidgetEnablerCodeIfRequired for MM1.1");
}
return null;
},evalScriptTag:function(tag){
if(tag.src){
var h=document.getElementsByTagName("head")[0];
var _2d=document.createElement("SCRIPT");
_2d.src=tag.src;
h.appendChild(_2d);
}else{
if(tag.text&&tag.text.length>0){
if(window.execScript){
window.execScript(tag.text);
}else{
if(_c("safari")){
window.setTimeout(tag.text,0);
}else{
eval.call(window,tag.text);
}
}
}
}
},xhtmlToHtml:function(d,_2e,_2f,_30,ids){
if(!_2e){
return;
}
if(!_30){
for(var i=0,a;a=_2e.attributes[i];i++){
var n=a.nodeName.toLowerCase();
switch(n){
case "class":
_2f.className=a.nodeValue;
break;
case "colspan":
_2f.colSpan=a.nodeValue;
break;
case "style":
try{
_2f.style.cssText=a.nodeValue;
}
catch(e){
}
break;
default:
if(n=="onclick"&&_c("ie")){
_2f.onclick=new Function(a.nodeValue);
}else{
_2f.setAttribute(a.nodeName,a.nodeValue);
}
}
}
if(_2f.id&&ids){
ids[_2f.id]=_2f;
}
}
var n=_2e.nodeName.toLowerCase();
for(var i=0,x;x=_2e.childNodes[i];i++){
switch(x.nodeType){
case 1:
var e=d.createElement(x.nodeName);
_2f.appendChild(e);
com.ibm.social.incontext.util.html.xhtmlToHtml(d,x,e,false,ids);
break;
case 3:
switch(n){
case "script":
if(_c("ie")){
_2f.text=x.nodeValue;
}else{
_2f.appendChild(d.createTextNode(x.nodeValue));
}
break;
case "style":
if(_c("ie")){
_2f.styleSheet.cssText=x.nodeValue;
}else{
_2f.appendChild(d.createTextNode(x.nodeValue));
}
break;
default:
_2f.appendChild(d.createTextNode(x.nodeValue));
break;
}
break;
}
}
},alert:function(msg){
alert(msg);
},confirm:function(msg,_31,_32){
var _33=confirm(msg);
if(_33&&_31){
_31();
}else{
if(!_33&&_32){
_32();
}
}
},showLoading:function(_34,_35){
if(_34){
var _36=_5.create("table",{className:"eeLoadingCtnr",role:"presentation"},_34);
var _37=_5.create("tbody",{},_36);
var tr=_5.create("tr",{},_37);
var td=_5.create("td",{},tr);
var div=_5.create("div",{className:"lotusLoading"},td);
td=_5.create("td",{},tr);
var _38=_5.create("span",{className:"lotusAltText"},td);
_38.appendChild(_3.doc.createTextNode(_9.GENERAL.LOADING));
if(_35){
_b.add(_38,"eeLoadingTxt");
_b.remove(_38,"lotusAltText");
}else{
var _39=this.isHighContrast();
if(_39){
_b.remove(_38,"lotusAltText");
}
}
}
},isHighContrast:function(){
var _3a=false;
var div=_5.create("div",{"aria-hidden":"true",role:"presentation",style:{cssText:"border: 1px solid;"+"border-color:red green;"+"position: absolute;"+"height: 5px;"+"top: -999px;"+"background-image: url(\""+(_e.blankGif||require.toUrl("dojo/resources/blank.gif?etag=Z6uJWS0"))+"\");"}},_3.body());
var cs=_8.getComputedStyle(div);
if(cs){
var _3b=cs.backgroundImage;
_3a=(cs.borderTopColor==cs.borderRightColor)||(_3b!=null&&(_3b=="none"||_3b=="url(invalid-url:)"));
}
if(div){
div.outerHTML="  ";
}
return _3a;
},processScripts:function(el,_3c){
var _3d,end,_3e,_3f;
if(el&&_3c){
_3d=_3c.indexOf("<script>");
end=_3c.indexOf("</script>");
if(end){
if(_3d){
_3e=_3c.substring((_3d+8),end);
}
_3f=_3c.substring(end+9,_3c.length);
if(_3f){
el.innerHTML=_3f;
}
if(_3e){
eval(_3e);
}
}
}
},promptContentChangedDialog:function(_40){
var _41=_9.DIALOG;
_11.prompt(_41.CHANGED_CLOSE_TITLE,_41.CHANGED_CLOSE_MESSAGE,_41.OK,_41.CANCEL,_40);
},removeProfileLinks:function(_42){
if(!_42){
return null;
}
var _43=_5.create("div",{innerHTML:_42});
_d("span.vcard > a",_43).forEach(function(_44){
var _45=this.htmlText(_44);
_45=_f.encode(_45);
var _46=_5.create("span",{innerHTML:_45});
_5.place(_46,_44,"replace");
});
return _43.innerHTML;
}});
});


;define("ic-as/config/enablement",["dojo","dojo/_base/lang","dojo/cookie","ic-core/config/properties"],function(_1,_2,_3,_4){
(function(){
function _5(_6,_7){
return {"featureName":_6,"offByDefault":_7};
};
_2.setObject("com.ibm.social.as.config.enablement",{AS_HASHTAG_SEARCH:_5("com.ibm.social.as.hashtagSearchEnabled",true),AS_COMMENT_FILE_ATTACH:_5("com.ibm.social.as.attachmentCommentEnabled",true),AS_COMMENT_FILE_ATTACH_ATT:_5("com.ibm.connections.ublog.attachmentCommentEnabled",true),AS_SHARED_EXTERNALLY:_5("com.ibm.social.as.sharedExternallyEnabled",false),AS_VIDEO_PREVIEW:_5("com.ibm.social.as.videoPreviewEnabled",false),checkEnablement:function(_8){
var _9=true;
if(_8.offByDefault){
_9=(_4[_8.featureName]==="true"||_4[_8.featureName]==="enabled"||!!_3(_8.featureName));
}
return _9;
}});
})();
return com.ibm.social.as.config.enablement;
});


;define("ic-as/constants/events",[],function(){
var _1={BADGE_DECREASE_MY_NOTIFICATIONS:"lconn/homepage/activitystream/event/mynotificationsbadge/decrease",BADGE_UPDATE_MY_NOTIFICATIONS:"lconn/homepage/activitystream/event/mynotificationsbadge/update",BADGE_DECREASE_MENTIONS:"lconn/homepage/activitystream/event/mentionsbadge/decrease",BADGE_UPDATE_MENTIONS:"lconn/homepage/activitystream/event/mentionsbadge/update",BADGE_DATA_LOADED:"lconn/homepage/activitystream/event/badges/loaded",BADGE_RESET:"lconn/homepage/activitystream/event/badges/reset",BADGE_RESET_AMD:"com/ibm/ic-as/activitystream/event/badges/reset",BADGE_SYNC_MY_NOTIFICATIONS:"lconn/homepage/activitystream/event/mynotificationsbadge/sync",ACTIONREQUIREDBADGEDECREASE:"lconn/homepage/activitystream/event/actionrequiredbadge/decrease",ACTIONREQUIREDBADGEUPDATE:"lconn/homepage/activitystream/event/actionrequiredbadge/update",ACTIVITYSTREAMLOADED:"com/ibm/social/as/event/activitystreamloaded",BACKTOMAIN:"com/ibm/social/as/event/backtomain",CLEARMESSAGE:"lconn/homepage/activitystream/event/message/clear",CREATEMESSAGE:"lconn/homepage/activitystream/event/message/create",FEEDFETCHED:"com/ibm/social/as/event/feedfetched",INIT:"com/ibm/social/as/event/populate/init",DYNAMICFAIL:"/com/ibm/social/as/event/dynamicfail",ITEMCLICKED:"com/ibm/social/as/event/newsitemclicked",ITEMSELECTED:"com/ibm/social/as/event/newsitemselected",ITEMDESELECTED:"com/ibm/social/as/event/newsitemdeselected",ITEMGOTFOCUS:"com/ibm/social/as/event/newitemgotfocus",ITEMLOSTFOCUS:"com/ibm/social/as/event/itemlostfocus",KEYBOARDNAVIGATION:"com/ibm/social/as/event/keyboardnavigation",ADDACTIVITYENTRY:"com/ibm/social/as/event/addactivityentry",PAGECHANGE:"com/ibm/social/as/event/pagechange",PLACEHOLDERADD:"com/ibm/social/as/event/placeholder/add",PLACEHOLDERREMOVE:"com/ibm/social/as/event/placeholder/remove",POPULATE:"com/ibm/social/as/event/populate",POPULATEERROR:"com/ibm/social/as/event/populate/error",PARAMCHANGE:"com/ibm/social/as/event/paramchange",CONFIGERROR:"com/ibm/social/as/event/config/error",REMOVEACTIVITYENTRY:"com/ibm/social/as/event/removeactivityentry",STATEUPDATED:"com/ibm/social/as/event/stateupdated",TAGSFOLLOWING:"lconn/homepage/activitystream/event/tagmanagerextension/tagsfollowing",UPDATESTATE:"com/ibm/social/as/event/updatestate",UPDATEFILTERS:"lconn/homepage/activitystream/event/updatefilters",UPDATEEETARGET:"com/ibm/social/as/event/updateeetarget",PAGEDIRTY:"lconn/homepage/activitystream/event/pagedirty",PAGECLEAN:"lconn/homepage/activitystream/event/pageclean",DIRTYCHECKLEAVE:"lconn/homepage/activitystream/dirtycheck/leave/",STARTCOMMENT:"com/ibm/social/as/comment/startComment",STATUSUPDATEPOST:"com/ibm/social/as/statusupdateposted",STOPCOMMENT:"com/ibm/social/as/comment/stopComment",RESIZEHEIGHT:"com/ibm/social/as/event/resizeTextHeight",NEWSITEMDELETE:"com/ibm/social/as/event/newsitemdelete",FEEDRENDERED:"com/ibm/social/as/event/feedrendered",FEEDDESTROYED:"com/ibm/social/as/event/feeddestroyed",CLOSEEE:"com/ibm/social/as/event/closeee",COMMUNITYDISABLED:"com/ibm/social/as/community/disabled",LIKEPOPUPOPEN:"com/ibm/oneui/recommend/popup/onOpen",MICROBLOGCONFIGLOADED:"com/ibm/social/as/event/mbConfigLoaded",SHOWTOPBORDER:"com/ibm/social/as/event/showTopBorder",REMOVETOPBORDER:"com/ibm/social/as/event/removeTopBorder",CHANGEPAGETITLE:"com/ibm/social/as/event/changePageTitle",ASSTREAMFILTERED:"com/ibm/social/as/event/streamFiltered",ENABLESEARCH:"com/ibm/social/as/event/enableSearch",FILTERMENUHIDE:"com/ibm/social/as/event/filtermenuhide",SAVEACTIONCOMPLETE:"com/ibm/social/as/event/saveActionComplete",SHOWMORECLICKED:"com/ibm/social/as/event/showMoreClicked",HTML5VIDEOPLAYING:"com/ibm/social/as/event/html5VideoPlaying"};
return _1;
});


;define("ic-as/util/ConfigObjectUtil",["dojo/_base/lang","ic-as/constants/events"],function(_1,_2){
_1.setObject("com.ibm.social.as.util.ConfigObjectUtil",{getOptionById:function(_3,_4){
return {item:_3[_4],id:_4};
},getNumRealOptions:function(_5){
var _6=0;
this.forEachRealOptionKey(_5,function(){
_6++;
});
return _6;
},forEachRealOptionKey:function(_7,_8,_9){
for(var _a in _7){
if(_a!=="all"){
_8.call(_9,_a);
}
}
},getSelectedOption:function(_b){
if(_b.selectedItem&&_b.options[_b.selectedItem]){
return _b.selectedItem;
}else{
if(_b.selectedItem){
this.triggerRefreshInNextTick();
}
return false;
}
},triggerRefreshInNextTick:function(){
window.setTimeout(_1.hitch(dojo,"publish",_2.UPDATESTATE,[[]]),0);
},getDefaultOption:function(_c){
if(_c.defaultItem&&_c.options[_c.defaultItem]){
return _c.defaultItem;
}else{
for(var o in _c.options){
if(_c.defaultItem){
this.triggerRefreshInNextTick();
}
_c.defaultItem=o;
return o;
}
}
},getSelectedOrDefaultOptionKey:function(_d){
var _e=this.getSelectedOption(_d);
if(!_e){
_e=this.getDefaultOption(_d);
_d.selectedItem=_e;
}
return _e;
},getSelectedOrDefaultOptionObj:function(_f){
return _f.options[this.getSelectedOrDefaultOptionKey(_f)];
}});
return com.ibm.social.as.util.ConfigObjectUtil;
});


;define("ic-as/util/configNormalizer",["dojo/_base/declare"],function(_1){
var _2=_1("com.ibm.social.as.util.configNormalizer",[],{constructor:function(_3){
function _4(_5){
var _6=_5.options,_7;
for(var _8 in _6){
_7=_6[_8];
if(_7.selected){
_5.defaultItem=_8;
_5.selectedItem=_5.selectedItem||_8;
}
if(_7.filters){
_4(_7.filters);
}
}
};
var _9=(_3&&_3.configObject)||window.activityStreamConfig;
if(_9&&_9.views&&!_9.filters){
_9.filters={"options":_9.views};
_4(_9.filters);
}else{
if(_9&&_9.filters&&!_9.views){
_9.views=_9.filters.options;
}
}
}});
return _2;
});


;define("ic-as/util/hashtag/HashtagUtil",["dojo","dojo/_base/declare","dojo/dom-construct","dojo/i18n!ic-as/nls/activitystream","dojo/string","ic-core/config/services","ic-core/url"],function(_1,_2,_3,_4,_5,_6,_7){
var _8=_2("com.ibm.social.as.util.hashtag.HashtagUtil",null,{getSearchHashtagUrl:function(_9,_a){
if(_9){
return _7.getServiceUrl(_6.communities).uri+"/service/html/community/updates?communityUuid="+_9+"&filter=all#tag="+encodeURIComponent(_a)+"&tab=StatusUpdates";
}
var _b=encodeURIComponent("{\"type\":\"category\",\"values\":[\"Tag/"+_a+"\"]}");
return _7.getServiceUrl(_6.search).uri+"/web/search?scope=status_updates&constraint="+_b;
},linkifyHashtags:function(_c,_d,_e){
var _f=_3.create("div");
if(_d&&_d.length!=0){
_d.sort(function(a,b){
return b.length>a.length;
});
var _10=_c;
if(!_c&&_c!==""){
_c=_10;
}else{
_c=_c.replace(new RegExp("(^|[^\\w\\d/])#","g"),function(_11){
return _11.replace("#","##");
});
var _12;
var _13=_c;
var _14=_13.toLowerCase();
for(var i=0;i<_d.length;i++){
var tag=_d[i];
var re=new RegExp("##"+this.regexEscapeTag(tag),"ig");
var _15;
var _16=0;
var _17="";
while(_15=re.exec(_14)){
var _18=_13.substr(_15.index+1,tag.length+1);
_17+=_13.substring(_16,_15.index);
_17+=this.linkifyHashtag(_15[0],_18,_e,tag);
_16=_15.index+2+tag.length;
}
if(_17){
_17+=_13.substr(_16);
_12=_17;
_13=_17;
_14=_17.toLowerCase();
}
}
if(_12){
_c=_12;
}
_c=_c.replace(new RegExp("(^|[^\\w\\d/])##","g"),function(_19){
return _19.replace("##","#");
});
}
}
return _c;
},linkifyHashtag:function(_1a,_1b,_1c,_1d){
_1a=_1a.replace(/##/,"#");
var _1e="";
if(_1a.indexOf("#")>0){
_1e=_1a.charAt(0);
_1a=_1a.substring(1);
}
var _1f="";
var _20=_4;
if(_20&&_20.hashtagTitle){
_1f=_5.substitute(_20.hashtagTitle,[_1d]);
}
var _21={title:_1f,tag:_1d};
return _1e+this.createAnchorLink(_1b,_1c,_1d,_21);
},createAnchorLink:function(_22,_23,_24,_25){
var _26=_3.create("a",_25);
_26.href=this.getSearchHashtagUrl(_23,_24);
_26.innerHTML=_22;
return _26.outerHTML||new XMLSerializer().serializeToString(_26);
},regexEscapeTag:function(tag){
var _27=["(",")","[","]","{","}","/","\\",".","*","+","?","|","$","^"];
var _28=new RegExp("(\\"+_27.join("|\\")+")","g");
return tag.replace(_28,"\\$1");
}});
_8._Instance=null;
_8.getInstance=function(){
if(_8._Instance==null){
_8._Instance=new _8();
}
return _8._Instance;
};
return _8.getInstance();
});


;define("ic-as/config/ConfigManager",["dojo","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","ic-as/config/enablement","ic-as/util/ConfigObjectUtil","ic-as/util/configNormalizer","ic-core/config/services","ic-as/util/hashtag/HashtagUtil"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
var _a=_3(_7,{configObject:null,activityStreamModel:null,pagingHandler:null,newsItemFactory:null,newsItemManager:null,searchHashtagUtil:null,configObjectUtil:null,constructor:function(_b){
this.debug("ConfigManager constructor");
if(_b===undefined){
this.configObject={};
}
if(_b){
_4.mixin(this,_b);
}
var _c=this.configObject;
_c.activityStreamModelClass=_c.activityStreamModelClass||"ic-as.ActivityStreamModel";
_c.pagingHandlerClass=_c.pagingHandlerClass||"ic-as.paging.PagingHandler";
_c.newsItemFactoryClass=_c.newsItemFactoryClass||"ic-as.item.manager.NewsItemFactory";
_c.newsItemManagerClass=_c.newsItemManagerClass||"ic-as.item.manager.NewsItemManager";
var _d=(_4.exists("ic-as.util.hashtag.ASHashtagUtil")&&_5.checkEnablement(_5.AS_HASHTAG_SEARCH));
var _e=(_d)?"ic-as.util.hashtag.ASHashtagUtil":"ic-as.util.hashtag.HashtagUtil";
_c.searchHashtagUtilClass=_c.searchHashtagUtilClass||_e;
if(_c.defaultUrlTemplate){
var _f=_c.defaultUrlTemplate;
var _10=_8.opensocial;
if(_c.defaultUrlTemplate.substring(0,4).toLowerCase()!="http"&&_10){
if(window.location.protocol=="https:"&&_10.secureEnabled&&_10.secureUrl){
_c.defaultUrlTemplate=_10.secureUrl+_f;
}else{
if(_10.url){
_c.defaultUrlTemplate=_10.url+_f;
}
}
}
}
this.configObjectUtil=_6;
},getConfigObject:function(){
return this.configObject;
},getActivityStreamModel:function(){
this.debug("ConfigManager getActivityStreamModel");
this._checkMember("activityStreamModel","activityStreamModelClass");
return this.activityStreamModel;
},getPagingHandler:function(_11){
this.debug("ConfigManager getPagingHandler");
this._checkMember("pagingHandler","pagingHandlerClass",_11);
return this.pagingHandler;
},getNewsItemFactory:function(){
this.debug("ConfigManager getNewsItemFactory");
this._checkMember("newsItemFactory","newsItemFactoryClass");
return this.newsItemFactory;
},getNewsItemManager:function(_12){
this.debug("ConfigManager getNewsItemManager");
this._checkMember("newsItemManager","newsItemManagerClass",_12);
return this.newsItemManager;
},getSearchHashtagUtil:function(){
this.debug("ConfigManager getSearchHashtagUtil");
this._checkMember("searchHashtagUtil","searchHashtagUtilClass");
return this.searchHashtagUtil;
},getViews:function(){
return this.configObject.filters;
},getDefaultUrlTemplateValues:function(){
return this.configObject.defaultUrlTemplateValues;
},getUserInfoId:function(){
return (this.configObject.userInfo)?this.configObject.userInfo.id:undefined;
},getUserInfoDisplayName:function(){
return (this.configObject.userInfo)?this.configObject.userInfo.displayName:undefined;
},getEEConfig:function(){
return this.configObject.eeCfg;
},getUrlUpdater:function(_13){
return this.configObject.urlUpdater;
},isShareBox:function(){
this.debug("ConfigManager isShareBox");
return (this.configObject.shareBox!=undefined);
},getEEManager:function(){
this.debug("ConfigManager getEEManager");
return this.configObject.eeManager;
},getLinkTarget:function(){
return this.configObject.linkTarget||"_blank";
},isDynamicLoadingDisabled:function(){
return (this.configObject.dynamicLoadingDisabled);
},isUserNewsAdmin:function(){
var _14=this.configObject.connections;
return (_14&&(_14.isAdmin==="true"));
},checkDirtyFlag:function(){
return (this.configObject.dirtyChecker==="true");
},isReadonlyLikes:function(){
return (this.configObject&&this.configObject.readonlyLikes&&this.configObject.readonlyLikes==="true")?true:false;
},isInlineCommentingEnabled:function(){
var _15=true;
if(this.configObject&&this.configObject.inlineCommentingEnabled===false){
_15=this.configObject.inlineCommentingEnabled;
}
return _15;
},isFeatureEnabledByConfig:function(_16){
var _17=true;
if(this.configObject&&this.configObject.enablement){
_17=_2.some(this.configObject.enablement,function(_18){
if(_18&&_18.name===_16&&!_18.enabled){
return false;
}
});
}
return _17;
},isPermLinkViewOfAS:function(){
var _19=this.configObjectUtil.getSelectedOrDefaultOptionObj(this.getViews());
var _1a=false;
if(_19&&_19.filters){
var _1b=_19.filters;
var _1c=this.configObjectUtil.getSelectedOrDefaultOptionObj(_1b);
if(!_1c.label){
_1a=true;
}
}
return _1a;
},debug:function(_1d){
if(typeof as_console_debug!=="undefined"){
as_console_debug("com.ibm.social.as.config.ConfigManager - "+_1d);
}else{
if(typeof console!=="undefined"){
console.debug("com.ibm.social.as.config.ConfigManager - "+_1d);
}
}
},_checkMember:function(_1e,_1f,_20){
_20=_20||{};
if(!this[_1e]){
if(_4.exists(this.configObject[_1f])){
var cls=_4.getObject(this.configObject[_1f]);
this[_1e]=new cls(_20);
}
}
}});
_a._Instance=null;
_a.getInstance=function(_21){
if(_a._Instance==null){
_a._Instance=new _a(_21);
}
return _a._Instance;
};
return _a.getInstance();
});


;define("ic-as/util/hashtag/HashTagParser",["dojo/_base/array","dojo/_base/declare","ic-as/config/ConfigManager","ic-as/util/hashtag/HashtagUtil"],function(_1,_2,_3,_4){
var _5=_2("com.ibm.social.as.util.hashtag.HashTagParser",null,{parseHashTags:function(_6,_7){
var _8;
if(this.newsData.isCommunity()){
_8=this.newsData.getCommunityId();
_8=this.getConnectionsCommunityId(_8);
}
return this._setHashtagLinks(_6,_7,_8);
},getTagsArray:function(_9){
if(!_9){
return [];
}
return tagsArr=_1.map(_9,function(x){
return x.displayName;
});
},_setHashtagLinks:function(_a,_b,_c){
if(_a){
var _d=(_3.getSearchHashtagUtil())?_3.getSearchHashtagUtil():_4;
return _d.linkifyHashtags(_a,_b,_c);
}
return "";
}});
return _5;
});


;define("ic-ui/layout/people",["dojo","dojo/_base/lang","dojo/_base/config","dojo/_base/window","dojo/ready","dojo/has","dojo/string","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/i18n","dojo/i18n!ic-core/nls/strings","ic-core/config/services","ic-core/url","../util/Url"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){
var _10=_2.getObject("com.ibm.lconn.layout.people",true);
var _11=_2.getObject("com.ibm.social.layout.people");
if(!_11){
_11=_2.mixin(_2.getObject("com.ibm.social.layout.people",true),{createLink:function(_12){
return null;
},createImage:function(_13,_14,_15){
return null;
},getImageUrl:function(_16,_17){
return null;
},isImageEnabled:function(){
return false;
}});
}
var _18="fn vcard";
var _19="fn";
var _1a={className:"x-lconn-userid",style:{display:"none"}};
var _1b={className:"email",style:{display:"none"}};
var _1c="/html/profileView.do";
var _1d="/photo2.do";
var _1e=_c;
var _1f=(_6("chrome")>11||_6("ie")>8||_6("ff")>4)?true:null;
var _20=_d.profiles;
var _21=(_3.blankGif||require.toUrl("dojo/resources/blank.gif?etag=Z6uJWS0")).toString();
function _22(src){
this.src=src;
};
var _23={id:"userid",userid:"userid",uid:"uid",email:"email",dn:"distinguishedName",profileId:"key"};
function _24(_25,_26){
var key;
for(key in _23){
if(_23.hasOwnProperty(key)){
if(_25[key]){
_26[_23[key]]=_25[key];
break;
}
}
}
return _26;
};
if(_20){
var _27=_f.secure;
var url;
if(_27){
url=_20.secureUrl;
}else{
url=_20.url;
}
_2.mixin(_10,{getProfileUrl:function(_28){
var _29=url+_1c+_e.writeParameters(_24(_28,{}));
return _29;
},createLink:function(_2a,_2b,_2c){
var _2d=this.getProfileUrl(_2a);
var a;
var _2e=_2a.name;
if(_2a.state=="inactive"){
_2e=_7.substitute(_1e.rs_inactivePerson,[_2e]);
}
if(_2c){
_9.add(_2c,_18);
if(_2a.state=="inactive"){
_9.add(_2c,"lotusPersonInactive");
}else{
_9.add(_2c,"lotusPerson");
}
var _2f;
if(_6("ie")===8){
_2f=_2c.innerHTML;
}
_8.set(_2c,"href",_2d);
if(_6("ie")===8){
_2c.innerHTML=_2f;
}
a=_2c;
a.appendChild(_2b||_4.doc.createTextNode(_2e));
}else{
a=_a.create("a",{href:_2d});
_9.add(a,_19);
if(_2a.state=="inactive"){
_9.add(a,"lotusPersonInactive");
}else{
_9.add(a,"lotusPerson");
}
a.appendChild(_2b||_4.doc.createTextNode(_2e));
}
if((_2a.uid!=null)&&(_2a.uid!="")){
_a.create("span",_1a,a).appendChild(_4.doc.createTextNode(_2a.uid));
}else{
if((_2a.userid!=null)&&(_2a.userid!="")){
_a.create("span",_1a,a).appendChild(_4.doc.createTextNode(_2a.userid));
}else{
if((_2a.email!=null)&&(_2a.email!="")){
_a.create("span",_1b,a).appendChild(_4.doc.createTextNode(_2a.email));
}
}
}
_9.add(a,"bidiAware");
return a;
},createImage:function(_30,_31,_32){
if(!_30&&console){
console.log("Person parameter is null.");
return;
}
var _33=(!_1._postLoad&&_31>=0);
var src=this.getImageUrl(_30,_31);
var _34=_7.substitute(_1e.rs_PersonPicture,[_30.name]);
var img=_a.create("img",{src:_33?_21:src,alt:_34,style:(_31>=0)?{width:_31+"px",height:_31+"px"}:null});
if(_30.state=="inactive"){
_9.add(img,"lotusDim");
}
_9.add(img,"usersRadius");
if(_33){
_5(_2.hitch(img,_22,src));
}
var out=_32?_10.createLink(_30,img):img;
out.title=_34;
return out;
},getImageUrl:function(_35,_36){
var _37={r:_1f,small:(_36<=64)?true:null};
_24(_35,_37);
return url+_1d+_e.writeParameters(_37);
},isImageEnabled:function(){
return true;
}});
_2.mixin(_11,_10);
}else{
com.ibm.lconn.layout.people=_11;
}
return _10;
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["ic-ee"]=true;

;define("ic-ee/data/AbstractRoutes",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/_base/config","ic-core/config/services"],function(_1,_2,_3,_4,_5){
var _6=_2("com.ibm.social.ee.data.AbstractRoutes",null,{constructor:function(_7){
_3.mixin(this,_7);
this.svcUrls={};
},isSecure:function(){
if("isSecure" in _4){
return _4.isSecure;
}else{
var _8=(window.location.protocol||"http").replace(":","");
return (_8==="https");
}
},getServiceUrl:function(_9){
var _a=(_9)?_9:this.service;
if(!this.svcUrls[_a]){
if(_5){
this.svcUrls[_a]=_5[_a]?_5[_a][this.isSecure()?"secureUrl":"url"]:null;
}else{
this.svcUrls[_a]="/"+_a;
}
}
return this.svcUrls[_a];
},isServiceEnabled:function(){
if(_5){
if(_5[this.service]){
return true;
}
}
return false;
}});
return _6;
});


;define("ic-ee/config",["ic-core/config/services"],function(_1){
(function(){
var _2,_3,_4,_5=_1;
_3=function(){
var _6=window.webResourcesUrl||window.location.href;
var _7=_6.substring(0,_6.indexOf(":"));
return (_7==="https");
};
_4=_3()?_5.webresources.secureUrl:_5.webresources.url;
_2=com.ibm.social.ee.config={inlineGadgets:{},files:{canShare:true},gadgetParams:{width:380,maxWidth:250,maxHeight:250,maxTags:3},common:{commentCount:5,maxCommentLength:1000,imageFileTypes:["gif","jpeg","jpg","png"]},htmlContentParams:{width:70,height:70,numImages:4,numChar:500},ecm:{publishedParams:{includeRecommendation:true,includeTags:true,includeNotification:true,includeWorkingDraftInfo:true,includeApprovers:true},draftParams:{includeWorkingDrafts:true,includeApprovers:true},generatorName:"{ecm_files}",forceSSO:true},notificationEvents:{"files.notification.share":true,"blogs.notification.notify":true,"ideationblog.notification.notify-idea":true}};
_2.getInlineGadgetUrlFunc=function(_8){
return null;
};
_2.getProfileUrl=function(){
return _3()?_5.profiles.secureUrl:_5.profiles.url;
};
_2.getOpenSocialUrl=function(){
return _5.opensocial[_3()?"secureUrl":"url"];
};
})();
return com.ibm.social.ee.config;
});


;define("ic-ee/widget/Button",["dojo","dojo/_base/declare","dojo/_base/config","dojo/on","dijit/focus","dijit/form/DropDownButton"],function(_1,_2,_3,on,_4,_5){
_2("com.ibm.social.ee.widget.DropDownButton",[_5],{tooltip:"",a11yLabel:"",showMenuLabel:"",dropDownIcon:"lotusArrow lotusDropDownSprite eeDropDown",templateString:"<span style=\"vertical-align: top; margin: 0\" class=\"dijitInline dijitDropDownButton\" dojoAttachEvent=\"onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse\"><span class=\"dijitInline\"><button class=\"lotusBtn\" type=\"${type}\" title=\"${tooltip}\" dojoAttachPoint=\"focusNode,titleNode,_arrowWrapperNode\" waiRole=\"button\" waiState=\"haspopup-true,labelledby-${id}_label\"><span id=\"${id}_label\"><span dojoAttachPoint=\"containerNode, _popupStateNode\"></span></span><img src=\"${blankIcon}\" waiRole=\"presentation\" alt=\"\" aria-label=\"${showMenuLabel}\" role=\"presentation\" class=\"${dropDownClass} ${dropDownIcon}\"/><span class=\"lotusAltText\" waiRole=\"presentation\" role=\"presentation\">&nbsp;&#9660;</span></button></span></span>",buildChildren:function(){
},postMixInProperties:function(){
this.dropDownClass="eeDropDownArrow";
this.blankIcon=_3.blankGif;
this.inherited(arguments);
},toggleDropDown:function(){
if(this.disabled||this.readOnly){
return;
}
_4.focus(this.popupStateNode);
var _6=this.dropDown;
if(!_6){
return;
}
if(!this._opened){
if(_6._scrollableChildren&&_6._scrollableChildren.length<1){
this.buildChildren();
}
if(_6.href&&!_6.isLoaded){
var _7=this;
var _8=on(_6,"Load",function(){
_8.remove();
_7.openDropDown();
});
_6._loadCheck(true);
return;
}else{
this.openDropDown();
}
}else{
this.closeDropDown();
}
}});
return com.ibm.social.ee.widget.Button;
});


;define("ic-incontext/util/proxy",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/_base/config","dojo/_base/url"],function(_1,_2,_3,_4,_5){
var _6=function(_7){
return _7=="https"?443:80;
};
var _8=_3.getObject("ic-as/util/xhr/XhrHandler");
var _9=_8===undefined||!_8.useOauth;
var _a=_4.proxy;
var _b;
if(_9&&_a){
var _c=window.location;
var _d=_c.hostname;
var _e=(_c.protocol||"http").replace(":","");
var _f=_c.port||_6(_e);
_b=function(url){
var uri=new _5(url);
var _10=uri.host;
if(_10){
var _11=uri.scheme||_e;
var _12=uri.port||_6(_11);
if(_11!=_e||_12!=_f||_10!=_d){
return _a+"/"+_11+"/"+encodeURIComponent(_10+":"+_12)+(uri.path||"")+(uri.query?("?"+uri.query):"");
}
}
return url;
};
}else{
_b=function(url){
return url;
};
}
return _b;
});


;define("ic-incontext/util/url",["dojo","dojo/_base/lang","dojo/_base/url","ic-incontext/util/proxy"],function(_1,_2,_3,_4){
return {_const:{regex:/(^[a-zA-Z]+)\:\/\/([a-zA-Z\d][\a-z\A-Z\d\-\.]*)(:\d{1,5})?([\/\?\#].*)?/,protocolPorts:{"http":80,"https":443}},parse:function(_5){
if(!_5){
return null;
}
if(typeof _5!="string"&&console.trace){
throw "Argument for URI must be a string";
}
_5=new _3(_5);
_5.queryParameters=this.getRequestParameters(_5);
return _5;
},write:function(_6){
if(!_6){
return null;
}
var _7="";
if(_6.scheme){
_7+=_6.scheme+":";
}
if(_6.authority){
_7+="//"+_6.authority;
}
_7+=_6.path;
if(_6.queryParameters){
_7+=this.writeParameters(_6.queryParameters);
}else{
if(_6.query){
_7+=((_6.query.charAt(0)!="?")?"?":"")+_6.query;
}
}
if(_6.fragment){
_7+="#"+_6.fragment;
}
return _7;
},rewrite:function(_8,p){
if(_8&&p){
_8=this.parse(_8);
_2.mixin(_8.queryParameters,p);
_8=this.write(_8);
}
return _8;
},splitQuery:function(_9){
var _a={};
if(!_9){
return _a;
}
if(_9.charAt(0)=="?"){
_9=_9.substring(1);
}
var _b=_9.split("&");
for(var i=0;i<_b.length;i++){
if(_b[i].length>0){
var _c=_b[i].indexOf("=");
if(_c==-1){
var _d=decodeURIComponent(_b[i]);
var _e=_a[_d];
if(_2.isArray(_e)){
_e.push("");
}else{
if(_e){
_a[_d]=[_e,""];
}else{
_a[_d]="";
}
}
}else{
if(_c>0){
var _d=decodeURIComponent(_b[i].substring(0,_c));
var _f=decodeURIComponent(_b[i].substring(_c+1));
var _e=_a[_d];
if(_2.isArray(_e)){
_e.push(_f);
}else{
if(_e){
_a[_d]=[_e,_f];
}else{
_a[_d]=_f;
}
}
}
}
}
}
return _a;
},getRequestParameters:function(uri){
if(!uri){
return {};
}
if(typeof uri=="string"){
uri=new _3(uri);
}
return this.splitQuery(uri.query);
},writeParameters:function(map){
var out=[];
for(var key in map){
var _10=map[key];
if(typeof _10!="undefined"&&_10!=null){
key=encodeURIComponent(key);
if(_2.isArray(_10)){
for(var i=0;i<_10.length;i++){
if(_10[i]){
out.push(out.length==0?"?":"&");
out.push(key);
out.push("=");
out.push(encodeURIComponent(_10[i]));
}
}
}else{
out.push(out.length==0?"?":"&");
out.push(key);
out.push("=");
out.push(encodeURIComponent(_10));
}
}
}
return out.join("");
},removeRelativePathFromHost:function(uri){
var _11=this.parse(uri);
_11=_11.scheme+"://"+_11.host;
return _11;
},getProxifiedURL:function(url){
return _4(url);
}};
});


;define("ic-ee/util/misc",["dojo","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/on","dojo/query","dijit/Menu","dijit/MenuItem","ic-ee/config","ic-ee/widget/Button","ic-incontext/util/url"],function(_1,_2,_3,_4,_5,_6,_7,on,_8,_9,_a,_b,_c,_d){
return {getItemIdFromRollupUrl:function(_e){
var uu=_d;
var _f=uu.parse(_e);
return _f.queryParameters.filterValue;
},getItemId:function(_10){
return misc._getTextAfterLastIden(_10,":");
},_getTextAfterLastIden:function(str,_11){
var id=str,_12=-1;
if(id){
_12=id.lastIndexOf(_11);
if(_12!=-1){
id=id.substring(_12+1);
}
}
return id;
},generateActionBtns:function(_13,_14,_15,nls){
var _16=null,_17=null,_18=null,_19=false,_1a=false,_1b=this,_1c=_15.length;
_2.forEach(_15,function(_1d){
if(_1d.isVisible()){
if(!_19){
_1b.createButton(_14,_1d,_13);
_19=true;
}else{
if(!_1a&&(_1c<=2)){
_1b.createButton(_14,_1d,_13);
_1a=true;
}else{
if(!_17){
_16=_7.create("span",{},_14);
_17=new _9({"class":"lotusActionMenu lotusPlain"});
}
_18=new _a({label:_1d.name,title:_1d.title,onClick:_1d.execute});
_17.addChild(_18);
if(_1d.isFollow){
_13.followBtn=_18.containerNode;
}
}
}
}
});
if(_17&&_18&&_16){
var _1e={};
_1e["label"]=nls.common.more.label;
_1e["tooltip"]=nls.common.more.tooltip;
_1e["a11yLabel"]="";
_1e["dropDown"]=_17;
_1e["showMenuLabel"]=nls.common.more.label;
new com.ibm.social.ee.widget.DropDownButton(_1e,_16);
}
},createButton:function(_1f,_20,_21){
var btn=_7.create("button",{type:"button",className:"lotusBtn lotusBtnSpecial lotusFirst",title:_20.title},_1f);
btn.appendChild(_4.doc.createTextNode(_20.name));
if(_20.optClasses){
_6.add(btn,_20.optClasses);
}
if(_20.isDisabled&&_20.isDisabled()){
_6.add(btn,"lotusBtnDisabled");
btn.setAttribute("disabled","true");
btn.setAttribute("aria-disabled","true");
}else{
_6.remove(btn,"lotusBtnDisabled");
btn.removeAttribute("disabled");
btn.removeAttribute("aria-disabled");
}
on(btn,"click",_3.hitch(_20,"execute"));
if(_20.isFollow){
_21.followBtn=btn;
}
_1f.style.display="";
},isImage:function(ext){
var _22=_b.common.imageFileTypes;
var _23=_2.indexOf(_22,ext);
if(_23!=-1){
return true;
}else{
return false;
}
},addMessageToNewWindowLinks:function(){
var _24=i18nactivitystream;
_8("a").forEach(function(_25,_26,arr){
if(_5.get(_25,"target")=="_blank"){
var _27=_5.get(_25,"title");
if(_5.get(_25,"newWindowLink")){
return;
}
if(_27&&_24&&_24.opensInNewWindow){
_27=_27+" "+_24.opensInNewWindow;
_5.set(_25,"title",_27);
_5.set(_25,"newWindowLink","true");
_5.remove(_25,"aria-label");
}
}
});
}};
});


;define("ic-ee/data/ProfilesRoutes",["dojo/_base/declare","dojo/_base/lang","ic-ui/layout/people","ic-ee/data/AbstractRoutes","ic-ee/util/misc","ic-incontext/util/url","ic-core/config/services"],function(_1,_2,_3,_4,_5,_6,_7){
var _8=_6;
var _9=_5;
var _a=_1("com.ibm.social.ee.data.ProfilesRoutes",_4,{service:"profiles",getNetworkInviteEEUrl:function(_b,_c){
var _d=_9.getItemId(_b);
var _e=_9.getItemId(_c);
var _f=this.getServiceUrl()+(this.oauth?"/oauth":"")+"/app/person/@me/forms/connect/"+_d+"/connection/"+_e;
return _f;
},getUserProfileUrl:function(id){
if(this.isServiceEnabled()){
return _8.rewrite(this.getServiceUrl()+"/html/profileView.do",{userid:id});
}else{
if(_3){
var _10=_3.createLink({userid:id});
if(_10){
return _10.href;
}
}
}
return "";
},getUserPhotoUrl:function(id){
var _11;
if(this.isServiceEnabled()){
_11=_8.rewrite(this.getServiceUrl()+(this.oauth?"/oauth":"")+"/photo.do",{userid:id});
}else{
if(_7.scprofiles){
_11=_8.rewrite(this.getServiceUrl("scprofiles")+"/photo/"+id);
}else{
if(_3){
_11=_3.getImageUrl({userid:id});
}else{
_11=this._getNoPersonPhotoUrl();
}
}
}
if(this.network){
_11=this.network.rewriteUrl(_11);
}
return _11;
},getUserProfileUrlByEmail:function(_12){
return this.isServiceEnabled()?_8.rewrite(this.getServiceUrl()+"/html/profileView.do",{email:_12}):"";
},getUserPhotoUrlByEmail:function(_13){
var tmp=this.isServiceEnabled()?_8.rewrite(this.getServiceUrl()+(this.oauth?"/oauth":"")+"/photo.do",{email:_13}):this._getNoPersonPhotoUrl();
if(this.network){
tmp=this.network.rewriteUrl(tmp);
}
return tmp;
},_getNoPersonPhotoUrl:function(){
var _14=_7.webresources;
if(_14){
return _14[this.isSecure()?"secureUrl":"url"]+"/web/com.ibm.lconn.core.styles.oneui3/images/personNoPhoto128.gif";
}
return "";
}});
return _a;
});


;define("ic-as/util/RouteHelper",["dojo/_base/declare","dojo/_base/lang","ic-as/config/ConfigManager","ic-core/config/services","ic-core/url","ic-ee/data/ProfilesRoutes"],function(_1,_2,_3,_4,_5,_6){
var _7=_1("com.ibm.social.as.util.RouteHelper",null,{useOAuth:false,isAnonymous:false,inited:false,cfg:null,profilesRoutes:null,constructor:function(_8){
if(_8){
_2.mixin(this,_8);
}
},initRouteHelper:function(){
if(this.inited){
return;
}
if(!this.cfg){
this.cfg=_3.getConfigObject();
}
if(this.isGadget){
this.useOAuth=asc.useOAuth||this.useOAuth;
}
this.profilesRoutes=new _6({oauth:this.useOAuth,anonymous:this.isAnonymous,network:this.network});
this.inited=true;
},getBaseOpensocialUrl:function(){
this.initRouteHelper();
var _9=_5.getServiceUrl(_4.opensocial).uri;
if(this.useOAuth){
_9+="/oauth";
}else{
if(this.isAnonymous){
_9+="/anonymous";
}
}
return _9;
},getBaseNewsUrl:function(){
this.initRouteHelper();
var _a=_5.getServiceUrl(_4.news).uri;
if(this.useOAuth){
_a+="/oauth";
}else{
if(this.isAnonymous){
_a+="/anonymous";
}
}
return _a;
},getUblogRelativePath:function(){
this.initRouteHelper();
var _b="";
if(this.useOAuth){
_b+="/oauth";
}else{
if(this.isAnonymous){
_b+="/anonymous";
}
}
_b+="/rest/ublog/";
return _b;
},getProfilesRoutes:function(){
this.initRouteHelper();
return this.profilesRoutes;
},getMBSettingsUrl:function(){
return this.getBaseOpensocialUrl()+"/rest/ublog/@config/settings";
},getMBDeleteUrl:function(id){
return this.getBaseOpensocialUrl()+"/rest/ublog/@me/@all/"+id;
},getMBDeleteCommentUrl:function(id,_c){
return this.getBaseOpensocialUrl()+"/rest/ublog/@me/@all/"+id+"/comments/"+_c;
},getMBCommentLikeUrl:function(_d){
return this.getBaseOpensocialUrl()+"/rest/ublog/@me/@all/"+_d+"/likes";
},getCommentUrl:function(id){
return this.getBaseOpensocialUrl()+"/rest/ublog/@all/@all/"+id+"/comments";
},getCommentSvcRetrievalUrl:function(id,_e,_f){
var url=this.getBaseOpensocialUrl()+"/rest/ublog/@all/@all/"+id+"/comments?sortBy=published&sortOrder=descending";
if(_e){
url+="&startIndex="+_e;
}
if(_f){
url+="&count="+_f;
}
return url;
},getCommentPermittedUrl:function(_10){
return this.getBaseNewsUrl()+"/microblogging/isPermitted.action?action=COMMENT&entityId="+_10;
},getSaveUrl:function(id){
return this.getBaseOpensocialUrl()+"/rest/activitystreams/@me/@all/@all/"+id;
},getUnsaveUrl:function(id){
return this.getBaseOpensocialUrl()+"/rest/activitystreams/@me/@all/@all/"+id;
},getActionRequiredUrl:function(id){
return this.getBaseOpensocialUrl()+"/rest/activitystreams/@me/@all/@all/"+id;
},getActionRequiredInitUrl:function(){
return this.getBaseOpensocialUrl()+"/rest/activitystreams/@me/@actions/@all?count=1";
},getRepostUrl:function(){
return this.getBaseOpensocialUrl()+"/rest/activitystreams/@me/@all/@all";
},getMarkAllReadUrl:function(){
return this.getBaseOpensocialUrl()+"/rest/activitystreams/@me/@all/@all/@all";
},getBadgesDataUrl:function(){
return this.getBaseOpensocialUrl()+"/rest/activitystreams/@me/@all/@all?count=1";
},getBadgeResetUrl:function(id){
return this.getBaseOpensocialUrl()+"/rest/activitystreams/@me/"+id+"/@all?count=1&resetCounter=true";
},getNotificationsForMeUrl:function(){
var url=_5.getServiceUrl(_4.opensocial).uri;
return url+"/rest/activitystreams/@me/@responses/@all";
},getNotificationsLivePreviewPreferences:function(){
var url=_5.getServiceUrl(_4.opensocial).uri;
return url+"/rest/people/@me/@self?fields=userSettings.LIVEPREVIEW_MENTIONS,userSettings.LIVEPREVIEW_NOTIFICATIONS";
},getNotificationsForMeWebUrl:function(){
var url=_5.getServiceUrl(_4.homepage).uri;
return url+"/web/updates/#myNotifications/forme/all";
},getActivityByIDUrl:function(id){
var url=_5.getServiceUrl(_4.opensocial).uri;
return url+"/rest/activitystreams/@me/@all/@all/"+id;
}});
_7._Instance=null;
_7.getInstance=function(){
if(_7._Instance==null){
_7._Instance=new _7();
}
return _7._Instance;
};
return _7;
});


;define("ic-as/util/BaseItemUtil",["dojo","dojo/date/stamp","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/query","dojo/topic","dojo/dom-geometry","ic-as/util/RouteHelper","ic-core/url","ic-core/config/services"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){
var _10=_3("com.ibm.social.as.util.BaseItemUtil",null,{getConnectionsUserId:function(_11){
var ret=_11;
if(ret&&ret.indexOf("urn:lsid:lconn.ibm.com:")!=-1){
var _12=ret.lastIndexOf(":");
if(_12!=-1){
ret=ret.substr(_12+1);
}
}
return ret;
},getPhotoUrl:function(_13){
var _14="";
var _15="";
var _16="";
if(_13){
_15=this.getConnectionsUserId(_13.id);
_16=(_13.image)?_13.image.url:undefined;
}
_14=(_16)?_16:_d.getInstance().getProfilesRoutes().getUserPhotoUrl(_15);
if(!_14){
_14=_e.getServiceUrl(_f.webresources).uri;
_14+="/web/com.ibm.oneui.styles/css/images/profileNoPhoto.gif";
}
return _14;
}});
return _10;
});


;define("ic-as/util/fileviewer/FileViewerUtil",["dojo/_base/declare","dojo/_base/lang","dojo/has"],function(_1,_2,_3){
var _4=_1(null,{fileViewer:undefined,constructor:function(){
},launchFileViewer:function(_5){
this.fileViewer=_2.getObject("lconn.share.fileviewer.ConnectionsFileViewer");
if(this.fileViewer&&_5){
this.fileViewer.openFromUrl(_5);
}else{
throw err("FileViewer not available");
}
},isFileOverlayEnabled:function(_6){
if(typeof activityStreamAbstractHelper!=="undefined"&&activityStreamAbstractHelper.isGadget){
return false;
}
if(_6==="profiles"){
return false;
}
if(_3("fileviewer-everywhere")&&_3("fileviewer-everywhere-activitystream")){
return true;
}
return false;
},isFileOverlayEnabledNC:function(_7){
return (this.isFileOverlayEnabled(_7)&&_3("fileviewer-everywhere-nc"));
}});
_4._Instance=null;
_4.getInstance=function(){
if(_4._Instance==null){
_4._Instance=new _4();
}
return _4._Instance;
};
return _4.getInstance();
});


;define("ic-as/notification/util/keys",[],function(){
var _1={INLINE_MODE:"inline",IFRAME_MODE:"iframe",IFRAME_MODE_MIXED_DOMAIN:"iframeMixedDomain",INLINE_MODE_ONPREM:"inlineOnPrem",TOGGLE_NC:"com/ibm/social/notification/TOGGLE_NC",OPEN_NC:"com/ibm/social/notification/OPEN_NC",CLEARBADGE:"com/ibm/social/as/notification/CLEARBADGE",UPDATEBADGE:"com/ibm/social/as/notification/UPDATEBADGE",SHOWBADGE:"com/ibm/social/as/notification/SHOWBADGE",HIDEBADGE:"com/ibm/social/as/notification/HIDEBADGE",SHOW:"com/ibm/social/as/notification/SHOW",FOCUS:"com/ibm/social/as/notification/FOCUS",FETCHFEED:"com/ibm/social/as/notification/FETCHFEED",FEEDFETCHED:"com/ibm/social/as/notification/FEEDFETCHED",HIDE:"com/ibm/social/as/notification/HIDE",KEYBOARDNAVIGATION:"com/ibm/social/as/notification/KEYBOARDNAVIGATION",NEWNOTIFICATION:"com/ibm/social/as/notification/NEWNOTIFICATION",LIVEPREVIEW_PREF_CHANGE:"com/ibm/social/as/notification/LIVEPREVIEW_PREF_CHANGE"};
return _1;
});


;define("ic-as/notification/util/NCKeys",[],function(){
var _1={OPEN_NC_FLYOUT:"openNCFlyout",CLOSE_NC_FLYOUT:"closeNCFlyout",HANDLE_PUSH_NOTIFICATION:"handlePushNotification",REQUEST_SINGLE_NOTIFICATION:"requestSingleNotification",MARK_ALL_READ:"markallread",SEE_ALL_LINK:"seeAllLink",SETTINGS_LINK:"settingsLink",SCROLLING:"scrolling",MARK_READ_ON_ITEM:"MarkReadOnItem",KEYPRESS_NOTIFICATION_ITEM:"keypressNotificationItem",CLICK_NOTIFICATION_ITEM:"clickNotificationItem"};
return _1;
});


;define("ic-as/util/xhr/DojoXhrHandler",["dojo/request/xhr","ic-incontext/util/url"],function(_1,_2){
return {canSessionTimeout:true,xhr:function(_3,_4){
var _5=_2.getProxifiedURL(_4.url);
_4.method=_3;
var _6=_4.error;
_4.error=function(_7,_8){
if(_8&&_8.xhr&&_8.xhr.status===401){
_7.unauthenticated=true;
}
if(_6){
_6(_7,_8);
}
};
return _1(_5,_4);
}};
});


;define("ic-as/util/xhr/XhrHandler",["dojo","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Deferred","ic-as/util/xhr/DojoXhrHandler"],function(_1,_2,_3,_4,_5,_6){
var _7=false;
return {_queuedRequests:[],noInitTimeout:false,useOauth:false,init:function(_8){
_7=true;
if(this.noInitTimeout){
window.clearTimeout(this.noInitTimeout);
}
this.init=function(){
as_console_debug("com.ibm.social.as.util.xhr.XhrHandler.init called twice!");
};
_8=_8||{};
if(_8.isGadget){
require(["ic-as/util/xhr/OSXhrHandler"],_4.hitch(this,function(_9){
_4.mixin(this,_9);
this.initOSXhrHander();
this.processQueue();
}));
if(_8.useOauth){
this.useOauth=_8.useOauth;
}
}else{
if(_8.xhr){
_4.mixin(this,_8);
}else{
_4.mixin(this,_6);
this.processQueue();
}
}
},processQueue:function(){
_3.forEach(this._queuedRequests,function(_a){
this.xhr.apply(this,_a.args).addCallbacks(_4.hitch(_a.deferred,"callback"),_4.hitch(_a.deferred,"errback"));
},this);
},xhr:function(_b){
var df=new _5();
this._queuedRequests.push({"args":arguments,"deferred":df});
if(!_7&&!this.noInitTimeout){
this.noInitTimeout=window.setTimeout(_4.hitch(this,function(){
_3.forEach(this._queuedRequests,function(_c){
_c.deferred.errback("something is trying to use com.ibm.social.as.util.xhr.XhrHandler without calling init! Call init() with no params to simply use dojo's xhr service");
},this);
as_console_debug("something is trying to use com.ibm.social.as.util.xhr.XhrHandler without calling init! Call init() with no params to simply use dojo's xhr service");
throw new Error("something is trying to use com.ibm.social.as.util.xhr.XhrHandler without calling init! Call init() with no params to simply use dojo's xhr service");
}),3000);
}
return df;
},xhrGet:function(_d){
return this.xhr("GET",_d);
},xhrPost:function(_e){
return this.xhr("POST",_e);
},xhrPut:function(_f){
return this.xhr("PUT",_f);
},xhrDelete:function(_10){
return this.xhr("DELETE",_10);
},xhrHead:function(_11){
this.xhr("HEAD",_11);
}};
});


;define("ic-as/notification/util/MarkReadUtil",["dojo/_base/declare","dojo/_base/json","../../util/xhr/XhrHandler","ic-as/util/RouteHelper"],function(_1,_2,_3,_4){
var _5=_1(null,{markAllNotificationsRead:function(){
var _6=this.generateModelObject(true);
var _7=_4.getInstance().getMarkAllReadUrl();
return this.handleAPICall(_7,_6);
},markNotificationRead:function(id,_8){
var _9=this.generateModelObject(_8);
var _a=_4.getInstance().getActivityByIDUrl(id);
return this.handleAPICall(_a,_9);
},handleAPICall:function(_b,_c){
return _3.xhrPut({url:_b,headers:{"Content-Type":"application/json; charset=utf-8"},data:_2.toJson(_c)});
},generateModelObject:function(_d){
var _e={connections:{read:_d},id:"",actor:{id:""},verb:"",object:{id:""}};
return _e;
}});
_5._Instance=null;
_5.getInstance=function(_f){
if(_5._Instance==null){
_5._Instance=new _5();
}
return _5._Instance;
};
return _5.getInstance();
});


;define("ic-as/item/data/interfaces/INewsDataAccessor",["dojo/_base/declare"],function(_1){
var _2=_1(null,{getId:function(){
},getActor:function(){
},getActorId:function(){
},getActorDisplayName:function(){
},getActorImageUrl:function(){
},getGenerator:function(){
},getGeneratorId:function(){
},getGeneratorDisplayName:function(){
},getGeneratorImageUrl:function(){
},getContent:function(){
},getObject:function(){
},getObjectAuthorId:function(){
},getObjectUrl:function(){
},getPublished:function(){
},getPostedTime:function(){
},getProvider:function(){
},getTarget:function(){
},getTargetId:function(){
},getTargetObjectType:function(){
return (this.target)?this.target.objectType:undefined;
},getTargetUrl:function(){
},getTargetAuthorId:function(){
return (this.target&&this.target.author)?this.target.author.id:undefined;
},getTargetAuthorName:function(){
},getTitle:function(){
},getUpdated:function(){
},getUrl:function(){
},getVerb:function(){
},getActivityType:function(){
},getActivityId:function(){
},getActivityDisplayName:function(){
},getActivityImage:function(){
},getActivityFileAuthorId:function(){
},getActivityFileAuthorName:function(){
},getActivityFileAuthorUrl:function(){
},getActivityFileSize:function(){
},getActivityPublishTime:function(){
},getActivityUrl:function(){
},getActivityFileUrl:function(){
},getActivityTags:function(){
},getActivityReplies:function(){
},getActivityAuthorId:function(){
},getActivityAuthorName:function(){
},getActivityAuthorImage:function(){
},getActivityAuthorImageUrl:function(){
},getActivityIsPublic:function(){
},getActivityMimeType:function(){
},getConnectionsBroadcast:function(){
},getConnectionsShortTitle:function(){
},getConnectionsPlainTitle:function(){
},getConnectionsRead:function(){
},getConnectionsFollowedResource:function(){
},getConnectionsContainerName:function(){
},isConnections:function(){
},isAllMandatorySupplied:function(){
},getActivitySummary:function(){
},getActivitySummaryValidated:function(){
},setActivitySummary:function(_3){
},getActivityAttachments:function(){
},isUrlAttachment:function(){
},getUrlAttachment:function(){
},isStatusUpdate:function(_4){
},isCommunity:function(){
},getCommunityId:function(){
},getActivityLikesCount:function(){
},getActivityLikesItems:function(){
},getBoardUserId:function(){
},getEmbedObject:function(){
},getPermaLink:function(){
},getFilePublshTime:function(){
},getActionLinks:function(){
}});
return _2;
});


;define("ic-as/item/data/NewsDataAccessor",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/has","dojo/query","dojo/io-query","ic-as/config/enablement","ic-as/item/data/interfaces/INewsDataAccessor"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
var _a=_2(_9,{activity:null,activityIsTarget:true,init:function(){
if(this.isConnections()&&this.getTarget()&&this.connections.rollupid==this.getTargetId()){
this.activity=this.getTarget();
}else{
this.activity=this.getObject();
this.activityIsTarget=false;
}
},isActivityTarget:function(){
return this.activityIsTarget;
},getId:function(){
return this.id;
},getActor:function(){
return this.actor||undefined;
},getActorId:function(){
return (this.actor)?this.actor.id:undefined;
},getActorDisplayName:function(){
return (this.actor&&this.actor.displayName)?this.actor.displayName:"";
},getActorImageUrl:function(){
return (this.actor&&this.actor.image)?this.actor.image.url:undefined;
},getGenerator:function(){
return this.generator||undefined;
},getGeneratorId:function(){
return (this.generator)?this.generator.id:undefined;
},getGeneratorDisplayName:function(){
return (this.generator)?this.generator.displayName:undefined;
},getGeneratorImageUrl:function(){
return (this.generator&&this.generator.image)?this.generator.image.url:undefined;
},getContent:function(){
return this.content||"";
},getObject:function(){
return this.object||undefined;
},getObjectAuthorId:function(){
return (this.object&&this.object.author)?this.object.author.id:undefined;
},getObjectUrl:function(){
return (this.object)?this.object.url:undefined;
},getPublished:function(){
return this.published||undefined;
},getPostedTime:function(){
return this.postedTime||undefined;
},getProvider:function(){
return this.provider||undefined;
},getTarget:function(){
return this.target||undefined;
},getTargetId:function(){
return (this.target)?this.target.id:undefined;
},getTargetObjectType:function(){
return (this.target)?this.target.objectType:undefined;
},getTargetUrl:function(){
return (this.target)?this.target.url:undefined;
},getTargetAuthorId:function(){
return (this.target&&this.target.author)?this.target.author.id:undefined;
},getTargetAuthorName:function(){
return (this.target&&this.target.author)?this.target.author.name:undefined;
},getTitle:function(){
return this.title||undefined;
},getUpdated:function(){
return this.updated||undefined;
},getUrl:function(){
return this.url||undefined;
},getVerb:function(){
return this.verb||"";
},getActivityType:function(){
if(this.activity){
var _b=this.activity.type||this.activity.objectType;
return _b||undefined;
}
return undefined;
},getActivityId:function(){
return (this.activity)?this.activity.id:undefined;
},getActivityDisplayName:function(){
return (this.activity)?this.activity.displayName:undefined;
},getActivityImage:function(){
return (this.activity)?this.activity.image:undefined;
},getActivityImageUrl:function(){
return (this.getActivityImage())?this.getActivityImage().url:undefined;
},getActivityMimeType:function(){
return (this.activity)?this.activity.mimeType:undefined;
},getActivityFileAuthorId:function(){
var _c=this.getTargetAuthorId();
return (_c)?_c:this.getActivityAuthorId();
},getActivityFileAuthorName:function(){
var _d=this.getTargetAuthorName();
return (_d)?_d:this.getActivityAuthorName();
},getActivityFileAuthorUrl:function(){
return undefined;
},getActivityFileSize:function(){
return (this.activity)?this.activity.fileSize:undefined;
},getActivityPublishTime:function(){
return (this.activity)?this.activity.published:undefined;
},getActivityUrl:function(){
return (this.activity)?this.activity.url:undefined;
},getActivityFileUrl:function(){
return (this.activity)?this.activity.fileUrl:undefined;
},getActivityTags:function(){
return (this.activity&&this.activity.tags)||[];
},getActivityReplies:function(){
return (this.activity&&this.activity.replies)||undefined;
},getActivityAuthorId:function(){
return (this.activity&&this.activity.author)?this.activity.author.id:undefined;
},getActivityAuthorName:function(){
return (this.activity&&this.activity.author)?this.activity.author.displayName:undefined;
},getActivityAuthorImage:function(){
return (this.activity&&this.activity.author)?this.activity.author.image:undefined;
},getActivityAuthorImageUrl:function(){
return (this.getActivityAuthorImage())?this.getActivityAuthorImage().url:undefined;
},getActivityIsPublic:function(){
return (this.connections)?(this.connections.isPublic==="true"):undefined;
},getConnectionsBroadcast:function(){
return (this.connections)?this.connections.broadcast:undefined;
},getConnectionsShortTitle:function(){
return (this.connections)?this.connections.shortTitle:undefined;
},getConnectionsPlainTitle:function(){
return (this.connections)?this.connections.plainTitle:undefined;
},getConnectionsRead:function(){
return (this.connections)?this.connections.read:undefined;
},getConnectionsFollowedResource:function(){
return (this.connections)?this.connections.followedResource:undefined;
},getConnectionsContainerName:function(){
return (this.connections&&this.connections.containerName)?this.connections.containerName:undefined;
},isConnections:function(){
return (this.connections)?true:false;
},isAllMandatorySupplied:function(){
return (this.getActor()&&this.getPublished());
},getActivitySummary:function(){
return (this.activity)?this.activity.summary:undefined;
},getActivitySummaryValidated:function(){
var _e=this.getActivitySummary();
var _f=null;
if(_e){
var _10=_4.create("div",{innerHTML:_e});
var _11=_5("ie")?_10.innerText:_10.textContent;
_11=_11?_3.trim(_11):null;
if(_11){
_f=_e;
}else{
if(_6("img",_10).length>0){
_f=_e;
}
}
}
return _f;
},setActivitySummary:function(_12){
if(this.activity){
this.activity.summary=_12;
}
},getActivityAttachments:function(){
return (this.activity)?this.activity.attachments:undefined;
},isUrlAttachment:function(){
return (this.activity&&this.activity.attachments)?(this.activity.attachments[0].objectType==="link"):undefined;
},getUrlAttachment:function(){
var _13=this.getActivityAttachments();
if(_13&&_13.length>0){
return _13[0];
}
},isStatusUpdate:function(){
return (this.getConnectionsBroadcast()==="true"&&this.getActivityType()==="note");
},isRepost:function(){
return (this.verb)?(this.verb==="bump"):undefined;
},isCommunity:function(){
return this.getCommunityId()!=null;
},getCommunityId:function(){
return (this.connections&&this.connections.communityid)||null;
},getActivityLikesCount:function(){
return (this.activity&&this.activity.likes)?this.activity.likes.totalItems:undefined;
},getActivityLikesItems:function(){
return (this.activity&&this.activity.likes&&this.activity.likes.items)?this.activity.likes.items:[];
},getBoardUserId:function(){
var _14="";
var _15=this.getTargetObjectType();
if(_15==="person"){
_14=this.getTargetId();
}else{
if(_15==="note"){
var _16=this.getTargetUrl();
if(_16){
var _17=_16.substring(_16.indexOf("?")+1,_16.length);
_14=_7.queryToObject(_17).userid;
}
}
}
return _14;
},getEmbedObject:function(){
return (this.openSocial)?this.openSocial.embed:undefined;
},getPermaLink:function(){
return (this.activity)?this.activity.url:undefined;
},getFilePublshTime:function(){
return this.getActivityPublishTime();
},getActionLinks:function(){
return (this.openSocial)?this.openSocial.actionLinks:undefined;
},isLikeEnabled:function(){
return (this.connections&&this.connections.likeService)?true:false;
},getLikeSvcUrl:function(){
return (this.connections&&this.connections.likeService)?this.connections.likeService:null;
},isSharedExternallyDisabledOnActivityStream:function(){
var asc=window.activityStreamConfig;
return asc&&asc.containerInfo&&asc.containerInfo.disableSharedExternally;
},isActivityExternal:function(){
if(!_8.checkEnablement(_8.AS_SHARED_EXTERNALLY)||this.isSharedExternallyDisabledOnActivityStream()){
return false;
}
return this.activity.connections&&this.activity.connections.isExternal&&this.activity.connections.isExternal==="true";
},isForumsItem:function(){
return this.isFromType("forums");
},isFromType:function(_18){
var _19=this.getGeneratorId();
if(!_19){
return false;
}
return _19===_18;
}});
return _a;
});


;define("ic-as/notification/util/ICNotificationController",["dojo/_base/declare","dojo/_base/lang","dojo/aspect","dojo/on"],function(_1,_2,_3,on){
var _4=_1(null,{_NotificationPermissionGranted:"granted",constructor:function(){
},requestNotificationPermission:function(){
var _5=(window.Notification&&Notification.permission!=="denied")||(window.webkitNotifications&&webkitNotifications.checkPermission()===0);
if(!/[\?&]mode=/.test(window.location.href)&&_5&&Notification.permission=="default"){
Notification.requestPermission();
}
},createNative:function(_6,_7,_8,_9,_a,_b){
if(window.Notification&&Notification.permission===this._NotificationPermissionGranted){
var _c=this.buildHTMLNotificationObject(_7,_8,_b);
var _d=new Notification(_6||"",_c);
if(_a){
setTimeout(function(){
_d.close();
},10000);
}
if(_9){
_d.onclick=function(){
window.location.href=_9;
};
}
return _d;
}else{
this.requestNotificationPermission();
}
},buildHTMLNotificationObject:function(_e,_f,tag){
var _10={lang:"en"};
if(_e){
_10.body=_e;
}
if(_f){
_10.icon=_f;
}
if(tag){
_10.tag=tag;
}
return _10;
}});
_4._Instance=null;
_4.getInstance=function(){
if(_4._Instance==null){
_4._Instance=new _4();
}
return _4._Instance;
};
return _4.getInstance();
});


;define("ic-as/notification/view/NotificationPopupItem",["dojo/_base/declare","ic-as/notification/util/ICNotificationController","../util/keys","dojo/topic"],function(_1,_2,_3,_4){
var _5=_1(null,{title:null,body:null,icon:null,rollupId:null,url:null,constructor:function(_6,_7,_8,_9,_a){
this.title=_6;
this.body=_7;
this.icon=_8;
this.rollupId=_9;
this.url=_a;
},createPopup:function(){
var _b=_2.createNative(this.title,this.body,this.icon,"",true,this.rollupId);
_4.publish(_3.NEWNOTIFICATION,this.title);
var _c=this;
_b.onclick=function(e){
e.preventDefault();
var _d=window.open(_c.url,"_blank");
_d.focus();
return false;
};
}});
return _5;
});


;define("ic-ui/layout/insights/tracker",["dojo/_base/declare","dojo/_base/lang","dijit/_Widget","dojox/lang/functional/object"],function(_1,_2,_3,df){
var _4={};
var _5=_2.mixin(_2.getObject("com.ibm.lconn.layout.insights.tracker",true),{BUTTON_CLICK:"button_click",FORM_SUBMIT:"form_submit",ACTION:"action",track:function(_6,_7){
df.forIn(_4,function(_8,_9){
_8(_6,_7);
});
},register:function(_a,_b){
if(_4[_a]){
throw "Insights plugin '"+_a+"' already registered!";
}
_4[_a]=_b;
},_reset:function(){
_4={};
}});
var _c=_1(_3,{BUTTON_CLICK:_5.BUTTON_CLICK,FORM_SUBMIT:_5.FORM_SUBMIT,ACTION:_5.ACTION,EVENT_PREFIX:"ic",componentName:"",setComponentName:function(_d){
this.componentName=_d;
},register:function(_e,_f){
_5.register(_e,_f);
},track:function(_10,_11){
var _12=[this.EVENT_PREFIX,this.componentName,_10].join(".");
_5.track(_12,_11);
}});
_5.getInstance=function(_13){
return new _c({componentName:_13?_13:""});
};
return _5;
});


;define("ic-ui/layout/insights/debug/NewRelicDebug",["dojo/_base/lang","../tracker","dojox/lang/functional"],function(_1,_2,_3){
var _4="newrelicdebug",_5="insights.newrelic.debug.enabled",_6="insights.newrelic.debug.data";
function _7(){
var _8,_9=[];
try{
_8=localStorage.getItem(_6);
if(_8){
_9=JSON.parse(_8);
}
}
catch(e){
console.warn("Failed to parse existing New Relic debug data as JSON.  Existing data may be lost.",e);
}
if(!(_9 instanceof Array)){
console.warn("Existing New Relic debug data is not an array.  Existing data may be lost.");
_9=[];
}
return _9;
};
function _a(){
localStorage.removeItem(_6);
};
function _b(){
return _1.getObject("localStorage")&&localStorage.getItem(_5);
};
function _c(_d){
if(_d){
localStorage.setItem(_5,"true");
}else{
localStorage.removeItem(_5);
}
};
function _e(_f,_10){
if(!_b()){
return;
}
var _11=_7(),_12,_13;
try{
_12={actionName:_f,timestamp:(new Date()).toISOString(),args:{}};
_3.forIn(_10,function(_14,key){
_12.args[key]=""+_14;
});
_11.push(_12);
json=JSON.stringify(_11);
localStorage.setItem(_6,json);
}
catch(e){
console.warn("Failed to save New Relic debug data as JSON.",e);
}
try{
_13="require([\"ic-ui/layout/insights/tracker\", \"ic-ui/layout/insights/NewRelic\"], function (tracker) { tracker.track(\"${actionName}\", ${args}); });";
_13=_13.replace("${actionName}",_12.actionName);
_13=_13.replace("${args}",JSON.stringify(_12.args));
console.log("Call to New Relic: ",_13);
}
catch(e){
console.warn("Failed to generate real call to ic-ui/layout/insights/tracker",e);
}
};
var _15=_1.mixin(_1.getObject("com.ibm.lconn.layout.insights.debug.NewRelicDebug",true),{name:_4,track:_e,register:function(){
_2.register(_4,_e);
},_getData:_7,_clearData:_a,_isDebugEnabled:_b,_setDebugEnabled:_c});
_15.register();
return _15;
});


;define("ic-ui/layout/insights/NewRelic",["dojo/_base/lang","dojo/_base/config","ic-core/config/features","./tracker","./debug/NewRelicDebug"],function(_1,_2,_3,_4){
var _5="newrelic";
function _6(){
if(_1.getObject("newrelic")&&_1.isFunction(_1.getObject("newrelic.addPageAction"))&&_3("insights-new-relic")){
newrelic.addPageAction.apply(newrelic,arguments);
}else{
if(_2.isDebug){
console.warn("New Relic instrumentation was invoked but is missing");
}
}
};
var _7=_1.mixin(_1.getObject("com.ibm.lconn.layout.insights.NewRelic",true),{name:_5,track:_6,register:function(){
_4.register(_5,_6);
}});
_7.register();
return _7;
});


;define("ic-as/notification/util/NCNewRelic",["dojo/_base/lang","dojox/uuid/generateRandomUuid","ic-ui/layout/insights/tracker","ic-ui/layout/insights/NewRelic","dojo/has","dojo/sniff"],function(_1,_2,_3,_4,_5){
var _6=_5("notification-center-new-relic");
var _7=_2();
var _8="ic.as.nc";
var _9="Action";
var _a,_b;
var _c={track:function(_d,_e){
if(!_3||!_6||!_d){
return;
}
var _f={"defaultType":_9,"ncSession":_7,"ncItemType":(_a&&_a.getActivityType()||""),"ncUnreadNotifications":(_b&&_b.connections.unreadNotifications||""),"ncNumberOfNotifications":(_b&&_b.list.length||"")};
_1.mixin(_f,_e);
_3.track(_8+"."+_d,_f);
},setItem:function(_10){
_a=_10;
},setItems:function(_11){
_b=_11;
},trackNotificationItem:function(_12,_13,_14,_15,_16){
this.track(_12,{"eventType":_13,"ncItemPosition":_14,"ncItemType":_15,"ncVerb":_16});
}};
return _c;
});


;define("ic-as/notification/view/NotificationsItem",["dojo","dojo/dom-attr","dojo/_base/declare","dojo/_base/lang","dojo/date/stamp","dojo/i18n!ic-as/nls/activitystream","dojo/query","dojo/on","dojo/dom-class","dojo/topic","dojo/keys","dijit/_OnDijitClickMixin","dojo/text!./templates/NotificationsItem.html","dijit/_Templated","dijit/_Widget","dojo/_base/event","ic-core/config/features","ic-core/ext/timeago/Timeago","ic-incontext/util/DateFormat","ic-incontext/util/html","ic-as/util/hashtag/HashTagParser","ic-as/util/BaseItemUtil","ic-as/util/fileviewer/FileViewerUtil","../util/keys","../util/NCKeys","../util/MarkReadUtil","../../util/xhr/XhrHandler","../../item/data/NewsDataAccessor","./NotificationPopupItem","../util/NCNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,on,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,_1a,_1b,_1c,_1d){
var _1e=_3("com.ibm.social.as.notification.NotificationsItem",[_e,_d,_14,_15],{templateString:_c,data:null,newsData:null,content:"",time:null,timeString:null,timeSeconds:null,timeago:null,timeagoNode:null,authorImage:null,ariaSummary:null,activitySummary:null,activityTitle:null,authorImageSrc:null,notificationContent:null,strings:_6,helper:null,position:null,postMixInProperties:function(){
this.inherited(arguments);
_3.safeMixin(this.data,new _1b());
this.data.init();
this.newsData=this.data;
_1d.setItem(this.data);
this.time=this.data.getPublished();
this.timeString=this.getDateString(this.strings,this.time);
this.timeSeconds=this.getTimeWithSeconds(this.time).substring(0,11);
this.ariaSummary=this.data.getConnectionsPlainTitle();
if(this.data.getActivitySummary()){
var _1f=this.handleHashTags(this.data.getActivitySummary());
this.activitySummary=(_1f)?"\""+_1f+"\"":"";
}
this.activityTitle=this.data.getTitle();
},handleHashTags:function(_20){
var _21=_20;
if(this.data.getActivityType()==="note"&&this.data.getGeneratorId()==="profiles"){
this.tagsArray=this.getTagsArray(this.data.getActivityTags());
_21=this.parseHashTags(_21,this.tagsArray);
}
return _21;
},postCreate:function(){
this.inherited(arguments);
this.timeago=new _11({},this.timeagoNode);
var _22=this.data.getActor();
_7(".icNote-authorImg",this.domNode).forEach(_4.hitch(this,function(_23){
this.authorImageSrc=this.getPhotoUrl(_22);
_2.set(this.authorImage,"src",this.authorImageSrc);
}));
if(_13.isHighContrast()){
_8.add(this.bluedot,"lotusHidden");
}
this.own(on(this.domNode,"keydown",_4.hitch(this,function(e){
this._onKeyPress(e);
})));
if(_10("news-read-status-enabled")){
if(_13.isHighContrast()){
_8.add(this.bluedot,"lotusHidden");
this.own(on(this.highContrastTextUnread,"click",_4.hitch(this,function(e){
this.handleMarkRead(e);
})),on(this.highContrastTextRead,"click",_4.hitch(this,function(e){
this.handleMarkRead(e);
})));
}else{
_8.remove(this.bluedot,"lotusHidden");
this.own(on(this.bluedot,"click",_4.hitch(this,function(e){
this.handleMarkRead(e);
_1d.trackNotificationItem(_18.MARK_READ_ON_ITEM,e.type,this.position,this.newsData.getActivityType(),this.newsData.getVerb());
})),on(this.bluedot,"blur",_4.hitch(this,function(e){
_8.remove(this.bluedot,"focused");
})),on(this.bluedot,"focus",_4.hitch(this,function(e){
_8.add(this.bluedot,"focused");
})),on(this.bluedot,"keydown",_4.hitch(this,function(e){
if(_a.ENTER===e.keyCode&&!e.shiftKey){
this.handleMarkReadKeyBoard(e);
_1d.trackNotificationItem(_18.MARK_READ_ON_ITEM,e.type,this.position,this.newsData.getActivityType(),this.newsData.getVerb());
}
})));
}
this.setupMarkReadIndicatorWithDefaults();
}
_7("a",this.domNode).forEach(_4.hitch(this,function(_24){
_2.set(_24,"tabindex","0");
}));
},_onKeyPress:function(evt){
if(evt){
this._onFocus();
switch(evt.keyCode){
case _a.UP:
case _a.DOWN:
this.keyboardNavigate(evt.keyCode);
_f.stop(evt);
break;
case _a.ENTER:
case _a.SPACE:
if(evt.target===this.bluedot||evt.target===this.highContrastTextRead||evt.target===this.highContrastTextUnread){
this.handleMarkReadKeyBoard(evt);
}else{
this.onClick(evt);
}
_f.stop(evt);
break;
}
}
},_onFocus:function(e){
_8.add(this.bluedot,"focused");
},_onBlur:function(e){
_8.remove(this.bluedot,"focused");
},setupMarkReadIndicatorWithDefaults:function(){
if(this.data.getConnectionsRead()==="false"){
_8.remove(this.notificationContent,"selected");
}else{
_8.add(this.notificationContent,"selected");
}
this.toggleMarkReadTitle();
},onClick:function(e){
var _25=e.target;
if(this.isMarkUnreadActive()){
this.handleMarkRead();
}
if(e.type==="click"){
_1d.trackNotificationItem(_18.CLICK_NOTIFICATION_ITEM,e.type,this.position,this.newsData.getActivityType(),this.newsData.getVerb());
}else{
_1d.trackNotificationItem(_18.KEYPRESS_NOTIFICATION_ITEM,e.type,this.position,this.newsData.getActivityType(),this.newsData.getVerb());
}
if(this.newsData.getActivityType()=="file"&&_16.isFileOverlayEnabledNC(this.newsData.getGenerator().id)){
try{
_16.launchFileViewer(this.newsData.getActivityFileUrl());
return;
}
catch(err){
}
}
if(this.shouldCancelDefaultOpen(_25.tagName)){
return;
}
window.open(this.data.getActivityUrl(),"_blank");
},shouldCancelDefaultOpen:function(_26){
return ("a"==_26.toLowerCase());
},isMarkUnreadActive:function(){
return (!_8.contains(this.bluedot,"lotusHidden")&&!_8.contains(this.notificationContent,"selected"));
},handleMarkReadKeyBoard:function(e){
this.handleMarkRead(e);
},keyboardNavigate:function(_27){
_9.publish(_17.KEYBOARDNAVIGATION,this.domNode,_27);
},handleMarkRead:function(e){
this.data.connections.read=(this.data.getConnectionsRead()==="true")?"false":"true";
var _28=_19.markNotificationRead(this.data.getId(),this.data.connections.read);
_28.then(_4.hitch(this,function(_29){
_8.toggle(this.notificationContent,"selected");
this.toggleMarkReadTitle();
}),function(_2a){
console.log(_2a);
});
if(e){
_f.stop(e);
}
},toggleMarkReadTitle:function(){
if(_13.isHighContrast()){
if(_8.contains(this.notificationContent,"selected")){
_8.remove(this.highContrastTextRead,"lotusHidden");
_8.add(this.highContrastTextUnread,"lotusHidden");
}else{
_8.add(this.highContrastTextRead,"lotusHidden");
_8.remove(this.highContrastTextUnread,"lotusHidden");
}
}else{
if(_8.contains(this.notificationContent,"selected")){
_2.set(this.bluedot,"title",this.strings.markUnread);
}else{
_2.set(this.bluedot,"title",this.strings.markRead);
}
}
},setMarkRead:function(){
_2.set(this.bluedot,"title",this.strings.markUnread);
_8.add(this.notificationContent,"selected");
},getDateString:function(_2b,_2c,_2d){
_2d=_2d||{};
var _2e=_5.fromISOString(_2c);
var df=new _12(_2e,_2d);
return df.formatByAge({DAY:_2b.timeDay,MONTH:_2b.timeMonth,TODAY:_2b.timeToday,YEAR:_2b.timeYear,YESTERDAY:_2b.timeYesterday,TOMORROW:_2b.timeTomorrow});
},getTimeWithSeconds:function(_2f){
var _30=_5.fromISOString(_2f);
var df=new _12(_30);
return df.time_long();
},generateNotificationPopup:function(){
return new _1c(this.data.getConnectionsPlainTitle(),"",this.authorImageSrc,this.data.getActivityId(),this.data.getActivityUrl());
}});
return _1e;
});


;define("ic-as/notification/util/MessageTransport",["dojo/_base/declare","dojo/topic","ic-as/notification/util/keys"],function(_1,_2,_3){
var _4=_1("com.ibm.social.as.notification.util.MessageTransport",null,{mode:_3.INLINE_MODE,constructor:function(_5){
this.mode=_5;
},sendMessage:function(_6,_7){
if(this.mode===_3.IFRAME_MODE){
if(window.parent&&window.parent.postMessage){
window.parent.postMessage(this.constructWindowMessage(_6,_7),"*");
}
}
_2.publish(_6,_7);
},constructWindowMessage:function(_8,_9){
var _a=_8+"|";
if(_9){
_a+=_9;
}
return _a;
}});
_4._Instance=null;
_4.getInstance=function(_b){
if(_4._Instance==null){
_4._Instance=new _4(_b);
}
return _4._Instance;
};
return _4;
});


;define("dojo/text!ic-as/notification/view/templates/NoNotificationView.html", '<div>\n       <div class="icBanner-NoNotification-bee" data-dojo-attach-point="notificationBee"> ${!beeIcon}</div>\n       <div class="icBanner-NoNotification" id="icBanner-NoNotification" tabindex="0">${strings.noNewNotifications}</div>\n</div>');

;define("dojo/text!ic-as/notification/icons/bee_large.svg", '<svg alt="" version="1.1" class="bee" id="Layer_1_bee" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\r\n	 viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve">\r\n<g>\r\n	<path d="M47.373,54h33.254c-3.586-4.822-9.692-8-16.627-8C57.064,46,50.959,49.178,47.373,54z"/>\r\n	<path d="M44.131,62C44.047,62.656,44,63.324,44,64v6h40v-6c0-0.676-0.047-1.344-0.131-2H44.131z"/>\r\n	<path d="M44,84c0,0.676,0.047,1.344,0.131,2h39.738C83.953,85.344,84,84.676,84,84v-6H44V84z"/>\r\n	<path d="M64,102c6.935,0,13.041-3.178,16.627-8H47.373C50.959,98.822,57.064,102,64,102z"/>\r\n	<path d="M12.922,58.197c-1.703,0.707-3.305,1.746-4.689,3.131c-1.387,1.387-2.424,2.984-3.131,4.688\r\n		c-0.733,1.77-1.104,3.65-1.102,5.531c-0.002,1.887,0.369,3.766,1.102,5.533c0.707,1.709,1.744,3.305,3.131,4.689\r\n		c1.385,1.387,2.986,2.424,4.688,3.133C14.678,85.629,16.551,86,18.424,86c0.01,0,0.02,0,0.029,0c0.01,0,0.02,0,0.029,0\r\n		c1.871,0,3.742-0.371,5.502-1.102c1.707-0.705,3.303-1.744,4.688-3.129c1.385-1.385,2.426-2.982,3.133-4.689L44,46L12.922,58.197z\r\n		 M28.096,75.581c-0.528,1.263-1.286,2.394-2.253,3.36c-0.974,0.974-2.113,1.734-3.392,2.263C21.178,81.732,19.843,82,18.482,82\r\n		h-0.059c-1.363,0-2.701-0.268-3.965-0.79c-1.287-0.536-2.429-1.299-3.4-2.271c-0.971-0.971-1.732-2.11-2.262-3.391\r\n		C8.267,74.27,7.998,72.924,8,71.543c-0.002-1.371,0.267-2.716,0.796-3.994c0.531-1.279,1.293-2.42,2.265-3.392\r\n		c0.962-0.962,2.093-1.719,3.361-2.251l22.505-8.833L28.096,75.581z"/>\r\n	<path d="M122.898,66.016c-0.707-1.703-1.744-3.301-3.131-4.688c-1.385-1.385-2.986-2.424-4.689-3.131L84,46l12.195,31.08\r\n		c0.707,1.707,1.748,3.305,3.133,4.689c1.385,1.385,2.98,2.424,4.688,3.129c1.76,0.73,3.631,1.102,5.502,1.102\r\n		c0.01,0,0.02,0,0.029,0c0.01,0,0.02,0,0.029,0c1.873,0,3.746-0.371,5.504-1.098c1.701-0.709,3.303-1.746,4.688-3.133\r\n		c1.387-1.385,2.424-2.98,3.131-4.689c0.732-1.768,1.104-3.646,1.102-5.533C124.002,69.666,123.631,67.785,122.898,66.016z\r\n		 M119.202,75.551c-0.528,1.278-1.29,2.418-2.265,3.393c-0.967,0.968-2.109,1.73-3.385,2.262c-1.275,0.527-2.613,0.795-3.976,0.795\r\n		h-0.059c-1.361,0-2.696-0.268-3.975-0.799c-1.272-0.525-2.412-1.286-3.386-2.26c-0.967-0.967-1.725-2.098-2.253-3.36l-8.832-22.509\r\n		l22.505,8.833c1.268,0.532,2.399,1.289,3.361,2.251c0.972,0.973,1.734,2.113,2.264,3.389c0.53,1.282,0.799,2.627,0.797,4.006\r\n		C120.001,72.924,119.733,74.27,119.202,75.551z"/>\r\n	<path d="M54,42c4.418,0,8-3.58,8-8s-3.582-8-8-8s-8,3.58-8,8S49.582,42,54,42z M54,30c2.206,0,4,1.795,4,4s-1.794,4-4,4\r\n		c-2.206,0-4-1.795-4-4S51.794,30,54,30z"/>\r\n	<path d="M74,42c4.418,0,8-3.58,8-8s-3.582-8-8-8s-8,3.58-8,8S69.582,42,74,42z M74,30c2.206,0,4,1.795,4,4s-1.794,4-4,4\r\n		c-2.206,0-4-1.795-4-4S71.794,30,74,30z"/>\r\n</g>\r\n</svg>\r\n');

;define("ic-as/notification/view/NoNotificationView",["dojo/_base/declare","dojo/i18n!ic-as/nls/activitystream","dojo/text!./templates/NoNotificationView.html","dijit/_Templated","dijit/_Widget","dojo/has","dojo/dom-class","dojo/text!../icons/bee_large.svg"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9=_1([_5,_4],{beeIcon:_8,templateString:_3,strings:_2,notificationBee:null,postCreate:function(){
this.inherited(arguments);
if(_6("ie")<9){
beeIcon="";
_7.add(this.notificationBee,"icon");
}else{
_7.add(this.notificationBee,"svg");
}
}});
return _9;
});


;define("dojo/text!ic-as/trending/templates/inlineTagList.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="lotusFilters2 lotusHidden">\n	<div class="lotusSearchFilterSection">\n		<span data-dojo-attach-point="descNode">${bundle.nlsStrings.matching}</span>\n		<ul class="lotusInlinelist" role="listbox" aria-label="hashtag filters" tabindex="0" data-dojo-attach-point="selectedListNode">\n		</ul>\n	\n	</div>\n</div>\n');

;define("ic-as/util/Localizer",["dojo","dojo/_base/declare","dojo/i18n","dojo/i18n!ic-as/nls/activitystream","dojo/string"],function(_1,_2,_3,_4,_5){
var _6=_2("com.ibm.social.as.util.Localizer",null,{bundle:{_initialized:false},constructor:function(){
if(!this.bundle._initialized){
this.bundle.nlsStrings=_4;
this.bundle._initialized=true;
}
},getLocalizedString:function(_7,_8){
var _9=this.bundle.nlsStrings[_7];
return (_8)?_5.substitute(_9,_8):_9;
},postMixInProperties:function(){
this.inherited(arguments);
this.localizeStrings();
},localizeStrings:function(){
}});
return _6;
});


;define("ic-as/trending/InlineTagList",["dojo","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-construct","dojo/on","dojo/query","dojo/keys","dojo/text!ic-as/trending/templates/inlineTagList.html","dijit/_Templated","dijit/_Widget","dijit/registry","ic-as/util/Localizer"],function(_1,_2,_3,_4,_5,_6,on,_7,_8,_9,_a,_b,_c,_d){
var _e=_3("com.ibm.social.as.trending.InlineTagList",[_b,_a,_d],{templateString:_9,selectedTags:null,inlineTagClass:"com.ibm.social.as.trending.InlineSelectedTag",selectedListNode:null,descNode:null,postCreate:function(){
this.own(_2.after(this.selectedTags,"add",_4.hitch(this,"addSelectedTag"),true));
this.containerNode=this.domNode;
this.own(on(this.selectedListNode,"keypress",_4.hitch(this,"onKeyPress")));
this.own(_2.after(this.selectedTags,"remove",_4.hitch(this,"checkSelectedNode"),true));
},addSelectedTag:function(_f){
this.checkSelectedNode();
var _10=_4.getObject(this.inlineTagClass);
var _11=new _10({label:_f});
_6.place(_11.domNode,this.selectedListNode);
_11.connect(_11.deleteLink,"onclick",_4.hitch(this,"unSelectTag",_f));
_11.connect(_11.deleteLink,"onkeypress",_4.hitch(_11,"onKeyPress"));
_11.connect(this.selectedTags,"remove",function(_12){
if(_12===_f){
if(_11.hasPrevious()){
_11.focusPrevious();
}else{
if(_11.hasNext()){
_11.focusNext();
}
}
_11.destroy();
}
});
_11.focus();
},checkSelectedNode:function(){
var _13=this.selectedTags.getArray().length;
if(_13==0){
_5.add(this.domNode,"lotusHidden");
}else{
_5.remove(this.domNode,"lotusHidden");
if(_13==1){
this.descNode.innerHTML=this.bundle.nlsStrings.matching;
}else{
this.descNode.innerHTML=this.bundle.nlsStrings.matchingAllOf;
}
}
},unSelectTag:function(tag){
this.selectedTags.remove(tag);
},onKeyPress:function(_14){
var _15=_8;
switch(_14.keyCode){
case _15.DOWN_ARROW:
this._focusFirstItem();
}
},_focusFirstItem:function(){
var _16=this.selectedTags.getArray().length;
if(_16>0){
var _17=_7("li",this.selectedListNode);
if(_17.length>0){
var _18=_17[0];
if(_18){
var _19=_c.byId(_18.widgetid||_18.id);
if(_19){
_19.focus();
}
}
}
}
}});
return _e;
});


;define("ic-as/util/EventedArray",["dojo/_base/array","dojo/_base/declare"],function(_1,_2){
var _3=_2("com.ibm.social.as.util.EventedArray",[],{arr:null,isUpdating:false,constructor:function(_4){
this.arr=_4||[];
},add:function(_5,_6){
this.notUpdating();
_6=typeof _6!=="undefined"?_6:this.arr.length;
this.arr.splice(_6,0,_5);
},remove:function(_7){
this.notUpdating();
if(_1.indexOf(this.arr,_7)!==-1){
this.arr.splice(_1.indexOf(this.arr,_7),1);
}
},replaceWith:function(_8){
this.notUpdating();
var _9=this.arr.length;
while(_9--){
if(_1.indexOf(_8,this.arr[_9])===-1){
this.remove(this.arr[_9]);
}
}
_1.forEach(_8,function(_a,_b){
if(_1.indexOf(this.arr,_a)===-1){
this.add(_a,_b);
}
},this);
},setUpdating:function(){
this.isUpdating=true;
},notUpdating:function(){
this.isUpdating=false;
},getArray:function(){
return this.arr;
}});
return _3;
});


;define("ic-core/util/EventMixin",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/aspect"],function(_1,_2,_3,_4){
var _5=_2("lconn.core.util.EventMixin",null,{disconnectionFuncName:"destroy",subscribe:function(){
var _6=[];
this.subscribe=function(){
return _6.push(_1.subscribe.apply(_1,arguments));
};
_4.after(this,this.disconnectionFuncName,_3.hitch(null,function(){
var _7;
while(_7=_6.pop()){
_7.remove();
}
}),true);
return this.subscribe.apply(this,arguments);
},connect:function(){
var _8=[];
this.connect=function(){
return _8.push(_1.connect.apply(_1,arguments));
};
_4.after(this,this.disconnectionFuncName,_3.hitch(null,function(){
var _9;
while(_9=_8.pop()){
_9.remove();
}
}),true);
return this.connect.apply(this,arguments);
}});
return _5;
});


;define("ic-as/util/hashtag/search/ActivityStreamSearchHashtag",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/aspect","dojo/dom-construct","dojo/json","dojo/query","ic-as/constants/events","ic-as/trending/InlineTagList","ic-as/util/EventedArray","ic-core/config/properties","ic-core/util/EventMixin"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
var _d=_2(_c,{inlineListDijit:null,init:false,selectedTags:null,dateReqString:null,calledUpdateState:false,onLoad:function(){
this.selectedTags=new _a();
this.selectedTags.replaceWith([]);
this.own(_4.after(this.selectedTags,"add",_3.hitch(this,"addTagStream"),true));
this.own(_4.after(this.selectedTags,"remove",_3.hitch(this,"removeTagStream"),true));
var _e=_7("div.lotusStreamTopLoading")[0];
this.inlineListDijit=this.inlineListDijit||new _9({"selectedTags":this.selectedTags,"inlineTagClass":"com.ibm.social.as.util.hashtag.search.InlineSelectedHashtag"},_5.create("div",{},_e,"before"));
this.subscribe(_8.UPDATESTATE,_3.hitch(this,"onStateUpdate"));
this.init=true;
},onStateUpdate:function(){
this.calledUpdateState=true;
this.selectedTags.replaceWith([]);
},addSearchTag:function(_f){
if(!this.init){
this.onLoad();
}
this.calledUpdateState=false;
var _10=this.selectedTags.getArray();
if(_1.indexOf(_10,_f)>=0){
this.selectedTags.remove(_f);
}
this.selectedTags.add(_f);
},removeTagStream:function(){
this.updateStream(false);
},addTagStream:function(){
this.updateStream(true);
},updateStream:function(_11){
if(this.calledUpdateState){
return;
}
var _12={"filters":this.makeFiltersString()};
if(this.dateReqString){
_12["dateFilter"]=this.dateReqString;
}
this.setStreamFilteredEvent();
topic.publish(_8.CLOSEEE);
topic.publish(_8.PARAMCHANGE,_12,_11);
},setStreamFilteredEvent:function(){
if(this.selectedTags.getArray().length>0){
topic.publish(_8.ASSTREAMFILTERED,true);
}else{
topic.publish(_8.ASSTREAMFILTERED,false);
}
},publishViewChange:function(_13,_14){
this.calledUpdateState=true;
topic.publish(_8.UPDATESTATE,{view:_13,filter:_14});
},makeFiltersString:function(){
var _15=[];
_1.forEach(this.selectedTags.getArray(),function(tag){
_15.push({"type":"tag","values":[tag]});
});
return _6.stringify(_15);
}});
_d._Instance=null;
_d.getInstance=function(){
if(_d._Instance==null){
_d._Instance=new _d();
}
return _d._Instance;
};
return _d;
});


;define("ic-as/util/LinkTarget",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dojo/query","ic-as/config/enablement","ic-as/config/ConfigManager","ic-as/util/hashtag/search/ActivityStreamSearchHashtag"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9=_2("com.ibm.social.as.util.LinkTarget",null,{linkTarget:"_blank",anchorTarget:"",postMixInProperties:function(){
this.inherited(arguments);
this.anchorTarget=this.getActivityStreamTarget();
},modifyContentLinkTargets:function(_a){
_5(".asLinkContainer",_a).query("a").forEach(_3.hitch(this,function(_b,_c){
var _d=_4.get(_b,"href");
if(!_d||(_d&&_d.indexOf("javascript:")!=0)){
_4.set(_b,"target",this.getLinkTarget());
}
_d=null;
_b=null;
}));
if(_6.checkEnablement(_6.AS_HASHTAG_SEARCH)){
this.modifyHashtagSearchLinks(_a);
}
_a=null;
},modifyHashtagSearchLinks:function(_e){
var _f=_5("a.hashtagSearchLink",_e).forEach(_3.hitch(this,function(_10,_11){
if(_10){
this.connect(_10,"onclick","handleHashtagSearch");
}
_10=null;
}));
_e=null;
},handleHashtagSearch:function(e){
var _12=e.target;
var _13=_4.get(_12,"tag");
_8.getInstance().addSearchTag(_13);
},getActivityStreamTarget:function(){
return "target="+"'"+this.getLinkTarget()+"'";
},getLinkTarget:function(){
return _7?_7.getLinkTarget():this.linkTarget;
}});
return _9;
});


;define("ic-as/notification/view/NotificationsFlyout",["dojo","dojo/dom-construct","dojo/_base/declare","dojo/i18n!ic-as/nls/activitystream","dojo/_base/array","dojo/_base/lang","dojo/dom-class","dojo/on","dojo/dom","dojo/text!./templates/NotificationsFlyout.html","dojo/topic","dojo/date","dojo/date/stamp","dojo/_base/event","dojo/dom-style","dojo/keys","dijit/_Templated","dijit/_Widget","dijit/registry","ic-core/config/features","./NotificationsItem","../util/MessageTransport","../util/keys","../util/NCKeys","../util/MarkReadUtil","./NoNotificationView","ic-as/util/LinkTarget","ic-as/util/RouteHelper","ic-core/url","ic-core/config/services","../util/NCNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,on,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,_1a,_1b,_1c,_1d,_1e){
var _1f=_3("com.ibm.social.as.notification.NotificationsFlyout",[_11,_10,_1a],{templateString:_9,allNotificationsUrl:null,NotificationsFeed:null,notificationItem:null,newNotifications:null,NotificationCount:0,settingsUrl:null,ncMode:null,defaultPageSize:null,pagingFinished:false,noNotificationWidget:null,readAllAction:null,helper:null,ncPosition:null,isPaging:false,allowScrollCheck:false,strings:_4,postMixInProperties:function(){
this.allNotificationsUrl=_1b.getInstance().getNotificationsForMeWebUrl();
var _20=_1c.getServiceUrl(_1d.homepage).uri;
this.settingsUrl=_1c.getServiceUrl(_1d.news).uri;
this.inherited(arguments);
},postCreate:function(){
this.inherited(arguments);
if(_13("news-read-status-enabled")){
_7.remove(this.readAllAction,"lotusHidden");
this.own(on(this.readAllAction,"click",_6.hitch(this,function(e){
this.handleMarkAllRead(e);
_1e.track(_17.MARK_ALL_READ,{eventType:e.type});
})),on(this.readAllAction,"keypress",_6.hitch(this,function(e){
if(_f.ENTER===e.keyCode&&!e.shiftKey){
this.handleMarkAllRead(e);
_1e.track(_17.MARK_ALL_READ,{eventType:e.type});
}
})),on(this.readAllAction,"keydown",_6.hitch(this,function(e){
if(_f.ENTER===e.keyCode&&!e.shiftKey){
this.handleMarkAllRead(e);
_1e.track(_17.MARK_ALL_READ,{eventType:e.type});
}
})));
}
if(this.ncMode&&this.ncMode===_16.IFRAME_MODE){
_7.add(this.domNode,"icBanner-frame");
}
if(_13("ie")<=8){
_7.add(this.domNode,"ie8");
}
if(_13("ie")){
this.own(on(this.domNode,"focusout",_6.hitch(this,"handleFocusOut")));
}
this.own(on(this.domNode,"mouseleave",_6.hitch(this,"handleMouseOut")),on(this.domNode,"keypress",_6.hitch(this,function(evt){
switch(evt.keyCode){
case _f.ESCAPE:
this.hide(true);
break;
}
})),on(this.seeAllLink,"keypress",_6.hitch(this,function(evt){
if(_f.TAB===evt.keyCode&&!evt.shiftKey){
_1e.track("seeAllLink",{eventType:evt.type});
this.focusTopLevel();
if(evt){
_d.stop(evt);
}
}
})),on(this.readAllAction,"keypress",_6.hitch(this,function(evt){
if(_f.TAB===evt.keyCode&&evt.shiftKey){
this.focusBottomLevel();
if(evt){
_d.stop(evt);
}
}
})),on(this.seeAllLink,"click",_6.hitch(this,function(evt){
_1e.track(_17.SEE_ALL_LINK,{eventType:evt.type});
})),on(this.settingsLink,"click",_6.hitch(this,function(evt){
_1e.track(_17.SETTINGS_LINK,{eventType:evt.type});
})),_a.subscribe(_16.FOCUS,_6.hitch(this,"focusTopLevel")));
},loadStreamMore:function(){
this.allowScrollCheck=false;
this.isPaging=true;
var _21=this.getCurrentLastItem();
var _22=_21.published;
_a.publish(_16.FETCHFEED,_22);
},destroyContent:function(){
_5.forEach(_12.findWidgets(this.notificationItem),function(_23){
_23.destroyRecursive();
});
if(this.noNotificationWidget){
this.noNotificationWidget.destroy();
}
_2.empty(this.notificationItem);
this.NotificationsFeed=undefined;
},showLoader:function(){
if(this.loadingNode){
_7.remove(this.loadingNode,"lotusHidden");
}
},hideLoader:function(){
if(this.loadingNode){
_7.add(this.loadingNode,"lotusHidden");
}
},setupNotificationCenterContent:function(_24){
if(_24){
this.destroyContent();
this.showLoader();
}
},renderNotificationsItems:function(_25){
if(_25.connections.unreadNotifications>0){
this.newNotifications=_1.string.substitute(this.strings.newNotifications,[_25.connections.unreadNotifications]);
}
if(!this.pagingFinished){
this.NotificationsFeed=_25.list;
if(this.NotificationsFeed!=null&&this.NotificationsFeed.length>0){
var _26=document.createDocumentFragment();
_5.forEach(this.NotificationsFeed,_6.hitch(this,function(_27){
this.NotificationCount++;
var _28=new _14({position:this.NotificationCount,data:_27,helper:this.helper});
_26.appendChild(_28.domNode);
}));
_2.place(_26,this.notificationItem);
}else{
if(!this.isPaging){
this.noNotificationWidget=new _19();
_2.place(this.noNotificationWidget.domNode,this.contentNode);
}
}
}
if(this.isLastPage(_25)){
this.pagingFinished=true;
}
this.hideLoader();
this.allowScrollCheck=true;
this.modifyContentLinkTargets(this.domNode);
},pushNotification:function(_29){
var _2a=new _14({data:_29,helper:this.helper});
_1e.trackNotificationItem(_17.REQUEST_SINGLE_NOTIFICATION,"push","",_29.object.objectType,_29.verb);
var _2b=_2a.generateNotificationPopup();
_2b.createPopup();
_2a.destroy();
},isLastPage:function(_2c){
if(_2c){
if(_2c.itemsPerPage<this.defaultPageSize){
return true;
}
}
return false;
},getCurrentLastItem:function(){
if(this.NotificationsFeed){
return this.NotificationsFeed[this.NotificationsFeed.length-1];
}
},checkScroll:function(){
var _2d=25;
if(!this.pagingFinished&&this.allowScrollCheck&&(this.contentNode.scrollTop>=this.contentNode.scrollHeight-this.contentNode.clientHeight-_2d)){
this.loadStreamMore();
_1e.track(_17.SCROLLING);
}
},show:function(e){
this.showFlyoutDom();
if(e){
_d.stop(e);
}
_15.getInstance().sendMessage(_16.SHOW);
this.focusTopLevel();
},hide:function(_2e){
_15.getInstance().sendMessage(_16.HIDE,_2e);
},showFlyoutDom:function(){
_7.remove(this.domNode,"lotusHidden");
},hideFlyoutDom:function(){
_7.add(this.domNode,"lotusHidden");
},focusTopLevel:function(){
this.readAllAction.focus();
},focusBottomLevel:function(){
this.seeAllLink.focus();
},toggle:function(e){
if(_7.contains(this.domNode,"lotusHidden")){
this.show(e);
}else{
this.hide();
}
},resetPaging:function(){
this.pagingFinished=false;
},handleMarkAllRead:function(e){
var _2f=_18.markAllNotificationsRead();
_2f.then(_6.hitch(this,function(_30){
this.markAllNotificationsRead();
}),function(_31){
console.log(_31);
});
if(e){
_d.stop(e);
}
},markAllNotificationsRead:function(){
_5.some(_12.findWidgets(this.notificationItem),function(_32){
if(_32.setMarkRead){
_32.setMarkRead();
}
});
},handleMouseOut:function(e){
setTimeout(_6.hitch(this,function(){
this.hide();
}),400);
if(e){
_d.stop(e);
}
},handleFocusOut:function(e){
var _33=null;
if(_13("ie")<=8){
_33=e.toElement;
}else{
_33=e.relatedTarget;
}
if(_8.isDescendant(_33,this.domNode)){
if(e){
_d.stop(e);
}
return;
}
this._onBlur(e);
},_onBlur:function(e){
setTimeout(_6.hitch(this,function(){
this.hide();
}),200);
if(e&&e.preventDefault){
_d.stop(e);
}
}});
return _1f;
});


;define("ic-as/util/badging/BadgingUtil",["dojo/_base/declare","dojo/_base/lang","dojo/topic","ic-as/constants/events","ic-as/util/RouteHelper","ic-as/util/xhr/XhrHandler"],function(_1,_2,_3,_4,_5,_6){
var _7=_1(null,{subscriptionHandle:null,constructor:function(){
this.subscriptionHandle=_3.subscribe(_4.BADGE_RESET_AMD,_2.hitch(this,"resetBadge"));
},resetBadge:function(id){
var _8=_5.getInstance().getBadgeResetUrl(id);
_6.xhrGet({url:_8,handleAs:"json",preventCache:true}).then(function(_9){
},function(_a){
console.log(_a);
});
},destroy:function(){
this.subscriptionHandle.remove();
}});
_7._Instance=null;
_7.getInstance=function(){
if(_7._Instance==null){
_7._Instance=new _7();
}
return _7._Instance;
};
return _7.getInstance();
});


;define("ic-as/notification/badging/NotificationCenterBadgeController",["dojo/_base/declare","dojo/_base/lang","dojo/topic","ic-as/notification/util/MessageTransport","ic-as/notification/util/keys","ic-as/constants/events","ic-as/util/badging/BadgingUtil"],function(_1,_2,_3,_4,_5,_6,_7){
var _8=_1("com.ibm.social.as.notification.badging.NotificationCenterBadgeController",null,{currentCount:0,constructor:function(_9){
if(_9){
_2.mixin(this,_9);
}
_3.subscribe(_5.FEEDFETCHED,_2.hitch(this,"clearBadge"));
_3.subscribe(_6.BADGE_RESET,_2.hitch(this,"checkBadge"));
_3.subscribe(_6.BADGE_SYNC_MY_NOTIFICATIONS,_2.hitch(this,"updateBadging"));
},checkBadge:function(_a){
if(_a==="@responses"){
this.clearBadge();
}
},getCount:function(){
return this.currentCount;
},incrementBadging:function(){
this.currentCount=this.currentCount+1;
_4.getInstance().sendMessage(_5.UPDATEBADGE,this.currentCount);
},showBadge:function(){
_4.getInstance().sendMessage(_5.SHOWBADGE);
},hideBadge:function(){
_4.getInstance().sendMessage(_5.HIDEBADGE);
},updateBadging:function(_b){
if(_b!==undefined){
this.currentCount=_b;
_4.getInstance().sendMessage(_5.UPDATEBADGE,_b);
}
},updateASSideNavBadging:function(_c){
if(_c!==undefined){
_3.publish(_6.BADGE_UPDATE_MY_NOTIFICATIONS,_c.viewCounts.notifications);
_3.publish(_6.BADGE_UPDATE_MENTIONS,_c.viewCounts.mentions);
}
},setBadgeForReset:function(){
this.resetBadge=true;
},clearBadge:function(){
if(this.currentCount!==0){
this.updateBadging(0);
this.hideBadge();
_3.publish(_6.BADGE_RESET_AMD,"@responses");
_3.publish(_6.BADGE_UPDATE_MY_NOTIFICATIONS,0);
}
}});
_8._Instance=null;
_8.getInstance=function(){
if(_8._Instance==null){
_8._Instance=new _8();
}
return _8._Instance;
};
return _8.getInstance();
});


;define("dojo/text!ic-as/notification/badging/templates/NotificationCenterBadge.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div>\n    <div data-dojo-attach-point="ncBadge" id="ncBadge" aria-hidden="true" class="lotusAccess notificationCenter">${ariaLabelNotifications}</div>\n	<div data-dojo-attach-point="notificationCenterBadge" role="alert" aria-live="polite" aria-label="${ariaLabelNotifications}" class="icBanner-badge lotusHidden">0</div>\n	<div class="lotusAccess" data-dojo-attach-point="ariaNewNotification" role="alert" aria-live="polite"></div>\n	<span aria-hidden="true" class="lotusAccess notificationCenter" id="arialabelNotificationsFlyoutBadge">${strings.ariaNotificationCenter}</span>\n</div>');

;define("ic-as/notification/badging/NotificationCenterInlineBadge",["dojo/_base/declare","dojo/string","dojo/_base/lang","dojo/dom-class","dojo/dom-style","dojo/i18n!ic-as/nls/activitystream","dojo/text!ic-as/notification/badging/templates/NotificationCenterBadge.html","dijit/_Templated","dijit/_Widget","dojo/topic","ic-as/notification/util/keys"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
var _c=_1("com.ibm.social.as.notification.badging.NotificationCenterInlineBadge",[_9,_8],{templateString:_7,maxBadgeNum:99,maxBadgeNumStr:"99+",strings:_6,postMixInProperties:function(){
this.inherited(arguments);
this.ariaLabelNotifications=this.strings.newNotifications.substring(5);
},postCreate:function(){
this.inherited(arguments);
this.subscribe(_b.UPDATEBADGE,_3.hitch(this,this.updateBadging));
this.subscribe(_b.SHOWBADGE,_3.hitch(this,this.showBadge));
this.subscribe(_b.HIDEBADGE,_3.hitch(this,this.hideBadge));
this.subscribe(_b.NEWNOTIFICATION,_3.hitch(this,this.updateNewNotificationAria));
},updateNewNotificationAria:function(_d){
if(_d){
setTimeout(_3.hitch(this,function(){
var _e=_2.substitute(this.strings.ariaNewNotification,[_d]);
this.updateTextNode(this.ariaNewNotification,_d);
}),2000);
}
},updateBadging:function(_f){
if(_f>0){
this._updateBadgeNumber(_f);
this.showBadge();
}else{
this.hideBadge();
setTimeout(_3.hitch(this,function(){
this._updateBadgeNumber(_f);
}),1500);
}
},_updateBadgeNumber:function(_10){
var _11="";
if(_10>this.maxBadgeNum){
this.updateTextNode(this.notificationCenterBadge,this.maxBadgeNumStr);
_11=_2.substitute(this.strings.newNotifications,[this.maxBadgeNumStr]);
this.updateTextNode(this.ncBadge,_11);
}else{
this.updateTextNode(this.notificationCenterBadge,_10);
_11=_2.substitute(this.strings.newNotifications,[_10]);
this.updateTextNode(this.ncBadge,_11);
}
},updateTextNode:function(_12,_13){
if(_12.innerText){
_12.innerText=_13;
}else{
_12.textContent=_13;
}
},showBadge:function(){
_4.remove(this.notificationCenterBadge,"lotusHidden");
_5.set(this.notificationCenterBadge,"opacity","1");
},hideBadge:function(){
_5.set(this.notificationCenterBadge,"opacity","0");
}});
return _c;
});


;define("ic-as/notification/config/NotificationCenterLivePreviewPrefs",["dojo/_base/declare","dojo/_base/json","dojo/topic","ic-as/notification/util/keys","dojo/_base/lang","ic-as/notification/util/ICNotificationController","ic-as/util/xhr/XhrHandler","ic-as/util/RouteHelper"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9=_1(null,{notificationLivePreviewEnabled:false,mentionLivePreviewEnabled:false,LIVEPREVIEW_MENTIONS:"LIVEPREVIEW_MENTIONS",LIVEPREVIEW_NOTIFICATIONS:"LIVEPREVIEW_NOTIFICATIONS",SESSION_STORAGE_KEY:"IC_NOTIFICATION_CENTER_LIVE_PREFS",constructor:function(_a,_b){
if(_a!==undefined){
this.notificationLivePreviewEnabled=_a;
}
if(_b!==undefined){
this.mentionLivePreviewEnabled=_b;
}
_3.subscribe(_4.LIVEPREVIEW_PREF_CHANGE,_5.hitch(this,"updatePreferences"));
},isNotificationLivePreviewEnabled:function(){
return this.notificationLivePreviewEnabled;
},isMentionLivePreviewEnabled:function(){
return this.mentionLivePreviewEnabled;
},updatePreferences:function(_c){
var _d=true;
if(_c&&_c.entry&&_c.entry.appData&&_c.entry.appData.userSettings){
var _e=_c.entry.appData.userSettings;
this.mentionLivePreviewEnabled=(typeof _e[this.LIVEPREVIEW_MENTIONS]!=="undefined")?(_e[this.LIVEPREVIEW_MENTIONS]=="true"):_d;
this.notificationLivePreviewEnabled=(typeof _e[this.LIVEPREVIEW_NOTIFICATIONS]!=="undefined")?(_e[this.LIVEPREVIEW_NOTIFICATIONS]=="true"):_d;
}
this.setPrefencesToStorage();
},setPrefencesToStorage:function(){
var _f={"LIVEPREVIEW_MENTIONS":this.mentionLivePreviewEnabled,"LIVEPREVIEW_NOTIFICATIONS":this.notificationLivePreviewEnabled};
sessionStorage.setItem(this.SESSION_STORAGE_KEY,_2.toJson(_f));
},readPreferencesFromStorage:function(){
var _10=sessionStorage.getItem(this.SESSION_STORAGE_KEY);
if(_10){
var _11=_2.fromJson(_10);
this.mentionLivePreviewEnabled=_11.LIVEPREVIEW_MENTIONS;
this.notificationLivePreviewEnabled=_11.LIVEPREVIEW_NOTIFICATIONS;
}
},requestUserLivePreviewPreferences:function(){
var _12=sessionStorage.getItem(this.SESSION_STORAGE_KEY);
if(!_12){
_7.xhrGet({url:_8.getInstance().getNotificationsLivePreviewPreferences(),handleAs:"json",timeout:10000}).then(_5.hitch(this,function(_13){
this.updatePreferences(_13);
}),function(_14){
console.log(_14);
});
}else{
this.readPreferencesFromStorage();
}
if(this.isMentionLivePreviewEnabled()||this.isNotificationLivePreviewEnabled()){
_6.requestNotificationPermission();
}
},isNotificationAllowed:function(_15){
if(_15&&_15.isMention){
return this.isMentionLivePreviewEnabled();
}else{
if(_15&&!_15.isMention){
return this.isNotificationLivePreviewEnabled();
}
}
}});
return _9;
});


;define("ic-as/notification/util/WindowBroadcastSupport",["dojo/_base/declare","dojo/json","dojo/date","dojo/_base/lang"],function(_1,_2,_3,_4){
var _5=_1(null,{isMaster:false,storageLock:null,masterFrequency:10000,STORAGE_LOCK:"icStorageChannelLock",IC_WINDOW_BROADCAST:"icWindowBroadcast",_listenerFunction:undefined,initWindowBroadcastSupport:function(){
var _6=new Date().getTime();
var _7=0;
try{
_7=+localStorage.getItem(this.STORAGE_LOCK)||0;
}
catch(error){
}
if((_6-_7)>this.masterFrequency){
this.assignMaster();
}else{
this.loseMaster();
}
this._listenerFunction=_4.hitch(this,"handleStorageEventInternal");
if(window.addEventListener){
window.addEventListener("storage",this._listenerFunction,false);
window.addEventListener("unload",this._listenerFunction,false);
}else{
window.attachEvent("onstorage",this._listenerFunction);
window.attachEvent("unload",this._listenerFunction);
}
},handleStorageEventInternal:function(_8){
if(_8.type==="unload"){
this.unregisterNotificationBroadcast();
}else{
var _9=_8.key,_a=0,_b;
if(_9===this.STORAGE_LOCK){
try{
_a=+localStorage.getItem(this.STORAGE_LOCK)||0;
}
catch(error){
}
if(_a&&!this.isMaster){
this.loseMaster();
}
}else{
if(_9===this.IC_WINDOW_BROADCAST){
try{
this.handleStorageEvent(_8);
}
catch(error){
}
}
}
}
},handleStorageEvent:function(_c){
},cleanupWindowSupport:function(){
},windowActivated:function(){
},windowDeactivated:function(){
},unregisterNotificationBroadcast:function(){
if(window.removeEventListener){
window.removeEventListener("storage",this._listenerFunction,false);
window.removeEventListener("unload",this._listenerFunction,false);
}else{
window.detachEvent("storage",this._listenerFunction);
window.detachEvent("unload",this._listenerFunction);
}
this.cleanupWindowSupport();
},assignMaster:function(){
console.log("WindowBroadcastSupport: assignMaster");
this.isMaster=true;
this.setStorageLock();
this.windowActivated();
},setStorageLock:function(){
try{
localStorage.setItem(this.STORAGE_LOCK,new Date().getTime());
}
catch(error){
}
clearTimeout(this.storageLock);
this.storageLock=setTimeout(_4.hitch(this,this.setStorageLock),this.masterFrequency);
},loseMaster:function(){
clearTimeout(this.storageLock);
this.isMaster=false;
this.storageLock=setTimeout(_4.hitch(this,this.assignMaster),(this.masterFrequency+this.getRandomTimeout(10000)));
this.windowDeactivated();
},getRandomTimeout:function(_d){
return ~~(Math.random()*_d);
},windowBroadcast:function(_e){
try{
localStorage.setItem(this.IC_WINDOW_BROADCAST,_2.stringify({type:"broadcast",event:_e}));
}
catch(error){
}
}});
return _5;
});


;define("ic-as/notification/NotificationPoll",["dojo/_base/declare","dojo/_base/lang","dojo/string","dojo/date/stamp","dojo/date","dojo/topic","dojo/aspect","dojo/json","ic-as/constants/events","ic-as/util/xhr/XhrHandler","ic-as/notification/util/WindowBroadcastSupport","ic-as/notification/badging/NotificationCenterBadgeController","ic-as/util/RouteHelper","ic-core/config/features","ic-as/notification/util/ICNotificationController","dojo/i18n!ic-as/nls/activitystream"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){
var _11=_1(_b,{timeoutID:null,pollingInterval:600000,helper:null,timeStampInPast:null,init:false,strings:_10,cacheUnread:0,constructor:function(){
this.helper=_d.getInstance({cfg:{userInfo:{id:"id"}}});
this.setupDateInPast();
_6.subscribe(_9.BADGE_RESET_AMD,_2.hitch(this,"resetUnreadCache"));
},resetUnreadCache:function(){
this.cacheUnread=0;
},setupDateInPast:function(){
var _12=new Date();
_12=_5.add(_12,"year",-20);
this.timeStampInPast=_4.toISOString(_12,{zulu:true,milliseconds:true});
},initPoll:function(){
this.masterFrequency=this.pollingInterval;
this.initWindowBroadcastSupport();
},windowActivated:function(){
this.stopPoll();
this.timeoutID=setTimeout(_2.hitch(this,this.poll),this.pollingInterval);
if(!this.init){
this.fetchNewNotificationsInfo();
this.init=true;
}
},windowDeactivated:function(){
this.stopPoll();
this.handleStorageEvent=function(_13){
var msg=_8.parse(_13.newValue);
this.handleNotificationBadgeUpdate(msg.event,true);
};
},stopPoll:function(){
if(this.timeoutID){
clearTimeout(this.timeoutID);
}
},poll:function(){
console.debug("polling notification center");
this.fetchNewNotificationsInfo();
this.timeoutID=setTimeout(_2.hitch(this,this.poll),this.pollingInterval);
},handleNotificationBadgeUpdate:function(_14){
if(_14&&_14.connections&&_14.connections.unreadNotifications){
var _15=_14.connections.unreadNotifications;
try{
_15=parseInt(_15);
}
catch(e){
}
if(_15>this.cacheUnread){
this.cacheUnread=_15;
_c.updateBadging(_14.connections.unreadNotifications);
}
}
},fetchNewNotificationsInfo:function(){
var _16=this.helper.getNotificationsForMeUrl()+"?count=1";
_16=_16+"&updatedBefore="+this.timeStampInPast;
_a.xhrGet({url:_16,handleAs:"json"}).then(_2.hitch(this,function(_17){
this.handleNotificationBadgeUpdate(_17);
}),function(_18){
console.log(_18);
});
}});
_11._Instance=null;
_11.getInstance=function(){
if(_11._Instance==null){
_11._Instance=new _11();
}
return _11._Instance;
};
return _11.getInstance();
});


;define("ic-as/listener/Subscriber",["dojo/_base/array","dojo/_base/declare","dojo/topic"],function(_1,_2,_3){
var _4=_2("com.ibm.social.as.listener.Subscriber",null,{subscribes:null,constructor:function(){
this.subscribes=[];
},setupSubscribes:function(){
},subscribe:function(_5,_6){
this.subscribes.push(_3.subscribe(_5,_6));
},destroy:function(){
_1.forEach(this.subscribes,function(_7){
_7.remove();
});
}});
return _4;
});


;define("ic-as/util/ItemNavigationHandler",["dojo/_base/declare","dojo/_base/lang","dojo/query","ic-as/constants/events","ic-as/listener/Subscriber","dijit/focus"],function(_1,_2,_3,_4,_5,_6){
var _7=_1("com.ibm.social.as.util.ItemNavigationHandler",_5,{KEYUP:38,KEYDOWN:40,landmark:".activityStreamNewsItemContainer",subscriptionKey:_4.KEYBOARDNAVIGATION,changeItemHandle:null,constructor:function(){
this.subscribe(this.subscriptionKey,_2.hitch(this,function(_8,_9){
this._moveFocus(_8,_9);
}));
},_moveFocus:function(_a,_b){
var _c=null;
switch(_b){
case this.KEYUP:
_c=_a.previousSibling;
break;
case this.KEYDOWN:
_c=_a.nextSibling;
break;
default:
_c=null;
}
if(_c){
if(_c.focus){
_6.focus(_c);
}else{
var _d=_3(this.landmark,_c);
if(_d.length>0){
_6.focus(_d[0]);
}
}
}
}});
return _7;
});


;define("ic-as/notification/util/NotificationItemNavigationHandler",["dojo/_base/declare","ic-as/util/ItemNavigationHandler","./keys"],function(_1,_2,_3){
var _4=_1(_2,{landmark:".icNotification-post-inner",subscriptionKey:_3.KEYBOARDNAVIGATION});
_4._Instance=null;
_4.getInstance=function(){
if(_4._Instance==null){
_4._Instance=new _4();
}
return _4._Instance;
};
return _4.getInstance();
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["cometd-dojo"]=true;

;this.org=this.org||{};
org.cometd={};
org.cometd.JSON={};
org.cometd.JSON.toJSON=org.cometd.JSON.fromJSON=function(_1){
throw "Abstract";
};
org.cometd.Utils={};
org.cometd.Utils.isString=function(_2){
if(_2===undefined||_2===null){
return false;
}
return typeof _2==="string"||_2 instanceof String;
};
org.cometd.Utils.isArray=function(_3){
if(_3===undefined||_3===null){
return false;
}
return _3 instanceof Array;
};
org.cometd.Utils.inArray=function(_4,_5){
for(var i=0;i<_5.length;++i){
if(_4===_5[i]){
return i;
}
}
return -1;
};
org.cometd.Utils.setTimeout=function(_6,_7,_8){
return window.setTimeout(function(){
try{
_7();
}
catch(x){
_6._debug("Exception invoking timed function",_7,x);
}
},_8);
};
org.cometd.Utils.clearTimeout=function(_9){
window.clearTimeout(_9);
};
org.cometd.TransportRegistry=function(){
var _a=[];
var _b={};
this.getTransportTypes=function(){
return _a.slice(0);
};
this.findTransportTypes=function(_c,_d,_e){
var _f=[];
for(var i=0;i<_a.length;++i){
var _10=_a[i];
if(_b[_10].accept(_c,_d,_e)===true){
_f.push(_10);
}
}
return _f;
};
this.negotiateTransport=function(_11,_12,_13,url){
for(var i=0;i<_a.length;++i){
var _14=_a[i];
for(var j=0;j<_11.length;++j){
if(_14===_11[j]){
var _15=_b[_14];
if(_15.accept(_12,_13,url)===true){
return _15;
}
}
}
}
return null;
};
this.add=function(_16,_17,_18){
var _19=false;
for(var i=0;i<_a.length;++i){
if(_a[i]===_16){
_19=true;
break;
}
}
if(!_19){
if(typeof _18!=="number"){
_a.push(_16);
}else{
_a.splice(_18,0,_16);
}
_b[_16]=_17;
}
return !_19;
};
this.find=function(_1a){
for(var i=0;i<_a.length;++i){
if(_a[i]===_1a){
return _b[_1a];
}
}
return null;
};
this.remove=function(_1b){
for(var i=0;i<_a.length;++i){
if(_a[i]===_1b){
_a.splice(i,1);
var _1c=_b[_1b];
delete _b[_1b];
return _1c;
}
}
return null;
};
this.clear=function(){
_a=[];
_b={};
};
this.reset=function(){
for(var i=0;i<_a.length;++i){
_b[_a[i]].reset();
}
};
};
org.cometd.Transport=function(){
var _1d;
var _1e;
this.registered=function(_1f,_20){
_1d=_1f;
_1e=_20;
};
this.unregistered=function(){
_1d=null;
_1e=null;
};
this._debug=function(){
_1e._debug.apply(_1e,arguments);
};
this._mixin=function(){
return _1e._mixin.apply(_1e,arguments);
};
this.getConfiguration=function(){
return _1e.getConfiguration();
};
this.getAdvice=function(){
return _1e.getAdvice();
};
this.setTimeout=function(_21,_22){
return org.cometd.Utils.setTimeout(_1e,_21,_22);
};
this.clearTimeout=function(_23){
org.cometd.Utils.clearTimeout(_23);
};
this.convertToMessages=function(_24){
if(org.cometd.Utils.isString(_24)){
try{
return org.cometd.JSON.fromJSON(_24);
}
catch(x){
this._debug("Could not convert to JSON the following string","\""+_24+"\"");
throw x;
}
}
if(org.cometd.Utils.isArray(_24)){
return _24;
}
if(_24===undefined||_24===null){
return [];
}
if(_24 instanceof Object){
return [_24];
}
throw "Conversion Error "+_24+", typeof "+(typeof _24);
};
this.accept=function(_25,_26,url){
throw "Abstract";
};
this.getType=function(){
return _1d;
};
this.send=function(_27,_28){
throw "Abstract";
};
this.reset=function(){
this._debug("Transport",_1d,"reset");
};
this.abort=function(){
this._debug("Transport",_1d,"aborted");
};
this.toString=function(){
return this.getType();
};
};
org.cometd.Transport.derive=function(_29){
function F(){
};
F.prototype=_29;
return new F();
};
org.cometd.RequestTransport=function(){
var _2a=new org.cometd.Transport();
var _2b=org.cometd.Transport.derive(_2a);
var _2c=0;
var _2d=null;
var _2e=[];
var _2f=[];
function _30(_31){
while(_2f.length>0){
var _32=_2f[0];
var _33=_32[0];
var _34=_32[1];
if(_33.url===_31.url&&_33.sync===_31.sync){
_2f.shift();
_31.messages=_31.messages.concat(_33.messages);
this._debug("Coalesced",_33.messages.length,"messages from request",_34.id);
continue;
}
break;
}
};
function _35(_36,_37){
this.transportSend(_36,_37);
_37.expired=false;
if(!_36.sync){
var _38=this.getConfiguration().maxNetworkDelay;
var _39=_38;
if(_37.metaConnect===true){
_39+=this.getAdvice().timeout;
}
this._debug("Transport",this.getType(),"waiting at most",_39,"ms for the response, maxNetworkDelay",_38);
var _3a=this;
_37.timeout=this.setTimeout(function(){
_37.expired=true;
var _3b="Request "+_37.id+" of transport "+_3a.getType()+" exceeded "+_39+" ms max network delay";
var _3c={reason:_3b};
var xhr=_37.xhr;
_3c.httpCode=_3a.xhrStatus(xhr);
_3a.abortXHR(xhr);
_3a._debug(_3b);
_3a.complete(_37,false,_37.metaConnect);
_36.onFailure(xhr,_36.messages,_3c);
},_39);
}
};
function _3d(_3e){
var _3f=++_2c;
var _40={id:_3f,metaConnect:false};
if(_2e.length<this.getConfiguration().maxConnections-1){
_2e.push(_40);
_35.call(this,_3e,_40);
}else{
this._debug("Transport",this.getType(),"queueing request",_3f,"envelope",_3e);
_2f.push([_3e,_40]);
}
};
function _41(_42){
var _43=_42.id;
this._debug("Transport",this.getType(),"metaConnect complete, request",_43);
if(_2d!==null&&_2d.id!==_43){
throw "Longpoll request mismatch, completing request "+_43;
}
_2d=null;
};
function _44(_45,_46){
var _47=org.cometd.Utils.inArray(_45,_2e);
if(_47>=0){
_2e.splice(_47,1);
}
if(_2f.length>0){
var _48=_2f.shift();
var _49=_48[0];
var _4a=_48[1];
this._debug("Transport dequeued request",_4a.id);
if(_46){
if(this.getConfiguration().autoBatch){
_30.call(this,_49);
}
_3d.call(this,_49);
this._debug("Transport completed request",_45.id,_49);
}else{
var _4b=this;
this.setTimeout(function(){
_4b.complete(_4a,false,_4a.metaConnect);
var _4c={reason:"Previous request failed"};
var xhr=_4a.xhr;
_4c.httpCode=_4b.xhrStatus(xhr);
_49.onFailure(xhr,_49.messages,_4c);
},0);
}
}
};
_2b.complete=function(_4d,_4e,_4f){
if(_4f){
_41.call(this,_4d);
}else{
_44.call(this,_4d,_4e);
}
};
_2b.transportSend=function(_50,_51){
throw "Abstract";
};
_2b.transportSuccess=function(_52,_53,_54){
if(!_53.expired){
this.clearTimeout(_53.timeout);
this.complete(_53,true,_53.metaConnect);
if(_54&&_54.length>0){
_52.onSuccess(_54);
}else{
_52.onFailure(_53.xhr,_52.messages,{httpCode:204});
}
}
};
_2b.transportFailure=function(_55,_56,_57){
if(!_56.expired){
this.clearTimeout(_56.timeout);
this.complete(_56,false,_56.metaConnect);
_55.onFailure(_56.xhr,_55.messages,_57);
}
};
function _58(_59){
if(_2d!==null){
throw "Concurrent metaConnect requests not allowed, request id="+_2d.id+" not yet completed";
}
var _5a=++_2c;
this._debug("Transport",this.getType(),"metaConnect send, request",_5a,"envelope",_59);
var _5b={id:_5a,metaConnect:true};
_35.call(this,_59,_5b);
_2d=_5b;
};
_2b.send=function(_5c,_5d){
if(_5d){
_58.call(this,_5c);
}else{
_3d.call(this,_5c);
}
};
_2b.abort=function(){
_2a.abort();
for(var i=0;i<_2e.length;++i){
var _5e=_2e[i];
this._debug("Aborting request",_5e);
this.abortXHR(_5e.xhr);
}
if(_2d){
this._debug("Aborting metaConnect request",_2d);
this.abortXHR(_2d.xhr);
}
this.reset();
};
_2b.reset=function(){
_2a.reset();
_2d=null;
_2e=[];
_2f=[];
};
_2b.abortXHR=function(xhr){
if(xhr){
try{
xhr.abort();
}
catch(x){
this._debug(x);
}
}
};
_2b.xhrStatus=function(xhr){
if(xhr){
try{
return xhr.status;
}
catch(x){
this._debug(x);
}
}
return -1;
};
return _2b;
};
org.cometd.LongPollingTransport=function(){
var _5f=new org.cometd.RequestTransport();
var _60=org.cometd.Transport.derive(_5f);
var _61=true;
_60.accept=function(_62,_63,url){
return _61||!_63;
};
_60.xhrSend=function(_64){
throw "Abstract";
};
_60.transportSend=function(_65,_66){
this._debug("Transport",this.getType(),"sending request",_66.id,"envelope",_65);
var _67=this;
try{
var _68=true;
_66.xhr=this.xhrSend({transport:this,url:_65.url,sync:_65.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(_65.messages),onSuccess:function(_69){
_67._debug("Transport",_67.getType(),"received response",_69);
var _6a=false;
try{
var _6b=_67.convertToMessages(_69);
if(_6b.length===0){
_61=false;
_67.transportFailure(_65,_66,{httpCode:204});
}else{
_6a=true;
_67.transportSuccess(_65,_66,_6b);
}
}
catch(x){
_67._debug(x);
if(!_6a){
_61=false;
var _6c={exception:x};
_6c.httpCode=_67.xhrStatus(_66.xhr);
_67.transportFailure(_65,_66,_6c);
}
}
},onError:function(_6d,_6e){
_61=false;
var _6f={reason:_6d,exception:_6e};
_6f.httpCode=_67.xhrStatus(_66.xhr);
if(_68){
_67.setTimeout(function(){
_67.transportFailure(_65,_66,_6f);
},0);
}else{
_67.transportFailure(_65,_66,_6f);
}
}});
_68=false;
}
catch(x){
_61=false;
this.setTimeout(function(){
_67.transportFailure(_65,_66,{exception:x});
},0);
}
};
_60.reset=function(){
_5f.reset();
_61=true;
};
return _60;
};
org.cometd.CallbackPollingTransport=function(){
var _70=new org.cometd.RequestTransport();
var _71=org.cometd.Transport.derive(_70);
var _72=2000;
_71.accept=function(_73,_74,url){
return true;
};
_71.jsonpSend=function(_75){
throw "Abstract";
};
_71.transportSend=function(_76,_77){
var _78=this;
var _79=0;
var _7a=_76.messages.length;
var _7b=[];
while(_7a>0){
var _7c=org.cometd.JSON.toJSON(_76.messages.slice(_79,_79+_7a));
var _7d=_76.url.length+encodeURI(_7c).length;
if(_7d>_72){
if(_7a===1){
this.setTimeout(function(){
_78.transportFailure(_76,_77,{reason:"Bayeux message too big, max is "+_72});
},0);
return;
}
--_7a;
continue;
}
_7b.push(_7a);
_79+=_7a;
_7a=_76.messages.length-_79;
}
var _7e=_76;
if(_7b.length>1){
var _7f=0;
var end=_7b[0];
this._debug("Transport",this.getType(),"split",_76.messages.length,"messages into",_7b.join(" + "));
_7e=this._mixin(false,{},_76);
_7e.messages=_76.messages.slice(_7f,end);
_7e.onSuccess=_76.onSuccess;
_7e.onFailure=_76.onFailure;
for(var i=1;i<_7b.length;++i){
var _80=this._mixin(false,{},_76);
_7f=end;
end+=_7b[i];
_80.messages=_76.messages.slice(_7f,end);
_80.onSuccess=_76.onSuccess;
_80.onFailure=_76.onFailure;
this.send(_80,_77.metaConnect);
}
}
this._debug("Transport",this.getType(),"sending request",_77.id,"envelope",_7e);
try{
var _81=true;
this.jsonpSend({transport:this,url:_7e.url,sync:_7e.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(_7e.messages),onSuccess:function(_82){
var _83=false;
try{
var _84=_78.convertToMessages(_82);
if(_84.length===0){
_78.transportFailure(_7e,_77,{httpCode:204});
}else{
_83=true;
_78.transportSuccess(_7e,_77,_84);
}
}
catch(x){
_78._debug(x);
if(!_83){
_78.transportFailure(_7e,_77,{exception:x});
}
}
},onError:function(_85,_86){
var _87={reason:_85,exception:_86};
if(_81){
_78.setTimeout(function(){
_78.transportFailure(_7e,_77,_87);
},0);
}else{
_78.transportFailure(_7e,_77,_87);
}
}});
_81=false;
}
catch(xx){
this.setTimeout(function(){
_78.transportFailure(_7e,_77,{exception:xx});
},0);
}
};
return _71;
};
org.cometd.WebSocketTransport=function(){
var _88=new org.cometd.Transport();
var _89=org.cometd.Transport.derive(_88);
var _8a;
var _8b=true;
var _8c=false;
var _8d=true;
var _8e={};
var _8f={};
var _90=false;
var _91=null;
var _92=false;
var _93=null;
_89.reset=function(){
_88.reset();
_8b=true;
_8c=false;
_8d=true;
_8e={};
_8f={};
_90=false;
_91=null;
_92=false;
_93=null;
};
function _94(){
if(_90){
return;
}
_90=true;
var url=_8a.getURL().replace(/^http/,"ws");
this._debug("Transport",this.getType(),"connecting to URL",url);
try{
var _95=_8a.getConfiguration().protocol;
var _96=_95?new org.cometd.WebSocket(url,_95):new org.cometd.WebSocket(url);
}
catch(x){
_8b=false;
this._debug("Exception while creating WebSocket object",x);
throw x;
}
_8d=_8a.getConfiguration().stickyReconnect!==false;
var _97=this;
var _98=null;
var _99=_8a.getConfiguration().connectTimeout;
if(_99>0){
_98=this.setTimeout(function(){
_98=null;
_97._debug("Transport",_97.getType(),"timed out while connecting to URL",url,":",_99,"ms");
var _9a={code:1000,reason:"Connect Timeout"};
_97.webSocketClose(_96,_9a.code,_9a.reason);
_97.onClose(_96,_9a);
},_99);
}
var _9b=function(){
_97._debug("WebSocket opened",_96);
_90=false;
if(_98){
_97.clearTimeout(_98);
_98=null;
}
if(_91){
_8a._warn("Closing Extra WebSocket Connections",_96,_91);
_97.webSocketClose(_96,1000,"Extra Connection");
}else{
_97.onOpen(_96);
}
};
var _9c=function(_9d){
_9d=_9d||{code:1000};
_97._debug("WebSocket closing",_96,_9d);
_90=false;
if(_98){
_97.clearTimeout(_98);
_98=null;
}
if(_91!==null&&_96!==_91){
_97._debug("Closed Extra WebSocket Connection",_96);
}else{
_97.onClose(_96,_9d);
}
};
var _9e=function(_9f){
_97._debug("WebSocket message",_9f,_96);
if(_96!==_91){
_8a._warn("Extra WebSocket Connections",_96,_91);
}
_97.onMessage(_96,_9f);
};
_96.onopen=_9b;
_96.onclose=_9c;
_96.onerror=function(){
_9c({code:1002,reason:"Error"});
};
_96.onmessage=_9e;
this._debug("Transport",this.getType(),"configured callbacks on",_96);
};
function _a0(_a1,_a2,_a3){
var _a4=org.cometd.JSON.toJSON(_a2.messages);
_a1.send(_a4);
this._debug("Transport",this.getType(),"sent",_a2,"metaConnect =",_a3);
var _a5=this.getConfiguration().maxNetworkDelay;
var _a6=_a5;
if(_a3){
_a6+=this.getAdvice().timeout;
_92=true;
}
var _a7=this;
var _a8=[];
for(var i=0;i<_a2.messages.length;++i){
(function(){
var _a9=_a2.messages[i];
if(_a9.id){
_a8.push(_a9.id);
_8f[_a9.id]=this.setTimeout(function(){
_a7._debug("Transport",_a7.getType(),"timing out message",_a9.id,"after",_a6,"on",_a1);
var _aa={code:1000,reason:"Message Timeout"};
_a7.webSocketClose(_a1,_aa.code,_aa.reason);
_a7.onClose(_a1,_aa);
},_a6);
}
})();
}
this._debug("Transport",this.getType(),"waiting at most",_a6,"ms for messages",_a8,"maxNetworkDelay",_a5,", timeouts:",_8f);
};
function _ab(_ac,_ad,_ae){
try{
if(_ac===null){
_94.call(this);
}else{
_a0.call(this,_ac,_ad,_ae);
}
}
catch(x){
this.setTimeout(function(){
_ad.onFailure(_ac,_ad.messages,{exception:x});
},0);
}
};
_89.onOpen=function(_af){
this._debug("Transport",this.getType(),"opened",_af);
_91=_af;
_8c=true;
this._debug("Sending pending messages",_8e);
for(var key in _8e){
var _b0=_8e[key];
var _b1=_b0[0];
var _b2=_b0[1];
_93=_b1.onSuccess;
_a0.call(this,_af,_b1,_b2);
}
};
_89.onMessage=function(_b3,_b4){
this._debug("Transport",this.getType(),"received websocket message",_b4,_b3);
var _b5=false;
var _b6=this.convertToMessages(_b4.data);
var _b7=[];
for(var i=0;i<_b6.length;++i){
var _b8=_b6[i];
if(/^\/meta\//.test(_b8.channel)||_b8.successful!==undefined){
if(_b8.id){
_b7.push(_b8.id);
var _b9=_8f[_b8.id];
if(_b9){
this.clearTimeout(_b9);
delete _8f[_b8.id];
this._debug("Transport",this.getType(),"removed timeout for message",_b8.id,", timeouts",_8f);
}
}
}
if("/meta/connect"===_b8.channel){
_92=false;
}
if("/meta/disconnect"===_b8.channel&&!_92){
_b5=true;
}
}
var _ba=false;
for(var j=0;j<_b7.length;++j){
var id=_b7[j];
for(var key in _8e){
var ids=key.split(",");
var _bb=org.cometd.Utils.inArray(id,ids);
if(_bb>=0){
_ba=true;
ids.splice(_bb,1);
var _bc=_8e[key][0];
var _bd=_8e[key][1];
delete _8e[key];
if(ids.length>0){
_8e[ids.join(",")]=[_bc,_bd];
}
break;
}
}
}
if(_ba){
this._debug("Transport",this.getType(),"removed envelope, envelopes",_8e);
}
_93.call(this,_b6);
if(_b5){
this.webSocketClose(_b3,1000,"Disconnect");
}
};
_89.onClose=function(_be,_bf){
this._debug("Transport",this.getType(),"closed",_be,_bf);
_8b=_8d&&_8c;
for(var id in _8f){
this.clearTimeout(_8f[id]);
}
_8f={};
for(var key in _8e){
var _c0=_8e[key][0];
var _c1=_8e[key][1];
if(_c1){
_92=false;
}
_c0.onFailure(_be,_c0.messages,{websocketCode:_bf.code,reason:_bf.reason});
}
_8e={};
_91=null;
};
_89.registered=function(_c2,_c3){
_88.registered(_c2,_c3);
_8a=_c3;
};
_89.accept=function(_c4,_c5,url){
return _8b&&!!org.cometd.WebSocket&&_8a.websocketEnabled!==false;
};
_89.send=function(_c6,_c7){
this._debug("Transport",this.getType(),"sending",_c6,"metaConnect =",_c7);
var _c8=[];
for(var i=0;i<_c6.messages.length;++i){
var _c9=_c6.messages[i];
if(_c9.id){
_c8.push(_c9.id);
}
}
_8e[_c8.join(",")]=[_c6,_c7];
this._debug("Transport",this.getType(),"stored envelope, envelopes",_8e);
_ab.call(this,_91,_c6,_c7);
};
_89.webSocketClose=function(_ca,_cb,_cc){
try{
_ca.close(_cb,_cc);
}
catch(x){
this._debug(x);
}
};
_89.abort=function(){
_88.abort();
if(_91){
var _cd={code:1001,reason:"Abort"};
this.webSocketClose(_91,_cd.code,_cd.reason);
this.onClose(_91,_cd);
}
this.reset();
};
return _89;
};
org.cometd.Cometd=function(_ce){
var _cf=this;
var _d0=_ce||"default";
var _d1=false;
var _d2=new org.cometd.TransportRegistry();
var _d3;
var _d4="disconnected";
var _d5=0;
var _d6=null;
var _d7=0;
var _d8=[];
var _d9=false;
var _da={};
var _db=0;
var _dc=null;
var _dd=[];
var _de={};
var _df;
var _e0;
var _e1={};
var _e2=false;
var _e3=false;
var _e4={protocol:null,stickyReconnect:true,connectTimeout:0,maxConnections:2,backoffIncrement:1000,maxBackoff:60000,logLevel:"info",reverseIncomingExtensions:true,maxNetworkDelay:10000,requestHeaders:{},appendMessageTypeToURL:true,autoBatch:false,advice:{timeout:60000,interval:0,reconnect:"retry"}};
function _e5(_e6,_e7){
try{
return _e6[_e7];
}
catch(x){
return undefined;
}
};
this._mixin=function(_e8,_e9,_ea){
var _eb=_e9||{};
for(var i=2;i<arguments.length;++i){
var _ec=arguments[i];
if(_ec===undefined||_ec===null){
continue;
}
for(var _ed in _ec){
var _ee=_e5(_ec,_ed);
var _ef=_e5(_eb,_ed);
if(_ee===_e9){
continue;
}
if(_ee===undefined){
continue;
}
if(_e8&&typeof _ee==="object"&&_ee!==null){
if(_ee instanceof Array){
_eb[_ed]=this._mixin(_e8,_ef instanceof Array?_ef:[],_ee);
}else{
var _f0=typeof _ef==="object"&&!(_ef instanceof Array)?_ef:{};
_eb[_ed]=this._mixin(_e8,_f0,_ee);
}
}else{
_eb[_ed]=_ee;
}
}
}
return _eb;
};
function _f1(_f2){
return org.cometd.Utils.isString(_f2);
};
function _f3(_f4){
if(_f4===undefined||_f4===null){
return false;
}
return typeof _f4==="function";
};
function _f5(_f6,_f7){
if(window.console){
var _f8=window.console[_f6];
if(_f3(_f8)){
_f8.apply(window.console,_f7);
}
}
};
this._warn=function(){
_f5("warn",arguments);
};
this._info=function(){
if(_e4.logLevel!=="warn"){
_f5("info",arguments);
}
};
this._debug=function(){
if(_e4.logLevel==="debug"){
_f5("debug",arguments);
}
};
this._isCrossDomain=function(_f9){
return _f9&&_f9!==window.location.host;
};
function _fa(_fb){
_cf._debug("Configuring cometd object with",_fb);
if(_f1(_fb)){
_fb={url:_fb};
}
if(!_fb){
_fb={};
}
_e4=_cf._mixin(false,_e4,_fb);
var url=_cf.getURL();
if(!url){
throw "Missing required configuration parameter 'url' specifying the Bayeux server URL";
}
var _fc=/(^https?:\/\/)?(((\[[^\]]+\])|([^:\/\?#]+))(:(\d+))?)?([^\?#]*)(.*)?/.exec(url);
var _fd=_fc[2];
var uri=_fc[8];
var _fe=_fc[9];
_d1=_cf._isCrossDomain(_fd);
if(_e4.appendMessageTypeToURL){
if(_fe!==undefined&&_fe.length>0){
_cf._info("Appending message type to URI "+uri+_fe+" is not supported, disabling 'appendMessageTypeToURL' configuration");
_e4.appendMessageTypeToURL=false;
}else{
var _ff=uri.split("/");
var _100=_ff.length-1;
if(uri.match(/\/$/)){
_100-=1;
}
if(_ff[_100].indexOf(".")>=0){
_cf._info("Appending message type to URI "+uri+" is not supported, disabling 'appendMessageTypeToURL' configuration");
_e4.appendMessageTypeToURL=false;
}
}
}
};
function _101(_102){
if(_102){
var _103=_da[_102.channel];
if(_103&&_103[_102.id]){
delete _103[_102.id];
_cf._debug("Removed",_102.listener?"listener":"subscription",_102);
}
}
};
function _104(_105){
if(_105&&!_105.listener){
_101(_105);
}
};
function _106(){
for(var _107 in _da){
var _108=_da[_107];
if(_108){
for(var i=0;i<_108.length;++i){
_104(_108[i]);
}
}
}
};
function _109(_10a){
if(_d4!==_10a){
_cf._debug("Status",_d4,"->",_10a);
_d4=_10a;
}
};
function _10b(){
return _d4==="disconnecting"||_d4==="disconnected";
};
function _10c(){
return ++_d5;
};
function _10d(_10e,_10f,name,_110,_111){
try{
return _10f.call(_10e,_110);
}
catch(x){
_cf._debug("Exception during execution of extension",name,x);
var _112=_cf.onExtensionException;
if(_f3(_112)){
_cf._debug("Invoking extension exception callback",name,x);
try{
_112.call(_cf,x,name,_111,_110);
}
catch(xx){
_cf._info("Exception during execution of exception callback in extension",name,xx);
}
}
return _110;
}
};
function _113(_114){
for(var i=0;i<_dd.length;++i){
if(_114===undefined||_114===null){
break;
}
var _115=_e4.reverseIncomingExtensions?_dd.length-1-i:i;
var _116=_dd[_115];
var _117=_116.extension.incoming;
if(_f3(_117)){
var _118=_10d(_116.extension,_117,_116.name,_114,false);
_114=_118===undefined?_114:_118;
}
}
return _114;
};
function _119(_11a){
for(var i=0;i<_dd.length;++i){
if(_11a===undefined||_11a===null){
break;
}
var _11b=_dd[i];
var _11c=_11b.extension.outgoing;
if(_f3(_11c)){
var _11d=_10d(_11b.extension,_11c,_11b.name,_11a,true);
_11a=_11d===undefined?_11a:_11d;
}
}
return _11a;
};
function _11e(_11f,_120){
var _121=_da[_11f];
if(_121&&_121.length>0){
for(var i=0;i<_121.length;++i){
var _122=_121[i];
if(_122){
try{
_122.callback.call(_122.scope,_120);
}
catch(x){
_cf._debug("Exception during notification",_122,_120,x);
var _123=_cf.onListenerException;
if(_f3(_123)){
_cf._debug("Invoking listener exception callback",_122,x);
try{
_123.call(_cf,x,_122,_122.listener,_120);
}
catch(xx){
_cf._info("Exception during execution of listener callback",_122,xx);
}
}
}
}
}
}
};
function _124(_125,_126){
_11e(_125,_126);
var _127=_125.split("/");
var last=_127.length-1;
for(var i=last;i>0;--i){
var _128=_127.slice(0,i).join("/")+"/*";
if(i===last){
_11e(_128,_126);
}
_128+="*";
_11e(_128,_126);
}
};
function _129(){
if(_dc!==null){
org.cometd.Utils.clearTimeout(_dc);
}
_dc=null;
};
function _12a(_12b){
_129();
var _12c=_de.interval+_db;
_cf._debug("Function scheduled in",_12c,"ms, interval =",_de.interval,"backoff =",_db,_12b);
_dc=org.cometd.Utils.setTimeout(_cf,_12b,_12c);
};
var _12d;
var _12e;
function _12f(sync,_130,_131,_132){
for(var i=0;i<_130.length;++i){
var _133=_130[i];
var _134=""+_10c();
_133.id=_134;
if(_d6){
_133.clientId=_d6;
}
var _135=undefined;
if(_f3(_133._callback)){
_135=_133._callback;
delete _133._callback;
}
_133=_119(_133);
if(_133!==undefined&&_133!==null){
_133.id=_134;
_130[i]=_133;
if(_135){
_e1[_134]=_135;
}
}else{
_130.splice(i--,1);
}
}
if(_130.length===0){
return;
}
var url=_cf.getURL();
if(_e4.appendMessageTypeToURL){
if(!url.match(/\/$/)){
url=url+"/";
}
if(_132){
url=url+_132;
}
}
var _136={url:url,sync:sync,messages:_130,onSuccess:function(_137){
try{
_12d.call(_cf,_137);
}
catch(x){
_cf._debug("Exception during handling of messages",x);
}
},onFailure:function(_138,_139,_13a){
try{
var _13b=_cf.getTransport();
_13a.connectionType=_13b?_13b.getType():"unknown";
_12e.call(_cf,_138,_139,_13a);
}
catch(x){
_cf._debug("Exception during handling of failure",x);
}
}};
_cf._debug("Send",_136);
_d3.send(_136,_131);
};
function _13c(_13d){
if(_d7>0||_d9===true){
_d8.push(_13d);
}else{
_12f(false,[_13d],false);
}
};
this.send=_13c;
function _13e(){
_db=0;
};
function _13f(){
if(_db<_e4.maxBackoff){
_db+=_e4.backoffIncrement;
}
};
function _140(){
++_d7;
};
function _141(){
var _142=_d8;
_d8=[];
if(_142.length>0){
_12f(false,_142,false);
}
};
function _143(){
--_d7;
if(_d7<0){
throw "Calls to startBatch() and endBatch() are not paired";
}
if(_d7===0&&!_10b()&&!_d9){
_141();
}
};
function _144(){
if(!_10b()){
var _145={channel:"/meta/connect",connectionType:_d3.getType()};
if(!_e3){
_145.advice={timeout:0};
}
_109("connecting");
_cf._debug("Connect sent",_145);
_12f(false,[_145],true,"connect");
_109("connected");
}
};
function _146(){
_109("connecting");
_12a(function(){
_144();
});
};
function _147(_148){
if(_148){
_de=_cf._mixin(false,{},_e4.advice,_148);
_cf._debug("New advice",_de);
}
};
function _149(_14a){
_129();
if(_14a&&_d3){
_d3.abort();
}
_d6=null;
_109("disconnected");
_d7=0;
_13e();
_d3=null;
if(_d8.length>0){
var _14b=_d8;
_d8=[];
_12e.call(_cf,undefined,_14b,{reason:"Disconnected"});
}
};
function _14c(_14d,_14e,_14f){
var _150=_cf.onTransportFailure;
if(_f3(_150)){
_cf._debug("Invoking transport failure callback",_14d,_14e,_14f);
try{
_150.call(_cf,_14d,_14e,_14f);
}
catch(x){
_cf._info("Exception during execution of transport failure callback",x);
}
}
};
function _151(_152,_153){
if(_f3(_152)){
_153=_152;
_152=undefined;
}
_d6=null;
_106();
if(_10b()){
_d2.reset();
_147(_e4.advice);
}else{
_147(_cf._mixin(false,_de,{reconnect:"retry"}));
}
_d7=0;
_d9=true;
_df=_152;
_e0=_153;
var _154="1.0";
var url=_cf.getURL();
var _155=_d2.findTransportTypes(_154,_d1,url);
var _156={version:_154,minimumVersion:_154,channel:"/meta/handshake",supportedConnectionTypes:_155,_callback:_153,advice:{timeout:_de.timeout,interval:_de.interval}};
var _157=_cf._mixin(false,{},_df,_156);
if(!_d3){
_d3=_d2.negotiateTransport(_155,_154,_d1,url);
if(!_d3){
var _158="Could not find initial transport among: "+_d2.getTransportTypes();
_cf._warn(_158);
throw _158;
}
}
_cf._debug("Initial transport is",_d3.getType());
_109("handshaking");
_cf._debug("Handshake sent",_157);
_12f(false,[_157],false,"handshake");
};
function _159(){
_109("handshaking");
_d9=true;
_12a(function(){
_151(_df,_e0);
});
};
function _15a(_15b){
var _15c=_e1[_15b.id];
if(_f3(_15c)){
delete _e1[_15b.id];
_15c.call(_cf,_15b);
}
};
function _15d(_15e){
_15a(_15e);
_124("/meta/handshake",_15e);
_124("/meta/unsuccessful",_15e);
var _15f=!_10b()&&_de.reconnect!=="none";
if(_15f){
_13f();
_159();
}else{
_149(false);
}
};
function _160(_161){
if(_161.successful){
_d6=_161.clientId;
var url=_cf.getURL();
var _162=_d2.negotiateTransport(_161.supportedConnectionTypes,_161.version,_d1,url);
if(_162===null){
var _163="Could not negotiate transport with server; client=["+_d2.findTransportTypes(_161.version,_d1,url)+"], server=["+_161.supportedConnectionTypes+"]";
var _164=_cf.getTransport();
_14c(_164.getType(),null,{reason:_163,connectionType:_164.getType(),transport:_164});
_cf._warn(_163);
_149(true);
return;
}else{
if(_d3!==_162){
_cf._debug("Transport",_d3.getType(),"->",_162.getType());
_d3=_162;
}
}
_d9=false;
_141();
_161.reestablish=_e2;
_e2=true;
_15a(_161);
_124("/meta/handshake",_161);
var _165=_10b()?"none":_de.reconnect;
switch(_165){
case "retry":
_13e();
_146();
break;
case "none":
_149(false);
break;
default:
throw "Unrecognized advice action "+_165;
}
}else{
_15d(_161);
}
};
function _166(_167){
var _168="1.0";
var url=_cf.getURL();
var _169=_cf.getTransport();
var _16a=_d2.findTransportTypes(_168,_d1,url);
var _16b=_d2.negotiateTransport(_16a,_168,_d1,url);
if(!_16b){
_14c(_169.getType(),null,_167.failure);
_cf._warn("Could not negotiate transport; client=["+_16a+"]");
_149(true);
_15d(_167);
}else{
_cf._debug("Transport",_169.getType(),"->",_16b.getType());
_14c(_169.getType(),_16b.getType(),_167.failure);
_15d(_167);
_d3=_16b;
}
};
function _16c(_16d){
_124("/meta/connect",_16d);
_124("/meta/unsuccessful",_16d);
var _16e=_10b()?"none":_de.reconnect;
switch(_16e){
case "retry":
_146();
_13f();
break;
case "handshake":
_d2.reset();
_13e();
_159();
break;
case "none":
_149(false);
break;
default:
throw "Unrecognized advice action"+_16e;
}
};
function _16f(_170){
_e3=_170.successful;
if(_e3){
_124("/meta/connect",_170);
var _171=_10b()?"none":_de.reconnect;
switch(_171){
case "retry":
_13e();
_146();
break;
case "none":
_149(false);
break;
default:
throw "Unrecognized advice action "+_171;
}
}else{
_16c(_170);
}
};
function _172(_173){
_e3=false;
_16c(_173);
};
function _174(_175){
_149(true);
_15a(_175);
_124("/meta/disconnect",_175);
_124("/meta/unsuccessful",_175);
};
function _176(_177){
if(_177.successful){
_149(false);
_15a(_177);
_124("/meta/disconnect",_177);
}else{
_174(_177);
}
};
function _178(_179){
_174(_179);
};
function _17a(_17b){
var _17c=_da[_17b.subscription];
if(_17c){
for(var i=_17c.length-1;i>=0;--i){
var _17d=_17c[i];
if(_17d&&!_17d.listener){
delete _17c[i];
_cf._debug("Removed failed subscription",_17d);
break;
}
}
}
_15a(_17b);
_124("/meta/subscribe",_17b);
_124("/meta/unsuccessful",_17b);
};
function _17e(_17f){
if(_17f.successful){
_15a(_17f);
_124("/meta/subscribe",_17f);
}else{
_17a(_17f);
}
};
function _180(_181){
_17a(_181);
};
function _182(_183){
_15a(_183);
_124("/meta/unsubscribe",_183);
_124("/meta/unsuccessful",_183);
};
function _184(_185){
if(_185.successful){
_15a(_185);
_124("/meta/unsubscribe",_185);
}else{
_182(_185);
}
};
function _186(_187){
_182(_187);
};
function _188(_189){
_15a(_189);
_124("/meta/publish",_189);
_124("/meta/unsuccessful",_189);
};
function _18a(_18b){
if(_18b.successful===undefined){
if(_18b.data!==undefined){
_124(_18b.channel,_18b);
}else{
_cf._warn("Unknown Bayeux Message",_18b);
}
}else{
if(_18b.successful){
_15a(_18b);
_124("/meta/publish",_18b);
}else{
_188(_18b);
}
}
};
function _18c(_18d){
_188(_18d);
};
function _18e(_18f){
_18f=_113(_18f);
if(_18f===undefined||_18f===null){
return;
}
_147(_18f.advice);
var _190=_18f.channel;
switch(_190){
case "/meta/handshake":
_160(_18f);
break;
case "/meta/connect":
_16f(_18f);
break;
case "/meta/disconnect":
_176(_18f);
break;
case "/meta/subscribe":
_17e(_18f);
break;
case "/meta/unsubscribe":
_184(_18f);
break;
default:
_18a(_18f);
break;
}
};
this.receive=_18e;
_12d=function(_191){
_cf._debug("Received",_191);
for(var i=0;i<_191.length;++i){
var _192=_191[i];
_18e(_192);
}
};
_12e=function(_193,_194,_195){
_cf._debug("handleFailure",_193,_194,_195);
_195.transport=_193;
for(var i=0;i<_194.length;++i){
var _196=_194[i];
var _197={id:_196.id,successful:false,channel:_196.channel,failure:_195};
_195.message=_196;
switch(_196.channel){
case "/meta/handshake":
_166(_197);
break;
case "/meta/connect":
_172(_197);
break;
case "/meta/disconnect":
_178(_197);
break;
case "/meta/subscribe":
_197.subscription=_196.subscription;
_180(_197);
break;
case "/meta/unsubscribe":
_197.subscription=_196.subscription;
_186(_197);
break;
default:
_18c(_197);
break;
}
}
};
function _198(_199){
var _19a=_da[_199];
if(_19a){
for(var i=0;i<_19a.length;++i){
if(_19a[i]){
return true;
}
}
}
return false;
};
function _19b(_19c,_19d){
var _19e={scope:_19c,method:_19d};
if(_f3(_19c)){
_19e.scope=undefined;
_19e.method=_19c;
}else{
if(_f1(_19d)){
if(!_19c){
throw "Invalid scope "+_19c;
}
_19e.method=_19c[_19d];
if(!_f3(_19e.method)){
throw "Invalid callback "+_19d+" for scope "+_19c;
}
}else{
if(!_f3(_19d)){
throw "Invalid callback "+_19d;
}
}
}
return _19e;
};
function _19f(_1a0,_1a1,_1a2,_1a3){
var _1a4=_19b(_1a1,_1a2);
_cf._debug("Adding",_1a3?"listener":"subscription","on",_1a0,"with scope",_1a4.scope,"and callback",_1a4.method);
var _1a5={channel:_1a0,scope:_1a4.scope,callback:_1a4.method,listener:_1a3};
var _1a6=_da[_1a0];
if(!_1a6){
_1a6=[];
_da[_1a0]=_1a6;
}
_1a5.id=_1a6.push(_1a5)-1;
_cf._debug("Added",_1a3?"listener":"subscription",_1a5);
_1a5[0]=_1a0;
_1a5[1]=_1a5.id;
return _1a5;
};
this.registerTransport=function(type,_1a7,_1a8){
var _1a9=_d2.add(type,_1a7,_1a8);
if(_1a9){
this._debug("Registered transport",type);
if(_f3(_1a7.registered)){
_1a7.registered(type,this);
}
}
return _1a9;
};
this.getTransportTypes=function(){
return _d2.getTransportTypes();
};
this.unregisterTransport=function(type){
var _1aa=_d2.remove(type);
if(_1aa!==null){
this._debug("Unregistered transport",type);
if(_f3(_1aa.unregistered)){
_1aa.unregistered();
}
}
return _1aa;
};
this.unregisterTransports=function(){
_d2.clear();
};
this.findTransport=function(name){
return _d2.find(name);
};
this.configure=function(_1ab){
_fa.call(this,_1ab);
};
this.init=function(_1ac,_1ad){
this.configure(_1ac);
this.handshake(_1ad);
};
this.handshake=function(_1ae,_1af){
_109("disconnected");
_e2=false;
_151(_1ae,_1af);
};
this.disconnect=function(sync,_1b0,_1b1){
if(_10b()){
return;
}
if(typeof sync!=="boolean"){
_1b1=_1b0;
_1b0=sync;
sync=false;
}
if(_f3(_1b0)){
_1b1=_1b0;
_1b0=undefined;
}
var _1b2={channel:"/meta/disconnect",_callback:_1b1};
var _1b3=this._mixin(false,{},_1b0,_1b2);
_109("disconnecting");
_12f(sync===true,[_1b3],false,"disconnect");
};
this.startBatch=function(){
_140();
};
this.endBatch=function(){
_143();
};
this.batch=function(_1b4,_1b5){
var _1b6=_19b(_1b4,_1b5);
this.startBatch();
try{
_1b6.method.call(_1b6.scope);
this.endBatch();
}
catch(x){
this._info("Exception during execution of batch",x);
this.endBatch();
throw x;
}
};
this.addListener=function(_1b7,_1b8,_1b9){
if(arguments.length<2){
throw "Illegal arguments number: required 2, got "+arguments.length;
}
if(!_f1(_1b7)){
throw "Illegal argument type: channel must be a string";
}
return _19f(_1b7,_1b8,_1b9,true);
};
this.removeListener=function(_1ba){
if(!_1ba||!_1ba.channel||!("id" in _1ba)){
throw "Invalid argument: expected subscription, not "+_1ba;
}
_101(_1ba);
};
this.clearListeners=function(){
_da={};
};
this.subscribe=function(_1bb,_1bc,_1bd,_1be,_1bf){
if(arguments.length<2){
throw "Illegal arguments number: required 2, got "+arguments.length;
}
if(!_f1(_1bb)){
throw "Illegal argument type: channel must be a string";
}
if(_10b()){
throw "Illegal state: already disconnected";
}
if(_f3(_1bc)){
_1bf=_1be;
_1be=_1bd;
_1bd=_1bc;
_1bc=undefined;
}
if(_f3(_1be)){
_1bf=_1be;
_1be=undefined;
}
var send=!_198(_1bb);
var _1c0=_19f(_1bb,_1bc,_1bd,false);
if(send){
var _1c1={channel:"/meta/subscribe",subscription:_1bb,_callback:_1bf};
var _1c2=this._mixin(false,{},_1be,_1c1);
_13c(_1c2);
}
return _1c0;
};
this.unsubscribe=function(_1c3,_1c4,_1c5){
if(arguments.length<1){
throw "Illegal arguments number: required 1, got "+arguments.length;
}
if(_10b()){
throw "Illegal state: already disconnected";
}
if(_f3(_1c4)){
_1c5=_1c4;
_1c4=undefined;
}
this.removeListener(_1c3);
var _1c6=_1c3.channel;
if(!_198(_1c6)){
var _1c7={channel:"/meta/unsubscribe",subscription:_1c6,_callback:_1c5};
var _1c8=this._mixin(false,{},_1c4,_1c7);
_13c(_1c8);
}
};
this.resubscribe=function(_1c9,_1ca){
_104(_1c9);
if(_1c9){
return this.subscribe(_1c9.channel,_1c9.scope,_1c9.callback,_1ca);
}
return undefined;
};
this.clearSubscriptions=function(){
_106();
};
this.publish=function(_1cb,_1cc,_1cd,_1ce){
if(arguments.length<1){
throw "Illegal arguments number: required 1, got "+arguments.length;
}
if(!_f1(_1cb)){
throw "Illegal argument type: channel must be a string";
}
if(/^\/meta\//.test(_1cb)){
throw "Illegal argument: cannot publish to meta channels";
}
if(_10b()){
throw "Illegal state: already disconnected";
}
if(_f3(_1cc)){
_1ce=_1cc;
_1cc=_1cd={};
}else{
if(_f3(_1cd)){
_1ce=_1cd;
_1cd={};
}
}
var _1cf={channel:_1cb,data:_1cc,_callback:_1ce};
var _1d0=this._mixin(false,{},_1cd,_1cf);
_13c(_1d0);
};
this.getStatus=function(){
return _d4;
};
this.isDisconnected=_10b;
this.setBackoffIncrement=function(_1d1){
_e4.backoffIncrement=_1d1;
};
this.getBackoffIncrement=function(){
return _e4.backoffIncrement;
};
this.getBackoffPeriod=function(){
return _db;
};
this.setLogLevel=function(_1d2){
_e4.logLevel=_1d2;
};
this.registerExtension=function(name,_1d3){
if(arguments.length<2){
throw "Illegal arguments number: required 2, got "+arguments.length;
}
if(!_f1(name)){
throw "Illegal argument type: extension name must be a string";
}
var _1d4=false;
for(var i=0;i<_dd.length;++i){
var _1d5=_dd[i];
if(_1d5.name===name){
_1d4=true;
break;
}
}
if(!_1d4){
_dd.push({name:name,extension:_1d3});
this._debug("Registered extension",name);
if(_f3(_1d3.registered)){
_1d3.registered(name,this);
}
return true;
}else{
this._info("Could not register extension with name",name,"since another extension with the same name already exists");
return false;
}
};
this.unregisterExtension=function(name){
if(!_f1(name)){
throw "Illegal argument type: extension name must be a string";
}
var _1d6=false;
for(var i=0;i<_dd.length;++i){
var _1d7=_dd[i];
if(_1d7.name===name){
_dd.splice(i,1);
_1d6=true;
this._debug("Unregistered extension",name);
var ext=_1d7.extension;
if(_f3(ext.unregistered)){
ext.unregistered();
}
break;
}
}
return _1d6;
};
this.getExtension=function(name){
for(var i=0;i<_dd.length;++i){
var _1d8=_dd[i];
if(_1d8.name===name){
return _1d8.extension;
}
}
return null;
};
this.getName=function(){
return _d0;
};
this.getClientId=function(){
return _d6;
};
this.getURL=function(){
if(_d3&&typeof _e4.urls==="object"){
var url=_e4.urls[_d3.getType()];
if(url){
return url;
}
}
return _e4.url;
};
this.getTransport=function(){
return _d3;
};
this.getConfiguration=function(){
return this._mixin(true,{},_e4);
};
this.getAdvice=function(){
return this._mixin(true,{},_de);
};
org.cometd.WebSocket=window.WebSocket;
if(!org.cometd.WebSocket){
org.cometd.WebSocket=window.MozWebSocket;
}
};
if(typeof define==="function"){
define("cometd-dojo/org/cometd",function(){
return org.cometd;
});
}


;define("dojo/request/script",["module","./watch","./util","../_base/kernel","../_base/array","../_base/lang","../on","../dom","../dom-construct","../has","../_base/window"],function(_1,_2,_3,_4,_5,_6,on,_7,_8,_9,_a){
_9.add("script-readystatechange",function(_b,_c){
var _d=_c.createElement("script");
return typeof _d["onreadystatechange"]!=="undefined"&&(typeof _b["opera"]==="undefined"||_b["opera"].toString()!=="[object Opera]");
});
var _e=_1.id.replace(/[\/\.\-]/g,"_"),_f=0,_10=_9("script-readystatechange")?"readystatechange":"load",_11=/complete|loaded/,_12=_4.global[_e+"_callbacks"]={},_13=[];
function _14(id,url,_15){
var doc=(_15||_a.doc),_16=doc.createElement("script");
_16.type="text/javascript";
_16.src=url;
_16.id=id;
_16.async=true;
_16.charset="utf-8";
return doc.getElementsByTagName("head")[0].appendChild(_16);
};
function _17(id,_18,_19){
_8.destroy(_7.byId(id,_18));
if(_12[id]){
if(_19){
_12[id]=function(){
delete _12[id];
};
}else{
delete _12[id];
}
}
};
function _1a(dfd){
var _1b=dfd.response.options,_1c=_1b.ioArgs?_1b.ioArgs.frameDoc:_1b.frameDoc;
_13.push({id:dfd.id,frameDoc:_1c});
if(_1b.ioArgs){
_1b.ioArgs.frameDoc=null;
}
_1b.frameDoc=null;
};
function _1d(dfd,_1e){
if(dfd.canDelete){
_1f._remove(dfd.id,_1e.options.frameDoc,true);
}
};
function _20(_21){
if(_13&&_13.length){
_5.forEach(_13,function(_22){
_1f._remove(_22.id,_22.frameDoc);
_22.frameDoc=null;
});
_13=[];
}
return _21.options.jsonp?!_21.data:true;
};
function _23(_24){
return !!this.scriptLoaded;
};
function _25(_26){
var _27=_26.options.checkString;
return _27&&eval("typeof("+_27+") !== \"undefined\"");
};
function _28(_29,_2a){
if(this.canDelete){
_1a(this);
}
if(_2a){
this.reject(_2a);
}else{
this.resolve(_29);
}
};
function _1f(url,_2b,_2c){
var _2d=_3.parseArgs(url,_3.deepCopy({},_2b));
url=_2d.url;
_2b=_2d.options;
var dfd=_3.deferred(_2d,_1d,_20,_2b.jsonp?null:(_2b.checkString?_25:_23),_28);
_6.mixin(dfd,{id:_e+(_f++),canDelete:false});
if(_2b.jsonp){
var _2e=new RegExp("[?&]"+_2b.jsonp+"=");
if(!_2e.test(url)){
url+=(~url.indexOf("?")?"&":"?")+_2b.jsonp+"="+(_2b.frameDoc?"parent.":"")+_e+"_callbacks."+dfd.id;
}
dfd.canDelete=true;
_12[dfd.id]=function(_2f){
_2d.data=_2f;
dfd.handleResponse(_2d);
};
}
if(_3.notify){
_3.notify.emit("send",_2d,dfd.promise.cancel);
}
if(!_2b.canAttach||_2b.canAttach(dfd)){
var _30=_1f._attach(dfd.id,url,_2b.frameDoc);
if(!_2b.jsonp&&!_2b.checkString){
var _31=on(_30,_10,function(evt){
if(evt.type==="load"||_11.test(_30.readyState)){
_31.remove();
dfd.scriptLoaded=evt;
}
});
}
}
_2(dfd);
return _2c?dfd:dfd.promise;
};
_1f.get=_1f;
_1f._attach=_14;
_1f._remove=_17;
_1f._callbacksProperty=_e+"_callbacks";
return _1f;
});


;define("dojo/io/script",["../_base/connect","../_base/kernel","../_base/lang","../sniff","../_base/window","../_base/xhr","../dom","../dom-construct","../request/script","../aspect"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
_2.deprecated("dojo/io/script","Use dojo/request/script.","2.0");
var _b={get:function(_c){
var _d;
var _e=this._makeScriptDeferred(_c,function(_f){
_d&&_d.cancel();
});
var _10=_e.ioArgs;
_6._ioAddQueryToUrl(_10);
_6._ioNotifyStart(_e);
_d=_9.get(_10.url,{timeout:_c.timeout,jsonp:_10.jsonp,checkString:_c.checkString,ioArgs:_10,frameDoc:_c.frameDoc,canAttach:function(_11){
_10.requestId=_11.id;
_10.scriptId=_11.scriptId;
_10.canDelete=_11.canDelete;
return _b._canAttach(_10);
}},true);
_a.around(_d,"isValid",function(_12){
return function(_13){
_b._validCheck(_e);
return _12.call(this,_13);
};
});
_d.then(function(){
_e.resolve(_e);
}).otherwise(function(_14){
_e.ioArgs.error=_14;
_e.reject(_14);
});
return _e;
},attach:_9._attach,remove:_9._remove,_makeScriptDeferred:function(_15,_16){
var dfd=_6._ioSetArgs(_15,_16||this._deferredCancel,this._deferredOk,this._deferredError);
var _17=dfd.ioArgs;
_17.id=_2._scopeName+"IoScript"+(this._counter++);
_17.canDelete=false;
_17.jsonp=_15.callbackParamName||_15.jsonp;
if(_17.jsonp){
_17.query=_17.query||"";
if(_17.query.length>0){
_17.query+="&";
}
_17.query+=_17.jsonp+"="+(_15.frameDoc?"parent.":"")+_2._scopeName+".io.script.jsonp_"+_17.id+"._jsonpCallback";
_17.frameDoc=_15.frameDoc;
_17.canDelete=true;
dfd._jsonpCallback=this._jsonpCallback;
this["jsonp_"+_17.id]=dfd;
}
dfd.addBoth(function(_18){
if(_17.canDelete){
if(_18 instanceof Error){
_b["jsonp_"+_17.id]._jsonpCallback=function(){
delete _b["jsonp_"+_17.id];
if(_17.requestId){
_2.global[_9._callbacksProperty][_17.requestId]();
}
};
}else{
_b._addDeadScript(_17);
}
}
});
return dfd;
},_deferredCancel:function(dfd){
dfd.canceled=true;
},_deferredOk:function(dfd){
var _19=dfd.ioArgs;
return _19.json||_19.scriptLoaded||_19;
},_deferredError:function(_1a,dfd){
console.log("dojo.io.script error",_1a);
return _1a;
},_deadScripts:[],_counter:1,_addDeadScript:function(_1b){
_b._deadScripts.push({id:_1b.id,frameDoc:_1b.frameDoc});
_1b.frameDoc=null;
},_validCheck:function(dfd){
var _1c=_b._deadScripts;
if(_1c&&_1c.length>0){
for(var i=0;i<_1c.length;i++){
_b.remove(_1c[i].id,_1c[i].frameDoc);
delete _b["jsonp_"+_1c[i].id];
_1c[i].frameDoc=null;
}
_b._deadScripts=[];
}
return true;
},_ioCheck:function(dfd){
var _1d=dfd.ioArgs;
if(_1d.json||(_1d.scriptLoaded&&!_1d.args.checkString)){
return true;
}
var _1e=_1d.args.checkString;
return _1e&&eval("typeof("+_1e+") != 'undefined'");
},_resHandle:function(dfd){
if(_b._ioCheck(dfd)){
dfd.callback(dfd);
}else{
dfd.errback(new Error("inconceivable dojo.io.script._resHandle error"));
}
},_canAttach:function(){
return true;
},_jsonpCallback:function(_1f){
this.ioArgs.json=_1f;
if(this.ioArgs.requestId){
_2.global[_9._callbacksProperty][this.ioArgs.requestId](_1f);
}
}};
_3.setObject("dojo.io.script",_b);
return _b;
});


;define("cometd-dojo/cometd",["cometd-dojo/org/cometd","dojo/json","dojox","dojo/_base/xhr","dojo/io/script","dojo/topic"],function(_1,_2,_3,_4,_5,_6){
_1.JSON.toJSON=_2.stringify;
_1.JSON.fromJSON=_2.parse;
_3.Cometd=function(_7){
var _8=new _1.Cometd(_7);
function _9(){
var _a=new _1.LongPollingTransport();
var _b=_1.Transport.derive(_a);
_b.xhrSend=function(_c){
var _d=_4.post({url:_c.url,sync:_c.sync===true,contentType:"application/json;charset=UTF-8",headers:_c.headers,postData:_c.body,withCredentials:true,handleAs:"json",load:_c.onSuccess,error:function(_e){
_c.onError(_e.message,_d?_d.ioArgs.error:_e);
}});
return _d.ioArgs.xhr;
};
return _b;
};
function _f(){
var _10=new _1.CallbackPollingTransport();
var _11=_1.Transport.derive(_10);
_11.jsonpSend=function(_12){
var _13=_5.get({url:_12.url,sync:_12.sync===true,callbackParamName:"jsonp",content:{message:_12.body},load:_12.onSuccess,error:function(_14){
_12.onError(_14.message,_13?_13.ioArgs.error:_14);
}});
return undefined;
};
return _11;
};
if(_1.WebSocket){
_8.registerTransport("websocket",new _1.WebSocketTransport());
}
_8.registerTransport("long-polling",new _9());
_8.registerTransport("callback-polling",new _f());
return _8;
};
var _15=new _3.Cometd();
_3.cometd=_15;
_15._init=_15.init;
_15._unsubscribe=_15.unsubscribe;
_15.unsubscribe=function(_16,_17,_18){
if(typeof _16==="string"){
throw "Deprecated function unsubscribe(string). Use unsubscribe(object) passing as argument the return value of subscribe()";
}
_15._unsubscribe.apply(_15,arguments);
};
_15._metaHandshakeEvent=function(_19){
_19.action="handshake";
_6.publish("/cometd/meta",_19);
};
_15._metaConnectEvent=function(_1a){
_1a.action="connect";
_6.publish("/cometd/meta",_1a);
};
_15.addListener("/meta/handshake",_15,_15._metaHandshakeEvent);
_15.addListener("/meta/connect",_15,_15._metaConnectEvent);
return _15;
});


;define("ic-as/notification/util/ICCometChannel",["dojo/_base/declare"],function(_1){
var _2=_1(null,{_channelId:null,_callback:null,constructor:function(_3,_4){
this._channelId=_3;
this._callback=_4;
},getChannelId:function(){
return this._channelId;
},getChannelCallback:function(){
return this._callback;
}});
return _2;
});


;(function(){
function _1(_2){
if(!_2.COOKIE){
_2.COOKIE={};
_2.COOKIE.set=function(_3,_4,_5){
throw "Abstract";
};
_2.COOKIE.get=function(_6){
throw "Abstract";
};
}
return _2.ReloadExtension=function(_7){
var _8;
var _9;
var _a=null;
var _b="org.cometd.reload";
var _c="/";
var _d=5;
var _e=false;
function _f(_10){
if(_a&&_a.handshakeResponse!==null){
_11(_10);
_a.cookiePath=_c;
var _12=_2.JSON.toJSON(_a);
_9("Reload extension saving cookie value",_12);
_2.COOKIE.set(_b,_12,{"max-age":_d,path:_c,expires:new Date(new Date().getTime()+_d*1000)});
}
};
function _13(_14){
return _a.url==_14.url;
};
function _11(_15){
if(_15){
if(typeof _15.cookieMaxAge==="number"){
_d=_15.cookieMaxAge;
}
if(typeof _15.cookieName==="string"){
_b=_15.cookieName;
}
if(typeof _15.cookiePath==="string"){
_c=_15.cookiePath;
}
}
};
this.configure=_11;
this.registered=function(_16,_17){
_8=_17;
_8.reload=_f;
_9=_8._debug;
};
this.unregistered=function(){
delete _8.reload;
_8=null;
};
this.outgoing=function(_18){
switch(_18.channel){
case "/meta/handshake":
_a={};
_a.url=_8.getURL();
var _19=_2.COOKIE.get(_b);
_9("Reload extension found cookie value",_19);
if(_19){
try{
var _1a=_2.JSON.fromJSON(_19);
_2.COOKIE.set(_b,"",{"max-age":-1,path:_1a.cookiePath,expires:-1});
if(_1a.handshakeResponse&&_13(_1a)){
_9("Reload extension restoring state",_1a);
setTimeout(function(){
_9("Reload extension replaying handshake response",_1a.handshakeResponse);
_a.handshakeResponse=_1a.handshakeResponse;
_a.transportType=_1a.transportType;
_a.reloading=true;
var _1b=_8._mixin(true,{},_a.handshakeResponse,{ext:{reload:true}});
_1b.supportedConnectionTypes=[_a.transportType];
_8.receive(_1b);
_9("Reload extension replayed handshake response",_1b);
},0);
if(!_e){
_e=true;
_8.startBatch();
}
return null;
}else{
_9("Reload extension could not restore state",_1a);
}
}
catch(x){
_9("Reload extension error while trying to restore cookie",x);
}
}
break;
case "/meta/connect":
if(!_a.transportType){
_a.transportType=_18.connectionType;
_9("Reload extension tracked transport type",_a.transportType);
}
break;
case "/meta/disconnect":
_a=null;
break;
default:
break;
}
return _18;
};
this.incoming=function(_1c){
if(_1c.successful){
switch(_1c.channel){
case "/meta/handshake":
if(!_a.handshakeResponse){
_a.handshakeResponse=_1c;
_9("Reload extension tracked handshake response",_1c);
}
break;
case "/meta/disconnect":
_a=null;
break;
case "/meta/connect":
if(_e){
_8.endBatch();
_e=false;
}
break;
default:
break;
}
}
return _1c;
};
_11(_7);
};
};
if(typeof define==="function"){
define("cometd-dojo/org/cometd/ReloadExtension",["cometd-dojo/org/cometd"],_1);
}else{
_1(org.cometd);
}
})();


;define("dojox/cometd",["cometd-dojo/cometd"],function(_1){
return _1;
});


;define("cometd-dojo/cometd/reload",["cometd-dojo/org/cometd","dojo/cookie","cometd-dojo/org/cometd/ReloadExtension","dojox/cometd"],function(_1,_2,_3,_4){
_1.COOKIE.set=_2;
_1.COOKIE.get=_2;
var _5=new _3();
_4.registerExtension("reload",_5);
return _5;
});


;define("ic-as/notification/util/_ICCometService",["dojo/_base/declare","dojo/_base/config","cometd-dojo/cometd","dojo/_base/array","dojo/_base/lang","dojo/_base/unload","dojo/json","./ICCometChannel","ic-core/config/services","ic-core/url","ic-as/notification/util/WindowBroadcastSupport","ic-as/util/xhr/XhrHandler","cometd-dojo/cometd/reload"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
var _d=_1(_b,{_internalSubscriptions:[],_subscriptions:[],_webSocketsEnabled:false,initCometD:function(){
this.initWindowBroadcastSupport();
},_initCometD:function(){
if(!_9.pushnotification){
console.warn("The push notification service is not enabled, aborting.");
return;
}
var _e=(_2.isDebug)?"debug":"info";
var _f=_a.getServiceUrl(_9.pushnotification)+"/form/comet";
setTimeout(_5.hitch(this,function(){
_3.configure({url:_f,backoffIncrement:this.generateRandomNumber(10000),maxBackoff:this.generateRandomNumber(300000),maxNetworkDelay:20000,logLevel:_e});
_3.getExtension("reload").configure({cookieMaxAge:100});
_3.websocketEnabled=this._webSocketsEnabled;
this.setupCometListener();
}),6000);
},generateRandomNumber:function(_10){
return Math.floor(_10+(Math.random()*200000));
},setupCometListener:function(){
var _11=this;
if(this.hasSubscriptions()){
_3.addListener("/meta/handshake",function(_12){
if(_12.successful){
var _13=_12.ext.channels;
_3.batch(function(){
_4.forEach(_11._subscriptions,function(_14){
var _15=_14.getChannelId();
if(_15==="news"){
if(!_13[_15]){
_15="news directed notifications";
}
}
if(_13[_15]&&_13[_15].url){
var _16=_13[_15].url;
_11._internalSubscriptions.push(_3.subscribe(_16,_3,function(_17){
_14.getChannelCallback()(_17);
if(_11.isMaster){
_17.icWindowChannel=true;
var _18={channelName:_15,payload:_17};
_11.windowBroadcast(_18);
}
}));
}else{
console.debug("comet chanel config not valid for: "+_14);
}
});
});
}else{
console.debug("fail to load comet");
}
});
window.addEventListener("pagehide",_5.hitch(this,function(){
_3.reload({cookieMaxAge:100});
_3.getTransport().abort();
}),false);
_6.addOnUnload(_5.hitch(this,function(){
try{
_3.getTransport().abort();
}
catch(e){
}
}));
this.initiateHandshake();
}
},initiateHandshake:function(){
var _19=_a.getServiceUrl(_9.pushnotification)+"/service/info";
_c.xhrGet({url:_19}).then(function(_1a){
_3.handshake();
},function(err){
console.log("Error connecting to push auth sync service /servic/info: "+err);
});
},stopCometD:function(){
_3.disconnect();
},hasSubscriptions:function(){
return this._subscriptions&&this._subscriptions.length>0;
},addCometChannelSubscription:function(_1b,_1c){
var _1d=new _8(_1b,_1c);
this._subscriptions.push(_1d);
},setWebSocketEnabled:function(_1e){
this._webSocketsEnabled=_1e;
},windowActivated:function(){
this.handleStorageEvent=function(_1f){
};
this._initCometD();
},windowDeactivated:function(){
var _20=this;
this.handleStorageEvent=function(_21){
var msg=_7.parse(_21.newValue);
if(msg.event&&msg.event.payload){
var _22=msg.event.channelName;
var _23=msg.event.payload;
if(_20._subscriptions.length>0){
_4.some(_20._subscriptions,function(_24){
if(_24&&_24.getChannelId()===_22){
_24.getChannelCallback()(_23);
return true;
}
});
}
}
};
}});
return _d;
});


;define("ic-as/notification/util/ICCometService",["./_ICCometService","dojo/_base/lang","dojo/ready"],function(_1,_2,_3){
var _4=new _1();
_3(function(){
setTimeout(_2.hitch(this,function(){
_4.initCometD();
}),8000);
});
return _4;
});


;define("ic-core/theme",["dojo/_base/array","dojo/_base/config","dojo/_base/lang","dojo/_base/window","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/dom-geometry","dojo/has","dojo/query","ic-core/util/Url","ic-core/config","ic-core/config/features","ic-core/config/properties","ic-core/config/services","ic-core/url"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_9,_d,_e,_f){
var _10,_11,_12,_13,_14,_15,_16,_17;
var _18="_css_url_rewriter";
window[_18]=typeof window[_18]==="function"?window[_18]:function(url){
return url;
};
var _19="lotusBaseStylesheet",_1a="lotusAppStylesheet",_1b="lotusThemeStylesheet",_1c="lotusSpritesStylesheet",_1d="stylesheet";
var _1e="com.ibm.lconn.core.web.styles.theme.default",_1f="default",_20="hikari",_21="gen4";
function _22(){
return _9("hikari-default-theme")?_20:(_d[_1e]||_21);
};
function _23(){
var _24=_5.byId(_19),_25=_5.byId(_1b),_26=_5.byId(_1c),_27=_5.byId(_1a);
if(!_14&&_24){
_16=_6.get(_24,"base")||_6.get(_24,"href").substr(0,_6.get(_24,"href").indexOf("_style"));
_14=new _b(_16);
_14.query=_6.get(_24,"query")||(_25?_6.get(_25,"href").substr(_6.get(_25,"href").indexOf("?")):"");
_13=_14.path;
_15=_10=_6.get(_24,"theme")||_22();
_11=_6.get(_24,"defaultTheme")||_10;
_12=_6.get(_24,"appName")||_3.getObject("ibmConfig.serviceName");
_16+="com.ibm.lconn.core.styles.oneui"+(_6.get(_24,"oneui")||3)+"/";
_17="?etag="+encodeURIComponent(_14.getQuery().etag);
}
return {baseLink:_24,themeLink:_25,spritesLink:_26,appLink:_27};
};
function _28(_29){
if(_29){
_29.id="";
setTimeout(function(){
var _2a=_29.parentNode;
if(_2a){
_2a.removeChild(_29);
}
},1);
}
return _29;
};
function _2b(){
return !_8.isBodyLtr();
};
function _2c(){
return _f.getServiceUrl(_e.webresources);
};
function _2d(_2e,_2f){
if(_2e){
_2f=_2f||{};
if(_2.isDebug){
_2f.debug=true;
}else{
_2f.etag=encodeURIComponent(_3.getObject("ibmConfig.versionStamp"));
}
_2e=new _b(_f.rewrite(_2e,_2f));
}
return window[_18](_2e);
};
var _30=0;
function seq(){
return _30++;
};
function _31(_32,_33){
if(_9("ie")>=9){
return document.createStyleSheet(_33.toString()).owningElement;
}else{
s=_32.cloneNode(true);
s.href=_33.toString();
return s;
}
};
var _34={};
_3.mixin(_34,{addBaseStylesheet:function(){
_23();
if(!_5.byId(_19)){
var _35=_2d(_2c()+"/web/_style",{"include":_2b()?"com.ibm.lconn.core.styles.oneui3/base/package3RTL.css":"com.ibm.lconn.core.styles.oneui3/base/package3.css"});
if(!_2.isDebug){
_35.query+="&etag="+encodeURIComponent(_3.getObject("ibmConfig.versionStamp"));
}
var _36=_7.create("link",{id:_19,rel:_1d,path:_35.path,query:_35.query,href:_35.toString()},_a("head")[0]);
}
return this;
},addSpritesStylesheet:function(){
_23();
if(!_5.byId(_1c)){
var _37=_2d(_2c()+"/web/_style",{"include":_2b()?"com.ibm.lconn.core.styles.oneui3/spritesRTL.css":"com.ibm.lconn.core.styles.oneui3/sprites.css"});
if(!_2.isDebug){
_37.query+="&etag="+encodeURIComponent(_3.getObject("ibmConfig.versionStamp"));
}
var _38=_7.create("link",{id:_1c,rel:_1d,path:_37.path,query:_37.query,href:_37.toString()},_a("head")[0]);
}
return this;
},addThemeStylesheet:function(_39){
_23();
_39=_39||_15;
if(!_5.byId(_1b)){
var _3a=_2d(_2c()+"/web/_lconntheme/"+encodeURIComponent(_39)+".css",{"version":"oneui3","rtl":_2b()});
var _3b=_7.create("link",{id:_1b,rel:_1d,path:_3a.path,query:_3a.query,href:_3a.toString()},_a("head")[0]);
}else{
console.warn("Theme stylesheet '%s' already included in this page",_15);
}
return this;
},addAppStylesheet:function(_3c,_3d){
_23();
_3c=_3c||_12;
_3d=_3d||_15;
if(!_5.byId(_1a)){
var _3e=_2d(_2c()+"/web/_lconnappstyles/"+encodeURIComponent(_3d)+"/"+encodeURIComponent(_3c)+".css",{"version":"oneui3","rtl":_2b()});
var _3f=_7.create("link",{id:_1a,rel:_1d,path:_3e.path,query:_3e.query,href:_3e.toString()},_a("head")[0]);
}else{
console.warn("Application stylesheet '%s' with theme '%s' already included in this page",_12,_15);
}
return this;
},addStylesheet:function(_40,_41){
if(!_40){
return;
}
_23();
_41=_41||_15;
if(1){
var _42=_2d(_2c()+"/web/_lconnappstyles/"+encodeURIComponent(_41)+"/"+encodeURIComponent(_40)+".css",{"version":"oneui3","rtl":_2b()});
var _43=_7.create("link",{id:"lotusStylesheet_"+seq(),rel:_1d,path:_42.path,query:_42.query,href:_42.toString()},_a("head")[0]);
}
return this;
},addAllStylesheets:function(_44,_45){
this.addBaseStylesheet().addSpritesStylesheet().addThemeStylesheet(_45).addAppStylesheet(_44,_45);
},getUrl:function(_46){
_23();
return _2d(_16+_46);
},switchTheme:function(_47,_48){
var _49=_23(),_4a=_49.baseLink,_4b=_49.spritesLink;
if(!_47){
_47=_10;
}
if(_47===_1f&&!_48){
_47=_22();
}
if(_47==_15||!_4a){
return;
}
_15=_47;
var _4c=encodeURIComponent(_47);
if(_47){
_28(_5.byId(_1b));
_14.path=_13+"_lconntheme/"+_4c+".css";
themeLink=_31(_4a,_14);
themeLink.id=_1b;
_7.place(themeLink,_4b,"after");
if(_12){
_28(_5.byId(_1a));
_14.path=_13+"_lconnappstyles/"+_4c+"/"+encodeURIComponent(_12)+".css";
appLink=_31(_4a,_14);
appLink.id=_1a;
_7.place(appLink,themeLink,"after");
}
}
},flip:function(dir){
_23();
if(dir===undefined){
dir=_2b()?"ltr":"rtl";
}
_1.forEach(document.querySelectorAll("[dir]"),function(el){
el.setAttribute("dir",dir);
});
_4.doc.documentElement.dir=dir;
_28(_5.byId(_19));
_28(_5.byId(_1c));
_28(_5.byId(_1a));
_28(_5.byId(_1b));
this.addAllStylesheets();
},getCurrentThemeId:function(){
_23();
return _15;
}});
return _34;
});


;define("ic-as/notification/NotificationCenter",["dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/_base/array","dojo/query","dojo/topic","dojo/date","dojo/date/stamp","dojo/on","dojo/keys","dojo/mouse","dojo/_base/event","dojo/dom-attr","dojo/dom-geometry","dojo/aspect","dojo/ready","ic-as/notification/view/NotificationsFlyout","ic-as/notification/badging/NotificationCenterBadgeController","ic-as/notification/badging/NotificationCenterInlineBadge","ic-as/notification/util/keys","ic-as/notification/util/NCKeys","ic-as/constants/events","ic-as/notification/config/NotificationCenterLivePreviewPrefs","ic-as/notification/NotificationPoll","ic-as/util/RouteHelper","ic-as/util/xhr/XhrHandler","ic-as/notification/util/NotificationItemNavigationHandler","ic-as/notification/util/ICCometService","ic-as/notification/util/MessageTransport","ic-as/notification/util/ICNotificationController","ic-core/config/features","ic-core/url","ic-core/config/services","ic-core/theme","./util/NCNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,_1a,_1b,_1c,_1d,_1e,_1f,_20,_21,_22,_23,_24,_25,_26,_27){
var _28=_1("ic-as.notification.NotificationCenter",null,{notificationFlyout:null,badgingController:null,topLevelSelectionNode:null,headerMenuNode:null,notificationCenterActionNode:null,flyoutContainerNode:null,allNotificationsUrl:null,helper:null,xhr:null,subscriptionHandle:[],firstLoad:true,ncMode:_18.INLINE_MODE,ncLastWeekTimestamp:null,ncLastWeekDate:null,defaultFetchDays:-7,defaultPageSize:"10",defaultPageSizeInt:null,isOpen:false,themeId:null,notifcationFlyoutPosition:null,ncStylesheet:null,livePreviewPrefs:null,onPremNavigated:false,isBadgingInitialized:false,headerMouseHandlerEnter:null,headerMouseHandlerLeave:null,constructor:function(_29,_2a,_2b){
if(_2b){
this.ncMode=_2b;
}
this.helper=new _1d({cfg:{userInfo:{id:"id"}}});
_1e.init();
this.xhr=_1e;
_21.getInstance(_2b);
if(this.ncMode!==_18.IFRAME_MODE_MIXED_DOMAIN){
if(!_23("notification-center-common-navbar")){
var _2c=_9("a",_29);
}else{
var _2c=[_29];
}
if(_2c&&_2c.length>0){
this.notificationCenterActionNode=_2c[0];
}
this.livePreviewPrefs=new _1b();
_14(_2.hitch(this,function(){
this.livePreviewPrefs.requestUserLivePreviewPreferences();
}));
}
this.badgingController=_16;
if(_2a){
_2a.innerHTML=" ";
}
this.flyoutContainerNode=_2a;
this.headerMenuNode=_29;
this.subscriptionHandle.push(_a.subscribe(_18.FETCHFEED,_2.hitch(this,"fetchNotificationFeed")));
this.subscriptionHandle.push(_a.subscribe(_1a.BADGE_SYNC_MY_NOTIFICATIONS,_2.hitch(this,"setBadgingInitialized")));
this.subscriptionHandle.push(_a.subscribe(_18.SHOW,_2.hitch(this,"handleFlyoutOpen")));
this.subscriptionHandle.push(_a.subscribe(_18.HIDE,_2.hitch(this,"handleFlyoutClose")));
this.subscriptionHandle.push(_a.subscribe(_18.OPEN_NC,_2.hitch(this,"openNC")));
this.defaultPageSizeInt=parseInt(this.defaultPageSize);
this.setupTimeBoundary();
_22.requestNotificationPermission();
this.initializeBadging(this.notificationCenterActionNode);
if(this.ncMode!==_18.IFRAME_MODE_MIXED_DOMAIN){
this.setupMessaging();
this.setupTopLevelSelectorNode(_29);
this.initNotificationCenterCommunication();
}
this.initNotificationFlyout();
if(this.ncMode===_18.IFRAME_MODE_MIXED_DOMAIN){
this.openNC();
}
},setBadgingInitialized:function(){
this.isBadgingInitialized=true;
},initNotificationCenterCommunication:function(){
if(_23("news-push-service")){
_20.addCometChannelSubscription("news",_2.hitch(this,function(_2d){
this.handlePushNotification(_2d);
}));
}
},setupTimeBoundary:function(){
this.ncLastWeekDate=new Date();
this.ncLastWeekDate=_b.add(this.ncLastWeekDate,"day",this.defaultFetchDays);
this.ncLastWeekTimestamp=_c.toISOString(this.ncLastWeekDate,{zulu:true,milliseconds:true});
},setupTopLevelSelectorNode:function(_2e){
if(_2e){
if(!_23("notification-center-common-navbar")){
this.headerMouseHandlerEnter=_d.pausable(_2e,_f.enter,_2.hitch(this,"openNC"));
this.headerMouseHandlerLeave=_d.pausable(_2e,_f.leave,_2.hitch(this,"closeNC"));
if(typeof window.navigation_banner_onMenuBtnKey!=="undefined"){
_13.after(window,"navigation_banner_onMenuBtnKey",_2.hitch(this,function(_2f,_30){
if(_2f.keyCode===_e.ENTER&&_30==="notificationsMenu"){
this.openNCMouseEnter();
}
}),true);
}else{
_d(this.notificationCenterActionNode,"keypress",_2.hitch(this,function(_31){
if(_31.keyCode===_e.ENTER){
this.openNCMouseEnter();
}
}));
}
}else{
_d(this.notificationCenterActionNode,"keydown",_2.hitch(this,function(_32){
if(_32.keyCode===_e.ENTER){
this.openNCMouseEnter();
}
}));
_d(this.notificationCenterActionNode,"click",_2.hitch(this,function(_33){
this.openNCMouseEnter();
}));
}
this.notifcationFlyoutPosition=_12.position(_2e,true);
var _34=_2e.parentNode;
this.topLevelSelectionNode=_34;
}
},navigateNotifications:function(){
this.flyoutContainerNode=_4.byId("notificationsMenu");
if(this.flyoutContainerNode&&!this.onPremNavigated){
this.onPremNavigated=true;
this.flyoutContainerNode.innerHTML="";
_6.place(this.notificationFlyout.domNode,this.flyoutContainerNode);
var _35=dojo.query(dojo.byId("lconnheadermenu-notifications"));
if(_35&&_35[0]){
_11.remove(_35[0],"role");
}
this.openNC();
}
},initializeBadging:function(_36){
var _37=new _17({});
if(_36){
_37=new _17({});
if(this.ncMode!==_18.INLINE_MODE&&this.ncMode!==_18.INLINE_MODE_ONPREM){
if(_37.ariaNewNotification){
var _38={position:"absolute",top:"-3000px",left:"-9999px"};
_7.set(_37.ariaNewNotification,_38);
_7.set(_37.ncBadge,_38);
}
_5.add(_37.notificationCenterBadge,"icBanner-badge-iframe");
}
_7.set(_37.domNode,"position","relative");
this.placeBadge(_37,_36);
}
window.setTimeout(_2.hitch(this,function(){
if(!this.isBadgingInitialized){
_1c.fetchNewNotificationsInfo();
}
}),6000);
},placeBadge:function(_39,_3a){
if(_23("notification-center-common-navbar")&&this.ncMode!==_18.INLINE_MODE_ONPREM){
_5.add(_39.notificationCenterBadge,"icBanner-badge-newNav");
_6.place(_39.domNode,_3a,1);
}else{
if(this.ncMode===_18.INLINE_MODE_ONPREM){
_5.add(_39.notificationCenterBadge,"icBanner-badge-onprem");
_6.place(_39.domNode,_3a,1);
}else{
_6.place(_39.domNode,_3a);
}
}
},setupMessaging:function(){
if(window.addEventListener){
window.addEventListener("message",_2.hitch(this,this.messageReceived),false);
}else{
window.attachEvent("onmessage",_2.hitch(this,this.messageReceived));
}
},messageReceived:function(evt){
if(evt&&evt.origin&&evt.data){
var _3b=evt.data.split("|");
var msg=_3b?_3b[0]:null;
switch(msg){
case _18.TOGGLE_NC:
this.toggle();
break;
case _18.OPEN_NC:
this.openNC();
break;
}
}
},handleFlyoutOpen:function(){
if(this.isOpen){
return;
}
_27.track(_19.OPEN_NC_FLYOUT);
if(this.ncMode!==_18.IFRAME_MODE_MIXED_DOMAIN&&!_23("notification-center-common-navbar")){
this.headerMouseHandlerEnter.pause();
this.headerMouseHandlerLeave.resume();
}
this.isOpen=true;
var _3c=this.badgingController.getCount();
if(_3c>0||this.firstLoad){
this.notificationFlyout.resetPaging();
this.fetchNotificationFeed();
this.firstLoad=false;
}
if(this.topLevelSelectionNode){
_5.add(this.topLevelSelectionNode,"lotusSelected");
}
},handleFlyoutClose:function(_3d){
_27.track(_19.CLOSE_NC_FLYOUT);
this.isOpen=false;
if(this.ncMode!==_18.IFRAME_MODE_MIXED_DOMAIN&&!_23("notification-center-common-navbar")){
this.headerMouseHandlerLeave.pause();
this.headerMouseHandlerEnter.resume();
}
if(this.topLevelSelectionNode){
_5.remove(this.topLevelSelectionNode,"lotusSelected");
}
if(_3d&&this.notificationCenterActionNode){
if(!_23("notification-center-common-navbar")){
this.handleSmartCloudFlyoutClose();
}
this.notificationCenterActionNode.focus();
}
},isCommonNavBarActive:function(){
return (typeof commonNavBar!=="undefined"&&commonNavBar);
},handleSmartCloudFlyoutClose:function(){
if(typeof navigation_banner_hideMenuNoDelay!=="undefined"){
navigation_banner_hideMenuNoDelay(null,this.flyoutContainerNode.id,this.headerMenuNode.id);
}
},handleSmartCloudFlyoutOpen:function(){
if(typeof navigation_banner_showMenu!=="undefined"){
navigation_banner_showMenu(this.flyoutContainerNode.id,this.headerMenuNode.id);
}
},fetchNotificationFeed:function(_3e,_3f){
if(this.notificationFlyout){
this.notificationFlyout.setupNotificationCenterContent(!_3e);
}
var _40=this.helper.getNotificationsForMeUrl()+"?count=";
if(_3f){
_40=_40+_3f;
}else{
_40=_40+this.defaultPageSize;
}
if(_3e){
_40=_40+"&updatedBefore="+_3e;
}
_40=_40+"&updatedSince="+this.ncLastWeekTimestamp;
this.xhr.xhrGet({url:_40,handleAs:"json"}).then(_2.hitch(this,function(_41){
this.handleNotificationFeed(_41,_3f);
_27.setItems(_41);
}),function(_42){
console.log(_42);
});
},requestSingleNotification:function(id){
var _43=this.helper.getActivityByIDUrl(id);
_1e.xhrGet({url:_43,handleAs:"json"}).then(_2.hitch(this,function(_44){
var _45=_44.entry;
this.notificationFlyout.pushNotification(_45);
}),function(_46){
console.log(_46);
});
},handlePushNotification:function(_47){
var _48=false;
var _49=(_47.data&&_47.data.messages)?_47.data.messages:_47.data.items;
if(_49&&_49.length>0){
var _4a=(_49[0].message)?_49[0].message:_49[0];
if(this.isNotificationLiveUpdatesEnabled(_47,_4a)){
this.requestSingleNotification(_4a.storyId);
}
if(this.notificationFlyout&&this.notificationFlyout.NotificationsFeed){
_8.forEach(this.notificationFlyout.NotificationsFeed,_2.hitch(this,function(_4b){
if(this.trimId(_4b.getId())===this.trimId(_4a.storyId)){
_48=true;
}
}));
}
if(_4a.viewCounts&&_4a.viewCounts.notifications&&!_48){
_27.track(_19.HANDLE_PUSH_NOTIFICATION,{ncUnreadNotifications:_4a.viewCounts.notifications});
this.badgingController.updateBadging(_4a.viewCounts.notifications);
this.badgingController.updateASSideNavBadging(_4a);
}
}
},isNotificationLiveUpdatesEnabled:function(_4c,_4d){
if(_23("notification-center-live-updates")&&(typeof _4c.icWindowChannel==="undefined")&&(typeof _23("ie")==="undefined")){
if(this.livePreviewPrefs.isNotificationAllowed(_4d)){
return true;
}
}
return false;
},handleNotificationFeed:function(_4e,_4f){
if(this.notificationFlyout&&_4f!=="1"){
_4e.list=this.filterEntriesById(_4e.list,this.notificationFlyout.getCurrentLastItem());
this.notificationFlyout.renderNotificationsItems(_4e);
_a.publish(_18.FEEDFETCHED);
}
if(_4f){
this.badgingController.updateBadging(_4e.connections.unreadNotifications);
}
},filterEntriesById:function(_50,_51){
if(!_50||!_51){
return _50;
}
for(var e=0;e<_50.length;e++){
var _52=_50[e];
if(_52.id==_51.id){
return _50.slice(e+1);
}
}
return _50;
},trimId:function(_53){
var i=_53.lastIndexOf(":");
if(i!=-1){
return _53.substr(i);
}else{
return null;
}
},toggle:function(e){
this.notificationFlyout.toggle(e);
if(e){
_10.stop(e);
}
},openNCMouseEnter:function(e){
if(this.ncMode===_18.INLINE_MODE_ONPREM&&this.flyoutContainerNode===null){
return;
}
this.notificationFlyout.show();
},openNC:function(e){
if(this.ncMode===_18.INLINE_MODE_ONPREM&&this.flyoutContainerNode===null){
return;
}
this.notificationFlyout.show(e);
if(e){
_10.stop(e);
}
},closeNC:function(e){
this.notificationFlyout.hide();
if(e){
_10.stop(e);
}
},isRTL:function(){
return !dojo._isBodyLtr();
},initNotificationFlyout:function(){
if(this.notificationFlyout===null){
var _54=(this.flyoutContainerNode)?this.flyoutContainerNode:_3.body();
var _55=_6.create("div",null,_54);
this.notificationFlyout=new _15({ncPosition:this.notifcationFlyoutPosition,ncMode:this.ncMode,defaultPageSize:this.defaultPageSizeInt,helper:this.helper},_55);
if(this.flyoutContainerNode){
this.notificationFlyout.showFlyoutDom();
}
}
}});
_28._Instance=null;
_28._Init=false;
_28.getInstance=function(_56,_57,_58){
if(_28._Instance==null&&_28._Init===false){
_28._Init=true;
_28._Instance=new _28(_56,_57,_58);
_28._Init=false;
}
return _28._Instance;
};
if(!window.as_console_debug){
(function(){
var s=window.location.search;
var _59=s&&(s.indexOf("debug=dojo")!=-1||s.indexOf("debug=true")!=-1||s.indexOf("debug-as")!=-1);
if(_59&&window.console&&window.console.debug){
try{
window.as_console_debug=window.console.debug;
window.as_console_debug("Create as_console_debug()");
}
catch(e){
window.as_console_debug=function(){
var msg="",i;
for(i=0;i<arguments.length;i++){
msg+=arguments[i]+" ";
}
window.console.debug(msg);
};
}
}else{
window.as_console_debug=function(){
};
}
})();
}
return _28;
});


;if(!dojo._hasResource["lconn.core.header.apps"]){
dojo._hasResource["lconn.core.header.apps"]=true;
dojo.provide("lconn.core.header.apps");














(function(){
var _1="lotusBannerApps",_2="lotusBannerHomepage",_3="lotusBannerFilesExternal",_4="lotusBannerCommunities",_5="lotusBannerCommunitiesExternal",_6="lotusBannerModeration",_7="lotusBannerProfiles",_8="lotusBannerHeaderMetrics",_9="lotusBannerFooterMetrics",_a="lotusBannerMail",_b="lotusBannerCalendar";
function _c(_d){
switch(_d){
case "homepage":
return [_2];
case "files":
return [_3,_1];
case "communities":
return [_5,_4];
case "profiles":
return [_7];
case "metrics":
return [_8];
case "moderation":
return [_6];
default:
return [_1];
}
};
var _e=com.ibm.oneui.util.proxy(lconn.core.url.getServiceUrl(lconn.core.config.services.webresources).toString())+"/web/user/roles?",_f=lconn.core.config.sessionCookies,_10={"global-moderator":[_6],"metrics-report-run":[_8,_9],"admin":[_8,_9],"mail-user":[_9,_b,_a]};
var _11=[_2,_4,_7,_1,_6,_8];
lconn.core.header.apps={updateBannerByRoles:function(){
var _12=[];
for(var _13 in _10){
if(!this.updateBanner(_10[_13],dojo.cookie("ROLE_"+_13),_13)){
_12.push(_13);
}
}
if(_12.length>0){
dojo.xhrGet({url:_e+dojo.objectToQuery({role:_12}),handleAs:"json",load:dojo.hitch(this,function(_14){
for(var _15 in _14){
this.updateBanner(_10[_15],_14[_15],_15);
}
}),timeout:10000});
}
if(lconn.core.widget.MobileAppBanner.isEnabled()){
new lconn.core.widget.MobileAppBanner();
}
},updateBanner:function(ids,_16,_17){
if((_16==false)||(_16=="false")){
return true;
}
if(!dojo.isArray(ids)){
ids=[ids];
}
var _18=dojo.map(ids,function(id){
return dojo.byId(id);
});
_18=dojo.filter(_18,function(_19){
return _19!=undefined;
});
if(_18.length>0&&_16==undefined){
return false;
}
if((_16==true)||(_16=="true")){
if(_17=="mail-user"&&lconn.core.config.services.connectionsmail){


new com.ibm.lconn.socialmail.gadget.NavigationHandler();
}
dojo.forEach(_18,function(_1a){
_1a.style.display="";
});
}
return true;
},initNotificationCenter:function(){
var _1b=dojo.byId("lotusBannerNotifications");
if(_1b&&(dojo.getStyle(_1b,"display")!="none")){
var _1c=dojo.getObject("ic-as.notification.NotificationCenter");
try{
_1c.getInstance(_1b,null,"inlineOnPrem");
}
catch(e){
}
}
},updateUserNameMenu:function(){
var _1d=dojo.byId("logoutLink");
var _1e=dojo.byId("logoutContainer");
if(_1d&&_1e){
_1e.appendChild(_1d);
dojo.style(_1d,"display","block");
var _1f=dojo.byId("logoutLi");
if(_1f){
dojo.style(_1f,"display","none");
}
}
},onLogin:function(){
for(var _20 in _10){
dojo.cookie("ROLE_"+_20,null,{expires:-1,path:"/"});
}
},onLogout:function(){
dojo.forEach(_f,function(_21){
dojo.cookie(_21,null,{expires:-1,path:"/"});
});
},updateLoginRegion:function(){
var il=dojo.byId("loginLabel"),ol=dojo.byId("logoutLabel");
if(il&&ol){
dijit.setWaiRole(ol,"region");
dijit.removeWaiRole(il);
}
},setSelected:function(app){
dojo.forEach(_11,function(_22){
var _23=dojo.byId(_22);
if(_23){
dojo.removeClass(_23,"lotusSelected");
}
});
dojo.forEach(_c(app),function(_24){
var _25=dojo.byId(_24);
if(_25){
dojo.addClass(_25,"lotusSelected");
}
});
}};
lconn.core.header.apps.BANNER_IDS={BANNER_APPS:_1,BANNER_HOMEPAGE:_2,BANNER_FILES_EXTERNAL:_3,BANNER_COMMUNITIES:_4,BANNER_COMMUNITIES_EXTERNAL:_5,BANNER_MODERATION:_6,BANNER_PROFILES:_7,BANNER_HEADER_METRICS:_8,BANNER_FOOTER_METRICS:_9,BANNER_MAIL:_a,BANNER_CALENDAR:_b};
})();
dojo.addOnLoad(function(){
var _26=dojo.byId("headerUserName");
var _27=lconn.core.auth.isAuthenticated();
if(_26){
dojo.attr(_26,"onmenuloaded","lconn.core.header.apps.updateUserNameMenu");
}
if(!_27){
lconn.core.auth.addLoginHandler(lconn.core.header.apps.onLogin);
}else{
lconn.core.header.apps.initNotificationCenter();
lconn.core.auth.addLogoutHandler(lconn.core.header.apps.onLogout);
}
});
}


;if(!dojo._hasResource["lconn.core.i18nOverrider"]){
dojo._hasResource["lconn.core.i18nOverrider"]=true;
dojo.provide("lconn.core.i18nOverrider");
dojo.deprecated("lconn.core.i18nOverrider","Use standard resource bundle operations, stop requiring lconn.core.i18nOverrider.","3.5");


lconn.core.i18nOverrider.getResourceString=function(_1){
throw "Use dojo.i18n.getLocalization(...) instead";
};
lconn.core.i18nOverrider.loadResourceStringsInParams=function(_2,_3){
throw "Use dojo.i18n.getLocalization(...) instead";
};
lconn.core.i18nOverrider.replaceParams=function(_4,_5){
dojo.deprecated("lconn.core.i18nOverrider.replaceParams","Use dojo.string.substitute with ${} strings instead","3.5");
var _6=_4.indexOf("{");
if(_6!=-1){
var _7=_4.indexOf("}");
if(_7==-1){
return _4;
}
var _8=_4.substring(_6+1,_7);
var _9=_5[_8];
if(typeof _9=="undefined"){
_9="{"+_8+"}";
}
return _4.substring(0,_6)+_9+lconn.core.i18nOverrider.replaceParams(_4.substring(_7+1),_5);
}else{
return _4;
}
};
}


;define("dojox/xml/parser",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(_1){
_1.getObject("xml.parser",true,dojox);
dojox.xml.parser.parse=function(_2,_3){
var _4=_1.doc;
var _5;
_3=_3||"text/xml";
if(_2&&_1.trim(_2)&&"DOMParser" in _1.global){
var _6=new DOMParser();
_5=_6.parseFromString(_2,_3);
var de=_5.documentElement;
var _7="http://www.mozilla.org/newlayout/xml/parsererror.xml";
if(de.nodeName=="parsererror"&&de.namespaceURI==_7){
var _8=de.getElementsByTagNameNS(_7,"sourcetext")[0];
if(_8){
_8=_8.firstChild.data;
}
throw new Error("Error parsing text "+de.firstChild.data+" \n"+_8);
}
return _5;
}else{
if("ActiveXObject" in _1.global){
var ms=function(n){
return "MSXML"+n+".DOMDocument";
};
var dp=["Microsoft.XMLDOM",ms(6),ms(4),ms(3),ms(2)];
_1.some(dp,function(p){
try{
_5=new ActiveXObject(p);
}
catch(e){
return false;
}
return true;
});
if(_2&&_5){
_5.async=false;
_5.loadXML(_2);
var pe=_5.parseError;
if(pe.errorCode!==0){
throw new Error("Line: "+pe.line+"\n"+"Col: "+pe.linepos+"\n"+"Reason: "+pe.reason+"\n"+"Error Code: "+pe.errorCode+"\n"+"Source: "+pe.srcText);
}
}
if(_5){
return _5;
}
}else{
if(_4.implementation&&_4.implementation.createDocument){
if(_2&&_1.trim(_2)&&_4.createElement){
var _9=_4.createElement("xml");
_9.innerHTML=_2;
var _a=_4.implementation.createDocument("foo","",null);
_1.forEach(_9.childNodes,function(_b){
_a.importNode(_b,true);
});
return _a;
}else{
return _4.implementation.createDocument("","",null);
}
}
}
}
return null;
};
dojox.xml.parser.textContent=function(_c,_d){
if(arguments.length>1){
var _e=_c.ownerDocument||_1.doc;
dojox.xml.parser.replaceChildren(_c,_e.createTextNode(_d));
return _d;
}else{
if(_c.textContent!==undefined){
return _c.textContent;
}
var _f="";
if(_c){
_1.forEach(_c.childNodes,function(_10){
switch(_10.nodeType){
case 1:
case 5:
_f+=dojox.xml.parser.textContent(_10);
break;
case 3:
case 2:
case 4:
_f+=_10.nodeValue;
}
});
}
return _f;
}
};
dojox.xml.parser.replaceChildren=function(_11,_12){
var _13=[];
if(_1.isIE){
_1.forEach(_11.childNodes,function(_14){
_13.push(_14);
});
}
dojox.xml.parser.removeChildren(_11);
_1.forEach(_13,_1.destroy);
if(!_1.isArray(_12)){
_11.appendChild(_12);
}else{
_1.forEach(_12,function(_15){
_11.appendChild(_15);
});
}
};
dojox.xml.parser.removeChildren=function(_16){
var _17=_16.childNodes.length;
while(_16.hasChildNodes()){
_16.removeChild(_16.firstChild);
}
return _17;
};
dojox.xml.parser.innerXML=function(_18){
if(_18.innerXML){
return _18.innerXML;
}else{
if(_18.xml){
return _18.xml;
}else{
if(typeof XMLSerializer!="undefined"){
return (new XMLSerializer()).serializeToString(_18);
}
}
}
return null;
};
return dojox.xml.parser;
});


;if(!dojo._hasResource["lconn.core.utilities"]){
dojo._hasResource["lconn.core.utilities"]=true;
dojo.provide("lconn.core.utilities");






lconn.core.utilities.getHash=function(){
var _1=document.location.href;
var i=_1.indexOf("#");
if(i==-1){
return "";
}
return _1.substring(i+1);
};
lconn.core.utilities.getURLParam=function(_2,_3){
var _4=lconn.core.url.parse(window.location.href);
var _5=_4.queryParameters[_2];
if(_3&&_5===undefined&&_4.fragment){
_5=lconn.core.url.splitQuery(_4.fragment)[_2];
if(_5===undefined){
try{
var _6=decodeURIComponent(_4.fragment);
if(_6!=_4.fragment){
_5=lconn.core.url.splitQuery(_6)[_2];
}
}
catch(e){
}
}
}
if(dojo.isArray(_5)){
return _5[0];
}
return _5;
};
lconn.core.utilities.isCSSSpriteOn=function(){
var _7=document.createElement("img");
_7.className="lotusSprite lotusSprite-iconPublic16";
_7.style.display="none";
document.body.appendChild(_7);
var _8=dojo.style(_7).backgroundPosition;
var _9=_8&&_8!="0px 0px";
return _9;
};
lconn.core.utilities.replacePlaceHolders=function(_a,_b){
var _c=new Object();
for(var i=0;_b!=null&&i<_b.length;i++){
_c[""+i+""]=_b[i];
}
return lconn.core.i18nOverrider.replaceParams(_a,_c);
};
lconn.core.utilities.processUntilElementIsFound=function(_d,_e,_f,_10,_11,_12,_13){
if(typeof (_e)!="function"){
return;
}
var _14=500;
var _15=20;
var _16=true;
if(typeof (_12)=="number"){
_14=_12;
}
if(typeof (_13)=="number"){
_15=_13;
}
if(typeof (_11)=="boolean"){
_16=_11;
}
var _17="";
var _18=0;
var _19=null;
if(_f!=null){
_19=_f.getElementById(_d);
}else{
_19=dojo.byId(_d);
}
if(_19!=null){
_e(_19,_10);
return;
}
_17=window.setInterval(function(){
var _1a=null;
if(_f!=null){
_1a=_f.getElementById(_d);
}else{
_1a=dojo.byId(_d);
}
_18++;
if(_1a!=null){
window.clearInterval(_17);
_e(_1a,_10);
}else{
if(_18==_15){
window.clearInterval(_17);
if(_16){
throw new Error("lconn.core.utilities.processUntilElementIsFound: elementId was never found: "+_d);
}
}
}
},_14);
};
lconn.core.utilities.processUntilAvailable=function(_1b,_1c,_1d,_1e,_1f,_20){
if(typeof (_1b)!="function"){
return;
}
var _21=500;
var _22=20;
var _23=true;
if(typeof (_1f)=="number"){
_21=_1f;
}
if(typeof (_20)=="number"){
_22=_20;
}
if(typeof (_1e)=="boolean"){
_23=_1e;
}
var _24="";
var _25=0;
if(eval(_1c)){
if(_1d!=null){
_1b(_1d);
}else{
_1b();
}
return;
}
_24=window.setInterval(function(){
_25++;
if(eval(_1c)){
window.clearInterval(_24);
if(_1d!=null){
_1b(_1d);
}else{
_1b();
}
}else{
if(_25==_22){
window.clearInterval(_24);
if(_23){
throw new Error("lconn.core.utilities.processUntilAvailable: test was never met: "+_1c);
}
}
}
},_21);
};
lconn.core.utilities.gotoURL=function(url,_26){
if(_26==null){
if(url.indexOf("?")!=-1){
url+="&ver="+profilesData.config.buildNumber+"&lastMod="+profilesData.config.profileLastMod;
}else{
url+="?ver="+profilesData.config.buildNumber+"&lastMod="+profilesData.config.profileLastMod;
}
}
if(dojo.isIE){
var _27=url;
setTimeout("window.location.href = SideBar_RedirectUrl",0);
}else{
window.location.assign(url);
}
};
lconn.core.utilities.toggleVisibility=function(_28,_29){
var _2a=null;
if((typeof _28)=="string"){
_2a=dojo.byId(_28);
}else{
_2a=_28;
}
if(_2a){
if(_2a.style.visibility=="hidden"){
lconn.core.utilities.show(_2a,_29);
}else{
lconn.core.utilities.hide(_2a,_29);
}
}
return false;
};
lconn.core.utilities.hide=function(_2b,_2c,_2d,_2e){
var _2f=null;
if((typeof _2b)=="string"){
_2f=dojo.byId(_2b);
}else{
_2f=_2b;
}
if(_2f!=null){
var _30=function(){
_2f.style.visibility="hidden";
if(!_2c){
_2f.style.display="none";
}
if(_2e!=null){
_2e();
}
};
if(_2d==null||_2d==false){
var _31=dojo.fx.wipeOut({node:_2f,duration:300,onEnd:_30});
_31.play();
}else{
_30();
}
}
return false;
};
lconn.core.utilities.show=function(_32,_33,_34,_35,_36){
var _37=0;
var _38=null;
if((typeof _32)=="string"){
_38=dojo.byId(_32);
}else{
_38=_32;
}
if(_34&&_38==null){
var _39="";
_39=window.setInterval(function(){
_37++;
if((typeof _32)=="string"){
_38=dojo.byId(_32);
}else{
_38=_32;
}
if(_38!=null){
window.clearInterval(_39);
lconn.core.utilities.show(_38,_33,false,_35,_36);
}else{
if(_37==20){
window.clearInterval(_39);
}
}
},300);
}else{
if(_38!=null){
var _3a=function(){
_38.style.visibility="visible";
if(!_33){
_38.style.display="block";
}
if(_36!=null){
_36();
}
};
if(_35==null||_35==false){
var _3b=dojo.fx.wipeIn({node:_38,duration:300});
_3b.play();
}else{
_3a();
}
}
}
return false;
};
lconn.core.utilities.loadScript=function(_3c){
if(this.scripts==null){
this.scripts={};
}
if(!this.scripts[_3c]){
this.scripts[_3c]=true;
var _3d=document.createElement("script");
_3d.src=_3c;
document.body.insertBefore(_3d,document.body.firstChild);
}
};
lconn.core.utilities.getExtension=function(s){
if(!s){
return "";
}
var i=s.lastIndexOf(".");
if(i!=-1){
return dojo.trim(s.substring(i+1).toLowerCase());
}
return "";
};
lconn.core.utilities.getFileIconClassName=function(_3e,_3f){
var _3f=_3f||16;
var _40=lconn.core.utilities.getExtension(_3e);
_40=_40.replace(/[^a-z0-9]/g,"-");
var _41="lconn-ftype{size} lconn-ftype{size}-{ext}";
var _42=_41.replace(/\{size\}/g,_3f).replace(/\{ext\}/g,_40);
return _42;
};
lconn.core.utilities.getGridActionClass=function(_43,_44){
var _44=_44||16;
var _45=lconn.core.utilities.getExtension(_43);
_45=_45.replace(/[^a-z0-9]/g,"-");
var _46="grid-a-{ext}";
var _47=_46.replace(/\{ext\}/g,_45);
return _47;
};
lconn.core.utilities.isDefined=function(_48){
var _49=_48.indexOf(".");
var _4a=true;
if(_49!=-1){
_4a=lconn.core.utilities.isDefined(_48.substring(0,_49));
if(_4a){
var _4b=eval("typeof( "+_48+") != 'undefined'");
return _4b;
}else{
return false;
}
}else{
return (window[_48]!=null);
}
};


if(dojo.isIE&&dojo.exists("dojox.xml.parser")&&"DOMParser" in dojo.global){
dojox.xml.parser["parse.orig"]=dojox.xml.parser.parse;
dojox.xml.parser.parse=function(str,_4c){
try{
var doc;
var ms=function(n){
return "MSXML"+n+".DOMDocument";
};
dojo.some(["Microsoft.XMLDOM",ms(6),ms(4),ms(3),ms(2)],function(p){
try{
doc=new ActiveXObject(p);
}
catch(e){
return false;
}
return true;
});
if(str&&doc){
doc.async=false;
doc.loadXML(str);
}
if(doc){
return doc;
}
}
catch(e){
}
return dojox.xml.parser["parse.orig"](str,_4c);
};
}
}


;if(!dojo._hasResource["lconn.core.xpath"]){
dojo._hasResource["lconn.core.xpath"]=true;
dojo.provide("lconn.core.xpath");
(function(){
var _1=function(_2,_3){
for(var x=0;x<_2.length;x++){
if(_3==_2[x].prefix){
return _2[x].nameSpaceURI;
}
}
return null;
};
var _4=function(_5,_6){
var _7="";
for(var x=0;_6!=null&&x<_6.length;x++){
_7+="xmlns:"+_6[x].prefix+"='"+_6[x].nameSpaceURI+"' ";
}
if(_7!=""&&(dojo.isIE||lconn.core.xpath.isIE11())){
_5.setProperty("SelectionNamespaces",_7);
}
};
var _8=function(_9){
if(_9!=null){
return function(_a){
var _b=_1(_9,_a);
if(lconn.core.xpath.debug){
console.log("getNameSpaceResolver: prefix: "+_a+" URI: "+_b);
}
if(lconn.core.xpath.debug&&(_b==null||_b=="")){
console.log("getNameSpaceResolver: no namespace was found for prefix: "+_a);
}
return _b;
};
}else{
return null;
}
};
var _c=function(_d){
var _e=new Array;
_e=_f(_e,_d);
return _e;
};
var _f=function(_10,_11){
if(_11.documentElement){
for(var x=0;x<_11.documentElement.attributes.length;x++){
var att=_11.documentElement.attributes[x];
var _12=att.nodeName.indexOf(":");
if(_12!=-1){
if(att.nodeName.substring(0,_12).toLowerCase()=="xmlns"){
var _13=att.nodeName.substring(_12+1);
var _14=_1(_10,_13);
if(lconn.core.xpath.debug){
console.log("addNamesSpaceFromRootElement: current prefix: "+_13+" nameSpaceURI: "+_14);
}
if(_14==null){
_14=att.nodeValue;
if(lconn.core.xpath.debug){
console.log("addNamesSpaceFromRootElement: adding prefix: "+_13+" nameSpaceURI: "+_14+" to the list");
}
_10.push({prefix:_13,nameSpaceURI:_14});
}
}
}
}
}
return _10;
};
lconn.core.xpath.debug=false;
lconn.core.xpath.selectNodes=function(_15,_16,_17,_18){
if(_16==null){
throw Error("lconn.core.xpath.selectNodes : XMLDocument can not be null\n");
}
if(_17==null){
_17=_c(_16);
}else{
_17=_f(_17,_16);
}
for(var x=0;lconn.core.xpath.debug&&x<_17.length;x++){
console.log(_17[x].prefix+":"+_17[x].nameSpaceURI);
}
if(_18==null&&(_16.documentElement!=null)){
_18=_16.documentElement;
}
if(dojo.isIE||lconn.core.xpath.isIE11()){
try{
_4(_16,_17);
return _18.selectNodes(_15);
}
catch(exception){
console.log(exception);
}
}else{
try{
var _19=_8(_17);
var _1a=0;
var _1b=null;
_1b=_16.evaluate(_15,_18,_19,_1a,_1b);
if(_1b!=null){
var _1c=new Array();
var $A=null;
while($A=_1b.iterateNext()){
_1c.push($A);
}
return _1c;
}
}
catch(exception){
console.log(exception);
}
}
};
lconn.core.xpath.selectSingleNode=function(_1d,_1e,_1f,_20){
var _21=lconn.core.xpath.selectNodes(_1d,_1e,_1f,_20);
if(_21==null||_21.length==0){
return null;
}
return _21[0];
};
lconn.core.xpath.selectText=function(_22,_23,_24,_25){
var _26=lconn.core.xpath.selectSingleNode(_22,_23,_24,_25);
if(_26==null){
return null;
}
return _26.nodeValue;
};
lconn.core.xpath.setNodeValue=function(_27,_28,_29,_2a,_2b){
var _2c=lconn.core.xpath.selectSingleNode(_27,_28,_2a,_2b);
if(_2c!=null){
if(_2c.nodeType==1){
if(_2c.hasChildNodes()){
var _2d=_2c.firstChild;
_2c.replaceChild(_28.createTextNode(_29),_2d);
}else{
_2c.appendChild(_28.createTextNode(_29));
}
}else{
if(_2c.nodeType==2){
_2c.nodeValue=_29;
}else{
if(_2c.nodeType==3){
_2c.nodeValue=_29;
}else{
console.log("lconn.core.xpath.setNodeValue: nodeType: "+_2c.nodeType);
}
}
}
}else{
var _2e=_27.lastIndexOf("/");
if(_2e!=-1){
var _2f=_27.substring(_2e+2);
var _30=_27.substring(_2e+1);
if(_30.indexOf("@")==0){
var _31=_27.substring(0,_2e);
var _32=lconn.core.xpath.selectSingleNode(_31,_28,_2a,_2b);
if(_32==null){
console.log("lconn.core.xpath.setNodeValue: couldn't find parent node for: "+_31+" orig "+_27);
return;
}
_32.setAttribute(_2f,_29);
return;
}
}
console.log("lconn.core.xpath.setNodeValue: couldn't find node for: "+_27);
}
};
lconn.core.xpath.isIE11=function(){
if(!dojo.isIE&&!dojo.isFF){
return !!navigator.userAgent.match(/Trident\/7\.0/);
}
return false;
};
lconn.core.xpath.loadDOMIE11=function(_33){
try{
var dom=new ActiveXObject("MSXML2.DOMDocument.6.0");
dom.async=false;
dom.loadXML(_33);
return dom;
}
catch(e){
if(djConfig.isDebug){
console.debug("Error during loading xml into MSXML2.DOMDocument.6.0: "+e);
}
}
};
})();
}


;if(!dojo._hasResource["lconn.core.help"]){
dojo._hasResource["lconn.core.help"]=true;
dojo.provide("lconn.core.help");






(function(_1,_2){
var _3="/topic/",_4={activities:_3+"com.ibm.lotus.connections.activities.help/",blogs:_3+"com.ibm.lotus.connections.blogs.help/",dogear:_3+"com.ibm.lotus.connections.bookmarks.help/",common:_3+"com.ibm.lotus.connections.common.help/",communities:_3+"com.ibm.lotus.connections.communities.help/",files:_3+"com.ibm.lotus.connections.files.help/",forums:_3+"com.ibm.lotus.connections.forums.help/",homepage:_3+"com.ibm.lotus.connections.homepage.help/",metrics:_3+"com.ibm.lotus.connections.common.help/",moderation:_3+"com.ibm.lotus.connections.common.help/",profiles:_3+"com.ibm.lotus.connections.profiles.help/",wikis:_3+"com.ibm.lotus.connections.wikis.help/"},_5={activities:_4.activities+"aframe.html",blogs:_4.blogs+"bframe.html",dogear:_4.dogear+"dframe.html",common:_4.common+"euframe.html",communities:_4.communities+"cframe.html",files:_4.files+"fframe.html",forums:_4.forums+"eframe.html",homepage:_4.homepage+"hframe.html",metrics:_4.metrics+"t_eucommon_metrics.html",moderation:_4.moderation+"c_eucommon_global_moderation.html",profiles:_4.profiles+"pframe.html",wikis:_4.wikis+"wframe.html"},_6=_4.common,_7=_5.common,_8="height=${h},width=${w},status=yes,toolbar=yes,menubar=no,location=no,scrollbars=yes,resizable=yes";
function _9(_a,_b){
var _c=_a;
var _b=(_b&&_4[_b])?_b:dojo.getObject("ibmConfig.serviceName");
if(!_a){
_c=_5[_b]||_7;
}else{
if(_a.indexOf(_3)!==0){
_c=(_4[_b]||_6)+_a.substring(_a.lastIndexOf("/")+1);
}
}
return _c;
};
function _d(){
var h=Math.max(_1.screen.height/4,770);
var w=Math.max(_1.screen.width/4,980);
return dojo.string.substitute(_8,{h:h,w:w});
};
lconn.core.help={launchDemo:function(_e){
if(!_e){
return;
}
var w=_1.open(_e,"_icDemoWindow",_d());
if(w){
w.focus();
}
},launchHelp:function(_f,_10){
if(!lconn.core.config.services.help){
return;
}
var w=_1.open(this.getProductHelpUrl(_f,_10),"_icHelpWindow",_d());
if(w){
w.focus();
}
},getProductHelpUrl:function(_11,_12){
var url,_13=lconn.core.url.getServiceUrl(lconn.core.config.services.help);
if(_13){
url=_13.toString()+_9(_11,_12);
}
return url;
},createHelpLink:function(el,_14,_15){
var _16=dojo.byId(el),url=this.getProductHelpUrl(_14,_15);
dojo.attr(el,"href",this.getProductHelpUrl(_14,_15));
return dojo.connect(el,"onclick",function(e){
dojo.stopEvent(e);
lconn.core.help.launchHelp(_14);
});
}};
}(window,document));
}


;define("ic-core/help",["./config/services","./url","dojo/_base/lang","dojo/on","dojo/dom","dojo/dom-attr","dojo/string"],function(_1,_2,_3,on,_4,_5,_6){
var _7="/topic/",_8={activities:_7+"com.ibm.lotus.connections.activities.help/",blogs:_7+"com.ibm.lotus.connections.blogs.help/",dogear:_7+"com.ibm.lotus.connections.bookmarks.help/",common:_7+"com.ibm.lotus.connections.common.help/",communities:_7+"com.ibm.lotus.connections.communities.help/",files:_7+"com.ibm.lotus.connections.files.help/",forums:_7+"com.ibm.lotus.connections.forums.help/",homepage:_7+"com.ibm.lotus.connections.homepage.help/",metrics:_7+"com.ibm.lotus.connections.common.help/",moderation:_7+"com.ibm.lotus.connections.common.help/",profiles:_7+"com.ibm.lotus.connections.profiles.help/",wikis:_7+"com.ibm.lotus.connections.wikis.help/"},_9={activities:_8.activities+"aframe.html",blogs:_8.blogs+"bframe.html",dogear:_8.dogear+"dframe.html",common:_8.common+"euframe.html",communities:_8.communities+"cframe.html",files:_8.files+"fframe.html",forums:_8.forums+"eframe.html",homepage:_8.homepage+"hframe.html",metrics:_8.metrics+"t_eucommon_metrics.html",moderation:_8.moderation+"c_eucommon_global_moderation.html",profiles:_8.profiles+"pframe.html",wikis:_8.wikis+"wframe.html"},_a=_8.common,_b=_9.common,_c="height=${h},width=${w},status=yes,toolbar=yes,menubar=no,location=no,scrollbars=yes,resizable=yes";
function _d(_e,_f){
var _10=_e;
_f=(_f&&_8[_f])?_f:_3.getObject("ibmConfig.serviceName");
if(!_e){
_10=_9[_f]||_b;
}else{
if(_e.indexOf(_7)!==0){
_10=(_8[_f]||_a)+_e.substring(_e.lastIndexOf("/")+1);
}
}
return _10;
};
function _11(){
var h=Math.max(window.screen.height/4,770);
var w=Math.max(window.screen.width/4,980);
return _6.substitute(_c,{h:h,w:w});
};
var _12=_3.mixin(_3.getObject("lconn.core.help",true),{launchDemo:function(_13){
if(!_13){
return;
}
var w=window.open(_13,"_icDemoWindow",_11());
if(w){
w.focus();
}
},launchHelp:function(_14,_15){
if(!_1.help){
return;
}
var w=window.open(this.getProductHelpUrl(_14,_15),"_icHelpWindow",_11());
if(w){
w.focus();
}
},getProductHelpUrl:function(_16,_17){
var _18,_19=_2.getServiceUrl(_1.help);
var _1a=/(([A-Za-z]{3,9}):\/\/)([-;:&=\+\$,\w]+@{1})?([-A-Za-z0-9\.]+)+:?(\d+)?((\/[-\+~%\/\.\w]+)?\??([-\+=&;%@\.\w]+)?#?([\w]+)?)?/gi;
if(_1a.test(_16)){
_18=_16;
}else{
if(_19){
_18=_19.toString()+_d(_16,_17);
}
}
return _18;
},createHelpLink:function(el,_1b,_1c){
var _1d=_4.byId(el),_2=this.getProductHelpUrl(_1b,_1c);
_5.set(el,"href",this.getProductHelpUrl(_1b,_1c));
return on(el,"click",function(e){
e.preventDefault(),e.stopPropagation();
_12.launchHelp(_1b);
});
}});
return _12;
});


;if(!dojo._hasResource["lotuslive.widgets.help"]){
dojo._hasResource["lotuslive.widgets.help"]=true;
dojo.provide("lotuslive.widgets.help");










lotuslive.widgets.help={custom_url:false,_updateHelpMenuInNavbar:function(){
navigation_banner_updateHelpMenu(null,lconn.core.help.getProductHelpUrl());
console.debug("Help link updated");
},updateHelpLinkInNavbarMenu:function(){
if(typeof (navigation_banner_updateHelpMenu)=="undefined"){
console.debug("Navbar not available yet, need to wait");
window.setTimeout(function(){
lotuslive.widgets.help.updateHelpLinkInNavbarMenu();
},200);
}else{
console.debug("Navbar available now");
this._updateHelpMenuInNavbar();
}
},set_custom_navbar_help_url:function(_1){
if(typeof _1!="undefined"&&_1!=""){
this.custom_url=_1;
}
}};
(function(_2,_3){
var _4="/topic/",_5={activities:_4+"com.ibm.cloud.activities.doc/",blogs:_4+"com.ibm.cloud.communities.doc/",common:_4+"com.ibm.cloud.welcome.doc/",communities:_4+"com.ibm.cloud.communities.doc/",files:_4+"com.ibm.cloud.files.doc/",forums:_4+"com.ibm.cloud.communities.doc/",homepage:_4+"com.ibm.cloud.welcome.doc/",news:_4+"com.ibm.cloud.welcome.doc/",profiles:_4+"com.ibm.cloud.people.doc/",search:_4+"com.ibm.cloud.welcome.doc/",wikis:_4+"com.ibm.cloud.communities.doc/",metrics:_4+"com.ibm.cloud.communities.doc/"},_6={activities:_5["activities"]+"aframe.html",blogs:_5["blogs"]+"community_blog_frame.html",common:_5["common"]+"welcome.html",communities:_5["communities"]+"cframe.html",files:_5["files"]+"fframe.html",forums:_5["forums"]+"community_forum_frame.html",homepage:_5["homepage"]+"activitystream.html",news:_5["news"]+"notifications.html",profiles:_5["profiles"]+"pframe.html",search:_5["search"]+"search.html",wikis:_5["wikis"]+"community_wiki_frame.html",metrics:_5["metrics"]+"t_com_metrics_whatis1.html"},_7=_5["common"],_8=_6["common"],_9={activities:"http://ibmtvdemo.edgesuite.net/software/lotus/uxid/smartcloud/engage/taking_action_with_activities/{lang}/taking_action_with_activities.html",common:"",communities:"http://ibmtvdemo.edgesuite.net/software/lotus/uxid/smartcloud/engage/communities/{lang}/tapping_into_the_power_of_the_community.html",files:"http://ibmtvdemo.edgesuite.net/software/lotus/uxid/smartcloud/engage/uploading/{lang}/uploading_and_sharing_files.html",wikis:""},_a=_9["common"],_b={"/topic/com.ibm.lotus.connections.homepage.help/t_using_my_to_do_list_widget.html":"/topic/com.ibm.cloud.activities.doc/aframe.html","/topic/com.ibm.lotus.connections.homepage.help/t_hp_using_events_widget.html":"/topic/com.ibm.cloud.communities.doc/community_events_frame.html"},_c={"/topic/com.ibm.lotus.connections.homepage.help/t_using_my_to_do_list_widget.html":"/support/knowledgecenter/SSL3JX/activities/aframe.html","/topic/com.ibm.lotus.connections.homepage.help/t_hp_using_events_widget.html":"/support/knowledgecenter/SSL3JX/community_events_frame.html","t_pers_tag_your_profile.html":"people/t_pers_tag_your_profile.html","t_people_edityourprofile.html":"people/t_people_edityourprofile.html","/welcome/welcome_get_started_set_up_profile.html":"welcome/welcome_get_started_set_up_profile.html"},_d="help3",_e="topic",_f=_d+"/"+_e+"/"+"com.ibm.cloud.verse.preview.doc",_10={"profiles":_f+"/"+"faq_my_profile.html","files":_f+"/"+"faq_myfiles.html"},_11="https://www.ibm.com",_12="/support/knowledgecenter/SSL3JX",_13={activities:_12+"/activities/",blogs:_12+"/communities/",common:_12+"/welcome/",communities:_12+"/communities/",files:_12+"/files/",forums:_12+"/communities/",homepage:_12+"/welcome/",news:_12+"/welcome/",profiles:_12+"/",search:_12+"com.ibm.cloud.welcome.doc/",wikis:_12+"/communities/",metrics:_12+"com.ibm.cloud.communities.doc/"},_14={activities:_13["activities"]+"aframe.html",blogs:_13["blogs"]+"community_blog_frame.html",common:_13["common"]+"welcome.html",communities:_13["communities"]+"cframe.html",files:_13["files"]+"fframe.html",forums:_13["forums"]+"community_forum_frame.html",homepage:_13["homepage"]+"activitystream.html",news:_13["news"]+"notifications.html",profiles:_13["profiles"]+"people/c_people_profiles.html",search:_13["search"]+"search.html",wikis:_13["wikis"]+"community_wiki_frame.html",metrics:_13["metrics"]+"t_com_metrics_whatis1.html"},_15=_14["common"];
function _16(){
var _17=lconn.core.locale.getLanguage(),_18,_19=dojo.getObject("ibmConfig.serviceName");
switch(_17){
case "ja":
case "de":
case "fr":
case "es":
_18=_17;
break;
case "zh":
_18="cn";
break;
default:
_18="en";
}
return (_9[_19]||_a).replace("{lang}",_18);
};
function _1a(_1b,_1c){
_1c=_1c||dojo.getObject("ibmConfig.serviceName");
var _1d=_1e(_1b),_1f=_1d;
if(!_1d){
_1f=_6[_1c]||_8;
}else{
if(_1d.indexOf(_4)!==0){
_1f=(_5[_1c]||_7)+_1d.substring(_1d.lastIndexOf("/")+1);
}
}
return _1f;
};
function _20(_21,_22){
_22=_22||dojo.getObject("ibmConfig.serviceName");
var _23=_1e(_21),_24=_23;
if(!_23){
_24=_14[_22]||KNOWLEDGE_BASE_DEFAULT_COMMON_TOPIC_PATH;
}else{
if(_23.indexOf(_4)!==0){
_24=(_13[_22]||_15)+_23;
}
}
if(typeof _25[_2.location.pathname]!="undefined"){
if(_25[_2.location.pathname].topic_required){
if(typeof _21!="undefined"&&typeof _21!="null"){
_24=_25[_2.location.pathname].link;
}
}else{
_24=_25[_2.location.pathname].link;
}
}
return _24;
};
function _1e(_26){
return _c[_26]||_26;
};
var lch=lconn.core.help,_27=lch.getProductHelpUrl,_28=lch.launchDemo;
lconn.core.help.getProductHelpUrl=function(_29,_2a){
var _2b=typeof gllConnectionsData!=="undefined"&&gllConnectionsData.isVerseOnly?_2c(_2a):null;
if(_2b){
return lconn.core.url.rewrite(_2b,{lang:lconn.core.locale.toJavaLocale()});
}
var _2d=_11;
var url=_1e(_29);
if(!(/^http/i).test(url)){
if(_2d){
url=_2d.toString()+_20(_29,_2a);
}
}
if(lotuslive.widgets.help.custom_url!=false){
url=lotuslive.widgets.help.custom_url;
}
return url;
};
var _25={"/profiles/html/searchProfiles.do":{"link":"/support/knowledgecenter/SSL3JX/people/find_people.html","topic_required":false},"/communities/service/html/communitycreate":{"link":"/support/knowledgecenter/SSL3JX/communities/richtext_editor.html","topic_required":true},"/communities/service/html/communityedit":{"link":"/support/knowledgecenter/SSL3JX/communities/richtext_editor.html","topic_required":true},"/communities/service/html/communityview":{"link":"/support/knowledgecenter/SSL3JX/communities/richtext_editor.html","topic_required":true},"/activities/service/html/mainpage":{"link":"/support/knowledgecenter/SSL3JX/communities/richtext_editor.html","topic_required":true},"/communities/service/html/communitystart":{"link":"/support/knowledgecenter/SSL3JX/communities/richtext_editor.html","topic_required":true},"/blogs/roller-ui/authoring/weblog.do":{"link":"/support/knowledgecenter/SSL3JX/communities/richtext_editor.html","topic_required":true},"/wikis/home":{"link":"/support/knowledgecenter/SSL3JX/communities/richtext_editor.html","topic_required":true},"/communities/service/html/composeemail":{"link":"/support/knowledgecenter/SSL3JX/communities/richtext_editor.html","topic_required":true},"/communities/service/html/communityoverview":{"link":"/support/knowledgecenter/SSL3JX/communities/richtext_editor.html","topic_required":true}};
lch.launchDemo=function(_2e){
var url=_16();
_28(url);
};
function _2c(_2f){
var _30=lconn.core.url.getServiceUrl(lconn.core.config.services.help),_2f=_2f||dojo.getObject("ibmConfig.serviceName"),_31=_10[_2f];
return _31?_30.scheme+"://"+_30.host+"/"+_31:null;
};
})(window,document);
}


;if(!dojo._hasResource["lconn.core.PeopleDataStore"]){
dojo._hasResource["lconn.core.PeopleDataStore"]=true;
dojo.provide("lconn.core.PeopleDataStore");
dojo.declare("lconn.core.PeopleDataStore",null,{constructor:function(_1,_2){
this.queryParam=(_1.queryParam?_1.queryParam:_2.getAttribute("queryParam"));
this.url=(_1.url?_1.url:_2.getAttribute("url"));
this.cache=[];
this.dirCache=[];
this.network=_1.network;
},queryParam:"",searchDirectory:false,cache:null,dirCache:null,network:null,fetch:function(_3){
var _4={};
var _5;
this.searchDirectory=(_3.queryOptions.searchDirectory?true:false);
if(this.searchDirectory){
_5=this.dirCache;
}else{
_5=this.cache;
}
if(typeof _5[_3.query.toLowerCase()]=="object"){
_3.count=_5.length;
_3.onComplete(_5[_3.query.toLowerCase()],_3);
return _3;
}
if(this.queryParam){
_4[this.queryParam]=_3.query;
}
if(this.searchDirectory){
_4.usedirectory="yes";
}
this.networkGet({url:this.url,content:_4,handleAs:"json-comment-optional",timeout:60000,load:dojo.hitch(this,function(_6){
var _7;
if(this.searchDirectory){
_7=this.dirCache;
}else{
_7=this.cache;
}
_3.count=_6.items.length;
_7[_3.query.toLowerCase()]=_6.items;
if(_3.onComplete){
_3.onComplete(_6.items,_3);
}
}),error:function(e,_8){
console.log("There was an error: "+e.message);
_8.xhr.abort();
}});
return _3;
},networkGet:function(_9){
if(this.network&&this.network.get){
return this.network.get(_9);
}
return (this.network||dojo).xhrGet(_9);
},getValue:function(_a,_b,_c){
if(_a[_b]){
return _a[_b];
}else{
return _c;
}
}});
}


;if(!dojo._hasResource["lconn.core.PeopleFinderDataStore"]){
dojo._hasResource["lconn.core.PeopleFinderDataStore"]=true;
dojo.provide("lconn.core.PeopleFinderDataStore");


dojo.declare("lconn.core.PeopleFinderDataStore",lconn.core.PeopleDataStore,{fetch:function(_1){
var _2={pageSize:_1&&_1.count?_1.count:15,highlight:false,query:_1&&_1.query,searchOnlyNameAndEmail:true};
var _3;
this.searchDirectory=_1&&_1.queryOptions&&_1.queryOptions.searchDirectory;
if(this.searchDirectory){
_3=this.dirCache;
}else{
_3=this.cache;
}
if(_1&&_1.query&&_3[_1.query]&&_3.hasOwnProperty(_1.query)){
_1.count=_3.length;
_1.onComplete(this.convertPeopleFinderResults(_3[_1.query.toLowerCase()]),_1);
return _1;
}
if(this.queryParam&&_1&&_1.query){
_2[this.queryParam]=_1.query;
}
if(this.searchDirectory){
_2.usedirectory="yes";
}
this.networkGet({url:this.url,content:_2,handleAs:"json-comment-optional",timeout:60000,load:dojo.hitch(this,function(_4){
var _5,_6;
if(this.searchDirectory){
_5=this.dirCache;
}else{
_5=this.cache;
}
_6=_4.persons?_4.persons:_4.items;
_1.count=_4.numResultsInCurrentPage;
_5[_1.query.toLowerCase()]=_6;
if(_1.onComplete){
_1.onComplete(this.convertPeopleFinderResults(_6),_1);
}
}),error:function(e,_7){
console.log("There was an error: "+e.message);
_7.xhr.abort();
}});
return _1;
},convertPeopleFinderResults:function(_8){
if(!_8||!_8.length||_8.length===0){
return _8;
}
var _9=new Array();
for(var i=0;i<_8.length;i++){
_9.push(this.convertPeopleFinderResult(_8[i]));
}
return _9;
},convertPeopleFinderResult:function(_a){
var _b={};
var _c=_a.userType=="VISITOR"?"EXTERNAL":_a.userType;
_b["userid"]=_a.id;
_b["type"]="0";
_b["name"]=_a.name;
_b["param"]=_a.id+"\x02"+_a.name;
_b["member"]=_a.email;
_b["ext"]={mode:_c};
return _b;
}});
}


;if(!dojo._hasResource["lconn.core.PeopleTypeAheadFormatMixin"]){
dojo._hasResource["lconn.core.PeopleTypeAheadFormatMixin"]=true;
dojo.provide("lconn.core.PeopleTypeAheadFormatMixin");






(function(_1,_2){
dojo.declare("lconn.core.PeopleTypeAheadFormatMixin",lconn.core.TypeAheadFormatMixin,{formatItem:function(_3,_4){
var _5=this._getLabelFromItem(_3);
return _4?this._htmlify(_5):_5;
},_getLabelFromItem:function(_6){
var _7=[];
if(_6){
if(typeof _6=="string"){
return _6;
}
if(_6.name){
_7.push((_2.isRTLValue(_6.name)&&!dojo._isBodyLtr())?"\u202a"+_6.name+"\u202c":_6.name);
if(_6.businessOwner){
_7.push(":");
var _8=!_2.isRTLValue(_6.businessOwner.charAt(0));
_7.push(!dojo._isBodyLtr()&&_8?_2.enforceTextDirection(_6.businessOwner,"rtl"):_6.businessOwner);
}
}
var _9=_6.member||_6.email;
if(_9){
_7.push(dojo._isBodyLtr()?"<"+_9+">\u200e":"\u200e<"+_9+">\u200e");
}
}
return dojo._isBodyLtr()?_7.join(" "):_2.enforceTextDirection(_7.join(" "),"rtl");
},_htmlify:function(_a){
return _1.encodeHtml(_a).replace(/"/g,"&quot;").replace(/\u200e/g,"&lrm;");
}});
}(lconn.core.util.html,lconn.core.globalization.bidiUtil));
}


;if(!dojo._hasResource["lconn.core.PeopleTypeAhead"]){
dojo._hasResource["lconn.core.PeopleTypeAhead"]=true;
dojo.provide("lconn.core.PeopleTypeAhead");












dojo.declare("lconn.core.PeopleTypeAhead",[lconn.core.TypeAhead,lconn.core.Res,lconn.core.PeopleTypeAheadFormatMixin],{isGroup:false,isPersonAndGroup:false,isCommunity:false,size:"",pageSize:lconn.core.config.properties["people.typeahead.pageSize"]?lconn.core.config.properties["people.typeahead.pageSize"]:15,multipleValues:false,NoResultsMessage:"",HeaderMessage:"",showHintText:true,disableSearchDirectory:false,autoSelectChars:[","],focused:false,templateString:null,templatePath:dojo.moduleUrl("lconn.core","templates/ComboBox.html"),disableBizCard:false,postMixInProperties:function(){
this.loadDefaultBundle();
this.searchDirectory=this.resBundle.rs_searchDirectory;
if(this.isGroup){
this.searchDirectory=this.resBundle.rs_searchGroupDirectory;
}else{
if(this.isCommunity){
this.searchDirectory=this.resBundle.rs_searchCommunityDirectory;
}else{
if(this.isPersonAndGroup){
this.searchDirectory=this.resBundle.rs_searchPersonAndGroupDirectory;
}
}
}
if(this.showHintText){
this.hintText=this.resBundle.rs_shadowText_searchDirectory;
if(this.isGroup){
this.hintText=this.resBundle.rs_shadowText_searchGroupDirectory;
}else{
if(this.isCommunity){
this.hintText=this.resBundle.rs_shadowText_searchCommunityDirectory;
}else{
if(this.isPersonAndGroup){
this.hintText=this.resBundle.rs_shadowText_searchPersonAndGroupDirectory;
}
}
}
}else{
this.hintText=null;
}
this.inherited(arguments);
this.baseClass="lotusText";
},postCreate:function(){
this.inherited(arguments);
var _1=this.resBundle.rs_shadowText_searchDirectory;
if(this.isGroup){
_1=this.resBundle.rs_shadowText_searchGroupDirectory;
}else{
if(this.isCommunity){
_1=this.resBundle.rs_shadowText_searchCommunityDirectory;
}else{
if(this.isPersonAndGroup){
_1=this.resBundle.rs_shadowText_searchPersonAndGroupDirectory;
}
}
}
var _2=dojo.place("<div id=\""+this.id+"_ariaDescribedBy"+"\" style=\"display:none;\">"+_1+"</div>",this.domNode,"after");
dojo.attr(this.domNode,"aria-describedby",this.id+"_ariaDescribedBy");
},getItem:function(){
return (this.item?this.item:null);
},_onKey:function(_3){
this.inherited(arguments);
var _4=dojo.keys;
if(this.focusNode.value&&this._currentInput&&this.focusNode.value!=this._currentInput&&_3.keyCode!==dojo.keys.ENTER){
this.focusNode.value=this._currentInput;
if(dojo.isIE||(!!navigator.userAgent.match(/Trident\/7\./))){
var _5=this.focusNode;
_5.focus();
var _6=_5.createTextRange();
_6.collapse(false);
_6.select();
}
}
switch(_3.keyCode){
case _4.PAGE_DOWN:
case _4.DOWN_ARROW:
case _4.PAGE_UP:
case _4.UP_ARROW:
if(this._opened){
this._popupWidget._focusOptionNode(this._popupWidget.getHighlightedOption());
}
break;
case _4.ENTER:
var pw=this._popupWidget;
if(pw.getHighlightedOption()==pw.searchButton){
pw.searchDirectory();
}
break;
}
},_onFocus:function(_7){
this.inherited(arguments);
this.focused=true;
},_onBlur:function(_8){
this.focused=false;
var pw=this._popupWidget;
if(!(pw&&pw.tooltipFocused)){
this.inherited(arguments);
}
if(dojo.isIE&&this.dropdownNode){
dojo.removeClass(this.dropdownNode,"lconnTypeAhead");
}
this.updateHintText();
},_startSearch:function(_9,_a){
_a=_a||{};
if(_a.searchImmediately){
_a.searchBoth=true;
}
var _b=this.id+"_popup";
if(!this._popupWidget){
this._popupWidget=this.dropDown=new lconn.core.PeopleTypeAheadMenu({_strings:this._strings,rs_searchDirectory:this.searchDirectory,NoResultsMessage:this.NoResultsMessage,HeaderMessage:this.HeaderMessage,disableSearchDirectory:this.disableSearchDirectory,onChange:dojo.hitch(this,this._selectOption),id:_b,inputWidget:this,disableBizCard:this.disableBizCard});
var _c=this.textbox.getAttribute("wairole");
if(_c){
dijit.setWaiRole(this.textbox,_c);
}
dijit.setWaiState(this._popupWidget.domNode,"live","polite");
dijit.removeWaiState(this.focusNode,"activedescendant");
}else{
dijit.setWaiState(this.focusNode,"activedescendant",_b);
}
this.item=null;
var _d=dojo.clone(this.query);
this._lastQuery=_d=_9;
this.searchTimer=this.defer(dojo.hitch(this,function(_e,_f){
var _10=this.store.fetch({queryOptions:dojo.mixin({ignoreCase:this.ignoreCase,deep:true},_a),query:_e,onComplete:dojo.hitch(this,"_openResultList"),onError:function(_11){
console.error("dijit.form.ComboBox: "+_11);
dojo.hitch(_f,"_hideResultList")();
},start:0,count:this.pageSize});
var _12=function(_13,_14){
_13.start+=_13.count*_14;
_13.direction=_14;
this.store.fetch(_13);
};
this._nextSearch=this._popupWidget.onPage=dojo.hitch(this,_12,_10);
this._popupWidget.searchDirectory=dojo.hitch(this,dojo.hitch(this,function(){
_10.queryOptions.searchDirectory=true;
this.store.fetch(_10);
}));
},_d,this),_a.searchImmediately?1:this.searchDelay);
},_openResultList:function(_15,_16){
if(this.disabled||this.readOnly||(_16.query!=this._lastQuery)){
return;
}
this._popupWidget.clearResultList();
if(_15.length){
var _17=new String(this.formatItem(_15[0]));
if(_17&&this.autoComplete&&!this._prev_key_backspace&&(_16.query!="")){
this._autoCompleteText(_17);
}
}
_16._maxOptions=this._maxOptions;
this._popupWidget.createOptions(_15,_16,dojo.hitch(this,"_getMenuLabelFromItem"));
this.results=_15;
var _18=dijit.form.ComboBox.prototype._hideResultList;
dijit.form.ComboBox.prototype._hideResultList=function(){
};
this._showResultList();
dijit.form.ComboBox.prototype._hideResultList=_18;
dojo.place(this._popupWidget.headerNode,this._popupWidget.domNode,"before");
this._popupWidget.domNode.parentNode.setAttribute("aria-label","Type Ahead");
document.activeElement.removeAttribute("aria-owns");
this._popupWidget.selected=null;
if(dojo.isIE&&(this.focusNode!=document.activeElement)&&!this.focusNode.preventFocus){
this.focusNode.focus();
}
if(_16.direction){
if(1==_16.direction){
this._popupWidget.highlightFirstOption();
}else{
if(-1==_16.direction){
this._popupWidget.highlightLastOption();
}
}
}
}});
dojo.declare("lconn.core.PeopleTypeAheadMenu",[dijit.form._ComboBoxMenu,lconn.core.Res],{rs_searchDirectory:" ",NoResultsMessage:"",HeaderMessage:"",templateString:"<div waiRole='listbox' class='lconnPeopleTypeAheadMenu dijitReset dijitMenu' dojoAttachPoint='containerNode' tabIndex='-1' style='overflow:\"auto\";'>"+"<div class='dijitMenuItem dijitMenu headerNode lotusHidden' dojoAttachPoint='headerNode' tabIndex='-1'></div>"+"<div class='dijitMenuItem dijitMenuPreviousButton' dojoAttachPoint='previousButton' role='option' tabIndex='-1'></div>"+"<div class='dijitMenuItem lotusAlignLeft resultsNode'  style='overflow: hidden;' dojoAttachPoint='resultsNode' role='option'></div>"+"<div class='dijitMenuItem searchDirectory ${searchDirectoryClass}' dojoAttachPoint='searchButton' role='option'>${rs_searchDirectory}</div>"+"<div class='dijitMenuItem dijitMenuNextButton' dojoAttachPoint='nextButton' role='option'></div>"+"</div>",_messages:null,searchDirectoryClass:"",disableSearchDirectory:false,disableBizCard:false,inputWidget:null,tooltipFocused:false,tooltipAroundNode:null,tooltipTimeout:null,tooltipDelay:600,tooltipId:0,popupClosed:true,postMixInProperties:function(){
this.loadDefaultBundle();
this.inherited("postMixInProperties",arguments);
if(this.disableSearchDirectory){
this.searchDirectoryClass="lotusHidden";
}
if(!this.NoResultsMessage){
this.NoResultsMessage=this.resBundle.rs_noResults||"";
}
},postCreate:function(){
dojo.attr(this.previousButton,"aria-label",this.resBundle.rs_navPrevLabel);
dojo.attr(this.searchButton,"aria-label",this.rs_searchDirectory);
dojo.attr(this.nextButton,"aria-label",this.resBundle.rs_more);
this.searchButton.selectHandler=dojo.hitch(this,function(evt){
dojo.stopEvent(evt);
this.searchDirectory();
return true;
});
this.resultsNode.selectHandler=dojo.hitch(this,function(evt){
dojo.stopEvent(evt);
return true;
});
if(dojo.version.minor===7&&dojo.version.patch>4||dojo.version.minor===9&&dojo.version.patch>2||dojo.version.minor===10){
this.connect(this.domNode,"mousedown",function(e){
dojo.stopEvent(e);
});
}
this.inherited("postCreate",arguments);
},searchDirectory:function(){
},setValue:function(_19){
if(_19.target.item){
this.value=_19;
this.onChange(_19);
}
},_onClick:function(evt){
if(evt.target==this.searchButton){
this.searchDirectory();
}else{
if(evt.target!=this.resultsNode){
this.inherited("_onClick",arguments);
}
}
},_onMouseUp:function(evt){
if(evt.target==this.searchButton){
this.searchDirectory();
}else{
if(evt.target!=this.resultsNode){
this.inherited("_onMouseUp",arguments);
}
}
},_onMouseOver:function(evt){
if(evt.target===this.domNode){
return;
}
var tgt=evt.target;
if(!(tgt==this.previousButton||tgt==this.nextButton||tgt==this.searchButton||tgt==this.resultsNode)){
while(tgt&&!tgt.getAttribute("item")){
tgt=tgt.parentNode;
}
}
this._focusOptionNode(tgt);
},_focusOptionNode:function(_1a){
if(this._highlighted_option!=_1a){
this._blurOptionNode();
this._highlighted_option=_1a;
dojo.removeClass(this._highlighted_option,"dijitMenuItemSelected");
dojo.addClass(this._highlighted_option,"dijitMenuItemHover");
var _1b=dojo.attr(_1a,"exid");
var _1c=dojo.attr(_1a,"persontype");
this.closeTooltip();
this.tooltipId++;
this.popupClosed=false;
if(_1b&&(_1c==0)&&!this.disableBizCard){
this.renderBizCard(_1b,_1a);
}else{
if(_1c!=-1){
this.inputWidget._announceOption(_1a);
}
}
}
},renderBizCard:function(_1d,_1e){
if(dojo.isFunction(dojo.getObject("lconn.profiles.bizCard.bizCard.renderMiniBizCard"))){
this.tooltipTimeout=setTimeout(dojo.hitch(lconn.profiles.bizCard.bizCard,"renderMiniBizCard",_1d,dojo.hitch(this,"showTooltip",this.tooltipId,_1e)),this.tooltipDelay);
}else{
this.inputWidget._announceOption(_1e);
}
},_blurOptionNode:function(){
if(this._highlighted_option){
dojo.removeClass(this._highlighted_option,"dijitMenuItemHover");
this._highlighted_option=null;
}
},_createOption:function(_1f,_20){
var _21=this.inherited("_createOption",arguments);
if(_1f.userid){
dojo.attr(_21,"exid",_1f.userid);
dojo.attr(_21,"aria-labelledby","bc_document_node");
}
if(_1f.type){
dojo.attr(_21,"persontype",_1f.type);
}
return _21;
},createOptions:function(_22,_23,_24){
dojo.publish("lconn/core/typeahead/open");
this.clearResultList();
this.items=_22;
if(!_23.start||_23.start==0){
this.previousButton.style.display="none";
}else{
this.previousButton.style.display="";
dojo.removeAttr(this.previousButton,"tabindex");
}
dojo.attr(this.previousButton,"id",this.id+"_prev");
if(this.HeaderMessage){
var el=this.headerNode;
while(el.firstChild){
el.removeChild(el.firstChild);
}
el.appendChild(document.createTextNode(this.HeaderMessage));
el.setAttribute("id",this.id+"_headerMessage");
el.setAttribute("item",this.HeaderMessage);
this.domNode.setAttribute("aria-describedby",this.id+"_headerMessage");
dojo.removeClass(el,"lotusHidden");
if(!dojo._isBodyLtr()){
dojo.addClass(el,"dijitMenuItemRtl");
}
}
var _25=_23.start||0;
var _26=_25+(_23.count||0);
dojo.forEach(_22,function(_27,i){
if(_23.count&&(i<_25||i>=_26)){
return;
}
var _28=this._createOption(_27,_24);
var _29=_28.innerHTML;
if(_22[i].userid=="null"&&_22[i].type==-1){
while(_28.firstChild){
_28.removeChild(_28.firstChild);
}
_28.appendChild(document.createTextNode(_29));
_28.item=_29;
this.resultsNode=_28;
}else{
dojo.attr(_28,"id",this.id+i);
_28.className=dojo._isBodyLtr()?"dijitMenuItem":"dijitMenuItem dijitMenuItemRtl";
_28.setAttribute("item",i);
}
dojo.style(_28,"overflow","hidden");
this.domNode.insertBefore(_28,this.nextButton);
},this);
this.nextButton.style.display=(_23.count&&_26<_22.length)?"":"none";
dojo.attr(this.nextButton,"id",this.id+"_next");
var el=this.resultsNode;
if(_22.length==0&&this.NoResultsMessage){
var _2a=dojo.string.substitute(this.NoResultsMessage,[_23.query]);
while(el.firstChild){
el.removeChild(el.firstChild);
}
el.appendChild(document.createTextNode(_2a));
el.item=_2a;
this.domNode.insertBefore(el,this.nextButton);
}
dojo.attr(this.resultsNode,"id",this.id+"_resultsNode");
if(!_23.queryOptions.searchDirectory&&_23.searchType!="directory"){
this.domNode.insertBefore(this.searchButton,this.nextButton);
}
dojo.attr(this.searchButton,"id",this.id+"_searchDir");
if(!dojo._isBodyLtr()){
dojo.addClass(this.searchButton,"dijitMenuItemRtl");
}
},clearResultList:function(){
var _2b=this.previousButton;
var _2c=this.nextButton;
while(_2b.nextSibling&&_2b.nextSibling!=_2c){
this.domNode.removeChild(_2b.nextSibling);
}
},getListLength:function(){
return this.domNode.childNodes.length-2-(this.searchButton.parentNode?1:0)-(this.resultsNode.parentNode?1:0)-(this.headerNode.parentNode?1:0);
},showTooltip:function(id,_2d,_2e){
if(_2d.parentNode&&_2d.parentNode.parentNode&&_2d.parentNode.parentNode.style.display==="none"){
this.popupClosed=true;
}
if(id==this.tooltipId&&!this.popupClosed){
this.tooltipAroundNode=_2d;
dijit.showTooltip(_2e,_2d,["after","before"]);
dijit._masterTT.containerNode.removeAttribute("wairole");
dijit._masterTT.containerNode.removeAttribute("role");
this.inputWidget._announceOption(_2d);
dojo.publish("com/ibm/social/incontext/typeahead/onMiniBizCardDisplay",[_2e]);
var a=dojo.query("a","cardBody")[0];
if(a){
this.connect(a,"onblur",dojo.hitch(this,function(){
this.tooltipFocused=false;
var iw=this.inputWidget;
setTimeout(function(){
if(!(iw&&iw.focused)){
iw._hideResultList();
}
},100);
}));
dojo.connect(a,"onkeypress",dojo.hitch(this,function(evt){
var key=evt.charOrCode;
var dk=dojo.keys;
var iw=this.inputWidget;
switch(key){
case dk.ESCAPE:
this.closeTooltip();
if(iw&&iw.domNode){
iw.domNode.focus();
}
break;
case dk.TAB:
if(iw&&iw.domNode){
iw.domNode.focus();
}
dojo.stopEvent(evt);
break;
}
}));
}
}
},closeTooltip:function(){
if(this.tooltipAroundNode){
dijit.hideTooltip(this.tooltipAroundNode);
this.tooltipAroundNode=null;
}
if(this.tooltipTimeout){
clearTimeout(this.tooltipTimeout);
this.tooltipTimeout=null;
}
},onPage:function(_2f){
this.debugLog("Entered PeopleTypeAhead onPage: direction = "+_2f);
this.debugLog("Left PeopleTypeAhead onPage");
},onClose:function(){
dojo.publish("lconn/core/typeahead/close");
this.popupClosed=true;
this.closeTooltip();
this._blurOptionNode();
}});
}


;if(!dojo._hasResource["lconn.core.PeopleFinderTypeAhead"]){
dojo._hasResource["lconn.core.PeopleFinderTypeAhead"]=true;
dojo.provide("lconn.core.PeopleFinderTypeAhead");


dojo.declare("lconn.core.PeopleFinderTypeAhead",[lconn.core.PeopleTypeAhead],{previousKey:null,formatItemHtml:function(_1){
return this.formatItem(_1,true);
},formatItem:function(_2,_3){
var _4="";
if(_2.name){
_4+=_2.name;
}
if(_2.member){
_4+=" <"+_2.member+">\u200e";
}
_4=_4.replace(/<b>/gi,"").replace(/<\/b>/gi,"");
return _4;
},_getMenuLabelFromItem:function(_5){
var _6=this.formatItemHtml(_5);
var _7="";
if(this.multipleValues){
_7=dojo.string.trim(this.keyArr[this.keyIdx]);
}else{
_7=dojo.string.trim(this.focusNode.value);
}
return {html:true,label:_6};
},_startSearch:function(_8){
if(!_8||!_8.trim().length){
return;
}
if(this.previousKey&&this.previousKey.trim()===_8.trim()){
return;
}
this.previousKey=_8;
this.inherited(arguments);
}});
}


;if(!dojo._hasResource["lconn.core.CommonTags.AjaxCall"]){
dojo._hasResource["lconn.core.CommonTags.AjaxCall"]=true;
(function(){
dojo.provide("lconn.core.CommonTags.AjaxCall");
dojo.declare("lconn.core.CommonTags.AjaxCall",null,{TAG_URL:"",REDIRECT_URL:"",TAG_TEMPLATE:"",URL_PARAMETERS:null,HANDLE_AS:"",constructor:function(_1){
dojo.mixin(this,_1);
},getTags:function(_2,_3,_4){
var _5=this.generateTagParameters(_4);
var _6={url:this.TAG_URL,content:_5,handleAs:this.HANDLE_AS,timeout:30000,handle:_2};
dojo.xhrGet(_6);
},redirect:function(_7){
if(_7!="undefined"&&_7!=null){
if(this.REDIRECT_URL.indexOf("?")>0){
this.REDIRECT_URL=this.REDIRECT_URL.substring(0,this.REDIRECT_URL.indexOf("?"));
this.REDIRECT_URL+="?";
this.REDIRECT_URL=this.generateTagUrl(this.REDIRECT_URL,_7);
this._redirect(this.REDIRECT_URL);
}else{
this.REDIRECT_URL+="?";
this.REDIRECT_URL=this.generateTagUrl(this.REDIRECT_URL,_7);
this._redirect(this.REDIRECT_URL);
}
}else{
this._redirect(this.REDIRECT_URL);
}
},_redirect:function(_8){
window.location=_8;
},encodeTagParameter:function(_9){
var _a=_9.split(" ");
var _b=null;
for(var i=0;i<_a.length;i++){
var _c=_a[i];
if(i>0){
_b+=" "+encodeURIComponent(_c);
}else{
_b=encodeURIComponent(_c);
}
}
return _b;
},generateTagUrl:function(_d,_e){
for(var i in this.URL_PARAMETERS){
if(i!=this.TAG_TEMPLATE){
var _f=encodeURIComponent(this.URL_PARAMETERS[i]);
_d+=i+"="+_f+"&";
}
}
if(_e!="undefined"&&_e!=null&&_e!=""){
var _10=this.encodeTagParameter(_e);
_d+=this.TAG_TEMPLATE+"="+_10;
}
return _d;
},generateTagParameters:function(_11){
var _12={};
if(this.URL_PARAMETERS!=null){
_12=this.URL_PARAMETERS;
}
if(_11!="undefined"&&_11!=null){
_12[this.TAG_TEMPLATE]=_11;
}
return _12;
},getTotalTagNumber:function(_13,_14){
var _15={url:this.TAG_URL,content:{type:"count",search:_14},handleAs:"json",timeout:30000,handle:function(_16,_17){
if(_16.total){
_13(_16.total);
}else{
_13(_16);
}
}};
dojo.xhrGet(_15);
},getPageTags:function(_18,_19,_1a,_1b){
var _1c={url:this.TAG_URL,content:{type:"all",page:_19,ps:_1a,search:_1b},handleAs:this.HANDLE_AS,timeout:30000,handle:_18};
dojo.xhrGet(_1c);
},clearParamsFromUrl:function(url){
if(url.indexOf("?")>-1){
url=url.substring(0,url.indexOf("?"));
}
return url;
}});
}());
}


;if(!dojo._hasResource["lconn.core.CommonTags.FeedConverter"]){
dojo._hasResource["lconn.core.CommonTags.FeedConverter"]=true;
dojo.provide("lconn.core.CommonTags.FeedConverter");
dojo.declare("lconn.core.CommonTags.FeedConverter",null,{tagList:null,categoriesTagName:"app:categories",parseFeed:function(_1){
var _2=_1.documentElement.childNodes;
if(!_2){
return;
}
this.tagList=new Array();
for(var i=0;i<_2.length;i++){
if(_2[i].localName=="category"||_2[i].baseName=="category"){
var _3=this.generateTagObject(_2[i]);
this.tagList.push(_3);
}
}
return this.tagList;
},generateTagObject:function(_4){
var _5=new Object;
_5.name=_4.getAttribute("term");
var _6=_4.getAttribute("snx:frequency");
if(_6){
_5.frequency=parseInt(_6);
}
var _7=_4.getAttribute("snx:intensityBin");
if(_7){
_5.intensityBin=parseInt(_7);
}
return _5;
}});
}


;if(!dojo._hasResource["lconn.core.aria._Helper"]){
dojo._hasResource["lconn.core.aria._Helper"]=true;
dojo.provide("lconn.core.aria._Helper");
dojo.declare("lconn.core.aria._Helper",null,{allItems:null,selIdx:-1,_connects:null,detectInvert:false,invert:false,cycle:true,containerRole:"",itemRole:"",scrollVertical:true,scrollHorizontal:true,constructor:function(_1,_2){
dojo.safeMixin(this,_2||{});
this._connects=[];
var cn=this.containerNode=this._getNode(_1),ai=this.allItems=dojo.query(["[role='",this.itemRole,"']"].join(""),cn),_3=dojo.forEach;
if(this.detectInvert){
_3(ai,dojo.hitch(this,this._detectInvert));
}
for(var i=0,_4;_4=ai[i];i++){
if(this._isSelected(_4)){
this.selIdx=i;
break;
}
}
if(this.selIdx==-1){
this.selIdx=this._getSelIdx(!this.invert);
}
_3(ai,dojo.hitch(this,this._resetItem,ai[this.selIdx]));
this._connects.push(dojo.connect(cn,"onclick",this,"_onItemClick"));
this._connects.push(dojo.connect(cn,"onkeydown",this,"_onKeyDown"));
},destroy:function(){
dojo.forEach(this._connects,dojo.hitch(dojo,dojo.disconnect));
},focus:function(){
if(this.selIdx>=0){
dijit.focus(this.allItems[this.selIdx]);
}else{
this.focusNextItem();
}
},focusNextItem:function(){
this._focusItem(!this.invert);
},focusPrevItem:function(){
this._focusItem(this.invert);
},_focusItem:function(_5){
var ai=this.allItems,si=this._getSelIdx(_5);
if(si!=this.selIdx){
this._kickOut(ai[this.selIdx]);
this._kickIn(ai[si]);
dijit.focus(ai[si]);
this.selIdx=si;
}
},_getNode:function(_6){
var _7=dojo.byId(_6);
if(!_7){
throw [this.declaredClass,": "+_6," is not a valid node or id"].join("");
}
if(!dijit.hasWaiRole(_7,this.containerRole)){
throw [this.declaredClass," needs a source node with role='",this.containerRole,"'"].join("");
}
return _7;
},_kickOut:function(_8,i){
dojo.attr(_8,"tabindex",-1);
},_kickIn:function(_9,i){
dojo.removeAttr(_9,"tabindex");
},_onItemClick:function(e){
var _a=this._getIndexOfItemFromEvent(e);
if(_a!=-1){
this.selIdx=_a;
var _b=this.allItems[_a];
dojo.forEach(this.allItems,dojo.hitch(this,this._resetItem,_b));
}
},_getIndexOfItemFromEvent:function(e){
var _c=-1,_d;
do{
_d=_d?_d.parentNode:e.target;
_c=dojo.indexOf(this.allItems,_d);
}while(_c==-1&&_d&&_d!=this.containerNode);
return _c;
},_onKeyDown:function(e){
var dk=dojo.keys;
if(e.altKey||e.metaKey||e.ctrlKey||e.shiftKey){
return;
}
var _e=dojo._isBodyLtr()?dk.RIGHT_ARROW:dk.LEFT_ARROW;
var _f=dojo._isBodyLtr()?dk.LEFT_ARROW:dk.RIGHT_ARROW;
switch(e.keyCode){
case this.scrollHorizontal?_e:-1:
case this.scrollVertical?dk.DOWN_ARROW:-1:
dojo.stopEvent(e);
this.focusNextItem();
break;
case this.scrollHorizontal?_f:-1:
case this.scrollVertical?dk.UP_ARROW:-1:
dojo.stopEvent(e);
this.focusPrevItem();
break;
}
},_resetItem:function(sel,_10,i){
if(_10==sel){
this._kickIn(_10);
}else{
this._kickOut(_10);
}
},_detectInvert:function(_11,i){
var ps=[],pp=_11,n=0;
do{
ps.push(dojo.style(pp,"float"));
pp=pp.parentNode;
}while(pp!=this.containerNode&&n++<10);
var rh=(dojo._isBodyLtr()?"right":"left");
if(dojo.indexOf(ps,rh)!=-1){
this.invert=true;
}
},_isSelected:function(_12){
return false;
},_isHidden:function(_13){
var cn=this.containerNode;
var n=_13;
while(n&&n!=cn){
if(dojo.style(n,"display")=="none"||dijit.getWaiState(n,"hidden")=="true"){
return true;
}
n=n.parentNode;
}
return false;
},_getSelIdx:function(fwd){
var n=0,c=this.allItems.length,r=this.selIdx;
do{
r=fwd?this._nextSelIdx(r):this._prevSelIdx(r);
}while(this._isHidden(this.allItems[r])&&n++<c);
return r;
},_prevSelIdx:function(_14){
var ret=-1;
if(this.cycle){
ret=_14-1;
if(ret<0){
ret=this.allItems.length-1;
}
}else{
ret=Math.max(0,_14-1);
}
return ret;
},_nextSelIdx:function(_15){
var ret=-1;
if(this.cycle){
ret=_15+1;
if(ret>=this.allItems.length){
ret=0;
}
}else{
ret=Math.min(this.allItems.length-1,_15+1);
}
return ret;
}});
}


;if(!dojo._hasResource["lconn.core.aria.Listbox"]){
dojo._hasResource["lconn.core.aria.Listbox"]=true;
dojo.provide("lconn.core.aria.Listbox");


dojo.declare("lconn.core.aria.Listbox",lconn.core.aria._Helper,{containerRole:"listbox",itemRole:"option"});
}


;dojo.cache("lconn.core", "CommonTags/templates/typeAhead.html", "<span> <input type=\"text\" id=\"widget_${id}\" class=\"lotusText\" autocomplete=\"off\" ${nameAttrSetting} dojoAttachEvent=\"onkeyup:_onKeyUp\" dojoAttachPoint=\"domNode,comboNode,textbox,focusNode\" waiState=\"haspopup-true,autocomplete-list,expanded-false\" role=\"combobox\"/> <span style=\"display:none\" dojoAttachPoint=\"_buttonNode\"></span></span>");

;if(!dojo._hasResource["lconn.core.CommonTags.CommonTagsTypeAhead"]){
dojo._hasResource["lconn.core.CommonTags.CommonTagsTypeAhead"]=true;
dojo.provide("lconn.core.CommonTags.CommonTagsTypeAhead");








(function(_1){
dojo.requireLocalization("lconn.core","strings");
dojo.declare("lconn.core.CommonTags.CommonTagsTypeAhead",lconn.core.TypeAhead,{hideEmptyResults:true,templateString:null,templatePath:dojo.moduleUrl("lconn.core","CommonTags/templates/typeAhead.html"),submitFormOnNonSelectingEnter:true,postMixInProperties:function(){
this.inherited(arguments);
var b=dojo.i18n.getLocalization("lconn.core","strings");
this.hintText=this.hintText||b.rs_searchInputDefault;
},formatItem:function(_2,_3){
var _4=this._getLabelFromItem(_2);
return _3?_1.encodeHtml(_4):_4;
},_getLabelFromItem:function(_5){
var _6=[];
if(_5){
if(typeof _5=="string"){
return _5;
}
var _7=_5.name||_5.displayName;
if(_7){
_6.push(_7);
}
}
return _6.join(" ");
}});
}(lconn.core.util.html));
}


;if(!dojo._hasResource["lconn.core.CommonTags.TagDialog"]){
dojo._hasResource["lconn.core.CommonTags.TagDialog"]=true;
dojo.provide("lconn.core.CommonTags.TagDialog");




dojo.declare("lconn.core.CommonTags.TagDialog",[dijit._Widget],{dialogTemplate:["<div class=\"lotusDialogBorder\" style=\"width: 650px;\">","<div class=\"lotusDialog\">","<div class=\"lotusDialogHeader\">","<h1 class=\"lotusHeading\">${nls.rs_tagDialogTitle}</h1>","<a class=\"lotusDialogClose\" role=\"button\" href=\"javascript:void(0);\" title=\"${nls.rs_tagDialogCloseTile}\">","<img src=\"${_blankGif}\" alt=\"${nls.rs_tagDialogCloseTile}\" role=\"presentation\" />","<span class=\"lotusAltText\">X</span>","</a>","</div>","<div class=\"lotusDialogContent\">","<div class=\"lotusTagCloud\"></div>","</div>","<div class=\"lotusPaging\" role=\"navigation\"><div class=\"lotusLeft\"></div>","<ul style=\"\" class=\"lotusRight lotusInlinelist\">","<li class=\"lotusFirst\" style=\"display:none\"><a href=\"javascript:void(0);\">${nls.rs_navPrevLabel}</a></li>","<li style=\"display:none\"><a href=\"javascript:void(0);\">${nls.rs_navNextLabel}</a></li>","</ul></div>","</div>","</div>"].join(""),ajaxCall:null,feedConverter:null,dialog:null,page:1,numPerPage:100,total:0,totalPage:0,tagWidget:null,searchBox:null,searchText:"",postMixInProperties:function(){
this.nls=dojo.i18n.getLocalization("lconn.core","strings");
},postCreate:function(){
this.dialog=new dijit.Dialog();
this.dialog.containerNode.innerHTML=dojo.string.substitute(this.dialogTemplate,this);
this.dialog.connect(dojo.query(".lotusDialogClose",this.dialog.containerNode)[0],"onclick","onCancel");
this.content=dojo.query(".lotusTagCloud",this.dialog.containerNode)[0];
this.searchBox=dojo.query(".lotusSearch",this.dialog.containerNode)[0];
dojo.connect(dojo.query("input[name=\"submit\"]",this.searchBox)[0],"onclick",dojo.hitch(this,function(_1){
dojo.stopEvent(_1);
this.search();
}));
this.footer=dojo.query(".lotusPaging",this.dialog.containerNode)[0];
var _2=dojo.query("li",this.footer)[0];
dojo.connect(dojo.query("a",_2)[0],"onclick",this,this.previous);
var _3=dojo.query("li",this.footer)[1];
dojo.connect(dojo.query("a",_3)[0],"onclick",this,this.next);
},reset:function(){
this.page=1;
this.searchText="";
dojo.query("input[type=\"text\"]",this.searchBox)[0].value="";
this.content.innerHTML="<img src=\""+this._blankGif+"\" alt=\"\" class=\"lotusLoading\" />"+this.nls.rs_loading;
},updatePageNumber:function(_4){
this.total=_4;
this.totalPage=Math.ceil(this.total/this.numPerPage);
this.updateFooter();
},updateFooter:function(){
var _5=dojo.query(".lotusLeft",this.footer)[0];
var v1=1+(this.page-1)*this.numPerPage;
var v2=this.page*this.numPerPage<this.total?this.page*this.numPerPage:this.total;
var v3=this.total;
_5.innerHTML=dojo.string.substitute(this.nls.rs_tagDialogPageInfo,[v1,v2,v3]);
var _6=dojo.query("li",this.footer)[0];
var _7=dojo.query("li",this.footer)[1];
if(this.page>1){
dojo.addClass(_6,"lotusFirst");
_6.style.display="inline";
}else{
_6.style.display="none";
}
if(this.page==1){
dojo.addClass(_7,"lotusFirst");
}else{
dojo.removeClass(_7,"lotusFirst");
}
if(this.page<this.totalPage){
_7.style.display="inline";
}else{
_7.style.display="none";
}
},updateContent:function(_8){
var _9=null;
if(this.ajaxCall.HANDLE_AS=="json"){
_9=_8;
}else{
_9=this.feedConverter.parseFeed(_8);
}
this.content.innerHTML="";
var _a=lconn.core.CommonTags.TagTransform.getCloudTags(_9);
for(var i=0;i<_a.length;i++){
var _b=document.createElement("span");
var a=document.createElement("a");
dojo.attr(a,{title:_a[i].frequency,"class":"lotusF"+_a[i].intensityBin,href:"javascript:void(0);",innerHTML:_a[i].name});
dojo.place(a,_b);
_b.innerHTML=" "+_b.innerHTML+" ";
a=dojo.query("a",_b)[0];
dojo.connect(a,"onclick",dojo.hitch(this,function(_c){
dojo.stopEvent(_c);
this.dialog.onCancel();
this.tagWidget._addSelectedTag(dojo.string.trim(_c.target.innerHTML));
}));
dojo.place(_b,this.content);
}
},footerLoading:function(){
var _d=dojo.query(".lotusLeft",this.footer)[0];
_d.innerHTML="<img alt=\"\" src=\""+this._blankGif+"\" class=\"lotusLoading\" />";
},requestTagsCount:function(){
var _e=dojo.hitch(this,this.updatePageNumber);
this.ajaxCall.getTotalTagNumber(_e,this.searchText);
},requestTags:function(){
var _f=dojo.hitch(this,this.updateContent);
this.ajaxCall.getPageTags(_f,this.page,this.numPerPage,this.searchText);
},show:function(){
this.reset();
this.dialog.show();
this.requestTags();
this.requestTagsCount();
},search:function(){
this.page=1;
this.searchText=dojo.string.trim(dojo.query("input[type=\"text\"]",this.searchBox)[0].value);
dojo.query("input[type=\"text\"]",this.searchBox)[0].value="";
var _10=dojo.query(".lotusFilters",this.searchBox)[0];
_10.innerHTML="<a href=\"javascript:void(0);\" class=\"lotusFilter\">"+this.searchText+"<span class=\"lotusClose\">X</span></a>";
dojo.connect(dojo.query("a.lotusFilter",_10)[0],"onclick",this,this.cancelSearch);
_10.style.display="inline";
this.requestTags();
this.requestTagsCount();
},cancelSearch:function(){
this.page=1;
this.searchText="";
dojo.query("input[type=\"text\"]",this.searchBox)[0].value="";
var _11=dojo.query(".lotusFilters",this.searchBox)[0];
_11.innerHTML="";
_11.style.display="none";
this.requestTags();
this.requestTagsCount();
},previous:function(){
this.footerLoading();
this.page--;
this.requestTags();
this.updateFooter();
},next:function(){
this.footerLoading();
this.page++;
this.requestTags();
this.updateFooter();
}});
}


;dojo.cache("lconn.core", "CommonTags/templates/tagWidget.html", "<div> <div dojoAttachPoint=\"_tagMenu,focusNode\"> <div dojoAttachPoint=\"_loadTags\"><img alt=\"${nls.rs_tagLoadingTags}\" src=\"${_blankGif}\" class=\"lotusLoading\" />${nls.rs_tagLoadingTags}</div> <div dojoAttachPoint=\"_noTags\" class=\"lconnEmpty lotusHidden\">${nls.rs_tagCloudNoTags}</div> <div class=\"lotusHidden\" dojoAttachPoint=\"_hasTags\"> <div dojoAttachPoint=\"_selectedTagsSection\" class=\"lotusHidden\"> <h3 style=\"border-bottom:0px;font-weight: bold;margin:0;padding:2px 0 0;\">${nls.rs_tagCloudSelectedTags}</h3> <ul class=\"lotusEditable lotusList lotusMeta\" dojoAttachPoint=\"_selectedTags\" role=\"listbox\" aria-label=\"${nls.rs_tagCloudSelectedTags}\"><li></li></ul> </div> </div> <div dojoAttachPoint=\"_tagSearchText\" class=\"lotusHidden\"> <a href=\"javascript:void(0);\" class=\"lotusBold\" dojoAttachEvent=\"onclick: _showSearchForm\" role=\"button\" title=\"${nls.rs_tagCloudSeachDesc}\">${nls.rs_tagCloudSeachDesc}</a> </div> <div dojoAttachPoint=\"_tagSearchForm\" class=\"lotusChunk lotusSearch lotusHidden\"> <form dojoAttachEvent=\"onsubmit: _searchTag\" style=\"margin:0;\"> <input class=\"lotusText\" dojoAttachPoint=\"_typeAheadDom\" dojoAttachEvent=\"onkeyup:_onKeyUp\"/><span class=\"lotusBtnImg\" title=\"${nls.rs_tagCloudSeach}\"><input type=\"image\" class=\"lotusSearchButton\" src=\"${_blankGif}\" name=\"submit\" alt=\"${nls.rs_tagCloudSeach}\"/><a href=\"javascript:;\" dojoAttachEvent=\"onclick: _searchTag\" class=\"lotusAltText\" role=\"button\">${nls.rs_tagCloudSeach}</a></span> </form> </div> <div dojoAttachPoint=\"_relatedTagsSection\" class=\"lotusHidden lotusChunk10\"> <h3 style=\"border-bottom: 0px; font-weight: bold; margin:0; padding:2px 0 0;\">${nls.rs_tagCloudRelatedTags}</h3> <div>${nls.rs_tagCloudRelatedTagsDescription}</div> <ul class=\"lotusList lotusTags lotusRelatedTags\" dojoAttachPoint=\"_relatedTags\" role=\"listbox\" aria-label=\"${nls.rs_tagCloudRelatedTags}\"><li></li></ul> </div> <div dojoAttachPoint=\"_normalTagsSection\" class=\"lotusHidden lotusChunk10\" aria-label=\"${nls.rs_tagCloudNavigationLabel}\"> <div id=\"${id}_tagCloudView\" dojoAttachPoint=\"_tagCloudView\" class=\"lotusHidden\"> <div dojoAttachPoint=\"_tagCloudTable\" class=\"lotusTagCloud\"></div> </div> <div id=\"${id}_tagListView\" dojoAttachPoint=\"_tagListView\" class=\"lotusHidden\"> <ul id=\"${id}_tagList\" dojoAttachPoint=\"_tagList\" class=\"lotusList lotusEditable lotusMeta\" role=\"listbox\" aria-label=\"${nls.rs_tagsLabel}\"><li></li></ul> </div> <div class=\"lotusChunk lotusSubsection\"> <div dojoAttachPoint=\"_tagCloudLink\" class=\"lotusHidden\"> <ul class=\"lotusInlinelist lotusActions\"> <li class=\"lotusFirst\"><span class=\"lotusBold\" dojoAttachPoint=\"_showCloudSpan,focusNode\" role=\"button\" aria-controls=\"${id}_tagCloudView\" aria-disabled=\"true\" aria-pressed=\"true\" tabindex=\"0\">${nls.rs_viewAsCloud}</span></li> <li><a href=\"javascript:void(0);\" title=\"${nls.rs_viewAsListTitle}\" role=\"button\" aria-controls=\"${id}_tagListView\" dojoAttachPoint=\"_showListLink\" dojoAttachEvent=\"onclick: _showList\">${nls.rs_viewAsList}</a></li> <li dojoAttachPoint=\"_tagCloudAll\" class=\"lotusHidden\"><a href=\"javascript:void(0);\" title=\"${nls.rs_tagCloudViewAllTitle}\" role=\"button\" dojoAttachEvent=\"onclick:_showAllTags\">${nls.rs_tagCloudViewAll}</a></li> </ul> </div> <div dojoAttachPoint=\"_tagListLink\" class=\"lotusHidden\"> <ul class=\"lotusInlinelist lotusActions\"> <li class=\"lotusFirst\"><a href=\"javascript:void(0);\" title=\"${nls.rs_viewAsCloudTitle}\" role=\"button\" aria-controls=\"${id}_tagCloudView\" dojoAttachPoint=\"_showCloudLink\" dojoAttachEvent=\"onclick: _showCloud\">${nls.rs_viewAsCloud}</a></li> <li><span class=\"lotusBold\" dojoAttachPoint=\"_showListSpan\" role=\"button\" aria-controls=\"${id}_tagListView\" aria-disabled=\"true\" aria-pressed=\"true\" tabindex=\"0\">${nls.rs_viewAsList}</span></li> <li dojoAttachPoint=\"_tagListAll\" class=\"lotusHidden\"><a href=\"javascript:void(0);\" title=\"${nls.rs_tagCloudViewAllTitle}\" role=\"button\" dojoAttachEvent=\"onclick:_showAllTags\">${nls.rs_tagCloudViewAll}</a></li> </ul> </div> </div> </div> </div></div>");

;if(!dojo._hasResource["lconn.core.CommonTags.TagWidget"]){
dojo._hasResource["lconn.core.CommonTags.TagWidget"]=true;
dojo.provide("lconn.core.CommonTags.TagWidget");




















dojo.requireLocalization("lconn.core","strings");
(function(){
function _1(el){
if(el){
dojo.addClass(el,"lotusHidden");
}
};
function _2(el){
if(el){
dojo.removeClass(el,"lotusHidden");
}
};
function _3(el){
if(el){
return dojo.hasClass(el,"lotusHidden");
}
return false;
};
function _4(id){
var _5=dijit.byId(id+"commonTagsTypeAhead");
if(_5&&_5.domNode.hasInput){
_5.domNode.value="";
_5.updateHintText();
}
};
dojo.declare("lconn.core.CommonTags.TagWidget",[dijit._Widget,dijit._Templated],{forRecentTags:false,loadOnStartup:true,tags:null,selectedTags:"",redirectUrl:"",urlParameters:null,tagTemplate:"",tagUrl:"",tagStore:null,ajaxCall:null,handleAs:"xml",feedConverter:null,_isRelated:false,disableRelated:false,multiSelected:true,typeAheadFeedUrl:"",typeAheadTemplate:"",tagDialogEnabled:false,tagsTypeaheadEnabled:true,redirectWhenClickTag:true,tagListCount:null,templatePath:dojo.moduleUrl("lconn.core","CommonTags/templates/tagWidget.html"),_selectedTagsArr:null,_viewType:"cloud",_showVis:null,_dialog:null,_showRelatedTags:false,postMixInProperties:function(){
this.inherited(arguments);
this.nls=dojo.i18n.getLocalization("lconn.core","strings");
if(!this.id){
this.id=dijit.getUniqueId("lconnTagWidget");
}
this._dirCode=dojo._isBodyLtr()?"":"\u200f";
},postCreate:function(){
this.inherited(arguments);
if(this.forRecentTags){
this._noTags.innerHTML=this.nls.rs_tagCloudNoRecentTags;
}
this.ajaxCall=this.createAjaxCall();
this.feedConverter=this.createFeedConverter();
if(this.tagsTypeaheadEnabled){
this._createTypeAhead();
}
this.subscribe("com/ibm/lconn/tags/widget/reload",this.reload);
this.subscribe("lconn/core/CommonTags/AddTag",this._addSelectedTag);
this.subscribe("lconn/core/CommonTags/RemoveTag",this._removeSelectedTag);
if(this.loadOnStartup){
this.load();
}
},destroy:function(){
this.inherited(arguments);
this.destroyRelatedHelpers();
this.destroyNormalHelpers();
},destroyRelatedHelpers:function(){
if(this.relatedHelper){
this.relatedHelper.destroy();
}
this.relatedHelper=null;
},destroyNormalHelpers:function(){
if(this.listHelper){
this.listHelper.destroy();
}
this.listHelper=null;
if(this.cloudHelper){
this.cloudHelper.destroy();
}
this.cloudHelper=null;
if(this.selectedTagsListHelper){
this.selectedTagsListHelper.destroy();
}
this.selectedTagsListHelper=null;
},createAjaxCall:function(){
if(this.ajaxCall==null){
this.ajaxCall=new lconn.core.CommonTags.AjaxCall();
this.ajaxCall.TAG_URL=this.tagUrl;
this.ajaxCall.REDIRECT_URL=this.redirectUrl;
this.ajaxCall.TAG_TEMPLATE=this.tagTemplate;
this.ajaxCall.URL_PARAMETERS=this.urlParameters;
if(this.handleAs=="xml"||this.handleAs=="json"){
this.ajaxCall.HANDLE_AS=this.handleAs;
}else{
this.ajaxCall.HANDLE_AS="xml";
}
}
return this.ajaxCall;
},createFeedConverter:function(){
if(this.feedConverter==null){
this.feedConverter=new lconn.core.CommonTags.FeedConverter();
}
return this.feedConverter;
},load:function(){
this.reload(true);
},reload:function(_6,_7){
if(_7!=null){
this.ajaxCall.URL_PARAMETERS=_7;
}
_6=!!_6;
this.prepareData();
this.checkIfRelated();
if(this._isRelated==true){
this.ajaxCall.getTags(dojo.hitch(this,this.ajaxCallBack),_6,this.selectedTags);
}else{
this.ajaxCall.getTags(dojo.hitch(this,this.ajaxCallBack),_6);
}
},reloadTags:function(_8){
this.ajaxCall.URL_PARAMETERS=_8;
this.reload(false);
},ajaxCallBack:function(_9){
if(!_9||_9 instanceof Error){
this._noTags.innerHTML=this.nls.rs_tagCloudError;
_1(this._loadTags);
_2(this._noTags);
return;
}
if(this.ajaxCall.HANDLE_AS=="json"){
this.tags=_9;
}else{
this.tags=this.feedConverter.parseFeed(_9);
}
this.updateView();
},checkIfRelated:function(){
if(this.selectedTags!=""&&this.selectedTags!="undefined"&&this.selectedTags!=null){
this._isRelated=true;
}else{
this._isRelated=false;
}
},updateView:function(){
this.prepareData();
this.checkIfRelated();
if(this._isRelated==true){
this._genSelectedTagsHtml();
if(!this.disableRelated){
this._genRelatedTagsHtml();
}
this._show();
}else{
this._genNormalTagsHtml();
this._show();
}
this._setFocus();
},prepareData:function(){
this._selectedTagsArr=[];
if(this.selectedTags!=null&&dojo.string.trim(this.selectedTags)!=""){
var _a=this.selectedTags.split(" ");
for(var i=0;i<_a.length;i++){
var _b=dojo.string.trim(_a[i]);
if(_b==""){
continue;
}
this._selectedTagsArr.push(_b);
}
}
this._selectedTagsArr=this._selectedTagsArr.sort();
this.selectedTags=this._selectedTagsArr.join(" ");
},_genRelatedTagsHtml:function(){
this.destroyRelatedHelpers();
this._relatedTags.innerHTML="";
this._showRelatedTags=false;
if(this.tags!=null){
var _c=this.tags.length;
for(var j=0;j<_c;j++){
var _d=this.tags[j];
if(this.existsInRelated(_d)){
continue;
}
var li=document.createElement("li");
dijit.setWaiRole(li,"presentation");
var a=document.createElement("a");
dijit.setWaiRole(a,"option");
a.href="javascript:;";
var _e=(_d.displayName)?_d.displayName:_d.name;
this.renderTag(a,_d);
var _f=document.createElement("span");
_f.className="lotusSymbol";
_f.innerHTML="+";
dojo.place(_f,a);
a=lconn.core.util.html.breakString(lconn.core.globalization.bidiUtil.enforceTextDirection(_e),document,a,10);
dojo.place(a,li);
dojo.place(document.createTextNode(this._dirCode+" "),li);
dojo.place(li,this._relatedTags);
this._showRelatedTags=true;
}
}
this.listHelper=new lconn.core.aria.Listbox(this._relatedTags);
},_genNormalTagsHtml:function(){
this.destroyNormalHelpers();
this._tagCloudTable.innerHTML="";
this._tagList.innerHTML="";
if(this.tags!=null){
var _10=lconn.core.CommonTags.TagTransform.getPopularTags(this.tags,50);
lconn.core.CommonTags.TagTransform.addIntensityBin(_10);
var _11=document.createElement("ul");
dijit.setWaiRole(_11,"listbox");
dojo.attr(_11,"aria-label",this.nls.rs_tagsLabel);
_11.style.listStyleType="disc";
_11.tabIndex="-1";
for(var i=0;i<_10.length;i++){
var tag=_10[i];
var li=document.createElement("li");
dijit.setWaiRole(li,"presentation");
var a=document.createElement("a");
a.href="javascript:;";
a.className="lotusF"+(tag.intensityBin||3);
var _12=(tag.displayName)?tag.displayName:tag.name;
this.renderTag(a,tag);
dijit.setWaiRole(a,"option");
a=lconn.core.util.html.breakString(lconn.core.globalization.bidiUtil.enforceTextDirection(_12),document,a,10);
dojo.place(a,li);
dojo.place(document.createTextNode(this._dirCode+" "),li);
dojo.place(li,_11);
}
dojo.place(_11,this._tagCloudTable);
this.cloudHelper=new lconn.core.aria.Listbox(_11);
var _13=lconn.core.CommonTags.TagTransform.getListTags(this.tags,this.tagListCount);
var _14=_13.length;
for(var j=0;j<_14;j++){
tag=_13[j];
var li=document.createElement("li");
dijit.setWaiRole(li,"presentation");
li.className="lotusAlignLeft";
var _15=document.createElement("span");
_15.className="lotusRight";
_15.innerHTML=tag.frequency;
li.appendChild(_15);
var a=document.createElement("a");
dijit.setWaiRole(a,"option");
dojo.addClass(a,"lotusLeft");
a.href="javascript:;";
var _12=(tag.displayName)?tag.displayName:tag.name;
this.renderTag(a,tag);
lconn.core.util.html.breakString(lconn.core.globalization.bidiUtil.enforceTextDirection(_12),document,a,10);
li.appendChild(a);
li.appendChild(document.createTextNode(this._dirCode+" "));
dojo.place(li,this._tagList);
}
this.listHelper=new lconn.core.aria.Listbox(this._tagList);
}
},renderTag:function(a,tag){
a.title=dojo.string.substitute(this.nls.rs_relatedTagTitle,[lconn.core.globalization.bidiUtil.enforceTextDirection(tag.displayName||tag.name),tag.frequency]);
this.connect(a,"click",dojo.hitch(this,"_addSelectedTagFromEvent",tag.name));
},existsInRelated:function(tag){
return (lconn.core.CommonTags.TagTransform.existsInRelatedTags(tag.name,this._selectedTagsArr));
},_genSelectedTagsHtml:function(){
var el=this._selectedTags;
el.innerHTML="";
for(var i=0;i<this._selectedTagsArr.length;i++){
var _16=this._selectedTagsArr[i];
var _17=_16;
var tag=this.findTag(_16);
if(tag){
_17=(tag.displayName)?tag.displayName:tag.name;
}
var li=document.createElement("li");
li.className="lotusAlignLeft";
dijit.setWaiRole(li,"presentation");
var _18=document.createElement("span");
dojo.addClass(_18,"lotusLeft");
lconn.core.util.html.breakString(lconn.core.globalization.bidiUtil.enforceTextDirection(_17),document,_18,10);
li.appendChild(_18);
var a=document.createElement("a");
a.href="javascript:;";
a.className="lotusDelete lotusRight";
a.title=dojo.string.substitute(this.nls.rs_removeTagTitle,[_17]);
this.connect(a,"click",dojo.hitch(this,"_removeSelectedTagFromEvent",_16));
dojo.attr(a,"role","option");
a.appendChild(document.createTextNode("\xa0"));
var img=document.createElement("img");
img.alt="";
img.src=this._blankGif;
dijit.setWaiRole(img,"presentation");
a.appendChild(img);
var _18=document.createElement("span");
_18.className="lotusAltText";
_18.appendChild(document.createTextNode("X"));
a.appendChild(_18);
li.appendChild(a);
el.appendChild(li);
}
this.selectedTagsListHelper=new lconn.core.aria.Listbox(el);
},findTag:function(_19){
if(_19&&this.tags){
var _1a=this.tags.length;
for(var i=0;i<_1a;i++){
var _1b=this.tags[i];
if(_1b.name===_19){
return _1b;
}
}
}
return null;
},_addSelectedTagFromEvent:function(tag,_1c){
try{
if(_1c){
dojo.stopEvent(_1c);
}
}
catch(e){
}
this._focusHint={related:true};
this._addSelectedTag(tag);
},_show:function(){
_1(this._loadTags);
if((this.tags==null||this.tags.length==0)&&(this.selectedTags==null||dojo.string.trim(this.selectedTags)=="")){
if(this.forRecentTags){
_2(this._tagSearchText);
}else{
_1(this._tagSearchText);
}
_2(this._noTags);
_1(this._hasTags);
_1(this._normalTagsSection);
}else{
_1(this._noTags);
_2(this._hasTags);
if(!this._openedSearchForm){
_1(this._tagSearchForm);
_2(this._tagSearchText);
}
if(this._isRelated==true){
_1(this._normalTagsSection);
_2(this._selectedTagsSection);
this._showSearchForm(null,true);
if(this._showRelatedTags&&!this.disableRelated){
_2(this._relatedTagsSection);
}else{
_1(this._relatedTagsSection);
}
}else{
_1(this._selectedTagsSection);
_1(this._relatedTagsSection);
_2(this._normalTagsSection);
if(this._viewType=="cloud"){
_1(this._tagListLink);
_1(this._tagListView);
_1(this._tagListAll);
_2(this._tagCloudLink);
_2(this._tagCloudView);
if(this.tagDialogEnabled){
_2(this._tagCloudAll);
}
}else{
_1(this._tagCloudLink);
_1(this._tagCloudAll);
_1(this._tagCloudView);
_2(this._tagListLink);
_2(this._tagListView);
if(this.tagDialogEnabled){
_2(this._tagListAll);
}
}
}
}
},_createTypeAhead:function(){
var _1d=dijit.byId(this.id+"commonTagsTypeAhead");
if(_1d!=null){
_1d.destroy();
}
this.tagStore=this.tagStore||new lconn.core.TypeAheadDataStore({url:this.typeAheadFeedUrl,queryParam:this.typeAheadTemplate},this.domNode);
var _1e={minChars:2,searchDelay:400,multipleValues:true,store:this.tagStore,token:" ","name":this.id+"commonTagsTypeAhead","id":this.id+"commonTagsTypeAhead"};
var _1f=new lconn.core.CommonTags.CommonTagsTypeAhead(_1e,this._typeAheadDom);
},_onKeyUp:function(evt){
lconn.core.globalization.bidiUtil.inputRTLProcessing(this._typeAheadDom);
},_toggleSubs:function(){
if(_3(this._tagMenu)){
new dojo.fx.Toggler({node:this._tagMenu,showDuration:500,showFunc:dojo.fx.wipeOut}).show();
this._toggleBar.className="lotusSprite lotusArrow lotusTwistyClosed";
}else{
new dojo.fx.Toggler({node:this._tagMenu,showDuration:500,showFunc:dojo.fx.wipeIn}).show();
this._toggleBar.className="lotusSprite lotusArrow lotusTwistyOpen";
}
},_showSearchForm:function(e,_20){
var el=dijit.byId(this.id+"commonTagsTypeAhead");
_1(this._tagSearchText);
_2(this._tagSearchForm);
if(el){
if(el.updateHintText){
el.updateHintText(_20?this.nls.rs_searchInputTagSelected:this.nls.rs_searchInputDefault);
}
if(e){
this._openedSearchForm=true;
dojo.stopEvent(e);
el.focus();
}
if(el.onSelect){
this.connect(el,"onSelect",dojo.hitch(this,"_searchTag",null));
}else{
if(el._doSelect){
this.connect(el,"_doSelect",dojo.hitch(this,"_searchTag",null));
}
}
}
},_popupHelp:function(_21){
dojo.stopEvent(_21);
var _22={tagWidget:this,event:_21};
dojo.publish("/tagWidget/help/show",[_22]);
},_showCloud:function(){
this._viewType="cloud";
this._show();
if(this.cloudHelper&&this.cloudHelper.focus){
this.cloudHelper.focus();
}else{
dijit.focus(this._showCloudSpan);
}
},_showList:function(){
this._viewType="list";
this._show();
if(this.listHelper&&this.listHelper.focus){
this.listHelper.focus();
}else{
dijit.focus(this._showListSpan);
}
},_loading:function(){
},_showAllTags:function(_23){
if(_23){
dojo.stopEvent(_23);
}
if(this._dialog==null){
var _24={ajaxCall:this.ajaxCall,feedConverter:this.feedConverter,tagWidget:this};
this._dialog=new lconn.core.CommonTags.TagDialog(_24);
}
this._dialog.show();
},_searchTag:function(_25,_26){
try{
if(_25){
dojo.stopEvent(_25);
}
}
catch(e){
}
if(_26){
if(typeof _26=="string"){
var tag=_26;
}else{
if(typeof _26.name=="string"){
var tag=_26.name;
}
}
}
if(this.tagsTypeaheadEnabled){
var _27=dijit.byId(this.id+"commonTagsTypeAhead");
if(!_27){
return;
}
var _28=_27.domNode;
if(!_28){
return;
}
if(!tag){
if(_28.hasInput==false){
return;
}
var tag=_28.value;
}
if(!tag){
return;
}
_28.value="";
}else{
var tag=this._typeAheadDom.value;
if(!tag){
return;
}
this._typeAheadDom.value="";
}
this._addSelectedTag(tag);
},_addSelectedTag:function(tag){
if(!tag){
return;
}
tag=tag.replace(new RegExp(" ","gm"),",");
var _29=tag.split(",");
var _2a=[];
if(this.multiSelected==true){
_2a=this._selectedTagsArr||[];
for(var p=0;p<_29.length;p++){
if(!_29[p]||lconn.core.CommonTags.TagTransform.existsInRelatedTags(_29[p],_2a)){
continue;
}
_2a.push(_29[p]);
}
}else{
for(var p=0;p<_29.length;p++){
if(!_29[p]){
continue;
}
_2a.push(_29[p]);
}
}
if(_2a.length>0){
this._selectedTagsArr=_2a;
this.selectedTags=this._selectedTagsArr.join(" ");
if(this.redirectWhenClickTag==false){
this.reload(false);
}else{
this.ajaxCall.redirect(this.selectedTags);
_4(this.id);
}
}else{
this.updateView();
}
},_removeSelectedTagFromEvent:function(tag,_2b){
try{
if(_2b){
dojo.stopEvent(_2b);
}
}
catch(e){
}
var _2c=this._selectedTagsArr||[];
this._focusHint={selected:dojo.indexOf(_2c,tag)};
this._removeSelectedTag(tag);
},_removeSelectedTag:function(tag){
var _2d=this._selectedTagsArr.length;
for(var i=0;i<_2d;i++){
if(tag==this._selectedTagsArr[i]){
this._selectedTagsArr.splice(i,1);
break;
}
}
this.selectedTags=this._selectedTagsArr.join(" ");
if(this.redirectWhenClickTag==false){
this.reload(false);
}else{
this.ajaxCall.redirect(this.selectedTags);
}
},_setFocus:function(){
if(this.redirectWhenClickTag||!this._focusHint){
return;
}
var _2e=this._focusHint;
this._focusHint=null;
var _2f=null;
if(_2e.related&&this._relatedTags){
_2f=dojo.query("a",this._relatedTags)[0];
}else{
if(_2e.selected>=0&&this._selectedTagsArr.length){
var _30=dojo.query("a",this._selectedTags);
_2f=_30[_2e.selected]||_30[_30.length-1];
}
}
if(!_2f&&_3(this._tagSearchForm)){
_2f=dojo.query("input",this._tagSearchForm)[0];
}
if(!_2f&&_3(this._tagSearchText)){
_2f=dojo.query("a",this._tagSearchText)[0];
}
if(_2f){
dijit.focus(_2f);
}
},setSelectedTags:function(_31){
if(_31!=null&&_31!="undefined"){
this._selectedTagsArr=_31;
this.selectedTags=this._selectedTagsArr.join(" ");
}
},setSingleTag:function(tag){
console.log("setting tag "+tag);
}});
dojo.declare("lconn.core.CommonTags._TagTransform",null,{getPopularTags:function(_32,_33){
if(_32==null||_32.length==0){
return [];
}
if(_32.length<=_33){
return _32.slice(0);
}
var _34=[];
for(var i=0;i<_32.length;i++){
_34.push(_32[i].frequency);
}
_34=_34.sort(function(a,b){
return a-b;
}).slice(_34.length-_33);
var _35=_34[0];
var _36=0;
while(_34[_36]==_35){
_36++;
}
var rtn=[];
var _37=0;
for(var i=0;i<_32.length;i++){
if(_32[i].frequency>_35){
rtn.push(_32[i]);
}else{
if(_32[i].frequency==_35&&_37<_36){
rtn.push(_32[i]);
_37++;
}
}
}
return rtn;
},getCloudTags:function(_38){
if(_38==null||_38.length==0){
return [];
}
var _39=this.sortByName(_38);
this.addIntensityBin(_39.tags);
return _39.tags;
},addIntensityBin:function(_3a){
if(_3a==null||_3a.length==0){
return [];
}
if(_3a[0].intensityBin){
return _3a;
}
var _3b=_3a.length;
var min=_3a[0].frequency;
var max=_3a[0].frequency;
for(var i=0;i<_3b;i++){
var _3c=_3a[i].frequency;
if(_3c<min){
min=_3c;
}
if(_3c>max){
max=_3c;
}
}
var _3d=0;
if(min!=max){
min=Math.log(1+min);
max=Math.log(1+max);
_3d=max-min;
}
var _3e=1;
var _3f=5;
for(var i=0;i<_3b;i++){
var tag=_3a[i];
if(_3d==0){
tag.intensityBin=Math.floor((_3f+_3e)/2);
}else{
tag.intensityBin=_3e+Math.floor((_3f-_3e)*((Math.log(1+tag.frequency)-min)/_3d));
}
}
return _3a;
},getListTags:function(_40,_41){
if(_40==null||_40.length==0){
return [];
}
if(_41){
var _42=this.getTopCounts(_40,_41);
}else{
var _42=this.getTopCounts(_40);
}
var _43=this.sortByName(_40).tags;
var _44=[];
for(var i=0;i<_42.length;i++){
for(var j=0;j<_43.length;j++){
if(_43[j].frequency==_42[i]){
if(this.existsInArray(_43[j],_44)==false){
_44.push(_43[j]);
break;
}
}
}
}
return _44;
},existsInArray:function(tag,_45){
return dojo.some(_45,function(_46){
return tag&&_46&&_46.name===tag.name;
});
},existsInRelatedTags:function(tag,_47){
return dojo.indexOf(_47,tag)!==-1;
},sortByName:function(_48){
var _49=[];
var _4a={};
var _4b={};
var _4c={};
var max=-1;
var min=-1;
var _4d=[];
if(_48&&_48.length){
for(var i=0;i<_48.length;i++){
_49.push(_48[i].name);
_4a[_48[i].name]=_48[i].id;
_4b[_48[i].name]=_48[i].frequency;
_4c[_48[i].name]=_48[i].displayName;
}
_49=_49.sort();
for(var i=0;i<_49.length;i++){
var _4e=_49[i];
var id=_4a[_49[i]];
var _4f=_4b[_49[i]];
var _50=_4c[_49[i]];
_4d[i]={id:id,name:_4e,displayName:_50,frequency:_4f};
if(max==-1){
max=_4f;
}
if(min==-1){
min=_4f;
}
max=Math.max(max,_4f);
min=Math.min(min,_4f);
}
}
return {tags:_4d,maxCount:max,minCount:min};
},getTopCounts:function(_51,_52){
var _53=[];
for(var i=0;i<_51.length;i++){
_53.push(_51[i].frequency);
}
_53=_53.sort(this.sortNumber).reverse();
if(_52!=null&&_52!="undefined"){
if(_52<=_53.length){
return _53.slice(0,_52);
}else{
return _53;
}
}else{
return _53.slice(0,10);
}
},sortNumber:function(a,b){
return a-b;
},breakString:function(s,d,el,_54){
if(!s){
return el;
}
_54=_54||10;
var b=new RegExp("[^\\s]{"+(_54+1)+"}","g");
var r;
var _55=0,end;
if(dojo.isIE||dojo.isSafari){
while(r=b.exec(s)){
end=--b.lastIndex;
el.appendChild(d.createTextNode(s.substring(_55,end)));
el.appendChild(d.createElement("wbr"));
_55=end;
}
}else{
while(r=b.exec(s)){
end=--b.lastIndex;
el.appendChild(d.createTextNode(s.substring(_55,end)+"\u200b"));
_55=end;
}
}
el.appendChild(d.createTextNode(s.substring(end)));
return el;
}});
lconn.core.CommonTags.TagTransform=new lconn.core.CommonTags._TagTransform();
})();
}


;if(!dojo._hasResource["lconn.core.HTMLUtil"]){
dojo._hasResource["lconn.core.HTMLUtil"]=true;
dojo.provide("lconn.core.HTMLUtil");
lconn.core.HTMLUtil.setInnerTextNode=function(el,_1){
el.innerHTML="";
el.appendChild(document.createTextNode(_1));
};
lconn.core.HTMLUtil.escapeInlineText=function(_2){
return lconn.core.HTMLUtil.escapeText(_2,true);
};
lconn.core.HTMLUtil.escapeText=function(_3,_4){
if(!_3||_3===""){
return "";
}
var _5=document.getElementById("escapeBufferDiv");
if(!_5){
var _6=document.createElement("div");
_6.id="escapeBufferDiv";
_6.style.display="none";
document.body.appendChild(_6);
_5=_6;
}
_5.appendChild(document.createTextNode(_3));
var _7=_5.innerHTML;
_5.innerHTML="";
if(_4){
_7=lconn.core.HTMLUtil.escape_q(_7);
}
return _7;
};
lconn.core.HTMLUtil.escape_q=function(_8){
if(!_8||_8===""){
return "";
}
var t="";
for(var i=0;i<_8.length;i++){
var c=_8.charAt(i);
if(c=="\""){
t+="&#34;";
}else{
if(c=="'"){
t+="&#39;";
}else{
if(c=="\\"){
t+="&#92;&#92;";
}else{
t+=c;
}
}
}
}
return t;
};
}


;if(!dojo._hasResource["lconn.core.HelpLauncher"]){
dojo._hasResource["lconn.core.HelpLauncher"]=true;
dojo.provide("lconn.core.HelpLauncher");






dojo.declare("lconn.core.HelpLauncher",lconn.core.widget.MenuLauncher,{openDelay:250,hideDelay:400,orient:{"TR":"TL","TL":"TR","BR":"BL","BL":"BR"},orientRTL:{"TL":"TR","TR":"TL","BL":"BR","BR":"BL"},_initMenu:function(){
this.menu=new lconn.core.HelpLauncher.ToolTip(dojo.mixin({id:this.menuId},this.optMenu));
},onOpen:function(){
this.inherited(arguments);
this.menu.containerNode.appendChild(document.createTextNode(""));
this.menu.domNode.parentNode.style.width=this.menu.width+22+"px";
dojo.attr(this.menu.containerNode,"aria-labelledby",this.menu.id+"_heading");
}});
dojo.declare("lconn.core.HelpLauncher.ToolTip",dijit.TooltipDialog,{heading:"",message:"",help:"",close:"",autofocus:false,width:200,maxWidth:400,"class":"lotusTooltipDialog",parseOnLoad:false,postMixInProperties:function(){
this.isLoaded=true;
this.title=this.help;
},buildRendering:function(){
var _1=this.strings;
var d=document;
var m=this.message;
var _2=this.heading;
var _3=this.close;
var h3,p;
var el=d.createElement("div");
el.className="lotusHelp";
m=(m)?m:"";
var _4=(typeof (m)==="string")?m:(m.textContent||m.innerText);
var _5=_4.length;
var w=Math.round(this.width+Math.min(Math.max(0,(_5-200)/125),1)*(this.maxWidth-this.width)+4);
el.style.width=w+"px";
this.width=w;
dojo.style(el,"border","0px");
var _6=d.createElement("div");
_6.className="lotusInfoBox";
dijit.setWaiRole(_6,"document");
dojo.attr(_6,"aria-labelledby",this.id+"_heading");
var _7=d.createElement("div");
_7.className="lotusRight";
var _8=this.closeLink=d.createElement("a");
_8.title=_3;
dijit.setWaiState(_8,"label",_3);
_8.className="lotusDelete";
_8.href="javascript:;";
this.connect(_8,"onclick","onCancel");
dijit.setWaiRole(_8,"button");
var _9=d.createElement("img");
_9.src=this._blankGif;
_9.setAttribute("alt","");
dijit.setWaiRole(_9,"presentation");
_8.appendChild(_9);
var _a=d.createElement("span");
_a.className="lotusAltText";
_a.appendChild(d.createTextNode("X"));
_8.appendChild(_a);
_7.appendChild(_8);
_6.appendChild(_7);
var _b=document.createElement("div");
_b.id=this.id+"_content";
_b.className="lotusHelpHeader";
dijit.setWaiState(_8,"describedBy",_b.id);
if(m){
if(_2){
h3=d.createElement("h3");
dijit.setWaiRole(h3,"heading");
dijit.setWaiState(h3,"level","1");
h3.id=this.id+"_heading";
h3.appendChild(d.createTextNode(_2));
_6.appendChild(h3);
}
if(typeof (m)==="string"){
p=d.createElement("p");
p.appendChild(d.createTextNode(m));
_b.appendChild(p);
}else{
_b.appendChild(m);
}
}
_6.appendChild(_b);
el.appendChild(_6);
this.content=el;
this.inherited(arguments);
},destroy:function(){
dijit.popup.close(this);
this.inherited(arguments);
},closeOnLinkClick:true,_attachTemplateNodes:function(){
this.inherited(arguments);
this.connect(this.domNode,"onmouseover","onMouseOver");
this.connect(this.domNode,"onmouseout","onMouseOut");
if(this.closeOnLinkClick){
this.connect(this.domNode,"onclick","onTooltipClick");
}
},onCancel:function(e){
if(e){
dojo.stopEvent(e);
}
this.inherited(arguments);
},onTooltipClick:function(e){
var el=e.target;
for(var i=0;el&&i<5;i++){
if(el.nodeName.toLowerCase()=="a"&&el!=this.closeLink){
this.onCancel();
return;
}else{
if(el==this.containerNode){
return;
}else{
el=el.parentNode;
}
}
}
}});
lconn.core.HelpLauncher.createHelpLink=function(a,_c,_d,_e,_f){
var d=document;
this.strings=_e||lconn.core.HelpLauncher.strings;
a=a||document.createElement("a");
_f=_f||false;
if(!_f){
if(a.childNodes.length>0){
while(a.firstChild){
a.removeChild(a.firstChild);
}
}
a.href="javascript:;";
dijit.setWaiRole(a,"button");
var img=d.createElement("IMG");
img.className=(lconn.core.locale.getLanguage()==="ar")?"lconnSprite lconnSprite-iconHelp16-ar":"lconnSprite lconnSprite-iconHelp16";
img.src=dijit._Widget.prototype._blankGif;
img.setAttribute("alt",this.strings.HELP);
a.appendChild(img);
var _10=d.createElement("span");
_10.className="lotusAltText";
_10.appendChild(d.createTextNode(lconn.core.locale.getLanguage()==="ar"?"\u061f":"?"));
a.appendChild(_10);
}
new lconn.core.HelpLauncher({optMenu:{heading:_c,message:_d,help:this.strings.HELP,close:this.strings.CLOSE}},a);
return a;
};
lconn.core.HelpLauncher.strings={HELP:"Help",CLOSE:"Close"};
}


;if(!dojo._hasResource["lconn.core.aria.Toolbar"]){
dojo._hasResource["lconn.core.aria.Toolbar"]=true;
dojo.provide("lconn.core.aria.Toolbar");


dojo.declare("lconn.core.aria.Toolbar",lconn.core.aria._Helper,{containerRole:"toolbar",itemRole:"button"});
}

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.oneui.ckeditor"]=true;

;if(!dojo._hasResource["com.ibm.oneui.ckeditor.editor.dojoconfig"]){
dojo._hasResource["com.ibm.oneui.ckeditor.editor.dojoconfig"]=true;
dojo.provide("com.ibm.oneui.ckeditor.editor.dojoconfig");
com.ibm.oneui.ckeditor.editor.dojoconfig.execCustomConfig=function(){
CKEDITOR.editorConfig=function(_1){
_1.plugins="a11yhelp,"+"basicstyles,"+"bidi,"+"blockquote,"+"clipboard,"+"colorbutton,"+"colordialog,"+"contextmenu,"+"dialogadvtab,"+"elementspath,"+"enterkey,"+"entities,"+"find,"+"flash,"+"floatingspace,"+"font,"+"format,"+"horizontalrule,"+"htmlwriter,"+"image,"+"iframe,"+"indentlist,"+"indentblock,"+"justify,"+"language,"+"link,"+"list,"+"liststyle,"+"magicline,"+"maximize,"+"newpage,"+"pagebreak,"+"pastefromword,"+"pastetext,"+"preview,"+"print,"+"removeformat,"+"save,"+"selectall,"+"showblocks,"+"showborders,"+"sourcearea,"+"specialchar,"+"stylescombo,"+"tab,"+"table,"+"tabletools,"+"templates,"+"toolbar,"+"undo,"+"wysiwygarea"+",tableresize,"+"ibmcustomdialogs,"+"ibmtoolbars,"+"ibmurllink,"+"ibmstatusmessage,"+"ibmbidi,"+"ibmpastenotesdatalink,"+"ibmpastevideo,"+"ibmpasteiframe,"+"ibmtabletools,"+"ibmimagedatauri,"+"ibmmenuhelpmessage,"+"ibmlanguagedropdown,"+"ibmcharactercounter,"+"ibmbinaryimagehandler,"+"ibmajax,"+"ibmpermanentpen,"+"ibmsametimeemoticons,"+"smiley";
_1.dialog_backgroundCoverColor="black";
_1.dialog_backgroundCoverOpacity=0.3;
_1.skin="ibmdesign";
_1.dialog_startupFocusTab=true;
_1.colorButton_enableMore=false;
_1.resize_enabled=false;
_1.toolbarCanCollapse=false;
_1.toolbar="Large";
_1.disableNativeSpellChecker=false;
_1.forceEnterMode=true;
_1.useComputedState=true;
_1.ignoreEmptyParagraph=false;
_1.ibmFilterPastedDataUriImage=true;
_1.magicline_color="blue";
_1.magicline_everywhere=false;
_1.removeDialogTabs="flash:advanced;image:advanced;";
_1.displayContextMenuHelpMessage=true;
_1.enableTableSort=true;
_1.ibmBinaryImageUploadUrl="";
_1.find_highlight={element:"span",styles:{"background-color":"#004","color":"#fff","border":"1px solid #004"}};
_1.pasteFromWordRemoveFontStyles=false;
_1.pasteFromWordRemoveStyles=false;
_1.copyFormatting_outerCursor=false;
_1.ibmPasteMediaLink={allowed_domains:["youtube.com","youtu.be","vimeo.com","dailymotion.com"]};
_1.ibmEnableSvgIcons=true;
_1.ibmAutoConvertUrls=true;
_1.ibmPermanentpenCookies=true;
_1.ibmModernTable={enable:true,enforceStyle:false};
_1.allowedContent=true;
_1.menus={link:{buttonClass:"cke_button_link",commands:["link","bookmark"],toolbar:"insert,30"},paste:{buttonClass:"cke_button_pastetext",groupName:"clipboard",commands:["paste","pastetext"],toolbar:"editing,0"}};
if(typeof gatekeeperConfig!="undefined"&&gatekeeperConfig["ckeditor-insert-media-widget"]){
_1.embed_provider=window.location.origin+"/connections/opengraph/form/anonymous/api/oembed?url={url}&extended=true";
_1.ibmDisableDraggableWidgets=true;
_1.ibmPasteMediaLink={allowed_domains:["youtube.com","youtu.be","vimeo.com","dailymotion.com"]};
_1.plugins+=",ibmwidgets,embed,embedbase,ibminsertmedia,ibmpastemedialink";
}
if(typeof gatekeeperConfig!="undefined"&&gatekeeperConfig["ckeditor-copy-formatting-plugin"]){
_1.plugins+=",copyformatting";
CKEDITOR.on("instanceReady",function(ev){
if(ev.editor.config.skin!=="ibmdesign"){
var _2=ev.sender.basePath+"plugins/copyformatting/styles/copyformatting-oneui.css";
ev.editor.document.appendStyleSheet(_2);
}
});
}
if(typeof gatekeeperConfig!="undefined"&&gatekeeperConfig["ckeditor-default-font"]){
_1.plugins+=",inlinefont";
_1.inlinefont_styles={$default:{"font-size":"12px",color:"#222","font-family":"Arial, Verdana, sans-serif"},ol:{"margin-right":"0px","padding":"0 40px"},li:{"margin-right":"0px","padding":"0 40px"},dl:{"margin-right":"0px","padding":"0 40px"}};
}
};
};
}


;define("dojo/i18n!dojo/cldr/nls/islamic", {"field-era":"Era","dateFormat-long":"MMMM d, y G","days-standAlone-wide":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","dateTimeFormat-full":"{1} \'at\' {0}","dateFormatItem-MMMd":"MMM d","dateTimeFormats-appendItem-Timezone":"{0} {1}","months-format-wide":["Muharram","Safar","Rabi\u02bb I","Rabi\u02bb II","Jumada I","Jumada II","Rajab","Sha\u02bbban","Ramadan","Shawwal","Dhu\u02bbl-Qi\u02bbdah","Dhu\u02bbl-Hijjah"],"field-second-relative+0":"now","dateFormatItem-MMMEd":"E, MMM d","dateFormat-full":"EEEE, MMMM d, y G","dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","dateTimeFormat-medium":"{1}, {0}","timeFormat-medium":"h:mm:ss a","dateFormatItem-EHms":"E HH:mm:ss","dateFormatItem-GyMMM":"MMM y G","field-minute":"Minute","field-day":"Day","dateTimeFormats-appendItem-Year":"{0} {1}","quarters-standAlone-abbr":["Q1","Q2","Q3","Q4"],"dayPeriods-format-narrow-noon":"n","eraNames":["AH"],"dateFormatItem-yyyyMMMEd":"E, MMM d, y G","dayPeriods-format-abbr-pm":"PM","dateFormatItem-Ehms":"E h:mm:ss a","dateTimeFormat-short":"{1}, {0}","dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}","days-format-wide":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"dateFormatItem-MEd":"E, M/d","dayPeriods-format-wide-pm":"PM","dayPeriods-format-abbr-noon":"noon","field-sun-relative+0":"this Sunday","field-sun-relative+1":"next Sunday","dayPeriods-format-abbr-am":"AM","field-sat-relative+-1":"last Saturday","timeFormat-short":"h:mm a","months-format-narrow":["1","2","3","4","5","6","7","8","9","10","11","12"],"dateFormatItem-Hms":"HH:mm:ss","field-zone":"Time Zone","field-thu-relative+-1":"last Thursday","dayPeriods-format-wide-am":"AM","field-second":"Second","field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","field-mon-relative+-1":"last Monday","dateFormatItem-Ed":"d E","dateFormatItem-Ehm":"E h:mm a","dateFormatItem-yyyyQQQQ":"QQQQ y G","dateFormatItem-yyyyMEd":"E, M/d/y GGGGG","dateFormatItem-hms":"h:mm:ss a","dateTimeFormats-appendItem-Era":"{0} {1}","quarters-format-abbr":["Q1","Q2","Q3","Q4"],"eraNarrow":["AH"],"dateFormatItem-EHm":"E HH:mm","field-hour":"Hour","days-format-short":["Su","Mo","Tu","We","Th","Fr","Sa"],"field-week-relative+-1":"last week","dateFormatItem-GyMMMd":"MMM d, y G","field-month-relative+-1":"last month","field-week":"Week","quarters-format-narrow":["1","2","3","4"],"dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","quarters-standAlone-wide":["Q1","Q2","Q3","Q4"],"dateFormatItem-yyyy":"y G","dateFormatItem-hm":"h:mm a","dateFormat-medium":"MMM d, y G","months-standAlone-abbr":["Muh.","Saf.","Rab. I","Rab. II","Jum. I","Jum. II","Raj.","Sha.","Ram.","Shaw.","Dhu\u02bbl-Q.","Dhu\u02bbl-H."],"dateFormatItem-Gy":"y G","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})","days-standAlone-narrow":["S","M","T","W","T","F","S"],"field-month-relative+0":"this month","field-month-relative+1":"next month","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","dateFormatItem-Hm":"HH:mm","dayPeriods-format-wide-noon":"noon","dateFormatItem-yyyyQQQ":"QQQ y G","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","field-year":"Year","field-thu-relative+0":"this Thursday","field-thu-relative+1":"next Thursday","field-day-relative+0":"today","field-day-relative+1":"tomorrow","field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","field-day-relative+-1":"yesterday","field-fri-relative+-1":"last Friday","field-dayperiod":"AM/PM","field-weekday":"Day of the Week","dateFormatItem-MMM":"LLL","quarters-format-wide":["1st quarter","2nd quarter","3rd quarter","4th quarter"],"days-standAlone-abbr":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dateFormatItem-yyyyMd":"M/d/y GGGGG","months-format-abbr":["Muh.","Saf.","Rab. I","Rab. II","Jum. I","Jum. II","Raj.","Sha.","Ram.","Shaw.","Dhu\u02bbl-Q.","Dhu\u02bbl-H."],"dateFormatItem-GyMMMEd":"E, MMM d, y G","timeFormat-long":"h:mm:ss a z","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","days-standAlone-short":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"timeFormat-full":"h:mm:ss a zzzz","dateFormatItem-yyyyMMM":"MMM y G","dateFormatItem-ms":"mm:ss","months-standAlone-wide":["Muharram","Safar","Rabi\u02bb I","Rabi\u02bb II","Jumada I","Jumada II","Rajab","Sha\u02bbban","Ramadan","Shawwal","Dhu\u02bbl-Qi\u02bbdah","Dhu\u02bbl-Hijjah"],"eraAbbr":["AH"],"field-year-relative+-1":"last year","field-tue-relative+-1":"last Tuesday","months-standAlone-narrow":["1","2","3","4","5","6","7","8","9","10","11","12"],"dateFormatItem-Md":"M/d","dayPeriods-format-narrow-pm":"p","dateFormatItem-H":"HH","dateFormatItem-M":"L","field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday","dateFormatItem-yyyyMMMd":"MMM d, y G","field-tue-relative+0":"this Tuesday","field-tue-relative+1":"next Tuesday","dateFormatItem-d":"d","days-format-abbr":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dateFormatItem-h":"h a","field-week-relative+0":"this week","field-week-relative+1":"next week","dayPeriods-format-narrow-am":"a","dateFormatItem-y":"y G","field-month":"Month","field-year-relative+0":"this year","field-sun-relative+-1":"last Sunday","field-year-relative+1":"next year","dateFormat-short":"M/d/y GGGGG","dateTimeFormat-long":"{1} \'at\' {0}","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","dateFormatItem-yyyyM":"M/y GGGGG","field-wed-relative+-1":"last Wednesday","days-format-narrow":["S","M","T","W","T","F","S"],"quarters-standAlone-narrow":["1","2","3","4"]});

;define("dojox/date/islamic/locale",["../..","dojo/_base/lang","dojo/_base/array","dojo/date","dojo/i18n","dojo/regexp","dojo/string","./Date","dojo/i18n!dojo/cldr/nls/islamic"],function(_1,_2,_3,dd,_4,_5,_6,_7,_8){
var _9=_2.getObject("date.islamic.locale",true,_1);
function _a(_b,_c,_d,_e,_f){
return _f.replace(/([a-z])\1*/ig,function(_10){
var s,pad;
var c=_10.charAt(0);
var l=_10.length;
var _11=["abbr","wide","narrow"];
switch(c){
case "G":
s=_c["eraAbbr"][0];
break;
case "y":
s=String(_b.getFullYear());
break;
case "M":
var m=_b.getMonth();
if(l<3){
s=m+1;
pad=true;
}else{
var _12=["months","format",_11[l-3]].join("-");
s=_c[_12][m];
}
break;
case "d":
s=_b.getDate(true);
pad=true;
break;
case "E":
var d=_b.getDay();
if(l<3){
s=d+1;
pad=true;
}else{
var _13=["days","format",_11[l-3]].join("-");
s=_c[_13][d];
}
break;
case "a":
var _14=(_b.getHours()<12)?"am":"pm";
s=_c["dayPeriods-format-wide-"+_14];
break;
case "h":
case "H":
case "K":
case "k":
var h=_b.getHours();
switch(c){
case "h":
s=(h%12)||12;
break;
case "H":
s=h;
break;
case "K":
s=(h%12);
break;
case "k":
s=h||24;
break;
}
pad=true;
break;
case "m":
s=_b.getMinutes();
pad=true;
break;
case "s":
s=_b.getSeconds();
pad=true;
break;
case "S":
s=Math.round(_b.getMilliseconds()*Math.pow(10,l-3));
pad=true;
break;
case "z":
s=dd.getTimezoneName(_b.toGregorian());
if(s){
break;
}
l=4;
case "Z":
var _15=_b.toGregorian().getTimezoneOffset();
var tz=[(_15<=0?"+":"-"),_6.pad(Math.floor(Math.abs(_15)/60),2),_6.pad(Math.abs(_15)%60,2)];
if(l==4){
tz.splice(0,0,"GMT");
tz.splice(3,0,":");
}
s=tz.join("");
break;
default:
throw new Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+_f);
}
if(pad){
s=_6.pad(s,l);
}
return s;
});
};
_9.format=function(_16,_17){
_17=_17||{};
var _18=_4.normalizeLocale(_17.locale);
var _19=_17.formatLength||"short";
var _1a=_9._getIslamicBundle(_18);
var str=[];
var _1b=_2.hitch(this,_a,_16,_1a,_18,_17.fullYear);
if(_17.selector=="year"){
var _1c=_16.getFullYear();
return _1c;
}
if(_17.selector!="time"){
var _1d=_17.datePattern||_1a["dateFormat-"+_19];
if(_1d){
str.push(_1e(_1d,_1b));
}
}
if(_17.selector!="date"){
var _1f=_17.timePattern||_1a["timeFormat-"+_19];
if(_1f){
str.push(_1e(_1f,_1b));
}
}
var _20=str.join(" ");
return _20;
};
_9.regexp=function(_21){
return _9._parseInfo(_21).regexp;
};
_9._parseInfo=function(_22){
_22=_22||{};
var _23=_4.normalizeLocale(_22.locale);
var _24=_9._getIslamicBundle(_23);
var _25=_22.formatLength||"short";
var _26=_22.datePattern||_24["dateFormat-"+_25];
var _27=_22.timePattern||_24["timeFormat-"+_25];
var _28;
if(_22.selector=="date"){
_28=_26;
}else{
if(_22.selector=="time"){
_28=_27;
}else{
_28=(typeof (_27)=="undefined")?_26:_26+" "+_27;
}
}
var _29=[];
var re=_1e(_28,_2.hitch(this,_2a,_29,_24,_22));
return {regexp:re,tokens:_29,bundle:_24};
};
_9.parse=function(_2b,_2c){
_2b=_2b.replace(/[\u200E\u200F\u202A\u202E]/g,"");
if(!_2c){
_2c={};
}
var _2d=_9._parseInfo(_2c);
var _2e=_2d.tokens,_8=_2d.bundle;
var _2f=_2d.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,"");
var re=new RegExp("^"+_2f+"$");
var _30=re.exec(_2b);
var _31=_4.normalizeLocale(_2c.locale);
if(!_30){
return null;
}
var _32,_33;
var _34=[1389,0,1,0,0,0,0];
var _35="";
var _36=0;
var _37=["abbr","wide","narrow"];
var _38=_3.every(_30,function(v,i){
if(!i){
return true;
}
var _39=_2e[i-1];
var l=_39.length;
switch(_39.charAt(0)){
case "y":
_34[0]=Number(v);
break;
case "M":
if(l>2){
var _3a=_8["months-format-"+_37[l-3]].concat();
if(!_2c.strict){
v=v.replace(".","").toLowerCase();
_3a=_3.map(_3a,function(s){
return s?s.replace(".","").toLowerCase():s;
});
}
v=_3.indexOf(_3a,v);
if(v==-1){
return false;
}
_36=l;
}else{
v--;
}
_34[1]=Number(v);
break;
case "D":
_34[1]=0;
case "d":
_34[2]=Number(v);
break;
case "a":
var am=_2c.am||_8["dayPeriods-format-wide-am"],pm=_2c.pm||_8["dayPeriods-format-wide-pm"];
if(!_2c.strict){
var _3b=/\./g;
v=v.replace(_3b,"").toLowerCase();
am=am.replace(_3b,"").toLowerCase();
pm=pm.replace(_3b,"").toLowerCase();
}
if(_2c.strict&&v!=am&&v!=pm){
return false;
}
_35=(v==pm)?"p":(v==am)?"a":"";
break;
case "K":
if(v==24){
v=0;
}
case "h":
case "H":
case "k":
_34[3]=Number(v);
break;
case "m":
_34[4]=Number(v);
break;
case "s":
_34[5]=Number(v);
break;
case "S":
_34[6]=Number(v);
}
return true;
});
var _3c=+_34[3];
if(_35==="p"&&_3c<12){
_34[3]=_3c+12;
}else{
if(_35==="a"&&_3c==12){
_34[3]=0;
}
}
var _3d=new _7(_34[0],_34[1],_34[2],_34[3],_34[4],_34[5],_34[6]);
return _3d;
};
function _1e(_3e,_3f,_40,_41){
var _42=function(x){
return x;
};
_3f=_3f||_42;
_40=_40||_42;
_41=_41||_42;
var _43=_3e.match(/(''|[^'])+/g);
var _44=_3e.charAt(0)=="'";
_3.forEach(_43,function(_45,i){
if(!_45){
_43[i]="";
}else{
_43[i]=(_44?_40:_3f)(_45);
_44=!_44;
}
});
return _41(_43.join(""));
};
function _2a(_46,_47,_48,_49){
_49=_5.escapeString(_49);
var _4a=_4.normalizeLocale(_48.locale);
return _49.replace(/([a-z])\1*/ig,function(_4b){
var s;
var c=_4b.charAt(0);
var l=_4b.length;
var p2="",p3="";
if(_48.strict){
if(l>1){
p2="0"+"{"+(l-1)+"}";
}
if(l>2){
p3="0"+"{"+(l-2)+"}";
}
}else{
p2="0?";
p3="0{0,2}";
}
switch(c){
case "y":
s="\\d+";
break;
case "M":
s=(l>2)?"\\S+ ?\\S+":p2+"[1-9]|1[0-2]";
break;
case "d":
s="[12]\\d|"+p2+"[1-9]|3[01]";
break;
case "E":
s="\\S+";
break;
case "h":
s=p2+"[1-9]|1[0-2]";
break;
case "k":
s=p2+"\\d|1[01]";
break;
case "H":
s=p2+"\\d|1\\d|2[0-3]";
break;
case "K":
s=p2+"[1-9]|1\\d|2[0-4]";
break;
case "m":
case "s":
s=p2+"\\d|[0-5]\\d";
break;
case "S":
s="\\d{"+l+"}";
break;
case "a":
var am=_48.am||_47["dayPeriods-format-wide-am"],pm=_48.pm||_47["dayPeriods-format-wide-pm"];
if(_48.strict){
s=am+"|"+pm;
}else{
s=am+"|"+pm;
if(am!=am.toLowerCase()){
s+="|"+am.toLowerCase();
}
if(pm!=pm.toLowerCase()){
s+="|"+pm.toLowerCase();
}
}
break;
default:
s=".*";
}
if(_46){
_46.push(_4b);
}
return "("+s+")";
}).replace(/[\xa0 ]/g,"[\\s\\xa0]");
};
var _4c=[];
_9.addCustomFormats=function(_4d,_4e){
_4c.push({pkg:_4d,name:_4e});
};
_9._getIslamicBundle=function(_4f){
var _50={};
_3.forEach(_4c,function(_51){
var _52=_4.getLocalization(_51.pkg,_51.name,_4f);
_50=_2.mixin(_50,_52);
},this);
return _50;
};
_9.addCustomFormats("dojo.cldr","islamic");
_9.getNames=function(_53,_54,_55,_56,_57){
var _58;
var _59=_9._getIslamicBundle(_56);
var _5a=[_53,_55,_54];
if(_55=="standAlone"){
var key=_5a.join("-");
_58=_59[key];
if(_58[0]==1){
_58=undefined;
}
}
_5a[1]="format";
return (_58||_59[_5a.join("-")]).concat();
};
_9.weekDays=_9.getNames("days","wide","format");
_9.months=_9.getNames("months","wide","format");
return _9;
});


;define("dojo/i18n!dojo/cldr/nls/hebrew", {"field-era":"Era","dateFormat-long":"MMMM d, y G","days-standAlone-wide":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","dateTimeFormat-full":"{1} \'at\' {0}","dateFormatItem-MMMd":"MMM d","dateTimeFormats-appendItem-Timezone":"{0} {1}","months-format-wide":["Tishri","Heshvan","Kislev","Tevet","Shevat","Adar I","Adar","Nisan","Iyar","Sivan","Tamuz","Av","Elul"],"months-standAlone-wide-leap":"Adar II","field-second-relative+0":"now","dateFormatItem-MMMEd":"E, MMM d","dateFormat-full":"EEEE, MMMM d, y G","dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","dateTimeFormat-medium":"{1}, {0}","timeFormat-medium":"h:mm:ss a","dateFormatItem-EHms":"E HH:mm:ss","dateFormatItem-GyMMM":"MMM y G","field-minute":"Minute","field-day":"Day","dateTimeFormats-appendItem-Year":"{0} {1}","quarters-standAlone-abbr":["Q1","Q2","Q3","Q4"],"dayPeriods-format-narrow-noon":"n","eraNames":["AM"],"dateFormatItem-yyyyMMMEd":"E, MMM d, y G","dayPeriods-format-abbr-pm":"PM","dateFormatItem-Ehms":"E h:mm:ss a","dateTimeFormat-short":"{1}, {0}","dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}","months-format-wide-leap":"Adar II","days-format-wide":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"dateFormatItem-MEd":"E, M/d","dayPeriods-format-wide-pm":"PM","dayPeriods-format-abbr-noon":"noon","field-sun-relative+0":"this Sunday","field-sun-relative+1":"next Sunday","dayPeriods-format-abbr-am":"AM","field-sat-relative+-1":"last Saturday","timeFormat-short":"h:mm a","months-format-narrow":["1","2","3","4","5","6","7","8","9","10","11","12","13"],"dateFormatItem-Hms":"HH:mm:ss","field-zone":"Time Zone","field-thu-relative+-1":"last Thursday","dayPeriods-format-wide-am":"AM","field-second":"Second","field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","field-mon-relative+-1":"last Monday","dateFormatItem-Ed":"d E","dateFormatItem-Ehm":"E h:mm a","dateFormatItem-yyyyQQQQ":"QQQQ y G","dateFormatItem-yyyyMEd":"E, M/d/y GGGGG","dateFormatItem-hms":"h:mm:ss a","dateTimeFormats-appendItem-Era":"{0} {1}","quarters-format-abbr":["Q1","Q2","Q3","Q4"],"eraNarrow":["AM"],"dateFormatItem-EHm":"E HH:mm","field-hour":"Hour","days-format-short":["Su","Mo","Tu","We","Th","Fr","Sa"],"field-week-relative+-1":"last week","dateFormatItem-GyMMMd":"MMM d, y G","months-format-narrow-leap":"7","field-month-relative+-1":"last month","field-week":"Week","quarters-format-narrow":["1","2","3","4"],"dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","quarters-standAlone-wide":["Q1","Q2","Q3","Q4"],"dateFormatItem-yyyy":"y G","dateFormatItem-hm":"h:mm a","dateFormat-medium":"MMM d, y G","months-standAlone-abbr":["Tishri","Heshvan","Kislev","Tevet","Shevat","Adar I","Adar","Nisan","Iyar","Sivan","Tamuz","Av","Elul"],"dateFormatItem-Gy":"y G","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})","months-standAlone-narrow-leap":"7","days-standAlone-narrow":["S","M","T","W","T","F","S"],"field-month-relative+0":"this month","field-month-relative+1":"next month","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","dateFormatItem-Hm":"HH:mm","dayPeriods-format-wide-noon":"noon","dateFormatItem-yyyyQQQ":"QQQ y G","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","field-year":"Year","field-thu-relative+0":"this Thursday","field-thu-relative+1":"next Thursday","field-day-relative+0":"today","field-day-relative+1":"tomorrow","field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","field-day-relative+-1":"yesterday","field-fri-relative+-1":"last Friday","field-dayperiod":"AM/PM","field-weekday":"Day of the Week","dateFormatItem-MMM":"LLL","quarters-format-wide":["1st quarter","2nd quarter","3rd quarter","4th quarter"],"days-standAlone-abbr":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dateFormatItem-yyyyMd":"M/d/y GGGGG","months-format-abbr":["Tishri","Heshvan","Kislev","Tevet","Shevat","Adar I","Adar","Nisan","Iyar","Sivan","Tamuz","Av","Elul"],"months-standAlone-abbr-leap":"Adar II","dateFormatItem-GyMMMEd":"E, MMM d, y G","timeFormat-long":"h:mm:ss a z","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","days-standAlone-short":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"timeFormat-full":"h:mm:ss a zzzz","dateFormatItem-yyyyMMM":"MMM y G","dateFormatItem-ms":"mm:ss","months-standAlone-wide":["Tishri","Heshvan","Kislev","Tevet","Shevat","Adar I","Adar","Nisan","Iyar","Sivan","Tamuz","Av","Elul"],"eraAbbr":["AM"],"field-year-relative+-1":"last year","field-tue-relative+-1":"last Tuesday","months-standAlone-narrow":["1","2","3","4","5","6","7","8","9","10","11","12","13"],"dateFormatItem-Md":"M/d","dayPeriods-format-narrow-pm":"p","dateFormatItem-H":"HH","dateFormatItem-M":"L","field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday","months-format-abbr-leap":"Adar II","dateFormatItem-yyyyMMMd":"MMM d, y G","field-tue-relative+0":"this Tuesday","field-tue-relative+1":"next Tuesday","dateFormatItem-d":"d","days-format-abbr":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dateFormatItem-h":"h a","field-week-relative+0":"this week","field-week-relative+1":"next week","dayPeriods-format-narrow-am":"a","dateFormatItem-y":"y G","field-month":"Month","field-year-relative+0":"this year","field-sun-relative+-1":"last Sunday","field-year-relative+1":"next year","dateFormat-short":"M/d/y GGGGG","dateTimeFormat-long":"{1} \'at\' {0}","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","dateFormatItem-yyyyM":"M/y GGGGG","field-wed-relative+-1":"last Wednesday","days-format-narrow":["S","M","T","W","T","F","S"],"quarters-standAlone-narrow":["1","2","3","4"]});

;define("dojox/date/hebrew/locale",["../..","dojo/_base/lang","dojo/_base/array","dojo/date","dojo/i18n","dojo/regexp","dojo/string","./Date","./numerals","dojo/i18n!dojo/cldr/nls/hebrew"],function(_1,_2,_3,dd,_4,_5,_6,_7,_8){
var _9=_2.getObject("date.hebrew.locale",true,_1);
_4.getLocalization("dojo.cldr","hebrew");
function _a(_b,_c,_d,_e,_f){
return _f.replace(/([a-z])\1*/ig,function(_10){
var s,pad;
var c=_10.charAt(0);
var l=_10.length;
var _11=["abbr","wide","narrow"];
switch(c){
case "G":
s=_c[(l<4)?"eraAbbr":"eraNames"][0];
break;
case "y":
if(_d.match(/^he(?:-.+)?$/)){
s=_8.getYearHebrewLetters(_b.getFullYear());
}else{
s=String(_b.getFullYear());
}
break;
case "M":
var m=_b.getMonth();
if(l<3){
if(!_b.isLeapYear(_b.getFullYear())&&m>5){
m--;
}
if(_d.match(/^he(?:-.+)?$/)){
s=_8.getMonthHebrewLetters(m);
}else{
s=m+1;
pad=true;
}
}else{
var _12=_9.getNames("months",_11[l-3],"format",_d,_b);
s=_12[m];
}
break;
case "d":
if(_d.match(/^he(?:-.+)?$/)){
s=_b.getDateLocalized(_d);
}else{
s=_b.getDate();
pad=true;
}
break;
case "E":
var d=_b.getDay();
if(l<3){
s=d+1;
pad=true;
}else{
var _13=["days","format",_11[l-3]].join("-");
s=_c[_13][d];
}
break;
case "a":
var _14=(_b.getHours()<12)?"am":"pm";
s=_c["dayPeriods-format-wide-"+_14];
break;
case "h":
case "H":
case "K":
case "k":
var h=_b.getHours();
switch(c){
case "h":
s=(h%12)||12;
break;
case "H":
s=h;
break;
case "K":
s=(h%12);
break;
case "k":
s=h||24;
break;
}
pad=true;
break;
case "m":
s=_b.getMinutes();
pad=true;
break;
case "s":
s=_b.getSeconds();
pad=true;
break;
case "S":
s=Math.round(_b.getMilliseconds()*Math.pow(10,l-3));
pad=true;
break;
case "z":
s="";
break;
default:
throw new Error("dojox.date.hebrew.locale.formatPattern: invalid pattern char: "+_f);
}
if(pad){
s=_6.pad(s,l);
}
return s;
});
};
_9.format=function(_15,_16){
_16=_16||{};
var _17=_4.normalizeLocale(_16.locale);
var _18=_16.formatLength||"short";
var _19=_9._getHebrewBundle(_17);
var str=[];
var _1a=_2.hitch(this,_a,_15,_19,_17,_16.fullYear);
if(_16.selector=="year"){
var _1b=_15.getFullYear();
return _17.match(/^he(?:-.+)?$/)?_8.getYearHebrewLetters(_1b):_1b;
}
if(_16.selector!="time"){
var _1c=_16.datePattern||_19["dateFormat-"+_18];
if(_1c){
str.push(_1d(_1c,_1a));
}
}
if(_16.selector!="date"){
var _1e=_16.timePattern||_19["timeFormat-"+_18];
if(_1e){
str.push(_1d(_1e,_1a));
}
}
var _1f=str.join(" ");
return _1f;
};
_9.regexp=function(_20){
return _9._parseInfo(_20).regexp;
};
_9._parseInfo=function(_21){
_21=_21||{};
var _22=_4.normalizeLocale(_21.locale);
var _23=_9._getHebrewBundle(_22);
var _24=_21.formatLength||"short";
var _25=_21.datePattern||_23["dateFormat-"+_24];
var _26=_21.timePattern||_23["timeFormat-"+_24];
var _27;
if(_21.selector=="date"){
_27=_25;
}else{
if(_21.selector=="time"){
_27=_26;
}else{
_27=(_26===undefined)?_25:_25+" "+_26;
}
}
var _28=[];
var re=_1d(_27,_2.hitch(this,_29,_28,_23,_21));
return {regexp:re,tokens:_28,bundle:_23};
};
_9.parse=function(_2a,_2b){
_2a=_2a.replace(/[\u200E\u200F\u202A-\u202E]/g,"");
if(!_2b){
_2b={};
}
var _2c=_9._parseInfo(_2b);
var _2d=_2c.tokens,_2e=_2c.bundle;
var re=new RegExp("^"+_2c.regexp+"$");
var _2f=re.exec(_2a);
var _30=_4.normalizeLocale(_2b.locale);
if(!_2f){
return null;
}
var _31,_32;
var _33=[5730,3,23,0,0,0,0];
var _34="";
var _35=0;
var _36=["abbr","wide","narrow"];
var _37=_3.every(_2f,function(v,i){
if(!i){
return true;
}
var _38=_2d[i-1];
var l=_38.length;
switch(_38.charAt(0)){
case "y":
if(_30.match(/^he(?:-.+)?$/)){
_33[0]=_8.parseYearHebrewLetters(v);
}else{
_33[0]=Number(v);
}
break;
case "M":
if(l>2){
var _39=_9.getNames("months",_36[l-3],"format",_30,new _7(5769,1,1)),_3a=_9.getNames("months",_36[l-3],"format",_30,new _7(5768,1,1));
if(!_2b.strict){
v=v.replace(".","").toLowerCase();
_39=_3.map(_39,function(s){
return s?s.replace(".","").toLowerCase():s;
});
_3a=_3.map(_3a,function(s){
return s?s.replace(".","").toLowerCase():s;
});
}
var _3b=v;
v=_3.indexOf(_39,_3b);
if(v==-1){
v=_3.indexOf(_3a,_3b);
if(v==-1){
return false;
}
}
_35=l;
}else{
if(_30.match(/^he(?:-.+)?$/)){
v=_8.parseMonthHebrewLetters(v);
}else{
v--;
}
}
_33[1]=Number(v);
break;
case "D":
_33[1]=0;
case "d":
if(_30.match(/^he(?:-.+)?$/)){
_33[2]=_8.parseDayHebrewLetters(v);
}else{
_33[2]=Number(v);
}
break;
case "a":
var am=_2b.am||_2e["dayPeriods-format-wide-am"],pm=_2b.pm||_2e["dayPeriods-format-wide-pm"];
if(!_2b.strict){
var _3c=/\./g;
v=v.replace(_3c,"").toLowerCase();
am=am.replace(_3c,"").toLowerCase();
pm=pm.replace(_3c,"").toLowerCase();
}
if(_2b.strict&&v!=am&&v!=pm){
return false;
}
_34=(v==pm)?"p":(v==am)?"a":"";
break;
case "K":
if(v==24){
v=0;
}
case "h":
case "H":
case "k":
_33[3]=Number(v);
break;
case "m":
_33[4]=Number(v);
break;
case "s":
_33[5]=Number(v);
break;
case "S":
_33[6]=Number(v);
}
return true;
});
var _3d=+_33[3];
if(_34==="p"&&_3d<12){
_33[3]=_3d+12;
}else{
if(_34==="a"&&_3d==12){
_33[3]=0;
}
}
var _3e=new _7(_33[0],_33[1],_33[2],_33[3],_33[4],_33[5],_33[6]);
if(_35<3&&_33[1]>=5&&!_3e.isLeapYear(_3e.getFullYear())){
_3e.setMonth(_33[1]+1);
}
return _3e;
};
function _1d(_3f,_40,_41,_42){
var _43=function(x){
return x;
};
_40=_40||_43;
_41=_41||_43;
_42=_42||_43;
var _44=_3f.match(/(''|[^'])+/g);
var _45=_3f.charAt(0)=="'";
_3.forEach(_44,function(_46,i){
if(!_46){
_44[i]="";
}else{
_44[i]=(_45?_41:_40)(_46);
_45=!_45;
}
});
return _42(_44.join(""));
};
function _29(_47,_48,_49,_4a){
_4a=_5.escapeString(_4a);
var _4b=_4.normalizeLocale(_49.locale);
return _4a.replace(/([a-z])\1*/ig,function(_4c){
var s;
var c=_4c.charAt(0);
var l=_4c.length;
var p2="",p3="";
if(_49.strict){
if(l>1){
p2="0"+"{"+(l-1)+"}";
}
if(l>2){
p3="0"+"{"+(l-2)+"}";
}
}else{
p2="0?";
p3="0{0,2}";
}
switch(c){
case "y":
s="\\S+";
break;
case "M":
if(_4b.match("^he(?:-.+)?$")){
s=(l>2)?"\\S+ ?\\S+":"\\S{1,4}";
}else{
s=(l>2)?"\\S+ ?\\S+":p2+"[1-9]|1[0-3]";
}
break;
case "d":
if(_4b.match("^he(?:-.+)?$")){
s="\\S['\"'\u05f3]{1,2}\\S?";
}else{
s="[12]\\d|"+p2+"[1-9]|30";
}
break;
case "E":
if(_4b.match("^he(?:-.+)?$")){
s=(l>3)?"\\S+ ?\\S+":"\\S";
}else{
s="\\S+";
}
break;
case "h":
s=p2+"[1-9]|1[0-2]";
break;
case "k":
s=p2+"\\d|1[01]";
break;
case "H":
s=p2+"\\d|1\\d|2[0-3]";
break;
case "K":
s=p2+"[1-9]|1\\d|2[0-4]";
break;
case "m":
case "s":
s=p2+"\\d|[0-5]\\d";
break;
case "S":
s="\\d{"+l+"}";
break;
case "a":
var am=_49.am||_48["dayPeriods-format-wide-am"],pm=_49.pm||_48["dayPeriods-format-wide-pm"];
if(_49.strict){
s=am+"|"+pm;
}else{
s=am+"|"+pm;
if(am!=am.toLowerCase()){
s+="|"+am.toLowerCase();
}
if(pm!=pm.toLowerCase()){
s+="|"+pm.toLowerCase();
}
}
break;
default:
s=".*";
}
if(_47){
_47.push(_4c);
}
return "("+s+")";
}).replace(/[\xa0 ]/g,"[\\s\\xa0]");
};
var _4d=[];
_9.addCustomFormats=function(_4e,_4f){
_4d.push({pkg:_4e,name:_4f});
};
_9._getHebrewBundle=function(_50){
var _51={};
_3.forEach(_4d,function(_52){
var _53=_4.getLocalization(_52.pkg,_52.name,_50);
_51=_2.mixin(_51,_53);
},this);
return _51;
};
_9.addCustomFormats("dojo.cldr","hebrew");
_9.getNames=function(_54,_55,_56,_57,_58){
var _59,_5a=_9._getHebrewBundle(_57),_5b=[_54,_56,_55];
if(_56=="standAlone"){
var key=_5b.join("-");
_59=_5a[key];
if(_59[0]==1){
_59=undefined;
}
}
_5b[1]="format";
var _5c=(_59||_5a[_5b.join("-")]).concat();
if(_54=="months"){
if(_58.isLeapYear(_58.getFullYear())){
_5b.push("leap");
_5c[6]=_5a[_5b.join("-")];
}else{
delete _5c[5];
}
}
return _5c;
};
return _9;
});


;if(!dojo._hasResource["lconn.core.globalization.BidiDateUtil"]){
dojo._hasResource["lconn.core.globalization.BidiDateUtil"]=true;
(function(){
dojo.provide("lconn.core.globalization.BidiDateUtil");
















var lg=lconn.core.globalization,_1=lg.api,_2=lg.config.CALENDAR;
function _3(){
return _1.getCalendar();
};
lconn.core.globalization.BidiDateUtil={isHijri:function(){
return _3()==_2.HIJRI;
},isHebrew:function(){
return _3()==_2.HEBREW;
},isGregorian:function(){
return _3()==_2.GREGORIAN;
},getDateComponent:function(_4,_5,_6){
var di=dojox.date.islamic,il=di.locale,dh=dojox.date.hebrew,hl=dh.locale,dg=dojo.date,gl=dg.locale;
if(this.isHijri()){
return il.getNames(_4,_5);
}else{
if(this.isHebrew()){
return hl.getNames(_4,_5,null,null,_6||this.fromGregorian());
}
}
return gl.getNames(_4,_5);
},fromGregorian:function(d){
var di=dojox.date.islamic,dh=dojox.date.hebrew,hl=dh.locale;
d=typeof d!=="undefined"?new Date(d):new Date();
if(this.isHijri()){
var _7=new di.Date();
return _7.fromGregorian(d);
}else{
if(this.isHebrew()){
var _7=new dh.Date();
return _7.fromGregorian(d);
}
}
return d;
},formatBidiDate:function(d,_8){
var di=dojox.date.islamic,il=di.locale,dh=dojox.date.hebrew,hl=dh.locale,dg=dojo.date,gl=dg.locale;
d=typeof d!=="undefined"?new Date(d):new Date();
if(this.isHijri()){
var _9=new di.Date();
return il.format(_9.fromGregorian(d),_8);
}else{
if(this.isHebrew()){
var _9=new dh.Date();
return hl.format(_9.fromGregorian(d),_8);
}
}
return gl.format(d,_8);
},getCalendar:function(){
return _3();
},getBundle:function(_a){
var di=dojox.date.islamic,il=di.locale,dh=dojox.date.hebrew,hl=dh.locale,dg=dojo.date,gl=dg.locale;
if(this.isHijri()){
return il._getIslamicBundle()[_a];
}else{
if(this.isHebrew()){
return hl._getHebrewBundle()[_a];
}
}
return gl._getGregorianBundle()[_a];
}};
})();
}


;if(!dojo._hasResource["lconn.core.DateUtil"]){
dojo._hasResource["lconn.core.DateUtil"]=true;
dojo.provide("lconn.core.DateUtil");








dojo.requireLocalization("lconn.core","strings");
dojo.requireLocalization("dojo.cldr","gregorian");




(function(){
var w={},_1=lconn.core.globalization.BidiDateUtil;
w.MILLS_IN_DAY=86400000;
w.inited=null;
w.Today="Error: not inited";
w.Yesterday="Error: not inited";
w.Tomorrow="Error: not inited";
w.initResStrings=function(){
var _2=new lconn.core.Res();
_2.loadDefaultBundle();
var b=_2.resBundle;
this.Today=b.rs_today;
this.Yesterday=b.rs_yesterday;
this.Tomorrow=b.rs_tomorrow;
this.At=b.rs_at;
this.inited=true;
};
w.delta=function(_3,_4){
var _5=_3.getTime()-_4;
var _6=Math.ceil(_5/(this.MILLS_IN_DAY));
return _6;
};
w.toString=function(_7,_8){
var _9;
if(!_7||!(_9=Date.parse(_7))){
console.log("Invalid date passed to DateUtil.toString(): "+_7);
return;
}
var _a="";
_a=this.toStringForTimeinMs(_9,_8);
return _a;
};
w.toStringForTimeinMs=function(_b,_c,_d){
if(this.Days==null){
this.Days=dojo.i18n.getLocalization("dojo.cldr","gregorian")["days-format-wide"];
}
if(this.Month==null){
this.Month=dojo.i18n.getLocalization("dojo.cldr","gregorian")["months-format-abbr"];
}
if(!_1.isGregorian()){
this.Month=_1.getDateComponent("months","abbr");
}
if(this.inited==null){
this.initResStrings();
}
var _e=new Date();
_e.setHours(0,0,0,0);
var _f=new Date();
_f.setTime(_b);
var _10=this.delta(_e,_b);
var _11="";
if(!_1.isGregorian()){
_f=_1.fromGregorian(_f);
_e=_1.fromGregorian(_e);
}
if(_10<=2&&_10>=-2){
if(_10==2){
if(!_c){
_11=this.Days[_f.getDay()]+" "+this.At+" "+this.getLocalizedTime(_f);
}else{
_11=this.Days[_f.getDay()];
}
}else{
if(_10==1){
if(!_c){
_11=this.Yesterday+" "+this.At+" "+this.getLocalizedTime(_f);
}else{
_11=this.Yesterday;
}
}else{
if(_10==0){
if(!_c){
_11=this.Today+" "+this.At+" "+this.getLocalizedTime(_f);
}else{
_11=this.Today;
}
}else{
if(_10==-1){
_11=this.Tomorrow;
}else{
if(_10==-2){
_11=this.Days[_f.getDay()];
}
}
}
}
}
}else{
if(_e.getFullYear()==_f.getFullYear()){
var lcl=lconn.core.locale,_12=lcl.getLanguage(),_13=lcl.getCountry();
if(_12==="en"&&(!_13||_13==="us")&&!_d){
_11=this.Month[_f.getMonth()]+" "+_f.getDate();
}else{
_11=this.getLocalizedDate(_f);
}
}else{
var lcl=lconn.core.locale,_12=lcl.getLanguage(),_13=lcl.getCountry();
if(_12==="en"&&(!_13||_13==="us")){
_11=this.Month[_f.getMonth()]+" "+_f.getDate()+", "+_f.getFullYear();
}else{
_11=this.getLocalizedDate(_f);
}
}
}
if(djConfig.locale=="ar"){
return "\u200f"+_11;
}
return _11;
};
w.getLocalizedTime=function(_14){
return dojo.date.locale.format(_14,{selector:"time",formatLength:"short",locale:djConfig.locale});
};
w.getLocalizedDate=function(_15){
if(_1.isGregorian()){
return dojo.date.locale.format(_15,{selector:"date",formatLength:"medium",locale:djConfig.locale});
}else{
return _1.formatBidiDate(_15,{selector:"date",formatLength:"medium",locale:djConfig.locale});
}
};
w.getLocaleString=function(_16){
var _17=new Date();
_17.setTime(_16);
if(_1.isGregorian()){
return _17.toLocaleString();
}else{
return _1.formatBidiDate(_17,{selector:"date",formatLength:"medium",locale:djConfig.locale});
}
};
lconn.core.DateUtil=w;
})();
lconn.core.DateUtil.atomDateToJsDate=function atomDateToJsDate(_18){
var _19=null;
var s=_18;
var _1a=(s.charAt(s.length-1)=="Z");
var _1b=s.indexOf("-");
if(s.length>="yyyy-mm-ddThh:mm".length){
s=s.substring(_1b-4);
var y=parseInt(s.substr(0,4));
var m=parseInt(s.substr(5,2),10)-1;
var d=parseInt(s.substr(8,2),10);
var h=parseInt(s.substr(11,2),10);
var mi=parseInt(s.substr(14,2),10);
var utc=0;
if(_1a){
var _1c=s.substring(17,s.length-1);
var _1d=parseFloat(_1c);
utc=Date.UTC(y,m,d,h,mi)+_1d*1000;
}else{
var zh=0;
var zm=0;
var _1e=s.length-6;
var _1f=s.charAt(_1e);
if((_1f=="+"||_1f=="-")&&s.indexOf("T")<s.length-5){
var se=parseInt(s.substr(17,2),10);
var zh=parseInt(s.substr(_1e,3),10);
var zm=parseInt(s.substr(_1e+4,2),10);
}
utc=Date.UTC(y,m,d,h,mi,se)-(zh*60*60*1000+zm*60*1000);
}
_19=new Date(utc);
}
return _19;
};
lconn.core.DateUtil.AtomDateToString=function AtomDateToString(_20,_21){
var _22=lconn.core.DateUtil.atomDateToJsDate(_20);
var _23=new Date(_20);
_22=_23.getDay()&&!_22?_23:_22;
return _22?lconn.core.DateUtil.toString(_22,_21):_20;
};
}


;if(!dojo._hasResource["lconn.core.NameUtil"]){
dojo._hasResource["lconn.core.NameUtil"]=true;
dojo.provide("lconn.core.NameUtil");


lconn.core.NameUtil={getHTML:function(_1,_2,_3,id,_4){
var _5;
var _6=lconn.core.HTMLUtil.escapeText(_3);
if(_2){
var _7=lconn.core.HTMLUtil.escapeText(_2);
if(_1){
_5=(_4?_1:lconn.core.HTMLUtil.escapeText(_1));
}else{
_5=_7;
}
return "<span"+(id?" id=\""+id+"\"":"")+"><span class=\"vcard\"><span class=\"fn person lotusPerson bidiAware\">"+_5+"</span><span class=\"email\" style=\"display: none;\">"+_7+"</span><span class=\"x-lconn-userid\" style=\"display: none;\">"+_6+"</span></span></span>";
}else{
var _5;
var _8=lconn.core.HTMLUtil.escapeInlineText(_3);
if(_1){
_5=(_4?_1:lconn.core.HTMLUtil.escapeText(_1));
}else{
_5=_6;
}
return "<span"+(id?" id=\""+id+"\"":"")+"><span class=\"vcard\"><span class=\"fn person lotusPerson bidiAware\">"+_5+"</span><span class=\"x-lconn-userid\" style=\"display: none;\">"+_6+"</span></span></span>";
}
}};
}


;if(!dojo._hasResource["lconn.core.TextBox"]){
dojo._hasResource["lconn.core.TextBox"]=true;
dojo.provide("lconn.core.TextBox");






dojo.declare("lconn.core.TextBox",[dijit._Widget,dijit._Templated],{shadowText:"",shadowTextOn:true,name:"",textBoxClass:"",templateString:"<span><input type=\"text\" class=\"${textBoxClass}\" dojoAttachPoint=\"textbox\" /><input type=\"hidden\" value=\"\" dojoAttachPoint=\"hiddenbox\" /></span>",postCreate:function(){
this.connect(this.textbox,"onfocus","textBoxFocus");
this.connect(this.textbox,"onblur","textBoxBlur");
this.connect(this.textbox,"onclick","textBoxClick");
this.textbox.name=this.id+"_textbox";
if(this.value){
this.textbox.value=this.value;
this.hiddenbox.value=this.value;
this.shadowTextOn=false;
}else{
dojo.addClass(this.textbox,"lotusInactive");
this.textbox.value=this.shadowText;
}
if(this.name){
this.hiddenbox.name=this.name;
}
if(this.title){
this.textbox.title=this.title;
}
lconn.core.globalization.bidiUtil.inputRTLProcessing(this.textbox);
this.connect(this.textbox,"onkeyup",function(){
lconn.core.globalization.bidiUtil.inputRTLProcessing(this.textbox);
});
if(dojo.isMoz||dojo.isOpera){
this.connect(this.textbox,"oninput",function(){
lconn.core.globalization.bidiUtil.inputRTLProcessing(this.textbox);
});
}
},textBoxBlur:function(){
if(this.textbox.value.length===0){
dojo.addClass(this.textbox,"lotusInactive");
this.shadowTextOn=true;
this.textbox.value=this.shadowText;
this.hiddenbox.value="";
}else{
dojo.removeClass(this.textbox,"lotusInactive");
this.hiddenbox.value=this.textbox.value;
this.shadowTextOn=false;
}
},textBoxFocus:function(){
if(this.shadowTextOn){
this.shadowTextOn=false;
this.textbox.value="";
this.hiddenbox.value="";
dojo.removeClass(this.textbox,"lotusInactive");
this.textbox.focus();
}
},textBoxClick:function(){
if(document.activeElement!=this.textbox){
this.textbox.focus();
}
},setHiddenValue:function(){
if(this.shadowTextOn){
this.hiddenbox.value="";
}else{
this.hiddenbox.value=this.textbox.value;
}
},focus:function(){
this.textbox.focus();
},getValue:function(){
return this.hiddenbox.value;
},setValue:function(_1){
this.textbox.value=_1;
if(document.activeElement!==this.textbox){
this.textBoxBlur();
}
lconn.core.globalization.bidiUtil.inputRTLProcessing(this.textbox);
},clearValue:function(){
this.setValue("");
}});
dojo.declare("lconn.core.DefaultValueTextbox",[dijit._Widget,dijit._Templated],{templateString:"<input class=\"lotusInactive\" type=\"text\" name=\"${name}\" value=\"${defaultValue}\" dojoAttachEvent=\"onfocus:_onFocus, onkeypress:_onChange, onchange:_onChange\"></input></div>",name:"",defaultValue:"",setFocus:function setFocus(){
window.setTimeout("dijit.focus('"+this.id+"')",0);
},isDirty:function isDirty(){
return this.dirty;
},_onFocus:function _onFocus(_2){
if(dojo.hasClass(this.domNode,"lotusInactive")){
window.setTimeout("dojo.byId('"+this.id+"').select()",0);
}
},_onChange:function _onChange(_3){
dojo.removeClass(this.domNode,"lotusInactive");
this.dirty=true;
}});
}


;if(!dojo._hasResource["lconn.core.typeahead.DataReader"]){
dojo._hasResource["lconn.core.typeahead.DataReader"]=true;
dojo.provide("lconn.core.typeahead.DataReader");










dojo.declare("lconn.core.typeahead.DataReader",[dijit._Widget],{lastQuery:null,pageSize:4,highlight:true,canSendEmptyQueries:false,basicAuthentication:"/fba",anonymousAuthentication:"/anonymous",path:"",resultsId:"",_xhr:null,_promise:null,timeout:0,startup:function(){
this.inherited(arguments);
var _1=lconn.core.url.getServiceUrl(lconn.core.config.services.search);
var _2=(lconn.core.auth.isAuthenticated()?this.basicAuthentication:this.anonymousAuthentication);
this._initLastQuery(_1+_2);
},_initLastQuery:function(_3){
this.lastQuery={url:_3+this.path,query:"",pageSize:this.pageSize,page:1};
},resetLastQuery:function(){
this.lastQuery.query="";
this.lastQuery.page=1;
},executeQuery:function(_4){
this.abortLastRequest();
this._promise=new dojo.Deferred();
if(_4){
this.lastQuery.query=_4;
}else{
if(!this.lastQuery.query&&!this.canSendEmptyQueries){
setTimeout(dojo.hitch(this,function(){
this._promise.cancel();
}),1);
return this._promise.promise;
}
}
var _5={url:this._constructLastQueryString(),content:"",handleAs:"json",load:dojo.hitch(this,"_querySuccess"),error:dojo.hitch(this,"_queryError"),failOk:true};
if(this.timeout>0){
_5.timeout=this.timeout;
}
this._xhr=dojo.xhrGet(_5);
return this._promise.promise;
},getNextPage:function(){
this.lastQuery.page++;
return this.executeQuery(null);
},_constructLastQueryString:function(){
return lconn.core.url.rewrite(this.lastQuery.url,{query:(this.lastQuery.query?this.lastQuery.query:undefined),pageSize:this.lastQuery.pageSize,page:(this.lastQuery.page>1?this.lastQuery.page:undefined),highlight:this.highlight});
},_querySuccess:function(_6,_7){
if(_7.xhr.status==200){
if(this._promise&&(!this._promise.isResolved()||!this._promise.isCanceled())){
var _8={data:_6[this.resultsId],totalResults:_6.totalResults,pageSize:this.pageSize};
this._promise.resolve(_8);
}
}else{
this._queryError(null,{status:_7.xhr.status});
}
},_queryError:function(_9){
if(_9&&_9.dojoType=="cancel"){
if(dojo.config.isDebug){
console.debug(_9);
}
}
if(this._promise){
this._promise.reject(_9);
}
},abortLastRequest:function(){
if(this._xhr){
this._xhr.cancel();
}else{
if(this._promise){
this._promise.cancel();
}
}
},setPageSize:function(_a){
this.lastQuery.pageSize=_a>0?_a:this.pageSize;
}});
}


;if(!dojo._hasResource["lconn.core.typeahead.Service"]){
dojo._hasResource["lconn.core.typeahead.Service"]=true;
dojo.provide("lconn.core.typeahead.Service");








dojo.declare("lconn.core.typeahead.Service",[dijit._Widget],{header:null,footer:null,isLoginNeeded:false,isDisabled:false,minToDisplay:-1,lengthToIgnoreMin:-1,isFocusable:false,useAriaNodes:true,_dataReader:null,_createdWidgets:null,postCreate:function(){
this._dataReader=new lconn.core.typeahead.DataReader();
this._dataReader.startup();
},startup:function(){
this._createdWidgets=[];
},destroy:function(){
this._cleanAll();
},_cleanAll:function(){
if(this._createdWidgets){
for(var i=0;i<this._createdWidgets.length;i++){
this._createdWidgets[i].destroyRecursive();
}
}
if(this.header&&this.header.parentNode){
this.header.parentNode.removeChild(this.header);
}
if(this.footer&&this.footer.parentNode){
this.footer.parentNode.removeChild(this.footer);
}
this._createdWidgets=[];
},executeQuery:function(_1){
var _2=new dojo.Deferred();
if(this._checkBeforeQueryExec(_2)){
var _3=this._dataReader.executeQuery(_1);
_3.then(dojo.hitch(this,"_handleResults",_2,_1));
_3.otherwise(dojo.hitch(this,"_handleError",_2));
}
return _2.promise;
},getNextPage:function(){
var _4=new dojo.Deferred();
if(this._checkBeforeQueryExec(_4)){
var _5=this._dataReader.getNextPage();
_5.then(dojo.hitch(this,"_handleResults",_4,this._dataReader.lastQuery.query));
_5.otherwise(dojo.hitch(this,"_handleError",_4));
}
return _4.promise;
},_checkBeforeQueryExec:function(_6){
var _7=true;
if(this.isDisabled){
this._handleDisabled(_6);
_7=false;
}else{
if(this.isLoginNeeded&&!lconn.core.auth.isAuthenticated()){
this._handleLogin(_6);
_7=false;
}
}
return _7;
},_handleResults:function(_8,_9,_a){
this._cleanAll();
var _b={header:this.header,footer:this.footer,aria:this.useAriaNodes?this.initAriaNodes():[],results:this.initResults(_a.data),totalResults:_a.totalResults,pageSize:_a.pageSize};
if(this.minToDisplay>=0&&(_9.length<=this.lengthToIgnoreMin||this.lengthToIgnoreMin<0)){
_b.minToDisplay=this.minToDisplay;
}else{
if(this.minToDisplay<0){
_b.minToDisplay=_b.totalResults;
}
}
_8.resolve(_b);
},_handleError:function(_c,_d){
if(_d&&_d.dojoType=="cancel"){
_c.cancel(_d);
}else{
this._cleanAll();
_c.resolve({});
}
},_handleLogin:function(_e){
_e.resolve({showLogin:true});
},_handleDisabled:function(_f){
this._cleanAll();
_f.resolve({serviceDisabled:true});
},initResults:function(_10){
return {};
},initAriaNodes:function(){
return [];
},setTimeout:function(_11){
this._dataReader.timeout=_11;
},setPageSize:function(_12){
this._dataReader.setPageSize(_12);
},focusCallback:function(_13){
}});
}

dojo.provide("lconn.core.nls.widgets")._built=true;
dojo.provide("lconn.core.nls.widgets.en");
lconn.core.nls.widgets.en={"ErrorGeneric":"An error occurred while displaying content. Contact your system administrator.","msg.loginRequired":"Log in to view your content.","actionsmenu":"Actions Menu","wcuLoadInfo":"Find out how you are related to this profile based on your network and actions.","view":"View","widgets_MoveUp":"Move Up","dykLoadInfo":"View recommended people to add to your network.","showErrorDetails":"Show Error Details","widgets_MovePrev":"Move To Previous Column","cancel":"Cancel","loadInfo":"Load Information ...","errorType":"Type: ","deleteWidgetConfirm":"I understand that the application and its associated data will be deleted and cannot be recovered.","hideWidgetMsg":"You are about to hide your application.\x3cbr/\x3e\x3cbr/\x3eYou can re-activate it at a later point simply by re-adding the application to your Community. All of the application content will be kept intact.","widget_BackToOverview":"Back to Overview Page","widgets_Max":"Maximize","changeTitleAction":"Change Title","errorDefaultMsg3":"Click here to show more details","widget_AllTab":"All","deleteWithSharedContentWidgetConfirm":"I understand that the application and its associated data will be deleted and cannot be recovered.  Content that members share with the community is still shared. If the application is added again, this shared content reappears in the application.","errorDefaultMsg2":"An error has occurred, contact your system Administrator","ticLoadInfo":"Find out what you have in common with this profile based on your network and activity.","widgets_Move":"Move","errorStackTrace":"Trace: ","edit":"Edit","save":"Save","errorLine":"Line:","actions_alt":"Actions for: ${0}","errorUnableToConnect":"Connection failed for {0}","deleteWidgetWarn":"Warning: Data for the application {0} will be permanently deleted.","dykLoadInfo2":"View recommended people to add to your network based on your existing network contacts.","open":"Open","errorName":"Name: ","switchTabWarning":"You must save changes on each tab before moving to another tab.","widgetCat_thrdParty":"Other","link.window.close":"Close window","hideWidget":"Hide Application","toggle":"Toggle","multiFeedReaderNoFeeds":"No feeds available","help":"Help","label.theme.customize":"Add Apps","info.feed.general.moreinfo":"Click here to show more details","widget_AddingWidget":"Adding Application","widgetCat_hidden":"Hidden","widgets_MoveNext":"Move To Next Column","str_component_id":"CLFWZ","delete":"Delete","widgets_MoveLeft":"Move Left","widgetCat_AllWidgets":"All Applications","widgets_MoveRight":"Move Right","errorDefaultMsg":"Unable to display application data","actions":"Actions","deleteWidgetMsg":"You are about to remove your application. This will remove all application content. This action cannot be undone. Content that members share with the community is still shared. If the application is added again, this shared content reappears in the application.\x3cbr/\x3e\x3cbr/\x3eIf you are sure you want to remove the application, click the Remove button below. \x3cbr/\x3eOtherwise, click Cancel.","widgets_Min":"Minimize","HideErrorDetails":"Hide Error Details","widgets_MoveDown":"Move Down","close":"Close","link.remove":"Remove","error.title.generic":"We\'ve encountered a problem.","widget_RemovingWidget":"Removing Application","hide":"Hide","link.window.openNewWindow":"Clicking this will open a new window","deleteWidget":"Remove Application","confirmDeleteWidget":"Are you sure you want to remove this application?\x3cbr\x3e\x3cbr\x3eYou can restore this application later through the Community Actions menu.  Any settings for displaying the application are lost, but the application\'s data remains intact.","error.message.generic":"Something went wrong - click the Back button and try again. If this does not work, report the problem in the support forum.","errorMsg":"Message: ","str.msgid.ignore":"true","refresh":"Refresh"};

;if(!dojo._hasResource["lconn.core.errorhandling"]){
dojo._hasResource["lconn.core.errorhandling"]=true;
dojo.provide("lconn.core.errorhandling");


dojo.requireLocalization("lconn.core","widgets");


lconn.core.errorhandling.DefaultXHRErrorHandler=function(_1,_2){
var _3=dojo.i18n.getLocalization("lconn.core","widgets");
var _4=null;
var _5=null;
if(_1.status==404){
if(_2.args!=null&&_2.args.url!=null){
if(_2.args.url.indexOf("roller-ui/feed")!=-1||_2.args.url.indexOf("files/basic/anonymous/api/userlibrary")!=-1||_2.args.url.indexOf("wikis/basic/anonymous/api/userlibrary")!=-1){
_5=_3["multiFeedReaderNoFeeds"];
lconn.core.errorhandling.displayError(_2,_5,_1);
return;
}
}
}
if(_1.status==400){
if(_2.args!=null&&_2.args.url!=null){
if(_2.args.url.indexOf("service/atom/communities")!=-1){
_5=_3["multiFeedReaderNoFeeds"];
lconn.core.errorhandling.displayError(_2,_5,_1);
return;
}
}
}
if(_1.documentElement!=null){
if(_1.documentElement.nodeName=="error"||_1.documentElement.nodeName=="parsererror"){
var _6=(dojox.data.dom.innerXML(_1.documentElement));
_5=lconn.core.errorhandling.getErrorHTML(null,null,null,null,_6);
}
}else{
var _7=_3["errorUnableToConnect"];
_7=lconn.core.utilities.replacePlaceHolders(_7,[_2.args.url]);
if(_1.message!=null&&_1.name!=null){
if(_2.args.xsltArgs!=null){
return lconn.core.errorhandling.DefaultErrorHandler(_7,_1,_2.args.xsltArgs);
}else{
return lconn.core.errorhandling.DefaultErrorHandler(_7,_1,_2.args.htmlContainerElemId);
}
}else{
_5=lconn.core.errorhandling.getErrorHTML(_7,null,null,null,_1);
}
}
if(_5==null){
_5=lconn.core.errorhandling.getErrorHTML(null,null,null,null,_1);
}
lconn.core.errorhandling.displayError(_2,_5,_1);
};
lconn.core.errorhandling.displayError=function(_8,_9,_a){
var _b=null;
if(_8.args.xsltArgs!=null&&_8.args.xsltArgs.htmlContainerElemId!=null){
_b=_8.args.xsltArgs.htmlContainerElemId;
}else{
if(_8.args.htmlContainerElemId!=null){
_b=_8.args.htmlContainerElemId;
}
}
var _c=dojo.i18n.getLocalization("lconn.comm","strings");
window.setTimeout(function(){
try{
if(_b){
var _d=dojo.i18n.getLocalization("lconn.comm","strings");
var _e=new com.ibm.oneui.controls.MessageBox({canClose:((typeof canClose=="undefined")?true:canClose),_strings:{icon_alt:_d["rs_msgbox_error"],a11y_label:_d["rs_msgbox_error_a11y"],close_btn_title:_d["rs_msgbox_close"],close_btn_alt:_d["rs_msgbox_close"]},type:com.ibm.oneui.controls.MessageBox.TYPE.ERROR,msg:_9},_b);
}
}
catch(e){
if(window.debugComm!=null&&window.console){
console.log(e);
}
}
},200);
};
lconn.core.errorhandling.DefaultErrorHandler=function(_f,_10,_11){
var log=function(_12,_13,_14){
var msg="";
if(_13 instanceof (Error)){
var _15=null;
if(_13.lineNumber!=null){
_15=_13.lineNumber;
}
if(_15!=null){
msg+=dojo.i18n.getLocalization("lconn.core","widgets")["errorLine"]+" "+_15+"<br/>";
}
var _16=null;
msg=lconn.core.errorhandling.getErrorHTML(_12,_13.message,_13.name,_15,_16);
}else{
var _16=null;
msg=lconn.core.errorhandling.getErrorHTML(_12,_13,null,null,_16);
}
var _17={args:{xsltArgs:{htmlContainerElemId:_14}}};
lconn.core.errorhandling.displayError(_17,msg);
};
if(typeof (_11)=="string"){
log(_f,_10,_11);
}else{
if(typeof (_11)=="undefined"){
var _18=document.createElement("span");
_18.id="errorContainer";
document.body.appendChild(_18);
log(_f,_10,"errorContainer");
}else{
if(_11.htmlContainerElemId!=null){
log(_f,_10,_11.htmlContainerElemId);
}else{
log(_f,_10,_11);
}
}
}
};
lconn.core.errorhandling.getErrorHTML=function(_19,_1a,_1b,_1c,_1d){
var msg="";
if(_1a!=null){
msg=_1a;
}
return msg;
};
var common_getStacktrace=function(){
var _1e=common_getStacktrace.caller;
var _1f=new Error();
if(_1f.stack!=null){
return _1f.stack;
}else{
var _20="";
while(_1e!=null){
_20+="\n"+common_getFunctionName(_1e);
var _21=_1e.caller;
if(_21==null&&_1e.arguments!=null&&_1e.arguments.caller!=null){
_21=_1e.arguments.caller;
}
_1e=_21;
}
return _20;
}
};
var common_getFunctionName=function(_22){
var _23=_22.name;
if(_22.tempName!=null&&_22.tempName!=""){
_23=_22.tempName;
}
if(_23==null||_23==""){
var _24=_22.toString();
var _25=_24.match(/function (\w*)/);
if(_25!=null){
_23=_25[1];
}
if(_23==null||_23==""){
_23="anonymous-function";
}
}
return _23;
};
}


;if(!dojo._hasResource["lconn.core.widgetUtils"]){
dojo._hasResource["lconn.core.widgetUtils"]=true;
dojo.provide("lconn.core.widgetUtils");








lconn.core.widgetUtils.handleRefresh=function(_1,_2){
var _3=_2.widgetId,_4=dojo.getObject("refreshInfoHolder");
if(_4&&_4[_3]){
_1=lconn.core.url.rewrite(_1,{preventCache:new Date().getTime()});
}
return _1;
};
lconn.core.widgetUtils.addVersionNumber=function(_5){
var _6=lconn.core.config.versionStamp;
if(_6){
_5=lconn.core.url.rewrite(_5,{etag:_6});
}
return _5;
};
lconn.core.widgetUtils.search=function(_7,_8,_9,_a){
try{
var _b=_7.getiWidgetAttributes();
var _c=_7.widgetId+"_TabItem";
var _d=dojo.byId(_c);
var _e=_b.getItemValue("searchKeywords");
var _f=_b.getItemValue("tagCloudItemValue");
var _10=_b.getItemValue("resourceId");
var _11=_7.getUserProfile().getItemValue("userid");
var _12=dojo.byId("search_searchResults_filterInfo");
lconn.core.widgetUtils.searchC(_8,_9,_e,_f,_10,_11,dojo.hitch(_7.io,_7.io.rewriteURI),_a,_12,_d);
}
catch(exception){
console.log("exception occurred during lconn.core.widgetUtils.search()");
console.log(exception);
lconn.core.errorhandling.DefaultErrorHandler("lconn.core.widgetUtils.search",exception,{htmlContainerElemId:_9});
}
};
lconn.core.widgetUtils.searchC=function(_13,_14,_15,_16,_17,_18,_19,_1a,_1b,_1c){
var _1d=dijit.byId("search_searchResults_filterInfo");
var _1e=dojo.byId("search_searchResults_filterInfo");
if(_1d!=null&&_1e!=null){
var _1f=_1e.parentNode;
_1d.destroy();
var _20=dojo.create("span",{id:"search_searchResults_filterInfo"});
_1f.appendChild(_20);
_1b=_20;
}else{
if(_1d!=null){
_1d.destroy();
}
}
if(_1b==null){
_1b=dojo.create("span",{id:"search_searchResults_filterInfo"});
}
var _21=!_18;
var _22=WidgetPlacementConfig.params.searchSvcRef;
if(window.debugWidgets){
console.log("lconn.core.widgetUtils.search: searchSvcRef: "+_22);
}
if(_22){
var url=_19(_22);
if(window.debugWidgets){
console.log("lconn.core.widgetUtils.search: url: "+url);
}
var _23={};
if(_15){
_23.query=_15;
}
if(_16||this.selectedTags!=null){
var _24;
if(this.selectedTags!=null){
_24=this.selectedTags;
}else{
var _25=_16.replace("/","\\/");
_24=_25.split(",");
}
for(var i=0;i<_24.length;i++){
var tag=_24[i];
var _26={type:"category",values:["Tag/"+tag]};
var _27=dojo.toJson(_26);
if(_23.constraint){
_23.constraint.push(_27);
}else{
_23.constraint=[_27];
}
}
}
if(this.selectedPeople!=null){
for(var i=0;i<this.selectedPeople.length;i++){
var _28=this.selectedPeople[i];
var _26={type:"category",values:["Person/"+_28]};
var _29=dojo.toJson(_26);
if(_23.constraint){
_23.constraint.push(_29);
}else{
_23.constraint=[_29];
}
}
}
_23.scope=_13?_13:"communities";
if(_1a){
var _2a={type:"field",id:"FIELD_LIBRARY_DBINTERNAL_UID",values:[_1a]};
var _2b=dojo.toJson(_2a);
if(_23.constraint){
_23.constraint.push(_2b);
}else{
_23.constraint=[_2b];
}
}
if(_17){
var _2c={type:"community",id:_17};
_23.social=dojo.toJson(_2c);
}
var _2d=lconn.core.url.writeParameters(_23);
if(window.debugWidgets){
console.log("lconn.core.widgetUtils.search: searchString: "+_2d);
console.log("lconn.core.widgetUtils.search: isPublic: "+_21);
console.log("lconn.core.widgetUtils.search: resultContainerDomNode: "+_14);
}
var _2e=(!_13||_13==="communities:content");
dojo["require"]("lconn.search.searchResults");
window.searchObject=new lconn.search.searchResults({contextRoot:url,isPublic:_21,queryString:_2d,resultsDomNode:dojo.byId(_14),filterAreaDomNode:_1b,showFilters:false,showHeading:_2e});
var _2f={focusNode:_1c};
if(_1c!=null&&_1c!="undefined"){
searchObject.update(_2f);
}else{
searchObject.update();
}
if(!lconn.core.widgetUtils.haveRegisteredTagChangeCallback){
searchObject.registerTagChange(function(_30,_31,_32){
if(window.debugWidgets){
console.log("lconn.core.widgetUtils.tagChange callback called. All tags: "+_30.join());
}
lconn.core.widgetUtils.updateHashParam("tag",_30);
lconn.core.widgetUtils.selectedTags=_30;
});
lconn.core.widgetUtils.haveRegisteredTagChangeCallback=true;
require(["dojo/topic"],function(_33){
_33.subscribe("search/person/changed",function(_34){
if(window.debugWidgets){
console.log("Search selected person changed.  Current value: "+_34.join());
}
lconn.core.widgetUtils.updateHashParam("person",_34);
lconn.core.widgetUtils.selectedPeople=_34;
});
});
}
}
if(typeof lconn.core.widgetUtils.selectedTags=="undefined"){
lconn.core.widgetUtils.haveRegisteredTagChangeCallback=false;
lconn.core.widgetUtils.selectedTags=null;
}
};
lconn.core.widgetUtils.updateHashParam=function(_35,_36){
var _37=lconn.core.utilities.getHash();
var _38=lconn.core.url.getRequestParameters("/index?"+_37);
if(_36.length==0){
delete _38[_35];
}else{
_38[_35]=_36.join();
}
var _39=lconn.core.url.writeParameters(_38);
window.location.hash=_39.substring(1);
};
}

dojo.provide("lconn.core.typeahead.nls.ResultDropDown")._built=true;
dojo.provide("lconn.core.typeahead.nls.ResultDropDown.en_us");
lconn.core.typeahead.nls.ResultDropDown.en_us={"SEARCH_SCOPE_ARIA_LABEL":"Selecting this option it will bring you to the actual scope page","LOGIN_MESSAGE":"\x3cspan style=\'color: #1F7CAE; font-weight: bold;\'\x3eLog in\x3c/span\x3e to see more results including Files, Wikis, Communities and more.","SEARCH_SCOPE_STRING":"Search for \x3cb\x3e${query}\x3c/b\x3e in ${scope}...","LOGIN_ARIA_LABEL":"Selecting this option will bring you to the login page"};

;if(!dojo._hasResource["lconn.core.typeahead.ResultDropDown"]){
dojo._hasResource["lconn.core.typeahead.ResultDropDown"]=true;
dojo.provide("lconn.core.typeahead.ResultDropDown");








dojo.requireLocalization("lconn.core.typeahead","ResultDropDown");
dojo.declare("lconn.core.typeahead.ResultDropDown",[dijit.TooltipDialog],{width:300,orientation:null,maxResults:7,selectedElement:null,showCalloutArrow:true,_selectionArray:null,_serviceNodeIndex:null,_serviceOrder:null,_doNotDisplay:false,_strings:null,_blankImg:"",_showLogin:false,normalScopeNode:null,normalScopeTextNode:null,resultsContainer:null,loginNode:null,postMixInProperties:function(){
this.inherited(arguments);
this._strings=dojo.i18n.getLocalization("lconn.core.typeahead","ResultDropDown");
dojo.mixin(this,this._strings);
this._blankImg=lconn.core.widgetUtils.addVersionNumber(this._blankGif);
this._selectionArray=[];
this._serviceNodeIndex={};
this._serviceOrder=[];
},buildRendering:function(){
this.inherited(arguments);
var _1=document.createElement("div");
_1.style.width=this.width+"px";
_1.style.border="0px";
_1.style.padding="2px";
dojo.addClass(_1,"lconnSearchResults");
if(this.showCalloutArrow){
var _2=document.createElement("div");
dojo.addClass(_2,"taArrowShadow");
var _3=document.createElement("div");
dojo.addClass(_3,"taArrow");
_2.appendChild(_3);
_1.appendChild(_2);
}
this.normalScopeNode=document.createElement("div");
this.normalScopeNode.setAttribute("role","option");
this.normalScopeNode.setAttribute("aria-describedby",this.id+"_normalScopeAria");
dojo.addClass(this.normalScopeNode,"pfNormalScope");
this.connect(this.normalScopeNode,"onclick","searchOnScope");
this.connect(this.normalScopeNode,"onclick","closeAndPreventReopen");
this.connect(this.normalScopeNode,"onmouseover",dojo.hitch(this,"onMouseOver",this.normalScopeNode));
if(this.showCalloutArrow){
var _4=document.createElement("div");
dojo.addClass(_4,"taArrowSelected");
this.normalScopeNode.appendChild(_4);
}
var _5=document.createElement("div");
dojo.addClass(_5,"lotusSearch pfSearchIcon");
var _6=document.createElement("span");
_6.className="lotusBtnImg";
var _7=document.createElement("input");
_7.type="image";
dojo.addClass(_7,"lotusSearchButton");
_7.src=lconn.core.widgetUtils.addVersionNumber(this._blankGif);
_7.alt="";
_7.setAttribute("role","presentation");
_6.appendChild(_7);
_5.appendChild(_6);
this.normalScopeNode.appendChild(_5);
this.normalScopeTextNode=document.createElement("div");
dojo.addClass(this.normalScopeTextNode,"pfTextMessage");
this.normalScopeNode.appendChild(this.normalScopeTextNode);
var _8=document.createElement("div");
dojo.addClass(_8,"lotusHidden");
_8.innerHTML=this.SEARCH_SCOPE_ARIA_LABEL;
_8.id=this.id+"_normalScopeAria";
this.normalScopeNode.appendChild(_8);
this.resultsContainer=document.createElement("div");
dojo.addClass(this.resultsContainer,"pfDirectoryResults lconnSearchHighlight");
var _9=document.createElement("div");
dojo.addClass(_9,"pfDirectoryResults");
this.loginNode=document.createElement("div");
dojo.addClass(this.loginNode,"lconn_gray pfEntry");
this.loginNode.style.padding="10px";
this.loginNode.setAttribute("role","option");
this.loginNode.setAttribute("aria-describedby",this.id+"_loginAria");
this.loginNode.innerHTML=this.LOGIN_MESSAGE;
this.connect(this.loginNode,"onmouseover",dojo.hitch(this,"onMouseOver",this.loginNode));
this.connect(this.loginNode,"onclick",dojo.hitch(this,"_login",this.loginNode));
_9.appendChild(this.loginNode);
var _a=document.createElement("div");
dojo.addClass(_a,"lotusHidden");
_a.innerHTML=this.LOGIN_ARIA_LABEL;
_a.id=this.id+"_loginAria";
_9.appendChild(_a);
_1.appendChild(this.normalScopeNode);
_1.appendChild(this.resultsContainer);
_1.appendChild(_9);
this.content=_1;
},startup:function(){
this.containerNode.style.padding="0px";
this.containerNode.setAttribute("role","listbox");
this.containerNode.setAttribute("wairole","listbox");
this.containerNode.setAttribute("aria-live","polite");
},destroy:function(){
dijit.popup.close(this);
this.inherited(arguments);
},showResults:function(_b,_c,_d){
if(this._doNotDisplay){
return;
}
this._prepareResultsContent(_d);
var _e={parent:_b,popup:this,around:_c,onClose:dojo.hitch(this,"_removeScrollbarFix")};
if(this.orientation){
_e.orient=this.orientation;
}
dijit.popup.open(_e);
this._addScrollbarFix();
},_prepareResultsContent:function(_f){
if(!_f){
this._populateResults();
}
this._selectionArray=[];
this._constructSelectionArray();
if(this._showLogin){
dojo.removeClass(this.loginNode,"lotusHidden");
this._selectionArray.push(this.loginNode);
}else{
dojo.addClass(this.loginNode,"lotusHidden");
}
this._prepareSelectionArray();
this._selectElement(this._selectionArray[0]);
},showLogin:function(_10){
this._showLogin=_10;
},closeResults:function(){
dijit.popup.close(this);
},_addScrollbarFix:function(){
if(this.domNode.parentElement){
dojo.addClass(this.domNode.parentElement,"pfScrollbarFix");
}
},_removeScrollbarFix:function(){
if(this.domNode.parentElement){
dojo.removeClass(this.domNode.parentElement,"pfScrollbarFix");
}
},setResults:function(_11,_12){
if(!this._serviceNodeIndex[_11]){
return;
}
this._serviceNodeIndex[_11].results=[];
this._serviceNodeIndex[_11].response=_12;
},_populateResults:function(){
var _13=0;
var _14=[];
var _15=[];
var low=[];
for(var i=0;i<this._serviceOrder.length;i++){
var _16=this._serviceOrder[i];
this._serviceNodeIndex[_16].node.innerHTML="";
if(this._serviceNodeIndex[_16].response&&this._serviceNodeIndex[_16].response.totalResults>0){
var max=this._serviceNodeIndex[_16].response.minToDisplay||0;
var _17=0;
if(this._serviceNodeIndex[_16].response.results.high){
_17+=this._insertElements(_16,this._serviceNodeIndex[_16].response.results.high,max-_17,_14);
}
if(this._serviceNodeIndex[_16].response.results.medium){
_17+=this._insertElements(_16,this._serviceNodeIndex[_16].response.results.medium,max-_17,_15);
}
if(this._serviceNodeIndex[_16].response.results.low){
_17+=this._insertElements(_16,this._serviceNodeIndex[_16].response.results.low,max-_17,low);
}
_13+=_17;
}
}
var _18=_14.concat(_15,low);
this._insertFillers(_18,_13);
for(var i=0;i<this._serviceOrder.length;i++){
this._addHeader(this._serviceOrder[i]);
this._addFooter(this._serviceOrder[i]);
this._addAriaNodes(this._serviceOrder[i]);
}
},_addHeader:function(_19){
if(this._serviceNodeIndex[_19].response.header&&this._serviceNodeIndex[_19].results.length>0){
this._serviceNodeIndex[_19].node.insertBefore(this._serviceNodeIndex[_19].response.header,this._serviceNodeIndex[_19].node.firstChild);
}
},_addAriaNodes:function(_1a){
if(this._serviceNodeIndex[_1a].response.aria&&this._serviceNodeIndex[_1a].response.aria.length>0&&this._serviceNodeIndex[_1a].results.length>0){
for(var i=0;i<this._serviceNodeIndex[_1a].response.aria.length;i++){
this._serviceNodeIndex[_1a].node.appendChild(this._serviceNodeIndex[_1a].response.aria[i]);
}
}
},_addFooter:function(_1b){
if(this._serviceNodeIndex[_1b].response.footer&&this._serviceNodeIndex[_1b].results.length>0){
this._serviceNodeIndex[_1b].response.footer.setAttribute("role","option");
this.connect(this._serviceNodeIndex[_1b].response.footer,"onmouseover",dojo.hitch(this,"onMouseOver",this._serviceNodeIndex[_1b].response.footer));
this._serviceNodeIndex[_1b].node.appendChild(this._serviceNodeIndex[_1b].response.footer);
this._serviceNodeIndex[_1b].results.push(this._serviceNodeIndex[_1b].response.footer);
}
},_insertFillers:function(_1c,_1d){
for(var i=0;i<_1c.length&&_1d<this.maxResults;i++){
var _1e=_1c[i].id;
var _1f=_1c[i].item;
this._serviceNodeIndex[_1e].node.appendChild(_1f);
this._serviceNodeIndex[_1e].results.push(_1f);
_1d++;
}
},_insertElements:function(_20,_21,max,_22){
for(var i=0;i<_21.length;i++){
_21[i].setAttribute("role","option");
dojo.addClass(_21[i],"pfEntry");
this.connect(_21[i],"onmouseover",dojo.hitch(this,"onMouseOver",_21[i]));
this.connect(_21[i],"onclick","closeAndPreventReopen");
if(i<max){
this._serviceNodeIndex[_20].node.appendChild(_21[i]);
this._serviceNodeIndex[_20].results.push(_21[i]);
}else{
_22.push({id:_20,item:_21[i]});
}
}
return (i<max?i:max);
},addServiceResponse:function(_23){
var _24=document.createElement("div");
_24.id=_23+"_resultsNode";
this.resultsContainer.appendChild(_24);
this._serviceNodeIndex[_23]={node:_24,tmpNode:document.createElement("div"),results:[],response:null};
this._serviceOrder.push(_23);
},_constructSelectionArray:function(){
this._selectionArray.push(this.normalScopeNode);
for(var i=0;i<this._serviceOrder.length;i++){
var _25=this._serviceNodeIndex[this._serviceOrder[i]].results;
if(_25){
this._selectionArray=this._selectionArray.concat(_25);
}
}
},_prepareSelectionArray:function(){
for(var i=0;i<this._selectionArray.length;i++){
var _26=this._selectionArray[i];
_26.setAttribute("aria-posinset",i+1);
_26.setAttribute("aria-setsize",this._selectionArray.length);
if(!_26.id){
_26.setAttribute("id",this.id+"_option_"+i);
}
}
},selectNextElement:function(){
if(!this.selectedElement){
return;
}
var _27=dojo.indexOf(this._selectionArray,this.selectedElement);
var _28=(this._selectionArray.length-1>_27&&_27>=0)?_27+1:0;
this._selectElement(this._selectionArray[_28]);
},selectPreviousElement:function(){
if(!this.selectedElement){
return;
}
var _29=dojo.indexOf(this._selectionArray,this.selectedElement);
var _2a=(this._selectionArray.length-1>=_29&&_29>0)?_29-1:this._selectionArray.length-1;
this._selectElement(this._selectionArray[_2a]);
},executeSelectedAction:function(){
if(!this.selectedElement){
this.normalScopeNode.click();
}else{
this.selectedElement.click();
}
},closeAndPreventReopen:function(){
this._doNotDisplay=true;
this.closeResults();
setTimeout(dojo.hitch(this,function(){
this._doNotDisplay=false;
}),500);
},setQueryString:function(_2b,_2c){
this.normalScopeTextNode.innerHTML=this.getString("SEARCH_SCOPE_STRING",{"query":this._escapeHtml(_2b),"scope":_2c});
this._showLogin=false;
},_escapeHtml:function(str){
var div=document.createElement("div");
div.appendChild(document.createTextNode(str));
return div.innerHTML;
},getString:function(_2d,_2e){
return dojo.string.substitute(this._strings[_2d],_2e);
},_selectElement:function(_2f){
if(this.selectedElement){
dojo.removeClass(this.selectedElement,"pfSelected");
dijit.setWaiState(this.selectedElement,"selected","false");
}
if(!_2f){
return;
}
this.selectedElement=_2f;
dojo.addClass(this.selectedElement,"pfSelected");
dijit.setWaiState(this.selectedElement,"selected","true");
setTimeout(dojo.hitch(this,"onActiveDescendantChanged",_2f.id),1);
},_login:function(){
lconn.core.auth.login();
},onMouseOver:function(_30,evt){
dojo.stopEvent(evt);
this._selectElement(_30);
},searchOnScope:function(){
},onActiveDescendantChanged:function(id){
}});
}


;if(!dojo._hasResource["lconn.core.typeahead.TypeAheadManager"]){
dojo._hasResource["lconn.core.typeahead.TypeAheadManager"]=true;
dojo.provide("lconn.core.typeahead.TypeAheadManager");










dojo.declare("lconn.core.typeahead.TypeAheadManager",[dijit._Widget],{TIMEOUT_PROPERTY:"com.ibm.lconn.core.peopleFinder.timeout",SERVICE_TIMEOUT_PROPERTY:"com.ibm.lconn.core.typeahead.serviceRequest.timeout",MAX_RESULTS_PROPERTY:"com.ibm.lconn.core.typeahead.maxResults",ResultDropDown:lconn.core.typeahead.ResultDropDown,orientation:null,dropDownWidth:300,TAscopeLabelNode:null,TAdropdownAnchor:null,TAtextField:null,TAdisable:false,TAservicesList:null,resultDropDown:null,activeDescendantId:null,_queryTimeout:200,_serciveTimeout:1500,_maxResults:7,_mouseDown:false,_timeoutID:null,_keyPressed:false,_lastQuery:"",_keyToIgnore:{9:true,16:true,17:true,18:true},postCreate:function(){
if(!this.TAtextField||this.TAdisable||!this.TAservicesList){
return;
}
if(!this.TAdropdownAnchor){
this.TAdropdownAnchor=this.TAtextField;
}
var _1=parseInt(lconn.core.config.properties[this.TIMEOUT_PROPERTY]);
if(_1){
this._queryTimeout=_1;
}
_1=parseInt(lconn.core.config.properties[this.SERVICE_TIMEOUT_PROPERTY]);
if(_1){
this._serciveTimeout=_1;
}
var _2=parseInt(lconn.core.config.properties[this.MAX_RESULTS_PROPERTY]);
if(_2){
this._maxResults=_2;
}
if(!this.TAtextField.id){
this.TAtextField.id=this.id+"_TAtextField";
}
if(!this.orientation){
this.orientation=dojo.isBodyLtr()?{"BR":"TR"}:{"BL":"TL"};
}
this.resultDropDown=new this.ResultDropDown({orientation:this.orientation,dropDownWidth:this.dropDownWidth,maxResults:this._maxResults});
this.resultDropDown.startup();
for(var i=0;i<this.TAservicesList.length;i++){
var _3=this.TAservicesList[i];
if(!lconn.core.typeahead.Service.prototype.isPrototypeOf(_3)&&dojo.config.isDebug){
console.warn("ATTENTION! The provided class "+_3.declaredClass+" is not a subclass of lconn.core.typeahead.Service");
}
_3.setTimeout(this._serciveTimeout);
_3.setPageSize(this._maxResults);
this.resultDropDown.addServiceResponse(_3.id);
}
this.connect(this.resultDropDown,"onActiveDescendantChanged","_changeActiveDescendantId");
this.connect(this.resultDropDown.domNode,"onmousedown","_TAonMouseDown");
this.resultDropDown.connect(this,"search","closeResults");
this.connect(this.resultDropDown,"searchOnScope","search");
this.connect(this.TAtextField,"onkeypress","typeAheadCallback");
if(!dojo.isIE){
this.connect(this.TAtextField,"oninput","_onInput");
}
this.connect(this.TAtextField,"onblur","onFieldBlur");
this.connect(this.TAtextField,"onfocus","onFieldFocus");
this.TAtextField.parentElement.setAttribute("role","combobox");
this.TAtextField.parentElement.setAttribute("popupactive","true");
this.TAtextField.parentElement.setAttribute("aria-expanded","false");
this.TAtextField.setAttribute("role","textbox");
this.TAtextField.setAttribute("aria-invalid","false");
if(this.TA_ARIA_LABEL){
this.TAtextField.setAttribute("aria-label",this.TA_ARIA_LABEL);
}
this.TAtextField.autocomplete="off";
},destroy:function(){
if(this.resultDropDown){
this.resultDropDown.destroyRecursive();
}
this.inherited(arguments);
},typeAheadCallback:function(_4){
var _5=_4.which||_4.keyCode;
if(this.TAdisable||(!_4.keyChar&&_5==27)){
this.resultDropDown.closeResults();
this.TAtextField.removeAttribute("aria-activedescendant");
this.TAtextField.parentElement.setAttribute("aria-expanded","false");
return;
}
if(!_4.keyChar&&_5==13){
dojo.stopEvent(_4);
this.resultDropDown.executeSelectedAction();
return;
}
if(!_4.keyChar&&_5==38){
dojo.stopEvent(_4);
this.resultDropDown.selectPreviousElement();
return;
}
if(!_4.keyChar&&_5==40){
dojo.stopEvent(_4);
this.resultDropDown.selectNextElement();
return;
}
if(this._keyToIgnore[_5]){
return;
}
this.runQuery();
this._keyPressed=true;
},_onInput:function(_6){
if(!this._keyPressed){
this.typeAheadCallback(_6);
}
this._keyPressed=false;
},runQuery:function(){
clearTimeout(this._timeoutID);
this._timeoutID=setTimeout(dojo.hitch(this,function(){
var _7=this.TAtextField.value;
_7=dojo.string.trim(_7);
if(!_7||this.TAisPlaceholderActive()){
this._handleEmptyQueryString();
return;
}
if(_7===this._lastQuery){
return;
}
this._lastQuery=_7;
this.resultDropDown.setQueryString(_7,this.TAscopeLabelNode.innerHTML);
var _8=[];
for(var i=0;i<this.TAservicesList.length;i++){
var _9=this.TAservicesList[i];
var _a=_9.executeQuery(_7);
_a.then(dojo.hitch(this,"setTypeaheadResults",_9.id));
_8.push(_a);
}
var _b=new dojo.DeferredList(_8);
_b.then(dojo.hitch(this,"showTypeaheadResults"));
}),this._queryTimeout);
},_handleEmptyQueryString:function(){
this._lastQuery="";
this.resultDropDown.closeResults();
this.TAtextField.removeAttribute("aria-activedescendant");
this.TAtextField.parentElement.setAttribute("aria-expanded","false");
this.activeDescendantId=null;
},_setActiveDescendant:function(){
if(this.activeDescendantId){
this.TAtextField.setAttribute("aria-activedescendant",this.activeDescendantId);
}else{
this.TAtextField.setAttribute("aria-activedescendant",this.resultDropDown.id);
}
},_changeActiveDescendantId:function(id){
this.activeDescendantId=id;
this._setActiveDescendant();
},setTypeaheadResults:function(_c,_d){
this.resultDropDown.setResults(_c,_d);
if(_d&&_d.showLogin){
this.resultDropDown.showLogin(_d.showLogin);
}
},showTypeaheadResults:function(){
this.resultDropDown.showResults(this,this.TAdropdownAnchor);
this.TAtextField.parentElement.setAttribute("aria-owns",this.resultDropDown.id);
this._setActiveDescendant();
this.TAtextField.parentElement.setAttribute("aria-expanded","true");
},onFieldBlur:function(_e){
if(this._mouseDown){
this._mouseDown=false;
return;
}
this.resultDropDown.closeResults();
this.TAtextField.removeAttribute("aria-activedescendant");
this.TAtextField.parentElement.setAttribute("aria-expanded","false");
},onFieldFocus:function(_f){
var str=this._lastQuery;
if(str&&!this.TAisPlaceholderActive()){
this.resultDropDown.showResults(this,this.TAdropdownAnchor,true);
this._setActiveDescendant();
this.TAtextField.parentElement.setAttribute("aria-expanded","true");
}
},_TAonMouseDown:function(evt){
if(evt){
dojo.stopEvent(evt);
}
this._mouseDown=true;
setTimeout(dojo.hitch(this,function(){
this.TAtextField.focus();
}),1);
},TAupdateCurrentScope:function(){
this.resultDropDown.setQueryString(this._lastQuery,this.TAscopeLabelNode.innerHTML);
},TAisPlaceholderActive:function(){
return false;
},search:function(){
}});
}


;if(!dojo._hasResource["lconn.core.peopleFinder.DataReader"]){
dojo._hasResource["lconn.core.peopleFinder.DataReader"]=true;
dojo.provide("lconn.core.peopleFinder.DataReader");


dojo.declare("lconn.core.peopleFinder.DataReader",[lconn.core.typeahead.DataReader],{additionalFields:{low:["city","country"],high:["workPhone","tag"]},searchOnlyNameAndEmail:false,mustMatchNameOrEmail:false,disablePhonetics:false,path:"/people/typeahead",resultsId:"persons",_initLastQuery:function(_1){
this.inherited(arguments);
this.lastQuery.additionalFields=JSON.stringify(this.additionalFields);
},executeQuery:function(_2,_3,_4){
var _5=this.inherited(arguments);
_5.then(_3);
_5.otherwise(_4);
},getNextPage:function(_6,_7){
this.lastQuery.page++;
this.executeQuery(null,_6,_7);
},_constructLastQueryString:function(){
return lconn.core.url.rewrite(this.lastQuery.url,{query:(this.lastQuery.query?this.lastQuery.query:undefined),pageSize:this.lastQuery.pageSize,page:(this.lastQuery.page>1?this.lastQuery.page:undefined),additionalFields:this.lastQuery.additionalFields,source:"ic_searchbox_dropdown",highlight:this.highlight,searchOnlyNameAndEmail:this.searchOnlyNameAndEmail,mustMatchNameOrEmail:this.mustMatchNameOrEmail,disablePhonetics:this.disablePhonetics});
}});
}

dojo.provide("com.ibm.social.personcard.widget.nls.strings")._built=true;
dojo.provide("com.ibm.social.personcard.widget.nls.strings.en_us");
com.ibm.social.personcard.widget.nls.strings.en_us={"EXCEEDED_ONE_TAG":"Plus 1 more tag...","EXCEEDED_TAGS":"Plus ${count} more tags...","TAGS_L":"Tags:","TAGS":"TAGS"};
if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.social.personcard"]=true;

;if(!dojo._hasResource["com.ibm.social.personcard.widget.Localization"]){
dojo._hasResource["com.ibm.social.personcard.widget.Localization"]=true;
dojo.provide("com.ibm.social.personcard.widget.Localization");


dojo.requireLocalization("com.ibm.social.personcard.widget","strings");
dojo.declare("com.ibm.social.personcard.widget.Localization",null,{commonStrings:null,postMixInProperties:function(){
this.commonStrings=dojo.i18n.getLocalization("com.ibm.social.personcard.widget","strings");
dojo.mixin(this,this.commonStrings);
this.inherited(arguments);
},getString:function(_1,_2){
return dojo.string.substitute(this.commonStrings[_1],_2);
}});
}


;dojo.cache("com.ibm.social.personcard", "widget/templates/PersonWidget.html", "<div class=\"lconn_personContainer\"> <div class=\"lconn_profileImage\"> <img dojoattachpoint=\"photoNode\" alt=\"\" role=\"presentation\" src=\"${photoUrl}\" style=\"max-width: ${_normalSize}px; max-height: ${_normalSize}px;\"> </div> <div class=\"lconn_profileInfo\"> <div class=\"vcard\"> <a dojoattachpoint=\"linkNode\" href=\"${profileUrl}\" class=\"fn url lotusPerson bidiAware\" title=\"${displayNameEscaped}\">${!displayNameString}</a> <span style=\"display: none;\" class=\"email\">${_escapedMail}</span> <span style=\"display: none;\" class=\"x-lconn-userid\">${userId}</span> </div> <div> <span dojoAttachPoint=\"jobResponsibilityNode\">${!jobResponsibility}</span> </div> <div> <span dojoAttachPoint=\"addressNode\">${!address}</span> </div> <div dojoAttachPoint=\"additionalInfo\" class=\"lconn_additionalInfo lotusHidden\"> <div> <a href=\"mailto:${_escapedMail}\" dojoAttachPoint=\"mailNode\" dojoAttachEvent=\"onclick: _mailClicked\">${!mail}</a> </div> <div> <span dojoAttachPoint=\"phoneNode\">${!phone}</span> </div> </div> <div dojoAttachPoint=\"tagsContainer\" class=\"lotusHidden\"> <span class=\"lconn_highlightedTagsTitle\">${TAGS_L}</span> <div dojoAttachPoint=\"highlightedTags\" class=\"lconn_highlightedTags\">${!tagString}</div> </div> </div></div>");

;dojo.cache("com.ibm.social.personcard", "widget/templates/PersonWidget_medium.html", "<div class=\"lconn_personContainer\"> <div class=\"lconn_profileImage\"> <img dojoattachpoint=\"photoNode\" alt=\"\" role=\"presentation\" src=\"${photoUrl}\" style=\"max-width: ${_bigSize}px; max-height: ${_bigSize}px;\"> </div> <div class=\"lconn_profileInfo lconn_medium_confidence\"> <div class=\"vcard\"> <a dojoattachpoint=\"linkNode\" href=\"${profileUrl}\" class=\"fn url lotusPerson bidiAware\" title=\"${displayNameEscaped}\">${!displayNameString}</a> <span style=\"display: none;\" class=\"email\">${_escapedMail}</span> <span style=\"display: none;\" class=\"x-lconn-userid\">${userId}</span> </div> <div> <span dojoAttachPoint=\"jobResponsibilityNode\">${!jobResponsibility}</span> </div> <div> <span dojoAttachPoint=\"addressNode\">${!address}</span> </div> <div dojoAttachPoint=\"additionalInfo\" class=\"lconn_additionalInfo\"> <div> <a href=\"mailto:${_escapedMail}\" dojoAttachPoint=\"mailNode\" dojoAttachEvent=\"onclick: _mailClicked\">${!mail}</a> </div> <div> <span dojoAttachPoint=\"phoneNode\">${!phone}</span> </div> </div> <div dojoAttachPoint=\"tagsContainer\" class=\"lotusHidden\"> <span class=\"lconn_highlightedTagsTitle\">${TAGS_L}</span> <div dojoAttachPoint=\"highlightedTags\" class=\"lconn_highlightedTags\">${!tagString}</div> </div> </div></div>");

;dojo.cache("com.ibm.social.personcard", "widget/templates/PersonWidget_high.html", "<div class=\"lconn_personContainer\"> <div class=\"lconn_profileImage\"> <img dojoattachpoint=\"photoNode\" alt=\"\" role=\"presentation\" src=\"${photoUrl}\" style=\"max-width: ${_bigSize}px; max-height: ${_bigSize}px;\"> </div> <div class=\"lconn_profileInfo-high\"> <div class=\"vcard\"> <a dojoattachpoint=\"linkNode\" href=\"${profileUrl}\" class=\"fn url lotusPerson bidiAware\" title=\"${displayNameEscaped}\">${!displayNameString}</a> <span style=\"display: none;\" class=\"email\">${_escapedMail}</span> <span style=\"display: none;\" class=\"x-lconn-userid\">${userId}</span> </div> <div> <span dojoAttachPoint=\"jobResponsibilityNode\">${!jobResponsibility}</span> </div> <div> <span dojoAttachPoint=\"addressNode\">${!address}</span> </div> <div dojoAttachPoint=\"additionalInfo\" class=\"lconn_additionalInfo\"> <div> <a href=\"mailto:${_escapedMail}\" dojoAttachPoint=\"mailNode\" dojoAttachEvent=\"onclick: _mailClicked\">${!mail}</a> </div> <div> <span dojoAttachPoint=\"phoneNode\">${!phone}</span> </div> </div> </div> <div class=\"lconn_separator\"></div> <div dojoAttachPoint=\"tagsContainer\" class=\"lconn_tags\"> <div class=\"lconn_title\">${TAGS}</div> <div dojoAttachPoint=\"tagCloudNode\">${!tagString}</div> <div dojoAttachPoint=\"exceededTags\" class=\"lotusHidden\">${!exceedingTagString}</div> <a href=\"javascript:;\" dojoAttachPoint=\"exceededMessage\" class=\"lotusHidden\" dojoAttachEvent=\"onclick: showExceedingTags\"></a> </div></div>");

;dojo.cache("com.ibm.social.personcard", "widget/templates/PersonWidget_compact.html", "<div class=\"lconn_personContainer compact\"> <div class=\"lconn_profileImage\"> <img class=\"lconn_userImage\" dojoattachpoint=\"photoNode\" alt=\"\" role=\"presentation\" src=\"${photoUrl}\" style=\"max-width: ${_compactSize}px; max-height: ${_compactSize}px;\"> </div> <div class=\"lconn_profileInfo\"> <div> <span class=\"lconn_title\" dojoattachpoint=\"linkNode\">${!displayNameString}</span> <a class=\"lconn_title\" dojoattachpoint=\"hiddenLinkNode\" href=\"${profileUrl}\" style=\"display: none;\">${!displayNameString}</a> </div> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"jobResponsibilityNode\">${!jobResponsibility}</span> </div> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"addressNode\">${!address}</span> </div> </div></div>");

;dojo.cache("com.ibm.social.personcard", "widget/templates/PersonWidget_medium_compact.html", "<div class=\"lconn_personContainer compact\"> <div class=\"lconn_profileImage\"> <img class=\"lconn_userImage\" dojoattachpoint=\"photoNode\" alt=\"\" role=\"presentation\" src=\"${photoUrl}\" style=\"max-width: ${_compactSize}px; max-height: ${_compactSize}px;\"> </div> <div class=\"lconn_profileInfo\"> <div> <span class=\"lconn_title\" dojoattachpoint=\"linkNode\">${!displayNameString}</span> <a class=\"lconn_title\" dojoattachpoint=\"hiddenLinkNode\" href=\"${profileUrl}\" style=\"display: none;\">${!displayNameString}</a> </div> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"jobResponsibilityNode\">${!jobResponsibility}</span> </div> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"addressNode\">${!address}</span> </div> <div class=\"lconn_additionalInfo-compact lconn_gray\"> <div> <span dojoAttachPoint=\"mailNode\">${!mail}</span> </div> <div> <span dojoAttachPoint=\"phoneNode\">${!phone}</span> </div> </div> </div></div>");

;dojo.cache("com.ibm.social.personcard", "widget/templates/PersonWidget_high_compact.html", "<div class=\"lconn_personContainer compact\"> <div class=\"lconn_profileImage\"> <img class=\"lconn_userImage\" dojoattachpoint=\"photoNode\" alt=\"\" role=\"presentation\" src=\"${photoUrl}\" style=\"max-width: ${_compactSize}px; max-height: ${_compactSize}px;\"> </div> <div class=\"lconn_profileInfo\"> <div> <span class=\"lconn_title\" dojoattachpoint=\"linkNode\">${!displayNameString}</span> <a class=\"lconn_title\" dojoattachpoint=\"hiddenLinkNode\" href=\"${profileUrl}\" style=\"display: none;\">${!displayNameString}</a> </div> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"jobResponsibilityNode\">${!jobResponsibility}</span> </div> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"addressNode\">${!address}</span> </div> <div class=\"lconn_additionalInfo-compact lconn_gray\"> <div> <span dojoAttachPoint=\"mailNode\">${!mail}</span> </div> <div> <span dojoAttachPoint=\"phoneNode\">${!phone}</span> </div> </div> <div class=\"lconn_separator-compact\"></div> <div dojoAttachPoint=\"tagsContainer\" class=\"lconn_tags-compact lconn_gray\"> <div dojoAttachPoint=\"tagCloudNode\">${!tagString}</div> </div> </div></div>");

;dojo.cache("com.ibm.social.personcard", "widget/templates/PersonWidget_compactFocusable.html", "<div class=\"lconn_personContainer compact\"> <div class=\"lconn_profileImage\"> <img class=\"lconn_userImage\" dojoattachpoint=\"photoNode\" alt=\"\" role=\"presentation\" src=\"${photoUrl}\" style=\"max-width: ${_compactSize}px; max-height: ${_compactSize}px;\"> </div> <div class=\"lconn_profileInfo\"> <div> <span class=\"lconn_title\" style=\"display: none;\" dojoattachpoint=\"linkNode\">${!displayNameString}</span> <a class=\"lconn_title\" href=\"${profileUrl}\" aria-describedby=\"${id}_metaData\" dojoattachpoint=\"hiddenLinkNode\" dojoattachevent=\"onclick: linkClicked, onfocus: onEntryFocused\">${!displayNameString}</a> </div> <div id=\"${id}_metaData\" dojoAttachPoint=\"metaDataNode\"> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"jobResponsibilityNode\">${!jobResponsibility}</span> </div> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"addressNode\">${!address}</span> </div> </div> </div></div>");

;dojo.cache("com.ibm.social.personcard", "widget/templates/PersonWidget_medium_compactFocusable.html", "<div class=\"lconn_personContainer compact\"> <div class=\"lconn_profileImage\"> <img class=\"lconn_userImage\" dojoattachpoint=\"photoNode\" alt=\"\" role=\"presentation\" src=\"${photoUrl}\" style=\"max-width: ${_compactSize}px; max-height: ${_compactSize}px;\"> </div> <div class=\"lconn_profileInfo\"> <div> <span class=\"lconn_title\" style=\"display: none;\" dojoattachpoint=\"linkNode\">${!displayNameString}</span> <a class=\"lconn_title\" href=\"${profileUrl}\" aria-describedby=\"${id}_metaData\" dojoattachpoint=\"hiddenLinkNode\" dojoattachevent=\"onclick: linkClicked, onfocus: onEntryFocused\">${!displayNameString}</a> </div> <div id=\"${id}_metaData\" dojoAttachPoint=\"metaDataNode\"> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"jobResponsibilityNode\">${!jobResponsibility}</span> </div> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"addressNode\">${!address}</span> </div> <div class=\"lconn_additionalInfo-compact lconn_gray\"> <div> <a href=\"mailto:${_escapedMail}\" dojoAttachPoint=\"mailNode\" dojoattachevent=\"onclick: linkClicked, onfocus: onEntryFocused\">${!mail}</a> </div> <div> <span dojoAttachPoint=\"phoneNode\">${!phone}</span> </div> </div> </div> </div></div>");

;dojo.cache("com.ibm.social.personcard", "widget/templates/PersonWidget_high_compactFocusable.html", "<div class=\"lconn_personContainer compact\"> <div class=\"lconn_profileImage\"> <img class=\"lconn_userImage\" dojoattachpoint=\"photoNode\" alt=\"\" role=\"presentation\" src=\"${photoUrl}\" style=\"max-width: ${_compactSize}px; max-height: ${_compactSize}px;\"> </div> <div class=\"lconn_profileInfo\"> <div> <span class=\"lconn_title\" style=\"display: none;\" dojoattachpoint=\"linkNode\">${!displayNameString}</span> <a class=\"lconn_title\" href=\"${profileUrl}\" aria-describedby=\"${id}_metaData\" dojoattachpoint=\"hiddenLinkNode\" dojoattachevent=\"onclick: linkClicked, onfocus: onEntryFocused\">${!displayNameString}</a> </div> <div id=\"${id}_metaData\" dojoAttachPoint=\"metaDataNode\"> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"jobResponsibilityNode\">${!jobResponsibility}</span> </div> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"addressNode\">${!address}</span> </div> <div class=\"lconn_additionalInfo-compact lconn_gray\"> <div> <a href=\"mailto:${_escapedMail}\" dojoAttachPoint=\"mailNode\" dojoattachevent=\"onclick: linkClicked, onfocus: onEntryFocused\">${!mail}</a> </div> <div> <span dojoAttachPoint=\"phoneNode\">${!phone}</span> </div> </div> <div class=\"lconn_separator-compact\"></div> <div dojoAttachPoint=\"tagsContainer\" class=\"lconn_tags-compact lconn_gray\"> <div dojoAttachPoint=\"tagCloudNode\">${!tagString}</div> </div> </div> </div></div>");

;if(!dojo._hasResource["com.ibm.social.personcard.widget.PersonWidget"]){
dojo._hasResource["com.ibm.social.personcard.widget.PersonWidget"]=true;
dojo.provide("com.ibm.social.personcard.widget.PersonWidget");












dojo.declare("com.ibm.social.personcard.widget.PersonWidget",[dijit._Widget,dijit._Templated,com.ibm.social.personcard.widget.Localization],{templatePath:dojo.moduleUrl("com.ibm.social.personcard","widget/templates/PersonWidget.html"),medium_templatePath:dojo.moduleUrl("com.ibm.social.personcard","widget/templates/PersonWidget_medium.html"),high_templatePath:dojo.moduleUrl("com.ibm.social.personcard","widget/templates/PersonWidget_high.html"),compact_templatePath:dojo.moduleUrl("com.ibm.social.personcard","widget/templates/PersonWidget_compact.html"),mediumCompact_templatePath:dojo.moduleUrl("com.ibm.social.personcard","widget/templates/PersonWidget_medium_compact.html"),highCompact_templatePath:dojo.moduleUrl("com.ibm.social.personcard","widget/templates/PersonWidget_high_compact.html"),compactFocusable_templatePath:dojo.moduleUrl("com.ibm.social.personcard","widget/templates/PersonWidget_compactFocusable.html"),mediumCompactFocusable_templatePath:dojo.moduleUrl("com.ibm.social.personcard","widget/templates/PersonWidget_medium_compactFocusable.html"),highCompactFocusable_templatePath:dojo.moduleUrl("com.ibm.social.personcard","widget/templates/PersonWidget_high_compactFocusable.html"),HIGH_CONFIDENCE:"high",MEDIUM_CONFIDENCE:"medium",LOW_CONFIDENCE:"low",profileUrl:"",photoUrl:"",userId:"",displayNameString:"",displayNameEscaped:"",preferredName:"",givenNames:null,jobResponsibility:"",mail:"",_escapedMail:"",address:"",phone:"",tags:null,tagString:"",_exceededTagsCount:-1,exceedingTagString:"",maxTags:20,compact:false,maxTagsInCompact:3,confidence:"",isFocusable:false,_compactSize:40,_normalSize:60,_bigSize:128,constructor:function(_1){
this._setValues(_1);
this._chooseTemplate();
},postCreate:function(){
this.connect(this.linkNode,"onfocus","_nameFocused");
if(!this.compact){
if(this.confidence==this.LOW_CONFIDENCE||this.confidence==this.MEDIUM_CONFIDENCE){
if(this.mail.match(/(<b>|<\/b>)/ig)||this.phone.match(/(<b>|<\/b>)/ig)){
dojo.removeClass(this.additionalInfo,"lotusHidden");
}
if(this.tags){
dojo.removeClass(this.tagsContainer,"lotusHidden");
}
}
if(this.mailNode&&!this.mail){
dojo.addClass(this.mailNode,"lotusHidden");
}
}
if(this.tagsContainer){
var _2=[];
if(dojo.isIE<=8){
_2=this.tagsContainer.querySelectorAll(".tag");
}else{
_2=this.tagsContainer.getElementsByClassName("tag");
}
for(var i=0;i<_2.length;i++){
this.connect(_2[i],"onclick","_tagClicked");
}
}
if(this._exceededTagsCount>0&&this.exceededMessage){
this.exceededMessage.innerHTML=this._exceededTagsCount>1?this.getString("EXCEEDED_TAGS",{count:this._exceededTagsCount}):this.getString("EXCEEDED_ONE_TAG");
dojo.removeClass(this.exceededMessage,"lotusHidden");
dojo.addClass(this.exceededMessage,"exceededMessage");
}
this.inherited(arguments);
},_setValues:function(_3){
if(_3.maxTags){
this.maxTags=_3.maxTags;
}
if(_3.maxTagsInCompact){
this.maxTagsInCompact=_3.maxTagsInCompact;
}
this.isFocusable=_3.isFocusable?true:false;
this.compact=_3.compact?true:false;
this.userId=_3.userId?_3.userId:"NULL";
this.preferredName=_3.preferredName?_3.preferredName:"";
this.givenNames=_3.givenNames?_3.givenNames:null;
this.displayNameString=_3.displayName?_3.displayName:"";
if(!this.preferredName&&this.givenNames){
for(var i=0;i<this.givenNames.length&&!this.preferredName;i++){
var gn=this.givenNames[i].match(/<b>\w*<\/b>/i);
if(!gn){
continue;
}
var _4=new RegExp(gn[0],"i");
if(!this.displayNameString.match(_4)){
this.preferredName=this.givenNames[i];
}
}
}
if(this.preferredName){
this.displayNameString+=" ("+this.preferredName+")\u200e";
}
this.displayNameEscaped=this.displayNameString.replace(/(<b>|<\/b>)/ig,"");
this.jobResponsibility=_3.jobResponsibility?_3.jobResponsibility:"";
this.mail=_3.mail?_3.mail:"";
this._escapedMail=this.mail.replace(/(<b>|<\/b>)/ig,"");
this.address=_3.address?_3.address:"";
this.phone=_3.phone?_3.phone:"";
this.tags=_3.tags?_3.tags:null;
this.confidence=_3.confidence;
if(!this.compact&&_3.tags){
var t=_3.tags;
for(var i=0;i<t.length;i++){
t[i]=lconn.core.globalization.bidiUtil.enforceTextDirection(t[i],document.dir);
}
var _5=t.slice(0,this.maxTags);
var _6=t.slice(this.maxTags);
this._exceededTagsCount=_6.length;
this.tagString="<a href='javascript:;' class='tag'>"+_5.join("</a>, <a href='javascript:;' class='tag'>")+"</a>";
if(this._exceededTagsCount>0){
this.exceedingTagString="<a href='javascript:;' class='tag'>"+_6.join("</a>, <a href='javascript:;' class='tag'>")+"</a>";
}
}else{
if(_3.tags){
var t=_3.tags;
for(var i=0;i<t.length;i++){
t[i]=lconn.core.globalization.bidiUtil.enforceTextDirection(t[i],document.dir);
}
var _5=t.slice(0,this.maxTagsInCompact);
this.tagString="<span class='tag'>"+_5.join("</span>, <span class='tag'>")+"</span>"+(_3.tags.length>this.maxTagsInCompact?"...":"");
}
}
},_chooseTemplate:function(){
this.profileUrl=com.ibm.lconn.layout.people.getProfileUrl({userid:this.userId});
if(this.compact){
this.photoUrl=lconn.core.widgetUtils.addVersionNumber(com.ibm.lconn.layout.people.getImageUrl({userid:this.userId},this._compactSize));
this.templatePath=this.isFocusable?this.compactFocusable_templatePath:this.compact_templatePath;
if(((this.mail&&(this.confidence==this.MEDIUM_CONFIDENCE||this.confidence==this.HIGH_CONFIDENCE))||this.phone)&&!this.tags){
this.templatePath=this.isFocusable?this.mediumCompactFocusable_templatePath:this.mediumCompact_templatePath;
}
if(this.tags){
this.templatePath=this.isFocusable?this.highCompactFocusable_templatePath:this.highCompact_templatePath;
}
}else{
var _7=this.confidence==this.LOW_CONFIDENCE?this._normalSize:this._bigSize;
if(this.confidence==this.MEDIUM_CONFIDENCE){
this.templatePath=this.medium_templatePath;
}else{
if(this.confidence==this.HIGH_CONFIDENCE){
this.templatePath=this.high_templatePath;
}
}
this.photoUrl=lconn.core.widgetUtils.addVersionNumber(com.ibm.lconn.layout.people.getImageUrl({userid:this.userId},_7));
}
},showExceedingTags:function(_8){
if(_8){
dojo.stopEvent(_8);
}
dojo.addClass(this.exceededMessage,"lotusHidden");
dojo.removeClass(this.exceededMessage,"exceededMessage");
dojo.removeClass(this.exceededTags,"lotusHidden");
},_tagClicked:function(_9){
if(_9){
dojo.stopEvent(_9);
}
var _a=_9.target;
if(!dojo.hasClass(_a,"tag")){
_a=_a.parentElement;
}
this.onTagClicked(_a.innerHTML.replace(/(<b>|<\/b>)/ig,""));
},_nameFocused:function(_b){
if(_b){
dojo.stopEvent(_b);
}
this.onNameFocused(this.domNode);
},_mailClicked:function(_c){
if(_c){
if(dojo.isIE<=8){
_c.cancelBubble();
}else{
_c.stopPropagation();
}
}
},personClick:function(){
if(this.compact){
this.hiddenLinkNode.click();
}else{
this.linkNode.click();
}
},linkClicked:function(_d){
if(_d){
_d.stopPropagation();
}
},onTagClicked:function(_e){
},onNameFocused:function(_f){
},onEntryFocused:function(evt){
}});
}

dojo.provide("lconn.core.peopleFinder.directory.nls.PeopleFinderService")._built=true;
dojo.provide("lconn.core.peopleFinder.directory.nls.PeopleFinderService.en_us");
lconn.core.peopleFinder.directory.nls.PeopleFinderService.en_us={"DIRECTORY_RESULTS":"DIRECTORY","MORE_DIRECTORY_ARIA_LABEL":"Selecting this option will bring you to the Profile Directory page","MORE_DIRECTORY_RESULTS":"More Directory Results...","ENTRY_ARIA_LABEL":"Directory entry. Selecting this option will bring you to the person Profile page"};

;if(!dojo._hasResource["lconn.core.peopleFinder.directory.PeopleFinderService"]){
dojo._hasResource["lconn.core.peopleFinder.directory.PeopleFinderService"]=true;
dojo.provide("lconn.core.peopleFinder.directory.PeopleFinderService");












dojo.requireLocalization("lconn.core.peopleFinder.directory","PeopleFinderService");
dojo.declare("lconn.core.peopleFinder.directory.PeopleFinderService",[lconn.core.typeahead.Service],{additionalFields:null,resultsNumber:4,highlight:true,searchOnlyNameAndEmail:false,mustMatchNameOrEmail:false,escapeLowConfidence:true,minToDisplay:1,lengthToIgnoreMin:3,postMixInProperties:function(){
this.inherited(arguments);
this.strings=dojo.i18n.getLocalization("lconn.core.peopleFinder.directory","PeopleFinderService");
dojo.mixin(this,this.strings);
},postCreate:function(){
if(!this.isDisabled){
this.isDisabled=(lconn.core.auth.getUser()&&lconn.core.auth.getUser().isExternal);
}
this._dataReader=new lconn.core.peopleFinder.DataReader({pageSize:this.resultsNumber,highlight:this.highlight,searchOnlyNameAndEmail:this.searchOnlyNameAndEmail,mustMatchNameOrEmail:this.mustMatchNameOrEmail});
if(this.additionalFields){
dojo.mixin(this._dataReader.additionalFields,this.additionalFields);
}
this._dataReader.startup();
this.header=document.createElement("div");
dojo.addClass(this.header,"pfTitle");
this.header.innerHTML=this.DIRECTORY_RESULTS;
this.footer=document.createElement("div");
this.footer.setAttribute("aria-describedby",this.id+"_moreDirectoryAria");
dojo.addClass(this.footer,"pfDirectoryLink");
var _1=document.createElement("span");
dojo.addClass(_1,"pfLinkNode");
_1.innerHTML=this.MORE_DIRECTORY_RESULTS;
this.footer.appendChild(_1);
this.connect(this.footer,"onclick","redirectToDirectory");
},executeQuery:function(_2){
var _3=new dojo.Deferred();
if(this.isDisabled){
this._handleDisabled(_3);
}else{
if(this.isLoginNeeded&&!lconn.core.auth.isAuthenticated()){
this._handleLogin(_3);
}else{
this._dataReader.executeQuery(_2,dojo.hitch(this,"_handleResults",_3,_2),dojo.hitch(this,"_handleError",_3));
}
}
return _3.promise;
},initResults:function(_4){
var _5={high:[],medium:[],low:[]};
for(var i=0;i<_4.length;i++){
if(this.escapeLowConfidence&&_4[i].confidence=="low"){
continue;
}
var _6=new com.ibm.social.personcard.widget.PersonWidget({userId:(_4[i].id?_4[i].id:""),displayName:(_4[i].name?_4[i].name:""),preferredName:(_4[i].preferredFirstName?_4[i].preferredFirstName:""),givenNames:(_4[i].givenNames?_4[i].givenNames:null),jobResponsibility:(_4[i].jobResponsibility?_4[i].jobResponsibility:""),mail:(_4[i].email?_4[i].email:""),address:(_4[i].city?_4[i].city:"")+(_4[i].city&&_4[i].country?", ":"")+(_4[i].country?_4[i].country:""),phone:(_4[i].workPhone?_4[i].workPhone:""),tags:(_4[i].confidence&&_4[i].confidence=="high"?_4[i].tag:null),compact:true,confidence:_4[i].confidence?_4[i].confidence:"low",isFocusable:this.isFocusable});
_6.startup();
this._createdWidgets.push(_6);
if(this.useAriaNodes){
_6.domNode.setAttribute("aria-describedby",this.id+"_entryAria");
}
_6.connect(_6.domNode,"onclick",dojo.hitch(this,"entrySelected",_6));
_6.connect(_6,"linkClicked",dojo.hitch(this,"entryClicked",_6));
if(this.isFocusable){
_6.connect(_6,"onEntryFocused",dojo.hitch(this,"focusCallback",_6.domNode));
}
_5[_6.confidence].push(_6.domNode);
}
return _5;
},initAriaNodes:function(){
var _7=document.createElement("div");
dojo.addClass(_7,"lotusHidden");
_7.innerHTML=this.ENTRY_ARIA_LABEL;
_7.id=this.id+"_entryAria";
var _8=document.createElement("div");
dojo.addClass(_8,"lotusHidden");
_8.innerHTML=this.MORE_DIRECTORY_ARIA_LABEL;
_8.id=this.id+"_moreDirectoryAria";
return [_7,_8];
},entrySelected:function(_9,_a){
_9.personClick();
},entryClicked:function(_b,_c){
},redirectToDirectory:function(){
var _d=this.getDirectoryLink();
_d+="#q="+encodeURIComponent(this._dataReader.lastQuery.query);
window.location=_d;
},getDirectoryLink:function(){
var _e=lconn.core.url.getServiceUrl(lconn.core.config.services.profiles)||lconn.core.url.getServiceUrl(lconn.core.config.services.scprofiles).toString().replace(/\/contacts/,"");
_e+="/html/searchProfiles.do";
return _e;
}});
}


;if(!dojo._hasResource["lconn.core.quickResults.DataReader"]){
dojo._hasResource["lconn.core.quickResults.DataReader"]=true;
dojo.provide("lconn.core.quickResults.DataReader");


dojo.declare("lconn.core.quickResults.DataReader",[lconn.core.typeahead.DataReader],{disableSpellingCorrection:false,path:"/quickresults/typeahead",resultsId:"pages",_constructLastQueryString:function(){
return lconn.core.url.rewrite(this.lastQuery.url,{query:(this.lastQuery.query?this.lastQuery.query:undefined),pageSize:this.lastQuery.pageSize,page:(this.lastQuery.page>1?this.lastQuery.page:undefined),highlight:this.highlight,disableSpellingCorrection:this.disableSpellingCorrection});
}});
}

dojo.provide("lconn.core.quickResults.nls.GenericEntry")._built=true;
dojo.provide("lconn.core.quickResults.nls.GenericEntry.en_us");
lconn.core.quickResults.nls.GenericEntry.en_us={"BOOKMARK_VIEWED_HOURS_AGO":"Bookmark viewed ${hours} hours ago","FILE_VIEWED_TODAY":"File viewed today","BLOG_VIEWED_SECONDS_AGO":"Blog viewed ${seconds} seconds ago","EVENT_VIEWED_YESTERDAY":"Event viewed yesterday","PROFILE_VIEWED_1_SECOND_AGO":"Profile viewed 1 second ago","PROFILE_VIEWED_HOURS_AGO":"Profile viewed ${hours} hours ago","ACTIVITY_VIEWED_YESTERDAY":"Activity viewed yesterday","TODO_VIEWED_AT_DATE":"To Do viewed ${date}","BLOG_VIEWED_1_HOUR_AGO":"Blog viewed 1 hour ago","BLOG_VIEWED_HOURS_AGO":"Blog viewed ${hours} hours ago","PROFILE_VIEWED_TODAY":"Profile viewed today","FILE_VIEWED_AT_DATE":"File viewed ${date}","EVENT_VIEWED_1_MINUTE_AGO":"Event viewed 1 minute ago","FILE_VIEWED_1_MINUTE_AGO":"File viewed 1 minute ago","PROFILE_VIEWED_MINUTES_AGO":"Profile viewed ${minutes} minutes ago","BOOKMARK_VIEWED_AT_DATE":"Bookmark viewed ${date}","FORUM_VIEWED_1_MINUTE_AGO":"Forum viewed 1 minute ago","ACTIVITY_VIEWED_AT_DATE":"Activity viewed ${date}","EVENT_VIEWED_SECONDS_AGO":"Event viewed ${seconds} seconds ago","COMMUNITY_VIEWED_AT_DATE":"Community viewed ${date}","ACTIVITY_VIEWED_1_MINUTE_AGO":"Activity viewed 1 minute ago","BLOG_VIEWED_AT_DATE":"Blog viewed ${date}","WIKI_VIEWED_SECONDS_AGO":"Wiki viewed ${seconds} seconds ago","BOOKMARK_VIEWED_1_SECOND_AGO":"Bookmark viewed 1 second ago","PROFILE_VIEWED_1_HOUR_AGO":"Profile viewed 1 hour ago","EVENT_VIEWED_HOURS_AGO":"Event viewed ${hours} hours ago","ACTIVITY_VIEWED_1_HOUR_AGO":"Activity viewed 1 hour ago","TODO_VIEWED_MINUTES_AGO":"To Do viewed ${minutes} minutes ago","FILE_VIEWED_YESTERDAY":"File viewed yesterday","BLOG_VIEWED_1_MINUTE_AGO":"Blog viewed 1 minute ago","FORUM_VIEWED_SECONDS_AGO":"Forum viewed ${seconds} seconds ago","ACTIVITY_VIEWED_HOURS_AGO":"Activity viewed ${hours} hours ago","TODO_VIEWED_1_SECOND_AGO":"To Do viewed 1 second ago","COMMUNITY_VIEWED_1_SECOND_AGO":"Community viewed 1 second ago","FILE_VIEWED_MINUTES_AGO":"File viewed ${minutes} minutes ago","WIKI_VIEWED_TODAY":"Wiki viewed today","ACTIVITY_VIEWED_TODAY":"Activity viewed today","BOOKMARK_VIEWED_MINUTES_AGO":"Bookmark viewed ${minutes} minutes ago","WIKI_VIEWED_1_MINUTE_AGO":"Wiki viewed 1 minute ago","EVENT_VIEWED_AT_DATE":"Event viewed ${date}","FORUM_VIEWED_YESTERDAY":"Forum viewed yesterday","BLOG_VIEWED_MINUTES_AGO":"Blog viewed ${minutes} minutes ago","WIKI_VIEWED_AT_DATE":"Wiki viewed ${date}","FILE_VIEWED_1_HOUR_AGO":"File viewed 1 hour ago","PROFILE_VIEWED_AT_DATE":"Profile viewed ${date}","UPDATED_BY":"Updated by ${author}","ACTIVITY_VIEWED_SECONDS_AGO":"Activity viewed ${seconds} seconds ago","TODO_VIEWED_TODAY":"To Do viewed today","COMMUNITY_VIEWED_1_HOUR_AGO":"Community viewed 1 hour ago","FILE_VIEWED_HOURS_AGO":"File viewed ${hours} hours ago","EVENT_VIEWED_1_SECOND_AGO":"Event viewed 1 second ago","COMMUNITY_VIEWED_SECONDS_AGO":"Community viewed ${seconds} seconds ago","FILE_VIEWED_1_SECOND_AGO":"File viewed 1 second ago","FORUM_VIEWED_1_SECOND_AGO":"Forum viewed 1 second ago","BOOKMARK_VIEWED_TODAY":"Bookmark viewed today","EVENT_VIEWED_MINUTES_AGO":"Event viewed ${minutes} minutes ago","WIKI_VIEWED_YESTERDAY":"Wiki viewed yesterday","ACTIVITY_VIEWED_1_SECOND_AGO":"Activity viewed 1 second ago","FORUM_VIEWED_HOURS_AGO":"Forum viewed ${hours} hours ago","COMMUNITY_VIEWED_YESTERDAY":"Community viewed yesterday","WIKI_VIEWED_MINUTES_AGO":"Wiki viewed ${minutes} minutes ago","BLOG_VIEWED_TODAY":"Blog viewed today","FORUM_VIEWED_TODAY":"Forum viewed today","WIKI_VIEWED_1_HOUR_AGO":"Wiki viewed 1 hour ago","BLOG_VIEWED_1_SECOND_AGO":"Blog viewed 1 second ago","FORUM_VIEWED_MINUTES_AGO":"Forum viewed ${minutes} minutes ago","BOOKMARK_VIEWED_1_HOUR_AGO":"Bookmark viewed 1 hour ago","PROFILE_VIEWED_1_MINUTE_AGO":"Profile viewed 1 minute ago","WIKI_VIEWED_1_SECOND_AGO":"Wiki viewed 1 second ago","FORUM_VIEWED_1_HOUR_AGO":"Forum viewed 1 hour ago","TODO_VIEWED_1_HOUR_AGO":"To Do viewed 1 hour ago","TODO_VIEWED_YESTERDAY":"To Do viewed yesterday","PROFILE_VIEWED_SECONDS_AGO":"Profile viewed ${seconds} seconds ago","EVENT_VIEWED_TODAY":"Event viewed today","WIKI_VIEWED_HOURS_AGO":"Wiki viewed ${hours} hours ago","BOOKMARK_VIEWED_YESTERDAY":"Bookmark viewed yesterday","COMMUNITY_VIEWED_HOURS_AGO":"Community viewed ${hours} hours ago","COMMUNITY_VIEWED_TODAY":"Community viewed today","PROFILE_VIEWED_YESTERDAY":"Profile viewed yesterday","ACTIVITY_VIEWED_MINUTES_AGO":"Activity viewed ${minutes} minutes ago","BOOKMARK_VIEWED_1_MINUTE_AGO":"Bookmark viewed 1 minute ago","COMMUNITY_VIEWED_MINUTES_AGO":"Community viewed ${minutes} minutes ago","BLOG_VIEWED_YESTERDAY":"Blog viewed yesterday","TODO_VIEWED_SECONDS_AGO":"To Do viewed ${seconds} seconds ago","TODO_VIEWED_1_MINUTE_AGO":"To Do viewed 1 minute ago","PREVIEW_MODE_ONLY":"(Preview Mode Only)","COMMUNITY_VIEWED_1_MINUTE_AGO":"Community viewed 1 minute ago","FILE_VIEWED_SECONDS_AGO":"File viewed ${seconds} seconds ago","EVENT_VIEWED_1_HOUR_AGO":"Event viewed 1 hour ago","BOOKMARK_VIEWED_SECONDS_AGO":"Bookmark viewed ${seconds} seconds ago","TODO_VIEWED_HOURS_AGO":"To Do viewed ${hours} hours ago","FORUM_VIEWED_AT_DATE":"Forum viewed ${date}"};

;dojo.cache("lconn.core", "quickResults/templates/GenericEntry.html", "<div class=\"lconn_personContainer compact\"> <div class=\"lconn_profileImage\"> <img class=\"${_additionalClass}\" dojoattachpoint=\"photoNode\" alt=\"\" role=\"presentation\" src=\"${photoUrl}\" style=\"max-width: 40px; max-height: 40px;\"> </div> <div class=\"lconn_profileInfo\"> <div> <span class=\"lconn_title\" dojoattachpoint=\"linkNode\">${!entryTitle}</span> <a class=\"lconn_title\" dojoattachpoint=\"hiddenLinkNode\" dojoattachevent=\"onclick: linkClicked\" href=\"${resourceUrl}\" style=\"display: none;\">${!entryTitle}</a> </div> <div id=\"${id}_metaData\" dojoAttachPoint=\"metaDataNode\"> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"detailsNode\">${details}</span> </div> <div class=\"lconn_gray\"> <span dojoAttachPoint=\"authorNode\">${_authorString}</span> <span class=\"lotusHidden\" dojoAttachPoint=\"_separator\"> | </span> <span class=\"lotusHidden\" dojoAttachPoint=\"dateNode\">${_dateString}</span> <span class=\"lotusHidden\" dojoAttachPoint=\"previewOnlyNode\">${PREVIEW_MODE_ONLY}</span> </div> </div> </div></div>");

;if(!dojo._hasResource["lconn.core.quickResults.GenericEntry"]){
dojo._hasResource["lconn.core.quickResults.GenericEntry"]=true;
dojo.provide("lconn.core.quickResults.GenericEntry");






















dojo.requireLocalization("lconn.core.quickResults","GenericEntry");
dojo.declare("lconn.core.quickResults.GenericEntry",[dijit._Widget,dijit._Templated],{templatePath:dojo.moduleUrl("lconn.core","quickResults/templates/GenericEntry.html"),contentId:"",entryTitle:"",details:"",author:"",date:null,source:"",itemType:"",isUpdate:false,resourceUrl:"",photoUrl:"",fileType:"",isFocusable:false,_strings:null,_authorString:"",_dateString:"",_additionalClass:"",postMixInProperties:function(){
this.inherited(arguments);
if(this.source=="updates"){
this.isUpdate=true;
}
this._strings=dojo.i18n.getLocalization("lconn.core.quickResults","GenericEntry");
dojo.mixin(this,this._strings);
this._initStrings();
this._initIcon();
},_initStrings:function(){
this._authorString=this.isUpdate?dojo.string.substitute(this.UPDATED_BY,{author:this.author}):this.author;
var _1=this._getEntryTypeString();
if(this.date&&_1){
var _2=new Date();
switch(dojo.date.difference(_2,this.date,"day")){
case 0:
var _3;
if((_3=dojo.date.difference(this.date,_2,"hour"))>0){
var _4=_3==1?this._strings[_1+"VIEWED_1_HOUR_AGO"]:this._strings[_1+"VIEWED_HOURS_AGO"];
this._dateString=dojo.string.substitute(_4,{hours:_3});
}else{
if((_3=dojo.date.difference(this.date,_2,"minute"))>0){
var _4=_3==1?this._strings[_1+"VIEWED_1_MINUTE_AGO"]:this._strings[_1+"VIEWED_MINUTES_AGO"];
this._dateString=dojo.string.substitute(_4,{minutes:_3});
}else{
_3=dojo.date.difference(this.date,_2,"second");
var _4="";
if(_3<1){
_4=this._strings[_1+"VIEWED_TODAY"];
}else{
if(_3==1){
_4=this._strings[_1+"VIEWED_1_SECOND_AGO"];
}else{
_4=this._strings[_1+"VIEWED_SECONDS_AGO"];
}
}
this._dateString=dojo.string.substitute(_4,{seconds:_3});
}
}
break;
case -1:
this._dateString=this._strings[_1+"VIEWED_YESTERDAY"];
break;
default:
this._dateString=dojo.string.substitute(this._strings[_1+"VIEWED_AT_DATE"],{date:lconn.core.DateUtil.toString(this.date)});
break;
}
}
},_initIcon:function(){
switch(this.source.toLowerCase()){
case "communities":
var _5=lconn.core.url.getServiceUrl(lconn.core.config.services.communities);
this.photoUrl=_5+"/service/html/image?communityUuid="+this.contentId+"&showDefaultForNoPermissions=true";
break;
case "files":
case "ecm":
this.photoUrl=this._blankGif;
if(this.itemType.toLowerCase()=="files_folder"){
this._additionalClass="lconnSprite-iconFolderClose32";
}else{
var _6=this.fileType;
var _7=this.entryTitle.replace(/(<b>|<\/b>)/ig,"");
if(!this.fileType&&_7.match(/.*[.](\w*)$/i)){
_6=_7.match(/.*[.](\w*)$/i)[1];
}
this._additionalClass="lconn-ftype32 lconn-ftype32-"+_6;
}
this.entryTitle=lconn.core.globalization.bidiUtil.enforceTextDirection(this.entryTitle,lconn.core.globalization.config.TEXT_DIRECTION.LEFT_TO_RIGHT);
break;
case "profiles":
this.photoUrl=lconn.core.widgetUtils.addVersionNumber(com.ibm.lconn.layout.people.getImageUrl({userid:this.contentId},40));
this._additionalClass="lconn_userImage";
break;
case "activities":
this.photoUrl=this._blankGif;
if(this.itemType.toLowerCase()=="activities_todo"){
this._additionalClass="lconnSprite-iconTodos30";
}else{
this._additionalClass="lconnSprite-iconActivities30";
}
break;
case "bookmarks":
this.photoUrl=this._blankGif;
this._additionalClass="lconnSprite-iconBookmarks30";
break;
case "blogs":
case "ideationblog":
this.photoUrl=this._blankGif;
this._additionalClass="lconnSprite-iconBlogs30";
break;
case "forums":
this.photoUrl=this._blankGif;
this._additionalClass="lconnSprite-iconForums30";
break;
case "wikis":
this.photoUrl=this._blankGif;
this._additionalClass="lconnSprite-iconWikis30";
break;
case "calendar":
this.photoUrl=this._blankGif;
this._additionalClass="lconnSprite-iconCalendar30";
break;
}
},_getEntryTypeString:function(){
var _8="";
switch(this.source.toLowerCase()){
case "communities":
_8="COMMUNITY_";
break;
case "files":
case "ecm":
_8="FILE_";
break;
case "profiles":
_8="PROFILE_";
break;
case "activities":
_8="ACTIVITY_";
break;
case "bookmarks":
_8="BOOKMARK_";
break;
case "blogs":
case "ideationblog":
_8="BLOG_";
break;
case "forums":
_8="FORUM_";
break;
case "wikis":
_8="WIKI_";
break;
case "todos":
_8="TODO_";
break;
case "calendar":
_8="EVENT_";
break;
}
return _8;
},startup:function(){
if(this.date){
dojo.removeClass(this.dateNode,"lotusHidden");
}
if(this.date&&this._authorString){
dojo.removeClass(this._separator,"lotusHidden");
}
if(this.source.toLowerCase()=="files"){
dojo.addClass(this.dateNode,"lconnHideOnSelected");
dojo.addClass(this.previewOnlyNode,"lconnShowOnSelected");
dojo.removeClass(this.previewOnlyNode,"lotusHidden");
}
if(this.isFocusable){
this.domNode.focus=dojo.hitch(this,"_focusEntry");
this.hiddenLinkNode.style.display="";
this.linkNode.style.display="none";
dojo.setAttr(this.hiddenLinkNode,"aria-describedby",this.metaDataNode.id);
}
this.inherited(arguments);
},_focusEntry:function(){
this.hiddenLinkNode.focus();
},entryClick:function(){
this.hiddenLinkNode.click();
},linkClicked:function(_9){
var _a=dojo.getObject("lconn.share.fileviewer.ConnectionsFileViewer.openFromUrl");
if(this.source.toLowerCase()=="files"&&(this.itemType.toLowerCase()!="files_folder"&&this.itemType.toLowerCase()!="forums_topic")&&_a){
if(_9){
dojo.stopEvent(_9);
}
_a(this.hiddenLinkNode.href);
}else{
if(_9){
_9.stopPropagation();
}
}
}});
}

dojo.provide("lconn.core.quickResults.nls.QuickResultsService")._built=true;
dojo.provide("lconn.core.quickResults.nls.QuickResultsService.en_us");
lconn.core.quickResults.nls.QuickResultsService.en_us={"QUICK_RESULTS":"RECENT","ENTRY_ARIA_LABEL":"Recently used entry. Selecting this option will bring you to the selected recent page"};

;if(!dojo._hasResource["lconn.core.quickResults.QuickResultsService"]){
dojo._hasResource["lconn.core.quickResults.QuickResultsService"]=true;
dojo.provide("lconn.core.quickResults.QuickResultsService");








dojo.requireLocalization("lconn.core.quickResults","QuickResultsService");
dojo.declare("lconn.core.quickResults.QuickResultsService",[lconn.core.typeahead.Service],{SERVICE_NAME:"quickResultsEnabled",disableSpellingCorrection:false,isLoginNeeded:true,minToDisplay:4,postMixInProperties:function(){
this.inherited(arguments);
this.strings=dojo.i18n.getLocalization("lconn.core.quickResults","QuickResultsService");
dojo.mixin(this,this.strings);
},postCreate:function(){
this._dataReader=new lconn.core.quickResults.DataReader({disableSpellingCorrection:this.disableSpellingCorrection});
this._dataReader.startup();
this.header=document.createElement("div");
dojo.addClass(this.header,"pfTitle");
this.header.innerHTML=this.QUICK_RESULTS;
this.isDisabled=lconn.core.config.properties[this.SERVICE_NAME]!=="true";
},initResults:function(_1){
var _2=[];
for(var i=0;i<_1.length;i++){
var _3=new lconn.core.quickResults.GenericEntry({contentId:(_1[i].contentId?_1[i].contentId:""),entryTitle:(_1[i].title?_1[i].title:""),details:(_1[i].details?_1[i].details:""),author:(_1[i].author?_1[i].author:""),date:(_1[i].date?new Date(_1[i].date):null),source:(_1[i].source?_1[i].source:""),itemType:(_1[i].itemType?_1[i].itemType:""),resourceUrl:(_1[i].url?_1[i].url:""),isFocusable:this.isFocusable});
_3.startup();
this._createdWidgets.push(_3);
if(this.useAriaNodes){
_3.domNode.setAttribute("aria-describedby",this.id+"_entryAria");
}
_3.connect(_3.domNode,"onclick",dojo.hitch(this,"entrySelected",_3));
_3.connect(_3,"linkClicked",dojo.hitch(this,"entryClicked",_3));
if(this.isFocusable){
_3.connect(_3.hiddenLinkNode,"onfocus",dojo.hitch(this,"focusCallback",_3.domNode));
}
_2.push(_3.domNode);
}
return {medium:_2};
},initAriaNodes:function(){
var _4=document.createElement("div");
dojo.addClass(_4,"lotusHidden");
_4.innerHTML=this.ENTRY_ARIA_LABEL;
_4.id=this.id+"_entryAria";
return [_4];
},_handleError:function(_5,_6){
if(!(_6&&_6.dojoType=="cancel")){
this.isDisabled=true;
}
this.inherited(arguments);
},entrySelected:function(_7,_8){
_7.entryClick();
},entryClicked:function(_9,_a){
}});
}

dojo.provide("lconn.core.nls.SearchBar")._built=true;
dojo.provide("lconn.core.nls.SearchBar.en_us");
lconn.core.nls.SearchBar.en_us={"LABEL_DOGEAR":"Bookmarks","LABEL_BLOGS":"Blogs","LABEL_STATUS_UPDATES":"Status Updates","LABEL_FILES":"Files","LABEL_ADVANCED":"Advanced","LABEL_ALL_FILES":"Files","LABEL_SEARCH":"Search","LABEL_PROFILES":"Profiles","LABEL_ACTIVITIES":"Activities","LABEL_WIKIS":"Wikis","LABEL_SELECT_SCOPE":"Refine search options","LABEL_ECM_FILES":"Files","LABEL_COMMUNITIES":"Communities","LABEL_FORUMS":"Forums","LABEL_ALLCONNECTIONS":"All Content"};

;dojo.cache("lconn.core", "templates/SearchBar.html", "<div class=\"lotusGlobalSearch\" role=\"search\"> <div class=\"lotusSearch\"> <form dojoAttachPoint=\"formNode\" method=\"POST\" dojoAttachEvent=\"onsubmit:formSubmitted\"> <input name=\"scope\" value=\"\" dojoAttachPoint=\"scopeInputNode\" type=\"hidden\" /> <input name=\"component\" value=\"\" dojoAttachPoint=\"featureInputNode\" type=\"hidden\" /> <table class=\"lotusLayout\" cellspacing=\"0\" role=\"presentation\" summary=\"\"> <tbody> <tr> <td> <div class=\"lotusHidden\" id=\"${id}-searchOptionLabel\">${_strings.LABEL_SELECT_SCOPE}</div> <div> <a href=\"javascript:;\" title=\"${_strings.LABEL_SELECT_SCOPE}\" class=\"lotusScope\" dojoAttachPoint=\"scopeNode\" dojoAttachEvent=\"onclick:openMenu,onkeypress:openMenuA11y\" aria-haspopup=\"true\" role=\"button\" aria-labelledby=\"${id}-searchOptionLabel ${id}searchOpt\"> <img class=\"lotusIcon\" alt=\"\" src=\"${_blankGif}\" dojoAttachPoint=\"currScopeIconNode\" role=\"presentation\"/> <span id=\"${id}searchOpt\" dojoAttachPoint=\"currScopeLabelNode\"> </span> <span class=\"lotusAltText\" role=\"presentation\">&#9660;</span> </a> </div> </td> <td> <input id=\"${id}searchInput\" dojoAttachPoint=\"textNode\" class=\"lotusText lotusInactive\" type=\"text\" name=\"query\" title=\"${_strings.LABEL_SEARCH}\"/> </td> <td> <span class=\"lotusBtnImg\"> <input dojoAttachPoint=\"onclick:submitForm\" class=\"lotusSearchButton\" type=\"image\" src=\"${_blankGif}\" alt=\"${_strings.LABEL_SEARCH}\" title=\"${_strings.LABEL_SEARCH}\" aria-label=\"${_strings.LABEL_SEARCH}\"/> <a href=\"javascript:;\" alt=\"${_strings.LABEL_SEARCH}\" dojoAttachEvent=\"onclick:submitForm\" class=\"lotusAltText\">${_strings.LABEL_SEARCH}</a> </span> </td> </tr> </tbody> </table> </form> </div></div>");

;if(!dojo._hasResource["lconn.core.SearchBar"]){
dojo._hasResource["lconn.core.SearchBar"]=true;
dojo.provide("lconn.core.SearchBar");














dojo.requireLocalization("lconn.core","SearchBar");
dojo.declare("lconn.core.SearchBar",[lconn.core.typeahead.TypeAheadManager,dijit._Templated],{templatePath:dojo.moduleUrl("lconn.core","templates/SearchBar.html"),localOptions:[],thirdPartySearchEngines:[],globalOptions:[],showAllFeatures:false,localAction:"",searchContextPath:"",_strings:dojo.i18n.getLocalization("lconn.core","SearchBar"),menuItems:[],featureIcons:{allareas:"lconnSprite lconnSprite-iconConnections16",activities:"lconnSprite lconnSprite-iconActivities16",blogs:"lconnSprite lconnSprite-iconBlogs16",communities:"lconnSprite lconnSprite-iconCommunities16",dogear:"lconnSprite lconnSprite-iconBookmarks16",all_files:"lconnSprite lconnSprite-iconFiles16",ecm_files:"lconnSprite lconnSprite-iconFiles16",files:"lconnSprite lconnSprite-iconFiles16",forums:"lconnSprite lconnSprite-iconForums16",profiles:"lconnSprite lconnSprite-iconProfiles16",wikis:"lconnSprite lconnSprite-iconWikis16",status_updates:"lconnSprite lconnSprite-iconStatusUpdate16"},selectedOption:null,textBox:null,globalAction:"",advancedSearchUrl:"",SEARCH_DIRECTORY:"directory",SEARCH_ADVANCED:"searchAdvancedIdentifier",SEARCH_POST_PATH:"/web/search",SEARCH_ADVANCED_PATH:"/web/jsp/advancedSearch.jsp",focusScopeMenuOnSelect:false,postCreate:function(){
this.TAdropdownAnchor=this.formNode;
this.TAscopeLabelNode=this.currScopeLabelNode;
var _1=new lconn.core.peopleFinder.directory.PeopleFinderService();
_1.startup();
var _2=new lconn.core.quickResults.QuickResultsService();
_2.startup();
this.TAservicesList=[_2,_1];
if(this.searchContextPath){
this.globalAction=this.searchContextPath+this.SEARCH_POST_PATH;
this.advancedSearchUrl=this.searchContextPath+this.SEARCH_ADVANCED_PATH;
}
this.textBox=new lconn.core.TextBox({shadowText:this._strings.LABEL_SEARCH,textBoxClass:"lotusText",name:"query",title:this._strings.LABEL_SEARCH,value:this.searchFor},this.textNode);
this.TAtextField=this.textBox.textbox;
if(!this.globalOptions){
this.globalOptions=[];
}
if(this.globalOptions.length<=1&&!this.showAllFeatures){
this.globalOptions=[];
}else{
if(this.globalOptions.length<1||this.showAllFeatures){
var _3=lconn.core.config.services;
if(_3.files&&_3.ecm_files){
delete this.featureIcons.files;
delete this.featureIcons.ecm_files;
}
this.globalOptions=[];
for(var _4 in this.featureIcons){
if(this.featureIcons.hasOwnProperty(_4)){
var _5=_4;
if(_4==="status_updates"){
_5="microblogging";
}
var _6=_3[_5]||(_4==="all_files"&&_3.files&&_3.ecm_files);
if(_6){
this.globalOptions.push({label:this._strings["LABEL_"+_4.toUpperCase()],feature:_4});
}
}
}
}
}
this.globalOptions.splice(0,0,{label:this._strings.LABEL_ALLCONNECTIONS,feature:"allareas",iconClass:"lconnSprite lconnSprite-iconConnections16","class":"lotusAlignLeft"});
this.inherited(arguments);
this.showDefaultOption();
},changeLocalOptions:function(_7){
this.localOptions=_7;
if(this.scopeMenu){
this.scopeMenu.destroyRecursive();
this.scopeMenu=null;
this.menuItems=[];
}
this.showDefaultOption();
},showDefaultOption:function(){
for(var i in this.localOptions){
if(this.localOptions[i].defaultOption){
this.selectOption(this.localOptions[i],false);
return;
}
}
if(this.globalOptions&&this.globalOptions.length>0){
this.selectOption(this.globalOptions[0],false);
}
},getScopeMenu:function(){
if(!this.scopeMenu){
this.scopeMenu=new dijit.Menu({"class":"lotusNavMenu lconnSearchScope",onItemClick:dojo.hitch(this,"selectOption")});
this.connect(this.scopeMenu,"_onBlur","closeMenu");
this.menuItems=[];
var _8=this.localOptions;
for(var i in _8){
_8[i].parentMenu=this.scopeMenu;
this.menuItems.push(new dijit.MenuItem(_8[i]));
}
if(_8&&_8.length&&this.globalOptions.length>0){
this.menuItems.push(new dijit.MenuSeparator({parentMenu:this.scopeMenu}));
}
_8=this.globalOptions;
if(_8.length>0){
for(var i in _8){
if(_8[i].feature&&this.featureIcons[_8[i].feature]){
_8[i].parentMenu=this.scopeMenu;
_8[i].iconClass=this.featureIcons[_8[i].feature];
this.menuItems.push(new dijit.MenuItem(_8[i]));
}
}
}
var _9=this.thirdPartySearchEngines;
if((_9!=null)&&(_9.length>0)){
this.menuItems.push(new dijit.MenuSeparator({parentMenu:this.scopeMenu}));
for(var i=0;i<_9.length;i++){
_9[i].parentMenu=this.scopeMenu;
this.menuItems.push(new dijit.MenuItem(_9[i]));
}
}
if(this.globalOptions.length>0){
this.menuItems.push(new dijit.MenuSeparator({parentMenu:this.scopeMenu}));
this.menuItems.push(new dijit.MenuItem({label:this._strings.LABEL_ADVANCED,feature:this.SEARCH_ADVANCED,"class":"lotusAlignLeft"}));
}
for(var i=0;i<this.menuItems.length;i++){
if(this.menuItems[i].iconNode){
this.menuItems[i].iconNode.setAttribute("role","presentation");
}
this.scopeMenu.addChild(this.menuItems[i]);
}
}
return this.scopeMenu;
},openMenu:function(_a){
var _b=this.getScopeMenu();
dijit.popup.open({popup:_b,around:this.scopeNode,orient:(dojo._isBodyLtr()?{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"}:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"}),onCancel:dojo.hitch(this,"_cancelMenu")});
_b.focus();
if(this.selectedOption._created){
_b.focusChild(this.selectedOption);
}
dojo.stopEvent(_a);
},openMenuA11y:function(_c){
if(_c.keyCode==dojo.keys.ENTER||_c.charCode==dojo.keys.SPACE||_c.keyCode==dojo.keys.DOWN_ARROW||_c.keyCode==dojo.keys.UP_ARROW){
this.openMenu(_c);
}
},_cancelMenu:function _cancelMenu(){
dijit.popup.close(this.getScopeMenu());
dijit.focus(this.scopeNode);
},closeMenu:function(){
if(this.scopeMenu){
dijit.popup.close(this.scopeMenu);
}
},onSelectOption:function(_d,_e){
this.selectOption(_d,true);
},selectOption:function(_f,_10){
this.TAdisable=!(_f.allowTypeahead)&&(typeof (_f.allowTypeahead)=="boolean");
this.closeMenu();
this.selectedOption=_f;
if(_f.feature&&_f.feature==this.SEARCH_ADVANCED){
location.href=this.advancedSearchUrl;
return;
}
this.currScopeLabelNode.innerHTML=_f.label;
this.currScopeIconNode.className="lotusIcon";
if(_f.iconClass){
dojo.addClass(this.currScopeIconNode,_f.iconClass);
}
if(_f.scope){
this.scopeInputNode.value=_f.scope;
this.featureInputNode.value=_f.feature?_f.feature:"";
}else{
if(_f.feature){
if(_f.feature=="allareas"){
this.featureInputNode.value="";
}else{
this.featureInputNode.value=_f.feature;
}
this.scopeInputNode.value="";
}
}
if(_f.action){
if(_f.scope=="extkeyword"){
this.formNode.method="GET";
this.formNode.action=_f.action;
}else{
this.formNode.method="POST";
this.formNode.action=_f.action;
}
}else{
if(_f.feature){
this.formNode.method="GET";
this.formNode.action=this.globalAction;
}else{
this.formNode.method="POST";
this.formNode.action=this.localAction;
}
}
if(_f.method&&_f.method=="GET"||_f.method=="POST"){
this.formNode.method=_f.method;
}
this.TAupdateCurrentScope();
if(_10){
if(this.focusScopeMenuOnSelect){
try{
this.scopeNode.focus();
}
catch(e){
this.textBox.focus();
}
}else{
this.textBox.focus();
}
}
},setSelectedFeature:function(_11){
if(!this.scopeMenu){
this.getScopeMenu();
}
for(var i in this.globalOptions){
if(this.globalOptions[i].feature===_11){
this.selectOption(this.globalOptions[i],false);
return;
}
}
if(this.globalOptions&&this.globalOptions[0]){
this.selectOption(this.globalOptions[0],false);
}
},isThirdPartySearchEngineSelected:function(){
var _12=false;
var _13=this.selectedOption.label;
for(var i=0;i<this.thirdPartySearchEngines.length&&!_12;i++){
_12=(this.thirdPartySearchEngines[i].label==_13);
}
return _12;
},submitForm:function(evt){
this.textBox.setHiddenValue();
var str=this.textBox.getValue();
str=dojo.string.trim(str);
if(str){
if(this.onSubmit()){
if(this.isThirdPartySearchEngineSelected()){
location.href=this.selectedOption.action+encodeURIComponent(this.textBox.hiddenbox.value);
}else{
if(this.selectedOption.feature&&this.selectedOption.feature==this.SEARCH_DIRECTORY){
var url=this.selectedOption.action;
if(this.selectedOption.valueReplaceParam){
url=url.replace(new RegExp("{"+this.selectedOption.valueReplaceParam+"}","gi"),encodeURIComponent(str));
}
window.location.href=url;
}else{
var _14=function _14(str,_15){
return str.indexOf(_15,str.length-_15.length)!==-1;
};
if(_14(this.formNode.action,this.SEARCH_POST_PATH)){
dojo.attr(this.featureInputNode,"name","scope");
if(!this.scopeInputNode.value){
dojo.attr(this.scopeInputNode,"disabled",true);
}
if(this.textBox.textbox){
dojo.attr(this.textBox.textbox,"disabled",true);
}
}
this.formNode.submit();
}
}
}
}
if(evt){
dojo.stopEvent(evt);
}
return false;
},getValue:function(){
return this.textBox.getValue();
},setValue:function(_16){
this.textBox.setValue(_16);
},clearValue:function(){
return this.textBox.clearValue();
},formSubmitted:function(evt){
this.submitForm();
dojo.stopEvent(evt);
},onSubmit:function(){
},search:function(){
this.submitForm();
},TAisPlaceholderActive:function(){
return this.textBox.shadowTextOn;
}});
}

dojo.provide("lotuslive.widgets.nls.SearchBar")._built=true;
dojo.provide("lotuslive.widgets.nls.SearchBar.en_us");
lotuslive.widgets.nls.SearchBar.en_us={"guests_label":"Guests","directory_label":"${orgName} Directory","people_label":"People","mycontacts_label":"My Contacts","organizations_label":"Organizations"};

;if(!dojo._hasResource["lotuslive.widgets.SearchBar"]){
dojo._hasResource["lotuslive.widgets.SearchBar"]=true;
(function(){
dojo.provide("lotuslive.widgets.SearchBar");


dojo.requireLocalization("lotuslive.widgets","SearchBar");
lotuslive.widgets.SearchBar={strings:null,inited:false,init:function(){
if(!this.inited){
this.strings=dojo.i18n.getLocalization("lotuslive.widgets","SearchBar");
this.inited=true;
}
},getPeopleSearchUrl:function(_1){
return gllConnectionsData.srvUrls["sc-search"].replace("{type}",_1).replace("{searchTerm}","");
},getConnectionsScopedSearchUrl:function(_2){
return gllConnectionsData.srvUrls["connections-scoped-search"].replace("{scope}",_2).replace("{query}","");
}};
var _3=lconn.core.SearchBar.prototype.postMixInProperties;
dojo.extend(lconn.core.SearchBar,{postMixInProperties:function(){
_3.apply(this,arguments);
if(window.gllConnectionsData!=undefined&&window.gllConnectionsData.appName==="homepage"){
lotuslive.widgets.SearchBar.init();
var _4=lotuslive.widgets.SearchBar;
this.thirdPartySearchEngines.push({label:_4.strings.directory_label.replace("${orgName}",window.gllConnectionsData.orgName),iconClass:"lconnSprite lconnSprite-iconProfiles16",scope:"scDirectory",action:_4.getConnectionsScopedSearchUrl("profiles")});
if(typeof gllConnectionsData!=="undefined"&&!gllConnectionsData.isVersePreview){
this.thirdPartySearchEngines.push({label:_4.strings.organizations_label,iconClass:"",scope:"scOrgs",action:_4.getPeopleSearchUrl("org")});
}
}
}});
})();
}


;if(!dojo._hasResource["lconn.core.aria.TabPanel"]){
dojo._hasResource["lconn.core.aria.TabPanel"]=true;
dojo.provide("lconn.core.aria.TabPanel");


dojo.declare("lconn.core.aria.TabPanel",lconn.core.aria._Helper,{containerRole:"tablist",itemRole:"tab",focusNextItem:function(){
var si=this.selIdx;
this.inherited(arguments);
this._selectItem(si);
},focusPrevItem:function(){
var si=this.selIdx;
this.inherited(arguments);
this._selectItem(si);
},_selectItem:function(si){
var ai=this.allItems;
if(si!=this.selIdx){
dijit.setWaiState(ai[si],"selected","false");
dijit.setWaiState(ai[this.selIdx],"selected","true");
this._activate(ai[this.selIdx]);
}
},_isSelected:function(_1){
return dijit.getWaiState(_1,"selected")=="true";
},_activate:function(_2){
try{
if(document.createEvent){
var _3=document.createEvent("HTMLEvents");
_3.initEvent("click",false,true);
_2.dispatchEvent(_3);
}else{
_2.fireEvent("onclick");
}
}
catch(e){
console.error([this.declaredClass,": ",e].join(""));
}
}});
}


;if(!dojo._hasResource["lconn.core.config.ckeditorLite"]){
dojo._hasResource["lconn.core.config.ckeditorLite"]=true;
dojo.provide("lconn.core.config.ckeditorLite");
lconn.core.config.ckeditorLite.execCustomConfig=function(){
CKEDITOR.editorConfig=function(_1){
_1.plugins="enterkey,"+"entities,"+"link,"+"pastetext,"+"selectall,"+"sourcearea,"+"undo,"+"wysiwygarea,"+"ibmurllink,"+"ibmcharactercounter,"+"ibmbasiceditor,"+"autogrow,"+"pastefromword";
_1.skin="oneui3";
_1.toolbar="Empty";
_1.toolbar_Empty=[[""]];
_1.disableNativeSpellChecker=false;
_1.forceEnterMode=true;
_1.useComputedState=true;
_1.ignoreEmptyParagraph=true;
_1.keystrokes=[[CKEDITOR.CTRL+76,null]];
_1.find_highlight={element:"span",styles:{"background-color":"#004","color":"#fff","border":"1px solid #004"}};
_1.pasteFromWordRemoveFontStyles=true;
_1.pasteFromWordRemoveStyles=true;
_1.ibmAutoConvertUrls=true;
_1.ibmEnablePasteLinksEvt=true;
_1.forcePasteAsPlainText=true;
_1.allowedContent=true;
};
};
}


;if(!dojo._hasResource["lconn.core.filepicker"]){
dojo._hasResource["lconn.core.filepicker"]=true;
dojo.provide("lconn.core.filepicker");


(function(_1){
_1.open=function(_2){
net.jazz.ajax.xdloader.load_async("lconn.files.picker.FilePickerAssy",function(){
lconn.files.picker.files.open(_2);
});
};
_1.openInline=function(_3){
net.jazz.ajax.xdloader.load_async("lconn.files.picker.EmbededFilePickerAssy",function(){
lconn.files.picker.fileswidget.create(_3);
});
};
}(lconn.core.filepicker));
}


;if(!dojo._hasResource["lconn.core.filesutil"]){
dojo._hasResource["lconn.core.filesutil"]=true;
dojo.provide("lconn.core.filesutil");


(function(_1){
_1.changeVisibility=function(_2){
net.jazz.ajax.xdloader.load_async("lconn.files.filesutil.FilesUtil",function(){
lconn.files.filesutil.FilesUtil.changeVisibility(_2);
});
};
_1.shareWithCommunity=function(_3){
net.jazz.ajax.xdloader.load_async("lconn.files.filesutil.FilesUtil",function(){
lconn.files.filesutil.FilesUtil.shareWithCommunity(_3);
});
};
_1.checkFileExist=function(_4){
net.jazz.ajax.xdloader.load_async("lconn.files.filesutil.FilesUtil",function(){
lconn.files.filesutil.FilesUtil.checkFileExist(_4);
});
};
_1.loadConfig=function(_5){
net.jazz.ajax.xdloader.load_async("lconn.files.filesutil.FilesUtil",function(){
lconn.files.filesutil.FilesUtil.loadConfig(_5);
});
};
_1.getConfig=function(_6){
net.jazz.ajax.xdloader.load_async("lconn.files.filesutil.FilesUtil",function(){
lconn.files.filesutil.FilesUtil.getConfig(_6);
});
};
}(lconn.core.filesutil));
}


;dojo.cache("lconn.core", "templates/DialogUtil.html", "<div class=\"lotusDialogBorder\"> <div class=\"lotusDialog\" style=\"zoom: 1\" role=\"dialog\" aria-labelledby=\"${titleID}\" aria-describedby=\"${contentID}\" waistate=\"${titleID}\"> <div class=\"lotusDialogHeader\"> <h1 class=\"lotusHeading\"> <span id=\"${titleID}\" class=\"title\"></span> </h1> <a class=\"lotusDialogClose\" role=\"button\" href=\"javascript:;\" title=\"${rs_close}\"><img src=\"${blankGif}\" alt=\"${rs_close}\" aria-label=\"${rs_close}\" /><span class=\"lotusAltText\">X</span> </a> </div> <div id=\"${contentID}\" class=\"lotusDialogContent\" role=\"presentation\"></div> <div class=\"lotusDialogFooter\" role=\"presentation\"> <input type=\"button\" class=\"lotusFormButton submit\" /> <input type=\"button\" class=\"lotusFormButton cancel\" /> </div> </div></div>");

;if(!dojo._hasResource["lconn.core.DialogUtil"]){
dojo._hasResource["lconn.core.DialogUtil"]=true;
dojo.provide("lconn.core.DialogUtil");












dojo.requireLocalization("lconn.core","strings");
(function(){
var _1=dojo.i18n.getLocalization("lconn.core","strings");
lconn.core.DialogUtil.alert=function(_2,_3,_4){
var d=_5();
d.lotusTitleNode.innerHTML=_2;
d.lotusContentNode.innerHTML=_3;
d.lotusCancelNode.style.display="none";
d.titleBar.style.display="none";
d.lotusSubmitNode.value=dojo.i18n.getLocalization("lconn.core","strings").rs_ok;
d.lotusSubmitNode.onclick=function(){
d.hide();
if(dojo.isFunction(_4)){
_4();
}
};
d.show();
};
lconn.core.DialogUtil.prompt=function(_6,_7,_8,_9,_a,_b){
var d=_5(_6);
d.lotusTitleNode.innerHTML=_6;
d.lotusContentNode.innerHTML=_7;
d.lotusSubmitNode.value=_8;
d.lotusCancelNode.value=_9;
d.lotusCancelNode.style.display="";
d.lotusSubmitNode.onclick=function(){
d.hide();
if(dojo.isFunction(_a)){
_a(true);
}
};
dojo.connect(d,"onCancel",null,function(){
if(dojo.isFunction(_a)){
_a(false);
}
});
d.titleBar.style.display="none";
if(_b){
dojo.addClass(d.lotusBorderNode,_b);
}
d.show();
};
lconn.core.DialogUtil.popupForm=function(_c,_d,_e,_f,_10,_11){
var d=_5(_c);
d.lotusTitleNode.innerHTML=_c;
d.lotusContentNode.innerHTML="";
d.lotusContentNode.appendChild(_d);
d.lotusSubmitNode.value=_e;
d.lotusCancelNode.value=_f;
d.lotusCancelNode.style.display="";
d.lotusSubmitNode.onclick=function(){
_10();
};
if(_11){
d.connect(d,"onCancel",dojo.hitch(null,_11));
}
d.titleBar.style.display="none";
d.show();
dojo.publish("lconn/core/DialogUtil/popupFormDialogShown",d);
return {_dialog:d,hide:function(){
d.hide();
},disableSubmit:function(){
dojo.addClass(d.lotusSubmitNode,"lotusBtnDisabled");
d.lotusSubmitNode.disabled="disabled";
d.lotusSubmitNode.value=_1.rs_loading;
},enableSubmit:function(){
dojo.removeClass(d.lotusSubmitNode,"lotusBtnDisabled");
d.lotusSubmitNode.disabled="";
d.lotusSubmitNode.value=_e;
}};
};
var _12={templatePath:dojo.moduleUrl("lconn.core","templates/DialogUtil.html")};
var _13=[];
function _5(){
while(_13.length>0&&!_13[_13.length-1].open){
var top=_13.pop();
top.destroyRecursive();
top=null;
}
var _14=(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif?etag=20160903.134200"));
var _15=dojo.string.substitute(dojo.cache("lconn.core","templates/DialogUtil.html"),dojo.mixin(dojo.clone(_1),{blankGif:_14,titleID:dojox.uuid.generateTimeBasedUuid(),contentID:dojox.uuid.generateTimeBasedUuid()}));
var d=new dijit.Dialog();
d.containerNode.innerHTML=_15;
d.closeBtn=dojo.query(".lotusDialogClose",d.containerNode)[0];
d.lotusTitleNode=dojo.query("h1 .title",d.containerNode)[0];
d.lotusContentNode=dojo.query(".lotusDialogContent",d.containerNode)[0];
d.lotusFooterNode=dojo.query(".lotusDialogFooter",d.containerNode)[0];
d.lotusSubmitNode=dojo.query(".lotusDialogFooter .submit",d.containerNode)[0];
d.lotusCancelNode=dojo.query(".lotusDialogFooter .cancel",d.containerNode)[0];
d.lotusBorderNode=dojo.query(".lotusDialogBorder",d.containerNode)[0];
d.connect(d.closeBtn,"onclick","onCancel");
d.connect(d.lotusCancelNode,"onclick","onCancel");
_13.push(d);
return _13[_13.length-1];
};
})();
}


;if(!dojo._hasResource["lconn.core.ckplugins.icdocpicker"]){
dojo._hasResource["lconn.core.ckplugins.icdocpicker"]=true;
(function(){
var _1=dojo.provide("lconn.core.ckplugins.icdocpicker");




dojo.requireLocalization("lconn.core","strings");






var _2=dojo.i18n.getLocalization("lconn.core","strings");
var _3=null;
var _4=true;
var _5=null;
var _6=null;
var _7=false;
var _8=false;
var _9="icdocpicker";
_1.getName=function(){
return _9;
};
_1.isEnabled=function(){
return lconn.core.config.services.files||lconn.core.config.services.ecm_files;
};
_1.addPlugin=function(){
if(CKEDITOR&&CKEDITOR.plugins&&CKEDITOR.plugins.registered&&CKEDITOR.plugins.registered[_9]){
return;
}
CKEDITOR.plugins.add(_9,{init:function(_a){
_a.ui.addButton("LinkToFiles",{label:_2.rs_docpicker_label,command:"linkToFiles"});
_a.addCommand("linkToFiles",{exec:function(_b){
var _c=dojo.getObject("lconn.communities.bizCard.core.community");
var _d=false;
_8=true;
if(_c!=null&&_c.linkToCommunityFilesEnabled){
_5=_c.uuid;
_6=_c.name;
_d=true;
var _e=_c.communityType;
if(_e==="private"){
_8=false;
}
_7=true;
lconn.core.filepicker.open({useCompact:true,title:_2.rs_docpicker_title,showVisibility:true,filesService:lconn.core.config.services.files,onSave:dojo.hitch(_1,_1.onSave,_b),onClose:dojo.hitch(_1,_1.onClose,_b),onSourceChange:function(_f){
_3=_f.id;
},repository:{type:"community",communityId:_5,communityName:_6,isPublic:_8},shareableOnly:true,publicOnly:_8,externalOnly:!!_c.externalAllowed,showExternal:!!_c.isMultiTenantMode,communityFilesType:"all"});
}else{
_7=false;
lconn.core.filepicker.open({useCompact:true,title:_2.rs_docpicker_title,showVisibility:true,filesService:lconn.core.config.services.files,onSave:dojo.hitch(_1,_1.onSave,_b),onClose:dojo.hitch(_1,_1.onClose,_b),onSourceChange:function(_10){
_3=_10.id;
},shareableOnly:true});
}
}});
}});
};
_1.onClose=function(_11){
if(_11){
_11.focus();
}
};
_1.onSave=function(_12,_13){
if(_7&&_3!="currentcommunity"&&_5&&_13.length>0){
lconn.core.filesutil.shareWithCommunity({file:_13,community:[_5],callback:dojo.hitch(this,this.handleShareWithComplete,_12,_13),visibility:_8?"public":null});
return;
}
setTimeout(function(){
lconn.core.ckplugins.icdocpicker.insertLinksToCKEditor(_12,_13);
},600);
};
_1.handleShareWithComplete=function(_14,_15,_16){
var _17=_16?_16.code:null,msg;
if(_17=="ConstraintViolation"){
msg=_2.rs_sharefile_constraint_violation;
}else{
if(_17=="AccessDenied"){
msg=_2.rs_sharefile_access_denied;
}else{
if(_17=="InvalidRequest"){
msg=_2.rs_sharefile_invalid_request;
}else{
if(_17=="SharingIntentRestriction"){
msg=_2.rs_sharefile_sharing_intent_restriction;
}
}
}
}
if(msg){
lconn.core.DialogUtil.alert(_2.rs_sharefile_error_title,msg);
}else{
this.insertLinksToCKEditor(_14,_15);
}
};
_1.insertLinksToCKEditor=function(_18,_19){
var el;
var doc=_18.document;
for(var i=0,l=_19.length;i<l;i++){
var _1a=_19[i];
var url=_1a.getUrlDownload();
el=new CKEDITOR.dom.element("a",doc);
el.setAttribute("href",(!url||0===url.length)?"href://":url);
el.setAttribute("title",dojo.string.substitute(_2.rs_docpicker_download_title,[lconn.core.util.html.formatFilename(_1a.getName())]));
el.setAttribute("data-cke-saved-href",(!url||0===url.length)?"href://":url);
el.setAttribute("target","_blank");
el.setAttribute("_ic_source","files");
el.setAttribute("_ic_files_uuid",_1a.getId());
var img=new CKEDITOR.dom.element("img",doc);
img.setAttribute("src",dojo.config.blankGif);
img.setAttribute("class","lconn-ftype16 lconn-ftype16-"+_1a.getExtension());
img.setAttribute("aria-hidden","true");
img.appendTo(el);
var str=new CKEDITOR.dom.element("strong",doc);
str.appendTo(el);
var txt=new CKEDITOR.dom.text(lconn.core.util.html.formatFilename(_1a.getName()),doc);
txt.appendTo(str);
_18.insertElement(el);
var sep=new CKEDITOR.dom.element("span",doc);
sep.setAttribute("class","lotusDivider");
sep.setAttribute("aria-hidden","true");
sep.setAttribute("role","img");
var bar=new CKEDITOR.dom.text("|",doc);
bar.appendTo(sep);
_18.insertElement(sep);
if(_3=="currentcommunity"){
url=_1a.getUrlVia();
}else{
url=_1a.getUrlAlternate();
}
el=new CKEDITOR.dom.element("a",doc);
el.setAttribute("href",(!url||0===url.length)?"href://":url);
el.setAttribute("title",dojo.string.substitute(_2.rs_docpicker_viewdetails_title,[lconn.core.util.html.formatFilename(_1a.getName())]));
el.setAttribute("data-cke-saved-href",(!url||0===url.length)?"href://":url);
el.setAttribute("target","_blank");
var txt=new CKEDITOR.dom.text(_2.rs_docpicker_viewdetails_text,doc);
txt.appendTo(el);
_18.insertElement(el);
}
};
})();
}


;if(!dojo._hasResource["lconn.core.ckplugins.icpublishBinaryData"]){
dojo._hasResource["lconn.core.ckplugins.icpublishBinaryData"]=true;












(function(){
var _1=dojo.provide("lconn.core.ckplugins.icpublishBinaryData");
var _2="icBinaryData";
_1.TOPIC="lconn/core/ckplugins/icpublishBinaryData";
_1.LOADING={DATA_AVAILABLE:_1.TOPIC+"/progress",UPLOAD_COMPLETE:_1.TOPIC+"/loaded"};
_1.URLarray=[];
_1.getName=function(){
return _2;
};
_1.isEnabled=function(){
return lconn.core.config.properties["com.ibm.lconn.core.web.ckeditor.pasteImages.enabled"]!=="false";
};
_1.addCustomConfig=function(_3){
if((dojo.indexOf(["blogs","wikis","forums","communities"],dojo.getObject("ibmConfig.serviceName"))!==-1)||((dojo.indexOf(["activities"],dojo.getObject("ibmConfig.serviceName"))!==-1)&&dojo.getObject("_lconn_act_config.OAPasteImageToEditorEnabled")===true)){
_3.ibmFilterPastedDataUriImage=!!dojo.isIE;
}
if(dojo.getObject("ibmConfig.serviceName")=="communities"&&!_3.isRTE){
_3.ibmFilterPastedDataUriImage=true;
}
_3.ibmPublishBinaryData=_1.PublishData;
};
_1.isDemo=function(){
return lconn.core.config.properties["com.ibm.lconn.core.web.ckeditor.pasteImages.demo.enabled"]=="true";
};
_1.addPlugin=function(){
if(CKEDITOR&&CKEDITOR.plugins&&CKEDITOR.plugins.registered&&CKEDITOR.plugins.registered[_2]){
return;
}
CKEDITOR.plugins.add(_2,{init:function(_4){
_1.URLarray=[];
var _5=dojo.subscribe(_1.TOPIC,function(_6){
if(_6.editor!==_4.name){
return;
}
_1.URLarray=[];
_1.subscribeObj=_6;
_7(_4,_6.filesArr);
for(var i=0;i<_6.filesArr.length;i++){
_8(_6.filesArr[i],_6.cb,false);
}
});
}});
};
_1.getImageAsBinaryDatacb=function(_9,id,_a){
};
_1.PublishData=function(_b,_c,_d,_e){
dojo.publish(_1.TOPIC,[{cb:_b,editor:_d,filesArr:_e,deleteImageNumber:_c,deleteImagecb:_f}]);
};
_1.substituteUrlcb=function(id,_10){
_11(id,_10);
CKEDITOR.tools.callFunction(_1.subscribeObj.cb,_1.URLarray,"");
};
var afl,_12=false;
function _f(id){
CKEDITOR.tools.callFunction(_1.subscribeObj.deleteImageNumber,[id],"");
};
function _13(_14){
var _15=new Array(_14.length);
for(var i=0;i<_14.length;i++){
_15[i]=_14.charCodeAt(i);
}
var _16=new Uint8Array(_15);
return _16;
};
function _7(_17,_18){
var _19=/^src="data:image\/(.*);base64,(.*)"$/;
var _1a=/data:image\/(.*);base64,(.*)$/;
for(var i=0,_1b;_1b=_18[i];i++){
var m=_1b.data[0].match(_19);
var _1c=_1b.size/1000;
_18[i].name=_1b.name?_1b.name:dojo.string.substitute("editor_image_${0}.${1}",[dojox.uuid.generateRandomUuid(),m[1]]);
_1b.type="image/"+m[1];
_18[i].binary=window.atob(m[2]);
var _1d=_13(_18[i].binary);
var _1e=new Blob([_1d],{type:_1b.type});
_1.getImageAsBinaryDatacb(_1e,_1b.id,_1b.name);
}
};
function _1f(_20){
var _21=new FormData();
var _22=_20.binary;
var nls=dojo.i18n.getLocalization("lconn.core","strings");
var _23=_13(_22);
var _24=new Blob([_23],{type:_20.type});
_21.append("method","upload");
_21.append("weblog",window.weblogHandle);
_21.append("path","BLOGS_UPLOADED_IMAGES");
_21.append("dangerousurlnonce",window.dangerousurlnonceValue);
_21.append("callType","ajax");
_21.append("uploadedFile0",_24,_20.name);
var _25=new XMLHttpRequest();
_25.open("POST",_1.sendUrl);
_25.upload.onprogress=function(e){
if(e.lengthComputable){
var _26=(e.loaded/e.total)*100;
dojo.publish(_1.LOADING.DATA_AVAILABLE,{status:_26,id:_20.id});
}
};
_25.send(_21);
_25.onreadystatechange=function(){
if(_25.readyState<4){
console.log("loading");
}else{
if(_25.readyState===4){
var _27=_25.response;
parser=new DOMParser();
var doc=parser.parseFromString(_27,"text/html");
var _28=doc.getElementsByTagName("textarea")[0];
responseObj=JSON.parse(_28.value);
dojo.publish(_1.LOADING.UPLOAD_COMPLETE,{id:_20.id});
var _29=responseObj.returnCode.messages;
if(responseObj.returnCode.value=="1"){
_f(_20.id);
var _2a=_29[0].indexOf("]")+2;
lconn.core.DialogUtil.alert(nls.rs_sharefile_error_title,_29[0].substring(_2a));
}else{
_11(_20.id,_29);
CKEDITOR.tools.callFunction(_1.subscribeObj.cb,_1.URLarray,"");
}
}
}
};
};
function _2b(_2c){
var _2d=new FormData();
var _2e=_2c.binary;
var _2f=_13(_2e);
var _30=new Blob([_2f],{type:_2c.type});
_2d.append("file",_30,_2c.name);
var _31=new XMLHttpRequest();
_31.open("POST",_1.sendUrl);
_31.upload.onprogress=function(e){
if(e.lengthComputable){
var _32=(e.loaded/e.total)*100;
console.log(e.loaded);
console.log(e.total);
dojo.publish(_1.LOADING.DATA_AVAILABLE,{status:_32,id:_2c.id});
}
};
_31.send(_2d);
_31.onreadystatechange=function onreadystatechange_$2(){
if(_31.readyState<4){
console.log("loading");
}else{
if(_31.readyState===4){
dojo.publish(_1.LOADING.UPLOAD_COMPLETE,{id:_2c.id});
var _33=_31.response;
parser=new DOMParser();
doc=parser.parseFromString(_33,"text/html");
var _34=lconn.share0.util.atom.getJsonResponseFromHtml(doc);
var _35=_36(_34,_2c);
if(_35){
_11(_2c.id,_35);
CKEDITOR.tools.callFunction(_1.subscribeObj.cb,_1.URLarray,"");
var _37=CKEDITOR.instances[_1.subscribeObj.editor];
if(lconn.wikis.App&&lconn.wikis.App.isRTE&&_37){
_37.document.getById(_2c.id).$.setAttribute("lconnResourceType","attachment");
_37.document.getById(_2c.id).$.setAttribute("lconnAttachedResourceType","draft");
}
}
}
}
};
};
function _38(_39){
console.log("cancel ");
_8(_39,_39.cb,false);
};
function _3a(_3b){
_8(_3b,_3b.cb,true);
};
function _36(_3c,_3d){
var url;
if(_3c&&_3c.contents&&_3c.contents.links){
for(var i=0;i<_3c.contents.links.length;i++){
var l=_3c.contents.links[i];
if(l.rel=="alternate"){
url=l.href;
if(url.search(/(\/media\/([^\/]*))/)==-1){
url=url+"/"+_3c.contents.title;
}
var uri=lconn.share0.util.uri.parseUri(url);
url=uri.path;
if(lconn.wikis.App&&lconn.wikis.App.isRTE){
url=uri.path.replace("files/oauth/appdata/communityapplibrary","connections/rte/community");
}
break;
}
}
url=url.replace(dojo.getObject("lconn.share0.config.services.form.anon"),dojo.getObject("lconn.share0.config.services.form.auth"));
}else{
if(_3c.status=="409"&&_3c.contents.errorCode==="ItemExists"){
if(_3d.stopRetry){
return;
}else{
_3d.stopRetry=true;
lconn.share0.util.html.confirm(_nls.INSERTLINK.CONFIRM_REPLACE,dojo.hitch(this,_3a,_3d),dojo.hitch(this,_38,_3d));
}
}
}
return url;
};
function _8(_3e,cb,_3f){
var _40=/wiki\/(.*)\/(.*)\/(.*)\//;
var _41=document.location.href;
var _42=_41.match(_40);
if(!_42){
_40=/wiki\/(.*)\/(.*)\/(.*)/;
_42=_41.match(_40);
}
var _43=CKEDITOR.instances[_1.subscribeObj.editor];
if(dojo.getObject("ibmConfig.serviceName")==="wikis"){
var app=lconn.wikis.App.getInstance();
var _44;
var _45,_46,_47;
if(app.scene.sceneInfo.draftId){
_47=app.scene.pageId;
}else{
if(app.scene.sceneInfo.pageId){
_46=app.wikis_actions.insertImage.documentId;
_47=app.scene.sceneInfo.pageId;
}else{
_44=true;
_45=app.scene.currentDraftId;
}
}
var _48=app.scene.libraryId;
var _49=app.scene.wikiLabel;
var _4a;
var _4b=app.getAuthenticatedUser();
if(!_4a&&_4b&&_4b.nonce){
_4a=_4b.nonce;
}
var f=function(_4c,_4d){
if(_4c instanceof Error){
console.log(_4c);
return;
}
var _4e=_4c;
var _4f={nonce:_4e};
if(_3f){
_4f.replace="true";
}
if(_44){
_1.sendUrl=lconn.core.url.rewrite(app.routes.getDraftAttachmentListServiceUrl(_49,_45),_4f);
}else{
_1.sendUrl=lconn.core.url.rewrite(app.routes.getAttachmentListServiceUrl(_48,_47),_4f);
}
_2b(_3e);
};
if(!_4a){
_4a=app.getNonce(f);
console.log(_4a);
}else{
f(_4a);
}
}else{
if(dojo.getObject("ibmConfig.serviceName")==="blogs"){
var _50=/blogs\/roller-ui\/authoring\/weblog(.*)entryId=(.*)&id=(.*)&autosave/;
var _51=_41.match(_50);
_1.sendUrl="/blogs/roller-ui/authoring/uploadFiles.do";
_1f(_3e);
}else{
if(dojo.getObject("ibmConfig.serviceName")==="communities"&&_43.config.isRTE){
var app=lconn.wikis.App.getInstance();
var _44;
var _45,_52,_47;
_47=app.pageId;
_45=app.currentCkeditorDraftId;
_52=app.resourceId;
var _53={};
if(_3f){
_53.replace="true";
}
if(!_47){
_1.sendUrl=lconn.core.url.rewrite(app.routes.getDraftAttachmentListServiceUrl(_52,_45),_53);
}else{
_1.sendUrl=lconn.core.url.rewrite(app.routes.getAttachmentListServiceUrl(_52,_47),_53);
}
_2b(_3e);
}
}
}
};
function _11(_54,_55){
var _56=new Object();
_56.id=_54;
_56.url=_55;
_1.URLarray.push(_56);
};
})();
}


;if(!dojo._hasResource["lconn.core.lcTextArea.mixins.ITextBoxUtils"]){
dojo._hasResource["lconn.core.lcTextArea.mixins.ITextBoxUtils"]=true;
dojo.provide("lconn.core.lcTextArea.mixins.ITextBoxUtils");


dojo.declare("lconn.core.lcTextArea.mixins.ITextBoxUtils",null,{maxLength:1000,maxByteLength:4000,isIE:dojo.isIE||!!navigator.userAgent.match(/Trident\/7\./)||!!navigator.userAgent.match(/Edge\//),isIE11:!!navigator.userAgent.match(/Trident\/7\./),isEdge:!!navigator.userAgent.match(/Edge\//),isSpace:function(c){
return (c&&(!!c.match(/\s|\u00a0|\u200b/i)||lconn.core.util.text.trim(c).length==0));
},getTextLength:function(){
return (this._showingShadowText)?0:this.getText().length;
},getUtfLength:function(){
return (this._showingShadowText)?0:lconn.core.util.text.lengthUtf8(this.getText());
},isTextTooLong:function(){
var _1=this.getText();
var _2=(this.maxByteLength&&this.maxByteLength!=0)?this.maxByteLength:4000;
return (_1.length>this.maxLength||this.getUtfLength()>_2);
},getTextOutput:function(_3){
var _4=this.getText();
if(_3){
var _5=this.maxLength;
if((this.getUtfLength(_4)>this.maxByteLength)&&this.maxByteLength!=0){
_5=lconn.core.util.text.getCharIndexForUtf8Index(_4,this.maxByteLength);
}
_4=_4.substr(0,_5);
}
return _4;
},isEmptyExceptSpaces:function(){
return this._showingShadowText||lconn.core.util.text.trim(this.getText()).length==0;
}});
}


;if(!dojo._hasResource["lconn.core.ckplugins.mentions.TypeAheadMenu"]){
dojo._hasResource["lconn.core.ckplugins.mentions.TypeAheadMenu"]=true;
dojo.provide("lconn.core.ckplugins.mentions.TypeAheadMenu");












var textUtils=new lconn.core.lcTextArea.mixins.ITextBoxUtils();
function fixTA(_1,_2,_3){
var _4=dojo.getStyle(_1,"height")-2;
var _5=dojo.position(_1);
var _6=dojo.window.getBox().t;
var _7={};
var _8=!dojo._isBodyLtr();
if((_2|0)>(_5.y|0)){
if(_5.y<_3.h){
_4=_4-_3.h;
}else{
_7.top=_5.y-_3.h+_6+"px";
}
}
_7.height=_4+"px";
if(_8&&_5.x<0){
_7.right=dojo.window.getBox().w-_5.w+"px";
}else{
if(_5.x+_5.w>dojo.window.getBox().w){
_7.left=dojo.window.getBox().w-_5.w+"px";
}
}
dojo.style(_1,_7);
};
dojo.declare("lconn.core.ckplugins.mentions.TypeAheadMenu",lconn.core.PeopleTypeAheadFormatMixin,{focusNode:null,store:null,isShowing:false,inputWidget:{},editorFocus:false,cancelBlur:false,pageSize:lconn.core.config.properties["people.typeahead.pageSize"]||15,constructor:function(_9){
dojo.safeMixin(this,_9);
},search:function(_a){
this.focusNode={value:_a.input};
if(!this.menu){
this.createMenu();
}
var _b=this.store.fetch({queryOptions:{ignoreCase:true,deep:true},query:_a.input,onComplete:dojo.hitch(this,this.show,_a.node),onError:dojo.hitch(this,function(_c){
console.error("dijit.form.ComboBox: "+_c);
this.hide();
}),start:0,count:this.pageSize});
var _d=function(_e,_f){
_e.start+=_e.count*_f;
_e.direction=_f;
this.store.fetch(_e);
};
this._nextSearch=this.menu.onPage=dojo.hitch(this,_d,_b);
this.menu.searchDirectory=dojo.hitch(this,dojo.hitch(this,function(){
_b.queryOptions.searchDirectory=true;
this.store.fetch(_b);
}));
},createMenu:function(){
this.menu=new lconn.core.PeopleTypeAheadMenu({store:this.store,"class":"typeAhead",disableBizCard:false,minChars:2,multipleValues:false,searchDelay:600,onSelect:dojo.hitch(this,function(){
if(dojo.isIE>=8||textUtils.isIE11){
this.editorFocus=true;
}
this.onSelect();
}),HeaderMessage:this.typeaheadHeaderString||""});
dojo.place(document.createTextNode(this.menu.resBundle.rs_searchDirectory),this.menu.searchButton);
this.menu.NoResultsMessage=this.menu.resBundle.rs_noResults;
this.menu.inputWidget={_announceOption:function(_10){
}};
this.menu.domNode.onKeyDown=dojo.hitch(this,function(){
this.onMenuKeyDown();
});
},show:function(_11,_12,_13){
var _14=dojo.position((_11.ownerDocument.defaultView||_11.ownerDocument.parentWindow).frameElement);
var _15=dojo.window.getBox().t;
var _16=dojo.position(_11);
var _17=_14.y+_16.y+_16.h;
var _18=!dojo._isBodyLtr();
this.menu.createOptions(_12,_13,dojo.hitch(this,"_getMenuLabelFromItem"));
com.ibm.oneui.util.openAround(this.menu.id,undefined,{noFocus:true,orient:["below","above"]},undefined,{x:_14.x+_16.x,y:_17+_15});
if(_18){
com.ibm.oneui.util.openAround(this.menu.id,undefined,{noFocus:true,orient:["below","above"]},undefined,{x:_14.x+_16.x-this.menu._popupWrapper.clientWidth,y:_17+_15});
}
this.isShowing=true;
fixTA(this.menu._popupWrapper,_17,_16);
},hide:function(){
if(this.menu){
dijit.popup.close(this.menu);
this.isShowing=false;
}
},onMenuKeyDown:function(e){
},onMenuKeyPress:function(e){
},onSelect:function(){
},focusPrevious:function(_19){
var _1a=this.getHighlightedOption();
if(_1a){
if(_1a.previousSibling!=this.menu.previousButton){
this.menu._focusOptionNode(_1a.previousSibling);
}
}else{
this.menu._focusOptionNode(this.menu.searchButton);
}
this.menu.selected=this.getHighlightedOption();
dojo.attr(_19,"aria-activedescendant",this.menu.selected.id);
},focusNext:function(_1b){
var _1c=this.getHighlightedOption();
if(_1c){
if(_1c.nextSibling!=this.menu.nextButton){
this.menu._focusOptionNode(_1c.nextSibling);
}
}else{
this.menu._focusOptionNode(this.menu.previousButton.nextSibling);
}
this.menu.selected=this.getHighlightedOption();
dojo.attr(_1b,"aria-activedescendant",this.menu.selected.id);
},getHighlightedOption:function(){
return this.menu&&this.menu._highlighted_option||null;
},getCurrentValue:function(){
var opt=this.getHighlightedOption();
return dojo.isIE<9?opt.innerText:opt.textContent;
},getSelectedItem:function(){
var _1d=this.getHighlightedOption();
return _1d&&this.menu.items[_1d.getAttribute("item")]||null;
},getTypeaheadLabel:function(){
return "type ahead list box";
},noResultsFound:function(){
return this.menu.items&&!this.menu.items.length;
},setTypeaheadHeader:function(s){
this.menu.HeaderMessage=s;
}});
}


;if(!dojo._hasResource["lconn.core.ckplugins.mentions._ARIAMixin"]){
dojo._hasResource["lconn.core.ckplugins.mentions._ARIAMixin"]=true;
dojo.provide("lconn.core.ckplugins.mentions._ARIAMixin");
(function(){
var _1=null;
lconn.core.ckplugins.mentions._ARIAMixin={addLabel:function(_2,el,_3){
if(el){
if(!_1){
_1=dojo.create("span",{"aria-live":"polite","aria-atomic":true,style:"position: absolute; top:-9999px",id:"mentionsAria_"+this.idx},_2.container.$);
}
this.setLabel(_3);
el.setAttribute("aria-labelledBy",_1.id);
}
},setLabel:function(_4){
if(!_1){
return;
}
var t=document.createTextNode(_4);
if(_1.firstChild){
_1.removeChild(_1.firstChild);
}
_1.appendChild(t);
_1.setAttribute("aria-label",_4);
},removeLabel:function(){
if(!_1){
return;
}
dojo.destroy(_1);
},getLabel:function(){
return _1;
},deleteLabel:function(){
if(dojo.config.isDebug){
this.removeLabel();
_1=null;
}else{
console.warn("_ARIAMixin.deleteLabel should only be used in tests");
}
}};
})();
}


;if(!dojo._hasResource["lconn.core.events"]){
dojo._hasResource["lconn.core.events"]=true;
dojo.provide("lconn.core.events");
(function(){
var _1=this,_2=(function(e){
try{
e.initKeyboardEvent("keyup",false,false,_1,"+",3,true,false,true,false,false);
return ((e["keyIdentifier"]||e["key"])=="+"&&(e["keyLocation"]||e["location"])==3)&&(e.ctrlKey?e.altKey?1:3:e.shiftKey?2:4)||9;
}
catch(__e__){
_2=0;
}
})(document.createEvent&&document.createEvent("KeyboardEvent")),_3={"char":"","key":"","location":0,"ctrlKey":false,"shiftKey":false,"altKey":false,"metaKey":false,"repeat":false,"locale":"","detail":0,"bubbles":false,"cancelable":false,"keyCode":0,"charCode":0,"which":0},_4=Function.prototype.call.bind?Function.prototype.call.bind(Object.prototype.hasOwnProperty):dojo.hitch(Object.prototype.hasOwnProperty,Function.prototype.call),_5=Object.defineProperty||function(_6,_7,_8){
if("value" in _8){
_6[_7]=_8["value"];
}
};
function _9(_a,_b){
var e;
if(_2){
e=document.createEvent("KeyboardEvent");
}else{
e=document.createEvent("Event");
}
var _c,_d={};
for(_c in _3){
if(_4(_3,_c)){
_d[_c]=(_4(_b,_c)&&_b||_3)[_c];
}
}
var _e=_d["ctrlKey"],_f=_d["shiftKey"],_10=_d["altKey"],_11=_d["metaKey"],_12=_d["altGraphKey"],_13=_2>3?((_e?"Control":"")+(_f?" Shift":"")+(_10?" Alt":"")+(_11?" Meta":"")+(_12?" AltGraph":"")).trim():null,_14=_d["key"]+"",_15=_d["char"]+"",_16=_d["location"],_17=_d["keyCode"]||(_d["keyCode"]=_14&&_14.charCodeAt(0)||0),_18=_d["charCode"]||(_d["charCode"]=_15&&_15.charCodeAt(0)||0),_19=_d["bubbles"],_1a=_d["cancelable"],_1b=_d["repeat"],_1c=_d["locale"],_1d=_1;
_d["which"]||(_d["which"]=_d["keyCode"]);
if("initKeyEvent" in e){
e.initKeyEvent(_a,_19,_1a,_1d,_e,_10,_f,_11,_17,_18);
}else{
if(_2&&"initKeyboardEvent" in e){
if(_2==1){
e.initKeyboardEvent(_a,_19,_1a,_1d,_14,_16,_e,_f,_10,_11,_12);
}else{
if(_2==2){
e.initKeyboardEvent(_a,_19,_1a,_1d,_e,_10,_f,_11,_17,_18);
}else{
if(_2==3){
e.initKeyboardEvent(_a,_19,_1a,_1d,_14,_16,_e,_10,_f,_11,_12);
}else{
if(_2==4){
e.initKeyboardEvent(_a,_19,_1a,_1d,_14,_16,_13,_1b,_1c);
}else{
e.initKeyboardEvent(_a,_19,_1a,_1d,_15,_14,_16,_13,_1b,_1c);
}
}
}
}
}else{
e.initEvent(_a,_19,_1a);
}
}
for(_c in _3){
if(_4(_3,_c)){
if(e[_c]!=_d[_c]){
try{
delete e[_c];
_5(e,_c,{writable:true,"value":_d[_c]});
}
catch(e){
}
}
}
}
return e;
};
lconn.core.events.createKeyboardEvent=_9;
})();
}


;if(!dojo._hasResource["lconn.core.ckplugins.mentions._Handler"]){
dojo._hasResource["lconn.core.ckplugins.mentions._Handler"]=true;
dojo.provide("lconn.core.ckplugins.mentions._Handler");










(function(_1,_2,_3){
var _4=new lconn.core.lcTextArea.mixins.ITextBoxUtils();
function _5(_6){
var _7=0;
dojo.map(_6,function(c){
_7+=c.charCodeAt(0)>1424?2:1;
});
return _7;
};
function _8(_9,_a){
var el=new CKEDITOR.dom.element(_4.isIE?"span":"a",_9.document);
if(_4.isIE){
el.addClass("cke_mention");
}
if(_a){
el.appendText(_a);
}
_9.insertElement(el);
return el;
};
function _b(_c){
var _d=_c.endContainer.type==CKEDITOR.NODE_ELEMENT?_c.endContainer.getLast():_c.endContainer,_e;
while(_d){
if(_d.getText()=="\u200b"){
_e=_d;
_e.remove();
}
_d=_d.getPrevious();
}
};
lconn.core.ckplugins.mentions._Handler={idx:0,dbcsComposing:false,_buffer:[],_editor:null,eventHandles:[],typeaheadHeaderString:"",_activatorInSel:false,activate:function(_f){
this._buffer=[];
this._editor=_f;
var el=this._node=_8(_f,this.activatorChar);
this.addLabel(_f,el,(this.ariaLabels&&this.ariaLabels.compose)||"");
var _10=new CKEDITOR.dom.range(el);
_10.moveToElementEditEnd(el);
_10.select();
},handleComposition:function(evt){
if(dojo.isIE||dojo.isChrome){
this.updateBuffer();
}else{
this._buffer.push(evt.data.$.data);
}
if(_5(this._buffer)>1){
this.showMenu();
}
this.dbcsComposing=false;
},handleCompositionStart:function(){
this.dbcsComposing=true;
},handleKeyDown:function(evt){
var key=evt.data.keyCode||evt.data.getKey();
if(this.menu&&this.menu.isShowing){
switch(key){
case dojo.keys.UP_ARROW:
evt.data.preventDefault(true);
this.menu.focusPrevious(this._node.$);
this.setLabel(this.menu.getCurrentValue());
break;
case dojo.keys.DOWN_ARROW:
evt.data.preventDefault(true);
this.menu.focusNext(this._node.$);
this.setLabel(this.menu.getCurrentValue());
break;
case dojo.keys.PAGE_UP:
case dojo.keys.PAGE_DOWN:
case dojo.keys.ESCAPE:
evt.data.preventDefault(true);
this.dispatchEvent(this.menu.menu.domNode,evt.data.$);
this.cancel();
break;
case dojo.keys.ENTER:
var _11=this.menu.getHighlightedOption();
if(_11){
if(_11==this.menu.menu.searchButton){
this.menu.menu.searchDirectory();
}else{
this.menu.onSelect();
}
}
evt.cancel();
break;
default:
if((key>=48&&key<=90)||(key>=96&&key<=105)||dojo.keys.DELETE||dojo.keys.BACKSPACE||dojo.keys.SPACE){
this.checkForActivatorInSel();
}
break;
}
}else{
switch(key){
case dojo.keys.BACKSPACE:
this.checkForActivatorInSel();
if(this._node.getText()==this.activatorChar){
if(dojo.isIE){
this.cancel();
}else{
evt.data.preventDefault(true);
this.removeMention();
}
}
break;
case dojo.keys.ENTER:
this.cancel();
evt.cancel();
break;
default:
if((key>=48&&key<=90)||(key>=96&&key<=105)||dojo.keys.DELETE||dojo.keys.SPACE){
this.checkForActivatorInSel();
}
break;
}
}
},handleKeyUp:function(evt){
var key=evt.data.getKey();
switch(key){
case dojo.keys.UP_ARROW:
case dojo.keys.DOWN_ARROW:
break;
case dojo.keys.ESCAPE:
case dojo.keys.CANCEL:
this.cancel();
break;
case dojo.keys.BACKSPACE:
if(this._node.$.parentNode){
this.handleBackspace();
}else{
this.hideMenu();
this.onCancel();
}
break;
case dojo.keys.SPACE:
var _12=(dojo.isIE&&!_4.isIE11);
var _13=(this._buffer.length>0&&_12&&_4.isSpace(this._buffer[(this._buffer.length-1)]));
var _14=(!_12&&this._buffer.length>1&&_4.isSpace(this._buffer[(this._buffer.length-1)])&&_4.isSpace(this._buffer[(this._buffer.length-2)]));
if((_14&&this.menu&&this.menu.isShowing&&this.menu.noResultsFound())||_13){
if(_13){
this.updateBuffer();
}
this.cancel();
break;
}
default:
if(!(((key==86||key==dojo.keys.F7)&&(evt.data.$.ctrlKey||evt.data.$.metaKey))||(evt.data.$.shiftKey&&key==dojo.keys.INSERT))||(evt.data.$.ctrlKey&&key==88)){
if(this._activatorInSel){
this._activatorInSel=false;
}else{
this.updateBuffer();
if(_5(this._buffer)>1){
if(key==dojo.keys.SPACE&&this.menu.isShowing&&this.menu.noResultsFound()&&!this.dbcsComposing){
this.cancel();
this.hideMenu();
}else{
this.showMenu();
}
}
}
}
break;
}
},activatorInSelection:function(){
var _15=this._editor.getSelection().getSelectedText();
return _15&&_15.indexOf(this.activatorChar)>-1;
},checkForActivatorInSel:function(){
if(this.activatorInSelection()){
this.removeMention();
this._activatorInSel=false;
}
},handleBackspace:function(){
this.updateBuffer();
var _16=this._node.getText().split("");
if(_16.length<1){
this.cancel();
return true;
}
if(_5(this._buffer)>1){
this.showMenu();
}else{
this.hideMenu();
}
},updateBuffer:function(){
this._buffer=(this._node)?this._node.getText().substring(1).split(""):[];
dojo.forEach(this._buffer,dojo.hitch(this,function(_17,i){
if(_17.charCodeAt(0)=="160"){
this._buffer[i]=" ";
}
}));
},handleDeletion:function(_18){
var _19=_18.getSelection().getRanges()[0];
var _1a=this.getMentionsAtRange(_19,_18);
if(_1a&&_1a.length>0){
var _1b=_19.endContainer,_1c,_1d;
if(_1a.length==1&&!dojo.isIE){
_2.addLabel(_18,_1b.getParent(),dojo.string.substitute(this.ariaLabels.removed,[_1a[0].name])||"");
}
dojo.forEach(_1a,dojo.hitch(this,function(_1e){
this._buffer=_1e.name.split("");
_1d=this.bidiActivatorChar();
if(_1e.name.indexOf(_1d)!==-1){
_1e.name=_1e.name.substring(_1e.name.indexOf(_1d)+_1d.length);
}
var _1f={editor:_18,mention:_1e.name,node:_1e.node,id:_1e.id,className:"PersonMentionsNode",getUserId:function(){
return _1e.id;
}};
var _20=_18.name;
if(this.eventHandles.onRemoveMention&&this.eventHandles.onRemoveMention[_20]){
this.eventHandles.onRemoveMention[_20](_1f);
}
dojo.publish("lconn/microblogging/mention/removed",[_1f]);
}));
if(_1b.$.className=="vcard"){
_1c=_1b.$;
}
_19.deleteContents();
_19.collapse();
_b(_19);
if(_1c){
if(dojo.isIE){
var _21=_18.createRange();
_21.setStartAt(_1b,CKEDITOR.POSITION_AFTER_START);
_21.setEndAt(_1b,CKEDITOR.POSITION_BEFORE_START);
_21.select();
_1b.remove();
}else{
_1c.remove();
var _22=_18.getSelection().getRanges()[0];
_22.select();
}
}
}
},handlePasteUndo:function(evt){
var _23=false;
var _24;
var _25=dojo.query("span.vcard",evt.editor.document.$);
var _26=(evt.name=="afterPaste");
if(!this._editor){
_24=this._editor;
this._editor=evt.editor;
_23=true;
}
dojo.forEach(_25,dojo.hitch(this,function(_27){
this.decorateContent(_27,_26);
}));
if(_23){
this._editor=_24;
}
},handlePasteActive:function(_28,_29){
this._buffer=this._buffer.concat(_28.split(""));
this._node.$.textContent=this.bidiActivatorChar()+this._buffer.join("");
var _2a=new CKEDITOR.dom.range(this._node);
_2a.setStartAt(this._node,CKEDITOR.POSITION_BEFORE_END);
_2a.setEndAt(this._node,CKEDITOR.POSITION_BEFORE_END);
_2a.select();
_29.focus();
if(_5(this._buffer)>1){
this.showMenu();
}
},handleBlur:function(ev){
if(this.menu){
if(this.menu.editorFocus){
ev.stop();
this._editor.focus();
this.menu.editorFocus=false;
}
if(this.menu.cancelBlur){
this.menu.cancelBlur=false;
}else{
this.hideMenu();
}
}
},handleModeChange:function(){
this.cancel();
},handleBeforeGetData:function(){
this.cancel();
},complete:function(_2b){
var _2c=new CKEDITOR.dom.text("\u200b"),_2d,_2e,_2f,_30;
if(dojo.isFunction(this.addMicroFormat)){
this.addMicroFormat(_2b);
}else{
this.cancel();
return;
}
this.hideMenu();
this.onComplete();
_2d=dojo.hitch(this,this.remove,this._node,_2b);
_2e=dojo.hitch(this,this.removeSymbol,this._node,_2b);
_30={editor:this._editor,mention:dojo.isFunction(this.formatData)?this.formatData(_2b):_2b,node:this._node.$,remove:_2d,removeSymbol:_2e,addSymbol:dojo.hitch(this,this.addSymbol,this._node,_2b),isUserExternal:dojo.hitch(this,this.isExternal,_2b),getUserId:dojo.hitch(this,this.getUserId,_2b),getUserOrgId:dojo.hitch(this,this.getUserOrgId,_2b),className:this.className,value:_2b&&_2b.name};
var _31=this._editor.name;
if(this.eventHandles.onCreateMention&&this.eventHandles.onCreateMention[_31]){
this.eventHandles.onCreateMention[_31](_30);
}
dojo.publish("lconn/microblogging/mention/completed",[_30]);
if(dojo.isFunction(this._editor.config.ibmMentionShouldNotifyCallback)){
_2f=this._editor.config.ibmMentionShouldNotifyCallback(_2b);
if(!_2f){
_2d();
}else{
if(dojo.isFunction(_2f.then)){
_2f.then(function(){
},_2d);
}
}
}
this.setLabel((this.ariaLabels&&dojo.string.substitute(this.ariaLabels.completed,[this.getValue()]))||"");
if(!_4.isIE11){
_2c.insertAfter(this._node);
}
},cancel:function(){
this.removeMention();
this._editor.insertText(this.activatorChar+this.getValue());
},removeMention:function(){
this.setLabel((this.ariaLabels&&dojo.string.substitute(this.ariaLabels.cancelled,[this.getValue()]))||"");
this._node.remove();
this.hideMenu();
this.onCancel();
},showMenu:function(){
if(!this.menu){
this.menu=new _1({store:(this.getStore||function(){
return null;
})(),onSelect:dojo.hitch(this,this.onSelect),onMenuKeyDown:dojo.hitch(this,this.onMenuKeyDown),onMenuKeyPress:dojo.hitch(this,this.onMenuKeyPress),idx:this.idx,typeaheadHeaderString:this.typeaheadHeaderString});
this.idx++;
}
if(dojo.isIE>=8||_4.isIE11){
this.menu.cancelBlur=true;
}
this.setLabel(this.menu.getTypeaheadLabel());
this.menu.search({input:this.getValue(),node:this._node.$});
},hideMenu:function(){
if(this.menu){
this.menu.hide();
}
},getValue:function(){
return this._buffer.join("");
},setValue:function(_32){
this._buffer=_32.split("");
this._node.setText(this.bidiActivatorChar()+this.getValue());
},handleSetTypeaheadHeader:function(s){
if(this.menu){
this.menu.setTypeaheadHeader(s);
}else{
this.typeaheadHeaderString=s;
}
},onSelect:function(){
var _33=this.menu.getSelectedItem();
if(_33){
this.setValue(this.getTextFromItem(_33));
this.complete(_33);
}else{
if(dojo.isIE>=8||_4.isIE11){
this.menu.cancelBlur=true;
}
}
},handleAddCallback:function(_34,_35,_36){
if(!this.eventHandles[_34]){
this.eventHandles[_34]={};
}
this.eventHandles[_34][_36.name]=_35;
},handleSetDataStore:function(_37){
this.setStore(_37);
},handleSetNetwork:function(_38){
this.setNetwork(_38);
},onMenuKeyPress:function(e){
if(e.charCode>0){
this._buffer.push(String.fromCharCode(e.charCode));
this.setValue(this.getValue());
}
},onMenuKeyDown:function(e){
switch(e.keyCode){
case dojo.keys.ESCAPE:
case dojo.keys.CANCEL:
this._editor.focus();
break;
case dojo.keys.BACKSPACE:
dojo.stopEvent(e);
this._editor.focus();
this.dispatchEvent(this._node.$.ownerDocument.body,e);
if(this.menu){
this.menu.focus();
}
this.handleBackspace();
break;
}
},dispatchEvent:function(_39,e){
var _3a=_3.createKeyboardEvent(e.type,{"char":String.fromCharCode(e.charCode),"key":e.keyCode,"location":0,"ctrlKey":e.ctrlKey,"shiftKey":e.shiftKey,"altKey":e.altKey,"metaKey":e.metaKey,"repeat":false,"locale":"","detail":0,"bubbles":e.bubbles,"cancelable":e.cancelable,"keyCode":e.keyCode,"charCode":e.charCode,"which":e.which});
_39.dispatchEvent(_3a);
},onComplete:function(){
},onCancel:function(){
}};
dojo.safeMixin(lconn.core.ckplugins.mentions._Handler,_2);
}(lconn.core.ckplugins.mentions.TypeAheadMenu,lconn.core.ckplugins.mentions._ARIAMixin,lconn.core.events));
}


;if(!dojo._hasResource["lconn.core.PeopleTypeAheadOpenSocialConverter"]){
dojo._hasResource["lconn.core.PeopleTypeAheadOpenSocialConverter"]=true;
dojo.provide("lconn.core.PeopleTypeAheadOpenSocialConverter");
dojo.declare("lconn.core.PeopleTypeAheadOpenSocialConverter",null,{idPrefix:"urn:lsid:lconn.ibm.com:profiles.person:",convertOpenSocialPeopleTypeAheadFeed:function(_1){
var _2=this._createWrapper();
var _3=this;
_2.items=dojo.map(_1.list,function(_4){
return _3._convertItem(_4);
});
return _2;
},_createWrapper:function(){
var _5={identifier:"member",label:"name",items:[]};
return _5;
},_convertItem:function(_6){
var _7=this._getEmail(_6.emails);
var _8=_6.id.replace(this.idPrefix,"");
var _9={name:_6.displayName,userid:_8,member:_7,type:"0"};
return _9;
},_getEmail:function(_a){
var _b="";
if(_a&&_a.length>0){
if(_a.length==1){
_b=_a[0].value;
}else{
var _c=dojo.filter(_a,function(_d){
return _d.type=="primary";
});
if(_c.length>0){
_b=_c[0].value;
}else{
_b=_a[0].value;
}
}
}
return _b;
}});
}


;if(!dojo._hasResource["lconn.core.PeopleDataStoreOpenSocial"]){
dojo._hasResource["lconn.core.PeopleDataStoreOpenSocial"]=true;
dojo.provide("lconn.core.PeopleDataStoreOpenSocial");






dojo.declare("lconn.core.PeopleDataStoreOpenSocial",lconn.core.PeopleDataStore,{_openSocialDataConverter:null,_openSocialParameters:null,network:null,constructor:function(_1,_2){
this._openSocialDataConverter=new lconn.core.PeopleTypeAheadOpenSocialConverter();
this.network=_1.network;
if(_1.openSocialParameters){
this._openSocialParameters=_1.openSocialParameters;
}
},setOpenSocialParameters:function(p){
this._openSocialParameters=p;
},fetch:function(_3){
var _4={};
var _5;
this.searchDirectory=(_3.queryOptions.searchDirectory?true:false);
if(this.searchDirectory){
_5=this.dirCache;
}else{
_5=this.cache;
}
if(typeof _5[_3.query.toLowerCase()]=="object"){
_3.count=_5.length;
_3.onComplete(_5[_3.query.toLowerCase()],_3);
return _3;
}
if(this._openSocialParameters){
for(p in this._openSocialParameters){
_4[p]=this._openSocialParameters[p];
}
}
if(this.queryParam){
_4[this.queryParam]=_3.query;
}
if(this.searchDirectory){
_4.searchType="directory";
}
this.networkGet({url:this.url,content:_4,handleAs:"json-comment-optional",timeout:60000,load:dojo.hitch(this,function(_6){
var _7;
if(this.searchDirectory){
_7=this.dirCache;
}else{
_7=this.cache;
}
var _8=this._openSocialDataConverter.convertOpenSocialPeopleTypeAheadFeed(_6);
_3.count=_8.items.length;
_7[_3.query.toLowerCase()]=_8.items;
if(_3.onComplete){
_3.onComplete(_8.items,_3);
}
}),error:function(e,_9){
console.log("There was an error: "+e.message);
_9.xhr.abort();
}});
return _3;
}});
dojo.declare("lconn.core.HybridPeopleDataStoreOpenSocial",lconn.core.PeopleFinderDataStore,{_openSocialDataConverter:null,_openSocialParameters:null,_extendedCache:null,extendedTypeAheadUrl:null,extendedQueryParam:null,network:null,constructor:function(_a,_b){
this._openSocialDataConverter=new lconn.core.PeopleTypeAheadOpenSocialConverter();
if(_a.openSocialParameters){
this._openSocialParameters=_a.openSocialParameters;
}
this._extendedCache=[];
this.extendedTypeAheadUrl=_a.extendedTypeAheadUrl;
this.extendedQueryParam=_a.extendedQueryParam;
this.network=_a.network;
},setOpenSocialParameters:function(p){
this._openSocialParameters=p;
},fetch:function(_c){
var _d={};
var _e;
this.searchDirectory=(_c.queryOptions.searchDirectory?true:false);
if(!this.searchDirectory){
_c=this.inherited("fetch",arguments);
}else{
_e=this._extendedCache;
if(typeof _e[_c.query.toLowerCase()]=="object"){
_c.count=_e.length;
_c.onComplete(_e[_c.query.toLowerCase()],_c);
return _c;
}
if(this._openSocialParameters){
dojo.mixin(_d,this._openSocialParameters);
}
if(this.extendedQueryParam){
_d[this.extendedQueryParam]=_c.query;
}
if(this.searchDirectory){
_d.searchType="directory";
}
if(_c.count){
_d.count=_c.count;
}
this.networkGet({url:this.extendedTypeAheadUrl,content:_d,handleAs:"json-comment-optional",timeout:60000,load:dojo.hitch(this,function(_f){
var _10=this._extendedCache;
var _11;
if(_f.list){
_11=this._openSocialDataConverter.convertOpenSocialPeopleTypeAheadFeed(_f);
}else{
if(_f.items){
_11=_10;
_11.items=this.convertPeopleFinderResults(_f.items);
}
}
_c.count=_11.items.length;
_10[_c.query.toLowerCase()]=_11.items;
if(_c.onComplete){
_c.onComplete(_11.items,_c);
}
}),error:function(){
console.log("There was an error");
}});
}
return _c;
}});
}

dojo.provide("com.ibm.social.ublog.nls.Mentions")._built=true;
dojo.provide("com.ibm.social.ublog.nls.Mentions.en_us");
com.ibm.social.ublog.nls.Mentions.en_us={"MENTIONS":"@${0}","LOGIN_COMMENT":"Log in to post a comment","PREVIOUS_CHOICES":"Previous choices","REMOVED_MENTION":"Removed mention of ${0}","REMOVE_MENTION":"Remove mention","CREATED_MENTION":"Created mention, continue typing for type ahead","MENTION_TYPEAHEAD_OPENED":"Mention type ahead opened, use the up and down arrow keys to select an item","FULL_SEARCH":"Person not listed? Use full search.","SELECTED_MENTION":"${0} selected","MORE_CHOICES":"More choices","JOIN_COMMUNITY_NON_SPECIFIC":"Join the community \'${0}\' to post a comment","YOUR_COMMENT":"Your comment: ${0}","JOIN_COMMUNITY":"Join this community to post a comment","COMPLETED_MENTION":"Completed mention of ${0}","REMOVE_MENTION_ARIA":"Remove mention to this person","NOT_ALLOWED":"You are not authorized to make comments on this message","CANCELLED_MENTION":"Cancelled mention of ${0}","ERROR_LIST_PERSON":"An error occurred when retrieving the list of people. Try again - contact your administrator if the problem persists."};

;dojo.cache("lconn.core", "widget/mentions/templates/mention.html", "<span contenteditable=\"false\" class=\"vcard\" data-mentions='${dataMention}'><a class=\"fn url\" href=\"${url}\">${name}</a><span class=\"x-lconn-userid\" style=\"display: none\">${userid}</span></span>");

;if(!dojo._hasResource["lconn.core.ckplugins.mentions.PersonHandler"]){
dojo._hasResource["lconn.core.ckplugins.mentions.PersonHandler"]=true;
dojo.provide("lconn.core.ckplugins.mentions.PersonHandler");




















dojo.requireLocalization("com.ibm.social.ublog","Mentions");
(function(){
var _1=dojo.i18n.getLocalization("com.ibm.social.ublog","Mentions"),_2=null,_3=null;
function _4(_5){
if(dojo.exists("SemTagSvc")&&dojo.isFunction(SemTagSvc.parseDom)){
SemTagSvc.parseDom(0,_5);
}
};
function _6(_7,_8){
_7.push({name:this.getNameFromNode(_8),id:this.getIdFromNode(_8),node:_8});
};
lconn.core.ckplugins.mentions.PersonHandler={activatorChar:"@",bidiActivatorChar:function(){
var _9=lconn.core.globalization.bidiUtil.isRTLValue(this._buffer[0]);
return !dojo.isBodyLtr()&&!_9?lconn.core.globalization.bidiUtil.enforceTextDirection(this.activatorChar,"ltr"):this.activatorChar;
},className:"PersonMentionsNode",ariaLabels:{compose:_1.CREATED_MENTION,completed:_1.COMPLETED_MENTION,cancelled:_1.CANCELLED_MENTION,removed:_1.REMOVED_MENTION},templatePath:dojo.moduleUrl("lconn.core","widget/mentions/templates/mention.html"),getStore:function(){
if(!_2){
if(_3){
this.network=_3;
}
var _a={filterBy:"displayName",count:15},_b,_c;
if(lconn.core.config.services.search){
_b=lconn.core.url.getServiceUrl(lconn.core.config.services.search)+(this.network&&this.network.oauth?"/oauth":"/anonymous")+"/people/typeahead";
_c=lconn.core.url.getServiceUrl(lconn.core.config.services.opensocial)+(this.network&&this.network.oauth?"/oauth":"/anonymous")+"/rest/people/@public/@all";
_2=new lconn.core.HybridPeopleDataStoreOpenSocial({url:_b,queryParam:"query",extendedTypeAheadUrl:_c,extendedQueryParam:"filterValue",openSocialParameters:_a,network:this.network});
}else{
_b=lconn.core.url.getServiceUrl(lconn.core.config.services.opensocial)+(this.network&&this.network.oauth?"/oauth":"/anonymous")+"/rest/people/@public/@all";
_2=new lconn.core.PeopleDataStoreOpenSocial({url:_b,queryParam:"filterValue",openSocialParameters:_a,network:this.network});
}
}
return _2;
},setStore:function(_d){
_2=_d;
},setNetwork:function(_e){
_3=_e;
},getTextFromItem:function(_f){
return _f?_f.name:null;
},decorateContent:function(_10,_11){
var _12=dojo.query("a.fn",_10)[0];
if((_11&&!this.hasBizCard(_10))||dojo.isIE==8){
var _13=dojo.isIE==8?_12.innerText:_12.textContent;
var _14={clean:dojo.trim(_13).replace(this.activatorChar,""),removeAtChar:_13.indexOf(this.activatorChar)==-1};
var _15=this.getStore();
_15.fetch({queryOptions:{ignoreCase:true,deep:true},query:_14.clean,onComplete:dojo.hitch(this,function(_16,_17,_18,_19){
var _1a;
this._node=new CKEDITOR.dom.element();
this._node.$=_16;
var _1b=dojo.filter(_19,function(_1c){
return _1c.name==_17.clean;
})[0];
if(!!_1b&&dojo.isFunction(this.addMicroFormat)){
_1a=this._editor;
this._editor=_18;
this.addMicroFormat(_1b,_17.removeAtChar);
this._editor=_1a;
}
},_10,_14,this._editor),onError:function(){
return;
}});
}else{
this._editor.fire("lockSnapshot");
dojo.removeClass(_12,"hasHover");
_4(_10);
this._editor.fire("unlockSnapshot");
}
},formatData:function(_1d,_1e){
var _1f={displayName:_1d.name,userId:_1d.userid,type:"PersonMentions",hasSymbol:!_1e};
return dojo.toJson(_1f);
},removeSingleQuote:function(_20){
if(_20.name.indexOf("'")>-1){
_20.name=_20.name.replace("'","&#39;");
}
return _20;
},addMicroFormat:function(_21,_22){
var url=com.ibm.lconn.layout.people.getProfileUrl({name:_21.name,userid:_21.userid});
var _23=dojo.string.substitute(dojo.cache(this.templatePath),{name:_22?dojox.html.entities.encode(_21.name):this.bidiActivatorChar()+dojox.html.entities.encode(_21.name),userid:_21.userid,url:url,dataMention:dojo.isFunction(this.formatData)?this.formatData(this.removeSingleQuote(_21)):""});
var _24=CKEDITOR.dom.element.createFromHtml(_23);
this._editor.fire("lockSnapshot");
_24.replace(this._node);
_4(_24.$);
this._editor.fire("unlockSnapshot");
this._node=_24;
var _25=this._editor.createRange();
_25.moveToPosition(_24,CKEDITOR.POSITION_AFTER_END);
this._editor.getSelection().selectRanges([_25]);
},remove:function(_26,_27){
dojo.deprecated("mentions.remove","Use removeSymbol instead.","6");
this.removeSymbol(_26,_27);
},removeSymbol:function(_28,_29){
var _2a=dojo.query("a.fn",_28.$)[0];
if(_2a){
_2a.innerHTML=dojox.html.entities.encode(_29.name);
_28.setAttribute("data-mentions",this.formatData(_29,true));
}
},addSymbol:function(_2b,_2c){
var _2d=dojo.query("a.fn",_2b.$)[0];
if(_2d&&_2d.innerHTML.indexOf(this.bidiActivatorChar())!==0){
_2d.innerHTML=this.bidiActivatorChar()+dojox.html.entities.encode(_2c.name);
_2b.setAttribute("data-mentions",this.formatData(_2c,false));
}
},getNameFromNode:function(_2e){
if(_2e.className=="vcard"&&_2e.childNodes.length>0){
return dojo.query("a.fn",_2e)[0].innerHTML;
}else{
if(_2e.parentElement.className=="vcard"){
return dojo.query("a.fn",_2e.parentElement)[0].innerHTML;
}
}
},getIdFromNode:function(_2f){
if(_2f.className=="vcard"){
return dojo.query("span.x-lconn-userid",_2f)[0].innerHTML;
}else{
if(_2f.parentElement.className=="vcard"){
return dojo.query("span.x-lconn-userid",_2f.parentElement)[0].innerHTML;
}
}
},isMentionNode:function(_30){
return _30&&((_30.$&&_30.$.className=="vcard")||(_30.className&&_30.className=="vcard"));
},getMentionsAtRange:function(_31,_32){
var _33=[];
if(dojo.isIE&&_31.collapsed){
if(dojo.isIE==8&&this.isMentionNode(_31.endContainer)){
_6.call(this,_33,_31.endContainer.$);
}else{
if(_31.endContainer.getText()=="\u200b"&&this.isMentionNode(_31.endContainer.getPrevious())){
_6.call(this,_33,_31.endContainer.getPrevious().$);
}
}
}else{
var _34=new CKEDITOR.dom.walker(_31),_35;
while(_35=_34.previous()){
if(this.isMentionNode(_35)){
_6.call(this,_33,_35.$);
}
}
}
return _33;
},hasBizCard:function(_36){
return _36&&!!dojo.query("span.x-lconn-userid",_36)[0];
},isExternal:function(_37){
return _37&&_37.ext&&_37.ext.mode=="EXTERNAL";
},getUserId:function(_38){
return _38&&_38.userid;
},getUserOrgId:function(_39){
return _39&&_39.ext&&_39.ext.orgId;
}};
dojo.safeMixin(lconn.core.ckplugins.mentions.PersonHandler,lconn.core.ckplugins.mentions._Handler);
})();
}


;if(!dojo._hasResource["lconn.core.ckplugins.mentions.HashtagHandler"]){
dojo._hasResource["lconn.core.ckplugins.mentions.HashtagHandler"]=true;
dojo.provide("lconn.core.ckplugins.mentions.HashtagHandler");








lconn.core.ckplugins.mentions.HashtagHandler={activatorChar:"#",ariaLabels:{compose:"Created hashtag. Continue typing for type ahead",completed:"Completed hashtag",cancelled:"Cancelled hashtag",removed:"Deleted hashtag"},getStore:function(){
return new lconn.core.TypeAheadDataStore({queryParam:"name",url:"tags.json"});
},getTextFromItem:function(_1){
return _1?_1.displayName:null;
},formatData:function(_2){
var _3={value:_2.displayName,type:"TagMentions",hasSymbol:true};
return dojo.toJson(_3);
},addMicroFormat:function(_4){
},remove:function(_5,_6){
},isMention:function(_7){
return false;
}};
dojo.safeMixin(lconn.core.ckplugins.mentions.HashtagHandler,lconn.core.ckplugins.mentions._Handler);
}


;if(!dojo._hasResource["lconn.core.ckplugins.mentions"]){
dojo._hasResource["lconn.core.ckplugins.mentions"]=true;
(function(){
var _1=dojo.provide("lconn.core.ckplugins.mentions");
var _2="com.ibm.lconn.core.web.ckeditor.mentions.enabled";












var _3="mentions";
_1.getName=function(){
return _3;
};
_1.isEnabled=function(){
return lconn.core.config.properties[_2]!=="false";
};
_1.addPlugin=function(){
if(CKEDITOR&&CKEDITOR.plugins&&CKEDITOR.plugins.registered&&CKEDITOR.plugins.registered[_3]){
return;
}
CKEDITOR.plugins.add(_3,{init:function(_4){
if(_4.config.ibmMentionDisabled||lconn.core.auth.getUser()&&lconn.core.auth.getUser().isExternal){
return;
}
var _5=0,_6=1;
var _7=_5,_8=null;
var _9=false;
var _a=lconn.core.lcTextArea.mixins.ITextBoxUtils();
function _b(){
_7=_5;
};
dojo.subscribe("CKEDITOR.beforeGetData",_c);
function _d(_e){
var _f=_e.getSelection().getRanges()[0],_10=_f.startContainer;
if(_10.type==CKEDITOR.NODE_ELEMENT){
var _11=_10.getChild(_f.startOffset>0?_f.startOffset-1:0);
if(_11){
var _12=_11.getText();
return _12==""?" ":_12[_f.startOffset>0?_12.length-1:0];
}
}
if(_10.type==CKEDITOR.NODE_TEXT&&_10.getText()!="\u200b"){
return _10.getText()[_f.startOffset?_f.startOffset-1:0];
}
while(_10&&(_10.getText()==""||_10.getText()=="\u200b")){
_10=_10.getPrevious();
}
return _10?_10.getText()[_10.getText().length-1]:" ";
};
function _13(ev){
dojo.forEach(_36,function(_14){
_14.handleDeletion(_4);
});
};
function _15(ev){
var key=ev.data.keyCode;
if(key!=dojo.keys.ENTER){
return;
}
switch(_7){
case _6:
if(_8&&_8.handleKeyDown(ev)){
delete _8;
_b();
}
}
};
function _16(ev){
switch(_7){
case _6:
if(_8&&_8.handlePasteActive(ev.data.dataValue,_4)){
delete _8;
_b();
}
ev.cancel();
_4.fire("afterPaste",ev);
break;
}
};
function _17(ev){
switch(_7){
case _6:
_8.handlePasteUndo(ev);
break;
case _5:
dojo.forEach(_36,function(_18){
_18.handlePasteUndo(ev);
});
break;
}
};
function _19(ev){
var _1a=ev.data.getTarget();
if((_1a.$.tagName=="A"||_1a.$.tagName=="SPAN")&&_1a.$.getAttribute("href")){
if(!(dojo.isFF&&ev.data.$.button&&ev.data.$.button==2)){
ev.data.preventDefault(true);
}
}
};
function _1b(ev){
_9=true;
if(_8){
_8.handleCompositionStart();
}
};
function _1c(ev){
switch(_7){
case _6:
if((_a.isIE11||!dojo.isIE)&&_8&&_8.handleComposition(ev)){
delete _8;
_b();
}
}
_9=false;
};
function _1d(ev){
var key=ev.data.getKey();
if(key==dojo.keys.ENTER){
return;
}
switch(_7){
case _5:
var _1e=dojo.filter(_37,function(_1f){
return key==_1f[0];
})[0];
if(_1e&&_a.isSpace(_d(_4))){
ev.data.preventDefault();
_8=_36[_1e[1]];
_8.activate(_4);
_8.onComplete=_b;
_8.onCancel=_b;
_7=_6;
dojo.publish("lconn/core/mentions/started",[{editor:_4,node:_8._node,cancel:dojo.hitch(_8,_8.cancel)}]);
}
break;
case _6:
break;
}
};
function _20(ev){
var key=ev.data.getKey();
if(dojo.isIE||dojo.isChrome){
_9=(key==229);
}
if(key==dojo.keys.ENTER){
return;
}
switch(_7){
case _6:
if(_8&&_8.handleKeyDown(ev)){
delete _8;
_b();
}
break;
case _5:
if(dojo.indexOf([dojo.keys.BACKSPACE,dojo.keys.DELETE],key)!==-1){
_13(ev);
}
if(key==dojo.keys.BACKSPACE||key==dojo.keys.DELETE){
if(dojo.isChrome||dojo.isIE>8){
var _21=_4.getSelection().getRanges()[0],_22=_21.startContainer;
if(_8){
if(_22.$&&(_22.$.parentNode!=_4)){
var _23=_22.$;
if(dojo.isIE&&_23.length<=1&&_23.previousSibling&&_23.previousSibling.tagName=="SPAN"){
_23=_23.previousSibling;
}else{
while(_23.tagName&&_23.tagName!=("P"||"SPAN")&&_23.parentNode.tagName!=("P"||"SPAN")){
_23=_23.parentNode;
}
}
var _24=_23.className;
if(_24&&_24.indexOf("vcard")>-1){
ev.data.preventDefault(true);
if(_8._node&&_8._node.$==_23){
_23=_8._node;
}else{
if(dojo.isIE>8){
_23=_22.getPreviousSourceNode();
}
}
if(dojo.isChrome){
_23.remove();
}else{
_21.setStartBefore(_23);
_21.setEndAfter(_22);
_21.deleteContents();
}
if(_8){
delete _8;
}
}
}
}
}
}
}
};
function _25(ev){
var key=ev.data.getKey();
var _26,_27;
if(key==dojo.keys.ENTER){
return;
}
switch(_7){
case _6:
var _28=((dojo.isIE>8&&!_a.isIE11)&&_9);
_26=(dojo.isIE&&key==dojo.keys.SPACE&&_9);
_27=_a.isSpace(_d(_4));
if(_28||(_26&&!_27)){
if(_8){
_8.handleComposition(ev);
}
}else{
if(_8){
_8.dbcsComposing=false;
if(_8.handleKeyUp(ev)){
delete _8;
_b();
}
}
}
case _5:
if(dojo.indexOf([dojo.keys.BACKSPACE,dojo.keys.DELETE],key)!==-1&&dojo.isIE==8){
_13(ev);
}
}
};
function _29(ev){
if(_8){
_8.handleBlur(ev);
}
};
function _2a(ev){
switch(_7){
case _6:
_8.handleModeChange();
_b();
break;
}
};
function _2b(ev){
if(ev.data.name=="undo"||ev.data.name=="redo"){
switch(_7){
case _6:
_8.handlePasteUndo(ev);
break;
case _5:
dojo.forEach(_36,function(_2c){
_2c.handlePasteUndo(ev);
});
break;
}
}
};
function _c(ev){
switch(_7){
case _6:
_8.handleBeforeGetData(ev);
_b();
break;
}
};
if(dojo.config.isDebug){
_1._eventHandlers={onAfterPaste:_17,onCompositionEnd:_1c,onKey:_15,onKeyDown:_20,onKeyPress:_1d,onKeyUp:_25};
_1.resetState=_b;
}
_4.on("mode",function(evt){
if(_4.mode==="wysiwyg"){
_4.on("key",_15);
_4.on("afterCommandExec",_2b);
_4.on("afterPaste",_17);
_4.on("paste",_16);
_4.document.on("click",_19);
_4.document.on("compositionstart",_1b);
_4.document.on("compositionend",_1c);
_4.on("blur",_29);
_4.on("beforeSetMode",_2a);
_4.document.on("keypress",_1d);
_4.document.on("keydown",_20);
_4.document.on("keyup",_25);
}
});
},cancelActiveMentions:function(_2d){
dojo.forEach(_36,function(_2e){
if(_2e._editor&&_2e._editor==_2d&&_2e._node&&_2e._node.$.nodeName=="A"&&_2e._node.$.parentNode!=null){
_2e.cancel();
}
});
},setTypeaheadHeader:function(s){
dojo.forEach(_36,function(_2f){
_2f.handleSetTypeaheadHeader(s);
});
},addCallback:function(_30,_31,_32){
dojo.forEach(_36,function(_33){
_33.handleAddCallback(_30,_31,_32);
});
},setDataStore:function(o){
dojo.forEach(_36,function(_34){
_34.handleSetDataStore(o);
});
},setNetwork:function(o){
dojo.forEach(_36,function(_35){
_35.handleSetNetwork(o);
});
}});
_1.registerHandler(lconn.core.ckplugins.mentions.PersonHandler);
};
var _36=[],_37=[];
_1.registerHandler=function(_38){
var _39=_36.push(_38)-1;
var arr=dojo.isArray(_38.activatorChar)?_38.activatorChar:[_38.activatorChar];
dojo.forEach(arr,function(c){
_37.push([c.charCodeAt(0),_39]);
});
};
})();
}


;if(!dojo._hasResource["lotuslive.widgets.ckplugins.mentions"]){
dojo._hasResource["lotuslive.widgets.ckplugins.mentions"]=true;
dojo.provide("lotuslive.widgets.ckplugins.mentions");








dojo.extend(lconn.core.ckplugins.mentions.TypeAheadMenu,{_peopleTA:null,_fakeList:null,_frameBody:null,_referenceNode:null,_initialized:false,isShowing:false,stopClose:false,cancelBlur:false,editorFocus:false,_getDataStoreUrl:function(){
var _1=(dojo.getObject("gllConnectionsData.srvUrls.contacts")||lconn.core.url.getServiceUrl(lconn.core.config.services.scprofiles).toString().replace(/(\/profiles)$/,""));
return _1+"/typeahead/people?contacts=false&users=true&groups=false&strict=true&intent=external";
},_instantiatePeopleTA:function(){
if(!this._peopleTA){
this._peopleTA=new bhc.PeopleTypeAhead({url:this._getDataStoreUrl(),multi:false,headerMessage:this.typeaheadHeaderString});
this._peopleTA.onSelect=dojo.hitch(this,function(){
if(dojo.isIE>8||Boolean(navigator.userAgent.match(/Trident\/7\./))){
this.editorFocus=true;
}
this.onSelect(this._peopleTA.getItem());
});
dojo.connect(this._peopleTA,"openDropDown",dojo.hitch(this,function(){
if(dojo.isIE!=8){
var _2=this._peopleTA.dropDown.getHighlightedOption();
if(_2){
this._createFakeList(this._frameBody);
this._createFakeOption(_2);
this._frameBody.setAttribute("aria-activedescendant",_2.id);
}
}
this._peopleTA.alternativeReferenceNode=this._referenceNode;
this.menu=this._peopleTA.dropDown;
this.menu.searchDirectory=function(){
};
this.isShowing=true;
var _3=this;
dojo.connect(this.menu.domNode,"mousedown,mouseup,onclick",function(e){
if(dojo.isIE>=8&&!Boolean(navigator.userAgent.match(/Trident\/7\./))){
_3.editorFocus=true;
}
_3.cancelBlur=true;
});
}));
this._peopleTA.domNode.style.height=0;
this._peopleTA.domNode.style.width=0;
this._peopleTA.domNode.style.visibility="hidden";
this._peopleTA.domNode.style.position="absolute";
dojo.body().appendChild(this._peopleTA.domNode);
}
if(this.menu){
this.menu.cancelBlur=true;
}
},_createReferenceNode:function(){
if(!this._referenceNode){
this._referenceNode=dojo.create("div",{},dojo.body());
this._referenceNode.style.position="absolute";
this._referenceNode.style.visibility="hidden";
}
},_initialize:function(){
if(!this._initialized){
this._instantiatePeopleTA();
this._createReferenceNode();
this._initialized=true;
}
},_updateNodesPosition:function(_4){
var _5=dojo.position((_4.ownerDocument.defaultView||_4.ownerDocument.parentWindow).frameElement,true);
var _6=dojo.position(_4);
this._referenceNode.style.top=(_5.y+_6.y)+"px";
this._referenceNode.style.left=(_5.x+_6.x)+"px";
this._referenceNode.style.height=_6.h+"px";
this._peopleTA.domNode.style.left=(_5.x+_6.x)+"px";
this._peopleTA.domNode.style.top=(_5.y+_6.y+_6.h)+"px";
},_createFakeList:function(_7){
if(!this._fakeList){
this._fakeList=dojo.create("div",{},_7);
this._fakeList.style.height=0;
this._fakeList.style.overflow="hidden";
this._fakeList.style.position="absolute";
this._fakeList.setAttribute("onkeydown","");
this._fakeList.setAttribute("onkeypress","");
this._fakeList.setAttribute("role","listbox");
this._fakeList.setAttribute("aria-label","People Type Ahead Search Results");
if(typeof this.typeaheadHeaderString!="undefined"){
this._fakeList.setAttribute("title",this.typeaheadHeaderString);
}
}
},_destroyFakeList:function(){
if(this._fakeList){
this._fakeList.parentNode.removeChild(this._fakeList);
this._fakeList=null;
this._fakeOption=null;
}
},_createFakeOption:function(_8){
if(this._fakeOption&&this._fakeList.firstChild){
this._fakeList.removeChild(this._fakeList.firstChild);
}
this._fakeOption=dojo.create("div",{},this._fakeList);
this._fakeOption.setAttribute("role","option");
this._fakeOption.setAttribute("tabindex",-1);
this._fakeOption.setAttribute("id",_8.getAttribute("id"));
this._fakeOption.setAttribute("aria-posinset",_8.getAttribute("aria-posinset"));
this._fakeOption.setAttribute("aria-setsize",_8.getAttribute("aria-setsize"));
this._fakeOption.innerHTML=_8.innerHTML;
},search:function(_9){
if(!this._initialized){
this._initialize();
this._frameBody=_9.node.ownerDocument.body;
}
this._updateNodesPosition(_9.node);
this._peopleTA._startSearch(_9.input);
},hide:function(){
if(!this.stopClose){
this._peopleTA._hideResultList();
this._destroyFakeList();
this._frameBody.removeAttribute("aria-activedescendant");
this.isShowing=false;
this._initialized=false;
}
},focusPrevious:function(){
var _a=this._peopleTA.dropDown;
var _b=parseInt(_a.getHighlightedOption().getAttribute("aria-posinset"));
var _c=_a.paginationInfo;
var _d=true;
if(_b==_c.start&&_b>1){
_a.onPage(-1);
}else{
if(_b>1){
_a.selectPreviousNode();
}else{
_d=false;
}
}
if(_d){
var _e=_a.getHighlightedOption();
this._createFakeOption(_e);
this._frameBody.setAttribute("aria-activedescendant",_e.id);
}
},focusNext:function(){
var _f=this._peopleTA.dropDown;
var _10=parseInt(_f.getHighlightedOption().getAttribute("aria-posinset"));
var _11=_f.paginationInfo;
var _12=true;
if(_10==_11.end&&_10<_11.totalNum){
_f.onPage(1);
}else{
if(_10<_11.totalNum){
_f.selectNextNode();
}else{
_12=false;
}
}
if(_12){
var _13=_f.getHighlightedOption();
this._createFakeOption(_13);
this._frameBody.setAttribute("aria-activedescendant",_13.id);
}
},getCurrentValue:function(){
return "";
},getSelectedItem:function(){
var _14=this._peopleTA.dropDown;
var _15=_14.getHighlightedOption();
this._peopleTA.onSelect=dojo.hitch(this,function(_16){
this._peopleTA.onSelect=_16;
},this._peopleTA.onSelect);
this._peopleTA._selectOption(_15);
return this._peopleTA.getItem();
},noResultsFound:function(){
return this._peopleTA.results.length==0;
},getHighlightedOption:function(){
return this.getSelectedItem();
}});
}


;if(!dojo._hasResource["lconn.core.ckplugins.urlDetect"]){
dojo._hasResource["lconn.core.ckplugins.urlDetect"]=true;
(function(){
var _1=dojo.provide("lconn.core.ckplugins.urlDetect");


var _2="urlDetect";
_1.getName=function(){
return _2;
};
_1.isEnabled=function(){
return !(lconn.core.config.properties["com.ibm.lconn.core.web.ckeditor.urlDetect.enabled"]==="false");
};
_1.addPlugin=function(){
if(dojo.exists("CKEDITOR.plugins.registered")&&CKEDITOR.plugins.registered[_2]){
return;
}
var _3=!!navigator.userAgent.match(/Trident\/7\./);
var _4=dojo.moduleUrl("lconn.core","widget/urlPreview/templates/urlDetect.html");
var _5="(^|\\s|>| *)"+"("+"((https?|ftps?|news|mailto|notes):|www\\.|w3\\.)"+"([\\w/\\#~:.?+=%@!\\[\\]\\-{},\\$\\*\\(\\);'\"]|&amp;)+?"+")"+"(?="+"[.:?\\),;!\\]'\"]*"+"(?:[^\\w/\\#~:.?+=&%@!\\[\\]\\-{},\\$\\*\\(\\);'\"]"+"| "+"|$)"+")";
var _6=new RegExp(_5,"gi");
function _7(_8,_9){
var _a;
if(_8){
_a=_9.createRange();
_a.setStartAfter(_8);
_a.setEndAfter(_8);
_a.select();
}
return _a;
};
function _b(_c){
var _d=_c&&(_c.type==CKEDITOR.NODE_ELEMENT)&&_c.getName();
return _d&&(_d=="a")&&_c.getAttribute("type")=="URLNode";
};
function _e(_f){
if(_f&&_f.type==CKEDITOR.NODE_TEXT&&_f.getText()=="\u200b"){
_f.remove();
}
};
function _10(_11){
var _12=_11&&_11.getText();
if(_12&&_12.charAt(_12.length-1)==" "){
_11.setText(_12.substring(0,_12.length));
CKEDITOR.dom.element.createFromHtml("&nbsp;").insertAfter(_11);
}
};
function _13(_14,_15){
if(dojo.isChrome){
var _16=_15&&_15.getPrevious();
var _17=_15&&_15.getNext();
}
_14.deleteContents();
if(!_17&&dojo.isChrome){
_10(_16);
}
_14.select();
};
CKEDITOR.plugins.add(_2,{init:function(_18){
function _19(_1a){
dojo.publish("lconn/core/ckeditor/url/entered",[{url:_1a,editor:_18}]);
};
function _1b(evt){
var _1c=evt.editor.getSelection().getRanges()[0];
if(dojo.isIE==8){
var _1d=dojo.string.substitute(dojo.cache(_4),{href:evt.data.commandData.href,url:_1c.endContainer.getText()});
CKEDITOR.dom.element.createFromHtml(_1d).insertAfter(_1c.endContainer);
_1c.deleteContents();
}else{
var _1e=_1c.endContainer.type==CKEDITOR.NODE_TEXT?_1c.endContainer.getParent():_1c.endContainer;
if(_1e.getAttribute("href")==evt.data.commandData.href){
_1e.setAttribute("contenteditable",false);
_1e.setAttribute("type","URLNode");
}
}
};
function _1f(_20){
var _21=_20.getSelection().getRanges()[0],_22;
if((dojo.isIE||_3)&&_21.collapsed){
if(_21.startContainer.type==CKEDITOR.NODE_ELEMENT&&_21.endContainer.getName()=="p"){
_22=_21.endContainer.getLast();
while(_22&&!_b(_22)){
_22=_22.getPrevious();
}
}else{
if(_21.startContainer.type==CKEDITOR.NODE_TEXT&&_21.endOffset=="1"&&_b(_21.endContainer.getPrevious())){
_22=_21.endContainer.getPrevious();
}
}
if(_22){
_22.remove();
}
}else{
var _23=new CKEDITOR.dom.walker(_21);
while(_22=_23.previous()){
if(_b(_22)){
_13(_21,_22);
}
}
}
};
function _24(evt){
switch(evt.data.getKey()){
case dojo.keys.BACKSPACE:
case dojo.keys.DELETE:
_1f(_18);
break;
default:
break;
}
};
function _25(evt){
if(evt.data.name=="insertLink"){
_1b(evt);
_19(evt.data.commandData.href);
}
};
function _26(evt){
var _27=evt.data,_28=_27.dataValue,_29="",_2a="",_2b=[],_2c=true;
if(evt.data.type=="html"||evt.data.type=="text"){
_2a=dojo.toDom("<div>"+_28+"</div>");
_2b=dojo.query("a[href]",_2a.nodeName=="#document-fragment"||"A"?_2a:"");
dojo.forEach(_2b,function(_2d){
if(_2d.parentElement&&(!_2d.parentElement.classList||(_2d.parentElement.classList&&!_2d.parentElement.classList.contains("vcard")))){
_29=dojo.string.substitute(dojo.cache(_4),{href:_2d.getAttribute("href"),url:_2d.innerText||_2d.innerHTML});
if(_2c){
_19(_2d.getAttribute("href"));
_2c=false;
}
_28=_28.replace(_2d.outerHTML,_29+"\u200b");
}
});
}
_27.dataValue=_28;
};
_18.on("instanceReady",function(evt){
if(_18.mode==="wysiwyg"){
_18.on("afterCommandExec",_25);
_18.on("paste",_26,this,null,999);
_18.document.on(dojo.isIE||_3?"keydown":"keyup",_24);
}
});
}});
};
})();
}


;if(!dojo._hasResource["lconn.core.ckeditor"]){
dojo._hasResource["lconn.core.ckeditor"]=true;
(function(){
dojo.provide("lconn.core.ckeditor");




























var _1=net.jazz.ajax.xdloader,_2=[],_3=[],_4=["lconn.core.ckplugins.icdocpicker","lconn.core.ckplugins.icpublishBinaryData","lconn.core.ckplugins.mentions"],_5=["lconn.core.ckplugins.mentions","lconn.core.ckplugins.urlDetect"];
window.CKEDITOR_GETURL=function(_6){
if(!CKEDITOR||!CKEDITOR.basePath||!CKEDITOR.timestamp){
return null;
}
var u=lconn.core.url.parse(_6);
if(!u.scheme&&_6.indexOf("/")!==0){
_6=CKEDITOR.basePath+_6;
}
if(_6.charAt(_6.length-1)!="/"){
_6=_7(_6);
}
return _6;
};
function _7(_8){
return lconn.core.url.rewrite(_8,{t:CKEDITOR.timestamp,etag:dojo.getObject("ibmConfig.versionStamp")});
};
function _9(_a,_b){
var ep=_b?_b.extraPlugins||"":CKEDITOR.config.extraPlugins,_c=ep?ep.split(","):[];
if(ep.indexOf(_a)==-1){
_c.push(_a);
if(_b){
_b.extraPlugins=_c.join(",");
}else{
CKEDITOR.config.extraPlugins=_c.join(",");
}
}
};
function _d(p,_e){
var o=dojo.getObject(p);
if(dojo.isFunction(o.isEnabled)&&!o.isEnabled()){
if(dojo.config.isDebug){
console.info("lconn.core.ckeditor: registered plugin '"+p+"' is not enabled.");
}
return;
}
if(dojo.isFunction(o.addPlugin)){
o.addPlugin();
}else{
console.warn("lconn.core.ckeditor: registered plugin '"+p+"' does not implement an addPlugin() method.");
}
lconn.core.ckeditor.addCustomConfig(function(_f){
_9(o.getName(),_f);
if(dojo.isFunction(o.addCustomConfig)){
o.addCustomConfig(_f);
}
});
};
function _10(_11){
var as=dojo.query("head link[rel=stylesheet]"),hr=dojo.map(as,function(lnk){
return lnk.href;
}),st=dojo.filter(hr,function(_12){
return _12.indexOf("ckeditor")===-1;
});
return st.concat(_7(CKEDITOR.basePath+(_11?"contentsLite.css":"contents.css")));
};
function _13(){
var _14="",_15=",Arial,Helvetica,sans-serif";
if(lconn.core.locale.getLanguage()==="ja"){
_14+=";MS Gothic/'MS UI Gothic','MS PGothic',Meiryo,'Sazanami Gothic','Hiragino Kaku Gothic Pro'"+_15;
}else{
if(lconn.core.locale.getLanguage()==="ko"){
_14+=";Gulim/Gulim,Dotum,'Malgun Gothic','Baekmuk Gulim',AppleGothic"+_15;
}else{
if(lconn.core.locale.getLanguage()==="zh"){
if(lconn.core.locale.getCountry()==="tw"){
_14+=";PMingLiU/PMingLiU,'AR PL ZenKai Uni','Apple LiGothic'"+_15;
}else{
_14+=";SimSun/SimSun,'AR PL ShanHeiSun Uni',STHeiti"+_15;
}
}
}
}
CKEDITOR.config.font_names+=_14;
};
function _16(_17){
(_17.lite?lconn.core.config.ckeditorLite:com.ibm.oneui.ckeditor.editor.dojoconfig).execCustomConfig();
CKEDITOR.editorConfig(_17);
var _18={customConfig:"",language:dojo.config.locale,ibmHelpDocumentationUrl:lconn.core.ckeditor.getHelpUrl,contentsCss:_10(_17.lite)},_19={mode:function(ev){
if(ev.editor.mode==="wysiwyg"){
var _1a=ev.editor.document.getBody();
["lconnRTE","lotusui30","lotusui30_body","lotusui30dojo","lotusui30_fonts"].forEach(function(_1b){
_1a.addClass(_1b);
});
if(_17.lite){
_1a.setAttribute("role","application");
_1a.setAttribute("aria-label",_17.title||"text area");
}
}
}},_1c;
switch(lconn.core.theme.getCurrentThemeId()){
case "hikari":
_18.skin="ibmdesign";
break;
case "gen4":
_18.skin="oneui3";
break;
default:
_18.skin="oneui3";
}
if(_17.lite){
_18.removePlugins=_17.autoGrow?_17.removePlugins:"autogrow";
if(lconn.core.globalization.api.isBidiEnabled()){
var _1d=lconn.core.globalization.api.getTextDirection();
if(_1d==lconn.core.globalization.config.TEXT_DIRECTION.LEFT_TO_RIGHT){
_17.contentsLangDirection="ltr";
}else{
if(_1d==lconn.core.globalization.config.TEXT_DIRECTION.RIGHT_TO_LEFT){
_17.contentsLangDirection="rtl";
}else{
_17.contentsLangDirection=document.dir;
}
}
}
}else{
if(lconn.share.util.configUtil.isBoxlinksEnabledForCkeditor()){
_1c={link:{buttonClass:"cke_button_link",commands:["link","linkToFiles"]},embedPreview:{buttonClass:"cke_button_embedPreview",commands:["iframePicker"]}};
}else{
_1c={link:{buttonClass:"cke_button_link",commands:["link","linkToFiles"]}};
}
dojo.mixin(_17.menus,_1c);
}
if(!_17.on){
_17.on={};
}
dojo.mixin(_17.on,_19);
dojo.mixin(_17,_18);
_13();
dojo.forEach(_2,function(_1e){
_1e(_17);
});
if(dojo.isFunction(_17.customConfigMethod)){
_17.customConfigMethod(_17);
}
_2=[];
};
lconn.core.ckeditor={applyCustomConfig:function(_1f){
var _20=_1f.customPlugins?dojo._toArray(_1f.customPlugins):_3;
var _21=_20.concat(_1f.lite?_5:_4);
if(_1f.disableURLDetect){
_21.splice(dojo.indexOf(_21,"lconn.core.ckplugins.urlDetect"),1);
}
dojo.forEach(_21,function(_22){
dojo.require(_22);
_d(_22,_1f);
});
_16(_1f);
},addCustomConfig:function(f){
_2.push(f);
},addCustomPlugin:function(p){
dojo.deprecated("Add the plugins as an input param (array) when creating the instance of the editor, ie: lconn.core.ckeditor.replace(location, {customPlugins: ['plugin1','plugin2']})","6.0");
_3.push(p);
},addExtraPlugin:function(n,_23){
_9(n,_23);
},replace:function(){
lconn.core.ckeditor.async("replace",dojo._toArray(arguments));
},appendTo:function(){
lconn.core.ckeditor.async("appendTo",dojo._toArray(arguments));
},async:function(_24,_25){
var _26=_25&&_25[1]||{};
_1.load_layer_async("lconn.core.ckeditorstatic",["lconn.core.ckeditor"],dojo.hitch(_26,function(){
lconn.core.ckeditor.applyCustomConfig(this);
if(typeof _24=="function"){
_24(CKEDITOR);
}else{
CKEDITOR[_24].apply(this,_25);
}
}));
},getHelpUrl:function(_27){
var _28="/topic/"+(_27||"com.ibm.lotus.connections.common.help/eucommon_ckeditor.html");
return lconn.core.help.getProductHelpUrl(_28);
}};
})();
}


;if(!dojo._hasResource["lotuslive.widgets.ckeditor"]){
dojo._hasResource["lotuslive.widgets.ckeditor"]=true;
dojo.provide("lotuslive.widgets.ckeditor");




(function(_1,_2){
var _3=lconn.core.ckeditor,_4=_3.getHelpUrl;
_3.getHelpUrl=function(_5){
var _6="/support/knowledgecenter/SSL3JX/welcome/richtext_editor.html";
return lconn.core.help.getProductHelpUrl(_6);
};
})(window,document);
}


;if(!dojo._hasResource["lconn.core.bizCard.bizCardUtils"]){
dojo._hasResource["lconn.core.bizCard.bizCardUtils"]=true;
dojo.provide("lconn.core.bizCard.bizCardUtils");




(function(){
var _1=dojo;
var _2=null;
var _3=function(){
if(!_2){
try{
_2=_1.i18n.getLocalization("lconn.profiles.bizCard","ui");
}
catch(e){
}
}
};
var _4="_ICBizCardLink";
lconn.core.bizCard.bizCardUtils={isDebug:false,scriptResourceName:"semanticTagService.js",version:"4.0",scripts:new Array(),_loadedCss:new Array(),initiated:false,_haveProxy:false,_proxyHelper:null,_allowJsonp:false,baseUrl:null,resourcesUrl:null,appChksum:null,liveElemPrefix:"semtag_live_",hoverIdx:0,hoverIdAttr:"icBizCard_idx",refcntAttr:"icBizCard_ref",setDojoObject:function(d){
if(typeof d=="object"){
_1=d;
}
},getDojoObject:function(){
return _1||dojo;
},init:function(_5){
if(this.initiated){
return;
}
var _6=window.SemTagSvcConfig||{};
this.resourcesUrl=_6.resourcesSvc||null;
if(_6.allowJsonp){
this._allowJsonp=true;
}
_3();
this.baseUrl=lconn.core.bizCard.bizCardUtils.initBaseUrl();
this._initProxyHelper();
this._initAppCksum();
if(_6.loadCssFiles&&!window.SemTagPersonConfig_noCss){
var _7=(window.SemTagSvcConfig&&SemTagSvcConfig.isBidiRTL);
if(!SemTagSvcConfig.isPortal){
this.loadCss(this.resourcesUrl+"/web/_style"+"?include=com.ibm.lconn.core.styles.oneui3/base/package3"+(_7?"RTL":"")+".css&exclude=org.dojotoolkit.dojo/resources/dojo.css",{id:"ibmConnect_CSS_package3"});
this.loadCss(this.resourcesUrl+"/web/_style"+"?include=com.ibm.lconn.core.styles.oneui3/sprites"+(_7?"RTL":"")+".css&exclude=org.dojotoolkit.dojo/resources/dojo.css",{id:"ibmConnect_CSS_sprites"});
this.loadCss(this.resourcesUrl+"/web/_lconntheme/default.css?version=oneui3"+(_7?"&rtl=true":"")+"&exclude=org.dojotoolkit.dojo/resources/dojo.css",{id:"ibmConnect_CSS_default"});
try{
var _8="\t\t\t\t\t\t.lotusui30 .lotusVCard .lotusPersonInfo {\t\t\t\t\t\t\toverflow: hidden;\t\t\t\t\t\t}\t\t\t\t\t\t.lotusui30 .lotusInlineVCard .lotusAppLinks a {\t\t\t\t\t\t\tborder-width: 0;\t\t\t\t\t\t}\t\t\t\t\t\t.lotusui30 .lotusInlineVCard .lotusPersonInfo h2 {\t\t\t\t\t\t\twidth: 105px;\t\t\t\t\t\t}\t\t\t\t\t\t.lotusui30 .lotusInlineVCard .lotusInfo .lconnSprite-iconAttention16 {\t\t\t\t\t\t\tdisplay: none;\t\t\t\t\t\t}\t\t\t\t\t\t.lotusui30 .lotusInlineVCard .lotusInfo {\t\t\t\t\t\t\tborder: 0;\t\t\t\t\t\t\tbackground-color: transparent;\t\t\t\t\t\t\tfont-size: 1em;\t\t\t\t\t\t\tpadding: 5px 10px 0;\t\t\t\t\t\t}\t\t\t\t\t\t.lotusui30 .lotusInlineVCard .lotusInfo span {\t\t\t\t\t\t\tmargin: 0;\t\t\t\t\t\t}\t\t\t\t\t";
if(_7){
_8+="\t\t\t\t\t\t\t.lotusui30 .lotusInlineVCard .lotusPhoto img {\t\t\t\t\t\t\t\theight: 35px;\t\t\t\t\t\t\t\twidth: 35px;\t\t\t\t\t\t\t}\t\t\t\t\t\t\t.lotusui30 .lotusInlineVCard, .lotusui30 .lotusInlineVCard .lotusContainer {\t\t\t\t\t\t\t\twidth: 175px;\t\t\t\t\t\t\t}\t\t\t\t\t\t\t.lotusui30 .lotusInlineVCard h2 {\t\t\t\t\t\t\t\tcolor: #444444;\t\t\t\t\t\t\t\tfont-size: 1.2em;\t\t\t\t\t\t\t\tfont-weight: bold;\t\t\t\t\t\t\t\tline-height: 1.3;\t\t\t\t\t\t\t\tmargin-right: 55px!important;\t\t\t\t\t\t\t\tpadding: 0;\t\t\t\t\t\t\t}\t\t\t\t\t\t\t.lotusui30 .lotusInlineVCard .lotusPhoto {\t\t\t\t\t\t\t\tborder-width: 0;\t\t\t\t\t\t\t\tmargin-top: 5px;\t\t\t\t\t\t\t\tpadding: 0;\t\t\t\t\t\t\t}\t\t\t\t\t\t";
}
var _9=dojo.create("style",{type:"text/css"});
if(_9.styleSheet){
_9.styleSheet.cssText=_8;
}else{
dojo.place(dojo.doc.createTextNode(_8),_9);
}
dojo.place(_9,dojo.body(),"first");
}
catch(ee){
if(this.isDebug&&window.console){
console.log(ee);
}
}
this.standaloneCSSloaded=true;
}
}
this.isDebug=(window.location.search.indexOf("debug=bizcard")!=-1);
setTimeout(function(){
if(window.LCSemTagMenu&&!dojo.byId(LCSemTagMenu.id)){
LCSemTagMenu.createMenuTag();
}
},100);
this.initiated=true;
},printDebug:function(_a){
if(this.isDebug&&window.console){
var d=new Date();
if(dojo.config.isDebug){
console.debug("["+d.toLocaleTimeString()+"."+d.getMilliseconds()+"] lconn.core.bizCard.bizCardUtils: "+_a);
}
}
},_sametimeModulesLoaded:false,loadSametimeModules:function(){
if(lconn.core.bizCard.bizCardUtils._sametimeModulesLoaded){
return;
}
try{
var _b=[];
if(_1.exists("lconn.core.config.services")){
if(lconn.core.config.services.sametimeProxy&&!_1.exists("lconn.profiles.sametime.sametimeProxyAwareness")){
_b.push("lconn.profiles.sametime.sametimeProxyAwareness");
}else{
if(_1.exists("SemTagSvcConfig.sametimeAwarenessEnabled")&&SemTagSvcConfig.sametimeAwarenessEnabled==true&&lconn.core.config.services.profiles&&!_1.exists("lconn.profiles.sametime.sametimeAwareness")){
_b.push("lconn.profiles.sametime.sametimeAwareness");
}
}
}
if(_b.length){
if(_1.exists("net.jazz.ajax.xdloader.load_async")){
net.jazz.ajax.xdloader.batch_load_async(_b,function(){
});
}else{
dojo.forEach(_b,_1.require);
}
lconn.core.bizCard.bizCardUtils._sametimeModulesLoaded=true;
}
}
catch(e){
if(window.console){
console.error("Unable to load Sametime modules");
console.error(e);
}
}
},initBaseUrl:function(){
var _c="";
if(window.SemTagSvc_baseUrl!=null){
_c=SemTagSvc_baseUrl;
}else{
if(window.SemTagSvcConfig!=null&&SemTagSvcConfig.baseUrl!=null){
_c=SemTagSvcConfig.baseUrl;
}else{
_c=this.getURL(this.scriptResourceName,"script",SemTagSvc.baseUrl,"src").baseUrl;
}
}
return _c;
},_initProxyHelper:function(){
if(window.SemTagSvcConfig!=null&&typeof (window.SemTagSvcConfig.proxyURL)!="undefined"&&window.SemTagSvcConfig.proxyURL.length>0){
this._haveProxy=true;
this._proxyHelper=new lconn.core.url.ProxyUrlHelper(window.SemTagSvcConfig.proxyURL);
}
},_initAppCksum:function(){
this.appChksum=this._getConfigValue("appChksum","UNDEFINED");
},_getConfigValue:function(_d,_e){
if(window.SemTagSvcConfig!=null&&typeof (window.SemTagSvcConfig[_d])!="undefined"){
return window.SemTagSvcConfig[_d];
}
return _e;
},appendAppChkSum:function(_f){
if(_f==null||_f.indexOf("etag=")>=0){
return _f;
}
var c=null;
if(_f.indexOf("?")<0){
c="?";
}else{
c="&";
}
return _f+c+"etag="+this.appChksum;
},getService:function(_10){
for(i=0;window.livetextCfg!=null&&i<window.livetextCfg.length;i++){
var _11=window.livetextCfg[i];
if(_11.id==_10){
return _11;
}
}
return null;
},processUntilAvailable:function(_12,_13,_14){
var _15="";
_15=window.setInterval(function(){
if(eval(_13)){
if(_14!=null){
_12(_14);
}else{
_12();
}
window.clearInterval(_15);
}
},300);
},getBaseURL:function(_16){
var _17=lconn.core.bizCard.bizCardUtils.getService(_16);
if(_17!=null&&_17.baseURL!=null){
return _17.baseURL;
}else{
if(this.initiated){
return this.baseUrl;
}else{
return lconn.core.bizCard.bizCardUtils.initBaseUrl();
}
}
},buildBaseURL:function(_18){
var _19=_18.indexOf("//")+2;
var _1a=_18.substring(0,_19);
var _1b=_18.substring(_19,_18.length);
_19=_1b.indexOf("/")+1;
var _1c=_1b.substring(0,_19);
_1b=_1b.substring(_19,_1b.length);
_19=_1b.indexOf("/");
var _1d=_1b.substring(0,_19);
_1b=_1b.substring(_19,_1b.length);
var _1e=_1a+_1c+_1d;
return _1e;
},getURL:function(_1f,_20,_21,_22){
var _23={};
var _24=location.protocol+"//"+location.host;
var s=document.getElementsByTagName(_20);
var _25="";
var _26=null;
for(var i=0;i<s.length;i++){
var src=s[i].getAttribute(_22);
if(src&&src.indexOf(_1f)!=-1){
_26=src;
_25=src.substring(0,src.indexOf(_21));
if(_21==null){
_25=this.buildBaseURL(src);
_23.baseUrl=_25;
}
_23.resourceFound=true;
break;
}
}
if(_23.baseUrl=="undefined"){
_23.baseUrl=(_25==_24)?_21:_25+_21;
}
return _23;
},getUrlParam:function(_27){
var _28={};
var loc=location.href;
if(loc.indexOf("?")>-1){
loc=loc.substring(loc.indexOf("?")+1);
if(loc.indexOf("#")>-1){
loc=loc.split("#")[0];
}
_28=dojo.queryToObject(loc);
}
var _29=_28[_27];
if(dojo.isArray(_29)&&_29!=null&&_29.length>0){
return _29[0];
}else{
if(typeof _29==="string"){
return _29;
}
}
return null;
},getProxifiedURL:function(url,_2a,_2b,_2c){
if(typeof _2c==="undefined"){
_2c=true;
}
for(var key in _2a){
if(key=="LANG"&&_2a[key]==""){
var _2d=new RegExp("&lang=@@@"+key+"@@@");
}else{
var _2d=new RegExp("@@@"+key+"@@@");
}
var val=_2a[key];
url=url.replace(_2d,val);
}
if(_2c){
url=this.appendAppChkSum(url);
}
url+="&suppress401=true";
if(this._haveProxy){
return this._proxyHelper.getProxifiedURL(url);
}
if(this._allowJsonp&&typeof _2b==="string"){
url+="&callback="+_2b;
}
return url;
},_timeout:10000,getBizCardData:function(url,_2e,_2f,_30,_31,_32,_33){
var url=this.getProxifiedURL(url,_2e,_2f);
if(!this._allowJsonp||this._haveProxy){
var _34=function(_35){
var _36=dojo.fromJson(_35.replace(/^\s*while\(1\);/,""));
_31(true,_36,_32);
};
var _37=function(_38){
_31(false,_38,_32);
};
dojo.xhrGet({url:url,timeout:this._timeout,load:_34,error:_37,contentType:"application/json"});
}else{
_30.request(url,this._timeout,_31,_32,_33);
}
},out:function(){
this.buffer="";
this.write=function(str){
this.buffer+=str;
};
},getSinglePropertyValue:function(_39){
if(!_39){
return false;
}
var _3a=_39.innerHTML.replace(/<[a-zA-Z\/][^>]*>/gi,"");
return _3a;
},sortByOrder:function(a,b){
if(a.order>b.order){
return 1;
}else{
if(a.order<b.order){
return -1;
}else{
return 0;
}
}
},getElementsByClassName:function(_3b,_3c,_3d,_3e){
if(!_3c){
_3c=document.body;
}
if(!_3d){
limit=0;
}
if(!_3e){
_3e=["*"];
}
var _3f=new RegExp("(^|\\s)"+_3b+"(\\s|$)");
if(_3c&&_3c.className&&_3c.className.match(_3f)){
return new Array(_3c);
}
var _40=new Array();
for(var t=0;t<_3e.length;t++){
var _41=_3c.getElementsByTagName(_3e[t]);
for(var i=0;i<_41.length;i++){
var _42=_41[i];
if(_42.className&&_42.className.match&&_42.className.match(_3f)){
_40.push(_42);
}
if(0<_3d&&_3d==_40.length){
break;
}
}
}
return _40;
},getParentByClassName:function(_43,_44){
if(!_44){
return null;
}
var _45=new RegExp("(^|\\s)"+_43+"(\\s|$)");
if(_44.className&&_44.className.match(_45)){
return _44;
}
while(_44.parentNode){
_44=_44.parentNode;
if(_44.className&&_44.className.match(_45)){
return _44;
}
}
},getConnectedElement:function(_46,_47){
var el=this.getParentByClassName(_46,_47);
if(el){
return el;
}
el=_47;
while(el){
var arr=dojo.query("["+_4+"=\""+el.id+"\"]");
if(arr&&arr.length>0){
return arr[0];
}
el=el.parentNode;
}
return el;
},_getAltOrTitleFromElement:function(el){
var alt="";
try{
if(el){
if(el.textContent||el.innerText){
var _48=dojo.clone(el);
try{
dojo.query("*",_48).forEach(function(_49){
if(_49&&(dojo.hasClass(_49,"lotusHidden")||_49.style.display=="none")){
_49.parentNode.removeChild(_49);
}
});
}
catch(e){
}
alt=dojo.trim((dojo.isIE?_48.innerText:_48.textContent));
}else{
if(el.tagName&&el.tagName.toUpperCase()==="IMG"){
if(dojo.hasAttr(el,"title")){
alt=dojo.trim(dojo.attr(el,"title"));
}else{
if(dojo.hasAttr(el,"alt")){
alt=dojo.trim(dojo.attr(el,"alt"));
}
}
}else{
if(el.parentNode){
dojo.query(".x-lconn-displayname",el.parentNode).forEach(function(_4a){
if(_4a.textContent||_4a.innerText){
alt=dojo.trim((dojo.isIE?_4a.innerText:_4a.textContent));
}
});
}
}
}
}
}
catch(e){
}
return alt;
},_getAltMessage:function(_4b,_4c){
_3();
if(typeof _4c=="undefined"){
_4c="label.semtag.hover.alt";
}
var _4d=_2["label.semtag.hover"];
try{
var _4e=lconn.core.bizCard.bizCardUtils._getAltOrTitleFromElement(_4b);
if(_4e.length==0){
for(var ii=0;ii<_4b.childNodes.length;ii++){
_4e=lconn.core.bizCard.bizCardUtils._getAltOrTitleFromElement(_4b.childNodes[ii]);
if(_4e.length>0){
break;
}
}
}
if(_4e.length>0){
_4d=(_2[_4c]).replace("{0}",_4e);
}
}
catch(e){
}
return _4d;
},_overrideTimeout:null,addOverride:function(_4f,_50){
var str=_4f.innerHTML;
if(str.charAt(0)==="@"){
str=dojox.string.BidiComplex.stripSpecialCharacters(str);
if(str.charAt(1)==="@"){
str=str.substring(1);
}
if(!dojo.isBodyLtr()||window.getComputedStyle(_4f,null).direction==="rtl"){
str=lconn.core.globalization.bidiUtil.LRE+"@"+str.substring(1)+lconn.core.globalization.bidiUtil.PDF;
}
while(_4f.firstChild){
_4f.removeChild(_4f.firstChild);
}
_4f.appendChild(document.createTextNode(str));
var e=_4f;
while(e.nodeName!="DIV"){
if(e.nodeName==="P"){
break;
}else{
e=e.parentNode;
}
}
if(e.dir!=""&&e.style.textAlign===""){
e.style.textAlign=(e.dir==="rtl")?"right":"left";
}
}
if(dojo.hasAttr(_4f,"_bizcardprocessed_")){
return;
}
try{
dojo.attr(_4f,{"_bizcardprocessed_":"true","role":"button"});
var _51=function(evt){
LCSemTagMenu.isAccessibleOpen=true;
_50(evt);
dojo.stopEvent(evt);
};
var _52=function(el){
return (dojo.hasAttr(_4f,"href_bc_"));
};
var _53=function(el,yn){
if(yn){
if(dojo.hasAttr(_4f,"href")&&dojo.attr(_4f,"href")!=="javascript:;"){
dojo.attr(_4f,"href_bc_",dojo.attr(_4f,"href"));
dojo.attr(_4f,"href","javascript:;");
}
}else{
if(_52(el)){
dojo.attr(_4f,"href",dojo.attr(_4f,"href_bc_"));
dojo.removeAttr(_4f,"href_bc_");
}
}
};
setTimeout(function(){
_53(_4f,true);
},1);
dojo.connect(_4f,"onclick",dojo.hitch(this,function(_54){
if(_52(_4f)){
_51(_54);
}else{
if(this._overrideTimeout){
clearTimeout(this._overrideTimeout);
}
}
}));
dojo.connect(_4f,"onmouseover",dojo.hitch(this,function(_55){
_53(_4f,false);
if(dojo.exists("LCSemTagMenu.preventFocus")){
dojo.setObject("LCSemTagMenu.preventFocus_prev",LCSemTagMenu.preventFocus);
}
dojo.setObject("LCSemTagMenu.preventFocus",true);
this._overrideTimeout=setTimeout(function(){
_50(_55);
this._overrideTimeout=null;
},window.LCSemTagMenu.showDelay);
}));
dojo.connect(_4f,"onmouseout",dojo.hitch(this,function(_56){
_53(_4f,true);
if(this._overrideTimeout){
clearTimeout(this._overrideTimeout);
}
LCSemTagMenu.unfocus(_56);
setTimeout(function(){
if(dojo.exists("LCSemTagMenu.preventFocus_prev")){
dojo.setObject("LCSemTagMenu.preventFocus",LCSemTagMenu.preventFocus_prev);
dojo.setObject("LCSemTagMenu.preventFocus_prev",undefined);
}else{
dojo.setObject("LCSemTagMenu.preventFocus",undefined);
}
},LCSemTagMenu.hideDelay+100);
}));
}
catch(e){
if(window.console){
console.error("Error in lconn.core.bizCard.bizCardUtils.addOverride");
console.error(e);
}
}
try{
if(lconn.core.auth.getUser().isExternal){
dojo.attr(_4f,"href","javascript:;");
dojo.connect(_4f,"click",function(_57){
_51(_57);
});
}
}
catch(e){
}
},addPostLink:function(_58,_59){
if(dojo.hasAttr(_58,"_bizcardprocessed_")){
return;
}
dojo.attr(_58,"_bizcardprocessed_","true");
var _5a=(new String(Math.random())).substring(2);
dojo.attr(_58,_4,_5a);
var _5b=this._getAltMessage(_58);
var _5c=dojo.create("a",{"role":"button","aria-haspopup":"true","href":"javascript:;","aria-controls":LCSemTagMenu.id,"id":_5a});
dojo.connect(_5c,"onclick",_59);
dojo.create("img",{"src":(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif?etag=20160903.134200")),"className":"lconnSprite lconnSprite-iconContext","alt":_5b,"title":_5b,"style":{"display":"inline","margin":"0 3px","padding":"0 1px"}},_5c);
dojo.create("span",{"className":"lotusAltText",innerHTML:"&#9660;"},_5c);
dojo.place(_5c,_58,"after");
},addHover:function(_5d,_5e,_5f,_60){
dojo.attr(_5d,"aria-describedby","semtagmenu");
var _61=_5d.getAttribute(this.refcntAttr);
if(_61){
_5d.setAttribute(this.refcntAttr,parseInt(Number(_61)+1));
if(LCSemTagMenu.staticHover){
var img=LCSemTagMenu.findHoverFromLiveElement(_5d);
if(img){
dojo.connect(img,"onclick",_5f);
img.setAttribute("href","javascript:;");
}else{
this.printDebug("couldn't find the hover for this element!");
}
}else{
var _62=dojo.isFF?_5d.getAttribute("class"):_5d.className;
if(_62.indexOf("hasHover")==-1){
dojo.connect(_5d,"onmouseover",_5e);
dojo.connect(_5d,"onfocus",_5e);
dojo.connect(_5d,"onmouseout",function(evt){
LCSemTagMenu.unfocus(evt);
});
if(!dojo.isIE){
dojo.connect(_5d,"onblur",function(evt){
LCSemTagMenu.unfocus(evt);
});
}
}else{
this.printDebug("attempting to connect repeated events to element: "+_5d);
}
}
}else{
_5d.setAttribute(this.refcntAttr,"1");
this.hoverIdx++;
_5d.setAttribute(this.hoverIdAttr,parseInt(this.hoverIdx));
if(LCSemTagMenu.staticHover){
var img=this.createHoverImage();
dojo.connect(img,"onclick",_5f);
img.setAttribute("href","javascript:;");
var _63=_5d.nextSibling;
if(_63){
_63.parentNode.insertBefore(img,_63);
}else{
_5d.parentNode.appendChild(img);
}
_5d.setAttribute(this.hoverIdAttr,parseInt(this.hoverIdx));
_5d.id=this.liveElemPrefix+this.hoverIdx;
}else{
var _62=dojo.isFF?_5d.getAttribute("class"):_5d.className;
if(_62&&0<_62.length){
_62+=" hasHover";
}else{
_62="hasHover";
}
if(dojo.isFF){
_5d.setAttribute("class",_62);
}else{
_5d.className=_62;
}
dojo.connect(_5d,"onmouseover",_5e);
dojo.connect(_5d,"onfocus",_5e);
dojo.connect(_5d,"onmouseout",function(evt){
LCSemTagMenu.unfocus(evt);
});
if(!dojo.isIE){
dojo.connect(_5d,"onblur",function(evt){
LCSemTagMenu.unfocus(evt);
});
}
}
if(_60!=null){
dojo.connect(_5d,"onkeydown",_60);
}
}
try{
dojo.query("> *:not(.hasHover)",_5d).forEach(dojo.hitch(this,function(_64){
if(!dojo.hasClass(_64,"lotusHidden")&&_64.style.display!="none"){
this.addHover(_64,_5e,_5f,_60);
}
}));
}
catch(e){
}
},createHoverImage:function(){
var img=document.createElement("img");
this.hoverIdx++;
img.id=this.hoverIdAttr+this.hoverIdx;
img.className=LCSemTagMenu.iconName;
img.setAttribute("src",this.baseUrl+"/images/menu_selected_hover.gif");
img.setAttribute("border","0");
var _65=document.createElement("a");
dojo.connect(_65,"onfocus",LCSemTagMenu.activateHover);
dojo.connect(_65,"onmouseover",LCSemTagMenu.activateHover);
dojo.connect(_65,"onmouseout",LCSemTagMenu.deactivateHover);
_65.appendChild(img);
return _65;
},showHover:function(_66,_67){
this.printDebug("in showHover");
try{
if(LCSemTagMenu.showing){
LCSemTagMenu.clearTimeouts();
LCSemTagMenu.showHover(_66,_67);
}else{
LCSemTagMenu.startShowTimer(_66,_67);
}
}
catch(e){
console.error("Error in lconn.core.bizCard.bizCardUtils.showHover");
console.error(e);
}
},setMenuData:function(_68,_69,_6a,_6b,_6c){
LCSemTagMenu.setMenuData(_68,_69,_6a,_6b,_6c);
},getMenuItemJson:function(_6d,_6e,_6f,_70){
var o=_6f?_6f:0;
var i=_70?_70:"";
return {"label":_6d,"href":_6e,"order":o,"icon":i};
},getMenuHeaderJson:function(_71,_72){
return {"markup":_71,"order":_72};
},getMenuFooterJson:function(_73,_74){
return {"markup":_73,"order":_74};
},getElementFromEvent:function(_75){
return _75.target?_75.target:_75.srcElement;
},getLiveElementFromEvent:function(_76){
return LCSemTagMenu.findLiveElementFromEventSource(this.getElementFromEvent(_76));
},getEventAbsoluteX:function(e){
var x=0;
if(e.pageX){
x=e.pageX;
}else{
if(e.clientX){
x=e.clientX+document.body.scrollLeft;
}
}
return x;
},getEventAbsoluteY:function(e){
var y=0;
if(e.pageY){
y=e.pageY;
}else{
if(e.clientY){
y=e.clientY+document.body.scrollTop;
}
}
return y;
},getStyle:function(_77,_78){
var _79;
if(window.getComputedStyle){
_79=document.defaultView.getComputedStyle(_77,null).getPropertyValue(_78);
}else{
if(_77.currentStyle){
_79=_77.currentStyle[_78];
}
}
return _79;
},createGroupJson:function(ctx,_7a){
return {"context":ctx,"extenders":_7a};
},createActionJson:function(id,ctx,_7b,_7c,url,_7d){
var o=parseInt(_7d);
return {"id":id,"context":ctx,"label":_7b,"description":_7c,"url":url,"order":o};
},parseOrder:function(_7e){
if(_7e==null||_7e.length==0){
return 0;
}
if(_7e.charAt(0)=="-"){
return parseInt(_7e.substr(1))*-1;
}else{
return parseInt(_7e);
}
},_langParamValue:"",getLangParam:function(){
var _7f=null;
var _80=dojo.getObject("lconn.core.LanguageSelector.COOKIE_NAME");
if(dojo.cookie&&(_80!="undefined")&&(_80!=null)){
_7f=dojo.cookie(_80);
}
if(_7f==null||_7f==""){
_7f=this.getUrlParam("lang");
}
if(_7f==null||_7f==""){
if(window.djConfig!=null&&djConfig.locale!=null){
_7f=djConfig.locale;
if(_7f=="pt-pt"){
_7f="pt";
}
}
}
if(_7f==null||_7f==""){
_7f="en";
}
_7f=_7f.replace(/\-/g,"_");
_7f=_7f.toLowerCase();
this._langParamValue=_7f;
return this._langParamValue;
},getTextValue:function(_81){
if(!_81){
return "";
}
return _81.innerHTML.replace(/<[a-zA-Z\/][^>]*>/gi,"");
},getTypedValue:function(_82,_83){
if(!_83){
_83="def";
}
var _84=new Array();
var _85=this.getElementsByClassName("type",_82);
var _86=this.getElementsByClassName("value",_82);
var _87="";
if(_86.length<1){
_87=this.getTextValue(_82);
}
for(i=0;i<_86.length;i++){
_87+=this.getTextValue(_86[i]);
}
if(_85.length<1){
_84[_83]=_87;
}else{
for(j=0;j<_85.length;j++){
var _88=_85[j];
var _89=_88.tagName.match(/^abbr$/i)?_88.getAttribute("title"):this.getTextValue(_88);
_84[_89.toLowerCase()]=_87;
}
}
return _84;
},findNameElementInHcard:function(_8a){
if(_8a.className!="vcard"){
_8a=this.getParentByClassName("vcard",_8a);
}
var _8b=this.getElementsByClassName("fn",_8a)[0];
if(!_8b){
_8b=this.getElementsByClassName("n",_8a)[0];
}
return _8b;
},findElementByNameInHcard:function(_8c,_8d){
if(_8c.className!="vcard"){
_8c=this.getParentByClassName("vcard",_8c);
}
return this.getElementsByClassName(_8d,_8c)[0];
},loadScript:function(_8e){
var _8f=this.getLangParam();
if(_8e.indexOf("lang=")!=-1&&_8f!=null){
_8e=_8e.substring(0,_8e.indexOf("lang"))+"lang="+_8f;
}else{
if(_8e.indexOf("resourcebundle")!=-1&&_8f!=null){
_8e=_8e+"&lang="+_8f;
}
if(_8e.indexOf("resourceStrings")!=-1&&_8f!=null){
_8e=_8e+"&lang="+_8f;
}
if(_8e.indexOf("js-resources.js")!=-1&&_8f!=null){
_8e=_8e+((_8e.indexOf("?")!=-1)?"&":"?")+"lang="+_8f;
}
}
_8e=this.appendAppChkSum(_8e);
if(!this.scripts[_8e]){
this.scripts[_8e]=true;
var _90=document.createElement("script");
_90.src=_8e;
document.body.insertBefore(_90,document.body.firstChild);
}
},loadCss:function(css,_91){
_91=_91||{};
css=this.appendAppChkSum(css);
var _92=false;
for(var ii=0;ii<this._loadedCss.length;ii++){
if(this._loadedCss[ii].href==css){
_92=true;
break;
}
}
if(!_92){
var el=dojo.create("link",{href:css,rel:"stylesheet",type:"text/css",media:"screen"});
dojo.mixin(el,_91);
var _93=function(){
var _94=dojo.doc.getElementsByTagName("head");
if(!_94||!_94[0]){
_94=dojo.doc.getElementsByTagName("body");
}
if(!_94||!_94[0]){
return null;
}else{
return _94[0];
}
};
var _95=null;
if(this._loadedCss.length>0){
var _96=this._loadedCss[this._loadedCss.length-1];
if(_96){
_95=dojo.place(el,_96,"after");
}else{
_95=dojo.place(el,_93(),"first");
}
}else{
_95=dojo.place(el,_93(),"first");
}
this._loadedCss.push(_95);
return true;
}
return false;
},toggleInlineCard:function(_97){
var _98=dojo.doc.getElementById(_97+"_Pivot");
var _99=dojo.doc.getElementById(_97+"_Details");
if(_98!=null&&_99!=null){
if(_98.className.indexOf("lotusPivotNavOpen")!=-1){
_98.className="lotusPivotNav";
_99.style.display="none";
}else{
_98.className="lotusPivotNav lotusPivotNavOpen";
_99.style.display="block";
}
}
}};
window.LCSemTagMenu={isDebug:false,staticHover:false,focusRestored:false,preventFocus:false,id:"semtagmenu",hideDelay:500,showDelay:500,timeouts:new Array(),iconName:"menu_drop_icon",showing:false,currentElem:null,refCount:-1,tabOrderByDomNodeOrder:0,tabOrderByTabIndex:0,elemOrigTabIdx:null,elemTempTabIdx:1000,elemNext:null,originalActiveEl:null,svcHandlers:new Array(),items:new Array(),headers:new Array(),footers:new Array(),hoverIdRE:null,iconNameRE:new RegExp("(^|\\s)menu_drop_icon(\\s|$)"),hoverOffset:{x:15,y:15,w:315},menuOffset:{x:15,y:15,w:425},initited:false,init:function(){
if(this.initited==false){
LCSemTagMenu.hoverIdRE=new RegExp(lconn.core.bizCard.bizCardUtils.hoverIdPrefix);
dojo.connect(document,"onclick",LCSemTagMenu.click);
dojo.connect(document,"onkeydown",LCSemTagMenu.keydown);
this.isDebug=(window.location.search.indexOf("debug=bizcard")!=-1);
this.initited=true;
}
},printDebug:function(msg){
if(this.isDebug){
var d=new Date();
if(dojo.config.isDebug){
console.debug("["+d.toLocaleTimeString()+"."+d.getMilliseconds()+"] LCSemTagMenu: "+msg);
}
}
},activateFocus:function(_9a){
lconn.core.bizCard.bizCardUtils.activateHover(_9a);
},activateHover:function(_9b){
var _9c=lconn.core.bizCard.bizCardUtils.getElementFromEvent(_9b);
if(_9c){
_9c.src=lconn.core.bizCard.bizCardUtils.baseUrl+"/images/menu_selected_hover.gif";
}
LCSemTagMenu.currentEvent=_9b;
LCSemTagMenu.setCurrentElement(LCSemTagMenu.findLiveElementFromEventSource(_9c));
},deactivateHover:function(_9d){
var _9e=lconn.core.bizCard.bizCardUtils.getElementFromEvent(_9d);
if(_9e){
_9e.src=lconn.core.bizCard.bizCardUtils.baseUrl+"/images/menu_selected_hover.gif";
}
LCSemTagMenu.setCurrentElement(null);
},showHover:function(_9f,_a0){
this.printDebug("in showHover");
try{
if(LCSemTagMenu.staticHover){
return;
}
try{
if(LCSemTagMenu.focusRestored&&_9f.type=="focus"){
LCSemTagMenu.printDebug("skipping showHover because focus was restored from hide timer...  event ["+_9f.type+"]. ");
LCSemTagMenu.focusRestored=false;
return;
}
}
catch(e){
console.log("showHover: eat exception, IE has issues with certain events not having an event.type, so reset flag regardless");
LCSemTagMenu.focusRestored=false;
return;
}
LCSemTagMenu.originalActiveEl=document.activeElement;
if(dojo.isIE&&dojo.exists("LCSemTagMenu.originalActiveEl.contentDocument.activeElement")){
LCSemTagMenu.originalActiveEl=LCSemTagMenu.originalActiveEl.contentDocument.activeElement;
}
var _a1=lconn.core.bizCard.bizCardUtils.getElementFromEvent(_9f);
if(_a1&&_a1.tagName.toLowerCase()=="img"&&_a1.parentNode.tagName.toLowerCase()=="a"){
_a1=_a1.parentNode;
}
LCSemTagMenu.elemOrigTabIdx=_a1.getAttribute("tabIndex");
if(LCSemTagMenu.tabOrderByTabIndex&&!LCSemTagMenu.elemOrigTabIdx){
LCSemTagMenu.elemNext=_a1.nextSibling;
_a1.setAttribute("tabIndex",parseInt(Number(LCSemTagMenu.elemTempTabIdx)));
}
var tag=LCSemTagMenu.getMenuTag(_a1);
var _a2=0;
if(_a1&&_a1!=LCSemTagMenu.currentElem){
LCSemTagMenu.clearAllSvcHandlers(tag);
_a2=_a1.getAttribute(lconn.core.bizCard.bizCardUtils.refcntAttr);
if(_a2){
LCSemTagMenu.currentEvent=_9f;
LCSemTagMenu.setCurrentElement(_a1);
}else{
LCSemTagMenu.printDebug("showHover called for a DOM element with no refcnt attribute!");
LCSemTagMenu.setCurrentElement(null);
return;
}
}
LCSemTagMenu.addSvcHandler(tag,_a0);
LCSemTagMenu.setRefCount(_a2);
var _a3=this._getCardNode();
if(_a3){
var _a4=true;
var _a5=_a3.parentNode;
while(_a5){
if(_a5.className&&(_a5.className.indexOf("popupPersonCard")>-1||_a5.className.indexOf("vcomm")>-1)){
_a4=false;
break;
}
_a5=_a5.parentNode;
}
if(_a4){
_a3.parentNode.removeChild(_a3);
}
}
var out=new lconn.core.bizCard.bizCardUtils.out();
LCSemTagMenu.writeHover(out,"ltr");
tag.innerHTML=out.buffer;
LCSemTagMenu.showing=true;
var pos=LCSemTagMenu.currentElemPosition;
LCSemTagMenu.show(LCSemTagMenu.id,_9f,Math.round(pos.x),LCSemTagMenu.hoverOffset.x,Math.round(pos.y),LCSemTagMenu.hoverOffset.y,Math.round(pos.w),Math.round(pos.h),LCSemTagMenu.hoverOffset.w);
}
catch(e){
console.error("Error in LCSemTagMenu.showHover");
console.error(e);
}
},addSvcHandler:function(tag,_a6){
LCSemTagMenu.svcHandlers.push(dojo.connect(tag,"onclick",_a6));
},clearAllSvcHandlers:function(tag){
while(0<LCSemTagMenu.svcHandlers.length){
var _a7=LCSemTagMenu.svcHandlers.pop();
if(_a7){
dojo.disconnect(_a7);
}
}
},getPosition:function(_a8,_a9){
var ret={x:0,y:0,w:0,h:0};
if(_1.exists("dojo.position")){
ret=dojo.position(_a8,_a9);
}else{
if(_a8["getBoundingClientRect"]){
var db=_1.body();
ret=_a8.getBoundingClientRect();
ret={x:ret.left,y:ret.top,w:ret.right-ret.left,h:ret.bottom-ret.top};
if(_1.isIE){
var _aa=_1._getIeDocumentElementOffset();
ret.x-=_aa.x+(_1.isQuirks?db.clientLeft+db.offsetLeft:0);
ret.y-=_aa.y+(_1.isQuirks?db.clientTop+db.offsetTop:0);
}
if(_a9){
var _ab=_1._docScroll();
ret.x+=_ab.x;
ret.y+=_ab.y;
}
}
}
try{
var _ac=_a8.parentNode;
while(_ac){
if(_ac.tagName.toLowerCase()=="body"){
break;
}
_ac=_ac.parentNode;
}
if(_ac){
var _ad=_1.query("[id=\""+LCSemTagMenu.id+"\"]",_ac)[0];
if(!_ad){
var _ae=_ac.parentNode;
var _af=_ae.parentNode;
var _b0;
if(_af.defaultView&&_af.defaultView.frameElement){
_b0=_af.defaultView.frameElement;
}else{
if(_af.frames.frameElement&&_af.frames.frameElement){
_b0=_af.frames.frameElement;
}
}
if(_b0){
var _b1=this.getPosition(_b0,false);
ret.x+=_b1.x;
ret.y+=_b1.y;
}
}
}
}
catch(e){
console.error("getPosition for iFrame failed");
console.error(e);
}
return ret;
},setCurrentElement:function(_b2){
LCSemTagMenu.currentElem=_b2;
if(_b2!=null){
LCSemTagMenu.currentElemPosition=this.getPosition(_b2,true);
LCSemTagMenu.setRefCount(_b2?Number(_b2.getAttribute(lconn.core.bizCard.bizCardUtils.refcntAttr)):0);
while(0<LCSemTagMenu.headers.length){
LCSemTagMenu.headers.pop();
}
while(0<LCSemTagMenu.items.length){
LCSemTagMenu.items.pop();
}
while(0<LCSemTagMenu.footers.length){
LCSemTagMenu.footers.pop();
}
}
},setRefCount:function(cnt){
LCSemTagMenu.refCount=cnt;
},setMenuData:function(_b3,_b4,_b5,_b6,_b7){
LCSemTagMenu.printDebug("Menu.setMenuData: items.length="+_b4.length);
if(!LCSemTagMenu.staticHover&&LCSemTagMenu.refCount<0){
LCSemTagMenu.printDebug("setMenuData called when refCount="+LCSemTagMenu.refCount);
return;
}
var _b8=LCSemTagMenu.findLiveElementFromEventSource(lconn.core.bizCard.bizCardUtils.getElementFromEvent(_b3));
if(!_b8){
LCSemTagMenu.printDebug("setMenuData called on a null live element");
return;
}
if(LCSemTagMenu.staticHover&&(_b8!=LCSemTagMenu.currentElem||LCSemTagMenu.showing)){
LCSemTagMenu.currentEvent=_b3;
LCSemTagMenu.setCurrentElement(_b8);
}
for(var i=0;i<_b4.length;i++){
LCSemTagMenu.items.push(_b4[i]);
}
if(_b5){
LCSemTagMenu.currentMenuCss=_b5;
}
if(_b6){
LCSemTagMenu.headers.push(_b6);
}
if(_b7){
LCSemTagMenu.footers.push(_b7);
}
LCSemTagMenu.stopEvent(_b3);
LCSemTagMenu.showMenu();
try{
if(LCSemTagMenu.isAccessibleOpen){
LCSemTagMenu.clearTimeouts();
}
}
catch(e){
LCSemTagMenu.printDebug("ERROR checking isAccessibleOpen event flag: "+e);
}
},getCurrentElement:function(){
return LCSemTagMenu.currentElem;
},showMenu:function(){
if(LCSemTagMenu.showing){
LCSemTagMenu.hide();
}
LCSemTagMenu.items.sort(lconn.core.bizCard.bizCardUtils.sortByOrder);
if(1<LCSemTagMenu.headers.length){
LCSemTagMenu.headers.sort(lconn.core.bizCard.bizCardUtils.sortByOrder);
}
if(1<LCSemTagMenu.footers.length){
LCSemTagMenu.footers.sort(lconn.core.bizCard.bizCardUtils.sortByOrder);
}
var out=new lconn.core.bizCard.bizCardUtils.out();
var _b9=(SemTagSvcConfig.isBidiRTL?"direction:rtl;":"");
var _ba="";
var _bb=LCSemTagMenu.id+"Card";
var _bc="";
if(LCSemTagMenu.currentElem){
var _bd=lconn.core.bizCard.bizCardUtils._getAltOrTitleFromElement(LCSemTagMenu.currentElem);
if(_bd.length>0){
_bc=" aria-label=\""+_2["label.personcard.dialog.title"].replace("{0}",lconn.core.util.html.encodeHtmlAttribute(_bd))+"\" ";
}
}
_ba+="<div id='"+_bb+"' role='dialog' "+_bc+" class='popupPersonCard' style='z-index:"+(LCSemTagMenu.getTopZIndex(_bb)+1)+"; position:absolute;"+_b9+"'>";
if(0<LCSemTagMenu.headers.length){
_ba+=LCSemTagMenu.headers[0].markup;
}
if(0<LCSemTagMenu.footers.length){
_ba+=LCSemTagMenu.footers[0].markup;
}
_ba+="</div>";
out.write(_ba);
var tag=LCSemTagMenu.getMenuTag();
LCSemTagMenu.clearAllSvcHandlers(tag);
LCSemTagMenu.offScreen(tag);
tag.innerHTML=out.buffer;
LCSemTagMenu.defaultCursor();
if(LCSemTagMenu.staticHover&&dojo.isFF){
var _be=tag.getElementsByTagName("a");
if(0<_be.length){
_be[0].focus();
}
}
var _bf={"target":LCSemTagMenu.currentElem};
var pos=LCSemTagMenu.currentElemPosition;
LCSemTagMenu.show(LCSemTagMenu.id,_bf,Math.round(pos.x),LCSemTagMenu.menuOffset.x,Math.round(pos.y),LCSemTagMenu.menuOffset.y,Math.round(pos.w),Math.round(pos.h),LCSemTagMenu.menuOffset.w);
},createMenuTag:function(_c0){
LCSemTagMenu.printDebug("in createMenuTag");
var tag=dojo.doc.createElement((LCSemTagMenu.tabOrderByDomNodeOrder?"div":"span"));
tag.setAttribute("id",LCSemTagMenu.id);
tag.setAttribute("role","tooltip");
tag.style.position=(LCSemTagMenu.tabOrderByDomNodeOrder?"fixed":"absolute");
tag.style.display="none";
dojo.connect(tag,"onmouseout",LCSemTagMenu.mouseout);
dojo.connect(tag,"onmouseover",LCSemTagMenu.mouseover);
dojo.connect(tag,"onfocus",LCSemTagMenu.focus);
if(LCSemTagMenu.tabOrderByTabIndex){
dojo.connect(tag,"onkeydown",LCSemTagMenu.keydown);
}
if(!dojo.hasClass(dojo.body(),"lotusui30_fonts")){
dojo.addClass(tag,"lotusui lotusui30 lotusui30dojo lotusui30_fonts lotusSpritesOn");
}
if(LCSemTagMenu.tabOrderByDomNodeOrder){
if(_c0){
_c0.parentNode.appendChild(tag);
}else{
dojo.body().insertBefore(tag,dojo.body().firstChild);
}
}else{
dojo.body().insertBefore(tag,dojo.body().firstChild);
}
return tag;
},getMenuTag:function(_c1){
var tag=dojo.byId(LCSemTagMenu.id);
if(!tag){
tag=this.createMenuTag(_c1);
}
if(LCSemTagMenu.tabOrderByTabIndex&&typeof (_c1)!="undefined"&&_c1!=null){
var _c2=_c1.getAttribute("tabIndex");
if(_c2){
tag.setAttribute("tabIndex",parseInt(Number(_c2)+1));
}
}else{
if(LCSemTagMenu.tabOrderByDomNodeOrder){
if(_c1){
_c1.parentNode.appendChild(tag);
}
}
}
return tag;
},windowWidth:function(){
var _c3=-1;
var d=document;
if(typeof window.innerWidth!="undefined"){
_c3=window.innerWidth;
}else{
if(d.documentElement&&typeof d.documentElement.clientWidth!="undefined"&&d.documentElement.clientWidth!=0){
_c3=d.documentElement.clientWidth;
}else{
if(d.body&&typeof d.body.clientWidth!="undefined"){
_c3=d.body.clientWidth;
}
}
}
return _c3;
},windowHeight:function(){
var _c4=-1;
var d=document;
if(typeof window.innerHeight!="undefined"){
_c4=window.innerHeight;
}else{
if(d.documentElement&&typeof d.documentElement.clientHeight!="undefined"&&d.documentElement.clientHeight!=0){
_c4=d.documentElement.clientHeight;
}else{
if(d.body&&typeof d.body.clientHeight!="undefined"){
_c4=d.body.clientHeight;
}
}
}
return _c4;
},show:function(_c5,e,_c6,_c7,_c8,_c9,_ca,_cb,_cc){
try{
var _cd=dojo.byId(_c5);
if(_ca==null){
_ca=0;
}
if(_cb==null){
_cb=0;
}
if(_cc==null){
_cc=0;
}
var _ce=SemTagSvcConfig.isBidiRTL;
LCSemTagMenu.printDebug("in show..."+" Y,X:["+_c8+","+_c6+"]"+" offsets:["+_c7+","+_c9+"] "+"parent W,H:["+_ca+","+_cb+"] "+"popup width: "+_cc);
_c6=_c6+_c7;
_c8=_c8+_c9;
var _cf=(e.target)?e.target:e.srcElement;
var top=(_c8!=null?_c8:lconn.core.bizCard.bizCardUtils.getEventAbsoluteY(e));
var _d0=(_c6!=null?_c6:lconn.core.bizCard.bizCardUtils.getEventAbsoluteX(e));
var _d1=this.windowWidth();
var _d2=this.windowHeight();
var _d3=document.body.scrollLeft;
var _d4=document.body.scrollTop;
LCSemTagMenu.printDebug("in show...(init values)"+" top,left:["+top+","+_d0+"] "+"win height,width:["+_d2+","+_d1+"] "+"scroll Y,X:["+_d4+","+_d3+"]");
if(_ce){
right=_d0-_c7+_ca;
_d0=right-_c7;
LCSemTagMenu.printDebug("in show...(bidi shift)"+" top,left:["+top+","+_d0+"]");
}
if(_ce){
if(_d0-_cc<0){
_d0=_cc-_c7+_d3;
LCSemTagMenu.printDebug("in show...(nudge right)"+" top,left:["+top+","+_d0+"]");
}
}else{
if(_d0+_cc>_d1){
_d0=_d1-_cc-_c7+_d3;
LCSemTagMenu.printDebug("in show...(nudge left)"+" top,left:["+top+","+_d0+"]");
}
}
if(SemTagSvcConfig.isPortal){
LCSemTagMenu.printDebug("in show...(in PORTAL start)"+" top,left:["+top+","+_d0+"]");
var od=SemTagUtil.getOwnerDocument(_cf);
if(od&&od.location!=document.location){
var f=SemTagUtil.getFrameElement(_cf);
if(f){
var el=f.offsetParent;
var x=0,y=0;
while(el){
x+=el.offsetLeft;
y+=el.offsetTop;
el=el.offsetParent;
}
var lof=_cf.offsetParent;
var xx=0,yy=0;
while(lof){
xx+=lof.offsetLeft;
yy+=lof.offsetTop;
lof=lof.offsetParent;
}
if(f.id=="wpsFLY_flyoutIFrame"){
top=y+yy+_cf.offsetHeight;
_d0=x+xx+_cf.offsetWidth;
}else{
top+=f.offsetTop;
_d0+=f.offsetLeft;
}
if(SemTagUtil.isGecko&&f.id=="wpsFLY_flyoutIFrame"){
iframeScrollLeft=f.contentWindow.pageXOffset;
iframeScrollTop=f.contentWindow.pageYOffset;
}
if(!SemTagUtil.isGecko&&f.id=="wpsFLY_flyoutIFrame"){
iframeScrollLeft=f.contentWindow.document.body.parentNode.scrollLeft;
iframeScrollTop=f.contentWindow.document.body.parentNode.scrollTop;
}
top-=iframeScrollTop;
_d0-=iframeScrollLeft;
}
}
LCSemTagMenu.printDebug("in show...(in PORTAL end)"+" top,left:["+top+","+_d0+"]");
}
LCSemTagMenu.printDebug("in show...(final)"+" top,left:["+top+","+_d0+"]");
_cd.style.top=top+"px";
_cd.style.left=_d0+"px";
_cd.style.display="block";
LCSemTagMenu.showing=true;
if(SemTagSvcConfig.isPortal){
_cd.style.zIndex="900";
}
if(dojo.isIE){
var _d5=dojo.byId("tempIframe");
if(_d5==null){
_d5=document.createElement("iframe");
_d5.setAttribute("id","tempIframe");
_d5.setAttribute("frameBorder","no");
_d5.setAttribute("scrolling","no");
_d5.setAttribute("src",lconn.core.bizCard.bizCardUtils.baseUrl+"/nav/blankIE.html");
_d5.style.position="absolute";
_d5.style.left=_d0+"px";
_d5.style.top=top+"px";
_d5.width=(_cd.offsetWidth).toString()+"px";
_d5.height=(_cd.offsetHeight).toString()+"px";
_d5.style.display="block";
_d5.style.zIndex="899";
document.body.appendChild(_d5);
}else{
_d5.style.left=_d0+"px";
_d5.style.top=top+"px";
_d5.width=(_cd.offsetWidth).toString()+"px";
_d5.height=(_cd.offsetHeight).toString()+"px";
_d5.style.display="block";
}
}
LCSemTagMenu.showing=true;
if(!LCSemTagMenu.preventFocus){
LCSemTagMenu.focusA11Y(_c5);
}
}
catch(e){
console.error("LCSemTagMenu.show: Exception Caught: ");
console.log(e);
}
},_getCardNode:function(_d6){
var _d7=null;
try{
dojo.query("*[id^='bc_document_node']",_d6||document).some(function(_d8){
_d7=_d8;
return _d8;
});
}
catch(e){
}
return _d7;
},focusA11Y:function(_d9){
try{
var _da=this._getCardNode(_d9);
if(LCSemTagMenu.showing&&_da){
var _db=[];
dojo.query("a,*:not([id^=\"A11Y\"],[tabindex=\"0\"]",_da).forEach(function(_dc){
var ok=true;
var _dd=_dc;
while(_dd&&_dd!=_da){
if(dojo.style(_dd,"display")=="none"){
ok=false;
break;
}
_dd=_dd.parentNode;
}
if(ok){
_db.push(_dc);
}
});
if(this.lastEventKeycode_&&this.lastEventKeycode_.keyCode==9&&this.lastEventKeycode_.shiftKey){
if(_db.length>0){
_db[_db.length-1].focus();
}else{
LCSemTagMenu.printDebug("focusA11Y:  could not find an element to focus.");
}
}else{
if(_db.length>0){
_db[0].focus();
}else{
LCSemTagMenu.printDebug("focusA11Y:  could not find an element to focus.");
}
}
this.lastEventKeycode_=null;
els=dojo.query("#A11YReader",_da).forEach(function(_de){
dojo.style(_de,"display","inline");
});
}
}
catch(e){
LCSemTagMenu.printDebug("focusA11Y:  could not focus element. Exception: "+e);
}
},hide:function(_df,e){
LCSemTagMenu.printDebug("in hide");
LCSemTagMenu.clearTimeouts();
var tag=LCSemTagMenu.getMenuTag();
if(!tag){
return false;
}
tag.style.display="none";
LCSemTagMenu.clearAllSvcHandlers(tag);
LCSemTagMenu.defaultCursor();
LCSemTagMenu.setCurrentElement(null);
var _e0=dojo.byId("tempIframe");
if(_e0){
_e0.style.display="none";
}
LCSemTagMenu.showing=false;
return true;
},restoreFocus:function(){
if(LCSemTagMenu.preventFocus){
return;
}
LCSemTagMenu.printDebug("in restoreFocus");
try{
var _e1=LCSemTagMenu.originalActiveEl;
if(_e1){
if(LCSemTagMenu.tabOrderByTabIndex&&_e1&&_e1.getAttribute("tabIndex")){
tag.setAttribute("tabIndex",null);
_e1.setAttribute("tabIndex",LCSemTagMenu.elemOrigTabIdx);
}
if(!lconn.profiles.bizCard.bizCardUI.wndh_vCard||(lconn.profiles.bizCard.bizCardUI.wndh_vCard&&lconn.profiles.bizCard.bizCardUI.wndh_vCard.closed)){
LCSemTagMenu.focusRestored=true;
setTimeout(function(){
try{
LCSemTagMenu.originalActiveEl.focus();
}
catch(e){
}
},100);
setTimeout(function(){
LCSemTagMenu.focusRestored=false;
},500);
}
}
}
catch(e){
console.error("LCSemTagMenu.restoreFocus: could not restore focus.  Exception: "+e);
}
},offScreen:function(_e2){
_e2.style.top="-1000px";
_e2.style.left="-1000px";
_e2.style.display="block";
},findLiveElementFromEventSource:function(_e3){
if(LCSemTagMenu.staticHover){
var id=_e3.id;
if(!id.match(LCSemTagMenu.hoverIdRE)){
var _e4=_e3.getElementsByTagName("img");
for(var i=0;i<_e4.length;i++){
if(_e4[i].id&&_e4[i].id.match(LCSemTagMenu.hoverIdRE)){
id=_e4[i].id;
break;
}
}
}
var idx=id.substr(lconn.core.bizCard.bizCardUtils.hoverIdPrefix.length);
return document.getElementById(lconn.core.bizCard.bizCardUtils.liveElemPrefix+idx);
}else{
var _e5=LCSemTagMenu.getCurrentElement();
return _e5?_e5:_e3;
}
},findHoverFromLiveElement:function(_e6){
var idx=_e6.getAttribute(lconn.core.bizCard.bizCardUtils.hoverIdPrefix+"idx");
return document.getElementById(lconn.core.bizCard.bizCardUtils.hoverIdPrefix+idx);
},inMenu:function(_e7,_e8){
if(!_e7||!_e8){
return false;
}
if(!LCSemTagMenu.showing){
return false;
}
try{
var el=lconn.core.bizCard.bizCardUtils.getElementFromEvent(_e8);
if((_e8.type=="mouseout"||_e8.type=="mouseover")){
el=(_e8.toElement?_e8.toElement:dojo.body());
LCSemTagMenu.printDebug("moused to: id:["+el.id+"] tag:["+el.tagName+"]");
}
while(el&&el.parentNode&&(el=el.parentNode)){
if(el===_e7){
return true;
}
}
return false;
}
catch(e){
console.log("inMenu: eat exception, IE has issues with certain events not having an event.type");
return false;
}
},mouseout:function(_e9){
LCSemTagMenu.printDebug("in mouseout..."+_e9);
var _ea=LCSemTagMenu.id;
menuElem=dojo.byId(_ea);
if(LCSemTagMenu.inMenu(menuElem,_e9)){
LCSemTagMenu.printDebug("mouseout: moused-out off element but we are on menu");
}else{
if(LCSemTagMenu.showing){
LCSemTagMenu.startHideTimer(_ea);
}else{
LCSemTagMenu.clearTimeouts();
}
}
},mouseover:function(_eb){
LCSemTagMenu.printDebug("in mouseover..."+_eb);
LCSemTagMenu.clearTimeouts();
},focus:function(_ec){
LCSemTagMenu.printDebug("in focus..."+_ec);
LCSemTagMenu.mouseover(_ec);
},unfocus:function(_ed){
LCSemTagMenu.printDebug("in unfocus..."+_ed);
LCSemTagMenu.mouseout(_ed);
},click:function(_ee){
LCSemTagMenu.printDebug("in click..."+_ee);
if(!_ee){
return;
}
if(LCSemTagMenu.showing){
var el=lconn.core.bizCard.bizCardUtils.getElementFromEvent(_ee);
if(el&&el.className!="lotusVCardHover"){
menuElem=dojo.byId(LCSemTagMenu.id);
if(!LCSemTagMenu.inMenu(menuElem,_ee)){
LCSemTagMenu.hide(LCSemTagMenu.id);
}
}
}
},lastEventKeycode_:null,keydown:function(_ef){
LCSemTagMenu.printDebug("in keydown..."+_ef);
LCSemTagMenu.catchEscape(_ef);
LCSemTagMenu.catchTab(_ef);
LCSemTagMenu.catchCtrlEnter(_ef);
LCSemTagMenu.lastEventKeycode_={"keyCode":_ef.keyCode,"shiftKey":_ef.shiftKey,"altKey":_ef.altKey,"ctrlKey":_ef.ctrlKey};
},catchEscape:function(_f0){
if(_f0.keyCode==27){
if(LCSemTagMenu.showing){
LCSemTagMenu.hide(LCSemTagMenu.id);
LCSemTagMenu.isAccessibleOpen=false;
LCSemTagMenu.restoreFocus();
}
}
},catchTab:function(_f1){
if(_f1.keyCode==9){
try{
if(LCSemTagMenu.showing&&document.activeElement.id=="A11YLast"){
LCSemTagMenu.focusA11Y();
}
if(LCSemTagMenu.showing&&dojo.query(".lotusVCardHover",dojo.byId(LCSemTagMenu.id)).length){
LCSemTagMenu.hide();
}
}
catch(e){
LCSemTagMenu.printDebug("catchTab:  could not check if current element is A11YLast id. Exception: "+e);
}
}
},catchCtrlEnter:function(_f2){
if(_f2.ctrlKey&&(_f2.keyCode==13)){
if(_f2.preventDefault){
_f2.preventDefault();
}
LCSemTagMenu.isAccessibleOpen=true;
lconn.profiles.bizCard.bizCard.showMenu(_f2);
if(!this.getCurrentElement()){
var _f3=lconn.core.bizCard.bizCardUtils.getLiveElementFromEvent(_f2);
this.setCurrentElement(_f3);
}
}
},stopEvent:function(_f4){
if(!_f4){
return;
}
if(dojo.isFF){
if(_f4.preventDefault==null){
_f4=_f4.original;
}
_f4.preventDefault();
_f4.stopPropagation();
}else{
try{
if(_f4.returnValue==null){
_f4=_f4.original;
}
_f4.returnValue=false;
_f4.cancelBubble=true;
}
catch(e){
}
}
},startShowTimer:function(_f5,_f6,_f7){
LCSemTagMenu.printDebug("in startShowTimer");
var _f8=(typeof (_f7)=="number"?_f7:LCSemTagMenu.showDelay);
if(0<_f8){
var t=window.setTimeout(function(){
LCSemTagMenu.showHover(_f5,_f6);
},_f8);
LCSemTagMenu.timeouts.push(t);
LCSemTagMenu.printDebug("...timer to show ("+t+") started, "+_f8+"ms");
}
},startHideTimer:function(_f9,_fa){
LCSemTagMenu.printDebug("in startHideTimer");
var _fb=(typeof (_fa)=="number"?_fa:LCSemTagMenu.hideDelay);
if(0<_fb){
var t=window.setTimeout(function(){
LCSemTagMenu.endHideTimer(_f9);
},_fb);
LCSemTagMenu.printDebug("...timer to hide ("+t+") started, "+_fb+"ms for "+_f9);
LCSemTagMenu.timeouts.push(t);
}
},endHideTimer:function(_fc){
LCSemTagMenu.printDebug("HIDE TIMER expired for "+_fc+".  Firing hide method.");
menuElem=dojo.byId(_fc);
LCSemTagMenu.hide(_fc);
LCSemTagMenu.restoreFocus();
},clearTimeouts:function(){
LCSemTagMenu.printDebug("in clearTimeouts:  ("+LCSemTagMenu.timeouts+")");
while((t=LCSemTagMenu.timeouts.pop())){
window.clearTimeout(t);
}
},defaultCursor:function(){
document.body.style.cursor="default";
},waitCursor:function(){
document.body.style.cursor="wait";
},clickCursor:function(){
document.body.style.cursor="pointer";
}};
LCSemTagMenu.defaultLoaded=true;
LCSemTagMenu.getTopZIndex=function(_fd){
var _fe=0;
dojo.query("[style*='z-index']").forEach(function(_ff,_100,arr){
if(!_fd||_ff.id!=_fd){
_fe=((zIdx=parseInt(dojo.style(_ff,"zIndex"),10))>_fe?zIdx:_fe);
}
});
return _fe;
};
LCSemTagMenu.writeHover=function(out,bidi){
var _101=LCSemTagMenu.id+"Box";
var _102="z-index:"+(LCSemTagMenu.getTopZIndex(_101)+1)+"; opacity: 1; top: 0;";
_3();
out.write("<a id='"+_101+"' class='lotusVCardHover' "+" onmouseover='javascript:LCSemTagMenu.clickCursor();'"+" onmouseout='javascript:LCSemTagMenu.defaultCursor();'"+" style='"+_102+"' "+">"+_2["label.semtag.hover.altA11Y"]+"</a>");
};
window.LCSemTagUtil={crossDomainRequest:function(){
var _103=new Array();
var _104=new Array();
var _105=new Array();
var self=this;
createTimeoutFunction=function(_106){
return function(){
self.cancelRequest(_106);
};
};
this.getScriptId=function(id){
return "_JVLN_"+id;
};
this.getScriptObject=function(id){
return document.getElementById(this.getScriptId(id));
};
this.cloneObject=function(obj){
var _107=new Object();
for(i in obj){
_107[i]=obj[i];
}
return _107;
};
this.request=function(url,_108,_109,_10a,_10b){
LCSemTagMenu.printDebug("LCSemTagUtil.request: started");
LCSemTagMenu.printDebug("LCSemTagUtil.request: connectionId "+_10b);
_10b=_10b.toLowerCase();
var _10c=this.getScriptId(_10b);
LCSemTagMenu.printDebug("LCSemTagUtil.request: objId "+_10c);
if(_109!=null){
_103[_10b]=_109;
}
if(_10a!=null){
if(!dojo.isFF){
_104[_10b]=this.cloneObject(_10a);
}else{
_104[_10b]=_10a;
}
}
var _10d=document.createElement("script");
_10d.id=_10c;
_10d.type="text/javascript";
_10d.defer=true;
try{
_10d.src=url;
LCSemTagMenu.printDebug("LCSemTagUtil.request: url: "+url);
}
catch(e){
LCSemTagMenu.printDebug("LCSemTagUtil.request: error:",e);
return false;
}
try{
var body=document.getElementsByTagName("body");
if(body[0]){
body[0].appendChild(_10d);
}else{
LCSemTagMenu.printDebug("LCSemTagUtil.request: error getting body element to insert script:"+_10d.id);
return false;
}
}
catch(e){
LCSemTagMenu.printDebug("LCSemTagUtil.request: error:",e);
return false;
}
LCSemTagMenu.printDebug("LCSemTagUtil.request: added script: "+_10d.id);
if(_108){
var self=this;
_105[_10b]=window.setTimeout(createTimeoutFunction(_10b),_108);
}
};
this.cancelRequest=function(id){
LCSemTagMenu.printDebug("LCSemTagUtil.cancelRequest:  Request ["+id+"] took too long.  Cancelling request for id: "+_105[id]);
var _10e=_103[id];
_103[id]=null;
var _10f=_104[id];
_104[id]=null;
if(_10e!=null){
try{
if(_10e){
_10e(false,null,_10f);
}
this.removeScript(id);
}
catch(e){
LCSemTagMenu.printDebug("LCSemTagUtil.cancelRequest: Exception Caught: "+e);
}
}else{
LCSemTagMenu.printDebug("LCSemTagUtil.cancelRequest: no callback for : "+id);
}
};
this.removeScript=function(id){
LCSemTagMenu.printDebug("LCSemTagUtil.removeScript: removing script element for: "+id);
if(id){
var _110=this.getScriptObject(id);
if(_110!=null){
var body=document.getElementsByTagName("body");
body[0].removeChild(_110);
LCSemTagMenu.printDebug("LCSemTagUtil.removeScript: removed script for id: "+id);
}else{
LCSemTagMenu.printDebug("LCSemTagUtil.removeScript: script is null for id: "+id);
}
}else{
LCSemTagMenu.printDebug("LCSemTagUtil.removeScript: id is null");
}
};
this.dispatch=function(id,data){
LCSemTagMenu.printDebug("LCSemTagUtil.dispatch: id: "+id);
if(id!=null){
id=id.toLowerCase();
}
try{
if(id!=null&&typeof (_105[id])!="undefined"&&_105[id]!=null){
LCSemTagMenu.printDebug("request dispatched. removing timeout for id ["+id+"]  timeout id: "+_105[id]);
window.clearTimeout(_105[id]);
}
var _111=_103[id];
var _112=_104[id];
_104[id]=null;
if(_111!=null){
_103[id]=null;
_111(true,data,_112);
window.setTimeout(function(){
self.removeScript(id);
},1000);
}else{
LCSemTagMenu.printDebug("LCSemTagUtil.dispatch: callback is null for id: "+id);
}
}
catch(e){
console.error("LCSemTagUtil.dispatch: Exception Caught: ");
console.log(e);
}
};
}};
var _113=false;
var _114;
if(_1.exists("window.SemTagSvc")){
_114=window.SemTagSvc;
}else{
_114=window.SemTagSvc=new com.ibm.mm.livetext.serviceImpl();
_113=true;
}
window.livetextCfg=(window.livetextCfg||[]);
var _115=window.SemTagSvcConfig=(window.SemTagSvcConfig||{});
if(!_115.proxyURL&&dojo.config.proxy){
_115.proxyURL=dojo.config.proxy;
}else{
if(_115.proxyURL&&!dojo.config.proxy){
dojo.config.proxy=_115.proxyURL;
}
}
if(!_115.appChksum&&_1.exists("lconn.core.config.versionStamp")){
_115.appChksum=lconn.core.config.versionStamp;
}
window.doUIExtensionConfigOnload=function(){
};
dojo.addOnLoad(function(){
setTimeout(function(){
if(dojo.config.isDebug&&window.console){
console.debug("Initialize semantic tag service");
}
_115.isBidiRTL=!dojo._isBodyLtr();
if(_113&&typeof _114.init==="function"){
_114.init();
}
lconn.core.bizCard.bizCardUtils.init();
},1);
});
})();
}

dojo.provide("lconn.communities.bizCard.nls.ui")._built=true;
dojo.provide("lconn.communities.bizCard.nls.ui.en");
lconn.communities.bizCard.nls.ui.en={"label.mult.other.subcommunities":"${0} Other Subcommunities","label.top.buttons.unfollow":"Stop Following this Community","label.msg.error":"Error","label.deleteWidgetConfirm.understandTitle":"I understand that the application and all data associated with it will be permanently deleted.","rs_community_image_alt_text":"community image","rs_move_community_dlg_clickViewUsers":"Click to view users","rs_move_community_dlg_community_title_label":"Community Title","label.private.community.alt.text":"This is a restricted community","label.subcommunities":"Subcommunities","label.moderated.community.alt.text":"This is a moderated community","label.top.buttons.leave":"Leave Community","label.expand":"Click to expand section","label.members":"Members ","rs_move_community_dlg_toplevel_radio":"Make this a top level community","label.deleteConfirm.okButtonValue":"OK","move.error.hasSubs.alert.body":"Community move is not allowed because community being moved has subcommunities.","rs_move_community_dlg_viewUsers":"View Users","label.top.buttons.create":"Create Subcommunity","rs_move_community_dlg_community_dialog_title":"Move Community","label.theme.changelayout":"Change Layout","label.deleteWidgetConfirm.signDirection":"Enter the name of the application and sign in with your name to confirm that you are authorized to delete it and that you want to permanently delete this application and its data.\x3cbr\x3e\x3cb\x3eNote:\x3c/b\x3e you can \x3ca href=\'javascript:void(null);\' dojoAttachEvent=\'onclick:onHideClicked\'\x3ehide this app\x3c/a\x3e instead so you can re-add it at a later time.","move.error.hasSubs.alert.title":"Community cannot be moved","label.action.confirm.community.after.unfollow":"You have stopped following this community.","rs_move_community_dlg_community_typeahead_label":"Community typeahead, start typing a name to select a community","label.convertInternalConfirm.warning":"Community content will be seen by people both inside and outside of your organization. Ensure that all existing community content added by any community member can be shared outside of your organization. Files that are not shared with everyone will be automatically removed.","label.top.buttons.metrics":"View Metrics","rs_move_community_dlg_move_button":"Move","tooltip.overview":"Click here to see the community\'s overview page","rs_move_community_dlg_close":"close","label.msgbox.warning":"Warning","label.nav.landmark.comm":"Community","label.deleteConfirm.understandTitle":"I understand that the community and all associated data with it will be permanently deleted.","label.top.buttons.join":"Join this Community","label.top.buttons.move":"Move Community","move.success":"Community has been successfully moved.  Please check membership of the community as it may have been adjusted by the move.","label.action.confirm.community.after.follow.member":"You are following this community and will receive updates about community content.","rs_move_community_dlg_owners_added":"These ({0}) users will be made owners of the Subcommunity:","label.top.buttons.unfollow.title":"Stop following the community to stop receiving updates about community content.","rs_move_community_dlg_change_to_private":"This community will be changed to restricted to be made to match the parent community.","label.msg.action.failed.need.login":"The action failed because you are no longer logged in.","label.external.members.allowed":"This community can have members from outside your organization.","label.deleteConfirm.warning":"Warning: The following Community and all data associated with it will be permanently deleted!","rs_move_community_dlg_cancel_button":"Cancel","label.convertInternalConfirm.warning2":"From now on, community content will be visible outside of your organization. Files without external permissions will be automatically removed.","label.action.confirm.community.after.follow.nonmember":"You are following this community and will receive updates about community content. Join this community to post content.","rs_move_community_dlg_change_to_moderated":"This community will be changed to moderated to be made to match the parent community.","label.convertInternalConfirm.signDirection":"Enter the information below to confirm that you want to open this community to people from outside your organization.","label.deleteConfirm.error":"The user name or community name does not match the required name.  Please check the names.","label.deleteConfirm.trash.signDirection":"Enter the information below to confirm you want to move this Community to the Trash.","rs_move_community_dlg_more_names_action":"show more...","label.members.lowercase":"members","label.leaveConfirm.dlgTitle":"Leave this Community","label.top.buttons.edit":"Edit Community","label.convertInternalConfirm.dlgTitle":"Convert Internal Community to External","label.top.buttons.moderate":"Moderate Community","label.top.buttons.follow.title":"Follow the community to get updates about community content.","label.deleteConfirm.dlgTitle":"Delete ${0}","confirm.delete.community":"Are you sure you want to delete this community? Deleting this community will remove all data including any content that has been added to the community. Click OK to delete this community or Cancel to return to the community.","label.deleteConfirm.oneSubCommunity":"This community has 1 subcommunity that will also be deleted.","label.window.title":"${0} - ${1}","label.one.subcommunity":"${0} Subcommunity","label.msgbox.close":"Close","label.deleteWidgetConfirm.warning":"Warning:  the following application and all data associated with it will be permanently deleted!","label.top.buttons.editsub":"Edit Subcommunity","rs_move_community_dlg_more_owners_action":"show more...","label.deleteWidgetConfirm.communityName":"Application name:","label.public.community.alt.text":"This is a public community","label.deleteConfirm.signatureTitle":"Sign with your name:","label.msgbox.information.a11y":"Information:","rs_move_community_dlg_confirm_message":"Please confirm that the changes listed are acceptable before moving the community.","rs_move_community_dlg_community_image_label":"Community Image","label.deleteConfirm.closeButtonValue":"Cancel","rs_move_community_dlg_warningMessage":"Moving this community will cause the following changes and cannot be undone","label.deleteConfirm.capitalizationWarning":"The values entered must exactly match the names with correct capitalization for the OK button to be enabled.","label.top.buttons.join.title":"Join the community to post community content.","label.deleteConfirm.trash.warning":"This community and its associated data and applications will be moved to the Trash and scheduled for permanent deletion.","rs_move_community_dlg_community_cannot_be_undone":"This cannot be undone!","move.error.hasSubs":"Community move is not allowed because community has subcommunities.","label.theme.customize":"Add Apps","rs_move_community_dlg_subcommunity_radio":"Make this a subcommunity of:","rs_move_community_dlg_community_move_action_legend":"Community Move Action","label.msg.confirmation":"Confirmation","label.deleteConfirm.multipleSubCommunities":"This community has ${0} subcommunities that will also be deleted.","label.top.buttons.email":"Mail Community","label.msgbox.information":"Information","label.top.buttons.gotoComm":"Go to Community","label.leaveConfirm.closeButtonValue":"Cancel","label.collapse":"Click to collapse section","label.top.buttons.follow":"Follow this Community","label.msgbox.warning.a11y":"Warning:","label.deleteWidgetConfirm.dlgTitle":"Delete ${0}","label.deleteConfirm.required":"required","label.overview":"Overview","label.msgbox.error":"Error","label.action.confirm.community.before.leave.groupEnabled":"Leaving this community will remove you from the membership, however, if you are a member of one or more groups that are members of this community, your membership in the community via that group will remain.","label.msgbox.success.a11y":"Success:","label.deleteConfirm.signDirection":"Enter the name of the community and sign in with your name to confirm that you are authorized to delete and that you want to permanently delete this entire community.","rs_move_community_dlg_members_added":"These ({0}) users will be made members of the Parent community:","label.tags.tags":"Tags","label.top.buttons.delete":"Delete Community","label.msgbox.success":"Success","label.action.confirm.community.before.leave":"Leaving this community will remove you from the membership.","label.top.buttons.actions":"More Actions","label.deleteWidgetConfirm.signDirection2":"Enter the name of the application and sign in with your name to confirm that you are authorized to delete it and that you want to permanently delete this application and its data.\x3cbr\x3e\x3cb\x3eNote:\x3c/b\x3e you can \x3ca href=\'javascript:onclick:dijit.byId(${0}).onHideClicked();\'\x3ehide this app\x3c/a\x3e instead so you can re-add it at a later time.","rs_move_community_dlg_acknowledgement":"I acknowledge these changes will occur when I select \'Move\' and cannot be undone","label.deleteConfirm.communityNameTitle":"Community name:","label.top.buttons.requestToJoin":"Request to Join this Community","move.error.generic":"Community move failed.","label.deleteWidgetConfirm.confirmCommunityName":"Confirm application name:","label.moderation.link":"Moderation","label.leaveConfirm.okButtonValue":"OK","tooltip.startpage":"Click here to see the community\'s start page","label.deleteConfirm.nameTitle":"Your name:","label.one.other.subcommunity":"${0} Other Subcommunity","label.metrics.link":"Metrics","label.other.subcommunities":"Other Subcommunities","rs_move_community_dlg_M_of_N_Users":"{0} of {1}","label.msgbox.error.a11y":"Error:","label.top.buttons.com.action.menu":"Press the space bar or enter key to activate the menu","label.msg.action.failed":"The action failed: ${0}","label.top.buttons.com.actions":"Community Actions","label.mult.subcommunities":"${0} Subcommunities","label.top.buttons.requestToJoin.title":"Request to join the community in order to post community content.","label.deleteConfirm.communityNameConfirm":"Confirm community name:","label.deleteConfirm.trash.dlgTitle":"Move to Trash"};
if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["lconn.communities.bizCard"]=true;

;if(!dojo._hasResource["lconn.communities.bizCard.dialogs.deleteConfirm"]){
dojo._hasResource["lconn.communities.bizCard.dialogs.deleteConfirm"]=true;
dojo.provide("lconn.communities.bizCard.dialogs.deleteConfirm");






dojo.requireLocalization("lconn.communities.bizCard","ui");
dojo.declare("lconn.communities.bizCard.dialogs.deleteConfirm",[dijit.Dialog],{stringResources:dojo.i18n.getLocalization("lconn.communities.bizCard","ui"),templateString:"<div dojoAttachPoint=\"containerNode\" id=\"dialog_communities\" class=\"lotusui30dojo lotusDialogWrapper\" tabindex=\"-1\" role=\"dialog\" waiState=\"labelledby-${id}_title\" aria-labelledby=\"${id}_title\"  aria-describedby=\"warning\">\t\t\t<div dojoAttachPoint=\"dialogBorder\" class=\"lotusDialogBorder\" style=\"width:inherit; height:inherit\">\t\t\t\t<div class=\"lotusDialog lotusForm2 _lotusDelete\"> \t\t\t\t\t<div dojoAttachPoint=\"titleBar\" class=\"lotusDialogHeader\"> \t\t\t\t\t\t<div dojoAttachPoint=\"titleNode\" id=\"${id}_title\" class=\"lotusHeading\">${dlgTitle}</div> \t\t\t\t\t\t<a class=\"lotusDialogClose\" role=\"button\" href=\"javascript:;\" title=\"Close\" dojoAttachEvent=\"onkeypress:onEnterCancelClicked,onclick:onCancelClicked\" >\t\t\t\t\t\t\t<img alt=\"Close\" src=\""+dojo.config.blankGif+"\"/>\t\t\t\t\t\t\t<span class=\"lotusAltText\" >X</span>\t\t\t\t\t\t</a> \t\t\t\t\t</div>\t\t\t\t\t<div style=\"overflow:hidden\"> \t\t\t\t\t\t<div class=\"lotusErrorBox lotusui30_layout\">\t\t\t\t\t\t\t<div class=\"lotusErrorContent\">\t\t\t\t\t\t\t\t<img alt=\"\" class=\"iconsMessages48 iconsMessages48-msgError48\" src=\""+dojo.config.blankGif+"\">\t\t\t\t\t\t\t\t<div class=\"lotusErrorForm\">\t\t\t\t\t\t\t\t\t<span id=\"warning\">\t\t\t\t\t\t\t\t\t\t<div class=\"lotusMessage2\" style=\"margin:0px; top:0px; padding:10px\">\t\t\t\t\t\t\t\t\t\t\t<span style=\"font-size:150%\">${warning}</span>\t\t\t\t\t\t\t\t\t\t\t<br>\t\t\t\t\t\t\t\t\t\t\t<span style=\"font-size:200%\">${communityTitleFinal}</span>\t\t\t\t\t\t\t\t\t\t\t<div>\t\t\t\t\t\t\t\t\t\t\t<p><b dojoAttachPoint=\"subcommunities\"></b></p>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div style=\"clear:both\"></div>\t\t\t\t\t\t\t\t\t\t<br>\t\t\t\t\t\t\t\t\t\t<span dojoAttachPoint=\"signDirection\">\t\t\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t\t\t\t<br><br>\t\t\t\t\t\t\t\t\t\t<span class=\"lotusMeta\" style=\"color:#666666\">\t\t\t\t\t\t\t\t\t\t\t${capitalizationWarning}\t\t\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t\t\t<br><br>\t\t\t\t\t\t\t\t\t<div id=\"communityNameLabel\" class=\"lotusFormField\">\t\t\t\t\t\t\t\t\t\t<label role=\"presentation\" class=\"lotusFloat\" style=\"margin-left: 0px; width:200px\">${communityName}</label>                                        <div class=\"lotusFieldWrapper\"><span dojoAttachPoint=\"communityTitleDisplay\"></span></div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class=\"lotusFormField\">\t\t\t\t\t\t\t\t\t\t<label class=\"lotusFloat\" style=\"margin-left: 0px; width:200px\"><span class=\"lotusFormRequired\">* </span>${confirmCommunityName}</label>\t\t\t\t\t\t\t\t\t\t<div class=\"lotusFieldWrapper\">\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" dojoAttachPoint=\"communityInputField\" aria-required=\"true\" aria-labelledby=\"communityNameLabel\" value=\"\" name=\"communityName\" id=\"communityInputField\" class=\"lotusText bidiAware\" dojoAttachEvent=\"oninput:onCommunityChange\"><br><br><br>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div id=\"signatureNameLabel\" class=\"lotusFormField\">\t\t\t\t\t\t\t\t\t\t<label role=\"presentation\" class=\"lotusFloat\" style=\"margin-left: 0px; width:200px\">${nameTitle}</label>\t\t\t\t\t\t\t\t\t\t<div class=\"lotusFieldWrapper\">${userNameDisplay}</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class=\"lotusFormField\">\t\t\t\t\t\t\t\t\t\t<label class=\"lotusFloat\" style=\"margin-left: 0px; width:200px\"><span class=\"lotusFormRequired\">*</span>${signatureTitle}</label>\t\t\t\t\t\t\t\t\t\t<div class=\"lotusFieldWrapper\">\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" dojoAttachPoint=\"nameInputField\" aria-required=\"true\" aria-labelledby=\"signatureNameLabel\" value=\"\" name=\"signature\" id=\"signature\" class=\"lotusText bidiAware\" dojoAttachEvent=\"oninput:onNameChange\"><br><br><br>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class=\"lotusFormField lotusMeta\">* ${required}</div> \t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div><!--end lotusDialogContent-->\t\t\t\t\t<div class=\"lotusDialogFooter\">\t\t\t\t\t\t<button dojoAttachPoint=\"okButtonNode\" class=\"lotusBtn lotusBtnDisabled\" aria-disabled=\"true\" dojoAttachEvent=\"onclick:onOkClicked\">${okButtonValue}</button>\t\t\t\t\t\t<button dojoAttachPoint=\"closeButtonNode\" dojoAttachPoint=\"closeText\" name=\"yourButtonName\"class=\"lotusBtn\" dojoAttachEvent=\"onclick:onCancelClicked\">${closeButtonValue}</button>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t</div><!--end lotusDialogBorder-->\t\t</div>",userName:"TBD",communityTitle:"COMMUNITY TITLE",nameCorrect:false,communityNameCorrect:false,numSubs:0,callback:null,communityName:"",confirmCommunityName:"",postMixInProperties:function(){
this.userName=dojox.html.entities.encode(this.userName);
this.communityTitleFinal=lconn.core.globalization.bidiUtil.enforceTextDirection(this.communityTitle);
this.communityTitleFinal=dojox.html.entities.encode(this.communityTitleFinal);
this.dlgTitle=dojo.string.substitute(this.stringResources["label.deleteConfirm.dlgTitle"],[this.communityTitleFinal]);
this.warning=this.stringResources["label.deleteConfirm.warning"];
this.nameTitle=this.stringResources["label.deleteConfirm.nameTitle"];
this.signatureTitle=this.stringResources["label.deleteConfirm.signatureTitle"];
this.okButtonValue=this.stringResources["label.deleteConfirm.okButtonValue"];
this.closeButtonValue=this.stringResources["label.deleteConfirm.closeButtonValue"];
this.communityName=this.stringResources["label.deleteConfirm.communityNameTitle"];
this.confirmCommunityName=this.stringResources["label.deleteConfirm.communityNameConfirm"];
this.capitalizationWarning=this.stringResources["label.deleteConfirm.capitalizationWarning"];
this.required=this.stringResources["label.deleteConfirm.required"];
this.inherited(arguments);
},postCreate:function(){
if(dojo.isIE){
dojo.connect(this.nameInputField,"onpropertychange",this,"onNameChange");
dojo.connect(this.communityInputField,"onpropertychange",this,"onCommunityChange");
dojo.style(this.dialogBorder,"width","auto");
dojo.style(this.dialogBorder,"height","auto");
if(!dojo._isBodyLtr()){
var _1=Math.max(dojo.coords(this.titleNode).w,600);
dojo.query(".lotusFormField",this.domNode).forEach(function(_2){
dojo.style(_2,"width",_1+"px");
});
}
}
if(this.numSubs==1){
dojo.html.set(this.subcommunities,this.stringResources["label.deleteConfirm.oneSubCommunity"]);
}else{
if(this.numSubs>1){
dojo.html.set(this.subcommunities,dojo.string.substitute(this.stringResources["label.deleteConfirm.multipleSubCommunities"],[this.numSubs]));
}
}
this.inherited(arguments);
this.communityTitleDisplay.innerHTML=lconn.core.globalization.bidiUtil.enforceTextDirection(this.communityTitle);
this.userNameDisplay.innerHTML=lconn.core.globalization.bidiUtil.enforceTextDirection(this.userName);
this.signDirection.innerHTML=this.stringResources["label.deleteConfirm.signDirection"];
dojo.removeClass(this.containerNode,"dijitContentPane");
this._enableDeleteButton();
dojo.connect(this,"_setup",dojo.hitch(this,"_setupOverride"));
lconn.core.globalization.bidiUtil.enforceTextDirectionOnPage(this.formNode);
},onOkClicked:function(){
this._destroy();
if(this.callback!=null){
this.callback();
}
},onEnterCancelClicked:function(_3){
if(_3.keyCode==13){
this.onCancelClicked();
}
},onCancelClicked:function(){
this._destroy();
},onNameChange:function(_4){
if(dojox.html.entities.decode(this.userName)==_4.target.value){
this.nameCorrect=true;
}else{
this.nameCorrect=false;
}
this._enableDeleteButton();
},onCommunityChange:function(_5){
if(dojox.html.entities.decode(this.communityTitle)==_5.target.value){
this.communityNameCorrect=true;
}else{
this.communityNameCorrect=false;
}
this._enableDeleteButton();
},_enableDeleteButton:function(){
okButton=this.okButtonNode;
bntDisabledClass="lotusBtnDisabled";
if(this.nameCorrect==true&&this.communityNameCorrect==true){
dojo.attr(okButton,{"class":"lotusBtn","aria-disabled":"false"});
okButton.disabled=false;
}else{
dojo.attr(okButton,{"class":"lotusBtn lotusBtnDisabled","aria-disabled":"true"});
okButton.disabled=true;
}
},_size:function(){
var _6=this.inherited(arguments);
this.domNode.style.position="absolute";
return (_6);
},_setupOverride:function(){
var _7=dojo.connect(this._fadeIn,"onEnd",function(){
dojo.byId("communityInputField").focus();
dojo.disconnect(_7);
});
},_destroy:function(){
this.hide();
this.destroyRecursive();
}});
}


;if(!dojo._hasResource["lconn.communities.bizCard.dialogs.deleteConfirmTrash"]){
dojo._hasResource["lconn.communities.bizCard.dialogs.deleteConfirmTrash"]=true;
dojo.provide("lconn.communities.bizCard.dialogs.deleteConfirmTrash");




dojo.requireLocalization("lconn.communities.bizCard","ui");
dojo.declare("lconn.communities.bizCard.dialogs.deleteConfirmTrash",[lconn.communities.bizCard.dialogs.deleteConfirm],{stringResources:dojo.i18n.getLocalization("lconn.communities.bizCard","ui"),templateString:"<div dojoAttachPoint=\"containerNode\" id=\"dialog_communities\" class=\"lotusui30dojo lotusDialogWrapper\" tabindex=\"-1\" role=\"dialog\" waiState=\"labelledby-${id}_title\" aria-describedby=\"warning\" aria-labelledby=\"${id}_title\">\t\t\t<div dojoAttachPoint=\"dialogBorder\" class=\"lotusDialogBorder\" style=\"width:inherit; height:inherit\">\t\t\t\t<div class=\"lotusDialog lotusForm2 _lotusDelete\"> \t\t\t\t\t<div dojoAttachPoint=\"titleBar\" class=\"lotusDialogHeader\"> \t\t\t\t\t\t<div dojoAttachPoint=\"titleNode\" id=\"${id}_title\" class=\"lotusHeading\">${dlgTitle}</div> \t\t\t\t\t\t<a class=\"lotusDialogClose\" role=\"button\" href=\"javascript:;\" title=\"${closeAnchorTitle}\" dojoAttachEvent=\"onkeypress:onEnterCancelClicked,onclick:onCancelClicked\" >\t\t\t\t\t\t\t<img alt=\"${closeImageAltText}\" src=\""+dojo.config.blankGif+"\"/>\t\t\t\t\t\t\t<span class=\"lotusAltText\" >X</span>\t\t\t\t\t\t</a> \t\t\t\t\t</div>\t\t\t\t\t<div style=\"overflow:hidden\"> \t\t\t\t\t\t<div class=\"lotusErrorBox lotusui30_layout\">\t\t\t\t\t\t\t<div class=\"lotusErrorContent\">\t\t\t\t\t\t\t\t<img alt=\"\" class=\"iconsMessages48 iconsMessages48-msgError48\" src=\""+dojo.config.blankGif+"\">\t\t\t\t\t\t\t\t<div class=\"lotusErrorForm\">\t\t\t\t\t\t\t\t\t<span id=\"warning\">\t\t\t\t\t\t\t\t\t\t<div class=\"lotusMessage2\" style=\"margin:0px; top:0px; padding:10px\">\t\t\t\t\t\t\t\t\t\t\t<span style=\"font-size:150%\">${warning}</span>\t\t\t\t\t\t\t\t\t\t\t<br>\t\t\t\t\t\t\t\t\t\t\t<p><b dojoAttachPoint=\"subcommunities\"></b></p>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div style=\"clear:both\"></div>\t\t\t\t\t\t\t\t<br>\t\t\t\t\t\t\t\t<div style=\"width:800px; word-wrap: break-word;\">\t\t\t\t\t\t\t\t\t<span dojoAttachPoint=\"signDirection\"></span>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<br><br>\t\t\t\t\t\t\t\t<span class=\"lotusMeta\" style=\"color:#666666\">\t\t\t\t\t\t\t\t\t${capitalizationWarning}\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t\t<br><br>\t\t\t\t\t\t\t\t<div id=\"communityNameLabel\" class=\"lotusFormField\">\t\t\t\t\t\t\t\t\t<label role=\"presentation\" class=\"lotusFloat\" style=\"margin-left: 0px; width:200px\">${communityName}</label>                                    <div class=\"lotusFieldWrapper\"><b><span dojoAttachPoint=\"communityTitleDisplay\"></span></b></div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div class=\"lotusFormField\">\t\t\t\t\t\t\t\t\t<label class=\"lotusFloat\" style=\"margin-left: 0px; width:200px\"><span class=\"lotusFormRequired\">* </span>${confirmCommunityName}</label>\t\t\t\t\t\t\t\t\t<div class=\"lotusFieldWrapper\">\t\t\t\t\t\t\t\t\t\t<input type=\"text\" dojoAttachPoint=\"communityInputField\" aria-required=\"true\" aria-labelledby=\"communityNameLabel\" value=\"\" name=\"communityName\" id=\"communityInputField\" class=\"lotusText\" dojoAttachEvent=\"oninput:onCommunityChange\"><br><br><br>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div id=\"signatureNameLabel\" class=\"lotusFormField\">\t\t\t\t\t\t\t\t\t<label role=\"presentation\" class=\"lotusFloat\" style=\"margin-left: 0px; width:200px\">${nameTitle}</label>\t\t\t\t\t\t\t\t\t<div class=\"lotusFieldWrapper\"><b><span dojoAttachPoint=\"userNameDisplay\"></span></b></div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div class=\"lotusFormField\">\t\t\t\t\t\t\t\t\t<label class=\"lotusFloat\" style=\"margin-left: 0px; width:200px\"><span class=\"lotusFormRequired\">*</span>${signatureTitle}</label>\t\t\t\t\t\t\t\t\t<div class=\"lotusFieldWrapper\">\t\t\t\t\t\t\t\t\t\t<input type=\"text\" dojoAttachPoint=\"nameInputField\" aria-required=\"true\" aria-labelledby=\"signatureNameLabel\" value=\"\" name=\"signature\" id=\"signature\" class=\"lotusText\" dojoAttachEvent=\"oninput:onNameChange\"><br><br><br>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class=\"lotusFormField lotusMeta\">* ${required}</div> \t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div><!--end lotusDialogContent-->\t\t\t\t\t<div class=\"lotusDialogFooter\">\t\t\t\t\t\t<button dojoAttachPoint=\"okButtonNode\" class=\"lotusBtn lotusBtnDisabled\" aria-disabled=\"true\" dojoAttachEvent=\"onclick:onOkClicked\">${okButtonValue}</button>\t\t\t\t\t\t<button dojoAttachPoint=\"closeButtonNode\" dojoAttachPoint=\"closeText\" name=\"yourButtonName\"class=\"lotusBtn\" dojoAttachEvent=\"onclick:onCancelClicked\">${closeButtonValue}</button>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t</div><!--end lotusDialogBorder-->\t\t</div>",postMixInProperties:function(){
this.inherited(arguments);
this.closeAnchorTitle=this.closeImageAltText=this.stringResources["label.msgbox.close"];
this.dlgTitle=this.stringResources["label.deleteConfirm.trash.dlgTitle"];
this.warning=this.stringResources["label.deleteConfirm.trash.warning"];
},resize:function(){
this.inherited(arguments);
this.titleBar.style.position="static";
},postCreate:function(){
this.inherited(arguments);
this.signDirection.innerHTML=this.stringResources["label.deleteConfirm.trash.signDirection"];
}});
}


;if(!dojo._hasResource["lconn.communities.bizCard.dialogs.deleteConfirmWidget"]){
dojo._hasResource["lconn.communities.bizCard.dialogs.deleteConfirmWidget"]=true;
dojo.provide("lconn.communities.bizCard.dialogs.deleteConfirmWidget");






dojo.requireLocalization("lconn.communities.bizCard","ui");
dojo.declare("lconn.communities.bizCard.dialogs.deleteConfirmWidget",[lconn.communities.bizCard.dialogs.deleteConfirmTrash],{postMixInProperties:function(){
var _1=dojo.hitch(this,"onHideClicked");
this.inherited(arguments);
this.warning=this.stringResources["label.deleteWidgetConfirm.warning"];
this.communityName=this.stringResources["label.deleteWidgetConfirm.communityName"];
this.confirmCommunityName=this.stringResources["label.deleteWidgetConfirm.confirmCommunityName"];
this.understandTitle=this.stringResources["label.deleteWidgetConfirm.understandTitle"];
this.communityTitle=lconn.core.HTMLUtil.escapeText(this.communityTitle);
this.communityTitleDisplay=this.communityTitle;
this.dlgTitle=dojo.string.substitute(this.stringResources["label.deleteWidgetConfirm.dlgTitle"],[this.communityTitle]);
},postCreate:function(){
this.inherited(arguments);
this.signDirection.innerHTML=dojo.string.substitute(this.stringResources["label.deleteWidgetConfirm.signDirection2"],["\""+this.id+"\""]);
},onHideClicked:function(){
this._destroy();
if(this.callback!=null){
this.callback(false);
}
},onOkClicked:function(){
this._destroy();
if(this.callback!=null){
this.callback(true);
}
}});
}


;define("dojo/hash",["./_base/kernel","require","./_base/config","./aspect","./_base/lang","./topic","./domReady","./sniff"],function(_1,_2,_3,_4,_5,_6,_7,_8){
_1.hash=function(_9,_a){
if(!arguments.length){
return _b();
}
if(_9.charAt(0)=="#"){
_9=_9.substring(1);
}
if(_a){
_c(_9);
}else{
location.href="#"+_9;
}
return _9;
};
var _d,_e,_f,_10=_3.hashPollFrequency||100;
function _11(str,_12){
var i=str.indexOf(_12);
return (i>=0)?str.substring(i+1):"";
};
function _b(){
return _11(location.href,"#");
};
function _13(){
_6.publish("/dojo/hashchange",_b());
};
function _14(){
if(_b()===_d){
return;
}
_d=_b();
_13();
};
function _c(_15){
if(_e){
if(_e.isTransitioning()){
setTimeout(_5.hitch(null,_c,_15),_10);
return;
}
var _16=_e.iframe.location.href;
var _17=_16.indexOf("?");
_e.iframe.location.replace(_16.substring(0,_17)+"?"+_15);
return;
}
location.replace("#"+_15);
!_f&&_14();
};
function _18(){
var ifr=document.createElement("iframe"),_19="dojo-hash-iframe",_1a=_3.dojoBlankHtmlUrl||_2.toUrl("./resources/blank.html");
if(_3.useXDomain&&!_3.dojoBlankHtmlUrl){
console.warn("dojo/hash: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");
}
ifr.id=_19;
ifr.src=_1a+"?"+_b();
ifr.style.display="none";
document.body.appendChild(ifr);
this.iframe=_1.global[_19];
var _1b,_1c,_1d,_1e,_1f,_20=this.iframe.location;
function _21(){
_d=_b();
_1b=_1f?_d:_11(_20.href,"?");
_1c=false;
_1d=null;
};
this.isTransitioning=function(){
return _1c;
};
this.pollLocation=function(){
if(!_1f){
try{
var _22=_11(_20.href,"?");
if(document.title!=_1e){
_1e=this.iframe.document.title=document.title;
}
}
catch(e){
_1f=true;
console.error("dojo/hash: Error adding history entry. Server unreachable.");
}
}
var _23=_b();
if(_1c&&_d===_23){
if(_1f||_22===_1d){
_21();
_13();
}else{
setTimeout(_5.hitch(this,this.pollLocation),0);
return;
}
}else{
if(_d===_23&&(_1f||_1b===_22)){
}else{
if(_d!==_23){
_d=_23;
_1c=true;
_1d=_23;
ifr.src=_1a+"?"+_1d;
_1f=false;
setTimeout(_5.hitch(this,this.pollLocation),0);
return;
}else{
if(!_1f){
location.href="#"+_20.search.substring(1);
_21();
_13();
}
}
}
}
setTimeout(_5.hitch(this,this.pollLocation),_10);
};
_21();
setTimeout(_5.hitch(this,this.pollLocation),_10);
};
_7(function(){
if("onhashchange" in _1.global&&(!_8("ie")||(_8("ie")>=8&&document.compatMode!="BackCompat"))){
_f=_4.after(_1.global,"onhashchange",_13,true);
}else{
if(document.addEventListener){
_d=_b();
setInterval(_14,_10);
}else{
if(document.attachEvent){
_e=new _18();
}
}
}
});
return _1.hash;
});


;define("dojo/i18n!ic-core/config/nls/widgetbundles", {"Forum":"Forums","feedReader":"Feed Reader","importantBookmarksDescription":"Collect bookmarks to web resources that are important to your community.","filesDescription":"Upload, share and work with community files and folders.","lc_clib":{"Gallery.description":"Showcase files in this community.","Gallery":"Gallery","CustomLibrary.description":"Use a document repository in your community.","librarysummary.description":"Use a document repository in your community.","Library.description":"Work with files using drafts, reviewers, and publishing.","CustomLibrary":"Linked Library","librarysummary":"Document Repository","Library":"Library","MediaGallery.description":"Share photos and videos with the community.","Library.sequenceNumber":"Library {0}","CustomLibrary.sequenceNumber":"Linked Library {0}","MediaGallery":"Media Gallery"},"Activities":"Activities","subcommunityDescription":"Bring together a subset of members within an existing community.","widgetPalette":"Widget Palette","SubcommunityNav":"Subcommunities","ImportantBookmarks":"Important Bookmarks","forumDescription":"Discuss topics and share ideas.","eventsDescription":"Post important community events such as seminars and training. ","tagsDescription":"Group interesting content using meaningful keywords to make it easier to find.","Updates":"Recent Updates","blogsDescription":"Quickly and dynamically share your news and views with community members.","wikiDescription":"Share resources with your community and collaborate with colleagues.","commActivitesDescription":"Track your community\'s goals, organize tasks and assign to-do items.","memberSummaryDescription":"People who are part of this community.  Share information and collaborate with members to bring your community to life.","Tags":"Tags","RelatedCommunities":"Related Communities","relatedCommunitiesDescription":"Build links to other communities.  ","CommunityUpdates":"Community Updates","Blog":"Blog","galleryDescription":"Share photos and videos with the community.","lc_sand":{"sand_simComm":"Similar Communities","sand_thingsInCommon":"Things in Common","sand_DYK":"Do You Know","sand_socialPath":"Who Connects Us?","sand_recomItems":"Recommendations","sand_recomComm":"Recommendations"},"RecentUpdates":"Recent Updates","MyLibrary":"My Library","Wiki":"Wiki","commBookmarks":"Make useful web resources available directly from your community.","updatesDescription":"Update your community status to let other members know what you are doing.","ideationBlogsDescription":"Collaborate with community members to contribute and vote on ideas.","Files":"Files","StatusUpdates":"Status Updates","RichContent":"Rich Content","Bookmarks":"Bookmarks","Calendar":{"default":"Events","view":"Upcoming Events"},"calendarDescription":"Post important community events such as seminars and training. ","descriptionDescription":"An overview of what your community is for.  The description should reflect the community\'s goals and values.","MyLibrary.sequenceNumber":"My Library {0}","commFeeds":"Add feeds to relevant web sites to your community.","IdeationBlog":"Ideation Blog","MembersSummary":"Members","Feeds":"Feeds","lc_default":{"commonTags":"Organization Tags","friends":"Network","socialTags":"Tags","board":"The Board","linkRoll":"My Links","filesReader":"Files","multiFeedReader":"Recent Posts","backgroundInfo":"Background","multiWidget":"Profile Information","structTags":"Structured Tags","contactInfo":"Contact Information","reportStructure":"Report-to Chain"},"Members":"Members","description":"Community Description"});

;define("dojo/i18n!ic-core/nls/widgets", {"edit":"Edit","error.message.generic":"Something went wrong - click the Back button and try again. If this does not work, report the problem in the support forum.","widgets_MoveNext":"Move To Next Column","widgets_MoveRight":"Move Right","errorLine":"Line:","hideWidget":"Hide Application","dykLoadInfo2":"View recommended people to add to your network based on your existing network contacts.","widgets_MoveLeft":"Move Left","deleteWidgetMsg":"You are about to remove your application. This will remove all application content. This action cannot be undone. Content that members share with the community is still shared. If the application is added again, this shared content reappears in the application.\x3cbr/\x3e\x3cbr/\x3eIf you are sure you want to remove the application, click the Remove button below. \x3cbr/\x3eOtherwise, click Cancel.","help":"Help","hide":"Hide","dykLoadInfo":"View recommended people to add to your network.","open":"Open","toggle":"Toggle","widgets_MovePrev":"Move To Previous Column","errorMsg":"Message: ","widgetCat_AllWidgets":"All Applications","widget_RemovingWidget":"Removing Application","ticLoadInfo":"Find out what you have in common with this profile based on your network and activity.","errorType":"Type: ","label.theme.customize":"Add Apps","actions_alt":"Actions for: ${0}","cancel":"Cancel","msg.loginRequired":"Log in to view your content.","hideWidgetMsg":"You are about to hide your application.\x3cbr/\x3e\x3cbr/\x3eYou can re-activate it at a later point simply by re-adding the application to your Community. All of the application content will be kept intact.","link.window.openNewWindow":"Clicking this will open a new window","save":"Save","widget_AddingWidget":"Adding Application","widgets_Move":"Move","errorDefaultMsg2":"An error has occurred, contact your system Administrator","errorDefaultMsg3":"Click here to show more details","errorUnableToConnect":"Connection failed for {0}","widgetCat_hidden":"Hidden","switchTabWarning":"You must save changes on each tab before moving to another tab.","HideErrorDetails":"Hide Error Details","widgets_Min":"Minimize","view":"View","errorDefaultMsg":"Unable to display application data","delete":"Delete","confirmDeleteWidget":"Are you sure you want to remove this application?\x3cbr\x3e\x3cbr\x3eYou can restore this application later through the Community Actions menu.  Any settings for displaying the application are lost, but the application\'s data remains intact.","widget_AllTab":"All","errorName":"Name: ","loadInfo":"Load Information ...","widgets_Max":"Maximize","showErrorDetails":"Show Error Details","widgets_MoveDown":"Move Down","errorStackTrace":"Trace: ","ErrorGeneric":"An error occurred while displaying content. Contact your system administrator.","deleteWidget":"Remove Application","widgetCat_thrdParty":"Other","widget_BackToOverview":"Back to Overview Page","deleteWithSharedContentWidgetConfirm":"I understand that the application and its associated data will be deleted and cannot be recovered.  Content that members share with the community is still shared. If the application is added again, this shared content reappears in the application.","info.feed.general.moreinfo":"Click here to show more details","multiFeedReaderNoFeeds":"No feeds available","refresh":"Refresh","error.title.generic":"We\'ve encountered a problem.","actionsmenu":"Actions Menu","changeTitleAction":"Change Title","str_component_id":"CLFWZ","link.window.close":"Close window","deleteWidgetConfirm":"I understand that the application and its associated data will be deleted and cannot be recovered.","deleteWidgetWarn":"Warning: Data for the application {0} will be permanently deleted.","close":"Close","link.remove":"Remove","widgets_MoveUp":"Move Up","wcuLoadInfo":"Find out how you are related to this profile based on your network and actions.","actions":"Actions"});

;define("ic-ui/aria/_Helper",["dojo","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/on","dojo/query","dojo/topic","dijit/focus","dijit/_base/wai"],function(_1,_2,_3,_4,_5,_6,_7,_8,on,_9,_a,_b){
return _3("com.ibm.oneui.aria._Helper",null,{allItems:null,selIdx:-1,_connects:null,detectInvert:false,invert:false,cycle:true,containerRole:"",itemRole:"",scrollVertical:true,scrollHorizontal:true,constructor:function(_c,_d){
_1.safeMixin(this,_d||{});
this._connects=[];
var cn=this.containerNode=this._getNode(_c),ai=this.allItems=_9(["[role='",this.itemRole,"']"].join(""),cn),_e=_2.forEach;
if(this.detectInvert){
_e(ai,_4.hitch(this,this._detectInvert));
}
var i,_f;
for(i=0,_f;_f=ai[i];i++){
if(this._isSelected(_f)){
this.selIdx=i;
break;
}
}
if(this.selIdx==-1){
this.selIdx=this._getSelIdx(!this.invert);
}
_e(ai,_4.hitch(this,this._resetItem,ai[this.selIdx]));
this._connects.push(on(cn,"click",_4.hitch(this,"_onItemClick")));
this._connects.push(on(cn,"keydown",_4.hitch(this,"_onKeyDown")));
},destroy:function(){
_2.forEach(this._connects,_4.hitch(_1,_1.disconnect));
},focus:function(){
if(this.selIdx>=0){
_b.focus(this.allItems[this.selIdx]);
}else{
this.focusNextItem();
}
},focusNextItem:function(){
this._focusItem(!this.invert);
},focusPrevItem:function(){
this._focusItem(this.invert);
},_focusItem:function(fwd){
var ai=this.allItems,si=this._getSelIdx(fwd);
if(si!=this.selIdx){
this._kickOut(ai[this.selIdx]);
this._kickIn(ai[si]);
_b.focus(ai[si]);
this.selIdx=si;
}
},_getNode:function(_10){
var _11=_5.byId(_10);
if(!_11){
throw [this.declaredClass,": "+_10," is not a valid node or id"].join("");
}
if(!dijit.hasWaiRole(_11,this.containerRole)){
throw [this.declaredClass," needs a source node with role='",this.containerRole,"'"].join("");
}
return _11;
},_kickOut:function(_12,i){
_6.set(_12,"tabindex",-1);
},_kickIn:function(_13,i){
_1.removeAttr(_13,"tabindex");
},_onItemClick:function(e){
var idx=this._getIndexOfItemFromEvent(e);
if(idx!=-1){
this.selIdx=idx;
var tgt=this.allItems[idx];
_2.forEach(this.allItems,_4.hitch(this,this._resetItem,tgt));
}
},_getIndexOfItemFromEvent:function(e){
var idx=-1,tgt;
do{
tgt=tgt?tgt.parentNode:e.target;
idx=_2.indexOf(this.allItems,tgt);
}while(idx==-1&&tgt&&tgt!=this.containerNode);
return idx;
},_onKeyDown:function(e){
var dk=_1.keys;
if(e.altKey||e.metaKey||e.ctrlKey||e.shiftKey){
return;
}
var _14=_7.isBodyLtr()?dk.RIGHT_ARROW:dk.LEFT_ARROW;
var _15=_7.isBodyLtr()?dk.LEFT_ARROW:dk.RIGHT_ARROW;
switch(e.keyCode){
case this.scrollHorizontal?_14:-1:
case this.scrollVertical?dk.DOWN_ARROW:-1:
e.preventDefault();
e.stopPropagation();
this.focusNextItem();
break;
case this.scrollHorizontal?_15:-1:
case this.scrollVertical?dk.UP_ARROW:-1:
e.preventDefault();
e.stopPropagation();
this.focusPrevItem();
break;
}
},_resetItem:function(sel,_16,i){
if(_16==sel){
this._kickIn(_16);
}else{
this._kickOut(_16);
}
},_detectInvert:function(_17,i){
var ps=[],pp=_17,n=0;
do{
ps.push(_8.get(pp,"float"));
pp=pp.parentNode;
}while(pp!=this.containerNode&&n++<10);
var rh=(_7.isBodyLtr()?"right":"left");
if(_2.indexOf(ps,rh)!=-1){
this.invert=true;
}
},_isSelected:function(_18){
return false;
},_isHidden:function(_19){
var cn=this.containerNode;
var n=_19;
while(n&&n!=cn){
if(_8.get(n,"display")=="none"||dijit.getWaiState(n,"hidden")=="true"){
return true;
}
n=n.parentNode;
}
return false;
},_getSelIdx:function(fwd){
var n=0,c=this.allItems.length,r=this.selIdx;
do{
r=fwd?this._nextSelIdx(r):this._prevSelIdx(r);
}while(this._isHidden(this.allItems[r])&&n++<c);
return r;
},_prevSelIdx:function(_1a){
var ret=-1;
if(this.cycle){
ret=_1a-1;
if(ret<0){
ret=this.allItems.length-1;
}
}else{
ret=Math.max(0,_1a-1);
}
return ret;
},_nextSelIdx:function(_1b){
var ret=-1;
if(this.cycle){
ret=_1b+1;
if(ret>=this.allItems.length){
ret=0;
}
}else{
ret=Math.min(this.allItems.length-1,_1b+1);
}
return ret;
}});
});


;define("ic-ui/aria/TabPanel",["dojo/_base/declare","./_Helper"],function(_1,_2){
var _3=_1("com.ibm.oneui.aria.TabPanel",_2,{containerRole:"tablist",itemRole:"tab",focusNextItem:function(){
var si=this.selIdx;
this.inherited(arguments);
this._selectItem(si);
},focusPrevItem:function(){
var si=this.selIdx;
this.inherited(arguments);
this._selectItem(si);
},_selectItem:function(si){
var ai=this.allItems;
if(si!=this.selIdx){
dijit.setWaiState(ai[si],"selected","false");
dijit.setWaiState(ai[this.selIdx],"selected","true");
this._activate(ai[this.selIdx]);
}
},_isSelected:function(_4){
return dijit.getWaiState(_4,"selected")==="true";
},_activate:function(_5){
try{
if(document.createEvent){
var _6=document.createEvent("HTMLEvents");
_6.initEvent("click",false,true);
_5.dispatchEvent(_6);
}else{
_5.fireEvent("onclick");
}
}
catch(e){
console.error([this.declaredClass,": ",e].join(""));
}
}});
return _3;
});


;define("ic-core/aria/TabPanel",["dojo/_base/kernel","ic-ui/aria/TabPanel"],function(_1,_2){
_1.deprecated("ic-core/aria/TabPanel","Use ic-ui/aria/TabPanel instead","5.0");
return _2;
});


;define("ic-ui/aria/Toolbar",["dojo/_base/declare","./_Helper"],function(_1,_2){
var _3=_1("com.ibm.oneui.aria.Toolbar",_2,{containerRole:"toolbar",itemRole:"button"});
return _3;
});


;define("ic-core/aria/Toolbar",["dojo/_base/kernel","ic-ui/aria/Toolbar"],function(_1,_2){
_1.deprecated("ic-core/aria/Toolbar","Use ic-ui/aria/Toolbar instead","5.0");
return _2;
});


;define("dojox/data/dom",["dojo/_base/kernel","dojo/_base/lang","dojox/xml/parser"],function(_1,_2,_3){
dojo.deprecated("dojox.data.dom","Use dojox.xml.parser instead.","2.0");
var _4=_2.getObject("dojox.data.dom",true);
_4.createDocument=function(_5,_6){
dojo.deprecated("dojox.data.dom.createDocument()","Use dojox.xml.parser.parse() instead.","2.0");
try{
return _3.parse(_5,_6);
}
catch(e){
return null;
}
};
_4.textContent=function(_7,_8){
dojo.deprecated("dojox.data.dom.textContent()","Use dojox.xml.parser.textContent() instead.","2.0");
if(arguments.length>1){
return _3.textContent(_7,_8);
}else{
return _3.textContent(_7);
}
};
_4.replaceChildren=function(_9,_a){
dojo.deprecated("dojox.data.dom.replaceChildren()","Use dojox.xml.parser.replaceChildren() instead.","2.0");
_3.replaceChildren(_9,_a);
};
_4.removeChildren=function(_b){
dojo.deprecated("dojox.data.dom.removeChildren()","Use dojox.xml.parser.removeChildren() instead.","2.0");
return dojox.xml.parser.removeChildren(_b);
};
_4.innerXML=function(_c){
dojo.deprecated("dojox.data.dom.innerXML()","Use dojox.xml.parser.innerXML() instead.","2.0");
return _3.innerXML(_c);
};
return _4;
});


;define("ic-core/i18nOverrider",["dojo","dojo/i18n"],function(_1,_2){
_1.deprecated("core.i18nOverrider","Use standard resource bundle operations, stop requiring core.i18nOverrider.","3.5");
var _3={};
_3.getResourceString=function(_4){
throw "Use dojo.i18n.getLocalization(...) instead";
};
_3.loadResourceStringsInParams=function(_5,_6){
throw "Use dojo.i18n.getLocalization(...) instead";
};
_3.replaceParams=function(_7,_8){
_1.deprecated("i18nOverrider.replaceParams","Use dojo.string.substitute with ${} strings instead","3.5");
var _9=_7.indexOf("{");
if(_9!=-1){
var _a=_7.indexOf("}");
if(_a==-1){
return _7;
}
var _b=_7.substring(_9+1,_a);
var _c=_8[_b];
if(typeof _c=="undefined"){
_c="{"+_b+"}";
}
return _7.substring(0,_9)+_c+_3.replaceParams(_7.substring(_a+1),_8);
}else{
return _7;
}
};
return _3;
});


;define("ic-core/utilities",["dojo","dojo/_base/array","dojo/_base/lang","dojo/dom","dojo/dom-style","dojo/fx","dojo/has","dojox/xml/parser","ic-core/i18nOverrider","ic-core/url"],function(_1,_2,_3,_4,_5,fx,_6,_7,_8,_9){
var _a={};
_a.getHash=function(){
var _b=document.location.href;
var i=_b.indexOf("#");
if(i==-1){
return "";
}
return _b.substring(i+1);
};
_a.getURLParam=function(_c,_d){
var _e=_9.parse(window.location.href);
var _f=_e.queryParameters[_c];
if(_d&&_f===undefined&&_e.fragment){
_f=_9.splitQuery(_e.fragment)[_c];
if(_f===undefined){
try{
var _10=decodeURIComponent(_e.fragment);
if(_10!=_e.fragment){
_f=_9.splitQuery(_10)[_c];
}
}
catch(e){
}
}
}
if(_3.isArray(_f)){
return _f[0];
}
return _f;
};
_a.isCSSSpriteOn=function(){
var img=document.createElement("img");
img.className="lotusSprite lotusSprite-iconPublic16";
img.style.display="none";
document.body.appendChild(img);
var pos=_5.get(img).backgroundPosition;
var _11=pos&&pos!="0px 0px";
return _11;
};
_a.replacePlaceHolders=function(_12,_13){
var _14=new Object();
for(var i=0;_13!=null&&i<_13.length;i++){
_14[""+i+""]=_13[i];
}
return _8.replaceParams(_12,_14);
};
_a.processUntilElementIsFound=function(_15,_16,_17,_18,_19,_1a,_1b){
if(typeof (_16)!="function"){
return;
}
var _1c=500;
var _1d=20;
var _1e=true;
if(typeof (_1a)=="number"){
_1c=_1a;
}
if(typeof (_1b)=="number"){
_1d=_1b;
}
if(typeof (_19)=="boolean"){
_1e=_19;
}
var _1f="";
var _20=0;
var _21=null;
if(_17!=null){
_21=_17.getElementById(_15);
}else{
_21=_4.byId(_15);
}
if(_21!=null){
_16(_21,_18);
return;
}
_1f=window.setInterval(function(){
var _22=null;
if(_17!=null){
_22=_17.getElementById(_15);
}else{
_22=_4.byId(_15);
}
_20++;
if(_22!=null){
window.clearInterval(_1f);
_16(_22,_18);
}else{
if(_20==_1d){
window.clearInterval(_1f);
if(_1e){
throw new Error("ic-core/utilities.processUntilElementIsFound: elementId was never found: "+_15);
}
}
}
},_1c);
};
_a.processUntilAvailable=function(_23,_24,_25,_26,_27,_28){
if(typeof (_23)!="function"){
return;
}
var _29=500;
var _2a=20;
var _2b=true;
if(typeof (_27)=="number"){
_29=_27;
}
if(typeof (_28)=="number"){
_2a=_28;
}
if(typeof (_26)=="boolean"){
_2b=_26;
}
var _2c="";
var _2d=0;
if(eval(_24)){
if(_25!=null){
_23(_25);
}else{
_23();
}
return;
}
_2c=window.setInterval(function(){
_2d++;
if(eval(_24)){
window.clearInterval(_2c);
if(_25!=null){
_23(_25);
}else{
_23();
}
}else{
if(_2d==_2a){
window.clearInterval(_2c);
if(_2b){
throw new Error("ic-core/utilities.processUntilAvailable: test was never met: "+_24);
}
}
}
},_29);
};
_a.gotoURL=function(url,_2e){
if(_2e==null){
if(url.indexOf("?")!=-1){
url+="&ver="+profilesData.config.buildNumber+"&lastMod="+profilesData.config.profileLastMod;
}else{
url+="?ver="+profilesData.config.buildNumber+"&lastMod="+profilesData.config.profileLastMod;
}
}
if(_6("ie")){
var _2f=url;
setTimeout("window.location.href = SideBar_RedirectUrl",0);
}else{
window.location.assign(url);
}
};
_a.toggleVisibility=function(_30,_31){
var _32=null;
if((typeof _30)=="string"){
_32=_4.byId(_30);
}else{
_32=_30;
}
if(_32){
if(_32.style.visibility=="hidden"){
_a.show(_32,_31);
}else{
_a.hide(_32,_31);
}
}
return false;
};
_a.hide=function(_33,_34,_35,_36){
var _37=null;
if((typeof _33)=="string"){
_37=_4.byId(_33);
}else{
_37=_33;
}
if(_37!=null){
var _38=function(){
_37.style.visibility="hidden";
if(!_34){
_37.style.display="none";
}
if(_36!=null){
_36();
}
};
if(_35==null||_35==false){
var _39=fx.wipeOut({node:_37,duration:300,onEnd:_38});
_39.play();
}else{
_38();
}
}
return false;
};
_a.show=function(_3a,_3b,_3c,_3d,_3e){
var _3f=0;
var _40=null;
if((typeof _3a)=="string"){
_40=_4.byId(_3a);
}else{
_40=_3a;
}
if(_3c&&_40==null){
var _41="";
_41=window.setInterval(function(){
_3f++;
if((typeof _3a)=="string"){
_40=_4.byId(_3a);
}else{
_40=_3a;
}
if(_40!=null){
window.clearInterval(_41);
_a.show(_40,_3b,false,_3d,_3e);
}else{
if(_3f==20){
window.clearInterval(_41);
}
}
},300);
}else{
if(_40!=null){
var _42=function(){
_40.style.visibility="visible";
if(!_3b){
_40.style.display="block";
}
if(_3e!=null){
_3e();
}
};
if(_3d==null||_3d==false){
var _43=fx.wipeIn({node:_40,duration:300});
_43.play();
}else{
_42();
}
}
}
return false;
};
_a.loadScript=function(_44){
if(this.scripts==null){
this.scripts={};
}
if(!this.scripts[_44]){
this.scripts[_44]=true;
var _45=document.createElement("script");
_45.src=_44;
document.body.insertBefore(_45,document.body.firstChild);
}
};
_a.getExtension=function(s){
if(!s){
return "";
}
var i=s.lastIndexOf(".");
if(i!=-1){
return _3.trim(s.substring(i+1).toLowerCase());
}
return "";
};
_a.getFileIconClassName=function(_46,_47){
var _47=_47||16;
var _48=_a.getExtension(_46);
_48=_48.replace(/[^a-z0-9]/g,"-");
var _49="lconn-ftype{size} lconn-ftype{size}-{ext}";
var _4a=_49.replace(/\{size\}/g,_47).replace(/\{ext\}/g,_48);
return _4a;
};
_a.getGridActionClass=function(_4b,_4c){
var _4c=_4c||16;
var _4d=_a.getExtension(_4b);
_4d=_4d.replace(/[^a-z0-9]/g,"-");
var _4e="grid-a-{ext}";
var _4f=_4e.replace(/\{ext\}/g,_4d);
return _4f;
};
_a.isDefined=function(_50){
var _51=_50.indexOf(".");
var _52=true;
if(_51!=-1){
_52=_a.isDefined(_50.substring(0,_51));
if(_52){
var _53=eval("typeof( "+_50+") != 'undefined'");
return _53;
}else{
return false;
}
}else{
return (window[_50]!=null);
}
};
if(_6("ie")&&"DOMParser" in _1.global){
_7["parse.orig"]=_7.parse;
_7.parse=function(str,_54){
try{
var doc;
var ms=function(n){
return "MSXML"+n+".DOMDocument";
};
_2.some(["Microsoft.XMLDOM",ms(6),ms(4),ms(3),ms(2)],function(p){
try{
doc=new ActiveXObject(p);
}
catch(e){
return false;
}
return true;
});
if(str&&doc){
doc.async=false;
doc.loadXML(str);
}
if(doc){
return doc;
}
}
catch(e){
}
return _7["parse.orig"](str,_54);
};
}
return _a;
});


;define("ic-core/errorhandling",["dojo","dojo/dom","dojo/i18n","dojo/i18n!ic-core/nls/widgets","dijit/_Widget","dojox/data/dom","ic-core/utilities"],function(_1,_2,_3,_4,_5,_6,_7){
var _8={};
_8.DefaultXHRErrorHandler=function(_9,_a){
var _b=_4;
var _c=null;
var _d=null;
if(_9.status==404){
if(_a.args!=null&&_a.args.url!=null){
if(_a.args.url.indexOf("roller-ui/feed")!=-1||_a.args.url.indexOf("files/basic/anonymous/api/userlibrary")!=-1||_a.args.url.indexOf("wikis/basic/anonymous/api/userlibrary")!=-1){
_d=_b["multiFeedReaderNoFeeds"];
_8.displayError(_a,_d,_9);
return;
}
}
}
if(_9.status==400){
if(_a.args!=null&&_a.args.url!=null){
if(_a.args.url.indexOf("service/atom/communities")!=-1){
_d=_b["multiFeedReaderNoFeeds"];
_8.displayError(_a,_d,_9);
return;
}
}
}
if(_9.documentElement!=null){
if(_9.documentElement.nodeName=="error"||_9.documentElement.nodeName=="parsererror"){
var _e=(_6.innerXML(_9.documentElement));
_d=_8.getErrorHTML(null,null,null,null,_e);
}
}else{
var _f=_b["errorUnableToConnect"];
_f=_7.replacePlaceHolders(_f,[_a.args.url]);
if(_9.message!=null&&_9.name!=null){
if(_a.args.xsltArgs!=null){
return _8.DefaultErrorHandler(_f,_9,_a.args.xsltArgs);
}else{
return _8.DefaultErrorHandler(_f,_9,_a.args.htmlContainerElemId);
}
}else{
_d=_8.getErrorHTML(_f,null,null,null,_9);
}
}
if(_d==null){
_d=_8.getErrorHTML(null,null,null,null,_9);
}
_8.displayError(_a,_d,_9);
};
_8.displayError=function(_10,msg,_11){
var _12=null;
if(_10.args.xsltArgs!=null&&_10.args.xsltArgs.htmlContainerElemId!=null){
_12=_10.args.xsltArgs.htmlContainerElemId;
}else{
if(_10.args.htmlContainerElemId!=null){
_12=_10.args.htmlContainerElemId;
}
}
if(_12!=null){
if(typeof (_12)=="string"){
_2.byId(_12).innerHTML=msg;
}else{
_12.innerHTML=msg;
}
}else{
alert("htmlContainerElemId was not defined.\n"+msg+"\nArguments: "+_10+"\nresponse: "+_11);
}
};
_8.DefaultErrorHandler=function(_13,_14,_15){
var log=function(_16,_17,_18){
var msg="";
if(_17 instanceof (Error)){
var _19=null;
if(_17.lineNumber!=null){
_19=_17.lineNumber;
}
if(_19!=null){
msg+=_4["errorLine"]+" "+_19+"<br/>";
}
var _1a=null;
msg=_8.getErrorHTML(_16,_17.message,_17.name,_19,_1a);
}else{
var _1a=null;
msg=_8.getErrorHTML(_16,_17,null,null,_1a);
}
var _1b={args:{xsltArgs:{htmlContainerElemId:_18}}};
_8.displayError(_1b,msg);
};
if(typeof (_15)=="string"){
log(_13,_14,_15);
}else{
if(typeof (_15)=="undefined"){
var _1c=document.createElement("span");
_1c.id="errorContainer";
document.body.appendChild(_1c);
log(_13,_14,"errorContainer");
}else{
if(_15.htmlContainerElemId!=null){
log(_13,_14,_15.htmlContainerElemId);
}else{
log(_13,_14,_15);
}
}
}
};
_8.getErrorHTML=function(_1d,_1e,_1f,_20,_21){
var _22=_4;
var _23=new Date().getTime();
var msg="";
if(_1e!=null&&_1e.indexOf("BMWIW0001E")!=-1){
msg+="<div class='lconnWidgetMsgError lconnWidgetMsgCompact'>";
}else{
msg+="<div class='lconnWidgetMsgError'>";
}
var id=dijit.getUniqueId("error");
msg+="<img class='lconnSprite lconnSprite-iconError16' src='"+_5.prototype._blankGif+"'/><b>"+_22["errorDefaultMsg"]+"</b><br/>";
msg+=_22["errorDefaultMsg2"]+"<br/><br/>";
msg+="<a href='javascript:void(0);' onclick=\"utilities.toggleVisibility('"+id+"');\">"+_22["errorDefaultMsg3"]+"</a>";
msg+="<div id='"+id+"' style='visibility: hidden; display: none;'>";
msg+="<br/>";
if(_1d!=null){
msg+=_22["errorName"]+" "+_1d+"<br/>";
}
if(_1e!=null){
msg+=_22["errorMsg"]+" "+_1e+"<br/>";
}
if(_1f!=null){
msg+=_22["errorType"]+""+_1f+"<br/>";
}
if(_20!=null){
msg+=_22["errorLine"]+" "+_20+"<br/>";
}
if(_21!=null){
msg+=_22["errorStackTrace"]+"<br/><pre>"+_21+"</pre><br/>";
}
msg+="</div>";
msg+="</div>";
return msg;
};
var _24=function(){
var _25=_24.caller;
var _26=new Error();
if(_26.stack!=null){
return _26.stack;
}else{
var _27="";
while(_25!=null){
_27+="\n"+_28(_25);
var _29=_25.caller;
if(_29==null&&_25.arguments!=null&&_25.arguments.caller!=null){
_29=_25.arguments.caller;
}
_25=_29;
}
return _27;
}
};
var _28=function(_2a){
var _2b=_2a.name;
if(_2a.tempName!=null&&_2a.tempName!=""){
_2b=_2a.tempName;
}
if(_2b==null||_2b==""){
var _2c=_2a.toString();
var _2d=_2c.match(/function (\w*)/);
if(_2d!=null){
_2b=_2d[1];
}
if(_2b==null||_2b==""){
_2b="anonymous-function";
}
}
return _2b;
};
return _8;
});


;define("ic-core/HTMLUtil",["dojo/_base/kernel","dojo/_base/lang"],function(_1,_2){
_1.deprecated("ic-core/HTMLUtil","Use ic-core/util/html instead","6.0");
var _3=_2.getObject("lconn.core.HTMLUtil",true);
_3.setInnerTextNode=function(el,_4){
el.innerHTML="";
el.appendChild(document.createTextNode(_4));
};
_3.escapeInlineText=function(_5){
return _3.escapeText(_5,true);
};
_3.escapeText=function(_6,_7){
if(!_6||_6===""){
return "";
}
var _8=document.getElementById("escapeBufferDiv");
if(!_8){
var _9=document.createElement("div");
_9.id="escapeBufferDiv";
_9.style.display="none";
document.body.appendChild(_9);
_8=_9;
}
_8.appendChild(document.createTextNode(_6));
var _a=_8.innerHTML;
_8.innerHTML="";
if(_7){
_a=_3.escape_q(_a);
}
return _a;
};
_3.escape_q=function(_b){
if(!_b||_b===""){
return "";
}
var t="";
for(var i=0;i<_b.length;i++){
var c=_b.charAt(i);
if(c=="\""){
t+="&#34;";
}else{
if(c=="'"){
t+="&#39;";
}else{
if(c=="\\"){
t+="&#92;&#92;";
}else{
t+=c;
}
}
}
}
return t;
};
return _3;
});


;define("ic-core/util/widgetPlacementConfig",["dojo/_base/array","dojo/_base/lang"],function(_1,_2){
"use strict";
function _3(_4,_5,_6){
return _1.filter(_4,function(_7){
return _7.getAttribute(_5)===_6;
});
};
function _8(_9){
var _a,_b;
_a=_2.getObject("WidgetPlacementConfig.widgetConfigXMLDocument.documentElement");
if(!_a){
return [];
}
_b=_a.getElementsByTagName("widgetDef");
if(_9){
_b=_3(_b,"defId",_9);
}
return _b;
};
function _c(_d,_e,id){
var _f,_10;
_f=_2.getObject("WidgetPlacementConfig.widgetConfigXMLDocument.documentElement");
if(!_f){
return [];
}
if(_d){
_10=_f.getElementsByTagName("page");
_10=_3(_10,"pageId",_d);
_f=_10[0];
}
if(!_f){
return [];
}
_10=_f.getElementsByTagName("widgetInstance");
if(_e){
_10=_3(_10,_e,id);
}
return _10;
};
function _11(_12){
var _13,_14;
_13=_2.getObject("WidgetPlacementConfig.widgetConfigXMLDocument.documentElement");
if(!_13){
return [];
}
if(_12){
_14=_13.getElementsByTagName("page");
_14=_3(_14,"pageId",_12);
_13=_14[0];
}
return _13;
};
var _15={getDefinitions:function(){
return _8();
},getDefinitionById:function(_16){
if(!_16){
return;
}
var _17=_8(_16);
return _17[0];
},getInstances:function(_18){
return _c(_18);
},getInstancesByDefId:function(_19,_1a){
return _c(_1a,"defIdRef",_19);
},getInstanceByInstId:function(_1b,_1c){
var _1d=_c(_1c,"instanceId",_1b);
return _1d[0];
},getPageById:function(_1e){
return _11(_1e);
}};
_2.setObject("lconn.core.util.widgetPlacementConfig",_15);
return _15;
});


;define("dojo/dnd/Avatar",["../_base/declare","../_base/window","../dom","../dom-attr","../dom-class","../dom-construct","../hccss","../query"],function(_1,_2,_3,_4,_5,_6,_7,_8){
return _1("dojo.dnd.Avatar",null,{constructor:function(_9){
this.manager=_9;
this.construct();
},construct:function(){
var a=_6.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_a=this.manager.source,_b,b=_6.create("tbody",null,a),tr=_6.create("tr",null,b),td=_6.create("td",null,tr),k=Math.min(5,this.manager.nodes.length),i=0;
if(_7("highcontrast")){
_6.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td);
}
_6.create("span",{innerHTML:_a.generateText?this._generateText():""},td);
_4.set(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});
for(;i<k;++i){
if(_a.creator){
_b=_a._normalizedCreator(_a.getItem(this.manager.nodes[i].id).data,"avatar").node;
}else{
_b=this.manager.nodes[i].cloneNode(true);
if(_b.tagName.toLowerCase()=="tr"){
var _c=_6.create("table"),_d=_6.create("tbody",null,_c);
_d.appendChild(_b);
_b=_c;
}
}
_b.id="";
tr=_6.create("tr",null,b);
td=_6.create("td",null,tr);
td.appendChild(_b);
_4.set(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});
}
this.node=a;
},destroy:function(){
_6.destroy(this.node);
this.node=false;
},update:function(){
_5.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);
if(_7("highcontrast")){
var _e=_3.byId("a11yIcon");
var _f="+";
if(this.manager.canDropFlag&&!this.manager.copy){
_f="< ";
}else{
if(!this.manager.canDropFlag&&!this.manager.copy){
_f="o";
}else{
if(!this.manager.canDropFlag){
_f="x";
}
}
}
_e.innerHTML=_f;
}
_8(("tr.dojoDndAvatarHeader td span"+(_7("highcontrast")?" span":"")),this.node).forEach(function(_10){
_10.innerHTML=this.manager.source.generateText?this._generateText():"";
},this);
},_generateText:function(){
return this.manager.nodes.length.toString();
}});
});


;define("dojo/dnd/Manager",["../_base/array","../_base/declare","../_base/lang","../_base/window","../dom-class","../Evented","../has","../keys","../on","../topic","../touch","./common","./autoscroll","./Avatar"],function(_1,_2,_3,_4,_5,_6,_7,_8,on,_9,_a,_b,_c,_d){
var _e=_2("dojo.dnd.Manager",[_6],{constructor:function(){
this.avatar=null;
this.source=null;
this.nodes=[];
this.copy=true;
this.target=null;
this.canDropFlag=false;
this.events=[];
},OFFSET_X:_7("touch")?0:16,OFFSET_Y:_7("touch")?-64:16,overSource:function(_f){
if(this.avatar){
this.target=(_f&&_f.targetState!="Disabled")?_f:null;
this.canDropFlag=Boolean(this.target);
this.avatar.update();
}
_9.publish("/dnd/source/over",_f);
},outSource:function(_10){
if(this.avatar){
if(this.target==_10){
this.target=null;
this.canDropFlag=false;
this.avatar.update();
_9.publish("/dnd/source/over",null);
}
}else{
_9.publish("/dnd/source/over",null);
}
},startDrag:function(_11,_12,_13){
_c.autoScrollStart(_4.doc);
this.source=_11;
this.nodes=_12;
this.copy=Boolean(_13);
this.avatar=this.makeAvatar();
_4.body().appendChild(this.avatar.node);
_9.publish("/dnd/start",_11,_12,this.copy);
function _14(e){
e.preventDefault();
e.stopPropagation();
};
this.events=[on(_4.doc,_a.move,_3.hitch(this,"onMouseMove")),on(_4.doc,_a.release,_3.hitch(this,"onMouseUp")),on(_4.doc,"keydown",_3.hitch(this,"onKeyDown")),on(_4.doc,"keyup",_3.hitch(this,"onKeyUp")),on(_4.doc,"dragstart",_14),on(_4.body(),"selectstart",_14)];
var c="dojoDnd"+(_13?"Copy":"Move");
_5.add(_4.body(),c);
},canDrop:function(_15){
var _16=Boolean(this.target&&_15);
if(this.canDropFlag!=_16){
this.canDropFlag=_16;
this.avatar.update();
}
},stopDrag:function(){
_5.remove(_4.body(),["dojoDndCopy","dojoDndMove"]);
_1.forEach(this.events,function(_17){
_17.remove();
});
this.events=[];
this.avatar.destroy();
this.avatar=null;
this.source=this.target=null;
this.nodes=[];
},makeAvatar:function(){
return new _d(this);
},updateAvatar:function(){
this.avatar.update();
},onMouseMove:function(e){
var a=this.avatar;
if(a){
_c.autoScrollNodes(e);
var s=a.node.style;
s.left=(e.pageX+this.OFFSET_X)+"px";
s.top=(e.pageY+this.OFFSET_Y)+"px";
var _18=Boolean(this.source.copyState(_b.getCopyKeyState(e)));
if(this.copy!=_18){
this._setCopyStatus(_18);
}
}
if(_7("touch")){
e.preventDefault();
}
},onMouseUp:function(e){
if(this.avatar){
if(this.target&&this.canDropFlag){
var _19=Boolean(this.source.copyState(_b.getCopyKeyState(e)));
_9.publish("/dnd/drop/before",this.source,this.nodes,_19,this.target,e);
_9.publish("/dnd/drop",this.source,this.nodes,_19,this.target,e);
}else{
_9.publish("/dnd/cancel");
}
this.stopDrag();
}
},onKeyDown:function(e){
if(this.avatar){
switch(e.keyCode){
case _8.CTRL:
var _1a=Boolean(this.source.copyState(true));
if(this.copy!=_1a){
this._setCopyStatus(_1a);
}
break;
case _8.ESCAPE:
_9.publish("/dnd/cancel");
this.stopDrag();
break;
}
}
},onKeyUp:function(e){
if(this.avatar&&e.keyCode==_8.CTRL){
var _1b=Boolean(this.source.copyState(false));
if(this.copy!=_1b){
this._setCopyStatus(_1b);
}
}
},_setCopyStatus:function(_1c){
this.copy=_1c;
this.source._markDndStatus(this.copy);
this.updateAvatar();
_5.replace(_4.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));
}});
_b._manager=null;
_e.manager=_b.manager=function(){
if(!_b._manager){
_b._manager=new _e();
}
return _b._manager;
};
return _e;
});


;define("dojo/i18n!ic-core/nls/insertimagedialog", {"newUpload":"New Upload","preview":"Preview:","browse":"Browse...","URL":"URL","imagePickerTitle":"Insert Images from Files","OK":"OK","filesTab":"From Files","required":"Required field","imageLibrary":"Image Library","alt":"Alternate text:","componentImagePickerTitle":" ${0} uploaded images","dialogTitle":"Add Image","previewWarning":"The image seems to have failed to load, are you sure this is a valid image url?","imageFile":"Files:","images":"Images:","cancel":"Cancel","description":"Description:"});
if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["ic-gadget"]=true;

;define("ic-gadget/container/Handle",["dojo/_base/declare","dojo/_base/lang"],function(_1,_2){
var _3=_1("com.ibm.lconn.gadget.container.Handle",null,{load:function(){
},unload:function(){
},refresh:function(){
if(this.getState()===com.ibm.lconn.gadget.container.Handle.LOADED){
this.unload();
this.load();
}
},getWidgetInfo:function(){
},getState:function(){
}});
_2.mixin(com.ibm.lconn.gadget.container.Handle,{LOADING:"LOADING",LOADED:"LOADED",UNLOADED:"UNLOADED",ERROR:"ERROR",__factory__:function(_4,_5,_6){
}});
return _3;
});


;define("ic-gadget/container/Accessor",["dojo/_base/declare","./Handle"],function(_1,_2){
var _3=_1("com.ibm.lconn.gadget.container.Accessor",null,{getCommonContainer:function(){
},getIRuntime:function(){
}});
com.ibm.lconn.gadget.container.Accessor.__instance__=com.ibm.lconn.gadget.container.Accessor.__instance__||function(_4){
};
return _3;
});


;define("ic-gadget/container/Container",["dojo/_base/declare","./Accessor","./Handle"],function(_1,_2,_3){
var _4=_1("com.ibm.lconn.gadget.container.Container",null,{loadWidget:function(_5){
},preloadWidgets:function(_6){
},loadWidgets:function(_7){
},unloadWidgets:function(_8){
},getGadgetInfo:function(_9){
}});
com.ibm.lconn.gadget.container.Container.__instance__=com.ibm.lconn.gadget.container.Container.__instance__||function(_a){
};
com.ibm.lconn.gadget.container.Container.RenderParam={TEST_MODE:"testmode"};
return _4;
});


;define("ic-gadget/container/ICActions",["dojo/_base/declare","dojo/_base/lang"],function(_1,_2){
var _3=_1("com.ibm.lconn.gadget.container.ICActions",null,{registerNavigateGadgetHandler:function(_4){
},registerService:function(_5){
}});
_2.mixin(com.ibm.lconn.gadget.container.ICActions,{__instance__:function(){
}});
return _3;
});


;define("ic-gadget/container/Views",["dojo/_base/declare","dojo/_base/lang"],function(_1,_2){
var _3=_1("com.ibm.lconn.gadget.container.Views",null,{registerCreateElementGadgetHandler:function(_4,_5,_6){
},registerCreateElementForEEHandler:function(_7,_8,_9){
},registerCreateElementForUrlHandler:function(_a,_b,_c){
}});
_2.mixin(com.ibm.lconn.gadget.container.Views,{__instance__:function(){
}});
return _3;
});


;define("ic-core/util/amdLoader",["dojo"],function(_1){
lconn.core.util.amdLoader=(function(_2){
var _3,_4,_5;
var _6="2.0.2",_7=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,_8=/require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,_9=/\.js$/,_a=/^\.\//,_b=Object.prototype.toString,ap=Array.prototype,_c=ap.slice,_d=ap.splice,_e=!!(typeof window!=="undefined"&&navigator&&document),_f=!_e&&typeof importScripts!=="undefined",_10=_e&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,_11="_",_12=typeof opera!=="undefined"&&opera.toString()==="[object Opera]",_13={},cfg={},_14=[],_15=false,req,s,_16,_17,_18,src,_19,_1a,_1b,_1c;
function _1d(it){
return _b.call(it)==="[object Function]";
};
function _1e(it){
return _b.call(it)==="[object Array]";
};
function _1f(ary,_20){
if(ary){
var i;
for(i=0;i<ary.length;i+=1){
if(ary[i]&&_20(ary[i],i,ary)){
break;
}
}
}
};
function _21(ary,_22){
if(ary){
var i;
for(i=ary.length-1;i>-1;i-=1){
if(ary[i]&&_22(ary[i],i,ary)){
break;
}
}
}
};
function _23(obj,_24){
return obj.hasOwnProperty(_24);
};
function _25(obj,_26){
var _27;
for(_27 in obj){
if(obj.hasOwnProperty(_27)){
if(_26(obj[_27],_27)){
break;
}
}
}
};
function _28(_29,_2a,_2b,_2c){
if(_2a){
_25(_2a,function(_2d,_2e){
if(_2b||!_23(_29,_2e)){
if(_2c&&typeof _2d!=="string"){
if(!_29[_2e]){
_29[_2e]={};
}
_28(_29[_2e],_2d,_2b,_2c);
}else{
_29[_2e]=_2d;
}
}
});
}
return _29;
};
function _2f(obj,fn){
return function(){
return fn.apply(obj,arguments);
};
};
function _30(){
return document.getElementsByTagName("script");
};
function _31(_32){
if(!_32){
return _32;
}
var g=_2;
_1f(_32.split("."),function(_33){
g=g[_33];
});
return g;
};
function _34(_35,_36,_37){
return function(){
var _38=_c.call(arguments,0),_39;
if(_37&&_1d((_39=_38[_38.length-1]))){
_39.__requireJsBuild=true;
}
_38.push(_36);
return _35.apply(null,_38);
};
};
function _3a(req,_3b,_3c){
_1f([["toUrl"],["undef"],["defined","requireDefined"],["specified","requireSpecified"]],function(_3d){
var _3e=_3d[1]||_3d[0];
req[_3d[0]]=_3b?_34(_3b[_3e],_3c):function(){
var ctx=_13[_11];
return ctx[_3e].apply(ctx,arguments);
};
});
};
function _3f(id,msg,err,_40){
var e=new Error(msg+"\nhttp://requirejs.org/docs/errors.html#"+id);
e.requireType=id;
e.requireModules=_40;
if(err){
e.originalError=err;
}
return e;
};
if(typeof _4!=="undefined"){
return;
}
if(typeof _5!=="undefined"){
if(_1d(_5)){
return;
}
cfg=_5;
_5=undefined;
}
if(typeof _3!=="undefined"&&!_1d(_3)){
cfg=_3;
_3=undefined;
}
function _41(_42){
var _43={waitSeconds:60,baseUrl:"./",paths:{},pkgs:{},shim:{}},_44={},_45={},_46=[],_47={},_48={},_49=1,_4a=1,_4b=[],_4c,_4d,_4e,_4f,_50;
function _51(ary){
var i,_52;
for(i=0;ary[i];i+=1){
_52=ary[i];
if(_52==="."){
ary.splice(i,1);
i-=1;
}else{
if(_52===".."){
if(i===1&&(ary[2]===".."||ary[0]==="..")){
break;
}else{
if(i>0){
ary.splice(i-1,2);
i-=2;
}
}
}
}
}
};
function _53(_54,_55,_56){
var _57=_55&&_55.split("/"),map=_43.map,_58=map&&map["*"],_59,_5a,_5b,_5c,i,j,_5d,_5e;
if(_54&&_54.charAt(0)==="."){
if(_55){
if(_43.pkgs[_55]){
_57=[_55];
}else{
_57=_57.slice(0,_57.length-1);
}
_54=_57.concat(_54.split("/"));
_51(_54);
_5a=_43.pkgs[(_59=_54[0])];
_54=_54.join("/");
if(_5a&&_54===_59+"/"+_5a.main){
_54=_59;
}
}else{
if(_54.indexOf("./")===0){
_54=_54.substring(2);
}
}
}
if(_56&&(_57||_58)&&map){
_5c=_54.split("/");
for(i=_5c.length;i>0;i-=1){
_5d=_5c.slice(0,i).join("/");
if(_57){
for(j=_57.length;j>0;j-=1){
_5b=map[_57.slice(0,j).join("/")];
if(_5b){
_5b=_5b[_5d];
if(_5b){
_5e=_5b;
break;
}
}
}
}
if(!_5e&&_58&&_58[_5d]){
_5e=_58[_5d];
}
if(_5e){
_5c.splice(0,i,_5e);
_54=_5c.join("/");
break;
}
}
}
return _54;
};
function _5f(_60){
if(_e){
_1f(_30(),function(_61){
if(_61.getAttribute("data-requiremodule")===_60&&_61.getAttribute("data-requirecontext")===_4e.contextName){
_61.parentNode.removeChild(_61);
return true;
}
});
}
};
function _62(id){
var _63=_43.paths[id];
if(_63&&_1e(_63)&&_63.length>1){
_5f(id);
_63.shift();
_4e.undef(id);
_4e.require([id]);
return true;
}
};
function _64(_65,_66,_67,_68){
var _69=_65?_65.indexOf("!"):-1,_6a=null,_6b=_66?_66.name:null,_6c=_65,_6d=true,_6e="",url,_6f,_70;
if(!_65){
_6d=false;
_65="_@r"+(_49+=1);
}
if(_69!==-1){
_6a=_65.substring(0,_69);
_65=_65.substring(_69+1,_65.length);
}
if(_6a){
_6a=_53(_6a,_6b,_68);
_6f=_47[_6a];
}
if(_65){
if(_6a){
if(_6f&&_6f.normalize){
_6e=_6f.normalize(_65,function(_71){
return _53(_71,_6b,_68);
});
}else{
_6e=_53(_65,_6b,_68);
}
}else{
_6e=_53(_65,_6b,_68);
url=_4e.nameToUrl(_65,null,_66);
}
}
_70=_6a&&!_6f&&!_67?"_unnormalized"+(_4a+=1):"";
return {prefix:_6a,name:_6e,parentMap:_66,unnormalized:!!_70,url:url,originalName:_6c,isDefine:_6d,id:(_6a?_6a+"!"+_6e:_6e)+_70};
};
function _72(_73){
var id=_73.id,mod=_44[id];
if(!mod){
mod=_44[id]=new _4e.Module(_73);
}
return mod;
};
function on(_74,_75,fn){
var id=_74.id,mod=_44[id];
if(_23(_47,id)&&(!mod||mod.defineEmitComplete)){
if(_75==="defined"){
fn(_47[id]);
}
}else{
_72(_74).on(_75,fn);
}
};
function _76(err,_77){
var ids=err.requireModules,_78=false;
if(_77){
_77(err);
}else{
_1f(ids,function(id){
var mod=_44[id];
if(mod){
mod.error=err;
if(mod.events.error){
_78=true;
mod.emit("error",err);
}
}
});
if(!_78){
req.onError(err);
}
}
};
function _79(){
if(_14.length){
_d.apply(_46,[_46.length-1,0].concat(_14));
_14=[];
}
};
function _7a(mod,_7b,_7c){
var _7d=mod&&mod.map,_7e=_34(_7c||_4e.require,_7d,_7b);
_3a(_7e,_4e,_7d);
_7e.isBrowser=_e;
return _7e;
};
_4f={"require":function(mod){
return _7a(mod);
},"exports":function(mod){
mod.usingExports=true;
if(mod.map.isDefine){
return (mod.exports=_47[mod.map.id]={});
}
},"module":function(mod){
return (mod.module={id:mod.map.id,uri:mod.map.url,config:function(){
return (_43.config&&_43.config[mod.map.id])||{};
},exports:_47[mod.map.id]});
}};
function _7f(id){
delete _44[id];
_1f(_4b,function(mod,i){
if(mod.map.id===id){
_4b.splice(i,1);
if(!mod.defined){
_4e.waitCount-=1;
}
return true;
}
});
};
function _80(mod,_81){
var id=mod.map.id,_82=mod.depMaps,_83;
if(!mod.inited){
return;
}
if(_81[id]){
return mod;
}
_81[id]=true;
_1f(_82,function(_84){
var _85=_84.id,_86=_44[_85];
if(!_86){
return;
}
if(!_86.inited||!_86.enabled){
_83=null;
delete _81[id];
return true;
}
return (_83=_80(_86,_28({},_81)));
});
return _83;
};
function _87(mod,_88,_89){
var id=mod.map.id,_8a=mod.depMaps;
if(!mod.inited||!mod.map.isDefine){
return;
}
if(_88[id]){
return _47[id];
}
_88[id]=mod;
_1f(_8a,function(_8b){
var _8c=_8b.id,_8d=_44[_8c],_8e;
if(_4f[_8c]){
return;
}
if(_8d){
if(!_8d.inited||!_8d.enabled){
_89[id]=true;
return;
}
_8e=_87(_8d,_88,_89);
if(!_89[_8c]){
mod.defineDepById(_8c,_8e);
}
}
});
mod.check(true);
return _47[id];
};
function _8f(mod){
mod.check();
};
function _90(){
var _91=_43.waitSeconds*1000,_92=_91&&(_4e.startTime+_91)<new Date().getTime(),_93=[],_94=false,_95=true,map,_96,err,_97;
if(_4c){
return;
}
_4c=true;
_25(_44,function(mod){
map=mod.map;
_96=map.id;
if(!mod.enabled){
return;
}
if(!mod.error){
if(!mod.inited&&_92){
if(_62(_96)){
_97=true;
_94=true;
}else{
_93.push(_96);
_5f(_96);
}
}else{
if(!mod.inited&&mod.fetched&&map.isDefine){
_94=true;
if(!map.prefix){
return (_95=false);
}
}
}
}
});
if(_92&&_93.length){
err=_3f("timeout","Load timeout for modules: "+_93,null,_93);
err.contextName=_4e.contextName;
return _76(err);
}
if(_95){
_1f(_4b,function(mod){
if(mod.defined){
return;
}
var _98=_80(mod,{}),_99={};
if(_98){
_87(_98,_99,{});
_25(_99,_8f);
}
});
_25(_44,_8f);
}
if((!_92||_97)&&_94){
if((_e||_f)&&!_50){
_50=setTimeout(function(){
_50=0;
_90();
},50);
}
}
_4c=false;
};
_4d=function(map){
this.events=_45[map.id]||{};
this.map=map;
this.shim=_43.shim[map.id];
this.depExports=[];
this.depMaps=[];
this.depMatched=[];
this.pluginMaps={};
this.depCount=0;
};
_4d.prototype={init:function(_9a,_9b,_9c,_9d){
_9d=_9d||{};
if(this.inited){
return;
}
this.factory=_9b;
if(_9c){
this.on("error",_9c);
}else{
if(this.events.error){
_9c=_2f(this,function(err){
this.emit("error",err);
});
}
}
this.depMaps=_9a&&_9a.slice(0);
this.depMaps.rjsSkipMap=_9a.rjsSkipMap;
this.errback=_9c;
this.inited=true;
this.ignore=_9d.ignore;
if(_9d.enabled||this.enabled){
this.enable();
}else{
this.check();
}
},defineDepById:function(id,_9e){
var i;
_1f(this.depMaps,function(map,_9f){
if(map.id===id){
i=_9f;
return true;
}
});
return this.defineDep(i,_9e);
},defineDep:function(i,_a0){
if(!this.depMatched[i]){
this.depMatched[i]=true;
this.depCount-=1;
this.depExports[i]=_a0;
}
},fetch:function(){
if(this.fetched){
return;
}
this.fetched=true;
_4e.startTime=(new Date()).getTime();
var map=this.map;
if(this.shim){
_7a(this,true)(this.shim.deps||[],_2f(this,function(){
return map.prefix?this.callPlugin():this.load();
}));
}else{
return map.prefix?this.callPlugin():this.load();
}
},load:function(){
var url=this.map.url;
if(!_48[url]){
_48[url]=true;
_4e.load(this.map.id,url);
}
},check:function(_a1){
if(!this.enabled||this.enabling){
return;
}
var id=this.map.id,_a2=this.depExports,_a3=this.exports,_a4=this.factory,err,_a5;
if(!this.inited){
this.fetch();
}else{
if(this.error){
this.emit("error",this.error);
}else{
if(!this.defining){
this.defining=true;
if(this.depCount<1&&!this.defined){
if(_1d(_a4)){
if(this.events.error){
try{
_a3=_4e.execCb(id,_a4,_a2,_a3);
}
catch(e){
err=e;
}
}else{
_a3=_4e.execCb(id,_a4,_a2,_a3);
}
if(this.map.isDefine){
_a5=this.module;
if(_a5&&_a5.exports!==undefined&&_a5.exports!==this.exports){
_a3=_a5.exports;
}else{
if(_a3===undefined&&this.usingExports){
_a3=this.exports;
}
}
}
if(err){
err.requireMap=this.map;
err.requireModules=[this.map.id];
err.requireType="define";
return _76((this.error=err));
}
}else{
_a3=_a4;
}
this.exports=_a3;
if(this.map.isDefine&&!this.ignore){
_47[id]=_a3;
if(req.onResourceLoad){
req.onResourceLoad(_4e,this.map,this.depMaps);
}
}
delete _44[id];
this.defined=true;
_4e.waitCount-=1;
if(_4e.waitCount===0){
_4b=[];
}
}
this.defining=false;
if(!_a1){
if(this.defined&&!this.defineEmitted){
this.defineEmitted=true;
this.emit("defined",this.exports);
this.defineEmitComplete=true;
}
}
}
}
}
},callPlugin:function(){
var map=this.map,id=map.id,_a6=_64(map.prefix,null,false,true);
on(_a6,"defined",_2f(this,function(_a7){
var _a8=this.map.name,_a9=this.map.parentMap?this.map.parentMap.name:null,_aa,_ab,_ac;
if(this.map.unnormalized){
if(_a7.normalize){
_a8=_a7.normalize(_a8,function(_ad){
return _53(_ad,_a9,true);
})||"";
}
_ab=_64(map.prefix+"!"+_a8,this.map.parentMap,false,true);
on(_ab,"defined",_2f(this,function(_ae){
this.init([],function(){
return _ae;
},null,{enabled:true,ignore:true});
}));
_ac=_44[_ab.id];
if(_ac){
if(this.events.error){
_ac.on("error",_2f(this,function(err){
this.emit("error",err);
}));
}
_ac.enable();
}
return;
}
_aa=_2f(this,function(_af){
this.init([],function(){
return _af;
},null,{enabled:true});
});
_aa.error=_2f(this,function(err){
this.inited=true;
this.error=err;
err.requireModules=[id];
_25(_44,function(mod){
if(mod.map.id.indexOf(id+"_unnormalized")===0){
_7f(mod.map.id);
}
});
_76(err);
});
_aa.fromText=function(_b0,_b1){
var _b2=_15;
if(_b2){
_15=false;
}
_72(_64(_b0));
req.exec(_b1);
if(_b2){
_15=true;
}
_4e.completeLoad(_b0);
};
_a7.load(map.name,_7a(map.parentMap,true,function(_b3,cb){
_b3.rjsSkipMap=true;
return _4e.require(_b3,cb);
}),_aa,_43);
}));
_4e.enable(_a6,this);
this.pluginMaps[_a6.id]=_a6;
},enable:function(){
this.enabled=true;
if(!this.waitPushed){
_4b.push(this);
_4e.waitCount+=1;
this.waitPushed=true;
}
this.enabling=true;
_1f(this.depMaps,_2f(this,function(_b4,i){
var id,mod,_b5;
if(typeof _b4==="string"){
_b4=_64(_b4,(this.map.isDefine?this.map:this.map.parentMap),false,!this.depMaps.rjsSkipMap);
this.depMaps[i]=_b4;
_b5=_4f[_b4.id];
if(_b5){
this.depExports[i]=_b5(this);
return;
}
this.depCount+=1;
on(_b4,"defined",_2f(this,function(_b6){
this.defineDep(i,_b6);
this.check();
}));
if(this.errback){
on(_b4,"error",this.errback);
}
}
id=_b4.id;
mod=_44[id];
if(!_4f[id]&&mod&&!mod.enabled){
_4e.enable(_b4,this);
}
}));
_25(this.pluginMaps,_2f(this,function(_b7){
var mod=_44[_b7.id];
if(mod&&!mod.enabled){
_4e.enable(_b7,this);
}
}));
this.enabling=false;
this.check();
},on:function(_b8,cb){
var cbs=this.events[_b8];
if(!cbs){
cbs=this.events[_b8]=[];
}
cbs.push(cb);
},emit:function(_b9,evt){
_1f(this.events[_b9],function(cb){
cb(evt);
});
if(_b9==="error"){
delete this.events[_b9];
}
}};
function _ba(_bb){
_72(_64(_bb[0],null,true)).init(_bb[1],_bb[2]);
};
function _bc(_bd,_be,_bf,_c0){
if(_bd.detachEvent&&!_12){
if(_c0){
_bd.detachEvent(_c0,_be);
}
}else{
_bd.removeEventListener(_bf,_be,false);
}
};
function _c1(evt){
var _c2=evt.currentTarget||evt.srcElement;
_bc(_c2,_4e.onScriptLoad,"load","onreadystatechange");
_bc(_c2,_4e.onScriptError,"error");
return {node:_c2,id:_c2&&_c2.getAttribute("data-requiremodule")};
};
return (_4e={config:_43,contextName:_42,registry:_44,defined:_47,urlFetched:_48,waitCount:0,defQueue:_46,Module:_4d,makeModuleMap:_64,configure:function(cfg){
if(cfg.baseUrl){
if(cfg.baseUrl.charAt(cfg.baseUrl.length-1)!=="/"){
cfg.baseUrl+="/";
}
}
var _c3=_43.pkgs,_c4=_43.shim,_c5=_43.paths,map=_43.map;
_28(_43,cfg,true);
_43.paths=_28(_c5,cfg.paths,true);
if(cfg.map){
_43.map=_28(map||{},cfg.map,true,true);
}
if(cfg.shim){
_25(cfg.shim,function(_c6,id){
if(_1e(_c6)){
_c6={deps:_c6};
}
if(_c6.exports&&!_c6.exports.__buildReady){
_c6.exports=_4e.makeShimExports(_c6.exports);
}
_c4[id]=_c6;
});
_43.shim=_c4;
}
if(cfg.packages){
_1f(cfg.packages,function(_c7){
var _c8;
_c7=typeof _c7==="string"?{name:_c7}:_c7;
_c8=_c7.location;
_c3[_c7.name]={name:_c7.name,location:_c8||_c7.name,main:(_c7.main||"main").replace(_a,"").replace(_9,"")};
});
_43.pkgs=_c3;
}
_25(_44,function(mod,id){
mod.map=_64(id);
});
if(cfg.deps||cfg.callback){
_4e.require(cfg.deps||[],cfg.callback);
}
},makeShimExports:function(_c9){
var _ca;
if(typeof _c9==="string"){
_ca=function(){
return _31(_c9);
};
_ca.exports=_c9;
return _ca;
}else{
return function(){
return _c9.apply(_2,arguments);
};
}
},requireDefined:function(id,_cb){
return _23(_47,_64(id,_cb,false,true).id);
},requireSpecified:function(id,_cc){
id=_64(id,_cc,false,true).id;
return _23(_47,id)||_23(_44,id);
},require:function(_cd,_ce,_cf,_d0){
var _d1,id,map,_d2,_d3;
if(typeof _cd==="string"){
if(_1d(_ce)){
return _76(_3f("requireargs","Invalid require call"),_cf);
}
if(req.get){
return req.get(_4e,_cd,_ce);
}
_d1=_cd;
_d0=_ce;
map=_64(_d1,_d0,false,true);
id=map.id;
if(!_23(_47,id)){
return _76(_3f("notloaded","Module name \""+id+"\" has not been loaded yet for context: "+_42));
}
return _47[id];
}
if(_cf&&!_1d(_cf)){
_d0=_cf;
_cf=undefined;
}
if(_ce&&!_1d(_ce)){
_d0=_ce;
_ce=undefined;
}
_79();
while(_46.length){
_d3=_46.shift();
if(_d3[0]===null){
return _76(_3f("mismatch","Mismatched anonymous define() module: "+_d3[_d3.length-1]));
}else{
_ba(_d3);
}
}
_d2=_72(_64(null,_d0));
_d2.init(_cd,_ce,_cf,{enabled:true});
_90();
return _4e.require;
},undef:function(id){
var map=_64(id,null,true),mod=_44[id];
delete _47[id];
delete _48[map.url];
delete _45[id];
if(mod){
if(mod.events.defined){
_45[id]=mod.events;
}
_7f(id);
}
},enable:function(_d4,_d5){
var mod=_44[_d4.id];
if(mod){
_72(_d4).enable();
}
},completeLoad:function(_d6){
var _d7=_43.shim[_d6]||{},_d8=_d7.exports&&_d7.exports.exports,_d9,_da,mod;
_79();
while(_46.length){
_da=_46.shift();
if(_da[0]===null){
_da[0]=_d6;
if(_d9){
break;
}
_d9=true;
}else{
if(_da[0]===_d6){
_d9=true;
}
}
_ba(_da);
}
mod=_44[_d6];
if(!_d9&&!_47[_d6]&&mod&&!mod.inited){
if(_43.enforceDefine&&(!_d8||!_31(_d8))){
if(_62(_d6)){
return;
}else{
return _76(_3f("nodefine","No define call for "+_d6,null,[_d6]));
}
}else{
_ba([_d6,(_d7.deps||[]),_d7.exports]);
}
}
_90();
},toUrl:function(_db,_dc){
var _dd=_db.lastIndexOf("."),ext=null;
if(_dd!==-1){
ext=_db.substring(_dd,_db.length);
_db=_db.substring(0,_dd);
}
return _4e.nameToUrl(_db,ext,_dc);
},nameToUrl:function(_de,ext,_df){
var _e0,_e1,pkg,_e2,_e3,i,_e4,url,_e5;
_de=_53(_de,_df&&_df.id,true);
if(req.jsExtRegExp.test(_de)){
url=_de+(ext||"");
}else{
_e0=_43.paths;
_e1=_43.pkgs;
_e3=_de.split("/");
for(i=_e3.length;i>0;i-=1){
_e4=_e3.slice(0,i).join("/");
pkg=_e1[_e4];
_e5=_e0[_e4];
if(_e5){
if(_1e(_e5)){
_e5=_e5[0];
}
_e3.splice(0,i,_e5);
break;
}else{
if(pkg){
if(_de===pkg.name){
_e2=pkg.location+"/"+pkg.main;
}else{
_e2=pkg.location;
}
_e3.splice(0,i,_e2);
break;
}
}
}
url=_e3.join("/")+(ext||".js");
url=(url.charAt(0)==="/"||url.match(/^[\w\+\.\-]+:/)?"":_43.baseUrl)+url;
}
return _43.urlArgs?url+((url.indexOf("?")===-1?"?":"&")+_43.urlArgs):url;
},load:function(id,url){
req.load(_4e,id,url);
},execCb:function(_e6,_e7,_e8,_e9){
return _e7.apply(_e9,_e8);
},onScriptLoad:function(evt){
if(evt.type==="load"||(_10.test((evt.currentTarget||evt.srcElement).readyState))){
_19=null;
var _ea=_c1(evt);
_4e.completeLoad(_ea.id);
}
},onScriptError:function(evt){
var _eb=_c1(evt);
if(!_62(_eb.id)){
return _76(_3f("scripterror","Script error",evt,[_eb.id]));
}
}});
};
req=_5=function(_ec,_ed,_ee,_ef){
var _f0=_11,_f1,_f2;
if(!_1e(_ec)&&typeof _ec!=="string"){
_f2=_ec;
if(_1e(_ed)){
_ec=_ed;
_ed=_ee;
_ee=_ef;
}else{
_ec=[];
}
}
if(_f2&&_f2.context){
_f0=_f2.context;
}
_f1=_13[_f0];
if(!_f1){
_f1=_13[_f0]=req.s.newContext(_f0);
}
if(_f2){
_f1.configure(_f2);
}
return _f1.require(_ec,_ed,_ee);
};
req.config=function(_f3){
return req(_f3);
};
if(!_3){
_3=req;
}
req.version=_6;
req.jsExtRegExp=/^\/|:|\?|\.js$/;
req.isBrowser=_e;
s=req.s={contexts:_13,newContext:_41};
req({});
_3a(req);
if(_e){
_16=s.head=document.getElementsByTagName("head")[0];
_17=document.getElementsByTagName("base")[0];
if(_17){
_16=s.head=_17.parentNode;
}
}
req.onError=function(err){
throw err;
};
req.load=function(_f4,_f5,url){
var _f6=(_f4&&_f4.config)||{},_f7;
if(_e){
_f7=_f6.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");
_f7.type=_f6.scriptType||"text/javascript";
_f7.charset="utf-8";
_f7.setAttribute("data-requirecontext",_f4.contextName);
_f7.setAttribute("data-requiremodule",_f5);
if(_f7.attachEvent&&!(_f7.attachEvent.toString&&_f7.attachEvent.toString().indexOf("[native code")<0)&&!_12){
_15=true;
_f7.attachEvent("onreadystatechange",_f4.onScriptLoad);
}else{
_f7.addEventListener("load",_f4.onScriptLoad,false);
_f7.addEventListener("error",_f4.onScriptError,false);
}
_f7.src=url;
_1a=_f7;
if(_17){
_16.insertBefore(_f7,_17);
}else{
_16.appendChild(_f7);
}
_1a=null;
return _f7;
}else{
if(_f){
importScripts(url);
_f4.completeLoad(_f5);
}
}
};
function _f8(){
if(_19&&_19.readyState==="interactive"){
return _19;
}
_21(_30(),function(_f9){
if(_f9.readyState==="interactive"){
return (_19=_f9);
}
});
return _19;
};
if(_e){
_21(_30(),function(_fa){
if(!_16){
_16=_fa.parentNode;
}
_18=_fa.getAttribute("data-main");
if(_18){
src=_18.split("/");
_1b=src.pop();
_1c=src.length?src.join("/")+"/":"./";
if(!cfg.baseUrl){
cfg.baseUrl=_1c;
}
_18=_1b.replace(_9,"");
cfg.deps=cfg.deps?cfg.deps.concat(_18):[_18];
return true;
}
});
}
_4=function(_fb,_fc,_fd){
var _fe,_ff;
if(typeof _fb!=="string"){
_fd=_fc;
_fc=_fb;
_fb=null;
}
if(!_1e(_fc)){
_fd=_fc;
_fc=[];
}
if(!_fc.length&&_1d(_fd)){
if(_fd.length){
_fd.toString().replace(_7,"").replace(_8,function(_100,dep){
_fc.push(dep);
});
_fc=(_fd.length===1?["require"]:["require","exports","module"]).concat(_fc);
}
}
if(_15){
_fe=_1a||_f8();
if(_fe){
if(!_fb){
_fb=_fe.getAttribute("data-requiremodule");
}
_ff=_13[_fe.getAttribute("data-requirecontext")];
}
}
(_ff?_ff.defQueue:_14).push([_fb,_fc,_fd]);
};
_4.amd={jQuery:true};
req.exec=function(text){
return eval(text);
};
req(cfg);
return {require:_3,requirejs:_5,define:_4};
})(_1.global);
return lconn.core.util.amdLoader;
});


;define("ic-core/util/LCDeferred",["dojo","dojo/_base/lang"],function(_1,_2){
var _3=function(){
};
var _4=Object.freeze||function(){
};
var _5=function(_6){
var _7,_8,_9,_a,_b;
var _c=(this.promise={});
function _d(_e){
if(_8){
throw new Error("This deferred has already been resolved");
}
_7=_e;
_8=true;
_f();
};
function _f(){
var _10;
while(!_10&&_b){
var _11=_b;
_b=_b.next;
if((_10=(_11.progress==_3))){
_8=false;
}
var _12=(_9?_11.error:_11.resolved);
if(_12){
try{
var _13=_12(_7);
if(_13&&typeof _13.then==="function"){
_13.then(_2.hitch(_11.deferred,"resolve"),_2.hitch(_11.deferred,"reject"));
continue;
}
var _14=_10&&_13===undefined;
if(_10&&!_14){
_9=_13 instanceof Error;
}
_11.deferred[_14&&_9?"reject":"resolve"](_14?_7:_13);
}
catch(e){
_11.deferred.reject(e);
}
}else{
if(_9){
_11.deferred.reject(_7);
}else{
_11.deferred.resolve(_7);
}
}
}
};
this.resolve=this.callback=function(_15){
this.fired=0;
this.results=[_15,null];
_d(_15);
};
this.reject=this.errback=function(_16){
_9=true;
this.fired=1;
_d(_16);
this.results=[null,_16];
if(!_16||_16.log!==false){
(_1.config.deferredOnError||function(x){
console.error(x);
})(_16);
}
};
this.progress=function(_17){
var _18=_b;
while(_18){
var _19=_18.progress;
_19&&_19(_17);
_18=_18.next;
}
};
this.addCallbacks=function(_1a,_1b){
this.then(_1a,_1b,_3);
return this;
};
this.then=_c.then=function(_1c,_1d,_1e){
var _1f=_1e==_3?this:new _5(_c.cancel);
var _20={resolved:_1c,error:_1d,progress:_1e,deferred:_1f};
if(_b){
_a=_a.next=_20;
}else{
_b=_a=_20;
}
if(_8){
_f();
}
return _1f.promise;
};
var _21=this;
this.cancel=_c.cancel=function(){
if(!_8){
var _22=_6&&_6(_21);
if(!_8){
if(!(_22 instanceof Error)){
_22=new Error(_22);
}
_22.log=false;
_21.reject(_22);
}
}
};
_4(_c);
};
_2.extend(_5,{addCallback:function(_23){
return this.addCallbacks(_2.hitch.apply(_1,arguments));
},addErrback:function(_24){
return this.addCallbacks(null,_2.hitch.apply(_1,arguments));
},addBoth:function(_25){
var _26=_2.hitch.apply(_1,arguments);
return this.addCallbacks(_26,_26);
},fired:-1});
return _5;
});


;define("ic-core/util/LCDeferredList",["dojo/Deferred","dojo/_base/array","ic-core/util/LCDeferred"],function(_1,_2,_3){
var _4=function(_5,_6,_7,_8,_9){
var _a=[];
_1.call(this);
var _b=this;
if(_5.length===0&&!_6){
this.resolve([0,[]]);
}
var _c=0;
_2.forEach(_5,function(_d,i){
_d.then(function(_e){
if(_6){
_b.resolve([i,_e]);
}else{
_f(true,_e);
}
},function(_10){
if(_7){
_b.reject(_10);
}else{
_f(false,_10);
}
if(_8){
return null;
}
throw _10;
});
function _f(_11,_12){
_a[i]=[_11,_12];
_c++;
if(_c===_5.length){
_b.resolve(_a);
}
};
});
};
_4.prototype=new _1();
_4.prototype.gatherResults=function(_13){
var d=new _4(_13,false,true,false);
d.addCallback(function(_14){
var ret=[];
_2.forEach(_14,function(_15){
ret.push(_15[1]);
});
return ret;
});
return d;
};
return _4;
});


;define("ic-gadget/config/settings",[],function(){
return {"developer":{"allowIntranetProxyAccess":false,"allowSSOFeature":false,"enabled":false},"security":{"allowUrlCheckPattern":"","authErrorRetryIntervalSec":300,"containerTokenCheckSec":7200,"containerTokenTTLSec":43200,"featureAdminEnabled":true,"gadgetTokenTTLSec":64800,"preloadJS":false,"preloadJSSafari":true,"ssoDomain":"apps.na.collabserv.com","transientErrorRetryIntervalSec":60,"urlWhitelistEnabled":true,"whiteListEnabled":true}};
});


;define("ic-gadget/util/trace",["dojo","dojo/_base/array","dojo/_base/lang","dojo/json"],function(_1,_2,_3,_4){
var _5=_3.getObject("com.ibm.lconn.gadget.util.trace",true),_6=_1.global,_7=null,_8=null;
if(!_6.console){
_8={log:function(){
}};
}else{
_8=console;
}
if(_3.isFunction(_8.log)&&_8.log.apply){
_7=function(_9){
return _3.hitch(_8,_8[_9]);
};
}else{
_7=function(_a){
return function(){
_8[_a](Array.prototype.slice.call(arguments));
};
};
}
_2.forEach(["log","debug","warn","error"],function(_b){
if(_6.console&&(_b!=="debug"||_1.config.isDebug===true)){
_5[_b]=(_8[_b])?_7(_b):_7("log");
}else{
_5[_b]=function(){
};
}
});
_5.entering=function(_c,_d,_e){
if(!_e){
_5.debug("ENTER: "+_c+"."+_d);
}else{
_5.debug("ENTER: "+_c+"."+_d);
}
};
_5.exiting=function(_f,_10,_11){
if(!_11){
_5.debug("EXITING: "+_f+"."+_10);
}else{
_5.debug("EXITING: "+_f+"."+_10);
}
};
_5.throwing=function(cls,_12,_13){
if(!_13){
_5.debug("THOWING: "+cls+"."+_12);
}else{
_5.debug("THOWING: "+cls+"."+_12+" -- ERROR: "+_4.stringify(_13));
}
};
return _5;
});


;define("ic-gadget/services/sso_reauth_callback",["dojo/_base/lang","ic-core/auth","../util/trace"],function(_1,_2,_3){
var _4=_1.getObject("com.ibm.lconn.gadget.services.sso_reauth_callback",true);
_4.registerService=function(_5){
_5.rpcRegister("_cre_sso_reauth_cb",function(_6){
_3.log("_cre_sso_reauth_cb rpc service fired with arguments",arguments);
_3.log("redirecting to login...");
_2.logoutAndlogin();
});
};
return _4;
});


;define("ic-gadget/container/Topics",["dojo/_base/lang"],function(_1){
var _2=_1.getObject("com.ibm.lconn.gadget.container.Topics",true);
var _3="com/ibm/lconn/gadget/";
_2.GadgetWindow={};
_2.GadgetWindow.SITE_TOPIC_SET_TITLE="setTitle";
_2.GadgetWindow.AFTER_ADJUST_WIDTH="afterAdjustWidth";
_2.GadgetWindow.AFTER_ADJUST_HEIGHT="afterAdjustHeight";
_2.GadgetWindow.SET_PREFS="setPrefs";
_2.getSiteTopic=function(_4,_5){
return _3+"site/"+_4+"/"+_5;
};
_2.getLifecycleEventTopic=function(_6){
return _3+_6;
};
_2.getMasterLifecycleTopic=function(){
return _3+"lifecycle";
};
return _2;
});


;define("dojo/i18n!ic-gadget/nls/iframeDialogStrings", {"dialogTitle":"OAuth Authorization"});

;define("ic-gadget/services/dialog/IframeDialog",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dojo/i18n","dojo/i18n!../../nls/iframeDialogStrings","dojo/on","dijit/Dialog"],function(_1,_2,_3,_4,_5,_6,on,_7){
var _8=_2("com.ibm.lconn.gadget.services.dialog.IframeDialog",null,{nls:_6,_w:500,_h:500,_url:"",_ifElement:null,_dialog:null,_wRegex:/width=(\d+)/,_hRegex:/height=(\d+)/,isAuto:null,constructor:function(_9,_a,_b){
this._url=_9;
this.isAuto=_b;
if(_a){
var _c,_d;
if(_c=_a.match(this._wRegex)){
this._w=_c[1];
}
if(_d=_a.match(this._hRegex)){
this._h=_d[1];
}
}
},init:function(_e,_f){
if(!this._dialog){
var _10=this._dialog=new _7({title:this.nls.dialogTitle,"class":"lcSharebox"});
var _11=document.createElement("div");
var _12="<iframe";
if(_e){
_12+=" id='"+_e+"'";
_12+=" name='"+_e+"'";
}
_12+="></iframe>";
_11.innerHTML=_12;
var _13=this._ifElement=_11.firstChild;
if(_f){
_4.set(_10.containerNode,"id",_f);
}
_4.set(_13,"src",this._url);
if(this._w){
_13.style.width=this._w+"px";
}
if(this._h){
_13.style.height=this._h+"px";
}
_10.set("content",_13);
on(_10,"Hide",_3.hitch(this,"onClose"));
}
},show:function(){
this._dialog.show();
},getWindow:function(){
return this._ifElement.contentWindow;
},hide:function(){
this._dialog.hide();
},destroy:function(){
this._dialog.destroyRecursive(false);
},onClose:function(){
}});
return _8;
});


;define("dojo/text!ic-gadget/services/dialog/templates/OAuthErrorDialog.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div id="${id}_dialog" role="dialog" aria-labelledby="${id}_title" class="lotusDialog">\n	<div class="lotusDialogBorder">\n		<div class="lotusDialog">\n			<div class="lotusDialogHeader">\n				<a class="lotusDialogClose" href="javascript:;" title="${nls.MESSAGE.DISMISS}" data-dojo-attach-event="onclick:closeDialog">\n					<img alt="${nls.MESSAGE.DISMISS}" src="${blankGif}">\n					<span class="lotusAltText">${nls.MESSAGE.DISMISS}</span>\n				</a>\n			</div>\n			<div class="lotusDialogContent" id="${id}_dialog_content">\n				<div class="lotusMessage2" role="alert">\n					<img class="lotusIcon lotusIconMsgError" src="${blankGif}" alt="${nls.MESSAGE.ERROR_ALT_TEXT}">\n					<span class="lotusAltText">${nls.MESSAGE.ERROR_ALT_TEXT}</span>\n					<div class="lotusMessageBody">${errorMessage}</div>\n				</div>\n			</div>\n		</div><!--end lotusDialog-->\n	</div><!--end lotusDialogBorder-->\n</div>\n');

;define("ic-gadget/services/dialog/OAuthErrorDialog",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/i18n","dojo/text!./templates/OAuthErrorDialog.html","dijit/Dialog","dijit/_Templated","dijit/_Widget"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9=_2("com.ibm.lconn.gadget.services.dialog.OAuthErrorDialog",[_8,_7],{widgetsInTemplate:true,nls:{network:{error_again:""}},templateString:_5,blankGif:null,errorMessage:null,dialog:null,constructor:function(){
var _a=this.nls.network;
this.blankGif=_1.config.blankGif;
this.errorMessage=_3.replace(_a.error,{again:_a.error_again},/\$\{([^\}]+)\}/g);
this.dialog=new _6();
},show:function(){
this.dialog.show();
this.dialog.get({content:this.domNode});
},closeDialog:function(){
this.dialog.destroy();
this.dialog=null;
this.destroy();
}});
return _9;
});


;define("ic-core/proxy",["dojo/_base/config","ic-core/config/services","ic-core/url"],function(_1,_2,_3){
var _4=function(_5){
return _5=="https"?443:80;
};
var _6=_1.proxy;
var _7;
if(_2.deploymentConfig){
_7=_3.getServiceUrl(_2.deploymentConfig).path+"/proxy/commonProxy";
}
var _8=window.location;
var _9=_8.hostname||"localhost";
var _a=(_8.protocol||"http").replace(":","");
var _b=_8.port||_4(_a);
return function(_c,_d){
var _e=_d?_7:_6;
if(!_e){
return _c;
}
var _f=new dojo._Url(_c);
var _10=_f.host;
if(_10){
var _11=_f.scheme||_a;
var _12=_f.port||_4(_11);
if(_11!=_a||_12!=_b||_10!=_9){
return _e+"/"+_11+"/"+encodeURIComponent(_10+":"+_12)+(_f.path||"")+(_f.query?("?"+_f.query):"");
}
}
return _c;
};
});


;define("ic-ui/util/proxy",["dojo/_base/kernel","ic-core/proxy"],function(_1,_2){
_1.deprecated("ic-ui/util/proxy","Use ic-core/proxy instead","5.0");
return _2;
});


;define("ic-gadget/services/TokenRefreshHandler",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/cookie","dojo/request","ic-core/util/LCDeferred","../config/settings","ic-core/auth","ic-core/url","ic-core/config/services","../util/trace","ic-ui/util/proxy"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
com.ibm.lconn.gadget.services.TokenRefreshHandler=(function(_d,_e,_f,_10,_11,_12,_13,_14,_15){
var _16={};
var _17=_14.security;
var _18="X-LConn-Auth",_19="X-IC-CRE-User",_1a="X-IC-CRE-Request-Origin",_1b="X-Update-Nonce",_1c="X-IC-Container-Token";
var _1d=_10.opensocial,_1e=_f.parse(_3.getObject("location",_d.global).toString(),_1d?_12(_f.getServiceUrl(_1d).toString()):"");
var _1f=_d.global.location;
_13.debug("Container token refresh TTL is: "+_17.containerTokenTTLSec);
_13.debug("Container token check: "+_17.containerTokenCheckSec);
function _20(_21,_22){
return _21&&_21.userId===_22.userId;
};
function _23(_24){
_13.debug("Invalidating current token data");
var _25=_24.sites_;
for(var _26 in _25){
var _27=_25[_26];
if(_27 instanceof osapi.container.GadgetSite){
var _28=_27.getActiveSiteHolder();
var _29=_24.service_.getCachedGadgetMetadata(_28.getUrl());
_29[osapi.container.MetadataResponse.NEEDS_TOKEN_REFRESH]=true;
}
}
};
function _2a(_2b){
var c=document.cookie,_2c="(?:^|; )"+_d.regexp.escapeString(_2b)+"=([^;]*)",_2d,_2e=new RegExp(_2c),res,_2f=[],i;
_2d=c.match(new RegExp(_2c,"g"));
if(_2d&&_2d.length>0){
i=_2d.length;
while(i--){
res=_2d[i];
_2f.push(decodeURIComponent(res.match(_2e)[1]));
}
}
return _2f;
};
function _30(_31,_32){
var _33,_34,_35;
var _36=false,_37=null,_38;
var _39=_1f.hostname;
var i,c;
if(_32){
i=_32.length;
while(i--){
_33=_32[i];
if((c=_33.indexOf("$"))>0&&c<_33.length-1){
_35=_33.substring(0,c);
_34=_33.substring(c+1);
_38=_20(_31,{userId:_34,isAuth:(_34.indexOf("anonymous")!==0)});
if((_39.indexOf(_35)+_35.length)===_39.length){
if(_37===null||_35===_39){
if(_37===_35){
_36=_36||_38;
}else{
_37=_35;
_36=_38;
}
}
}
}
}
}
return _36;
};
function _3a(_3b){
var _3c=_2a(_1c);
if(!_30(_3b,_3c)){
_13.debug("Must be in proxy situation, not getting container token cookie back from server.");
var _3d=_1f.hostname+"$"+_3b.userId;
_4(_1c,_3d,{path:"/"});
}
};
_16=_2("",[],{_userData:null,_lastUpdate:null,_containerToken:null,_commonContainer:null,getContainerToken:function(_3e){
var _3f=this,_40=new _11(),p=_3e?_3e:com.ibm.lconn.gadget.container.iContainer2.getIRuntime();
if(typeof (window["__isgadget"])=="undefined"){
p.then(function(){
if(typeof (window["shindig"])==="undefined"){
console.error("FATAL: shindig is undefined, returning");
return;
}
var _41=(typeof (window["user"])!=="undefined"?window["user"]:null),_42=(typeof (window["userid"])!=="undefined"?window["userid"]:null),u=(_41?_41:_42),_43=shindig.sha1();
u=(u?u:(_8?_8.getUser():null));
if(u){
_43.update(u);
u=_43.digestString();
}else{
u=(new Date()).valueOf();
}
var _44=[_1e.toString(),"/common/tokenRefresh?type=container&token=","&u=",u].join("");
var _45={};
_45[_1b]="check";
_45[_1a]=_1f.href;
_5(_44,{method:"GET",handleAs:"json",headers:_45,sync:false}).response.then(_3.hitch(_3f,"_creTokenDataHandlerLoad",_40),_3.hitch(_3f,"_creTokenDataHandlerError",_40));
});
}
return _40;
},_getCachedToken:function(){
var now=new Date().getTime();
var _46=_2a(_1c);
var _47=this._containerToken;
var _48=this._lastUpdate;
if(_48){
_48+=(_17.containerTokenTTLSec*1000);
}
if(!_30(this._userData,_46)){
return false;
}else{
if((_47&&_47.token)&&(_48&&now<_48)){
return _47.token;
}else{
return false;
}
}
},_creTokenDataHandlerLoad:function(_49,_4a){
var _4b=_4a.data,_4c=_4a;
_13.debug("SUCCESS: Load token: %o",_4b);
var _4d=this._parseUserData(_4c);
_3a(_4d);
_49.callback({creToken:_4b.containerToken,userData:_4d});
if(!this._userData){
this._lastUpdate=new Date().getTime();
this._containerToken=_4b.containerToken;
this._userData=_4d;
}
},_parseUserData:function(_4e){
var _4f=("true"===_4e.xhr.getResponseHeader(_18));
var _50=_4e.xhr.getResponseHeader(_19);
if(!_50){
_4f=false;
_50="anonymous_12cb0bb53b1e82f9abb84c4bc1a21f1ed371c5165ff8a629e88547b6b9d368f5";
_13.warn("No X-IC-CRE-User header, switching to anon user");
}
return {isAuth:_4f,userId:_50};
},_creTokenDataHandlerError:function(_51,_52,_53){
_13.error("ERROR: "+_52);
_51.errback(_52);
},_clearTokenData:function(_54){
this._invalidateGadgetTokens();
},tokenRefresh:function(_55){
var _56=this,_57=this._getCachedToken();
if(!_57){
this.getContainerToken().then(function(_58){
if((!_58)||(!_58.creToken)||(!_58.userData)||(!_58.userData.userId)){
var _59,_5a=_17.transientErrorRetryIntervalSec;
_13.debug("data: "+_58);
_13.debug("data.creToken: "+_58.creToken);
_13.debug("data.userData: "+_58.userData);
_13.debug("data.userData.userId: "+_58.userData.userId);
_13.warn("Error while refreshing container token - bad data.  Will retry in: "+_5a+" seconds");
_55(_59,_5a);
return;
}
_56._containerToken=_58.creToken;
_56._lastUpdate=new Date().getTime();
if(!_20(_56._userData,_58.userData)){
_23(_56._commonContainer);
_56._userData=_58.userData;
_55(_58.creToken.token,_17.containerTokenCheckSec);
_56._commonContainer.refreshTokens_();
cre$.internalutil.setCREContainerToken(_58.creToken);
}else{
_13.debug("Token refresh success %o",_58);
_55(_58.creToken.token,_17.containerTokenCheckSec);
cre$.internalutil.setCREContainerToken(_58.creToken);
}
},function(_5b){
var _5c,_5d=_17.transientErrorRetryIntervalSec;
_13.warn("Error while refreshing container token.  Will retry in: "+_5d+" seconds");
_55(_5c,_5d);
});
}else{
_55(_57,_17.containerTokenCheckSec);
}
},setCommonContainer:function(_5e){
this._commonContainer=_5e;
},logoutHandler:function(){
_4(_1c,_15,{expires:-1,domain:_17.ssoDomain,path:"/"});
_4(_1c,_15,{expires:-1,path:"/"});
}});
return _16;
})(_1,_8,_9,_a,_6,_c,_b,_7);
return com.ibm.lconn.gadget.services.TokenRefreshHandler;
});


;define("ic-gadget/services/tokenRefreshService",["dojo/_base/lang","dojo/cookie","ic-core/auth","./TokenRefreshHandler"],function(_1,_2,_3,_4){
com.ibm.lconn.gadget.services.tokenRefreshService=(function(_5,_6,_7){
var _8={};
var _9=new _6();
_8.getContainerToken=function(p){
return _9.getContainerToken(p);
};
_8.getTokenRefresher=function(){
return _1.hitch(_9,"tokenRefresh");
};
_8.registerService=function(_a){
_9.setCommonContainer(_a);
};
_7.addLogoutHandler(function(){
_9.logoutHandler();
});
return _8;
})(dojo,_4,_3);
return com.ibm.lconn.gadget.services.tokenRefreshService;
});


;define("ic-gadget/util/specHelper",["dojo","dojo/_base/lang","dojo/dom","dojox/uuid/generateRandomUuid","ic-core/globalization/api","ic-core/url"],function(_1,_2,_3,_4,_5,_6){
com.ibm.lconn.gadget.util.specHelper=(function(_7){
var _8={},_9=_2.getObject("location",_1.global).toString(),_a=function(){
},_b=_1.global;
var _c=function(_d){
if(_d){
if(_2.isString(_d)){
return function(){
(_b[_d]||_a).apply(null,arguments);
};
}else{
return _d;
}
}else{
return _a;
}
};
var _e=_8.nextDomId=function(){
return "gadget_"+_4();
};
var _f=function(_10){
var _11=_10.placement;
if(_11&&!_2.isString(_11)){
if(!_11.id){
_11.id=_e();
}
}
};
var _12=function(_13){
return (_13&&_13.instanceData&&_13.instanceData.renderType&&_13.instanceData.renderType==="inline");
};
var _14=_8.isGadget=function(_15){
return (_15&&_15.componentType&&_15.componentType==="gadget");
};
var _16=_8.isEEGadget=function(_17){
return (_14(_17)&&_17.instanceData&&_17.instanceData.eeDataModel);
};
var _18=_8.isInlineEE=function(_19){
return (_16(_19)&&_12(_19));
};
var _1a=_8.isInlineGadget=function(_1b){
return (_14(_1b)&&_12(_1b));
};
var _1c=_8.normalizeWidgetSpec=function(_1d){
var _1e=null,_1f=null,_20=null,_21=null;
_1d.definitionUrl=_7.parse(_9,_1d.definitionUrl).toString();
_1e=_1d.instanceData||(_1d.instanceData={});
if(_18(_1d)){
throw "Inline EE gadgets are not permitted. Attempted to load: "+_1d.definitionUrl;
}
if(_14(_1d)){
_1e=_1d.instanceData||(_1d.instanceData={});
_1f=_1e.renderParams||(_1e.renderParams={});
var _22=_1f.userPrefs||(_1f.userPrefs={});
if(_5){
_22["lconn.core.globalization.api.calendar"]=_5.getCalendar();
_22["lconn.core.globalization.api.textDirection"]=_5.getTextDirection();
_22["lconn.core.globalization.api.bidiEnabled"]=_5.isBidiEnabled();
}
if(_1.config.isDebug){
_1f[com.ibm.lconn.gadget.container.Container.RenderParam.TEST_MODE]=true;
}
}
_f(_1d);
_1e.errback=_c(_1d.errback);
return _1d;
};
var _23=_8.cloneSpec=function(_24){
if(!_24){
return _24;
}
var _25={};
for(var key in _24){
if(key==="placement"){
var val=_24[key];
if(!_2.isString(val)){
val=_3.byId(val).id;
}
_25[key]=val;
}else{
_25[key]=_24[key];
}
}
return _25;
};
return _8;
})(_6);
return com.ibm.lconn.gadget.util.specHelper;
});


;define("ic-gadget/services/oauthPopupDialog",["dojo/_base/lang","dojo/aspect","ic-core/auth","./dialog/IframeDialog","./dialog/OAuthErrorDialog","./tokenRefreshService","../util/specHelper","../util/trace"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9=_1.getObject("com.ibm.lconn.gadget.services.oauthPopupDialog",true);
_9.registerService=function(_a){
var _b={};
var _c=_6,_d=_3;
var _e=_8;
var _f={AUTHORIZE_SUCCESS:"authorize_success",AUTHORIZE_REJECTED:"authorize_rejected",AUTHORIZE_SERVER_ERROR:"authorize_server_error",AUTO_AUTHORIZE_REJECTED:"auto_authorize_rejected"};
_a.rpcRegister("_ic_oauth_dialog_status",function(_10,_11){
if(!_11.status){
return;
}
var _12=_11.status,_13=_11.message,wi=_b[_10.f],_14,_15=(wi?wi.handler:_14),_16=(wi?wi.dialog:_14);
if(_15===_14){
return;
}
switch(_12){
case _f.AUTHORIZE_SUCCESS:
_15();
break;
case _f.AUTHORIZE_REJECTED:
_15();
break;
case _f.AUTHORIZE_SERVER_ERROR:
if(!_16||_16.isAuto){
_15(true);
}else{
_16.show();
}
break;
case _f.AUTO_AUTHORIZE_REJECTED:
if(_16.isAuto){
_15(true);
}else{
_16.show();
}
break;
}
if(_13){
console.log(_13);
}
});
var _17={};
_a.setupNonGadgetRpcEndpoint();
_a.rpcRegister("_ic_oauth_dialog_open",function(_18,url,_19,pid,_1a){
var _1b=_18[osapi.container.GadgetSite.RPC_ARG_KEY];
var _1c=_1b.getId();
var _1d=null;
function _1e(_1f){
_1b.rpcCall("_ic_oauth_dialog_closed",function(){
},{isAutoFail:_1f,pids:_17[_1c]});
delete (_17[_1c]);
if(_1d){
delete _b[_1d];
}
};
function _20(){
var _21=["_ic_oauth_dialog_status","__ack","__cb","gadgets.rpc.config","gadgets.rpc.register","gadgets.rpc.unregister","gadgets.rpc.registerDefault","gadgets.rpc.unregisterDefault","gadgets.rpc.forceParentVerifiable","gadgets.rpc.call","gadgets.rpc.getRelayUrl","gadgets.rpc.setRelayUrl","gadgets.rpc.setAuthToken","gadgets.rpc.setupReceiver","gadgets.rpc.getAuthToken","gadgets.rpc.removeReceiver","gadgets.rpc.getRelayChannel","gadgets.rpc.receive","gadgets.rpc.receiveSameDomain","gadgets.rpc.getOrigin","gadgets.rpc.getTargetOrigin"],ifd=new _4(url,_19,_1a),_22=_7.nextDomId(),_23=_7.nextDomId();
gadgets.rpc.setUpRpcIdsForNonGadgetIframe(_22,_23,url,_21);
ifd.init(_22,_23);
if(!_1a){
ifd.show();
}
_1d=_22;
var _24=function(_25){
ifd.destroy();
_1e(_25);
};
_2.after(ifd,"onClose",_24);
_b[_22]={window:ifd.getWindow(),handler:_24,dialog:ifd};
};
if(!_17[_1c]){
_17[_1c]=[pid];
_c.getContainerToken().then(function(_26){
var _27=_26.userData;
if(!_27.isAuth){
_d.login();
}else{
_20();
}
},function(_28){
_e.error("Error checking user authentication: "+_28);
var _29=new _5();
_29.startup();
_29.show();
_1e(_1a);
});
}else{
_17[_1c].push(pid);
}
});
};
return _9;
});


;define("ic-gadget/services/urlSecurityService",["ic-core/config","ic-core/config/services","ic-core/url","../config/settings","../util/trace"],function(_1,_2,_3,_4,_5){
com.ibm.lconn.gadget.services.urlSecurityService=(function(_6,_7,_8,_9,_a,_b){
var _c={},_d=_8.security.urlWhitelistEnabled,_e=_8.security.allowUrlCheckPattern;
opensocialUrl_=_7.getServiceUrl(_b.opensocial),errorPage_=opensocialUrl_+"/ic/errors/errorMini.jsp";
if(_e){
_e=new RegExp(_8.security.allowUrlCheckPattern,"i");
}else{
_e={"test":function(){
return false;
}};
}
function _f(_10,url,_11){
if(_12(url)){
return this.navigateUrlNoSecurity.apply(this,arguments);
}else{
_9.warn("Blocking access to url: "+url+".  URL does not match whitelist.");
var _13=Array.prototype.slice.call(arguments);
_13[1]=errorPage_;
return this.navigateUrlNoSecurity.apply(this,_13);
}
};
function _12(url){
if(!_d){
return true;
}
return url&&url.indexOf("..")===-1&&_e.test(url);
};
_c.registerService=function(_14){
_14.navigateUrlNoSecurity=_14.navigateUrl;
_14.navigateUrl=_f;
};
return _c;
})(dojo,_3,_4,_5,com.ibm.lconn.gadget.services.dialog.UrlAccessDeniedDialog,_2);
return com.ibm.lconn.gadget.services.urlSecurityService;
});


;define("ic-gadget/services/fake_handleRpcMethod",["../util/trace"],function(_1){
com.ibm.lconn.gadget.services.fake_handleRpcMethod=(function(_2){
var _3={},_4="osapi._handleRpcMethod called - method not implemented in this container. arguments : ";
_3.registerService=function(_5){
_5.rpcRegister("osapi._handleGadgetRpcMethod",function(){
_2.debug(_4,arguments);
});
};
return _3;
})(_1);
return com.ibm.lconn.gadget.services.fake_handleRpcMethod;
});


;define("ic-core/util/jsonCompat",[],function(){
var _1;
if(!_1){
_1={};
}
(function(){
"use strict";
function f(n){
return n<10?"0"+n:n;
};
if(typeof Date.prototype.toJSON!=="function"){
Date.prototype.toJSON=function(_2){
return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null;
};
String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(_3){
return this.valueOf();
};
}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,_4=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,_5,_6,_7={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\"":"\\\"","\\":"\\\\"},_8;
function _9(_a){
_4.lastIndex=0;
return _4.test(_a)?"\""+_a.replace(_4,function(a){
var c=_7[a];
return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);
})+"\"":"\""+_a+"\"";
};
function _b(_c,_d){
var i,k,v,_e,_f=_5,_10,_11=_d[_c];
if(_11&&typeof _11==="object"&&typeof _11.toJSON==="function"){
_11=_11.toJSON(_c);
}
if(typeof _8==="function"){
_11=_8.call(_d,_c,_11);
}
switch(typeof _11){
case "string":
return _9(_11);
case "number":
return isFinite(_11)?String(_11):"null";
case "boolean":
case "null":
return String(_11);
case "object":
if(!_11){
return "null";
}
_5+=_6;
_10=[];
if(Object.prototype.toString.apply(_11)==="[object Array]"){
_e=_11.length;
for(i=0;i<_e;i+=1){
_10[i]=_b(i,_11)||"null";
}
v=_10.length===0?"[]":_5?"[\n"+_5+_10.join(",\n"+_5)+"\n"+_f+"]":"["+_10.join(",")+"]";
_5=_f;
return v;
}
if(_8&&typeof _8==="object"){
_e=_8.length;
for(i=0;i<_e;i+=1){
if(typeof _8[i]==="string"){
k=_8[i];
v=_b(k,_11);
if(v){
_10.push(_9(k)+(_5?": ":":")+v);
}
}
}
}else{
for(k in _11){
if(Object.prototype.hasOwnProperty.call(_11,k)){
v=_b(k,_11);
if(v){
_10.push(_9(k)+(_5?": ":":")+v);
}
}
}
}
v=_10.length===0?"{}":_5?"{\n"+_5+_10.join(",\n"+_5)+"\n"+_f+"}":"{"+_10.join(",")+"}";
_5=_f;
return v;
}
};
if(typeof _1.stringify!=="function"){
_1.stringify=function(_12,_13,_14){
var i;
_5="";
_6="";
if(typeof _14==="number"){
for(i=0;i<_14;i+=1){
_6+=" ";
}
}else{
if(typeof _14==="string"){
_6=_14;
}
}
_8=_13;
if(_13&&typeof _13!=="function"&&(typeof _13!=="object"||typeof _13.length!=="number")){
throw new Error("JSON.stringify");
}
return _b("",{"":_12});
};
}
if(typeof _1.parse!=="function"){
_1.parse=function(_15,_16){
var j;
function _17(_18,key){
var k,v,_19=_18[key];
if(_19&&typeof _19==="object"){
for(k in _19){
if(Object.prototype.hasOwnProperty.call(_19,k)){
v=_17(_19,k);
if(v!==undefined){
_19[k]=v;
}else{
delete _19[k];
}
}
}
}
return _16.call(_18,key,_19);
};
_15=String(_15);
cx.lastIndex=0;
if(cx.test(_15)){
_15=_15.replace(cx,function(a){
return "\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);
});
}
if(/^[\],:{}\s]*$/.test(_15.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){
j=eval("("+_15+")");
return typeof _16==="function"?_17({"":j},""):j;
}
throw new SyntaxError("JSON.parse");
};
}
}());
return lconn.core.util.jsonCompat;
});


;define("ic-gadget/people/_vcard_utils",{});


;define("ic-gadget/people/util/localizer",["dojo/_base/declare"],function(_1){
return _1([],{});
});


;define("ic-gadget/services/people_container",["dojo/_base/declare","dojo/dom-construct","ic-core/config","ic-core/config/services","ic-core/url","../people/_vcard_utils","../people/util/localizer"],function(_1,_2,_3,_4,_5,_6,_7){
com.ibm.lconn.gadget.services.people_container=(function(){
var _8=_1("",_7,{generateVcard:function(_9,_a,_b){
var _c=_5.getServiceUrl(_4.profiles);
var _d=this.getLocalizedString("Photo of ${0}",[_a]);
var _e=this.getLocalizedString("This is a link to the profile of ${0}",[_a]);
var _f=_c+"/html/profileView.do?userid="+_9;
var _10=_2.create("span",{className:"vcard"});
_10=_2.place(_10,_b.refNode,_b.relPos);
var _11=_2.create("a",{href:_f,title:_e,className:"fn url",target:this.linkTarget,innerHTML:_a},_10);
_2.create("span",{className:"photo",src:_c+"/photo.do?userid="+_9,alt:_d,style:{display:"none"}},_11);
_2.create("span",{className:"x-lconn-userid",style:{display:"none"},innerHTML:_9},_10);
return _10;
}});
return new _8();
})();
return com.ibm.lconn.gadget.services.people_container;
});


;define("ic-gadget/resources/iRuntimeModule",["dojo/_base/lang","ic-core/util/jsonCompat","../services/people_container"],function(_1,_2,_3,_4){
return _1.getObject("com.ibm.lconn.gadget.resources.iRuntimeModule",true);
});


;define("ic-gadget/services/ICActionsContainer",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","../container/ICActions"],function(_1,_2,_3,_4){
var _5=_2("com.ibm.lconn.gadget.services.ICActionsContainer",_4,{_renderGadgetInContainer:null,constructor:function(){
this._renderGadgetInContainer=[];
},registerService:function(_6){
_6.actions.registerNavigateGadgetHandler(_3.hitch(this,this.handleGadgetSelection));
},registerNavigateGadgetHandler:function(_7){
if(typeof _7==="function"){
this._renderGadgetInContainer.push(_7);
}
},handleGadgetSelection:function(_8,_9){
_1.forEach(this._renderGadgetInContainer,function(_a){
_a(_8,_9);
});
}});
var _b=new _5();
_4.__instance__=function(){
return _b;
};
return _5;
});


;define("ic-gadget/services/set_title",["dojo/_base/lang","dojo/topic","../container/Topics","../util/trace"],function(_1,_2,_3,_4){
var _5=_1.getObject("com.ibm.lconn.gadget.services.set_title",true);
_5.registerService=function(_6){
_6.rpcRegister("set_title",function(_7,_8){
var _9,_a;
if(_7.gs&&_7.gs.id_){
var _b=_3.getSiteTopic(_7.gs.id_,_3.GadgetWindow.SITE_TOPIC_SET_TITLE);
_2.publish(_b,_8);
_a=document.getElementById(_7.gs.id_);
if(_a.title){
_a.title=_8;
}
}else{
_4.log("looks like you're trying to set the title on an inline gadget, you need to use a better rpc call");
_4.log("try gadgets.rpc.call('', 'set_title', null, {'mid':__MODULE_ID__})");
}
});
};
return _5;
});


;define("ic-gadget/services/lifecycleModifications",["dojo/topic","../container/Topics"],function(_1,_2){
com.ibm.lconn.gadget.services.lifecycleModifications=(function(){
var _3={};
_3.registerService=function(_4){
var _5,_6,_7;
_5=_2.getMasterLifecycleTopic();
_6={};
_7=function(_8,_9){
var _a=_2.getLifecycleEventTopic(_8);
return function(){
_1.publish(_a,arguments);
_1.publish(_9,arguments);
};
};
for(var _b in osapi.container.CallbackType){
_6[osapi.container.CallbackType[_b]]=_7(osapi.container.CallbackType[_b],_5);
}
_4.addGadgetLifecycleCallback("lconn_gadget_lifecycle_publisher",_6);
};
return _3;
})();
return com.ibm.lconn.gadget.services.lifecycleModifications;
});


;define("ic-gadget/util/domStore",["dojo","dojo/dom-attr","dojo/_base/lang"],function(_1,_2,_3){
var _4=[0],_5="data-iContainer-data-"+ +new Date();
var _6=function(_7){
var _8=_2.get(_7,_5),_9=_4.length;
if(!_8){
_8=_9;
_2.set(_7,_5,_9);
_4[_8]={};
}
return {get:function(_a){
return _4[_8][_a];
},set:function(_b,_c){
_4[_8][_b]=_c;
return _c;
}};
};
_3.setObject("com.ibm.lconn.gadget.util.domStore",_6);
return _6;
});


;define("ic-gadget/services/ViewHandler",["dojo/_base/declare","dojo/_base/lang","../util/domStore"],function(_1,_2,_3){
var _4="_____NULL_____";
var _5="data-iContainer-destroy-handler";
function _6(_7){
if(!_7||_7===""){
return _4;
}else{
return _7;
}
};
function _8(_9){
return _9.el_;
};
var _a=_1("com.ibm.lconn.gadget.services.ViewHandler",null,{_registry:null,_handledMethod:null,constructor:function(_b){
this._registry={};
this._handledMethod=_b;
},registerHandler:function(_c,_d,_e){
_c=_6(_c);
var _f={"createHandler":_d,"destroyHandler":_e};
this._registry[_c]=_f;
},invokeCreate:function(_10,_11,_12){
_11=_6(_11);
var _13=this._registry,_14=_13[_11]||_13[_4];
_15=null;
if(_14){
var _15=_14.createHandler.apply(_10,_12);
_3(_15).set(_5,_14.destroyHandler);
return _15;
}else{
throw "Unknown view target for "+this._handledMethod+": "+_11;
}
}});
_2.mixin(com.ibm.lconn.gadget.services.ViewHandler,{invokeDestroy:function(_16,_17,_18){
var _19=_8(_17),_1a=_3(_19).get(_5);
if(_1a){
_1a.apply(_16,_18);
}else{
throw "Could not find handler method";
}
}});
return _a;
});


;define("ic-gadget/services/ViewContainer",["dojo/_base/declare","../container/Views","./ViewHandler"],function(_1,_2,_3){
var _4=_1("com.ibm.lconn.gadget.services.ViewContainer",_2,{_createForGadgetRegistry:null,_createForEERegistry:null,_createForUrlRegistry:null,_container:null,constructor:function(){
this._createForGadgetRegistry=new _3("createElementForGadget");
this._createForEERegistry=new _3("createElementForEmbeddedExperience");
this._createForUrlRegistry=new _3("createElementForUrl");
},registerCreateElementGadgetHandler:function(_5,_6,_7){
return this._createForGadgetRegistry.registerHandler(_5,_6,_7);
},registerCreateElementForEEHandler:function(_8,_9,_a){
return this._createForEERegistry.registerHandler(_8,_9,_a);
},registerCreateElementForUrlHandler:function(_b,_c,_d){
return this._createForUrlRegistry.registerHandler(_b,_c,_d);
},bindContainer:function(_e){
this._container=_e;
},createElementForGadget:function(_f,rel,_10,_11,_12,_13){
return this._createForGadgetRegistry.invokeCreate(this._container,_11,arguments);
},createElementForEmbeddedExperience:function(rel,_14,_15,_16,_17){
return this._createForEERegistry.invokeCreate(this._container,_15,arguments);
},createElementForUrl:function(rel,_18,_19,_1a){
return this._createForUrlRegistry.invokeCreate(this._container,_18,arguments);
},destroyElement:function(_1b){
return _3.invokeDestroy(this._container,_1b,arguments);
}});
var _1c=new _4();
_2.__instance__=function(){
return _1c;
};
return _4;
});


;define("dojo/i18n!ic-gadget/nls/gadgetDialogStrings", {"cancel":{"a11y":"Cancel","label":"Cancel","tooltip":"Cancel"}});

;define("dojo/text!ic-gadget/services/dialog/templates/GadgetDialog.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div aria-live="assertive">\n<div id="${id}_dialog" role="dialog" aria-labelledby="${gadgetNodeId}_title">\n	<div class="lotusDialogBorder">\n		<div class="lotusDialog">\n			<div class="lotusDialogHeader">\n				<h1 id="${gadgetNodeId}_title" class="lotusHeading" data-dojo-attach-point="titleNode">${gadgettitle}</h1>\n				<a class="lotusDialogClose" role="button" href="javascript:;" title="${nlsCommon.rs_close}" data-dojo-attach-event="onclick:closeDialog">\n					<img alt="${nlsCommon.rs_close}" src="${blankGif}">\n					<span class="lotusAltText">${nlsCommon.rs_close}</span>\n				</a>\n			</div><!--end lotusDialogHeader-->\n			<div class="lotusDialogContent" id="${gadgetNodeId}" style="padding-right:0px;padding-bottom:0px;overflow:auto;width:${gadgetwidth};height:${gadgetheight};" data-dojo-attach-point="gadgetNode">gadget goes here</div>\n		</div><!--end lotusDialog-->\n	</div><!--end lotusDialogBorder-->\n</div><!--end dialog-->\n</div>\n');

;define("ic-gadget/services/dialog/GadgetDialog",["dojo","dojo/i18n!../../nls/gadgetDialogStrings","dojo/_base/declare","dojo/_base/config","dojo/i18n","dojo/has","dojo/dom","dojo/dom-style","dojo/dom-attr","dojo/i18n!ic-core/nls/strings","dojo/query","dojo/text!./templates/GadgetDialog.html","dijit/Dialog","dijit/_Templated","dijit/_Widget","../../container/Topics"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){
var _11=_3("com.ibm.lconn.gadget.services.dialog.GadgetDialog",[_f,_e],{blankGif:"",_extents:{"height":300,"width":700},nlsCommon:_a,templateString:_c,popup:null,_setExtentStyle:function(_12,_13){
var _14="gadget"+_12;
if((typeof (_13)!="undefined")&&(_13!=null)){
var _15=_13["modulePrefs"][_12];
if(_15!=0){
this._extents[_12]=_15;
}
}
this[_14]=this._extents[_12]+"px";
},constructor:function(_16){
var _17=function(_18,_19){
var _1a="gadgettitle";
if(typeof _19!="undefined"){
var _1b=_19["modulePrefs"]["title"];
this[_1a]=_1b!==""?_1b:_18;
}else{
this[_1a]=_18;
}
};
_17.apply(this,["Gadget Dialog",_16.gadget_metadata]);
this._setExtentStyle("width",_16.gadget_metadata);
this._setExtentStyle("height",_16.gadget_metadata);
this.inherited(arguments);
},postMixInProperties:function(){
this.blankGif=_4.blankGif;
this.inherited(arguments);
this.nls=_2;
},postCreate:function(){
this._subscribeAll();
},_subscribeAll:function(){
var _1c=_10.getSiteTopic(this.gadgetNodeId,_10.GadgetWindow.SITE_TOPIC_SET_TITLE);
this.subscribe(_1c,"onGadgetTitleUpdated");
_1c=_10.getSiteTopic(this.gadgetNodeId,_10.GadgetWindow.AFTER_ADJUST_WIDTH);
this.subscribe(_1c,"onWidthUpdated");
_1c=_10.getSiteTopic(this.gadgetNodeId,_10.GadgetWindow.AFTER_ADJUST_HEIGHT);
this.subscribe(_1c,"onHeightUpdated");
_1c=_10.getLifecycleEventTopic(osapi.container.CallbackType.ON_RENDER);
this.subscribe(_1c,"onGadgetLoaded");
},show:function(){
if(this.popup==null){
this.popup=new _d();
}
this.popup.attr({content:this.domNode,title:""});
this.popup.show();
},_updateStyles:function(){
this.popup.resize();
try{
_8.set(this.gadgetNode,"overflow",null);
}
catch(e){
}
var _1d=_8.get(this.popup.containerNode,"height");
var _1e=_8.get(this.popup.containerNode,"width");
if(_1d<this._extents["height"]){
_8.set(this.gadgetNode,"height","auto");
_8.set(this.popup.containerNode,"height","auto");
if(!_6("ie")){
if(_6("safari")){
_8.set(this.gadgetNode,"height",this._extents.height+"px");
}else{
_8.set(this.gadgetNode,"height","auto");
}
_8.set(this.popup.containerNode,"overflow","visible");
}else{
_8.set(this.popup.containerNode,"height",(this._extents.height+67)+"px");
_8.set(this.popup.containerNode,"overflow","visible");
}
}
if(_1e<this._extents["width"]){
_8.set(this.popup.containerNode,"width","auto");
if(!_6("ie")){
_8.set(this.gadgetNode,"width","auto");
_8.set(this.popup.containerNode,"overflow","visible");
}else{
_8.set(this.popup.containerNode,"width",(this._extents.width+25)+"px");
_8.set(this.popup.containerNode,"overflow","visible");
}
}
},hide:function(){
this.popup.hide();
},destroy:function(){
this.inherited(arguments);
},onGadgetTitleUpdated:function(_1f){
this.titleNode.innerHTML=_1f;
},onWidthUpdated:function(_20){
this._extents.width=_8.get(_b("iframe",this.gadgetNode)[0],"width");
this._updateStyles();
},onHeightUpdated:function(_21){
this._extents.height=_8.get(_b("iframe",this.gadgetNode)[0],"height");
this._updateStyles();
},onGadgetLoaded:function(_22,_23){
if(_6("ie")&&_23==this.gadgetNodeId){
if(_23===this.gadgetNodeId){
var _24=_b("iframe",_7.byId(_23))[0];
if(_24){
if(_9.get(_24,"scrolling")=="no"){
_9.set(_24,"scrolling","auto");
}
}
}
}
var _24=_b("iframe",this.gadgetNode)[0];
if(_24){
_8.set(_24,"maxHeight","300px");
_8.set(this.gadgetNode,{"height":"auto","width":"auto"});
this._updateStyles();
if(_b("iframe",this.gadgetNode).length>0){
_b("iframe",this.gadgetNode)[0].setAttribute("role","presentation");
}
}
},closeDialog:function(){
this.hide();
}});
return _11;
});


;define("ic-gadget/services/viewModifications",["dojo","dojo/_base/lang","dojo/dom-attr","dojo/query","dojo/topic","ic-core/url","../container/Topics","../container/Views","./ViewContainer","./dialog/GadgetDialog","../util/specHelper","../util/trace"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
var _d=_2.getObject("com.ibm.lconn.gadget.services.viewModifications",true);
var _e=_8.__instance__();
var _f=_b.nextDomId;
var _10=function(_11,_12){
var _13=osapi.container.GadgetSite.prototype[_11];
osapi.container.GadgetSite.prototype[_11]=function(){
_13.apply(this,arguments);
var _14=_7.getSiteTopic(this.getId(),_7.GadgetWindow[_12]);
_5.publish(_14,Array.prototype.slice.call(arguments,0));
};
};
_d.registerService=function(_15){
var _16=_15.views;
_e.bindContainer(_15);
_16.createElementForGadget=_2.hitch(_e,"createElementForGadget");
_16.createElementForEmbeddedExperience=_2.hitch(_e,"createElementForEmbeddedExperience");
_16.createElementForUrl=_2.hitch(_e,"createElementForUrl");
_16.destroyElement=_2.hitch(_e,"destroyElement");
_15.rpcRegister("requestNavigateTo",function(_17,_18,_19,_1a){
var _1b=_17.gs;
var _1c=_1b.currentGadgetHolder_.gadgetInfo_.url;
var _1d=_1b.currentGadgetHolder_.renderParams_||{};
_1d.view=_18;
var _1e={};
if(_19){
if(_2.isObject(_19)){
_2.mixin(_1e,_19);
}else{
if(_2.isString(_19)){
_2.mixin(_1e,_6.splitQuery(_19));
}else{
_c.log("opt_params passed to gadgets.views.requestNavigateTo could not be processed.",_19);
}
}
}
_15.navigateGadget(_1b,_1c,_1e,_1d,null);
});
_10("setHeight","AFTER_ADJUST_HEIGHT");
_10("setWidth","AFTER_ADJUST_WIDTH");
};
_e.registerCreateElementGadgetHandler(null,_1f,_20);
_e.registerCreateElementForEEHandler(null,_21,_20);
_e.registerCreateElementForUrlHandler(null,_22,_20);
function _1f(_23,rel,_24,_25,_26,_27){
var _28=_24||"default";
var _29=_25||"default";
switch(_29.toLowerCase()){
case "modaldialog":
return _2a(this,true,_28,true,_23);
break;
default:
return _2a(this,true,_28,true,_23);
}
};
function _21(rel,_2b,_2c,_2d,_2e){
return _2a(this,true,"embedded",true);
};
function _22(rel,_2f,_30,_31){
return _21.apply(this,arguments);
};
function _20(_32){
_33(this,_32);
};
function _2a(_34,_35,_36,_37,_38,_39){
var _3a=_f();
var _3b={"id":"gadget_dialog_"+_3a,"gadgetNodeId":_3a,"gadget_metadata":_38};
var _3c=new _a(_3b);
_3c.closeDialog=function(){
var _3d=_3.get(_4("#"+_3a+">iframe")[0],"id");
_20.call(_34,_34.getGadgetSiteByIframeId_(_3d));
};
_3c.show();
return _3c.gadgetNode;
};
function _33(_3e,_3f){
var _40=_3f.el_.id;
var _41="gadget_dialog_"+_40;
_3e.closeGadget(_3f);
var _42=dijit.byId(_41);
if(_42){
_42.hide();
_42.destroyRecursive();
}
};
return _d;
});


;define("ic-gadget/container/_Accessor",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/cookie","dojo/dom-attr","dojo/dom-construct","dojo/topic","./Accessor","ic-core/url","ic-core/util/amdLoader","ic-core/util/LCDeferredList","ic-core/util/LCDeferred","ic-core/config/services","../config/settings","ic-core/config","../services/sso_reauth_callback","./Topics","./ICActions","../services/oauthPopupDialog","../services/urlSecurityService","../services/fake_handleRpcMethod","../resources/iRuntimeModule","../services/ICActionsContainer","../services/tokenRefreshService","../services/set_title","../services/lifecycleModifications","../services/viewModifications","../util/trace","ic-ui/util/proxy"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,_1a,_1b,_1c,_1d){
(function init_com_ibm_lconn_gadget_container__Accessor(_1e,_1f,_20,_21,_22,_23,_24,_25,_26,_27,_28){
var _29=null;
var _2a=_a.require;
var _2b=_24.security;
var _2c=_1e.global.location;
var _2d="X-IC-Preload";
var _2e=(function(){
var _2f=navigator.appName;
var _30=navigator.userAgent.indexOf("Safari");
return (_30!==-1||_2f==="Safari");
})();
var _31=(_1e.config.locale||""),_32=_31.substr(0,Math.min(_31.length,2)),_33=_31.substr(Math.min(_31.length,3),Math.min(_31.length,5));
var _34=(function(){
var _35={"pt":"br","zh":"tw"};
var _36={"zh":"zh-cn","he":"iw","id":"in","nb":"no"};
var _37=_32;
if(_35[_32]&&_35[_32]==_33){
_37=_37+"-"+_33;
}
_37=_36[_37]||_37;
if(!_37){
_37="en";
}
return _37;
})();
var _38=_21.opensocial,_39=_1f.parse(_2c.toString(),_38?_26(_1f.getServiceUrl(_38).toString()):"");
if(!_1e.config.blankGif){
(function configBlankGif_(){
var _3a=_21.webresources,_3b=_1f.parse(_2c.toString(),_26(_1f.getServiceUrl(_3a).toString()));
_1e.config.blankGif=_3b.toString()+"/web/com.ibm.lconn.core.styles.oneui3/images/blank.gif";
})();
}
var _3c=this;
function _3d(){
var _3e=new _22();
var _3f=_20.versionStamp||"";
var _40=(_34&&_34!=="")?"cre.messages."+_34+":":"",_41="&_ic_versionStamp="+_3f,_42=(_1e.config.isDebug?"&debug=1&noCache=1":_41),_43=_39.toString()+"/gadgets/js/cre.iruntime:cre.iwidget.event:cre.wire:cre.iwidget:cre.iwidget.itemset:"+"cre.util.stringify:cre.service.event:cre.osgadget:"+_40+"core:container:rpc:pubsub-2:views:embedded-experiences:open-views:selection:actions:viewenhancements:shared-script-frame:"+"cre.service.people:ibm.connections.sharedialog:com.ibm.connections.sharedialog:"+"com.ibm.connections.ee:ibm.connections.ee:container.nongadget:shindig.sha1:"+"open-views.js?c=1"+_42;
if(!_1e.global.cre$){
_25.debug("_Accessor.loadCreJs_ loading CRE JS from: "+_43);
setTimeout(_1e.hitch(_3c,function(){
_2a([_43],function(){
_25.debug("_Accessor.loadCreJs_ SUCCESS: Load CRE JS");
_3e.resolve();
_25.debug("_Accessor.__instance__ Exit load");
},function(_44){
_25.error("_Accessor.loadCreJs_ ERROR: ",_44);
_3e.errback(_44);
});
}),0);
}else{
_25.debug("_Accessor.loadCreJs_ SUCCESS: Load CRE JS via JS Bridge");
_3e.resolve();
}
return _3e;
};
var _45=["window.osapi.container.Container","window.osapi.container.Service","window.__CONTAINER_URI"];
window.__IC_iContainer2_AsyncDependenciesInit=new _22();
window._chkIC_Accessor_AsyncDependencies_=function(){
var _46=false;
try{
for(var i=_45.length;i--;){
if(typeof (eval(_45[i]))==="undefined"){
throw ("undefined leaf node");
}
}
_46=true;
}
catch(e){
}
if(_46){
window.__IC_iContainer2_AsyncDependenciesInit.resolve();
}else{
setTimeout("window._chkIC_Accessor_AsyncDependencies_()",50);
}
};
function _47(_48){
var loc=_2c;
cre$.config.SCHEME=loc.protocol.substring(0,loc.protocol.length-1);
cre$.config.HOST=loc.hostname;
cre$.config.PORT=(loc.port&&loc.port!=="")?loc.port:"";
cre$.config.CONTEXT_ROOT=_39.path;
cre$.config.locales=[_34];
cre$.config.isDebug=(_1e.config.isDebug?true:false);
cre$.config.MAX_TOKEN_TTL=_2b.gadgetTokenTTLSec;
};
function _49(_4a){
var cc={},CC=osapi.container.ContainerConfig;
cc[osapi.container.ServiceConfig.API_HOST]=[_39.scheme,"://",_39.authority].join("");
cc[osapi.container.ServiceConfig.API_PATH]=_39.path+"/rpc";
cc[CC.TOKEN_REFRESH_INTERVAL]=_2b.gadgetTokenTTLSec*1000;
cc[CC.GET_CONTAINER_TOKEN]=_28.getTokenRefresher();
cc[CC.GET_LANGUAGE]=function(){
return _32;
};
cc[CC.GET_COUNTRY]=function(){
return _33;
};
cc[CC.SET_PREFERENCES]=function(_4b,_4c,_4d){
var _4e=_27.getSiteTopic(_4c,_27.GadgetWindow.SET_PREFS);
_1e.publish(_4e,{"siteId":_4b,"gadgetUrl":_4c,"preferences":_4d});
};
if(_1e.config.isDebug){
cc[CC.RENDER_DEBUG]=true;
cc[CC.RENDER_TEST]=true;
}
return cc;
};
function _4f(_50){
_1b.registerService(_50);
_19.registerService(_50);
_1a.registerService(_50);
_13.registerService(_50);
_10.registerService(_50);
_15.registerService(_50);
_28.registerService(_50);
_12.__instance__().registerService(_50);
_14.registerService(_50);
};
var _51=_2("",_8,{_commonContainerPromise:null,_iRuntimePromise:null,constructor:function(_52,_53){
_25.entering("com.ibm.lconn.gadget.container._Accessor.prototype","constructor",arguments);
this._commonContainerPromise=new _22();
this._iRuntimePromise=new _22();
_52.then(_3.hitch(this,"_loadComplete",_53),_3.hitch(this,"_loadError"));
_25.exiting("com.ibm.lconn.gadget.container._Accessor.prototype","constructor",arguments);
},getCommonContainer:function(){
return this._commonContainerPromise;
},getIRuntime:function(){
return this._iRuntimePromise;
},fakeOpen:function(){
var _54={"id":"0",eventType:"PRELOAD"};
var _55=_21.webresources,_56=_1f.parse(_2c.toString(),_26(_1f.getServiceUrl(_55).toString()));
var _57=_56.toString();
var _58=_57+"/web/com.ibm.social.ee/ConnectionsEE.xml";
var c=document.getElementsByTagName("body")[0];
var div=_6.create("div",{id:dijit.getUniqueId("fake")},c);
div.style.display="none";
var def=[{definitionUrl:_58,mode:"preload",placement:_5.get(div,"id"),componentType:"gadget",instanceData:{renderParams:{},viewParams:{},eeDataModel:{context:_54}}}];
if(cre$&&cre$.iRuntime){
cre$.iRuntime.loadWidgets(def).then(function(){
_25.debug("_Accessor.fakeOpen preload done");
_4(_2d,"true",{path:"/"});
},function(_59){
_25.error("_Accessor.fakeOpen ERROR: ",_59);
});
}
},_loadComplete:function(_5a,_5b){
_25.entering("com.ibm.lconn.gadget.container._Accessor.prototype","_loadComplete");
_47(_5a);
var _5c=_49(_5a);
window._chkIC_Accessor_AsyncDependencies_();
window.__IC_iContainer2_AsyncDependenciesInit.then(_1e.hitch(this,function(){
setTimeout(_1e.hitch(this,function(){
var _5d=_5b[0][1];
var _5e=new osapi.container.Container(_5c);
_1e.global.__CONTAINER="default";
_4f(_5e);
cre$.internalutil.setCREContainerToken(_5d.creToken);
_5e.updateContainerSecurityToken(null,cre$.internalutil.getCREContainerToken().token,_2b.containerTokenCheckSec);
cre$.iRuntime.setCommonContainer(_5e,{configSecurityToken:false,configInlineOAH:true});
this._commonContainerPromise.resolve(_5e);
this._iRuntimePromise.resolve(cre$.iRuntime);
if((_2b.preloadJS)||(_2e&&(_2b.preloadJSSafari))){
var _5f=this.getCookieVals_(_2d);
if(!_5f||(!_5f.length>0)){
this.fakeOpen();
}
}
}),10);
}));
_25.exiting("com.ibm.lconn.gadget.container._Accessor.prototype","_loadComplete");
},getCookieVals_:function(_60){
var c=document.cookie,_61="(?:^|; )"+_1e.regexp.escapeString(_60)+"=([^;]*)",_62,_63=new RegExp(_61),res,_64=[],i;
_62=c.match(new RegExp(_61,"g"));
if(_62&&_62.length>0){
i=_62.length;
while(i--){
res=_62[i];
_64.push(decodeURIComponent(res.match(_63)[1]));
}
}
return _64;
},_loadError:function(_65){
_25.error("_Accessor.prototype._loadError called.",_65);
this._commonContainerPromise.errback(_65);
this._iRuntimePromise.errback(_65);
}});
_3.mixin(_8,{__instance__:function(_66){
_25.entering("com.ibm.lconn.gadget.container._Accessor","__instance__");
if(_29===null){
var _67=_3d(),_68=_28.getContainerToken(_67);
_29=new _51(new _23([_68,_67]),_66);
}else{
_25.debug("_Accessor.__instance__ Already called, skipping re-init");
}
_25.exiting("com.ibm.lconn.gadget.container._Accessor","__instance__");
return _29;
}});
})(_1,_9,_f,_d,_c,_b,_e,_1c,_1d,_11,_18);
return com.ibm.lconn.gadget.container._Accessor;
});


;define("ic-core/util/promises",["dojo/_base/declare","dojo/_base/lang","ic-core/util/LCDeferred","ic-core/util/LCDeferredList"],function(_1,_2,_3,_4){
var _5={};
_5.iFaceClass=_1("",null,{then:function(){
},cancel:function(){
}});
_5.isPromiseLike=function(_6){
if(_6&&(_6.then&&_2.isFunction(_6.then))){
return true;
}else{
return false;
}
};
_5.deferredToPromise=function(_7){
if(_5.isPromiseLike(_7)){
return _7;
}else{
var p=new _3();
_7.addCallback(p,"callback");
_7.addErrback(p,"errback");
return p;
}
};
return _5;
});


;define("ic-core/util/LCChainedDeferred",["dojo/_base/lang","ic-core/util/LCDeferred","ic-core/util/promises"],function(_1,_2,_3){
(function(d,_4,_5){
d.declare("lconn.core.util.LCChainedDeferred",_4.iFaceClass,{_promiseChain:null,_deferred:null,_errored:false,constructor:function(_6){
this._deferred=new _5();
this._promiseChain=_6;
this._hitch();
},then:function(cb,_7){
return this._deferred.then(cb,_7);
},cancel:function(){
if(this._promiseChain.cancel){
return this._promiseChain.cancel.apply(this._promiseChain,arguments);
}
this._errback.apply(this,arguments);
},_errback:function(){
this._errored=true;
var _8=this._deferred;
_8.errback.apply(_8.errback,arguments);
},_callback:function(_9){
if(!this._errored){
if(_4.isPromiseLike(_9)){
this._promiseChain=_9;
this._hitch();
}else{
this._deferred.callback(_9);
}
}
},_hitch:function(){
this._promiseChain.then(_1.hitch(this,"_callback"),_1.hitch(this,"_errback"));
}});
})(dojo,_3,_2);
return lconn.core.util.LCChainedDeferred;
});


;define("ic-gadget/container/_Handle",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/dom","dojo/dom-attr","ic-core/util/LCDeferred","ic-core/util/LCChainedDeferred","./Accessor","./Handle","../util/specHelper","../util/trace"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
(function(_c,_d,_e,_f,_10,_11){
function _12(_13){
if(_13){
if(_3.isString(_13)){
return _13;
}else{
return _5.get(_13,"id");
}
}
return null;
};
var _14=_2("",_d,{_accessor:null,_widgetSpec:null,_promise:null,_state:_d.UNLOADED,_originalPlacement:null,constructor:function(_15,_16,_17){
this._accessor=_15;
this._widgetSpec=_16;
this._originalPlacement=this._widgetSpec.placement;
if(_17){
this._state=_d.LOADING;
this._promise=_17;
_17.then(_3.hitch(this,"_loaded"),_3.hitch(this,this._failLoad));
}
},load:function(){
if(this._state===_d.UNLOADED){
this._state=_d.LOADING;
this._widgetSpec.placement=this._originalPlacement;
this._promise=this._withRuntime(_3.hitch(this,"_loading"),_3.hitch(this,"_failLoad"));
}
},_loading:function(_18){
alert("UNIMPLEMENTED: _loading()");
},_loaded:function(_19){
alert("UNIMPLEMENTED: _loaded()");
},_failLoad:function(){
this._state=_d.ERROR;
_e.error("_WidgetHandleBase - "+this._widgetSpec.componentType+" failed to load (%o): ",this._widgetSpec.definitionUrl);
this._widgetSpec.instanceData.errback.apply(null,arguments);
},unload:function(){
var _1a=this._state;
if(_1a===_d.LOADING||_1a===_d.LOADED){
this._promise.then(_3.hitch(this,"_unload"),_3.hitch(this,"_failUnload"));
}
},_unload:function(_1b){
alert("UNIMPLEMENTED: _unload()");
},_failUnload:function(){
this._state=_d.ERROR;
_e.error("_WidgetHandleBase - "+this._widgetSpec.componentType+" failed to load (%o): ",this._widgetSpec.definitionUrl);
},getState:function(){
return this._state;
},open:function(){
_e.log("open() is deprecated, use load() method instead.");
this.load();
},close:function(){
_e.log("close() is deprecated, use unload() method instead.");
this.unload();
}});
var _1c=_2("",_14,{_widgetId:null,_loading:function(_1d){
return _1d.loadWidgets([_f.cloneSpec(this._widgetSpec)]).then(_3.hitch(this,"_loaded",_1d),_3.hitch(this,"_failLoad"));
},_loaded:function(_1e){
_e.debug("_WidgetHandleImpl - %s loaded successfully: %o",this._widgetSpec.componentType,this._widgetSpec.definitionUrl);
var _1f=_12(this._widgetSpec.placement);
this._widgetId=_1e.getWidgetIdByDomId(_1f);
if(this._widgetId==null){
this._widgetId=this._originalPlacement;
}
this._state=_d.LOADED;
return _1e;
},_unload:function(_20){
var wid=this._widgetId;
if(this._widgetId){
if(this._widgetSpec.componentType=="gadget"){
var w=_20.getWidgetIdByDomId(wid);
wid=(w!=null?w:wid);
}
_20.unLoadWidgets([wid],false);
this._widgetId=null;
this._promise=null;
this._state=_d.UNLOADED;
}
},getWidgetInfo:function(){
var _21=this._state,_22=this;
if(_21===_d.LOADING||_21===_d.LOADED){
return this._promise.then(function(_23){
return _23.getWidgetById(_22._widgetId);
});
}else{
var _24="Unable to call getWidgetInfo() when widget handle is not in loaded state.  State of handle is:  "+this._state;
_e.debug(_24);
var _25=new _11();
_25.reject(_24);
return (_25);
}
},_withRuntime:function(_26,_27){
return new _10(this._accessor.getIRuntime().then(_26,_27));
}});
var _28=_2("",_14,{_gadgetSite:null,_withRuntime:function(_29,_2a){
return new _10(this._accessor.getCommonContainer().then(_29,_2a));
},_execCallback:function(){
try{
var _2b=this._widgetSpec.instanceData||{},_2c=_2b.callback;
if(_2c){
if(_3.isString(_2c)){
_2c=_c.global[_2c];
if(_2c){
_2c();
}
}else{
_2c();
}
}
}
catch(e){
}
}});
var _2d=_2("",_28,{_placement:null,_loading:function(cc){
var _2e=this._widgetSpec,_2f=_2e.instanceData||{},_30=_2f.renderParams||{},_31=_2f.viewParams||{},_32=new _11();
this._placement=_2e.placement;
var _33=this._gadgetSite||(this._gadgetSite=cc.newGadgetSite(_4.byId(_2e.placement)));
var _34=_f.isInlineGadget(_2e),_35=(_34?cc.inline:cc);
if(!_30[osapi.container.RenderParam.VIEW]){
_30[osapi.container.RenderParam.VIEW]="home";
}
_35.navigateGadget(_33,_2e.definitionUrl,_31,_30,_3.hitch(this,"_loaded",cc,_32));
return _32;
},_loaded:function(cc,_36,_37){
if(_37.error){
_36.errback(_37.error);
this._failLoad(_37.error);
}else{
this._state=_d.LOADED;
_36.callback(cc);
this._execCallback(_37);
}
},_unload:function(cc){
cc.closeGadget(this._gadgetSite);
if(this._placement!=null){
this._widgetSpec.placement=this._placement;
}
this._gadgetSite=null;
this._state=_d.UNLOADED;
return null;
}});
var _38=_2("",_28,{_loading:function(cc){
var _39=this._widgetSpec,_3a=_39.instanceData||{},_3b={},_3c=_3a.eeDataModel||{},_3d=new _11();
var _3e=osapi.container.ee.RenderParam;
if(_39.definitionUrl){
_3b[_3e.GADGET_RENDER_PARAMS]=_3a.renderParams||{};
_3b[_3e.GADGET_VIEW_PARAMS]=_3a.viewParams||{};
_3c.gadget=_39.definitionUrl;
}else{
_3b[_3e.URL_RENDER_PARAMS]=_3a.renderParams||{};
}
cc.ee.navigate(_4.byId(_39.placement),_3c,_3b,_3.hitch(this,"_loaded",cc,_3d));
return _3d;
},_loaded:function(cc,_3f,_40,_41){
if(_41&&_41.error){
_3f.errback(_41.error);
this._failLoad(_41.error);
}else{
this._state=_d.LOADED;
this._gadgetSite=_40;
_3f.callback(cc);
this._execCallback(_41);
}
},_unload:function(cc){
cc.ee.close(this._gadgetSite);
this._gadgetSite=null;
this._state=_d.UNLOADED;
return null;
}});
_d.__factory__=function(_42,_43,_44){
if(_f.isInlineEE(_43)){
throw "Inline EE gadgets are not permitted. Attempted to load: ";
}
if(!_44&&_f.isGadget(_43)){
if(_f.isEEGadget(_43)){
return new _38(_42,_43);
}else{
return new _2d(_42,_43);
}
}else{
return new _1c(_42,_43,_44);
}
};
})(_1,_9,_b,_a,_7,_6);
return com.ibm.lconn.gadget.container._Handle;
});


;define("ic-gadget/container/_Container",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","./Container","ic-core/util/promises","ic-core/util/LCDeferred","./Accessor","ic-core/util/LCChainedDeferred","./Handle","./_Handle","../services/people_container","../util/specHelper","../util/trace"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){
(function init_com_ibm_lconn_gadget_container_Container(_e,_f,_10){
var _11=null,_12=_f.normalizeWidgetSpec,_13=_f.cloneSpec;
var _14=_2("",_4,{_accessor:null,constructor:function(_15){
this._accessor=_15;
},loadWidgets:function(_16){
_e.debug("Container's loadWidgets called");
var _17=this._accessor;
if(_16&&_3.isArray(_16)){
var idx=_16.length,_18=null;
var _19=[];
var _1a=[];
var _1b=[];
while(idx--){
_19[idx]=_13(_12(_16[idx]));
_e.debug("_CONTAINER 1 widgetSpecs[idx].placement:  ",_16[idx].placement);
}
function _1c(_1d,_1e){
_1.forEach(_1e,function(_1f,i){
var id=null;
if(_1f.widgetObject.domId){
id=_1f.widgetObject.domId;
}else{
id=_1f.widgetObject.getDomId();
}
var _20=_1b[id];
if(_1f.isError()){
var err=_1f.getError();
_e.error("Error (",_1f.getError().message,") while loading widget: ",_1f);
_20.errback(_1f.getError());
}else{
_20.callback(_1d);
}
});
};
function _21(_22){
_e.error("Error while loading widgets: ",_16);
_1.forEach(_22,function(_23,i){
var _24=_1b[i];
_24.errback(_22);
});
};
function _25(_26){
if(_26&&_26.id){
return _26.id;
}
if(_3.isString(_26)){
return _26;
}
return null;
};
_1.forEach(_16,function(_27){
var _28=new _6();
_1b[_25(_27.placement)]=_28;
_1a.push(_10.__factory__(_17,_27,_28));
});
_17.getIRuntime().then(function(_29){
var _2a=_3.hitch(null,_1c,_29);
_29.loadWidgets(_19).then(_2a,_2a);
},_21);
return _1a;
}else{
throw ("parameter must be an array: "+_16);
}
},loadWidget:function(_2b){
return this.loadWidgets([_2b])[0];
},preloadWidgets:function(_2c){
if(_2c&&_3.isArray(_2c)&&_2c.length>0){
var idx=_2c.length,_2d=null;
while(idx--){
_12(_2c[idx]);
}
return new _8(this._accessor.getIRuntime().then(function(_2e){
return _2e.preloadWidgets(_2c);
},function(_2f){
_e.error("Error (",_2f,") while preloading widgets: ",_2c);
}));
}else{
var _2d=new _6();
_2d.errback("WidgetSpecs is empty, undefined or a non-array type.");
return _2d;
}
},unloadWidgets:function(_30){
_e.debug("Container's unloadWidgets called");
this._accessor.getIRuntime().then(function(_31){
return _31.unLoadWidgets(_30,false);
},function(_32){
_e.error("Error (",_32,") while unloading widgets: ",_30);
});
},getGadgetInfo:function(url){
var _33=new _6();
return new _8(this._accessor.getCommonContainer().then(_3.hitch(this,function(cc){
cc.preloadGadget(url,_3.hitch(this,this._cb,_33,url));
return (_33);
}),_3.hitch(this,function(_34){
_e.error("Error (",_34,") while getting gadget metadata:  ",url);
_33.resolve(null);
})));
},_cb:function(_35,url,_36){
if(_35!=null){
_35.resolve(_36[url]);
}else{
_e.error("Error while getting gadget metadata");
_35.resolve(null);
}
}});
_3.mixin(_4,{__instance__:function(_37){
if(!_11){
_11=new _14(_37);
}
return _11;
}});
})(_d,_c,_9);
return com.ibm.lconn.gadget.container._Container;
});


;define("ic-gadget/container/iContainer2",["dojo","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./Accessor","./Container","./ICActions","./Views","./_Accessor","./_Container","../services/ICActionsContainer","../services/ViewContainer","../util/trace"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){
var _e=_4.getObject("com.ibm.lconn.gadget.container.iContainer2",true);
(function init_com_ibm_lconn_gadget_container_iContainer2(){
var _f=_e,_10=_6,_11=_5,_12=null,_13=null,_14=_d,_15=null,_16=new (_2("",null,{constructor:function(){
}}))();
_15=function(_17,_18){
var _19,_1a,_1b=_f;
for(var i=0,len=_17.length;i<len;i++){
_1a=_17[i];
for(_19 in _1a){
if(!_16[_19]&&_4.isFunction(_1a[_19])){
_1b[_19]=_18(_19);
}
}
}
};
_15([_11.prototype,_10.prototype],function(_1c){
return function(){
var _1d=arguments,_1e=_f.init();
return _1e[_1c].apply(null,_1d);
};
});
_4.mixin(_f,{init:function(_1f){
_14.entering("com.ibm.lconn.gadget.container.iContainer","init",_1f);
_12=_11.__instance__(_1f);
_13=_10.__instance__(_12);
_14.debug("Accessor: ",_12);
_14.debug("Container: ",_13);
_f.init=function(){
return _f;
};
_15([_11.prototype],function(_20){
return _4.hitch(_12,_20);
});
_15([_10.prototype],function(_21){
return _4.hitch(_13,_21);
});
_14.exiting("com.ibm.lconn.gadget.container.iContainer","init",_1f);
return _f;
},views:_8.__instance__(),ICactions:_7.__instance__()});
if(_3.global.__iContainer_skip_init__){
_14.debug("Defering iContainer init.");
}else{
require(["dojo/domReady!"],function(){
var _22=_3.global.__iContainer_defer_init__;
if(_22&&_22.then){
var _23=this;
_22.then(_1.hitch(_23,function(){
_f.init();
}));
}else{
_f.init();
}
});
}
})();
return _e;
});


;define("dojo/i18n!ic-ui/nls/MessageBox", {"showMore":"Show More","SUCCESS":{"a11y_label":"Success:","icon_alt":"Success"},"SHARED_EXTERNAL":{"a11y_label":"Shared externally:","icon_alt":"Shared externally"},"showLess":"Show Less","ERROR":{"a11y_label":"Error:","icon_alt":"Error"},"common":{"close_btn_title":"Close","close_btn_alt":"Close"},"WARNING":{"a11y_label":"Warning:","icon_alt":"Warning"},"INFO":{"a11y_label":"Information:","icon_alt":"Information"}});

;define("dojo/text!ic-ui/templates/MessageBox.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="lotusMessage2" role="alert" aria-live="assertive">\n	<img class="lotusIcon" src="${_blankGif}" alt="${_strings.icon_alt}" data-dojo-attach-point="imgNode">\n	<span class="lotusAltText">${_strings.a11y_label}</span>\n	<div class="lotusMessageBody"><span data-dojo-attach-point="msgBody"></span>\n	\n	<a href="javascript:;" class="${showMoreClass}" data-dojo-attach-point="showMoreNode" data-dojo-attach-event="onclick: showMoreLessClicked">${messages.showMore}</a>\n	<a href="javascript:;" class="lotusHidden" data-dojo-attach-point="showLessNode" data-dojo-attach-event="onclick: showMoreLessClicked">${messages.showLess}</a>\n	<div class="lotusHidden" data-dojo-attach-point="showMoreMessageNode">${msgMore}</div>\n	</div>\n	<a href="javascript:;" class="lotusDelete lotusHidden" role="button" title="${_strings.close_btn_title}" data-dojo-attach-point="closeBtn">\n		<img alt="" src="${_blankGif}" role="presentation">\n		<span class="lotusAltText">X</span> \n	</a>\n</div>\n');

;define("ic-ui/MessageBox",["dojo","dojo/dom-construct","dojo/i18n","dojo/_base/lang","dojo/dom-class","dojo/_base/declare","dojo/dom","dojo/i18n!./nls/MessageBox","dojo/_base/window","dojo/text!./templates/MessageBox.html","dojo/topic","dijit/registry","dijit/_Templated","dijit/_Widget"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){
var _f={ERROR:0,WARNING:1,INFO:2,SUCCESS:3,SHARED_EXTERNAL:4};
var _10=_6("com.ibm.oneui.controls.MessageBox",[_e,_d],{type:_f.ERROR,canClose:false,msg:"",msgMore:"",showMoreClass:"lotusHidden",messages:_8,_strings:{},templateString:_a,msgBody:null,closeBtn:null,imgNode:null,showMoreMessageNode:null,showMoreNode:null,showLessNode:null,focusPostClose:null,buildRendering:function(){
var _11;
for(_11 in _f){
if(_f.hasOwnProperty(_11)){
if(this.type==_f[_11]){
this._strings=_4.mixin({},this.messages[_11],this._strings);
}
}
}
this._strings=_4.mixin({},this.messages.common,this._strings);
if(this.srcNodeRef&&this.srcNodeRef.id){
_c.remove(this.id);
this.id=_c.getUniqueId(this.declaredClass.replace(/\./g,"_"));
_c.add(this);
}
this.srcNodeRef=_2.create("div",{},this.srcNodeRef);
if(this.msgMore){
this.showMoreClass="";
}
this.inherited(arguments);
switch(this.type){
case _f.ERROR:
_5.add(this.imgNode,"lotusIconMsgError");
break;
case _f.WARNING:
_5.add(this.imgNode,"lotusIconMsgWarning");
_5.add(this.domNode,"lotusWarning");
break;
case _f.INFO:
_5.add(this.imgNode,"lotusIconMsgInfo");
_5.add(this.domNode,"lotusInfo");
break;
case _f.SHARED_EXTERNAL:
_5.add(this.imgNode,"lconnIconMsgSharedExternal");
_5.add(this.domNode,"lconnSharedExternal");
break;
default:
_5.add(this.imgNode,"lotusIconMsgSuccess");
_5.add(this.domNode,"lotusSuccess");
break;
}
if(this.msg){
var _12,m=this.msg,n=_7.byId(m);
if(_4.isFunction(m)){
_12=m.call(this,this.d||_9.doc);
}else{
if(n&&n.nodeType){
_12=n;
}else{
if(_4.isString(m)){
_12=_9.doc.createTextNode(m);
}else{
console.warn("MessageBox: msg should be a string, a DOM node or an id of a DOM node, or a function returning a DOM node.");
_12=_1._toDom("<!-- No message -->");
}
}
}
_2.place(_12,this.msgBody,"only");
}
this.containerNode=this.domNode;
},postCreate:function(){
if(this.canClose){
_5.remove(this.closeBtn,"lotusHidden");
this.connect(this.closeBtn,"onclick","close");
}
},close:function(e){
if(e){
e.preventDefault();
e.stopPropagation();
}
_5.add(this.domNode,"lotusHidden");
if(this.focusPostClose){
setTimeout(_4.partial(dijit.focus,this.focusPostClose),100);
}
this.onClose();
},onClose:function(){
_b.publish("ic-ui/message/closed",this);
this.destroy();
},showMoreLessClicked:function(){
_5.toggle(this.showMoreMessageNode,"lotusHidden");
_5.toggle(this.showMoreNode,"lotusHidden");
_5.toggle(this.showLessNode,"lotusHidden");
}});
_4.mixin(_10,{TYPE:_f});
return _10;
});


;define("ic-core/back",["dojo","dojo/_base/lang","dojo/_base/window","dojo/dom","dojo/dom-construct","dojo/dom-style","dojo/has"],function(_1,_2,_3,_4,_5,_6,_7){
var _8=_3.global;
function _9(){
var _a=_1.getObject("ic-share.fileviewer.FileViewer.shouldIgnoreUrlChange");
if(_a){
return _a();
}
return false;
};
var _b=function(){
var _c=_8.location.hash;
var _d=true;
var _e=true;
var _f=true;
var _10="lc.iframeElement";
var _11=null;
var _12=null;
var _13=null;
var _14=function(){
_c=_8.location.hash;
_d=_13.search;
_e=false;
_f=null;
};
var _15=function(){
if(_8.lconn.core.WidgetPlacement.URLChangeCallBack!=null){
for(var i=0;i<_8.lconn.core.WidgetPlacement.URLChangeCallBack.length;i++){
_8.lconn.core.WidgetPlacement.URLChangeCallBack[i](_8.location.href);
}
}
};
var _16=function(){
var _17=_5.create("iframe");
var uri=require.toUrl(location.href);
_17.id=_10;
var _18=_8.WidgetPlacementConfig.params.contextRoot+"/static/"+_8.WidgetPlacementConfig.params.version;
if(_7("ie")){
_17.src=(_18+"/nav/blankIE.html"+(uri.fragment?"?"+uri.fragment:""));
}else{
_17.src=(_18+"/nav/Blank.html"+(uri.fragment?"?"+uri.fragment:""));
}
_6.set(_17,"display","none");
_5.place(_17,_8.document.body,"last");
return _17;
};
var _19=function(uri,_1a){
_1b(uri,"uri");
_1b(_1a,"queryString");
return _1c(uri,"?",_1a);
};
var _1d=function(uri,_1e){
_1b(uri,"uri");
_1b(_1e,"fragmentString");
return _1c(uri,"#",_1e);
};
var _1b=function(_1f,_20){
if(_1f!=null){
return;
}
if(_20){
throw new Error(_20+" cannot be null");
}
throw new Error("value cannot be null");
};
var _21=function(_22,_23){
if(!(_2.trim(_22).length==0)){
return;
}
if(_23){
throw new Error(_23+" must be a non-empty string.  Saw: "+_22);
}
throw new Error("value must be a non-empty string.  Saw: "+_22);
};
var _1c=function(_24,_25,_26){
_1b(_25,"token");
_1b(_24,"string");
_1b(_26,"replacement");
if(_24.indexOf(_25)==-1){
return _24+_25+_26;
}
return _24.slice(0,_24.indexOf(_25)+1)+_26;
};
if(_7("ie")){
_16();
_11=_8[_10];
_12=_4.byId(_10);
_13=_11.location;
_14();
var _27=function(){
if(_e&&_c==_8.location.hash){
if(_13.search==_f){
_14();
}
return;
}
if(_c==_8.location.hash&&_d==_13.search){
return;
}
if(_c!=_8.location.hash){
_c=_8.location.hash;
if(_9()){
return;
}
var _28=require.toUrl(_8.location.href);
_e=true;
_f=_19(_13.search,_28.fragment||"");
_12.src=_19(_12.src,_28.fragment||"");
return _15();
}else{
var _29=require.toUrl(_13.href);
_8.location.href=_1d(_8.location.href,_29.query||"");
_14();
return _15();
}
};
_8.setInterval(_27,500);
}else{
var _27=function(){
if(_8.location.hash==_c){
return;
}
_c=_8.location.hash;
if(_9()){
return;
}
return _15();
};
_8.setInterval(_27,500);
}
};
_8.registerBackButtonSupport=_b;
return _8;
});


;define("dojo/i18n!ic-core/paletteOneUI/nls/dndAvatar", {"TITLE_CREATE_WIDGET":"Creating widget","ADD_WIDGET":"Release mouse to add widget to the page","MOVE_WIDGET":"Release mouse to drop widget","CANNOT_DROP_WIDGET":"Widget cannot be dropped here","TITLE_MOVE_WIDGET":"Moving widget","CANNOT_ADD_WIDGET":"Widget cannot be added here"});

;define("ic-core/paletteOneUI/dnd/avatar",["dojo","dojo/_base/declare","dojo/_base/window","dojo/dnd/Avatar","dojo/dnd/common","dojo/dom-class","dojo/i18n","dojo/i18n!ic-core/paletteOneUI/nls/dndAvatar","dojo/string"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
var _a=_2("lconn.dboard.dnd.avatar",_4,{_bodyNode:null,_titleNode:null,_draggedWidgetData:null,_isPaletteItem:null,_resourceBundle:null,construct:function(){
this._resourceBundle=_8;
if(this.manager.nodes.length){
this._isPaletteItem=_6.contains(this.manager.nodes[0],"paletteItem");
var _b=this.manager.source;
this._draggedWidgetData=_b.getItem(this.manager.nodes[0].id).data;
this.node=_3.doc.createElement("div");
_6.add(this.node,"idbc");
this._titleNode=_3.doc.createElement("div");
_6.add(this._titleNode,"idbt");
if(this._isPaletteItem){
this._titleNode.innerHTML=_9.substitute(this._resourceBundle.TITLE_CREATE_WIDGET,[this._draggedWidgetData]);
}else{
this._titleNode.innerHTML=_9.substitute(this._resourceBundle.TITLE_MOVE_WIDGET,[this._draggedWidgetData]);
}
this._bodyNode=_3.doc.createElement("div");
_6.add(this._bodyNode,"idbi");
this.node.appendChild(this._titleNode);
this.node.appendChild(this._bodyNode);
this.node.style.position="absolute";
this.node.style.zIndex=1999;
this.update();
}
},update:function(){
var _c=require.toUrl("ic-core/paletteOneUI/dnd/cannotDrop.gif?etag=Z6uKNXK").toString();
var _d=require.toUrl("ic-core/paletteOneUI/dnd/okDrop.gif?etag=Z6uKNXK").toString();
if(this._isPaletteItem){
if(this.manager.canDropFlag){
var _e="<img src='"+_d+"'></img>";
this._bodyNode.innerHTML=_e+" "+_9.substitute(this._resourceBundle.ADD_WIDGET,[this._draggedWidgetData]);
}else{
var _e="<img src='"+_c+"'></img>";
this._bodyNode.innerHTML=_e+" "+_9.substitute(this._resourceBundle.CANNOT_ADD_WIDGET,[this._draggedWidgetData]);
}
}else{
if(this.manager.canDropFlag){
var _e="<img src='"+_d+"'></img>";
this._bodyNode.innerHTML=_e+" "+_9.substitute(this._resourceBundle.MOVE_WIDGET,[this._draggedWidgetData]);
}else{
var _e="<img src='"+_c+"'></img>";
this._bodyNode.innerHTML=_e+" "+_9.substitute(this._resourceBundle.CANNOT_DROP_WIDGET,[this._draggedWidgetData]);
}
}
}});
return _a;
});


;define("dojo/dnd/Container",["../_base/array","../_base/declare","../_base/kernel","../_base/lang","../_base/window","../dom","../dom-class","../dom-construct","../Evented","../has","../on","../query","../touch","./common"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,on,_b,_c,_d){
var _e=_2("dojo.dnd.Container",_9,{skipForm:false,allowNested:false,constructor:function(_f,_10){
this.node=_6.byId(_f);
if(!_10){
_10={};
}
this.creator=_10.creator||null;
this.skipForm=_10.skipForm;
this.parent=_10.dropParent&&_6.byId(_10.dropParent);
this.map={};
this.current=null;
this.containerState="";
_7.add(this.node,"dojoDndContainer");
if(!(_10&&_10._skipStartup)){
this.startup();
}
this.events=[on(this.node,_c.over,_4.hitch(this,"onMouseOver")),on(this.node,_c.out,_4.hitch(this,"onMouseOut")),on(this.node,"dragstart",_4.hitch(this,"onSelectStart")),on(this.node,"selectstart",_4.hitch(this,"onSelectStart"))];
},creator:function(){
},getItem:function(key){
return this.map[key];
},setItem:function(key,_11){
this.map[key]=_11;
},delItem:function(key){
delete this.map[key];
},forInItems:function(f,o){
o=o||_3.global;
var m=this.map,e=_d._empty;
for(var i in m){
if(i in e){
continue;
}
f.call(o,m[i],i,this);
}
return o;
},clearItems:function(){
this.map={};
},getAllNodes:function(){
return _b((this.allowNested?"":"> ")+".dojoDndItem",this.parent);
},sync:function(){
var map={};
this.getAllNodes().forEach(function(_12){
if(_12.id){
var _13=this.getItem(_12.id);
if(_13){
map[_12.id]=_13;
return;
}
}else{
_12.id=_d.getUniqueId();
}
var _14=_12.getAttribute("dndType"),_15=_12.getAttribute("dndData");
map[_12.id]={data:_15||_12.innerHTML,type:_14?_14.split(/\s*,\s*/):["text"]};
},this);
this.map=map;
return this;
},insertNodes:function(_16,_17,_18){
if(!this.parent.firstChild){
_18=null;
}else{
if(_17){
if(!_18){
_18=this.parent.firstChild;
}
}else{
if(_18){
_18=_18.nextSibling;
}
}
}
var i,t;
if(_18){
for(i=0;i<_16.length;++i){
t=this._normalizedCreator(_16[i]);
this.setItem(t.node.id,{data:t.data,type:t.type});
_18.parentNode.insertBefore(t.node,_18);
}
}else{
for(i=0;i<_16.length;++i){
t=this._normalizedCreator(_16[i]);
this.setItem(t.node.id,{data:t.data,type:t.type});
this.parent.appendChild(t.node);
}
}
return this;
},destroy:function(){
_1.forEach(this.events,function(_19){
_19.remove();
});
this.clearItems();
this.node=this.parent=this.current=null;
},markupFactory:function(_1a,_1b,_1c){
_1a._skipStartup=true;
return new _1c(_1b,_1a);
},startup:function(){
if(!this.parent){
this.parent=this.node;
if(this.parent.tagName.toLowerCase()=="table"){
var c=this.parent.getElementsByTagName("tbody");
if(c&&c.length){
this.parent=c[0];
}
}
}
this.defaultCreator=_d._defaultCreator(this.parent);
this.sync();
},onMouseOver:function(e){
var n=e.relatedTarget;
while(n){
if(n==this.node){
break;
}
try{
n=n.parentNode;
}
catch(x){
n=null;
}
}
if(!n){
this._changeState("Container","Over");
this.onOverEvent();
}
n=this._getChildByEvent(e);
if(this.current==n){
return;
}
if(this.current){
this._removeItemClass(this.current,"Over");
}
if(n){
this._addItemClass(n,"Over");
}
this.current=n;
},onMouseOut:function(e){
for(var n=e.relatedTarget;n;){
if(n==this.node){
return;
}
try{
n=n.parentNode;
}
catch(x){
n=null;
}
}
if(this.current){
this._removeItemClass(this.current,"Over");
this.current=null;
}
this._changeState("Container","");
this.onOutEvent();
},onSelectStart:function(e){
if(!this.skipForm||!_d.isFormElement(e)){
e.stopPropagation();
e.preventDefault();
}
},onOverEvent:function(){
},onOutEvent:function(){
},_changeState:function(_1d,_1e){
var _1f="dojoDnd"+_1d;
var _20=_1d.toLowerCase()+"State";
_7.replace(this.node,_1f+_1e,_1f+this[_20]);
this[_20]=_1e;
},_addItemClass:function(_21,_22){
_7.add(_21,"dojoDndItem"+_22);
},_removeItemClass:function(_23,_24){
_7.remove(_23,"dojoDndItem"+_24);
},_getChildByEvent:function(e){
var _25=e.target;
if(_25){
for(var _26=_25.parentNode;_26;_25=_26,_26=_25.parentNode){
if((_26==this.parent||this.allowNested)&&_7.contains(_25,"dojoDndItem")){
return _25;
}
}
}
return null;
},_normalizedCreator:function(_27,_28){
var t=(this.creator||this.defaultCreator).call(this,_27,_28);
if(!_4.isArray(t.type)){
t.type=["text"];
}
if(!t.node.id){
t.node.id=_d.getUniqueId();
}
_7.add(t.node,"dojoDndItem");
return t;
}});
_d._createNode=function(tag){
if(!tag){
return _d._createSpan;
}
return function(_29){
return _8.create(tag,{innerHTML:_29});
};
};
_d._createTrTd=function(_2a){
var tr=_8.create("tr");
_8.create("td",{innerHTML:_2a},tr);
return tr;
};
_d._createSpan=function(_2b){
return _8.create("span",{innerHTML:_2b});
};
_d._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};
_d._defaultCreator=function(_2c){
var tag=_2c.tagName.toLowerCase();
var c=tag=="tbody"||tag=="thead"?_d._createTrTd:_d._createNode(_d._defaultCreatorNodes[tag]);
return function(_2d,_2e){
var _2f=_2d&&_4.isObject(_2d),_30,_31,n;
if(_2f&&_2d.tagName&&_2d.nodeType&&_2d.getAttribute){
_30=_2d.getAttribute("dndData")||_2d.innerHTML;
_31=_2d.getAttribute("dndType");
_31=_31?_31.split(/\s*,\s*/):["text"];
n=_2d;
}else{
_30=(_2f&&_2d.data)?_2d.data:_2d;
_31=(_2f&&_2d.type)?_2d.type:["text"];
n=(_2e=="avatar"?_d._createSpan:c)(String(_30));
}
if(!n.id){
n.id=_d.getUniqueId();
}
return {node:n,data:_30,type:_31};
};
};
return _e;
});


;define("dojo/dnd/Selector",["../_base/array","../_base/declare","../_base/kernel","../_base/lang","../dom","../dom-construct","../mouse","../_base/NodeList","../on","../touch","./common","./Container"],function(_1,_2,_3,_4,_5,_6,_7,_8,on,_9,_a,_b){
var _c=_2("dojo.dnd.Selector",_b,{constructor:function(_d,_e){
if(!_e){
_e={};
}
this.singular=_e.singular;
this.autoSync=_e.autoSync;
this.selection={};
this.anchor=null;
this.simpleSelection=false;
this.events.push(on(this.node,_9.press,_4.hitch(this,"onMouseDown")),on(this.node,_9.release,_4.hitch(this,"onMouseUp")));
},singular:false,getSelectedNodes:function(){
var t=new _8();
var e=_a._empty;
for(var i in this.selection){
if(i in e){
continue;
}
t.push(_5.byId(i));
}
return t;
},selectNone:function(){
return this._removeSelection()._removeAnchor();
},selectAll:function(){
this.forInItems(function(_f,id){
this._addItemClass(_5.byId(id),"Selected");
this.selection[id]=1;
},this);
return this._removeAnchor();
},deleteSelectedNodes:function(){
var e=_a._empty;
for(var i in this.selection){
if(i in e){
continue;
}
var n=_5.byId(i);
this.delItem(i);
_6.destroy(n);
}
this.anchor=null;
this.selection={};
return this;
},forInSelectedItems:function(f,o){
o=o||_3.global;
var s=this.selection,e=_a._empty;
for(var i in s){
if(i in e){
continue;
}
f.call(o,this.getItem(i),i,this);
}
},sync:function(){
_c.superclass.sync.call(this);
if(this.anchor){
if(!this.getItem(this.anchor.id)){
this.anchor=null;
}
}
var t=[],e=_a._empty;
for(var i in this.selection){
if(i in e){
continue;
}
if(!this.getItem(i)){
t.push(i);
}
}
_1.forEach(t,function(i){
delete this.selection[i];
},this);
return this;
},insertNodes:function(_10,_11,_12,_13){
var _14=this._normalizedCreator;
this._normalizedCreator=function(_15,_16){
var t=_14.call(this,_15,_16);
if(_10){
if(!this.anchor){
this.anchor=t.node;
this._removeItemClass(t.node,"Selected");
this._addItemClass(this.anchor,"Anchor");
}else{
if(this.anchor!=t.node){
this._removeItemClass(t.node,"Anchor");
this._addItemClass(t.node,"Selected");
}
}
this.selection[t.node.id]=1;
}else{
this._removeItemClass(t.node,"Selected");
this._removeItemClass(t.node,"Anchor");
}
return t;
};
_c.superclass.insertNodes.call(this,_11,_12,_13);
this._normalizedCreator=_14;
return this;
},destroy:function(){
_c.superclass.destroy.call(this);
this.selection=this.anchor=null;
},onMouseDown:function(e){
if(this.autoSync){
this.sync();
}
if(!this.current){
return;
}
if(!this.singular&&!_a.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){
this.simpleSelection=true;
if(_7.isLeft(e)){
e.stopPropagation();
e.preventDefault();
}
return;
}
if(!this.singular&&e.shiftKey){
if(!_a.getCopyKeyState(e)){
this._removeSelection();
}
var c=this.getAllNodes();
if(c.length){
if(!this.anchor){
this.anchor=c[0];
this._addItemClass(this.anchor,"Anchor");
}
this.selection[this.anchor.id]=1;
if(this.anchor!=this.current){
var i=0,_17;
for(;i<c.length;++i){
_17=c[i];
if(_17==this.anchor||_17==this.current){
break;
}
}
for(++i;i<c.length;++i){
_17=c[i];
if(_17==this.anchor||_17==this.current){
break;
}
this._addItemClass(_17,"Selected");
this.selection[_17.id]=1;
}
this._addItemClass(this.current,"Selected");
this.selection[this.current.id]=1;
}
}
}else{
if(this.singular){
if(this.anchor==this.current){
if(_a.getCopyKeyState(e)){
this.selectNone();
}
}else{
this.selectNone();
this.anchor=this.current;
this._addItemClass(this.anchor,"Anchor");
this.selection[this.current.id]=1;
}
}else{
if(_a.getCopyKeyState(e)){
if(this.anchor==this.current){
delete this.selection[this.anchor.id];
this._removeAnchor();
}else{
if(this.current.id in this.selection){
this._removeItemClass(this.current,"Selected");
delete this.selection[this.current.id];
}else{
if(this.anchor){
this._removeItemClass(this.anchor,"Anchor");
this._addItemClass(this.anchor,"Selected");
}
this.anchor=this.current;
this._addItemClass(this.current,"Anchor");
this.selection[this.current.id]=1;
}
}
}else{
if(!(this.current.id in this.selection)){
this.selectNone();
this.anchor=this.current;
this._addItemClass(this.current,"Anchor");
this.selection[this.current.id]=1;
}
}
}
}
e.stopPropagation();
e.preventDefault();
},onMouseUp:function(){
if(!this.simpleSelection){
return;
}
this.simpleSelection=false;
this.selectNone();
if(this.current){
this.anchor=this.current;
this._addItemClass(this.anchor,"Anchor");
this.selection[this.current.id]=1;
}
},onMouseMove:function(){
this.simpleSelection=false;
},onOverEvent:function(){
this.onmousemoveEvent=on(this.node,_9.move,_4.hitch(this,"onMouseMove"));
},onOutEvent:function(){
if(this.onmousemoveEvent){
this.onmousemoveEvent.remove();
delete this.onmousemoveEvent;
}
},_removeSelection:function(){
var e=_a._empty;
for(var i in this.selection){
if(i in e){
continue;
}
var _18=_5.byId(i);
if(_18){
this._removeItemClass(_18,"Selected");
}
}
this.selection={};
return this;
},_removeAnchor:function(){
if(this.anchor){
this._removeItemClass(this.anchor,"Anchor");
this.anchor=null;
}
return this;
}});
return _c;
});


;define("dojo/dnd/Source",["../_base/array","../_base/declare","../_base/kernel","../_base/lang","../dom-class","../dom-geometry","../mouse","../ready","../topic","./common","./Selector","./Manager","jazz/inverted!./AutoSource","jazz/inverted!./Target"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
var _d=_2("dojo.dnd.Source",_b,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(_e,_f){
_4.mixin(this,_4.mixin({},_f));
var _10=this.accept;
if(_10.length){
this.accept={};
for(var i=0;i<_10.length;++i){
this.accept[_10[i]]=1;
}
}
this.isDragging=false;
this.mouseDown=false;
this.targetAnchor=null;
this.targetBox=null;
this.before=true;
this._lastX=0;
this._lastY=0;
this.sourceState="";
if(this.isSource){
_5.add(this.node,"dojoDndSource");
}
this.targetState="";
if(this.accept){
_5.add(this.node,"dojoDndTarget");
}
if(this.horizontal){
_5.add(this.node,"dojoDndHorizontal");
}
this.topics=[_9.subscribe("/dnd/source/over",_4.hitch(this,"onDndSourceOver")),_9.subscribe("/dnd/start",_4.hitch(this,"onDndStart")),_9.subscribe("/dnd/drop",_4.hitch(this,"onDndDrop")),_9.subscribe("/dnd/cancel",_4.hitch(this,"onDndCancel"))];
},checkAcceptance:function(_11,_12){
if(this==_11){
return !this.copyOnly||this.selfAccept;
}
for(var i=0;i<_12.length;++i){
var _13=_11.getItem(_12[i].id).type;
var _14=false;
for(var j=0;j<_13.length;++j){
if(_13[j] in this.accept){
_14=true;
break;
}
}
if(!_14){
return false;
}
}
return true;
},copyState:function(_15,_16){
if(_15){
return true;
}
if(arguments.length<2){
_16=this==_c.manager().target;
}
if(_16){
if(this.copyOnly){
return this.selfCopy;
}
}else{
return this.copyOnly;
}
return false;
},destroy:function(){
_d.superclass.destroy.call(this);
_1.forEach(this.topics,function(t){
t.remove();
});
this.targetAnchor=null;
},onMouseMove:function(e){
if(this.isDragging&&this.targetState=="Disabled"){
return;
}
_d.superclass.onMouseMove.call(this,e);
var m=_c.manager();
if(!this.isDragging){
if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){
var _17=this.getSelectedNodes();
if(_17.length){
m.startDrag(this,_17,this.copyState(_a.getCopyKeyState(e),true));
}
}
}
if(this.isDragging){
var _18=false;
if(this.current){
if(!this.targetBox||this.targetAnchor!=this.current){
this.targetBox=_6.position(this.current,true);
}
if(this.horizontal){
_18=(e.pageX-this.targetBox.x<this.targetBox.w/2)==_6.isBodyLtr(this.current.ownerDocument);
}else{
_18=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);
}
}
if(this.current!=this.targetAnchor||_18!=this.before){
this._markTargetAnchor(_18);
m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));
}
}
},onMouseDown:function(e){
if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!_a.isFormElement(e))){
this.mouseDown=true;
this._lastX=e.pageX;
this._lastY=e.pageY;
_d.superclass.onMouseDown.call(this,e);
}
},onMouseUp:function(e){
if(this.mouseDown){
this.mouseDown=false;
_d.superclass.onMouseUp.call(this,e);
}
},onDndSourceOver:function(_19){
if(this!==_19){
this.mouseDown=false;
if(this.targetAnchor){
this._unmarkTargetAnchor();
}
}else{
if(this.isDragging){
var m=_c.manager();
m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));
}
}
},onDndStart:function(_1a,_1b,_1c){
if(this.autoSync){
this.sync();
}
if(this.isSource){
this._changeState("Source",this==_1a?(_1c?"Copied":"Moved"):"");
}
var _1d=this.accept&&this.checkAcceptance(_1a,_1b);
this._changeState("Target",_1d?"":"Disabled");
if(this==_1a){
_c.manager().overSource(this);
}
this.isDragging=true;
},onDndDrop:function(_1e,_1f,_20,_21){
if(this==_21){
this.onDrop(_1e,_1f,_20);
}
this.onDndCancel();
},onDndCancel:function(){
if(this.targetAnchor){
this._unmarkTargetAnchor();
this.targetAnchor=null;
}
this.before=true;
this.isDragging=false;
this.mouseDown=false;
this._changeState("Source","");
this._changeState("Target","");
},onDrop:function(_22,_23,_24){
if(this!=_22){
this.onDropExternal(_22,_23,_24);
}else{
this.onDropInternal(_23,_24);
}
},onDropExternal:function(_25,_26,_27){
var _28=this._normalizedCreator;
if(this.creator){
this._normalizedCreator=function(_29,_2a){
return _28.call(this,_25.getItem(_29.id).data,_2a);
};
}else{
if(_27){
this._normalizedCreator=function(_2b){
var t=_25.getItem(_2b.id);
var n=_2b.cloneNode(true);
n.id=_a.getUniqueId();
return {node:n,data:t.data,type:t.type};
};
}else{
this._normalizedCreator=function(_2c){
var t=_25.getItem(_2c.id);
_25.delItem(_2c.id);
return {node:_2c,data:t.data,type:t.type};
};
}
}
this.selectNone();
if(!_27&&!this.creator){
_25.selectNone();
}
this.insertNodes(true,_26,this.before,this.current);
if(!_27&&this.creator){
_25.deleteSelectedNodes();
}
this._normalizedCreator=_28;
},onDropInternal:function(_2d,_2e){
var _2f=this._normalizedCreator;
if(this.current&&this.current.id in this.selection){
return;
}
if(_2e){
if(this.creator){
this._normalizedCreator=function(_30,_31){
return _2f.call(this,this.getItem(_30.id).data,_31);
};
}else{
this._normalizedCreator=function(_32){
var t=this.getItem(_32.id);
var n=_32.cloneNode(true);
n.id=_a.getUniqueId();
return {node:n,data:t.data,type:t.type};
};
}
}else{
if(!this.current){
return;
}
this._normalizedCreator=function(_33){
var t=this.getItem(_33.id);
return {node:_33,data:t.data,type:t.type};
};
}
this._removeSelection();
this.insertNodes(true,_2d,this.before,this.current);
this._normalizedCreator=_2f;
},onDraggingOver:function(){
},onDraggingOut:function(){
},onOverEvent:function(){
_d.superclass.onOverEvent.call(this);
_c.manager().overSource(this);
if(this.isDragging&&this.targetState!="Disabled"){
this.onDraggingOver();
}
},onOutEvent:function(){
_d.superclass.onOutEvent.call(this);
_c.manager().outSource(this);
if(this.isDragging&&this.targetState!="Disabled"){
this.onDraggingOut();
}
},_markTargetAnchor:function(_34){
if(this.current==this.targetAnchor&&this.before==_34){
return;
}
if(this.targetAnchor){
this._removeItemClass(this.targetAnchor,this.before?"Before":"After");
}
this.targetAnchor=this.current;
this.targetBox=null;
this.before=_34;
if(this.targetAnchor){
this._addItemClass(this.targetAnchor,this.before?"Before":"After");
}
},_unmarkTargetAnchor:function(){
if(!this.targetAnchor){
return;
}
this._removeItemClass(this.targetAnchor,this.before?"Before":"After");
this.targetAnchor=null;
this.targetBox=null;
this.before=true;
},_markDndStatus:function(_35){
this._changeState("Source",_35?"Copied":"Moved");
},_legalMouseDown:function(e){
if(e.type!="touchstart"&&!_7.isLeft(e)){
return false;
}
if(!this.withHandles){
return true;
}
for(var _36=e.target;_36&&_36!==this.node;_36=_36.parentNode){
if(_5.contains(_36,"dojoDndHandle")){
return true;
}
if(_5.contains(_36,"dojoDndItem")||_5.contains(_36,"dojoDndIgnore")){
break;
}
}
return false;
}});
return _d;
});


;define("dojo/dnd/AutoSource",["../_base/declare","./Source"],function(_1,_2){
return _1("dojo.dnd.AutoSource",_2,{constructor:function(){
this.autoSync=true;
}});
});


;define("dojo/dnd/Target",["../_base/declare","../dom-class","./Source"],function(_1,_2,_3){
return _1("dojo.dnd.Target",_3,{constructor:function(){
this.isSource=false;
_2.remove(this.node,"dojoDndSource");
}});
});


;define("ic-core/dnd/Source",["dojo","dojo/_base/declare","dojo/_base/window","dojo/dnd/Source","dojo/dom-class","dojo/has","dojo/query","dojo/topic"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _4=_2("lconn.core.dnd.Source",_4,{isCursorNorthNode:function(_9,_a){
var _b=_1.coords(_9,true);
var _c=_9.offsetHeight;
return ((_a.pageY-_b.y)<(_c/2));
},_children:null,_changeState:function(_d,_e){
var _f=_d.toLowerCase()+"State";
this[_f]=_e;
},_addItemClass:function(_10,_11){
},_removeItemClass:function(_12,_13){
},getInsertPosition:function(e){
var pos=-1;
var _14=false;
var _15=[];
for(var i=0;i<this._children.length;i++){
if(this._children[i].style.display!="none"){
_15.push(this._children[i]);
}
}
var _16=_15.length-1;
if(_15.length>0){
if(this.isCursorNorthNode(_15[0],e)){
pos=0;
_14=true;
}else{
if(!this.isCursorNorthNode(_15[_16],e)){
pos=_16;
_14=false;
}else{
for(var i=0;i<_16;i++){
if(!this.isCursorNorthNode(_15[i],e)&&this.isCursorNorthNode(_15[i+1],e)){
pos=i;
_14=false;
break;
}
}
}
}
return [_15[pos],_14];
}else{
return [null,false];
}
},placeIndicator:function(_17,_18){
if(this.dropIndicator&&this.dropIndicator.parentNode){
this.dropIndicator.parentNode.removeChild(this.dropIndicator);
}
if(_17==null){
this.node.appendChild(this.dropIndicator);
}else{
if(_18){
_17.parentNode.insertBefore(this.dropIndicator,_17);
}else{
if(_17.parentNode.lastChild==_17){
this.node.appendChild(this.dropIndicator);
}else{
_17.parentNode.insertBefore(this.dropIndicator,_17.nextSibling);
}
}
}
},createDropIndicator:function(){
var _19=7;
this.dropIndicator=document.createElement("div");
this.dropIndicator.style.borderWidth="2px";
this.dropIndicator.style.borderColor="gray";
this.dropIndicator.style.borderStyle="dashed";
this.dropIndicator.style.cursor="default";
this.dropIndicator.style.height=_1.marginBox(_1.dnd.manager().avatar.node).h+"px";
this.dropIndicator.style.width=_1.marginBox(this.node).w-_19+"px";
},onDndStart:function(_1a,_1b,_1c){
_3.body().onselectstart=function(){
return false;
};
_3.body().unselectable="on";
lconn.core.dnd.Source.superclass.onDndStart.apply(this,arguments);
this._children=_7("> .dojoDndItem",this.parent);
this.threshold=5;
_1b[0].style.display="none";
},onMouseDown:function(e){
if(!this.current){
return;
}
var _1d=_7(".ibmDndDragHandle",this.current);
if(_1d.length){
if(e.target!=_1d[0]){
_8.publish("/dnd/cancel");
return;
}
}
lconn.core.dnd.Source.superclass.onMouseDown.apply(this,arguments);
},onMouseOver:function(e){
lconn.core.dnd.Source.superclass.onMouseOver.apply(this,arguments);
if(!this.isDragging){
var _1e=_7(".ibmDndDragHandle",this.current);
if(_1e.length){
if(e.target==_1e[0]){
_5.add(e.target,"ibmDndDragHandleOver");
}
}
}
},onMouseOut:function(e){
lconn.core.dnd.Source.superclass.onMouseOut.apply(this,arguments);
var _1f=_7(".ibmDndDragHandle",this.current);
if(_1f.length){
if(e.target==_1f[0]){
_5.remove(e.target,"ibmDndDragHandleOver");
}
}
},onDndDrop:function(_20,_21,_22){
var _23=this.current;
this.current=this.dropIndicator;
lconn.core.dnd.Source.superclass.onDndDrop.apply(this,arguments);
this.current=_23;
if(this.containerState=="Over"){
_8.publish("/ic-core/dnd/drop",_20.node,this.node,_21[0]);
}
_3.body().onselectstart=null;
_3.body().unselectable="off";
_1.dnd.manager().canDropFlag=false;
},insertNodes:function(_24,_25,_26,_27){
if(_25.length){
for(var i=0;i<_25.length;i++){
_25[i].style.display="";
}
}
lconn.core.dnd.Source.superclass.insertNodes.apply(this,arguments);
},deleteDropIndicator:function(){
if(this.dropIndicator&&this.dropIndicator.parentNode){
this.dropIndicator.parentNode.removeChild(this.dropIndicator);
this.dropIndicator=null;
}
this.pos=null;
},onDndCancel:function(){
this.deleteDropIndicator();
if(!this.flagNotHide){
var m=_1.dnd.manager();
for(var i=0;i<m.nodes.length;i++){
m.nodes[i].style.display="block";
}
}
_1.dnd.manager().canDropFlag=false;
lconn.core.dnd.Source.superclass.onDndCancel.call(this);
},onOutEvent:function(){
this.deleteDropIndicator();
this.flag=true;
lconn.core.dnd.Source.superclass.onOutEvent.call(this);
},pos:null,threshold:null,mutex:0,onMouseMove:function(e){
if(this.mutex!=0){
return;
}
if(this.isDragging&&this.targetState=="Disabled"){
return;
}
_4.superclass.onMouseMove.call(this,e);
var m=_1.dnd.manager();
if(!this.isDragging){
if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){
var _28=this.getSelectedNodes();
if(_28.length){
m.startDrag(this,_28,this.copyState(_6("copykey")(e),true));
this.flag=true;
}
}
}
if(this.isDragging){
this.threshold++;
if(this.threshold>=5){
try{
this.mutex++;
var _29=false;
if(this.current){
if(!this.targetBox||this.targetAnchor!=this.current){
this.targetBox={xy:_1.coords(this.current,true),w:this.current.offsetWidth,h:this.current.offsetHeight,id:this.current.id};
}
if(this.horizontal){
_29=(e.pageX-this.targetBox.xy.x)<(this.targetBox.w/2);
}else{
_29=(e.pageY-this.targetBox.xy.y)<(this.targetBox.h/2);
}
}
if((e.target!=this.dropIndicator)){
var pos=this.getInsertPosition(e);
if(!this.pos||pos[0]!=this.pos[0]||pos[1]!=this.pos[1]){
this.deleteDropIndicator();
this.createDropIndicator();
this.placeIndicator(pos[0],pos[1]);
this.pos=pos;
}
}
if(this.current!=this.targetAnchor||_29!=this.before){
this._markTargetAnchor(_29);
m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));
}
}
catch(e){
}
finally{
this.threshold=0;
this.mutex--;
}
}
}
}});
return _4;
});


;define("ic-core/paletteOneUI/dnd/Source",["dojo","dojo/_base/declare","dojo/_base/window","dojo/dom-class","dojo/topic","ic-core/dnd/Source"],function(_1,_2,_3,_4,_5,_6){
var _6=_2("lconn.dboard.dnd.Source",_6,{flagNotHide:false,isPalette:false,checkAcceptance:function(_7,_8){
if(this.isPalette){
return false;
}else{
return lconn.dboard.dnd.Source.superclass.checkAcceptance.apply(this,arguments);
}
},onDndDrop:function(_9,_a,_b){
if(this.containerState=="Over"&&_4.contains(_a[0],"paletteItem")){
_5.publish("/lconn/dboard/dropPaletteItem",_a[0],this.dropIndicator,this.node);
this.deleteDropIndicator();
_6.superclass.onDndCancel.call(this);
}else{
if(_4.contains(_a[0],"paletteItem")){
this.flagNotHide=true;
}
var _c=this.current;
this.current=this.dropIndicator;
lconn.dboard.dnd.Source.superclass.onDndDrop.apply(this,arguments);
this.flagNotHide=false;
this.current=_c;
if(this.containerState=="Over"){
_5.publish("/lconn/dboard/dnd/drop",_9.node,this.node,_a[0]);
}
}
_3.body().onselectstart=null;
_3.body().unselectable="off";
_1.dnd.manager().canDropFlag=false;
}});
return _6;
});


;define("ic-core/xpath",["dojo/has"],function(_1){
var _2={};
var _3=function(_4,_5){
var x;
for(x=0;x<_4.length;x++){
if(_5==_4[x].prefix){
return _4[x].nameSpaceURI;
}
}
return null;
};
var _6=function(_7,_8){
var _9="",x;
for(x=0;_8!=null&&x<_8.length;x++){
_9+="xmlns:"+_8[x].prefix+"='"+_8[x].nameSpaceURI+"' ";
}
if(_9!=""&&(_1("ie")||_2.isIE11())){
_7.setProperty("SelectionNamespaces",_9);
}
};
var _a=function(_b){
if(_b!=null){
return function(_c){
var _d=_3(_b,_c);
if(_2.debug){
console.log("getNameSpaceResolver: prefix: "+_c+" URI: "+_d);
}
if(_2.debug&&(_d==null||_d=="")){
console.log("getNameSpaceResolver: no namespace was found for prefix: "+_c);
}
return _d;
};
}else{
return null;
}
};
var _e=function(_f){
var _10=new Array;
_10=_11(_10,_f);
return _10;
};
var _11=function(_12,_13){
if(_13.documentElement){
var x;
for(x=0;x<_13.documentElement.attributes.length;x++){
var att=_13.documentElement.attributes[x];
var _14=att.nodeName.indexOf(":");
if(_14!=-1){
if(att.nodeName.substring(0,_14).toLowerCase()=="xmlns"){
var _15=att.nodeName.substring(_14+1);
var _16=_3(_12,_15);
if(_2.debug){
console.log("addNamesSpaceFromRootElement: current prefix: "+_15+" nameSpaceURI: "+_16);
}
if(_16==null){
_16=att.nodeValue;
if(_2.debug){
console.log("addNamesSpaceFromRootElement: adding prefix: "+_15+" nameSpaceURI: "+_16+" to the list");
}
_12.push({prefix:_15,nameSpaceURI:_16});
}
}
}
}
}
return _12;
};
_2.debug=false;
_2.selectNodes=function(_17,_18,_19,_1a){
if(_18==null){
throw Error("xpath.selectNodes : XMLDocument can not be null\n");
}
if(_19==null){
_19=_e(_18);
}else{
_19=_11(_19,_18);
}
var x;
for(x=0;_2.debug&&x<_19.length;x++){
console.log(_19[x].prefix+":"+_19[x].nameSpaceURI);
}
if(_1a==null&&(_18.documentElement!=null)){
_1a=_18.documentElement;
}
if(_1("ie")||_2.isIE11()){
try{
_6(_18,_19);
return _1a.selectNodes(_17);
}
catch(exception){
console.log(exception);
}
}else{
try{
var _1b=_a(_19);
var _1c=0;
var _1d=null;
_1d=_18.evaluate(_17,_1a,_1b,_1c,_1d);
if(_1d!=null){
var _1e=new Array();
var $A=null;
while($A=_1d.iterateNext()){
_1e.push($A);
}
return _1e;
}
}
catch(exception){
console.log(exception);
}
}
};
_2.selectSingleNode=function(_1f,_20,_21,_22){
var _23=_2.selectNodes(_1f,_20,_21,_22);
if(_23==null||_23.length==0){
return null;
}
return _23[0];
};
_2.selectText=function(_24,_25,_26,_27){
var _28=_2.selectSingleNode(_24,_25,_26,_27);
if(_28==null){
return null;
}
return _28.nodeValue;
};
_2.isIE11=function(){
if(!_1("ie")&&!_1("ff")){
return !!navigator.userAgent.match(/Trident\/7\.0/);
}
return false;
};
_2.loadDOMIE11=function(_29){
try{
var dom=new ActiveXObject("MSXML2.DOMDocument.6.0");
dom.async=false;
dom.loadXML(_29);
return dom;
}
catch(e){
console.log("Error during loading xml into MSXML2.DOMDocument.6.0: "+e);
}
};
_2.setNodeValue=function(_2a,_2b,_2c,_2d,_2e){
var _2f=_2.selectSingleNode(_2a,_2b,_2d,_2e);
if(_2f!=null){
if(_2f.nodeType==1){
if(_2f.hasChildNodes()){
var _30=_2f.firstChild;
_2f.replaceChild(_2b.createTextNode(_2c),_30);
}else{
_2f.appendChild(_2b.createTextNode(_2c));
}
}else{
if(_2f.nodeType==2){
_2f.nodeValue=_2c;
}else{
if(_2f.nodeType==3){
_2f.nodeValue=_2c;
}else{
console.log("xpath.setNodeValue: nodeType: "+_2f.nodeType);
}
}
}
}else{
var _31=_2a.lastIndexOf("/");
if(_31!=-1){
var _32=_2a.substring(_31+2);
var _33=_2a.substring(_31+1);
if(_33.indexOf("@")==0){
var _34=_2a.substring(0,_31);
var _35=_2.selectSingleNode(_34,_2b,_2d,_2e);
if(_35==null){
console.log("xpath.setNodeValue: couldn't find parent node for: "+_34+" orig "+_2a);
return;
}
_35.setAttribute(_32,_2c);
return;
}
}
console.log("xpath.setNodeValue: couldn't find node for: "+_2a);
}
};
return _2;
});


;define("ic-core/wp/events",[],function(){
var _1={WIDGET_ADDED_EVENT:"ic-core/wp/widgetAdded"};
return _1;
});


;define("ic-core/WidgetPlacementCRE",["dojo","dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/_base/json","dojo/_base/kernel","dojo/_base/lang","dojo/_base/window","dojo/cookie","dojo/Deferred","dojo/dnd/Manager","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/fx","dojo/has","dojo/i18n","dojo/i18n!./config/nls/widgetbundles","dojo/i18n!./nls/insertimagedialog","dojo/i18n!./nls/strings","dojo/i18n!./nls/widgets","dojo/io-query","dojo/on","dojo/parser","dojo/query","dojo/request","dojo/string","dojo/topic","dijit/_Widget","dijit/Dialog","dijit/registry","ic-gadget/container/iContainer2","ic-gadget/util/trace","ic-ui/DialogUtil","ic-ui/MessageBox","./aria/Toolbar","./back","./config/features","./config/properties","./config/services","./errorhandling","./help","./HTMLUtil","./paletteOneUI/dnd/avatar","./paletteOneUI/dnd/Source","./utilities","./xpath","./wp/events"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,fx,has,_11,_12,_13,_14,_15,_16,on,_17,_18,_19,_1a,_1b,_1c,_1d,_1e,_1f,_20,_21,_22,_23,_24,_25,_26,_27,_28,_29,_2a,_2b,_2c,_2d,_2e,_2f){
var win=_8.global;
var _30={};
var _31=_15,_32=null,_33=_14;
if(!win.WidgetPlacementConfig){
win.WidgetPlacementConfig={debug:false,appStartupDate:""};
}
var _34=false;
var _35=((win.ibmConfig)?win.ibmConfig.serviceName:null),_36=("communities"===_35),_37=("profiles"===_35);
var _38=true;
var _39=_2d.getURLParam("useServerInjection",true);
if("false"===_39){
_38=false;
}else{
if("true"===_39){
_38=true;
}else{
if(_37||_36){
_38=!("false"===_26["lconn.core.WidgetPlacement."+_35+".useServerInjection"]);
}
}
}
var _3a=false;
var _3b=_2d.getURLParam("limitedDND",true);
if("false"===_3b){
_3a=false;
}else{
if("true"===_3b){
_3a=true;
}
}
var _3c=true;
var _3d=_2d.getURLParam("freeLayout",true);
if("false"===_3d){
_3c=false;
}else{
if("true"===_3d){
_3c=true;
}
}
_30._freeLayout=_3c;
var _3e=(function(){
var _3f={addWidget:"/addWidget.do?",removeWidget:"/removeWidget.do?",moveWidget:"/moveWidget.do?",changeLayout:"/changeLayout.do?",savePreference:"/saveWidgetPreferences.do?"};
var _40=(function(){
if(has("json-widget-metadata")){
return true;
}else{
return false;
}
})();
var _41=(_40?"json":"xml");
var _42=function(_43,_44){
_44=_44||{};
_44.resourceId=win.WidgetPlacementConfig.resourceId;
_44.format=_41;
var _45=win.WidgetPlacementConfig.applicationContext+_3f[_43]+_16.objectToQuery(_44);
return _45;
};
var _46=(function(){
if(_40){
return function(_47){
return _47;
};
}else{
return function(doc){
if(!doc){
return null;
}
var _48={};
try{
_2.forEach(doc.childNodes[0].attributes,function(_49){
_48[_49.name]=_49.value;
});
}
catch(e){
_20.debug("Malformed response data.",e);
return null;
}
return _48;
};
}
})();
var _4a=function(_4b,_4c,_4d,_4e){
if(_7.isArray(_4b)){
_4b=_4b[0];
}
if(_7.isArray(_4c)){
_4c=_4c[0];
}
if(_7.isArray(_4d)){
_4d=("true"===_4d[0]);
}
if(_7.isArray(_4e)){
_4e=_4e[0];
}
var _4f=new _a();
var _50=_4b;
var _51={widgetDefId:_4b,uiLocation:_4c};
if(_4d){
_51.unhide=_4d;
if(_4e){
_51.instanceId=_4e;
_50=_4e;
}
}
var _52=_42("addWidget",_51);
_19(_52,{method:"POST",handleAs:_41}).then(function(_53){
_30.addWidgetInProgress=false;
win.WidgetPlacementConfig.lastMod=new Date().getTime();
var _54=_46(_53);
var _55=_54.widgetInstanceId;
_30.utils.withLayoutInfo(true).then(_7.hitch(this,function(){
var _56=_30.utils.getWidgetInstance(_55);
if(!_56){
_56={instanceId:_55,defIdRef:_4b,uiLocation:_4c};
_30.utils.addWidgetInstance(_56,null,null,_4d);
}
_1b.publish(_2f.WIDGET_ADDED_EVENT,_50);
_4f.resolve(_55);
}));
},function(err){
var _57=_46(err.response.data);
_4f.reject(_57);
_30.customAddWidgetErrorHandler(_57);
});
return _4f;
};
var _58=function(_59,_5a){
var _5b=new _a();
if(!_30.removeWidgetInProgress){
_30.removeWidgetInProgress=true;
var _5c={widgetInstanceId:_59,removeWidgetData:_5a};
var _5d=_42("removeWidget",_5c);
_19(_5d,{method:"POST",handleAs:_41,headers:{"X-Update-Nonce":win.dangerousurlnonce}}).then(function(_5e){
var _5f=!_5a;
_30.utils.removeWidgetInstance(_59,null,null,_5f);
_30.removeWidgetInProgress=false;
_5b.resolve();
},function(err){
_30.removeWidgetInProgress=false;
var _60=_46(err.response.data);
_5b.reject(_60);
_30.customAddWidgetErrorHandler(_60);
});
}else{
_30.removeWidgetInProgress=false;
_5b.reject();
}
return _5b;
};
var _61=function(_62,_63,_64){
var _65=new _a();
var _66={widgetInstanceId:_62,newUiLocation:_63};
if(_64){
_66.afterWidgetInstanceId=_64;
}
var _67=_42("moveWidget",_66);
_19(_67,{method:"POST",handleAs:_41}).then(function(_68){
win.WidgetPlacementConfig.lastMod=new Date().getTime();
_65.resolve();
},_28.DefaultXHRErrorHandler);
return _65;
};
var _69=function(_6a){
var _6b=new _a();
var _6c={layout:_6a};
var _6d=_42("changeLayout",_6c);
_19(_6d,{method:"POST",handleAs:_41}).then(function(_6e){
win.WidgetPlacementConfig.lastMod=new Date().getTime();
_6b.resolve();
},_28.DefaultXHRErrorHandler);
return _6b;
};
var _6f=function(_70,_71,_72){
var _73=new _a();
var _74={widgetInstanceId:_70};
if(_72){
_74.update=true;
}
var _75=_42("savePreference",_74);
var _76="";
for(name in _71){
_76+=(name+"=_="+_71[name]+",_,");
}
_19(_75,{method:"PUT",headers:{"X-Update-Nonce":win.dangerousurlnonce},data:_76,sync:true}).then(function(_77){
_30.utils.resetLayoutInfo();
win.WidgetPlacementConfig.lastMod=new Date().getTime()+"saveAttributes";
_73.resolve(_71);
},function(err){
_73.reject(err);
});
return _73;
};
var _78={addWidget:_4a,removeWidget:_58,moveWidget:_61,changeLayout:_69,savePreference:_6f};
return _78;
})();
_30.uiLocations={};
_30.dropZoneObjects={};
var _79=function(){
if(!_34){
_1f.init();
}
var _7a=_1f.getIRuntime();
_7a.then(function(){
_34=true;
});
if(!_7a||"function"!==typeof _7a.then){
_7a=new _a();
_7a.reject("_withIRuntime: failed to get iRuntime.");
}
return _7a;
};
var _7b=function(_7c){
if(/{[^}]+:[^}]+}/.test(_7c)){
return _7c;
}
var _7d=win.WidgetPlacementConfig.params,_7e=_7c.replace(/{/g,"${");
return _1a.substitute(_7e,_7d,function(v,k){
return (v?v:"{"+k+"}");
});
};
var _7f=function(_80){
if("string"!==typeof _80){
_20.debug("_parseWidgetTitle: unable to parse a non-string object, "+_80);
return "";
}
var _81=null,_82,_83,_84,obj;
try{
obj=_5.fromJson(_80);
if(!obj.title||"string"!==typeof obj.title){
_20.debug("_parseWidgetTitle: title is missing, will return an empty string");
return "";
}
_82=obj.title;
_84=obj.prefix;
if(_84){
_32=_32||_6.i18n.getLocalization("lconn.core.config","widgetbundles");
_83=_32||{};
_81=_83[_82];
if("string"!==typeof _81&&_83[_84]){
_81=_83[_84][_82];
}
if("string"!==typeof _81){
_81=_82;
}
}else{
_81=_82;
}
}
catch(e){
_81=_80;
}
_20.debug("_parseWidgetTitle: parsed title is "+_81);
return _2a.escapeText(_81);
};
var _85=function(_86,_87,_88){
if(!_87){
return false;
}
if("undefined"===typeof _88){
_88=true;
}
var _89=_87.modes||"view";
return ((!_86&&!_88)||(_86&&_89.indexOf(_86)!==-1));
};
var _8a=function(_8b,_8c){
if(!_8c){
return false;
}
var _8d=_8c.themes;
return (!_8d||!_8b||_8d.indexOf(_8b)!==-1);
};
var _8e=function(_8f,_90){
if(!_8f){
return false;
}
if(!_30.uiLocations[_8f]){
return true;
}
return _8a(_30.uiLocations[_8f].theme,_90);
};
var _91=function(_92){
var _93=_30.getUILocation(_92);
if(_93&&_30.uiLocations[_93]){
return _30.uiLocations[_93].theme;
}
return null;
};
var _94=function(){
var _95=null;
if(win.WidgetPlacementConfig.isProfilesEnv){
if(profilesData.displayedUser&&!profilesData.displayedUser.profileType){
profilesData.displayedUser.profileType="default";
}
_95=profilesData.displayedUser;
}
return _95;
};
var _96=function(_97,_98,_99){
_97=_97||[];
if(_97.length>1){
return _97;
}
var _9a={},_9b=[],_9c,_9d,_9e,_9f,_a0,_a1,j;
if(_97.length){
_9a[_97[0].entryName]=_97[0].entryValue;
}
configData=_98.configData;
_2.forEach(configData,function(_a2){
_a1=_7b(_a2["value"]);
_9a[_a2["key"]]=_a1;
});
itemSet=_98.itemSet;
_2.forEach(itemSet,function(_a3){
_a1=_7b(_a3["value"]);
_9a[_a3["name"]]=_a1;
});
if(_99){
win.WidgetPlacementConfig.params["widgetInstanceId"]=_99.instanceId;
itemSet=_99.itemSet;
_2.forEach(itemSet,function(_a4){
_a1=_7b(_a4["value"]);
_9a[_a4["name"]]=_a1;
});
}
for(attr in _9a){
_9b.push({entryName:attr,entryValue:_9a[attr]});
}
return _9b;
};
var _a5=function(){
if(_30.loadOrder){
for(var i=0;i<_30.loadOrder.length;i++){
var _a6=_30.loadOrder[i];
if(_a6){
if(_a6.uiLocation=="col3"&&_c.byId("profilePaneRight")!=null&&_e.contains("profilePaneRight","lotusHidden")){
_e.remove("profilePaneRight","lotusHidden");
}else{
if(_a6.uiLocation=="col1"&&_c.byId("profilePaneLeft")!=null&&_e.contains("profilePaneLeft","lotusHidden")){
_e.remove("profilePaneLeft","lotusHidden");
}
}
}
}
}
};
var _a7=function(){
if(win.WidgetPlacementConfig.navBarOverViewElementId){
var _a8=_c.byId(win.WidgetPlacementConfig.navBarOverViewElementId);
if(_a8){
_e.remove(_a8,"lotusSelected");
}
}
};
var _a9=function(_aa){
var _ab=false;
if(win.WidgetPlacementConfig.NavBarSelectedMenuItem!=null){
var _ac=win.WidgetPlacementConfig.NavBarSelectedMenuItem;
var idx=_ac.indexOf("_");
if(idx>0){
_ac=_ac.substring(0,idx);
}
if(_ac===_aa){
_ab=true;
}
}
return _ab;
};
var _ad=function(_ae,_af,_b0){
var _b1=_ae.navBarLinkText;
var _b2=_ae.navBarLink;
_30.addToNavBar(_ae,_af,_b0,_b2,_b1);
};
var _b3=function(_b4){
var _b5=_c.byId(_b4+"_navItem");
if(_b5){
_b5.parentNode.removeChild(_b5);
}
};
var _b6=function(){
var _b7=_b8();
if(_b7){
try{
new _30.aria.Toolbar(_b7.id);
}
catch(ee){
new _23(_b7.id);
}
}
};
_30.getWidgetDocAndRenderWidget=function(_b9,_ba,_bb,_bc,_bd,_be,_bf,_c0,_c1){
var _c2=function(){
if(!_c3()){
_30.showWidgetErrorInHeadline(_31["errorDefaultMsg"],false);
_10.set("contentArea",{display:"inline",visibility:"visible"});
}
};
var _c3=function(){
_ba=_ba||_30.utils.getWidgetDef(_b9);
if(_ba==null){
_20.warn("Unable to find widget definition for: "+_b9);
return null;
}
_b9=_b9||_ba.defId;
if(_b9!=_ba.defId){
_20.warn("The widgetDefId and widgetDef refer to different widget definitions: widgetDefId=",_b9,", widgetDef=",_ba);
return null;
}
var _c4=null;
if(_bb==null){
_c4=_b9;
}else{
if(_7.isObject(_bb)){
if(_bb.defIdRef!=_b9){
_20.warn("The widget definition and instance fail to match: widgetDef=",_ba,", widgetInstance=",_bb);
return null;
}
_c4=_bb.instanceId||_b9;
}else{
_c4=_bb;
_bb=_30.utils.getWidgetInstance(_c4);
}
}
if(_bb==null){
_bb={uiLocation:_bc,defIdRef:_b9,instanceId:_c4};
}
_be=_be||_ba.skinType;
var _c5=null;
var _c6=null;
var _c7=((_30.uiLocations[_bc])?_30.uiLocations[_bc].draggable:false),_c8="widget-container-"+_bc,_c9=_c.byId(_c8),_ca=_bc+"DropZone",_cb=_c.byId(_ca);
if(_c7){
if(_cb==null&&_c9){
_cb=_f.create("div",{id:_ca},_c9);
}
}else{
_cb=_c9;
}
_c6=_cb;
var url=_ba.url;
var _cc=_94();
_c1=_96(_c1,_ba,_bb);
var _cd=_30.utils.getEscapedWidgetName(_ba,_bb,false,_bd||"view");
var _ce=_ff(_c4,url,_cc,_c1,_bd,_cd);
var _cf=null;
if(_bd==="fullpage"){
_c6.innerHTML+=_fc(_c4);
_cf=_1f.loadWidget(_ce);
_cf.getWidgetInfo().then(function(_d0){
},function(_d1){
_1df(_c4,_d1.message);
});
}else{
if(false!==_bf){
var _d2=_a9(_b9);
if(_d2){
_a7();
}
_ad(_ba,_bb,_d2);
}
var _d3=_f.create("div");
var _d4=_129(_ba,_bb,_cc,null,true,_c7,_be,_bd);
_d3.innerHTML=_d4;
if(_c6){
_c6.appendChild(_d3.firstChild);
}
if(!_cb){
return _ba;
}
if(false!==_c0){
if(_30.dropZoneObjects[_ca]==null){
_2d.processUntilElementIsFound(_ca,_d8,null,{uiLocation:_bc,dropZoneDOMId:_ca});
}else{
_2d.processUntilElementIsFound(_c4+"Section",_dd,null,{dropZoneDOMId:_ca,widgetInstanceId:_c4});
}
}
var _d5=_8e(_bc,_ba);
if(_d5){
_cf=_1f.loadWidget(_ce);
_cf.getWidgetInfo().then(function(_d6){
},function(_d7){
_1df(_c4,_d7.message);
});
}else{
_1dc(_c4);
}
_2d.processUntilElementIsFound(_c4+"Section",function(){
_17.parse(_c.byId(_c4+"Section"));
},null,null,false);
}
return _ba;
};
_30.utils.withLayoutInfo().then(_c2);
};
var _d8=function(_d9,_da){
_17.parse(_d9);
var _db=_dc(_da.uiLocation,_d9);
_30.dropZoneObjects[_da.dropZoneDOMId]=_db;
};
var _dd=function(_de,_df){
_17.parse(_de);
var _e0=_30.dropZoneObjects[_df.dropZoneDOMId];
_e0.setItem(_de.id,{node:_de,id:_de.id,data:_df.widgetInstanceId,type:["widget"]});
};
var _e1=_4("lconn.core.WidgetPlacement.dnd.Source",_2c,{_emptyIndicator:null,_showEmptyIndicator:function(_e2,_e3){
if(_3a){
return;
}
if("undefined"===typeof _e2){
_e2=false;
}
if("undefined"===typeof _e3){
_e3=false;
}
if(!this._emptyIndicator){
var _e4=_33["rs_empty_column_placeholder"];
this._emptyIndicator=_f.create("div",{"class":"lotusWidget2 lotusEmptyColWarn",innerHTML:_e4,style:"display: none;"},this.node);
}
var _e5=this.getAllNodes(true);
var _e6=(0===_e5.length)||(_e3&&1===_e5.length);
if(_e2||_e6){
var _e7=("none"===_10.get(this._emptyIndicator,"display"));
if(_e7){
_10.set(this._emptyIndicator,"display","block");
}
}
},_hideEmptyIndicator:function(_e8){
if(_3a||!this._emptyIndicator){
return;
}
if("undefined"===typeof _e8){
_e8=true;
}
var _e9=this.getAllNodes(true);
var _ea=(0===_e9.length);
if(_e8||!_ea){
var _eb=("block"===_10.get(this._emptyIndicator,"display"));
if(_eb){
_10.set(this._emptyIndicator,"display","none");
}
}
},constructor:function(){
this._showEmptyIndicator();
},onDndStart:function(_ec,_ed,_ee){
if(!_ec.isInstanceOf(_e1)){
return;
}
_e1.superclass.onDndStart.apply(this,arguments);
if(_ec==this){
this._showEmptyIndicator(false,true);
}else{
this._showEmptyIndicator();
}
},onDndCancel:function(){
if(_30.currentFullpageWidgetInstanceId){
return;
}
_e1.superclass.onDndCancel.apply(this,arguments);
var _ef=this;
win.setTimeout(function(){
_ef._hideEmptyIndicator(false);
},0);
},onDndDrop:function(_f0,_f1,_f2){
if(!_f0.isInstanceOf(_e1)){
return;
}
_e1.superclass.onDndDrop.apply(this,arguments);
if(_f0==this){
var _f3=this;
win.setTimeout(function(){
_f3._showEmptyIndicator();
},0);
}
},onMouseOver:function(e){
_e1.superclass.onMouseOver.apply(this,arguments);
if(this.isDragging){
this._hideEmptyIndicator();
}
},onMouseOut:function(e){
_e1.superclass.onMouseOut.apply(this,arguments);
if(this.isDragging){
this._showEmptyIndicator(false,true);
}
},showEmptyIndicator:function(_f4){
this._showEmptyIndicator(_f4);
},hideEmptyIndicator:function(_f5){
this._hideEmptyIndicator(_f5);
},getAllNodes:function(_f6){
if(_f6){
return _30.getColumnWidgetNodes(this.parent,this.allowNested);
}else{
return _e1.superclass.getAllNodes.apply(this,arguments);
}
}});
var _dc=function(_f7,_f8){
var _f9=((_3a)?[]:["widget"]);
var _fa={jsId:_f7,accept:_f9,withhandles:true,skipForm:true};
var _fb=new _e1(_f8,_fa);
return _fb;
};
var _fc=function(_fd){
var _fe="<div id=\""+_fd+"\"></div>";
return _fe;
};
var _ff=function(_100,url,_101,_102,_103,_104){
var _105=[],_106=[],_107=_100;
url=_7b(url);
if(_103){
var _108=[];
_108.push({"id":"mode","value":_103});
_106.push({"id":"idescriptor","item":_108});
}
if(win.WidgetPlacementConfig.isProfilesEnv){
if(_101.uid!=null){
_105.push({"id":"profileDisplayedUserUID","value":_101.uid});
}
if(_101.key!=null){
_105.push({"id":"profileDisplayedUserKey","value":_101.key});
}
}
if(win.WidgetPlacementConfig.resourceId!=null){
_105.push({"id":"resourceId","value":win.WidgetPlacementConfig.resourceId});
}
if(win.WidgetPlacementConfig.parentResourceId!=null){
_105.push({"id":"parentResourceId","value":win.WidgetPlacementConfig.parentResourceId});
}
if(win.WidgetPlacementConfig.resourceType!=null){
_105.push({"id":"resourceType","value":win.WidgetPlacementConfig.resourceType});
}
if(win.WidgetPlacementConfig.resourceName!=null){
_105.push({"id":"resourceName","value":win.WidgetPlacementConfig.resourceName});
}
if(win.WidgetPlacementConfig.resourceOrgId!=null){
_105.push({"id":"resourceOrgId","value":win.WidgetPlacementConfig.resourceOrgId});
}
if(_104){
_105.push({"id":"computedWidgetTitle","value":_104});
}
for(var i=0;_102&&i<_102.length;i++){
_105.push({"id":_102[i].entryName,"value":_102[i].entryValue});
}
_106.push({"id":"attributes","mode":"edit","item":_105});
var _109={"itemSet":_106,"renderType":"default"};
var obj={definitionUrl:url,componentType:"iWidget",placement:_107,instanceData:_109};
if(_100){
obj.id=_100;
}
return obj;
};
var _b8=function(){
var _10a=_c.byId("lotusProfileNavBar")||_c.byId("lotusNavBar");
return _10a;
};
_30.destroyWidget=function(_10b,_10c,_10d,_10e,_10f){
var _110=_1e.byId(_10b+"moreActions");
if(_110&&_10d){
_110.destroy();
}
var _111=_1e.byId(_10b+"_toggleAction");
if(_111&&_10d){
_111.destroy();
}
_10c=_10c||_30.getUILocation(_10b);
if(_10f!==false){
var _112=_30.dropZoneObjects[_10c+"DropZone"];
if(_112){
_112.delItem(_10b+"Section");
}
}
_79().then(_7.hitch(this,function(_113){
var _114=_113.getWidgetIdByDomId(_10b);
if(_114){
var _115=[_114];
_1f.unloadWidgets(_115);
}
}));
var _116=null;
if(_10e){
_116=_c.byId(_10b+"SubArea");
}
if(_116){
_116.innerHTML="";
}
};
_30.closeFullPageWidgetIfOpen=function(){
if(_30.currentFullpageWidgetInstanceId){
_30.destroyWidget(_30.currentFullpageWidgetInstanceId,null,false,true,false);
_30.currentFullpageWidgetInstanceId=null;
}
};
_30.closeSwitchView=function(){
if(_30.currentFullpageWidgetInstanceId){
_30.destroyWidget(_30.currentFullpageWidgetInstanceId,null,false,false,false);
}
_2d.hide("widget-container-fullpage",false,true);
_30.destroyWidgetContainer("fullpage");
_30.isInWidgetFullpageMode=true;
};
_30.getInsertionPoint=function(_117,li){
var _118=li.getAttribute("uiLocation");
if(_118==="col2"){
var _119=_18("li[uilocation=\"col2\"]",_117);
if(_119&&_119.length){
return _119[_119.length-1];
}else{
return _117.children[_117.children.length-1];
}
}else{
return _117.children[_117.children.length-1];
}
};
var _11a=function(){
var _11b=_9("minimized-widgets");
if(_11b){
return _11b.split(";");
}else{
return [];
}
};
var _11c=function(_11d){
if(_11d&&_7.isArray(_11d)){
var _11e=_11d.join(";");
_9("minimized-widgets",_11e);
}
};
var _11f=function(_120){
var _121=_120;
if(_120&&_7.isObject(_120)){
_121=_120.instanceId||_120.defIdRef;
}
var _122=_11a();
if(_122&&_121){
return (_122.indexOf(_121)>=0);
}else{
return false;
}
};
var _123=function(_124,_125){
var _126=_124;
if(_124&&_7.isObject(_124)){
_126=_124.instanceId||_124.defIdRef;
}
var _127=_11a();
if(_127&&_126){
var _128=_127.indexOf(_126);
if(_128>=0&&!_125){
_127.splice(_128,1);
}else{
if(_128<0&&_125){
_127.push(_126);
}
}
_11c(_127);
}
};
var _129=function(_12a,_12b,_12c,_12d,_12e,_12f,_130,_131){
if(typeof _12a==="undefined"){
return "";
}
var url=_12a.url;
var _132=_12b.instanceId;
var _133=_12b.hidden;
var _134=_12a.defId;
var _135=_12a.helpLink;
var _136=_12a.fixedPosition;
var _137=_12a.displayLoginRequired;
var _138=((_135)?_7b(_135):null);
var _139=false;
var _13a="";
if(_132){
_139=true;
}
if(_132==null){
_132=_134;
}
var _13b=_132;
if(_131==="edit"){
_13b+="edit";
}
var _13c=win.WidgetPlacementConfig.userLoggedIn||_137!=="true";
var _13d=_30.utils.getEscapedWidgetName(_12a,_12b,true,_131||"view");
var _13e=_11f(_12b);
if(!_130){
_130="use25OneUISkin";
}
var _13f=null;
if(_130==="use25OneUISkin"){
var _140=((!_13e)?"Close":"Open");
var _141="";
var _142="";
if(_12e&&_12f&&_139){
_141=" dojoDndItem\" dndType=\"widget\" skipForm=\"true\" dndData=\""+_132;
_142="style=\"cursor: move\" ";
}
var _143=((_133=="true")?" lotusHidden ":"");
_13f="<div id=\""+_13b+"Section\" class=\"lotusWidget2"+_143+_141+"\" widgetId=\""+_132+"\" role=\"region\" aria-labelledby=\""+_132+"Id\" >";
var _144=_31["actions_alt"]||"Actions for: ${0}";
_144=_1a.substitute(_144,[_13d]);
_13f+="<h2 style=\"cursor: default\">"+"<a id=\"widgetActionsMenu"+_132+"\" class=\"lotusIcon lotusActionMenu\" href=\"javascript:void(0);\" onclick=\"lconn.core.WidgetPlacement.openMenu(event, '"+_132+"','widgetActionsMenu"+_132+"');\" onkeydown=\"if(event.keyCode==40) lconn.core.WidgetPlacement.openMenu(event, '"+_132+"','widgetActionsMenu"+_132+"');\" title=\""+_144+"\" role=\"button\" aria-haspopup=\"true\" aria-label=\""+_144+"\">"+"<img src=\""+_1c.prototype._blankGif+"\" alt=\"\"/>"+"<span class=\"lotusAltText\">"+_144+"</span>"+"</a>"+"<span class=\"ibmDndDragHandle\" "+_142+"id=\""+_132+"Id\">"+_13d+"</span>"+"</h2>";
_13f+="<div dojoType=\"dijit.Menu\" id=\""+_13b+"moreActions\" style=\"display: none;\" aria-label=\"More Action Menu\">";
if(!_13e){
_13f+="<div id=\""+_13b+"_toggleAction\" dojoType=\"dijit.MenuItem\" label=\""+_31["widgets_Min"]+"\" onclick=\"lconn.core.WidgetPlacement.minimizeWidget(this,'"+_132+"', '"+_134+"');\"></div>";
}else{
_13f+="<div id=\""+_13b+"_toggleAction\" dojoType=\"dijit.MenuItem\" label=\""+_31["widgets_Max"]+"\" onclick=\"lconn.core.WidgetPlacement.minimizeWidget(this,'"+_132+"', '"+_134+"');\"></div>";
}
if(_13c){
_13f+="<div dojoType=\"dijit.MenuItem\" label=\""+_31["refresh"]+"\" onclick=\"lconn.core.WidgetPlacement.fetchAndRefresh('"+_132+"');\"></div>";
}
if(_85("edit",_12a)&&_12e){
_13f+="<div class=\"edit_button\" dojoType=\"dijit.MenuItem\" label=\""+_31["edit"]+"\" onclick=\"lconn.core.utilities.hide('"+_132+"moreActions"+"', true, true);cre$.iRuntime.getWidgetById('"+_132+"').widgetObject.getIContext().iEvents.fireEvent('onModeChanged', '', {'newMode':'edit'});\"></div>";
}
if(_12e&&"undefined"!==typeof communityActionData){
if(communityActionData.showWidgetTitleEdit&&!(_134=="RecentUpdates"||_134=="StatusUpdates")){
var _145="<div dojoType=\"dijit.MenuItem\" label=\""+_31["changeTitleAction"]+"\" onclick=\"lconn.core.WidgetPlacement.changeTitle('"+_132+"');\"></div>";
_13f+=_145;
}
}
if(_85("view",_12a)&&_12e){
_13f+="<div style=\"display:none;\" class=\"view_button\" dojoType=\"dijit.MenuItem\" label=\""+_31["view"]+"\" onclick=\"lconn.core.utilities.hide('"+_132+"moreActions"+"', true, true);cre$.iRuntime.getWidgetById('"+_132+"').widgetObject.getIContext().iEvents.fireEvent('onModeChanged', '', {'newMode':'view'});\"></div>";
}
if(_138){
_13f+="<div dojoType=\"dijit.MenuItem\" label=\""+_31["help"]+"\" onclick=\"lconn.core.utilities.hide('"+_132+"moreActions"+"', true, true);lconn.core.WidgetPlacement.openHelpWindow('"+_138+"');\"></div>";
}
if(_139&&_12e){
var _146=_12b.uiLocation;
if(!_136){
_13f+="<div class=\"moveup_button\" dojoType=\"dijit.MenuItem\" label=\""+_31["widgets_MoveUp"]+"\" onclick=\"lconn.core.WidgetPlacement.moveUp('"+_132+"','"+_146+"');\"></div>";
_13f+="<div class=\"movedown_button\" dojoType=\"dijit.MenuItem\" label=\""+_31["widgets_MoveDown"]+"\" onclick=\"lconn.core.WidgetPlacement.moveDown('"+_132+"','"+_146+"');\"></div>";
_13f+="<div class=\"moveprev_button\" dojoType=\"dijit.MenuItem\" label=\""+_31["widgets_MovePrev"]+"\" onclick=\"lconn.core.WidgetPlacement.moveToPreviousColumn('"+_132+"','"+_146+"');\"></div>";
_13f+="<div class=\"movenext_button\" dojoType=\"dijit.MenuItem\" label=\""+_31["widgets_MoveNext"]+"\" onclick=\"lconn.core.WidgetPlacement.moveToNextColumn('"+_132+"','"+_146+"');\"></div>";
}
_13f+="<div dojoType=\"dijit.MenuItem\" label=\""+_31["hide"]+"\" onclick=\"lconn.core.WidgetPlacement.removeWidget('"+_132+"', false);\"></div>";
_13f+="<div dojoType=\"dijit.MenuItem\" label=\""+_31["link.remove"]+"\" onclick=\"lconn.core.WidgetPlacement.removeWidget('"+_132+"', true);\"></div>";
}
_13f+="</div>";
if(!_13e){
if(!win.WidgetPlacementConfig.userLoggedIn&&_137==="true"){
_13f+="<div id=\""+_13b+"SubArea\" style=\"-webkit-user-select: auto;\" widgetloaded=\"false\" widgetneedrefresh=\"false\">"+_31["msg.loginRequired"];
}else{
_13f+="<div id=\""+_13b+"SubArea\" style=\"-webkit-user-select: auto;\" widgetloaded=\"true\" widgetneedrefresh=\"false\">";
_13f+=_fc(_132);
}
}else{
_13f+="<div id=\""+_13b+"SubArea\" style=\"display: none; -webkit-user-select: auto;\" widgetloaded=\"false\"";
if(!win.WidgetPlacementConfig.userLoggedIn&&_137==="true"){
_13f+=" widgetneedrefresh=\"false\" >"+_31["msg.loginRequired"];
}else{
_13f+=" widgetneedrefresh=\"true\" >";
}
}
_13f+="</div>";
_13f+="</div>";
}else{
if(_130==="skinless"){
_13f="<div id=\""+_13b+"Section\">";
if(!win.WidgetPlacementConfig.userLoggedIn&&_137=="true"){
_13f+="<div id=\""+_13b+"SubArea\" widgetloaded=\"false\" >";
_13f+=_31["msg.loginRequired"];
}else{
_13f+="<div id=\""+_13b+"SubArea\" widgetloaded=\"true\" >";
_13f+=_fc(_132);
}
_13f+="</div>";
_13f+="</div>";
}
}
return _13f;
};
var _147=function(_148){
var _149=_c.byId(_148+"Section");
if(_149){
_149.parentNode.removeChild(_149);
}
};
_30.openHelpWindow=function(url){
var _14a=url.indexOf("&lang");
if(_14a>0){
url=url.substr(0,_14a);
}
_29.launchHelp(url);
};
_30.checkWidgetLocation=function(_14b,_14c){
var _14d=_c.byId(_14c+"DropZone"),_14e,_14f,_150;
if(_14d){
_14e=_14d.childNodes;
_14e=_2.filter(_14e,function(node){
return node&&!!node.getAttribute("widgetid");
});
if(_14e.length===1){
return "alone";
}
for(_14f=0;_14f<_14e.length;_14f++){
_150=_14e[_14f].getAttribute("widgetid");
if(_150===_14b){
if(_14f===0){
return "top";
}else{
if(_14f>=_14e.length-1){
return "bottom";
}else{
return "middle";
}
}
}
}
}
};
_30.getUILocation=function(_151){
var _152=_30.loadOrder,i;
for(i=0;_152&&i<_152.length;i++){
if(_152[i]&&_152[i].instanceId===_151){
return _152[i].uiLocation;
}
}
return "";
};
_30.updateMoreActions=function(_153){
var _154=_153+"moreActions";
var _155=_30.getUILocation(_153);
if(_155){
var _156=_30.checkWidgetLocation(_153,_155);
if(_156){
var _157=_18("#"+_154+">tbody>tr.moveup_button"),_158=_18("#"+_154+">tbody>tr.movedown_button");
if(_157&&_157.length&&_158&&_158.length){
var _159=_1e.byNode(_157[0]),_15a=_1e.byNode(_158[0]);
_159.onClick=function(){
_30.moveUp(_153,_155);
};
_15a.onClick=function(){
_30.moveDown(_153,_155);
};
switch(_156){
case "alone":
_157.style("display","none");
_158.style("display","none");
break;
case "top":
_157.style("display","none");
_158.removeAttr("style");
_158.style("-moz-user-select","none");
break;
case "bottom":
_157.removeAttr("style");
_157.style("-moz-user-select","none");
_158.style("display","none");
break;
case "middle":
_158.removeAttr("style");
_158.style("-moz-user-select","none");
_157.removeAttr("style");
_157.style("-moz-user-select","none");
break;
default:
break;
}
}
var _15b=_18("#"+_154+">tbody>tr.moveprev_button"),_15c=_18("#"+_154+">tbody>tr.movenext_button");
var _15d=(!_22d(_155,0));
if(_15b&&_15b.length&&_15c&&_15c.length){
if(_3a||_15d){
_15b.style("display","none");
_15c.style("display","none");
}else{
var _15e=_1e.byNode(_15b[0]),_15f=_1e.byNode(_15c[0]);
_15e.onClick=function(){
_30.moveToPreviousColumn(_153,_155);
};
_15f.onClick=function(){
_30.moveToNextColumn(_153,_155);
};
}
}
}
_79().then(_7.hitch(this,function(_160){
var _161=_160.getWidgetById(_153);
var edit=_18("#"+_154+">tbody>tr.edit_button");
var view=_18("#"+_154+">tbody>tr.view_button");
if(edit&&view&&_161){
var mode=_161.widgetObject.getIContext().getiDescriptor().getItemValue("mode");
switch(mode){
case "edit":
view.removeAttr("style");
edit.style("display","none");
break;
case "view":
edit.removeAttr("style");
view.style("display","none");
break;
}
}
}));
}
};
_30.openMenu=function(_162,_163,id){
var _164=_163+"moreActions";
var _165=_1e.byId(_164);
_30.updateMoreActions(_163);
if(_165==null){
_20.debug("lconn.core.WidgetPlacement.openMenu: dojoWidgetId \""+_164+"\" do not have a dojoWidget instance, creating one");
var _166=_c.byId(_164);
_17.parse(_166.parentNode||_166);
_165=_1e.byId(_164);
}
if(_165){
if(id){
var elem=_c.byId(id);
if(elem){
_d.set(elem,"aria-expanded","true");
_d.set(elem,"aria-owns",id+"_dropdown");
var _167=on(_165,"Close",function(){
_d.set(elem,"aria-expanded","false");
_d.remove(elem,"aria-owns");
_167.remove();
});
}
}
menuUtility.openMenu(_162,_164);
}else{
_20.debug("lconn.core.WidgetPlacement.openMenu: skipping open menu, can not find widget with id \""+_164+"\"");
}
};
var _168=function(_169){
_b6();
var _16a=_30.utils.getPageWidgetInstances(win.WidgetPlacementConfig.defaultPageId);
_16a=_30.sortWidgetNodes(_16a);
if(_16a&&_16a.length){
for(var i=0;i<_16a.length;i++){
var _16b=_16a[i];
var _16c=_16b.enabled;
if(_16c==null||_16c!="false"){
var _16d=_16b.defIdRef;
var _16e=_30.utils.getWidgetDef(_16d);
if(_16e==null){
_20.warn("Unable to find widget definition for: "+_16d+", it will be skipped.");
continue;
}
if(_30.canAddWidget(_16e,win.WidgetPlacementConfig,_169,_16b)){
var _16f=false;
if(win.WidgetPlacementConfig.NavBarSelectedMenuItem&&win.WidgetPlacementConfig.NavBarSelectedMenuItem===_16d){
_16f=true;
}
_ad(_16e,_16b,_16f);
}
}
}
}
};
_30.sortWidgetNodes=function(_170){
var _171=[],_172=[],_173=[];
for(var i=0;i<_170.length;i++){
var n=_170[i];
var _174=n.uiLocation;
if(_174==="col2"){
_171.push(n);
}else{
if(_174==="col3"&&n.defIdRef!=="Members"){
_172.push(n);
}else{
_173.push(n);
}
}
}
_173=_173.concat(_171,_172);
return _173;
};
_30.placeWidgetMetadata=function(_175,_176){
_30.initialLoad=true;
var _177=new _a();
var _178=[];
var _179=function(_17a,_17b,data,_17c,_17d){
var _17e={};
try{
var _17f;
if(win.WidgetPlacementConfig.isProfilesEnv){
var _180=(_17b&&typeof (_17b.profileType)=="string"&&_7.trim(_17b.profileType).length>0?_17b.profileType:"default");
_17f=_30.utils.getPageWidgetInstances(_17a,data,_180);
if(_17f==null||!_17f.length){
_17f=_30.utils.getPageWidgetInstances(_17a,data,"default");
_20.debug("No widget layout for profile type ["+_180+"] defined.  Falling back to default layout.");
}
}else{
_17f=_30.utils.getPageWidgetInstances(_17a,data);
_17f=_30.sortWidgetNodes(_17f);
}
if(_17f&&_17f.length){
for(var i=0;i<_17f.length;i++){
var _181=_17f[i];
var _182=_181.defIdRef;
var _183=_30.utils.getWidgetDef(_182,data);
if(_183==null){
_20.warn("Unable to find widget definition for: "+_182+", it will be skipped.");
continue;
}
var _184=_17c;
if(_1b2()&&_182!=="StatusUpdates"){
_184=false;
}
var _185=_176;
var _186=_30.isCommunitiesPage;
var _187=_85(_185,_183,_186),_188=_30.canAddWidget(_183,win.WidgetPlacementConfig,_17c,_181);
if(_187&&_188){
var url=_183.url;
var _189=_183.skinType;
var _18a=_181.uiLocation;
var _18b=((_30.uiLocations[_18a])?_30.uiLocations[_18a].draggable:false);
if(_17e[_18a]==null){
_17e[_18a]="";
}
var _18c=_181.instanceId||_182;
_30.loadOrder=_30.loadOrder||[];
_30.loadOrder.push({instanceId:_18c,uiLocation:_18a});
_17e[_18a]+=_129(_183,_181,_17b,data,_184,_18b,_189);
var _18d=_96(null,_183,_181);
var _18e=_30.utils.getEscapedWidgetName(_183,_181,_185);
var _18f=_ff(_18c,url,_17b,_18d,_185,_18e);
_178.push(_18f);
}
}
}
for(_18a in _17e){
var _190=_c.byId(_18a+"DropZone")||_c.byId("widget-container-"+_18a);
if(_190){
_190.innerHTML=_17e[_18a];
}
}
if(_17f&&_17f.length){
for(var i=0;i<_17f.length;i++){
var _191="widgetActionsMenu"+_17f[i].instanceId;
var _192=_c.byId(_191);
if(_192){
_d.set(_192,"aria-expanded","false");
}
}
}
_177.resolve(_178);
}
catch(exception){
_177.reject(exception);
_28.DefaultErrorHandler("lconn.core.WidgetPlacement.addAllWidgets",exception);
}
};
var _193=function(){
if(win.WidgetPlacementConfig.pageId==="fullPageWidgetView"){
try{
var _194=_c.byId("widgetContainer")||_c.byId("widget-container-fullpage");
var _195=common_getParam("widgetId");
var _196=_30.utils.getWidgetDef(_195);
var url=_196.url;
_30.addToNavBar(_196,null,_197,null,null,true,null);
var _198=[{entryName:"state",entryValue:"maximize"}];
_198=_96(_198,_196);
_194.innerHTML=_fc(_195);
_30.loadOrder=_30.loadOrder||[];
_30.loadOrder.push({instanceId:_195,uiLocation:"fullpage"});
}
catch(exception){
_28.DefaultErrorHandler("WidgetMgmt.loadWidgets",exception,"widgetContainer");
}
}else{
_179(win.WidgetPlacementConfig.pageId,_197,null,_199,_175);
}
};
var _197=_197||_94(),_199=(win.getUserProfileOverrideProperty("canPersonalize")==="true");
var _19a=_30.utils.withLayoutInfo();
if(_175!=false){
_19a.then(_7.hitch(this,function(){
_168(_199);
}));
}
if(!win.WidgetPlacementConfig.pageId){
_177.resolve(_178);
return _177;
}
if(_2c){
_2c.prototype.onSelectStart=function(){
};
}
_1ab();
for(uiLocation in _30.uiLocations){
var _19b=_c.byId("widget-container-"+uiLocation);
if(_19b){
var _19c=_30.uiLocations[uiLocation];
if(_199&&_19c&&_19c.draggable){
_f.create("div",{id:uiLocation+"DropZone","class":"target",role:"presentation"},_19b);
}else{
_d.set(_19b,"role","presentation");
}
}
}
_19a.then(_7.hitch(this,_193));
var _19d=_b.manager();
_19d.makeAvatar=function(){
return new _2b(this);
};
_1b.subscribe("/dnd/drop",_30.onDropHandler);
_1b.subscribe("/dnd/start",function(_19e,_19f,_1a0){
if(!_19e.isInstanceOf(_e1)){
return;
}
for(var i=0;i<_19f.length;i++){
_2d.hide(_19f[i],false,true);
_30.currentNode=_19f[i];
}
});
_1b.subscribe("/dnd/cancel",function(){
if(_30.currentNode){
_2d.show(_30.currentNode,false,false,true);
_30.currentNode=null;
}
});
_177.then(_7.hitch(this,function(_1a1){
var _1a2=_c.byId("lotusFrame");
if(_1a2==null){
var _1a3=_18(".lotusFrame");
if(_1a3!=null&&_1a3.length>0){
_1a2=_1a3[0];
}else{
_1a2=win.document;
}
}
_17.parse(_1a2);
for(uiLocation in _30.uiLocations){
var _1a4=uiLocation+"DropZone";
var _1a5=_c.byId(_1a4);
if(_1a5){
var _1a6=_dc(uiLocation,_1a5);
_30.dropZoneObjects[_1a4]=_1a6;
}
}
_30.initialLoad=false;
}));
return _177;
};
var _1a7=function(_1a8){
var node=(_7.isString(_1a8))?_c.byId("widget-container-"+_1a8):_1a8;
if(!node||1!==node.nodeType){
return null;
}
while("lotusMain"!==node.id){
var _1a9=node.getAttribute("class")||"";
var _1aa=_1a9.indexOf("wptheme");
if(-1===_1aa){
node=node.parentNode;
continue;
}
_1a9=_1a9.substring(_1aa);
var end=_1a9.indexOf(" ");
if(-1===end){
return _1a9;
}else{
return _1a9.substring(0,end);
}
}
return null;
};
var _1ab=function(){
_30.uiLocations={};
var _1ac=["banner","col1","col2","col3","col2recentposts","col2statusposts","palette"];
_2.forEach(_1ac,function(_1ad){
var _1ae=_c.byId("widget-container-"+_1ad);
if(!_1ae){
return false;
}
var _1af=_1a7(_1ae);
var _1b0=!("col2recentposts"===_1ad||"col2statusposts"===_1ad||"palette"===_1ad);
var _1b1=false;
_30.uiLocations[_1ad]={hidden:_1b1,draggable:_1b0,theme:_1af};
});
};
var _1b2=function(){
var _1b3="/community/updates",path=win.document.location.pathname;
return (path.indexOf(_1b3,path.length-_1b3.length)!==-1);
};
var _1b4=function(_1b5,_1b6){
_2.some(_30.loadOrder,function(node){
if(node&&_1b5===node.instanceId&&_1b6!==node.uiLocation){
node.uiLocation=_1b6;
return false;
}
});
};
_30.onDropHandler=function(_1b7,_1b8,_1b9){
if(!_30.currentNode){
return;
}
var _1ba=_b.manager().target,_1bb=_1ba.jsId,_1bc=_30.currentNode,_1bd=_1bc.getAttribute("widgetId");
if(_1ba&&_1b7&&_1ba!==_1b7){
_2d.hide(_1bd+"SubArea",true,true);
}
_2d.show(_1bc,false,false,true);
_30.currentNode=null;
_1b4(_1bd,_1bb);
var _1be=function(){
var _1bf=_1ba.getAllNodes();
for(var i=0;i<_1bf.length;i++){
if(_1bf[i].getAttribute("widgetId")===_1bd){
var _1c0=(i===0)?null:_1bf[i-1].getAttribute("widgetId");
_1c1(_1bd,_1bb,_1c0,_1ba,_1b7);
break;
}
}
};
win.setTimeout(_1be,300);
};
_30.getColumn3Anchor=function(){
return ("top");
};
_30.getColumn2Anchor=function(){
return ("top");
};
var _1c1=function(_1c2,_1c3,_1c4,_1c5,_1c6){
_1c4=_1c4||(_1c3==="col3"?_30.getColumn3Anchor():_30.getColumn2Anchor());
_3e.moveWidget(_1c2,_1c3,_1c4).then(function(){
if(_1c5&&_1c6&&_1c5!==_1c6){
_30.utils.withLayoutInfo(true).then(function(){
_30.refresh(_1c2);
});
}
},function(){
});
};
_30.unhideWidget=function(_1c7){
_18("[widgetid=\""+_1c7+"\"]").forEach(function(node){
if(_e.contains(node,"lotusHidden")){
_e.remove(node,"lotusHidden");
}
});
};
_30.renderWidgets=function(_1c8){
if(_1c8.length==0){
return;
}
var _1c9=[];
for(var i=0;i<_1c8.length;i++){
var _1ca=_c.byId(_1c8[i].placement);
if(_1ca){
_1c9.push(_1c8[i]);
}
}
_a5();
var lw=function(){
_1f.loadWidgets(_1c9);
};
_1f.preloadWidgets(_1c8).then(lw);
};
_30.loadWidgetFullPage=function(_1cb,_1cc){
_30.loadFullpageView(_1cb,_1cc,true,true);
};
_30.loadFullpageView=function(_1cd,_1ce,_1cf,_1d0,_1d1){
var _1d2=WidgetPlacementConfig.defaultPageId;
var _1d3=_30.utils.getWidgetInstance(_1cd,null,_1d2);
var _1d4=(_1d3?_1d3.defIdRef:_1cd);
var _1d5=_30.utils.getWidgetDef(_1d4);
_1ce=_1ce||[];
_1ce.push({name:"resourceId",value:win.WidgetPlacementConfig.resourceId});
_30.switchView(_1d5,_1d3,_1ce,_1d0,_1cf);
};
_30.reloadOverviewPage=function(){
_20.entering("ic-core/WidgetPlacement","reloadOverviewPage");
_30.closeOtherViews();
if(_30.currentFullpageWidgetInstanceId){
_30.destroyWidget(_30.currentFullpageWidgetInstanceId,null,false,true,false);
_30.currentFullpageWidgetInstanceId=null;
}
if(_30.onlyFullPageWidgetLoaded){
var _1d6=_30.placeWidgetMetadata(false,"view");
_1d6.then(_7.hitch(this,function(_1d7){
_30.renderWidgets(_1d7);
_30.onlyFullPageWidgetLoaded=false;
}));
}
if(win.WidgetPlacementConfig.hideElements){
for(var i=0;i<win.WidgetPlacementConfig.hideElements.length;i++){
_2d.show(win.WidgetPlacementConfig.hideElements[i],false,false,true);
try{
_1e.byId(win.WidgetPlacementConfig.hideElements[i]).show();
}
catch(exception1){
}
}
}
_30.destroyWidgetContainer("fullpage");
for(uiLocation in _30.uiLocations){
_30.showColumn(uiLocation);
}
_30.highlightOverviewLink();
_2.forEach(_30.loadOrder,function(node){
if(node&&_c.byId("widget-container-"+node.uiLocation)){
_30.refresh(node.instanceId);
}
});
return false;
};
_30.getWidgetDefId=function(_1d8,_1d9){
var _1da=_30.utils.getWidgetInstance(_1d8,_1d9),_1db=((_1da)?_1da.defIdRef:_1d8);
return _1db;
};
var _1dc=function(_1dd){
_1de(_1dd,"warning",_33["rs_widget_misplacement_warning"],null);
};
var _1df=function(_1e0,_1e1){
if(_1e1){
_20.error("Failed to load widget "+_1e0+", error:\n",_1e1);
}
_1de(_1e0,"error",_33["rs_widget_loading_error_title"],_33["rs_widget_loading_error_message"],false,true);
};
_30.refresh=function(_1e2,_1e3,_1e4){
var _1e5=_30.utils.getWidgetInstance(_1e2,_1e3),_1e6=((_1e5)?_1e5.defIdRef:_1e2),_1e7=_30.utils.getWidgetDef(_1e6,_1e3);
_2d.hide(_1e2+"moreActions",true,true);
if(!_1e5||!_1e7){
return;
}
_30.destroyWidget(_1e2,null,false,false,false);
_2d.show(_1e2+"SubArea",true,true,true);
var _1e8=_30.utils.getWidgetName(_1e7,_1e5,"view"),_1e9=_30.utils.getWidgetName(_1e7,_1e5),_1ea=_96(null,_1e7,_1e5),_1eb=_c.byId(_1e2+"SubArea");
if(_1eb){
_1eb.innerHTML=_fc(_1e2);
_1eb.setAttribute("widgetloaded","true");
}
if(win.refreshInfoHolder==null){
win.refreshInfoHolder={};
}
win.refreshInfoHolder[_1e2]=true;
if(_1e8){
var _1ec=_c.byId(_1e2+"Id");
if(_1ec){
if(_1ec.textContent){
_1ec.textContent=_1e8;
}else{
_1ec.innerText=_1e8;
}
}
}
if(_1e9){
var _1ed=_c.byId(_1e2+"_navItem");
if(_1ed){
var _1ee=_1ed.children[0];
if(_1ee.textContent){
_1ee.textContent=_1e9;
}else{
_1ee.innerText=_1e9;
}
}
}
var _1ef=_30.getUILocation(_1e2);
if(_8e(_1ef,_1e7)){
var _1f0=_ff(_1e2,_1e7.url,_94(),_1ea,"view",_1e8);
_1f.loadWidget(_1f0);
}else{
_1dc(_1e2);
}
win.setTimeout(function(){
win.refreshInfoHolder[_1e2]=null;
},2000);
if(_1e4){
win.setTimeout(function(){
_30.setFocus(_1e2,"widgetActionsMenu"+_1e2);
},0);
}
};
_30.refreshTitleAndMicroformat=function(_1f1,_1f2){
var _1f3=_30.utils.getWidgetInstance(_1f1,_1f2),_1f4=((_1f3)?_1f3.defIdRef:_1f1),_1f5=_30.utils.getWidgetDef(_1f4),_1f6=_30.utils.getWidgetName(_1f5,_1f3,"view"),_1f7=_30.utils.getWidgetName(_1f5,_1f3);
_1f8(_1f1,_1f6,_1f7);
};
var _1f8=function(_1f9,_1fa,_1fb){
_18("div#"+_1f9+" > span[title=\"attributes\"]").orphan();
if(_1fa){
var _1fc=_c.byId(_1f9+"Id");
if(_1fc){
if(_1fc.textContent){
_1fc.textContent=_1fa;
}else{
_1fc.innerText=_1fa;
}
}
}
if(_1fb){
var _1fd=_c.byId(_1f9+"_navItem");
if(_1fd){
var _1fe=_1fd.children[0];
if(_1fe.textContent){
_1fe.textContent=_1fb;
}else{
_1fe.innerText=_1fb;
}
}
}
};
_30.fetchAndRefresh=function(_1ff){
win.staleXMLConfig=true;
_30.utils.withLayoutInfo(true).then(function(){
_30.refresh(_1ff);
});
};
var _200=function(_201,_202,_203,_204){
var _205={"widgetTitle":_202};
_3e.savePreference(_201,_205,true).then(_203,_204);
};
var _206=function(str){
var _207=0;
for(var i=0;i<str.length;i++){
var _208=str.charCodeAt(i);
if(_208<128){
_207+=1;
}else{
if(_208<2048){
_207+=2;
}else{
_207+=3;
}
}
}
return _207;
};
_30.changeTitle=function(_209){
var _20a=_30.utils.getWidgetInstance(_209),_20b=((_20a)?_20a.defIdRef:null),_20c=((_20b)?_30.utils.getWidgetDef(_20b):null);
var _20d=_30.utils.getWidgetName(_20c,_20a,"view"),_20e=_30.utils.getDefaultWidgetName(_20c);
var _20f=_f.create("input",{type:"text",value:_20d,"aria-required":"true","class":"lotusText bidiAware",style:"width:300px","aria-labelledby":"newTitleLabel"});
var _210=_f.create("div");
var _211=_f.create("span",{innerHTML:_1a.substitute(_33["rs_widget_title_change_direction"],[_20e])+"<br/><br/><label id='newTitleLabel'>*"+_33["rs_widget_title_change_label"]+"</label>"});
_f.place(_210,_211,"first");
_f.place(_20f,_211,"last");
_f.create("br",{},_211,"last");
_f.create("br",{},_211,"last");
_f.create("span",{innerHTML:"* "+_13["required"]},_211,"last");
var _212=function(){
_213.hide();
_213=null;
_30.utils.withLayoutInfo(true).then(function(){
_30.refreshTitleAndMicroformat(_209);
});
};
var _214=function(_215){
var _216=_1a.substitute(_33["rs_widget_title_change_fail_message"]["default_message"],[_20e]);
_21a("error","dlgChangeTitle",_216,null,_210,false,false);
};
var _217=function(){
var _218=_20f.value;
if(_218){
_218=_218.trim();
}
if(_218&&_20d){
if(_218===_20d){
_213.hide();
_213=null;
}else{
if(_206(_218)>256){
var _219=_33["rs_widget_title_change_fail_message"]["title_too_long"];
_21a("error","dlgChangeTitle",_219,null,_210,false,false);
}else{
_200(_209,_218,_212,_214);
}
}
}else{
var _219=_33["rs_widget_title_change_fail_message"]["empty_new_title"];
_21a("error","dlgChangeTitle",_219,null,_210,false,false);
}
};
var _213=_21.popupForm(_33["rs_widget_title_change_title"],_211,_31["save"],_31["cancel"],_217,null);
};
_30.moveDown=function(_21b,_21c){
var _21d=_c.byId(_21c+"DropZone");
var _21e=_30.getColumnWidgetNodes(_21c);
for(var _21f=0;_21e&&_21f<_21e.length-1;_21f++){
var _220=_21e[_21f].getAttribute("widgetid");
if(_220===_21b){
var _221=_21f+1;
var _222=_21e[_221].getAttribute("widgetid");
_1c1(_21b,_21c,_222);
try{
_21d.insertBefore(_21e[_21f],_21e[_221+1]);
}
catch(exception){
_21d.appendChild(_21e[_21f]);
}
break;
}
}
_2d.hide(_21b+"moreActions",true,true);
var _223=_c.byId("widgetActionsMenu"+_21b);
if(_223){
_223.focus();
}
};
_30.moveUp=function(_224,_225){
var _226=_c.byId(_225+"DropZone");
var _227=_30.getColumnWidgetNodes(_225);
for(var _228=1;_227&&_228<_227.length;_228++){
var _229=_227[_228].getAttribute("widgetid");
if(_229==_224){
var _22a=_228-1;
var _22b=((_22a!==0)?_227[_22a-1].getAttribute("widgetid"):null);
_1c1(_224,_225,_22b);
_226.insertBefore(_227[_228],_227[_22a]);
break;
}
}
_2d.hide(_224+"moreActions",true,true);
var _22c=_c.byId("widgetActionsMenu"+_224);
if(_22c){
_22c.focus();
}
};
var _22d=function(_22e,_22f){
var _230=_18("div.widgetContainer").map(function(c){
return c.id.replace("widget-container-","");
}).filter(function(c){
var _231=_30.uiLocations[c];
return _231&&!_231.hidden&&_231.draggable;
});
if(_230.length<=1||-1===_230.indexOf(_22e)){
return null;
}
var _232=(_230.length+_230.indexOf(_22e)+_22f)%_230.length;
return _230[_232];
};
var _233=function(_234,_235,_236){
_235=_235||_30.getUILocation(_234);
var _237=_30.getColumnWidgetNodes(_235);
if(!_237){
return;
}
_237=_237.filter(function(w){
return (_234===w.getAttribute("widgetid"));
});
if(1!==_237.length){
return;
}
var _238=_22d(_235,_236);
if(_238){
var _239=_c.byId(_238+"DropZone");
_f.place(_237[0],_239,"last");
_1b4(_234,_238);
_30.moveWidgetToEnd(_234,_238);
_30.refresh(_234);
var _23a=_30.dropZoneObjects[_235+"DropZone"],_23b=_30.dropZoneObjects[_238+"DropZone"];
if(_23a&&_23b){
_23a.delItem(_234+"Section");
_23a.showEmptyIndicator();
_23b.setItem(_234+"Section",{node:_c.byId(_234+"Section"),id:_234+"Section",data:_234,type:["widget"]});
_23b.hideEmptyIndicator();
}
}
_2d.hide(_234+"moreActions",true,true);
var _23c=_c.byId("widgetActionsMenu"+_234);
if(_23c){
_23c.focus();
}
};
_30.moveToNextColumn=function(_23d,_23e){
_233(_23d,_23e,1);
};
_30.moveToPreviousColumn=function(_23f,_240){
_233(_23f,_240,-1);
};
var _241=function(){
if(!win.dialog1){
var _242=_c.byId("dialog1Container");
if(!_242){
_242=_f.create("div");
_242.id="dialog1Container";
_c.byId("lotusContent").appendChild(_242);
}
win.dialog1=new _1d({id:"dialog1",style:"width: 500px"},_242);
}
return win.dialog1;
};
_30.displayDialog=function(_243){
var _244=_241();
_244.setContent(_243);
try{
_244.titleBar.style.display="none";
}
catch(error1){
_20.error(error1);
}
_244.show();
var _245=_c.byId("dialog1.button");
if(_245){
_245.focus();
}
};
_30.getColumnWidgetNodes=function(_246,_247){
var _248=_c.byId(_246+"DropZone")||_c.byId("widget-container-"+_246);
if(!_248){
if(_7.isString(_246)){
return null;
}else{
_248=_c.byId(_246);
}
}
var _249=(_247?"":"> ")+"div.lotusWidget2";
return _18(_249,_248).filter(function(w){
return !!w.getAttribute("widgetid");
});
};
_30.moveWidgetToEnd=function(_24a,_24b){
var _24c=_30.getColumnWidgetNodes(_24b);
if(_24c){
var _24d=_d.get(_24c[_24c.length-1],"widgetid");
if(_24d===_24a){
if(_24c.length>1){
_24d=_d.get(_24c[_24c.length-2],"widgetid");
}else{
_24d=null;
}
}
_1c1(_24a,_24b,_24d,null,null);
}
};
_30.showFullWidgetDeleteConfirmation=function(_24e){
var _24f=true;
var _250=_30.utils.getWidgetDef(_24e);
if(_250){
var _251=_250.showFullWidgetDeleteConfirmation;
if(_251==="false"){
_24f=false;
}
}
return _24f;
};
_30.removeWidget=function(_252,_253,_254){
_20.entering("ic-core/WidgetPlacement","removeWidget",arguments);
var _255=function(){
var _256=_30.utils.getWidgetInstance(_252),_257=_30.getUILocation(_252);
if(!_30.removeWidgetInProgress){
if(_253){
_26b();
}
}
_3e.removeWidget(_252,_253).then(function(){
var _258=_264(_252);
var _259=win["_"+_252+"_iContext"];
if(_259&&_259.iScope().onRemoveWidgetUIContent){
_259.iScope().onRemoveWidgetUIContent();
}
_b3(_252);
_30.destroyWidget(_252,null,true);
_30.loadOrder=_2.filter(_30.loadOrder,function(_25a){
return (_25a&&_25a.instanceId!==_252);
});
win.setTimeout(_7.hitch(this,function(){
_30.setFocus(_258,"widgetActionsMenu"+_258);
}),0);
var _25b=_252+"Section";
var _25c=function(){
var _25d=_c.byId(_25b);
if(_25d){
_25d.parentNode.removeChild(_25d);
}
var _25e=_30.dropZoneObjects[_257+"DropZone"];
if(_25e){
_25e.showEmptyIndicator();
}
_26d();
};
var _25f=fx.wipeOut({node:_25b,duration:300,onEnd:_25c});
_25f.play();
win.WidgetPlacementConfig.lastMod=new Date().getTime();
if(_30.utils.getCallbacks("removeWidget")){
_2.forEach(_30.utils.getCallbacks("removeWidget"),function(_260){
_260(_256);
});
}
},function(){
});
};
var _261=function(){
};
var _262=_30.canRemoveWidget(_252);
if(!_262){
return;
}
var _263=_30.requestRemovalConfirmation(_254,_252,_253);
_263.then(_255,_261);
};
var _264=function(_265){
var _266=_18("div.lotusWidget2").map(function(_267){
return _267.getAttribute("widgetid");
}).filter(function(v){
return !!v;
});
var _268=_2.indexOf(_266,_265);
if(-1===_268){
_20.warn("The widget is not on the page: "+_265);
return null;
}
return _266[(_268+1)%(_266.length)];
};
var _269=function(){
var _26a="<div class=\"lotusDialogBorder\"><form class=\"lotusDialog lotusForm\">"+"<h1><img src=\""+win.WidgetPlacementConfig.applicationContext+"/nav/common/styles/images/loading.gif\" title=\""+_31["widget_AddingWidget"]+"\"> "+_31["widget_AddingWidget"]+"</h1>"+"</form></div>";
_30.displayDialog(_26a);
};
var _26b=function(){
var _26c="<div class=\"lotusDialogBorder\" role=\"alert\" aria-live=\"assertive\"><form class=\"lotusDialog lotusForm\">"+"<h1><img src=\""+win.WidgetPlacementConfig.applicationContext+"/nav/common/styles/images/loading.gif\"> "+_31["widget_RemovingWidget"]+"</h1>"+"</form></div>";
_30.displayDialog(_26c);
};
var _26d=function(){
var temp=_1e.byId("dialog1");
if(temp){
temp.hide();
}
};
_30.addWidgetToServerAndRender=function(_26e,_26f,_270,_271){
var _272=new _a("addWidgetToServerAndRender");
widgetDefIdString=_26e[0];
if(widgetDefIdString==="StatusUpdates"){
_26f="col2statusposts";
}else{
if(widgetDefIdString=="Tags"){
_26f="col1";
}
}
var _273=false;
if(_270==false||_270=="false"){
_269();
}else{
var _274=_30.utils.getWidgetInstance(_271);
if(_274&&"false"===_274.enabled){
_26f=_274.uiLocation;
}
_273=true;
}
_3e.addWidget(_26e,_26f,_270,_271).then(function(_275){
_30.loadOrder.push({instanceId:_275,uiLocation:_26f});
_30.getWidgetDocAndRenderWidget(_26e,null,_275,_26f);
var _276=_30.dropZoneObjects[_26f+"DropZone"];
if(_276){
_276.hideEmptyIndicator();
}
_26d();
if(_273){
_30.moveWidgetToEnd(_275,_26f);
}
_b6();
if(_30.utils.getCallbacks("addWidget")){
_2.forEach(_30.utils.getCallbacks("addWidget"),function(_277){
_277(_26e,_275,_26f,_270);
});
}
_272.resolve();
},function(){
_272.reject();
});
return _272;
};
var _21a=function(_278,_279,_27a,_27b,_27c,_27d,_27e){
if(_7.isString(_27c)){
_27c=_c.byId(_27c);
}
if(_27c){
var _27f=("error"===_278);
_27a=_27a||(_27f?_31["error.title.generic"]:null);
if(!_27a){
return;
}
if(true!==_27e){
_27c.innerHTML="";
}
var _280=(_27f?"ERROR":"WARNING");
var _281=_f.create("div",null,_27c,"first");
var _282=new _22({_strings:{icon_alt:_33["rs_messagebox_"+_278+"_a11y_label"],a11y_label:_33["rs_messagebox_"+_278+"_a11y_label"]},type:_22.TYPE[_280],msg:_27a,msgMore:_27b},_281);
if(false!==_27d&&_27b){
_282.showMoreNode.click();
}
}else{
_20.warn("Unable to show message in the container",_27c);
}
};
var _283=function(_284,_285,_286,_287,_288){
_21a(_284,"global",_285,_286,"headline",_287,_288);
};
var _1de=function(_289,_28a,_28b,_28c,_28d,_28e){
_21a(_28a,"widget"+_289,_28b,_28c,_289,_28d,_28e);
};
_30.showWidgetErrorInHeadline=function(_28f,_290){
_26d();
_30.removeWidgetInProgress=false;
_30.addWidgetInProgress=false;
var _291=((_28f)?(_28f.message||_28f.responseText):_28f);
_283("error",null,_291,true,_290);
};
_30.customAddWidgetErrorHandler=function(_292){
return _30.showWidgetErrorInHeadline(_292,true);
};
_30.minimizeWidget=function(_293,_294,_295,_296){
_2d.hide(_294+"moreActions",true,true);
var _297=_c.byId(_294+"SubArea");
var _298=(_10.get(_297,"display")==="none");
var _299=_294||_295;
_123(_299,!_298);
var _29a=_1e.byId(_294+"_toggleAction");
var _29b=_c.byId("widgetActionsMenu"+_294);
if(_298){
var _29c=_297.getAttribute("widgetloaded");
var _29d=_297.getAttribute("widgetneedrefresh");
if(_29d==null){
_29d="true";
}
if(_29c==="false"&&_29d==="true"){
var temp=function(){
_30.refresh(_294);
if(_296){
_10.set(_297,"display","none");
_29a.setLabel(_31["widgets_Max"]);
}else{
_10.set(_297,"display","");
_29a.setLabel(_31["widgets_Min"]);
}
};
_30.utils.withLayoutInfo().then(temp);
}else{
_10.set(_297,"display","");
_29a.setLabel(_31["widgets_Min"]);
}
}else{
_10.set(_297,"display","none");
_29a.setLabel(_31["widgets_Max"]);
}
win.setTimeout(function(){
_30.setFocus(_294,"widgetActionsMenu"+_294);
},0);
};
_30.addEditTabsWithOnclickCalls=function(_29e,_29f,_2a0,_2a1,_2a2){
return _30.addTabsWithOnclickCalls(_29e,_29f,_2a0,_2a1,_2a2,"edit");
};
_30.showFirstTab=function(_2a3,_2a4,_2a5){
if(win.WidgetPlacementConfig.TabContainerDomId){
var _2a6=_c.byId(win.WidgetPlacementConfig.TabContainerDomId);
if(_2a6){
_18("li[id$=\"_TabItem\"]",_2a6).forEach(function(node){
_e.remove(node,"lotusSelected");
_d.set(node,{"tabindex":"-1","aria-selected":"false","role":"tab"});
});
}
try{
_d.set(_c.byId(win.WidgetPlacementConfig.TabContainerDomId+"_panel"),"aria-label",_18("a._linkHolder",_c.byId(_2a4))[0].innerHTML);
}
catch(ee){
}
}
if(win.WidgetPlacementConfig.TempWidgetContainerDomId){
_30.destroyWidgetContainer(win.WidgetPlacementConfig.TempWidgetContainerDomId);
}
if(_2a3){
_2d.show(_2a3);
}
if(_2a4){
_18("#"+_2a4).forEach(function(_2a7){
_d.set(_2a7,{"tabindex":"0","aria-selected":"true"});
_e.add(_2a7,"lotusSelected");
});
}
var hash=win.location.hash;
if(hash){
var _2a8=hash.indexOf("&tab");
if(_2a8>0){
_30.changeHash(hash.substr(0,_2a8));
}
}
if(_2a5){
_2a5();
}
return false;
};
_30.addTabsWithOnclickCalls=function(_2a9,_2aa,_2ab,_2ac,_2ad,_2ae,_2af){
var _2b0=null;
_2.forEach(_30.uiLocations,function(loc){
_2d.show("widget-container-"+loc,false,true);
});
_2.forEach((win.WidgetPlacementConfig.hideElements||[]),function(elem){
_2d.hide(elem,false,true);
});
if(_2ac){
win.WidgetPlacementConfig.cancelCallBack=_2ac;
}
var _2b1=null;
var _2b2=null;
var _2b3=false;
var _2b4=null;
if(_2af&&_2af.length){
var _2b5=_2af[0].component;
if(_2b5&&_2b5==="communities:content"){
_2b3=true;
}
_2b1=_2af[0].selectTab;
_2b2=_2af[0].selectTabInst;
var hash="";
var key=_2af[0].entryValue;
if(key){
if(_2af[0].entryName==="searchKeywords"){
hash="query="+key;
}else{
if(_2af[0].entryName==="tagCloudItemValue"){
hash="tag="+key;
}
}
}
if(_2af[0].searchKeywords){
if(hash){
hash+="&";
}
hash+="query="+_2af[0].searchKeywords;
}
if(_2af[0].tagCloudItemValue){
if(hash){
hash+="&";
}
hash+="tag="+_2af[0].tagCloudItemValue;
}
if(_2af[0].person){
if(hash){
hash+="&";
}
hash+="person="+_2af[0].person;
}
if(hash){
if(_2b2){
hash+="&tabinst="+_2b2;
}else{
if(_2b1){
hash+="&tab="+_2b1;
}
}
_30.changeHash(hash);
}
if(win.searchPanel){
win.searchPanel.setSearchBarMode(true);
}
_2b4=_2af[0].moreActionsContainerNode;
}
var _2b6=_94();
var _2b7=(_2b6&&typeof (_2b6.profileType)==="string"&&_7.trim(_2b6.profileType).length>0?_2b6.profileType:"default");
var _2b8=_30.utils.getPageWidgetInstances(win.WidgetPlacementConfig.defaultPageId,null,_2b7);
if(!_2b8||!_2b8.length){
_2b8=_30.utils.getPageWidgetInstances(win.WidgetPlacementConfig.defaultPageId,null,"default");
}
var _2b9=(_30.getUserProfileOverrideProperty("canPersonalize")==="true");
var _2ba=function(node,opts){
var _2bb=opts.defNode.defId;
var _2bc=opts.instNode.instanceId||_2bb;
var _2bd=_2d.getURLParam("tabinst",true);
_18("._iconHolder",node.parentNode).forEach(function(_2be){
_10.set(_2be,"display","none");
});
if(!_2b4){
_18("._iconHolder",node).forEach(function(_2bf){
_10.set(_2bf,"display","inline");
});
}
try{
_d.set(_c.byId(win.WidgetPlacementConfig.TabContainerDomId+"_panel"),"aria-label",_18("a._linkHolder",node)[0].innerHTML);
}
catch(ee){
}
if(_30.infoMessage==null&&_c.byId("editWarningMessage")){
_30.infoMessage=new _22({canClose:true,_strings:{icon_alt:_33["rs_messagebox_info_icon_alt"],a11y_label:_33["rs_messagebox_info_a11y_label"],close_btn_title:_33["rs_close"],close_btn_alt:_33["rs_close"]},type:_22.TYPE.INFO,msg:_31["switchTabWarning"]},_f.create("div"));
_f.place(_30.infoMessage.domNode,_c.byId("editWarningMessage"),"only");
}
if(opts.destroyContainer){
_30.destroyWidgetContainer(win.WidgetPlacementConfig.TempWidgetContainerDomId,false);
}
_30.destroyWidget(_2bc,null,false,true,false);
_30.getWidgetDocAndRenderWidget(_2bb,opts.defNode,_2bc,win.WidgetPlacementConfig.TempWidgetContainerDomId,opts.widgetMode,"skinless",false,false,opts.attributesMap);
if(opts.initDispId){
_2d.hide(opts.initDispId,false,true);
}
if(opts.attributesMap&&opts.attributesMap.length){
var hash="";
var _2c0=_2d.getURLParam("query",true);
if(_2c0){
hash+="query="+_2c0;
}
var _2c1=_2d.getURLParam("tag",true);
if(_2c1){
if(hash){
hash+="&";
}
hash+="tag="+_2c1;
}
var _2c2=_2d.getURLParam("person",true);
if(_2c2){
if(hash){
hash+="&";
}
hash+="person="+_2c2;
}
_2b1=_2af[0].selectTab;
_2b2=_2af[0].selectTabInst;
if(_2b2){
hash+="&tabinst="+_2bc;
}else{
if(_2b1){
hash+="&tab="+_2bb;
}else{
hash+="&tabinst="+_2bc;
}
}
_30.changeHash(hash);
if(win.searchPanel){
win.searchPanel.setSearchBarMode(true);
}
}
if(_2b4){
var _2c3=_1e.byId(opts.instId+"moreActions");
if(_2c3){
_2c3.destroy();
}
if(!_7.isObject(_30._moreActionsConnect)){
_30._moreActionsConnect={};
}
if(_30._moreActionsConnect[opts.instId]){
_30._moreActionsConnect[opts.instId].remove();
delete _30._moreActionsConnect[opts.instId];
}
var _2c4=_2b4.id+"_menuHolder";
_18("."+_2c4).forEach(function(node){
node.parentNode.removeChild(node);
});
_f.place("<div dojoType=\"dijit.Menu\" id=\""+opts.instId+"moreActions\"  class=\""+_2c4+"\" style=\"display:none;\"></div>",_2b4,"after");
var _2c5=_30.utils.getEscapedWidgetName(opts.defNode,opts.instNode,true,_2ae||"view");
var _2c6=_31["actions_alt"]||"Actions for: ${0}";
_2c6=_1a.substitute(_2c6,[_2c5]);
_18("a",_2b4).forEach(function(node){
_d.set(node,{title:_2c6,"aria-label":_2c6});
});
_18(".lotusAltText",_2b4).forEach(function(node){
_d.set(node,{innerHTML:_2c6});
});
var _2c7=_c.byId(opts.instId+"moreActions");
_f.place(_f.create("div",{dojoType:"dijit.MenuItem",label:_31["refresh"],"onclick":"lconn.core.WidgetPlacement.fetchAndRefresh(\""+opts.instId+"\");"}),_2c7,"last");
var _2c8=opts.defNode.helpLink;
if(_2c8&&_2c8.length){
_2c8=_7b(_2c8);
var _2c9=_f.create("div",{dojoType:"dijit.MenuItem",label:_31["help"],title:_31["link.window.openNewWindow"],"onclick":"lconn.core.utilities.hide(\""+opts.instId+"moreActions\", true, true);"+"lconn.core.WidgetPlacement.openHelpWindow(\""+_2c8+"\");"});
_f.place(_2c9,_2c7,"last");
}
_17.parse(_2c7.parentNode);
_30._moreActionsConnect[opts.instId]=on(_2b4,"click",function(evt){
_30.openMenu(evt,opts.instId);
evt.preventDefault();
evt.stopPropagation();
});
}
};
var _2ca=function(opts){
var _2cb=50;
var _2cc=opts.defNode.defId;
var _2cd=_30.utils.getEscapedWidgetName(opts.defNode,opts.instNode,true,_2ae||"view");
var _2ce=_30.utils.getWidgetName(opts.defNode,opts.instNode,_2ae||"view");
if(_2cd.length>_2cb){
_2cd=_2cd.substring(0,_2cb)+"...";
}
var li=_c.byId(opts.instId+"_TabItem");
if(li==null){
li=_f.create("li",{id:opts.instId+"_TabItem",role:"tab",title:_2ce});
_f.place(li,_2a9,"last");
}
_d.set(li,{itemidx:opts.itemIdx,innerHTML:"<a tabindex=\"-1\" class=\"_linkHolder lotusLeft\">"+_2cd+"</a>"+"<a class=\"_iconHolder lotusIcon lotusLeft\" style=\"padding: 0; display: none;\"></a>"+"<div class=\"_menuHolder\" style=\"display: none;\"><div>"});
on(li,"click",function(evt){
_2ba(li,opts);
evt.preventDefault(),evt.stopPropagation();
return false;
});
if(!opts.showMenu){
_18("._iconHolder",li).forEach(_f.destroy);
_18("div._menuHolder",li).forEach(_f.destroy);
}else{
if(!_2b4){
var _2cf=_18("div._menuHolder",li)[0];
_d.set(_2cf,{id:opts.instId+"moreActions",dojoType:"dijit.Menu"});
var _2d0=_f.create("div",{dojoType:"dijit.MenuItem",label:_31["refresh"],"onclick":"lconn.core.WidgetPlacement.fetchAndRefresh(\""+opts.instId+"\");"});
_f.place(_2d0,_2cf,"last");
var _2d1=opts.defNode.helpLink;
if(_2d1&&_2d1.length){
_2d1=_7b(_2d1);
var _2d2=_f.create("div",{dojoType:"dijit.MenuItem",label:_31["help"],title:_31["link.window.openNewWindow"],"onclick":"lconn.core.utilities.hide(\""+_2cf.id+"\", true, true);"+"lconn.core.WidgetPlacement.openHelpWindow(\""+_2d1+"\");"});
_f.place(_2d2,_2cf,"last");
}
var _2d3=_31["actions_alt"]||"Actions for: ${0}";
_2d3=_1a.substitute(_2d3,[_2cd]);
var _2d4=_18("._iconHolder",li)[0];
_d.set(_2d4,{id:opts.instId+"_MenuIcon",role:"button","aria-haspopup":"true",href:"javascript:void(0);",innerHTML:"<img class=\"lotusArrow\" alt=\""+_2d3+"\" title=\""+_2d3+"\" src=\""+_1c.prototype._blankGif+"\"/><span class=\"lotusAltText\">&#9660;</span>"});
_e.add(_2d4,"lotusIcon");
on(_2d4,"click",function(evt){
_30.openMenu(evt,opts.instId);
evt.preventDefault();
evt.stopPropagation();
});
}
}
_f.place(li,_2a9);
_17.parse(li);
return li;
};
_2b8=_2b8||[];
_2.forEach(_2b8,_7.hitch(this,function(_2d5,idx){
var _2d6=_2d5.defIdRef;
if(_2b1==null){
_2b1=_2d6;
}
var _2d7=_30.utils.getWidgetDef(_2d6);
if(_2d7==null){
_20.warn("Unable to find widget definition for: "+_2d6+", it will be skipped.");
return;
}
var _2d8=_2d5.uiLocation,_2d9=_2d5.instanceId||_2d6;
if(_2d9===_2aa){
return;
}
if(!_30.canAddWidget(_2d7,win.WidgetPlacementConfig,_2b9,_2d5,_2b3)){
return;
}
var _2da={containerId:_2a9,tempContainerId:_2aa,defNode:_2d7,instNode:_2d5,instId:_2d9,initDispId:_2ab,cancelCallBack:_2ac,widgetMode:_2ae,attributesMap:_7.clone(_2af),itemIdx:idx,showMenu:false,destroyContainer:true};
var _2db=null;
if(_85(_2ae,_2d7)){
if(!((_2d6==="description")&&(_2ae==="edit"))){
_2db=_2ca(_2da);
}
}else{
if(_2d8===_2aa){
_2da.showMenu=true;
_2db=_2ca(_2da);
}
}
if(_2d9===_2b2||_2d6===_2b1){
_2b0=_2db;
}
}));
win.WidgetPlacementConfig.isTabbedFullPageWidgetRendering=true;
win.WidgetPlacementConfig.TempWidgetContainerDomId=_2aa;
win.WidgetPlacementConfig.TabContainerDomId=_2a9;
if(_30.aria&&typeof _30.aria.TabPanel==="function"){
new _30.aria.TabPanel(_2a9);
if(_2b0!=null){
_2b0.click();
}
}
_18("a._iconHolder",_c.byId(_2a9)).forEach(function(_2dc){
var _2dd=_18("img.lotusArrow",_2dc);
if(_2dd.length){
var _2de=_18("._linkHolder",_2dc.parentNode);
if(_2de.length){
var h=_1.coords(_2de[0]).h-_10.get(_2de[0],"borderBottomWidth");
if(!has("ie")){
h-=_10.get(_2de[0],"borderTopWidth");
}
_10.set(_2dd[0],"height",h+"px");
}
}
});
};
_30.URLChange=function(URL){
_20.entering("lconn.core.WidgetPlacement","URLChange",arguments);
var _2df=URL.indexOf("#");
if(_2df===-1||URL.substring(_2df).length===1||URL.substring(_2df)==="#overview"){
_30.reloadOverviewPage();
return;
}
var _2e0=_2d.getURLParam("fullpageWidgetId",true);
if(_2e0&&_2e0!==_30.currentFullpageWidgetInstanceId){
_30.loadFullpageView(_2e0,null,false,true,true);
return;
}
var _2e1=_2d.getURLParam("query",true);
if(_2e1&&_10.get("searchCommunityForm","display")==="none"){
if(_30.utils.getHandlers("handleSearchRequest")){
var _2e2=_2d.getURLParam("tabinst",true)||null,_2e3=_2d.getURLParam("tab",true)||null;
var opts={tab:_2e3,tabinst:_2e2,query:_2e1};
_2.forEach(_30.utils.getHandlers("handleSearchRequest"),function(_2e4){
_2e4(opts);
});
}
}
};
_30.init=function(mode){
var _2e5=_2d.getURLParam("fullpageWidgetId",true),_2e6=_2d.getURLParam("query",true),_2e7=_2d.getURLParam("tag",true);
var _2e8=("edit"===mode),_2e9=!!_2e5,_2ea=!_2e9&&(!!_2e6||!!_2e7),_2eb=!_2e9&&!_2ea&&!_2e8;
var _2ec=!_2e8;
if(_2e9){
mode="fullpage";
}else{
if(_2ea){
mode="search";
}else{
if(_30.isCommunitiesPage&&_2eb){
mode="view";
}
}
}
var _2ed=_30.placeWidgetMetadata(_2ec,mode);
if(_2eb){
_2.forEach(win.WidgetPlacementConfig.hideElements,function(_2ee){
_2d.show(_2ee,false,false,true);
});
}
if(_2e9||_1b2()){
_30.hideColumn("col1");
}
_a5();
if(typeof win.widgetUserInfo!=="undefined"&&typeof win.userid==="undefined"){
win.userid=win.widgetUserInfo.userid;
}
_79().then(_7.hitch(this,function(_2ef){
cre$.WidgetRefInternal.prototype.handleEvent=function(_2f0,_2f1,_2f2){
if(typeof _2f0==="undefined"||_2f0===null){
return false;
}
if(_2f0===this._iContext.constants.predefinedEvents.onModeChanged){
if(win.WidgetPlacementConfig.isTabbedFullPageWidgetRendering){
_30.handleModeExit();
}else{
if(_2f2&&_2f2.newMode==="fullpage"){
widgetId=this._iContext._iEvents._widgetId;
if(widgetId){
_30.changeHash("fullpageWidgetId="+widgetId);
}
}
return this.handleModeChange(_2f2.newMode);
}
}else{
if(_2f2&&_2f2.newMode&&this._isOnModeEvent(_2f0,_2f1,_2f2)){
this.invokeOnModeMethod(_2f2.newMode);
return true;
}
}
return this._handleEventInternal(_2f0,_2f1,_2f2);
};
if(_38&&_2eb){
var _2f3={};
if(win.WidgetPlacementConfig.resourceType){
_2f3.resourceType=win.WidgetPlacementConfig.resourceType;
}
if(win.WidgetPlacementConfig.resourceId){
_2f3.resourceId=win.WidgetPlacementConfig.resourceId;
}
if(win.WidgetPlacementConfig.pageId){
_2f3.page=win.WidgetPlacementConfig.pageId;
}
var _2f4=_16.objectToQuery(_2f3);
if(_2f4){
_2f4="?"+_2f4;
}
var url=win.WidgetPlacementConfig.applicationContext+"/widgetProcess.do"+_2f4;
var st=cre$.internalutil.getCREContainerToken();
st=(st&&st.token)?st.token:"";
_19(url,{method:"GET",handleAs:"json",headers:{"X-Shindig-ST":st},sync:true}).then(function(_2f5){
if(_2f5.sc){
_283("error",_33["rs_widgets_loading_error_title"],_33["rs_widget_loading_error_message"],false,true);
_20.error("Failed to get data from "+url+", error: \n"+_2f5.message);
return;
}
var _2f6=_30f(_2f5.pageData);
_2ed.then(_7.hitch(this,function(_2f7){
var _2f8=_2ef.init(_2f6,true);
var _2f9=function(_2fa){
_20.debug(_2fa);
};
var _2fb=function(_2fc){
_2.forEach(_2fc,function(_2fd){
if(!_2fd){
return false;
}
if(_7.isString(_2fd)){
_20.error("Failed to load widget(s), error: \n"+_2fd);
}else{
if(_7.isObject(_2fd)){
if(_7.isFunction(_2fd.getWidgetRef)){
_2fd=_2fd.getWidgetRef();
}
if(_7.isFunction(_2fd.isError)&&_2fd.isError()){
var _2fe=_2fd.getError().message;
var _2ff=_2fd.getWidgetId();
_1df(_2ff,_2fe);
}
}
}
});
};
_2f8.then(_2f9,_2fb);
}));
},function(_300){
_283("error",_33["rs_widgets_loading_error_title"],_33["rs_widget_loading_error_message"],false,true);
_20.error("Failed to get data from "+url+", error: \n"+_300);
});
}else{
var _301={};
_30c(_301);
_2ef.init(_301,true);
}
cre$.iwidget.iContext.prototype.canNavigateAway=null;
cre$.iwidget.iContext.prototype.getUserProfile=function(){
if(!this._userProfile){
var ss=this._iRuntime.getStateSet(this._instanceData.moduleId,this.constants.USERPROFILE,{});
this._userProfile=new cre$.iwidget.UserProfile(this._instanceData.moduleId,ss);
this._userProfile._iContext=this;
this._userProfile.widgetUserInfo=this._userProfile.user;
}
return this._userProfile;
};
_4("com.ibm.cre.iwidget.iContext",com.ibm.cre.iwidget.iContext,{constructor:function(_302,_303){
var _304=cre$.iRuntime.getProxyUrl();
var _305=null;
var _306=null;
var uri=_304.replace("%host%",document.location.host);
var _307=shindig.uri(uri);
var _308=_307.getPath();
var _309=_308+"/";
if(_302.instanceMetaData){
_309+=_302.instanceMetaData.moduleId;
}else{
_309+=_302.getModuleId();
}
_307.setPath(_309);
uri=_307.toString();
var _30a=shindig.uri().removePrefix(uri);
if(_30a.indexOf("/")>0){
_305=_30a.substring(0,_30a.indexOf("/"));
_306=_30a.substring(_30a.indexOf("/"),_30a.indexOf("?"));
}else{
_305=_30a;
_306="/";
}
if(_305.indexOf(":")>0){
_305=this._proxyCookieDomain.substring(0,this._proxyCookieDomain.indexOf(":"));
}
_9("widgetid",null,{path:_306,domain:_305,expires:-1});
_9("st",null,{path:_306,domain:_305,expires:-1});
},getTheme:function(){
return _91(this.getWidgetId());
}});
_327(_2ef);
if(_30.URLChangeCallBack==null){
_30.URLChangeCallBack=[_30.URLChange];
win.registerBackButtonSupport();
}
if(_2eb&&!_38||_2e8){
_2ed.then(_7.hitch(this,function(_30b){
_30.renderWidgets(_30b);
}));
}else{
if(_2e9){
_30.onlyFullPageWidgetLoaded=true;
_30.loadFullpageView(_2e5,null,"initial",false);
}
}
}));
};
var _30c=function(_30d,_30e){
if(!_30e){
_30e={"id":"userProfile","item":[{"id":"viewer","value":win.widgetUserInfo}]};
}
_30d.userProfile=_30e;
return _30d;
};
var _30f=function(_310){
var _311=_310.instanceData,_312=_310.widgetMetadata,_313=_94();
_30c(_310);
var _314={};
var _315=_2.filter(_312,function(_316){
if(!!_316.error){
_314[_316.definitionUrl]=_316;
return false;
}
return true;
});
var _317={};
var _318=_2.filter(_311,function(_319){
var _31a=_c.byId(_319.domId);
if(!_31a){
return false;
}
if(_314[_319.definition]){
_1df(_319.domId,_314[_319.definition].error.message);
return false;
}
var _31b=_30.getUILocation(_319.domId);
var _31c=_30.utils.getWidgetDefByInstance(_319.domId);
var _31d=_8e(_31b,_31c);
if(!_31d){
_1dc(_319.domId);
return false;
}
_317[_319.definition]=true;
return true;
});
var _31e=_2.filter(_315,function(_31f){
return (_317[_31f.definitionUrl]===true);
});
_2.forEach(_318,function(data){
var _320=data.instanceMetaData.itemSet;
_2.forEach(_320,function(v){
if("attributes"!==v.id){
return;
}
var item=v.item;
_2.forEach(item,function(it){
var _321=it.value;
if("computedWidgetTitle"===it.id){
_321=_7f(_321);
}
_321=_7b(_321);
it.value=_321;
});
if(win.WidgetPlacementConfig.isProfilesEnv){
if(_313.uid!=null){
item.push({"id":"profileDisplayedUserUID","value":_313.uid});
}
if(_313.key!=null){
item.push({"id":"profileDisplayedUserKey","value":_313.key});
}
}
if(win.WidgetPlacementConfig.resourceId!=null){
item.push({"id":"resourceId","value":win.WidgetPlacementConfig.resourceId});
}
if(win.WidgetPlacementConfig.parentResourceId!=null){
item.push({"id":"parentResourceId","value":win.WidgetPlacementConfig.parentResourceId});
}
if(win.WidgetPlacementConfig.resourceType!=null){
item.push({"id":"resourceType","value":win.WidgetPlacementConfig.resourceType});
}
if(win.WidgetPlacementConfig.resourceName!=null){
item.push({"id":"resourceName","value":win.WidgetPlacementConfig.resourceName});
}
});
});
_310.instanceData=_318;
_310.widgetMetadata=_31e;
return _310;
};
var _322=function(_323){
var _324={};
var _325=_323.getAllNames();
for(var i=0,name,_326;i<_325.length;i++){
name=_325[i];
_326=_323.getItemValue(name);
_324[name]=_326;
}
return _324;
};
var _327=function(_328){
var _329={};
_329.update=function(_32a,_32b,sync){
var _32c=new cre$.promise.Promise();
var _32d=_322(_32b);
_3e.savePreference(_32a,_32d).then(function(_32e){
var _32f=function(){
_32c.resolve(_32b);
_30.refreshTitleAndMicroformat(_32a);
};
var _330=function(_331,_332){
_32c.reject();
};
_30.utils.withLayoutInfo(true,_330).then(_32f);
},function(_333){
_32c.reject(_333);
});
return _32c;
};
_329.getItemSets=function(_334,id,mode){
var _335=_328.getWidgetById(_334).widgetObject.getIContext();
return cre$.promise.resolved(_335.getItemSet(id,mode));
};
cre$.services.getServiceManager().setService(cre$.services.ITEMSETPERSISTENCE,_329,"");
};
_30.initEdit=function(){
_30.init("edit");
};
_30.setFocus=function(_336,_337){
var _338=_c.byId(_336+"Section");
if(_338){
var _339=_18("#"+_337,_338);
if(_339&&_339.length){
try{
if(_339[0].focus){
_339[0].focus();
}
}
catch(e){
_20.error(e.message);
}
}
}
};
_30.changeLayout=function(_33a,_33b){
if(!_7.isString(_33a)||""===_33a){
_20.warn("new layout is invalid: "+_33a);
return;
}
_3e.changeLayout(_33a).then(function(){
if(_7.isFunction(_33b)){
_33b();
}
});
};
return _30;
});


;define("ic-core/WidgetPlacement",["dojo","dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/_base/window","dojo/_base/xhr","dojo/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/has","dojo/hash","dojo/i18n","dojo/i18n!./config/nls/widgetbundles","dojo/i18n!./nls/strings","dojo/i18n!./nls/widgets","dojo/keys","dojo/on","dojo/query","dojo/request","dojo/string","dojo/topic","./aria/TabPanel","./aria/Toolbar","./config/features","./config/properties","./config/services","./errorhandling","./help","./HTMLUtil","./url","./util/widgetPlacementConfig","./utilities","./WidgetPlacementCRE","./xpath","ic-gadget/util/trace","ic-ui/DialogUtil"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,on,_15,_16,_17,_18,_19,_1a,_e,_1b,_1c,_1d,_1e,_1f,_20,_21,_22,_23,_24,_25,_26){
var win=_6.global;
var _27=((win.ibmConfig)?win.ibmConfig.serviceName:null),_28=("communities"===_27),_29=("profiles"===_27);
var wp=_23;
wp.isCommunitiesPage=_28;
wp.isProfilesPage=_29;
var _2a=_13,_2b=null,_2c=_12;
var _2d=function(_2e){
if(/{[^}]+:[^}]+}/.test(_2e)){
return _2e;
}
var _2f=win.WidgetPlacementConfig.params,_30=_2e.replace(/{/g,"${");
return _17.substitute(_30,_2f,function(v,k){
return (v?v:"{"+k+"}");
});
};
var _31=function(){
var _32=_9.byId("lotusProfileNavBar")||_9.byId("lotusNavBar");
return _32;
};
var _33=function(_34){
var _35=((_34)?_34+"_navItem":win.WidgetPlacementConfig.navBarOverViewElementId);
if(!_35){
return null;
}
return _9.byId(_35);
};
var _36=function(_37){
var _38=_31();
if(!_38){
return;
}
var _39=_33(_37);
if(_39){
var _3a=_15("li",_38)||[];
_2.forEach(_3a,function(_3b){
if(""!==_3b.className){
_b.remove(_3b,"lotusSelected");
}
});
_b.add(_39,"lotusSelected");
var _3c=_3d(_39);
if(_3c){
wp.setTitle(_3c);
var _3e=_9.byId("dropdownNavMenuSelection");
if(_3e){
_a.set(_3e,"innerText",_3c);
}
}
}
};
var _3f=function(_40,_41,_42){
if(!_41){
return false;
}
if("undefined"===typeof _42){
_42=true;
}
var _43=_41.modes||"view";
return ((!_40&&!_42)||(_40&&_43.indexOf(_40)!==-1));
};
wp.utils={};
if(_e("json-widget-metadata")){
_5.mixin(wp.utils,(function(){
var _44=function(_45,_46,doc){
doc=doc||win.WidgetPlacementConfig.widgetConfigDocument;
_45=_45||win.WidgetPlacementConfig.pageId||win.WidgetPlacementConfig.defaultPageId;
_46=_46||"default";
var _47=_2.filter(doc.layouts,function(_48){
return _48.resourceSubType=_46;
});
if(!_47.length){
return null;
}
var _49=_2.filter(_47[0].pages,function(_4a){
return (_4a.pageId===_45);
});
if(!_49.length){
return null;
}
return _49[0];
};
var _4b=function(_4c,doc){
if(!_4c){
return null;
}
if(_5.isArray(_4c)){
_4c=_4c[0];
}
doc=doc||win.WidgetPlacementConfig.widgetConfigDocument;
var _4d=_2.filter(doc.definitions,function(def){
return (def&&def.payload&&def.payload.defId===_4c);
});
return ((_4d&&_4d.length)?_4d[0].payload:null);
};
var _4e=function(_4f,doc,_50){
if(!_4f){
return null;
}
if(_5.isArray(_4f)){
_4f=_4f[0];
}
var _51=_44(_50,null,doc);
if(!_51){
return null;
}
var _52=_2.filter(_51.widgetInstances,function(_53){
return (_53.instanceId===_4f);
});
if(!_52.length){
_52=_2.filter(_51.widgetInstances,function(_54){
return (_54.defIdRef===_4f);
});
}
return ((_52&&_52.length)?_52[0]:null);
};
var _55=function(def,doc,_56){
if(!def){
return null;
}
if(_5.isArray(def)){
def=def[0];
}
def=def.defId||def;
var _57=_44(_56,null,doc);
if(!_57){
return null;
}
var _58=_2.filter(_57.widgetInstances,function(_59){
return (_59.defIdRef===def);
});
return _58;
};
var _5a=function(_5b,doc,_5c){
if(!_5b){
return null;
}
if(_5.isArray(_5b)){
_5b=_5b[0];
}
_5b=(_5.isString(_5b)?_4e(_5b,doc,_5c):_5b);
var _5d=(_5b?_5b["defIdRef"]:null);
return _4b(_5d,doc);
};
var _5e=function(_5f,doc,_60){
var _61=_44(_5f,_60,doc);
return (_61?_61.widgetInstances:null);
};
var _62=function(doc){
doc=doc||win.WidgetPlacementConfig.widgetConfigDocument;
var _63={};
var _64=_2.map(doc.definitions,function(def){
if(!def||!def.payload){
return null;
}
var _65=def.payload;
if(_65.defId){
if(_63[_65.defId]){
return null;
}else{
_63[_65.defId]=true;
return _65;
}
}else{
return _65;
}
});
_64=_2.filter(_64,function(def){
return !!def;
});
return _64;
};
var _66=function(_67,doc,_68,_69){
if(!_67){
return false;
}
if(_69){
var _6a=_67.instanceId||_67;
if(!_6a){
return false;
}
var _6b=_4e(_6a,doc,_68);
if(!_6b){
return false;
}
_6b.enabled="true";
}else{
if(!_67.defIdRef||!_67.uiLocation){
return false;
}
var _6c=_44(_68,null,doc);
if(!_6c){
return false;
}
_6c.widgetInstances.push(_67);
}
return true;
};
var _6d=function(_6e,doc,_6f,_70){
if(!_6e){
return false;
}
if(_70){
var _71=_4e(_6e,doc,_6f);
if(!_71){
return false;
}
_71.enabled="false";
}else{
var _72=_44(_6f,null,doc);
if(!_72){
return false;
}
_72.widgetInstances=_2.filter(_72.widgetInstances,function(_73){
return (_73&&_73.instanceId!==_6e);
});
}
return true;
};
var _74=function(_75,_76){
var _77=new _8(),url;
if(!win.WidgetPlacementConfig.widgetConfigDocument||true===_75||true===win.staleXMLConfig){
url=win.WidgetPlacementConfig.layoutInfoUrl+"&format=json";
if(!win.staleXMLConfig){
url+="&lastMod="+win.WidgetPlacementConfig.lastMod;
}
if("undefined"!==typeof win.WidgetPlacementConfig.needsMigration){
if(win.WidgetPlacementConfig.needsMigration==true){
url+="&needsMigration=true";
}
}
if(win.WidgetPlacementConfig.debug){
console.info("Using URL:"+url);
}
_7.get({url:url,handleAs:"json",sync:true,load:function(_78){
win.WidgetPlacementConfig.widgetConfigDocument=_78;
_77.resolve();
},error:_76||_1d.DefaultXHRErrorHandler});
win.staleXMLConfig=false;
}else{
_77.resolve();
}
return _77;
};
var _79=function(){
win.WidgetPlacementConfig.widgetConfigDocument=null;
};
var _7a={getWidgetDef:_4b,getAllWidgetDefs:_62,getWidgetInstance:_4e,getWidgetInstancesByDef:_55,getWidgetDefByInstance:_5a,getPageWidgetInstances:_5e,addWidgetInstance:_66,removeWidgetInstance:_6d,withLayoutInfo:_74,resetLayoutInfo:_79};
return _7a;
})());
}else{
_5.mixin(wp.utils,(function(){
var _7b="/tns:widgets/tns:layout/tns:page[@pageId=\"%PAGE_ID%\"]/tns:widgetInstance[@instanceId=\"%INST_ID%\"]",_7c="/tns:widgets/tns:layout/tns:page[@pageId=\"%PAGE_ID%\"]/tns:widgetInstance[@defIdRef=\"%DEF_ID%\"]",_7d="/tns:widgets/tns:definitions/tns:widgetDef[@defId=\"%DEF_ID%\"]",_7e="/tns:widgets/tns:layout%LAYOUT_OPTIONS%/tns:page[@pageId=\"%PAGE_ID%\"]/tns:widgetInstance",_7f="/tns:widgets/tns:layout/tns:page[@pageId=\"%PAGE_ID%\"]",_80="/tns:widgets/tns:definitions/tns:widgetDef";
var _81=function(_82){
if(!_82){
return null;
}
var _83={};
_2.forEach(_82.attributes,function(_84){
_83[_84.name]=_84.value;
});
var _85=_82.getElementsByTagName("configData"),_86=_82.getElementsByTagName("itemSet");
var _87=[];
if(_85.length){
var _88=_85[0].getElementsByTagName("attr");
_2.forEach(_88,function(_89){
_87.push({"key":_89.getAttribute("key"),"value":_89.getAttribute("value")});
});
}
_83.configData=_87;
_87=[];
if(_86.length){
var _8a=_86[0].getElementsByTagName("item");
_2.forEach(_8a,function(_8b){
_87.push({"name":_8b.getAttribute("name"),"value":_8b.getAttribute("value")});
});
}
_83.itemSet=_87;
return _83;
};
var _8c=(function(){
try{
if(!_e("ie")&&!_e("ff")){
return !!win.navigator.userAgent.match(/Trident\/7\.0/);
}
}
catch(e){
}
return false;
})();
var _8d=function(_8e,_8f){
if(!_8e){
return null;
}
if(_5.isArray(_8e)){
_8e=_8e[0];
}
var _90=null;
if(_e("ie-native-mode")||_8c){
_90=_21.getDefinitionById(_8e);
}else{
var doc=((_8f)?_8f:win.WidgetPlacementConfig.widgetConfigXMLDocument),exp=_7d.replace("%DEF_ID%",_8e);
_90=_24.selectSingleNode(exp,doc);
}
return _81(_90);
};
var _91=function(_92,_93,_94,_95){
if(!_92){
return null;
}
if(_5.isArray(_92)){
_92=_92[0];
}
_94=_94||win.WidgetPlacementConfig.pageId||win.WidgetPlacementConfig.defaultPageId;
var _96=null;
if(_e("ie-native-mode")||_8c){
_96=_21.getInstanceByInstId(_92,_94);
if(!_96){
var _97=_92;
_96=_21.getInstancesByDefId(_97,_94)[0];
}
}else{
var doc=_93||win.WidgetPlacementConfig.widgetConfigXMLDocument,exp=_7b.replace("%PAGE_ID%",_94).replace("%INST_ID%",_92),_96=_24.selectSingleNode(exp,doc);
if(!_96){
var _97=_92;
exp=_7c.replace("%PAGE_ID%",_94).replace("%DEF_ID%",_97);
_96=_24.selectSingleNode(exp,doc);
}
}
if(_95===false){
return _96;
}else{
return _81(_96);
}
};
var _98=function(def,_99,_9a){
if(!def){
return null;
}
if(_5.isArray(def)){
def=def[0];
}
_9a=_9a||win.WidgetPlacementConfig.pageId||win.WidgetPlacementConfig.defaultPageId;
def=def.defId||def;
var _9b=null;
if(_e("ie-native-mode")||_8c){
_9b=_21.getInstancesByDefId(def,_9a);
}else{
var doc=_99||win.WidgetPlacementConfig.widgetConfigXMLDocument,exp=_7c.replace("%PAGE_ID%",_9a).replace("%DEF_ID%",def);
_9b=_24.selectNodes(exp,doc);
}
return _2.map(_9b,_81);
};
var _9c=function(_9d,doc,_9e){
if(!_9d){
return null;
}
if(_5.isArray(_9d)){
_9d=_9d[0];
}
_9e=_9e||win.WidgetPlacementConfig.pageId||win.WidgetPlacementConfig.defaultPageId;
doc=doc||win.WidgetPlacementConfig.widgetConfigXMLDocument;
_9d=(_5.isString(_9d)?_91(_9d,doc,_9e):_9d);
var _9f=(_9d?_9d["defIdRef"]:null);
return _8d(_9f,doc);
};
var _a0=function(_a1,_a2,_a3){
_a1=_a1||win.WidgetPlacementConfig.pageId||win.WidgetPlacementConfig.defaultPageId;
var _a4=null;
if(_e("ie-native-mode")||_8c){
_a4=_21.getInstances(_a1);
}else{
var doc=_a2||win.WidgetPlacementConfig.widgetConfigXMLDocument,exp=_7e.replace("%PAGE_ID%",_a1);
if(_a3){
exp=exp.replace("%LAYOUT_OPTIONS%","[@resourceSubType=\"%TYPE%\"]").replace("%TYPE%",_a3);
}else{
exp=exp.replace("%LAYOUT_OPTIONS%","");
}
_a4=_24.selectNodes(exp,doc);
}
return _2.map(_a4,_81);
};
var _a5=function(_a6){
var _a7=null;
if(_e("ie-native-mode")||_8c){
_a7=_21.getDefinitions();
}else{
var doc=_a6||win.WidgetPlacementConfig.widgetConfigXMLDocument;
_a7=_24.selectNodes(_80,doc);
}
var _a8={};
var _a9=_2.map(_a7,_81);
_a9=_2.filter(_a9,function(def){
if(!def||!def.defId||_a8[def.defId]){
return false;
}else{
_a8[def.defId]=true;
return true;
}
});
return _a9;
};
var _aa=function(_ab,doc,_ac,_ad){
if(!_ab){
return false;
}
doc=doc||win.WidgetPlacementConfig.widgetConfigXMLDocument;
_ac=_ac||win.WidgetPlacementConfig.pageId||win.WidgetPlacementConfig.defaultPageId;
var _ae=null;
if(_ad){
var _af=_ab.instanceId||_ab;
if(!_af){
return false;
}
_ae=_91(_af,doc,_ac,false);
if(!_ae){
return false;
}
}else{
if(!_ab.defIdRef||!_ab.uiLocation){
return false;
}
var _b0=null;
if(_e("ie-native-mode")||_8c){
_b0=_21.getPageById(_ac);
}else{
var exp=_7f.replace("%PAGE_ID%",_ac);
_b0=_24.selectSingleNode(exp,doc);
}
if(!_b0){
return false;
}
var _b1=doc.documentElement.namespaceURI;
if(typeof doc.createElementNS==="function"){
_ae=doc.createElementNS(_b1,"widgetInstance");
}else{
_ae=doc.createNode(1,"widgetInstance",_b1);
}
_ae.setAttribute("defIdRef",_ab.defIdRef);
if(_ab.instanceId){
_ae.setAttribute("instanceId",_ab.instanceId);
}
_ae.setAttribute("uiLocation",_ab.uiLocation);
_b0.appendChild(_ae);
}
_ae.setAttribute("enabled","true");
return true;
};
var _b2=function(_b3,doc,_b4,_b5){
if(!_b3){
return false;
}
_b4=_b4||win.WidgetPlacementConfig.pageId||win.WidgetPlacementConfig.defaultPageId;
var _b6=_91(_b3,doc,_b4,false);
if(!_b6){
return false;
}
if(_b5){
_b6.setAttribute("enabled","false");
}else{
_b6.parentNode.removeChild(_b6);
}
return true;
};
var _b7=function(_b8,_b9){
var _ba=new _8(),url;
if(!win.WidgetPlacementConfig.widgetConfigXMLDocument||true===_b8||true===win.staleXMLConfig){
url=win.WidgetPlacementConfig.layoutInfoUrl;
if(!win.staleXMLConfig){
url+="&lastMod="+win.WidgetPlacementConfig.lastMod;
}
if("undefined"!==typeof win.WidgetPlacementConfig.needsMigration){
if(win.WidgetPlacementConfig.needsMigration==true){
url+="&needsMigration=true";
}
}
_25.debug("Using URL:"+url);
_7.get({url:url,handleAs:"xml",sync:true,load:function(_bb){
win.WidgetPlacementConfig.widgetConfigXMLDocument=_bb;
_ba.resolve();
},error:_b9||_1d.DefaultXHRErrorHandler});
win.staleXMLConfig=false;
}else{
_ba.resolve();
}
return _ba;
};
var _bc=function(){
win.WidgetPlacementConfig.widgetConfigXMLDocument=null;
};
var _bd={getWidgetDef:_8d,getAllWidgetDefs:_a5,getWidgetInstance:_91,getWidgetInstancesByDef:_98,getWidgetDefByInstance:_9c,getPageWidgetInstances:_a0,addWidgetInstance:_aa,removeWidgetInstance:_b2,withLayoutInfo:_b7,resetLayoutInfo:_bc};
return _bd;
})());
}
_5.mixin(wp.utils,(function initCustomFuncs(){
var _be={filter:{canAddWidget:[],canRemoveWidget:[],isWidgetRemovalAccepted:[]},callback:{addWidget:[],removeWidget:[]},handler:{handleSearchRequest:[]}};
var _bf=function(_c0,_c1,_c2){
if(!_c1||!_5.isFunction(_c2)){
_25.debug("unable to register "+_c0+" \""+_c1+"\"");
return;
}
if(!_5.isArray(_be[_c0][_c1])){
_25.debug("registering a "+_c0+" \""+_c1+"\" which is never defined before");
}
_be[_c0][_c1].push(_c2);
};
var _c3=function(_c4,_c5){
if(!_c5||!_5.isArray(_be[_c4][_c5])){
_25.debug("no "+_c4+" with name \""+_c5+"\" is found");
return null;
}
return _be[_c4][_c5];
};
var _c6=function(_c7,_c8){
if(!_c8||!_5.isArray(_be[_c7][_c8])){
_25.debug("no "+_c7+" is about to be cleared with name \""+_c8+"\"");
return;
}
_be[_c7][_c8]=[];
};
var _c9={registerFilter:_5.partial(_bf,"filter"),registerCallback:_5.partial(_bf,"callback"),registerHandler:_5.partial(_bf,"handler"),getFilters:_5.partial(_c3,"filter"),getCallbacks:_5.partial(_c3,"callback"),getHandlers:_5.partial(_c3,"handler"),clearFilters:_5.partial(_c6,"filter"),clearCallbacks:_5.partial(_c6,"callback"),clearHandlers:_5.partial(_c6,"handler")};
return _c9;
})());
wp.showColumn=function(_ca){
if(_5.isString(_ca)){
_ca=[_ca];
}
if(!_ca||!_ca.length){
return;
}
_2.forEach(_ca,function(col){
if(wp.uiLocations[col]){
wp.uiLocations[col].hidden=false;
_22.show("widget-container-"+col,false,false,true);
}
});
};
wp.hideColumn=function(_cb){
if(_5.isString(_cb)){
_cb=[_cb];
}
if(!_cb||!_cb.length){
return;
}
_2.forEach(_cb,function(col){
if(wp.uiLocations[col]){
wp.uiLocations[col].hidden=true;
_22.hide("widget-container-"+col,false,true);
}
});
};
wp.changeHash=function(_cc){
win.location.hash=_cc;
};
win.changeHash=function(_cd){
_4.deprecated("window.changeHash()","use changeHash() in ic-core/WidgetPlacement instead","5.5");
wp.changeHash(_cd);
};
win.registerCloseViewFunction=function(_ce){
_4.deprecated("window.registerCloseViewFunction()","use registerCloseViewFunction in ic-core/WidgetPlacement instead","5.5");
wp.registerCloseViewFunction=_ce;
};
wp.closeOtherViews=function(){
if(wp.registerCloseViewFunction!=null){
wp.registerCloseViewFunction();
wp.registerCloseViewFunction=null;
}
};
win.closeOtherViews=function(){
_4.deprecated("window.closeOtherViews()","use closeOtherViews() in ic-core/WidgetPlacement instead","5.5");
wp.closeOtherViews();
};
wp.switchView=function(_cf,_d0,_d1){
wp.closeOtherViews();
wp.registerCloseViewFunction=wp.closeSwitchView;
var _d2=_d0;
if(_d0&&_5.isObject(_d0)){
_d2=_d0.instanceId||_d0.defIdRef;
}
if(!_d2&&_cf&&_5.isObject(_cf)){
_d2=_cf.defId;
}
wp.destroyWidget(_d2,null,false,true);
if(wp.currentFullpageWidgetInstanceId!=null){
wp.destroyWidget(wp.currentFullpageWidgetInstanceId,null,false,true);
}
wp.destroyWidgetContainer("fullpage");
for(uiLocation in wp.uiLocations){
wp.hideColumn(uiLocation);
}
_2.forEach(win.WidgetPlacementConfig.hideElements,function(_d3){
_22.hide(_d3,false,true);
});
_36(_d2);
win.setTimeout(function(){
_22.show("widget-container-fullpage",false,false,true);
wp.getWidgetDocAndRenderWidget(null,_cf,_d0,"fullpage","fullpage","skinless",false);
wp.currentFullpageWidgetInstanceId=_d2;
wp.isInWidgetFullpageMode=true;
var _d4=wp.utils.getWidgetName(_cf,_d0);
wp.setTitle(_d4);
},wp.currentFullpageWidgetInstanceId==null?200:0);
};
win.switchView=function(_d5,_d6,_d7,_d8,_d9){
_4.deprecated("window.switchView()","use switchView() in ic-core/WidgetPlacement instead","5.5");
wp.switchView(_d5,_d6,_d7);
};
var _3d=function(_da){
var _db=_a.get(_da,"id");
var _dc=_db.indexOf("_navItem");
if(_dc!==-1){
var _dd=_db.substring(0,_dc),_de=wp.utils.getWidgetInstance(_dd),_df=wp.utils.getWidgetDefByInstance(_de),_e0=wp.utils.getWidgetName(_df,_de);
if(_e0){
return _e0;
}
}
var _e1=_15("a",_da);
if(_e1.length){
return _5.trim(_e1[0][(_e("ie")?"innerText":"textContent")]);
}
_25.warn("Unable to get proper title from navitem: ",_da);
return null;
};
wp.setTitle=function(_e2){
if(_28&&win.ic_comm_communityName){
var _e3="${0} - ${1}";
var _e4=[_e2,win.ic_comm_communityName];
win.document.title=_17.substitute(_e3,_e4);
}
};
win.setTitle=function(el){
_4.deprecated("window.setTitle()","use setTitle() in ic-core/WidgetPlacement instead","5.5");
try{
var _e5=_3d(el);
if(_e5){
wp.setTitle(_e5);
}
}
catch(e){
}
};
wp.utils.getResourcedStringForItem=function(_e6,_e7){
_2b=_2b||_4.i18n.getLocalization("lconn.core.config","widgetbundles");
var _e8=_e6.bundleRefId||"lc_default";
var _e9=_e6[_e7];
var _ea=_2b||{};
var _eb=_ea[_e9];
if(typeof _eb!=="string"&&_ea[_e8]){
_eb=_ea[_e8][_e9];
}
if(typeof _eb!=="string"){
_eb=_e9;
}
return _eb;
};
win.getResourcedStringForItem=function(_ec,_ed){
_4.deprecated("window.getResourcedStringForItem()","use getResourcedStringForItem() in ic-core/WidgetPlacement instead","5.5");
return wp.utils.getResourcedStringForItem(_ec,_ed);
};
wp.utils.getResourcedStringById=function(_ee,_ef){
_2b=_2b||_4.i18n.getLocalization("lconn.core.config","widgetbundles");
var _f0=_ee.bundleRefId||"lc_default";
var _f1=_2b[_f0];
if(!_f1){
_25.log("unable to find resource bundle for \""+_f0+"\"");
_f1={};
}
var _f2=_f1[_ef];
return ((_f2===undefined)?_ef:_f2);
};
win.getResourcedStringById=function(_f3,_f4){
_4.deprecated("window.getResourcedStringById()","use getResourcedStringById() in ic-core/WidgetPlacement instead","5.5");
return wp.utils.getResourcedStringById(_f3,_f4);
};
var _f5=function(_f6,_f7){
_2b=_2b||_4.i18n.getLocalization("lconn.core.config","widgetbundles");
var _f8=_f6.bundleRefId||"lc_default";
var _f9=_f6[_f7];
var _fa=_2b||{};
var _fb=_fa[_f9];
if(!_fb&&_fa[_f8]){
_fb=_fa[_f8][_f9];
}
if(!_fb){
_fb=_f9;
}
return _fb;
};
wp.utils.getDefaultWidgetName=function(_fc,_fd){
var _fe=null;
if(_fc){
_fe=_f5(_fc,"defId");
if(_fe&&_5.isObject(_fe)){
_fe=_fe[_fd]||_fe["default"];
}
}
return _fe;
};
win.getDefaultWidgetName=function(_ff,mode,_100){
_4.deprecated("window.getDefaultWidgetName()","use getDefaultWidgetName() in ic-core/WidgetPlacement instead","5.5");
return wp.utils.getDefaultWidgetName(_ff,mode,_100);
};
wp.utils.getEscapedWidgetName=function(_101,_102,_103,mode){
if("undefined"===typeof _103){
_103=false;
}
return _1f.escapeInlineText(wp.utils.getWidgetName(_101,_102,mode),_103);
};
win.getEscapedWidgetName=function(_104,_105,_106,mode){
_4.deprecated("window.getEscapedWidgetName()","use getEscapedWidgetName() in ic-core/WidgetPlacement instead","5.5");
return wp.utils.getEscapedWidgetName(_104,_105,_106,mode);
};
wp.utils.getWidgetName=function(_107,_108,mode){
var _109=null;
if(_108){
var _10a=_108.defaultTitle;
if(!_10a){
_109=_108.title;
}
}
if(_109==null){
_107=_107||wp.utils.getWidgetDefByInstance(_108);
_109=wp.utils.getDefaultWidgetName(_107,mode);
}
return _109;
};
win.getWidgetName=function(_10b,_10c,mode){
_4.deprecated("window.getWidgetName()","use getWidgetName() in ic-core/WidgetPlacement instead","5.5");
return wp.utils.getWidgetName(_10b,_10c,mode);
};
wp.addToNavBar=function(_10d,_10e,_10f,_110,_111){
var _112=[];
var _113=[];
var _114=[];
var ii;
var _115=_31();
if(_115==null){
return;
}
var _116=_10d.showFullPageViewLinkInNavBar;
if((_116!=null&&_116=="true")||_3f("fullpage",_10d)||(_110!=null&&_110!="")){
if(_111!=null&&_111!=""){
_113=_111.split(",");
for(ii=0;ii<_113.length;ii++){
_112[ii]=wp.utils.getResourcedStringById(_10d,_113[ii]);
}
}else{
_112[0]=wp.utils.getWidgetName(_10d,_10e);
}
if(_110!=null&&_110!=""){
_114=_110.split(",");
}
var _117=_10d.defId;
var _118=_10e.instanceId||_117;
for(ii=0;ii<_112.length;ii++){
var li=_c.create("li",{id:_118+"_navItem"+((ii===0)?"":ii),"role":"button","aria-pressed":"false","tabindex":-1,"uiLocation":_10e.uiLocation,"widgetdefid":_117});
var _119=_c.create("a",{textContent:_112[ii],"tabindex":-1});
if(_110!=null&&_110!=""){
if(_114[ii]==null){
_114[ii]=_114[0];
}
win.WidgetPlacementConfig.params["widgetInstanceId"]=_118;
var _11a=_2d(_114[ii]);
_a.set(_119,"href",_11a);
}else{
_a.set(_119,"href","javascript:void(0);");
var _11b=function(){
changeHash("fullpageWidgetId="+_118);
return false;
};
on(_119,"click",_11b);
}
li.appendChild(_119);
if(_117==="StatusUpdates"){
var _11c=_9.byId("RecentUpdates_navItem");
_115.insertBefore(li,_11c.nextSibling);
}else{
if(win.WidgetPlacementConfig.insertBeforeNavBarId){
_115.insertBefore(li,_9.byId(win.WidgetPlacementConfig.insertBeforeNavBarId));
}else{
_c.place(li,wp.getInsertionPoint(_115,li),"after");
}
}
if(_10f==true){
var _11d=win.WidgetPlacementConfig.NavBarSelectedMenuItem;
var _11e=0;
var idx=_11d.indexOf("_");
if(idx>0){
_11e=_11d.substring(idx+1);
}
if(ii==_11e){
_b.add(li,"lotusSelected");
}
}
}
}
};
win.addToNavBar=function(_11f,_120,_121,_122,_123,_124,_125){
_4.deprecated("window.addToNavBar()","use addToNavBar() in ic-core/WidgetPlacement instead","5.5");
wp.addToNavBar(_11f,_120,_122,_123,_125);
};
wp.canAddWidget=function(_126,_127,_128,_129,_12a){
if(_126==null){
return false;
}
var _12b=_126.loginRequired;
if(_12b=="true"&&!_127.userLoggedIn){
return false;
}
var _12c=_126.resourceOwnerWidget;
if(_12c==="true"&&!_128){
return false;
}
var _12d=_126.hideWidgetForMyProfile,_12e=wp.getUserProfileOverrideProperty("key");
if(_12d==="true"&&_127.userLoggedIn&&_127.params.resourceId==_12e){
return false;
}
var _12f=_126.requireAcl;
if(_12f!=null&&_12f!=""){
var ok=false;
try{
for(var ii=0;ii<_127.enabledPermissions.length;ii++){
if(_127.enabledPermissions[ii]==_12f){
ok=true;
break;
}
}
}
catch(e){
}
if(!ok){
return false;
}
}
if(_129!=null&&wp.onlyFullPageWidgetLoaded!=true&&!_12a){
var _130=_129.enabled;
if(_130==="false"){
return false;
}
}
var _131=_126.prerequisite;
if(_131!=null&&_131!=""&&_127.availableServices!=null){
var _132=_131.split(" ");
for(var x=0;_132.length!=null&&x<_132.length;x++){
if(_127.availableServices[_132[x]]==null||_127.availableServices[_132[x]]==false){
return false;
}
}
}
var _133=_126.requiredFeatures;
if(_133!=null&&_133!=""&&typeof _127.enabledFeatures!=="undefined"&&_127.enabledFeatures!=null&&_127.enabledFeatures!=""){
if(win.WidgetPlacementConfig.debug){
console.info("enabledFeatures = "+_127.enabledFeatures);
}
var _134=_127.enabledFeatures.split(new RegExp("[, \u3000]{1}","g"));
var i=0,len=_134.length;
var _135=false;
for(i=0;i<len;i++){
if(_134[i]==_133){
_135=true;
break;
}
}
if(!_135){
_25.debug("The user doesn't have the required feature, returning false");
return false;
}
}
var _136=_126.defId;
if(_127.disabledWidgets&&_127.disabledWidgets[_136]){
_25.debug("Widget "+_136+" is disabled in this context.");
return false;
}
if(wp.utils.getFilters("canAddWidget")){
var _137={WidgetPlacementConfig:_127,canPersonalize:_128,showHidden:_12a};
var _138=_2.every(wp.utils.getFilters("canAddWidget"),function(_139){
return _139(_126,_129,_137);
});
if(!_138){
return false;
}
}
return true;
};
win.canAddWidget=function(_13a,_13b,_13c,_13d,_13e){
_4.deprecated("window.canAddWidget()","use canAddWidget in ic-core/WidgetPlacement instead","5.5");
return wp.canAddWidget(_13a,_13b,_13c,_13d,_13e);
};
wp.canRemoveWidget=function(_13f,_140){
var _141=wp.utils.getWidgetInstance(_13f);
if(!_141){
console.log("lconn.core.WidgetPlacementCRE.removeWidget: Unable to find widget instance for instanceId = "+widgetInstanceId);
return false;
}
if(wp.utils.getFilters("canRemoveWidget")){
var _142=wp.utils.getWidgetDefByInstance(_141);
var _143={removeWidgetData:_140};
var _144=_2.every(wp.utils.getFilters("canRemoveWidget"),function(_145){
return _145(_142,_141,_143);
});
if(!_144){
return false;
}
}
return true;
};
win.canRemoveWidget=function(_146,_147){
_4.deprecated("window.canRemoveWidget()","use canRemoveWidget in ic-core/WidgetPlacement instead","5.5");
return wp.canRemoveWidget(_146,_147);
};
wp.requestRemovalConfirmation=function(_148,_149,_14a){
var _14b=function(_14c){
if(_14c){
_14d.resolve();
}else{
_14d.reject();
}
};
var _14d=new _8();
if(false!==_148){
if(wp.utils.getFilters("isWidgetRemovalAccepted")){
_2.forEach(wp.utils.getFilters("isWidgetRemovalAccepted"),function(_14e){
_14e(_149,_14a,_14b);
});
}
}else{
_14d.resolve();
}
return _14d;
};
win.requestRemovalConfirmation=function(_14f,_150,_151){
_4.deprecated("window.requestRemovalConfirmation()","use requestRemovalConfirmation in ic-core/WidgetPlacement instead","5.5");
return wp.requestRemovalConfirmation(_14f,_150,_151);
};
wp.destroyWidgetContainer=function(_152){
_2.forEach(wp.loadOrder,function(_153){
if(_153!=null&&_153.uiLocation==_152){
wp.destroyWidget(_153.instanceId,_153.uiLocation,false);
}
});
var _154=_9.byId("widget-container-"+_152);
if(_154&&_154.innerHTML){
_154.innerHTML="";
}
};
win.destroyWidgetContainer=function(_155){
_4.deprecated("window.destroyWidgetContainer()","use destroyWidgetContainer() in ic-core/WidgetPlacement instead","5.5");
wp.destroyWidgetContainer(_155);
};
wp.highlightOverviewLink=function(){
_36(null);
};
win.highlightOverviewLink=function(){
_4.deprecated("window.highlightOverviewLink()","use highlightOverviewLink() in ic-core/WidgetPlacement instead","5.5");
wp.highlightOverviewLink();
};
wp.isOverviewLinkSelected=function(){
var _156=false;
if(win.WidgetPlacementConfig.navBarOverViewElementId!=null){
var _157=_9.byId(win.WidgetPlacementConfig.navBarOverViewElementId);
if(_157!=null){
_156=_b.contains(_157,"lotusSelected");
}
}
return _156;
};
win.isOverviewLinkSelected=function(){
_4.deprecated("window.isOverviewLinkSelected()","use isOverviewLinkSelected() in ic-core/WidgetPlacement instead","5.5");
return wp.isOverviewLinkSelected();
};
wp.activateTabbedWidget=function(_158,_159,_15a,_15b,_15c,_15d,_15e){
var _15f=_158.defId;
var _160=_159.instanceId||_15f;
if(_15d){
wp.destroyWidgetContainer(win.WidgetPlacementConfig.TempWidgetContainerDomId,false);
}
wp.destroyWidget(_160,null,false,true);
wp.getWidgetDocAndRenderWidget(_15f,_158,_160,win.WidgetPlacementConfig.TempWidgetContainerDomId,_15a,"skinless",false,false,_15e);
if(_15b!=null){
_22.hide(_15b,false,true);
}
if(typeof _15e=="undefined"||_15e==null){
_15e=[];
}
if(_5.isObject(_15e)&&!_5.isArray(_15e)){
_15e=[_15e];
}
var _161="tab";
_2.forEach(_15e,function(attr){
try{
if(attr&&attr["role"]){
_161=attr["role"];
}
}
catch(ee){
}
});
var _162=_15("li",_9.byId(_15c));
_2.forEach(_162,function(){
if(liElement.className!=""){
_b.remove(liElement,"lotusSelected");
}
_b.remove(liElement,"dijitTabContainerBottom-container");
_a.set(liElement,{tabindex:"-1","role":_161,"aria-selected":"false"});
var _163=liElement.id.substring(0,liElement.id.indexOf("_TabItem"));
var _164=_9.byId(_163+"_menuiconHolder");
var _165=_9.byId(_163+"_selectedLinkHolder");
var _166=_9.byId(_163+"_menuicon");
if(_164!=null){
_d.set(_164,"width","7000px");
_d.set(_164,"display","block");
}
if(_165!=null){
_d.set(_165,"width","1px");
_d.set(_165,"visibility","hidden");
_d.set(_165,"overflow","hidden");
}
if(_166!=null){
_a.set(_166,"tabIndex","-1");
}
_15("a",liElement).forEach(function(node){
_a.set(node,"tabIndex","-1");
});
var _167=_9.byId(_163+"_multiWidget");
var _168=_9.byId(_163+"_linkHolder");
if(_168!=null){
_168.insertBefore(_167,_168.firstChild);
}
});
var _169=_9.byId(_160+"_TabItem");
if(_169!=null){
_b.add(_169,"lotusSelected");
_a.set(_169,{tabindex:"0","aria-selected":"true"});
_b.add(_169,"dijitTabContainerBottom-container");
}
var _16a=_9.byId(_160+"_menuiconHolder");
var _16b=_9.byId(_160+"_selectedLinkHolder");
var _16c=_9.byId(_160+"_menuicon");
if(_16a!=null){
_d.set(_16a,"width","");
_d.set(_16a,"display","");
}
if(_16b!=null){
_d.set(_16b,"width","");
_d.set(_16b,"visibility","");
_d.set(_16b,"overflow","");
}
if(_16c!=null){
dojoAttr.remove(_16c,"tabIndex");
}
var _16d=_9.byId(_160+"_multiWidget");
var _16e=_9.byId(_160+"_selectedLinkHolder");
if(_16e!=null){
_16e.insertBefore(_16d,_16e.firstChild);
}
};
win.activateTabbedWidget=function(_16f,_170,_171,_172,_173,_174,_175){
_4.deprecated("window.activeTabbedWidget()","use activeTabbedWidget() in ic-core/WidgetPlacement instead","5.5");
wp.activeTabbedWidget(_16f,_170,_171,_172,_173,_174,_175);
};
wp.getUserProfileOverrideProperty=function(_176){
if(win.WidgetPlacementConfig.userLoggedIn==false||win.WidgetPlacementConfig.userLoggedIn==null){
return null;
}else{
var _177=null;
if(win.widgetUserInfo!=null){
var temp=widgetUserInfo[_176];
if(temp==undefined||temp=="undefined"||temp==null){
_177=null;
}else{
_177=temp;
}
}else{
if(win.WidgetPlacementConfig.userInfoXML==null){
var _178=function(res){
win.WidgetPlacementConfig.userInfoXML=res;
var temp=res.documentElement.getAttribute(_176);
if(temp==undefined||temp=="undefined"||temp==null){
_177=null;
}else{
_177=temp;
}
};
var url=win.WidgetPlacementConfig.userInfoUrl;
_16(url,{method:"GET",handleAs:"xml",sync:true}).then(_178,_1d.DefaultXHRErrorHandler);
}else{
_177=win.WidgetPlacementConfig.userInfoXML.documentElement.getAttribute(_176);
}
}
return _177;
}
};
win.getUserProfileOverrideProperty=function(_179){
_4.deprecated("window.getUserProfileOverrideProperty()","use getUserProfileOverrideProperty() in ic-core/WidgetPlacement instead","5.5");
return wp.getUserProfileOverrideProperty(_179);
};
wp.handleModeExit=function(_17a){
win.WidgetPlacementConfig.handleModeExitExe=true;
if(win.WidgetPlacementConfig.cancelCallBack!=null&&_17a!=true){
win.WidgetPlacementConfig.cancelCallBack();
}
_2.forEach(win.WidgetPlacementConfig.hideElements,function(_17b){
_22.show(_17b,false,false,true);
});
if(win.WidgetPlacementConfig.TabContainerDomId!=null){
var _17c=_9.byId(win.WidgetPlacementConfig.TabContainerDomId);
var _17d=_17c.childNodes;
var temp=[];
_2.forEach(_17d,function(_17e){
var _17f=_17e.id;
if(typeof _17f!=="undefined"&&_17f!=null&&_17f.indexOf("_TabItem")!=-1&&!_b.contains(_17e,"noRemove")){
temp.push(_17e);
}
});
_2.forEach(temp,function(_180){
_180.parentNode.removeChild(_180);
});
}
if(win.WidgetPlacementConfig.TempWidgetContainerDomId!=null){
win.destroyWidgetContainer(win.WidgetPlacementConfig.TempWidgetContainerDomId);
}
_2.forEach(wp.loadOrder,function(_181){
if(_181&&_9.byId(_181.instanceId)){
wp.refresh(_181.instanceId);
}
});
_2.forEach(wp.uiLocations,function(_182){
_22.show("widget-container-"+_182,false,false,true);
});
win.WidgetPlacementConfig.handleModeExitExe=null;
win.WidgetPlacementConfig.firstWidget=null;
win.WidgetPlacementConfig.isFullPageWidgetRendering=null;
win.WidgetPlacementConfig.TempWidgetContainerDomId=null;
win.WidgetPlacementConfig.TabContainerDomId=null;
win.WidgetPlacementConfig.isTabbedFullPageWidgetRendering=null;
highlightOverviewLink();
};
win.handleModeExit=function(_183){
_4.deprecated("window.handleModeExit()","use handleModeExit() in ic-core/WidgetPlacement instead","5.5");
wp.handleModeExit(_183);
};
var _184=function(_185,_186,opts){
var _187=_5.getObject("lconn.communities.bizCard.core.community");
if(_187&&_187.externalAllowed){
if(_185.showInExternalCommunities==="false"){
return false;
}
}
return true;
};
wp.utils.registerFilter("canAddWidget",_5.hitch(wp,_184));
var _188=function(_189,_18a,opts){
if(opts.removeWidgetData){
if(_18a.defIdRef==="Files"&&wp.utils.getWidgetInstance("MediaGallery")){
_25.log("Skipping removal of Files widget since MediaGallery widget is present.");
return false;
}
}
return true;
};
wp.utils.registerFilter("canRemoveWidget",_5.hitch(wp,_188));
var _18b=function(_18c){
if(!_18c){
return;
}
var _18d=_18c.defIdRef,_18e=_18c.instanceId||_18d;
try{
if(_18d==="StatusUpdates"){
win.location.href=win.WidgetPlacementConfig.applicationContext+"/service/html/communityview?communityUuid="+win.WidgetPlacementConfig.resourceId;
}
}
catch(e){
console.log(e);
}
};
wp.utils.registerCallback("removeWidget",_5.hitch(wp,_18b));
var _18f=function(_190,_191,_192){
if(_191){
var _193=wp.utils.getWidgetInstance(_190);
var _194=_193.defIdRef;
if(_194==="FeaturedSurvey"||_194==="LinkedQuickrCommunityLib"||wp.showFullWidgetDeleteConfirmation(_194)===false){
_26.prompt(_2a["deleteWidget"],_2a["confirmDeleteWidget"],_2c["rs_ok"],_2a["cancel"],_192,null);
}else{
var _195=function(_196){
if(_196){
_192(true);
}else{
_192(false);
wp.removeWidget(_190,false,false);
}
};
var _197=_5.getObject("lconn.communities.bizCard.dialogs.deleteConfirmWidget");
var dlg=new _197({communityTitle:wp.utils.getWidgetName(null,_193),callback:_195,userName:communityActionData.userName});
dlg.show();
}
}else{
_26.prompt(_2a["hideWidget"],_2a["hideWidgetMsg"],_2a["hide"],_2a["cancel"],_192,null);
}
};
wp.utils.registerFilter("isWidgetRemovalAccepted",_5.hitch(wp,_18f));
var _198=function(opts){
var _199=[{entryName:"searchKeywords",entryValue:opts.query,component:"communities:content",selectTabInst:opts.tabinst,selectTab:opts.tab}];
var _19a=_5.getObject("lconn.comm.community");
_19a.handleSearchRequestbyGeneral(_199);
};
wp.utils.registerHandler("handleSearchRequest",_5.hitch(wp,_198));
if(!wp.aria){
wp.aria={};
}
wp.aria.TabPanel=_3("lconn.core.WidgetPlacement.aria.TabPanel",_19,{selectedClassname:"lotusSelected",connectToFirstLink:false,selIdx:0,_prevIdx:0,constructor:function(){
this.inherited(arguments);
var ai=this.allItems;
var si=this.selIdx;
_2.forEach(ai,_5.hitch(this,function(node,idx){
_d.set(node,{cursor:"pointer"});
this._connects.push(on(node,"click",_5.hitch(this,function(_19b){
this.selIdx=idx;
this._setItemVisuals();
})));
if(this.connectToFirstLink){
try{
_a.set(_15("a",node)[0],"tabindex","-1");
}
catch(ee){
}
this._connects.push(on(node,"click",_5.hitch(this,function(_19c){
try{
var item=_15("a",node)[0];
if(win.document.createEvent){
var evt=win.document.createEvent("HTMLEvents");
evt.initEvent("click",false,true);
item.dispatchEvent(evt);
}else{
item.fireEvent("onclick");
}
}
catch(e){
}
})));
}
}));
this._selectItem(this.selIdx,true);
this._activate(ai[this.selIdx]);
},_activate:function(item,_19d){
if(_19d||!this.connectToFirstLink){
return this.inherited(arguments);
}else{
return this._activate((_15("a",item)[0]),true);
}
},_setItemVisuals:function(){
var ai=this.allItems;
var si=this._prevIdx;
if(this.selIdx!=this._prevIdx){
_b.remove(ai[this._prevIdx],this.selectedClassname);
_a.set(ai[this._prevIdx],{"tabindex":"-1","aria-selected":"false"});
}
_b.add(ai[this.selIdx],this.selectedClassname);
_a.set(ai[this.selIdx],{"tabindex":"0","aria-selected":"true"});
this._prevIdx=this.selIdx;
},_selectItem:function(si,_19e){
if(typeof _19e==="undefined"){
_19e=false;
}
this._prevIdx=si;
this._setItemVisuals();
this.inherited(arguments);
if(!_19e){
this.allItems[this.selIdx].focus();
}
}});
wp.aria.Toolbar=_3("lconn.core.WidgetPlacement.aria.Toolbar",_1a,{selectedClassname:"lotusSelected",connectToFirstLink:true,selIdx:0,_oldIdx:0,changeSelectOnClick:true,setItemIdx:function(node,idx){
if(_a.get(node,"role")==="button"){
_a.set(node,"itemidx_",idx);
}else{
if(node.parentNode){
return this.setItemIdx(node.parentNode,idx);
}
}
},getItemIdx:function(node){
ret=this.selIdx;
if(_a.get(node,"itemidx_")!=null){
ret=_a.get(node,"itemidx_");
}else{
if(node.parentNode){
return this.getItemIdx(node.parentNode);
}
}
return ret;
},constructor:function(){
if(typeof win.lconncoreWidgetPlacementariaToolbar!=="undefined"){
win.lconncoreWidgetPlacementariaToolbar.destroy();
}
win.lconncoreWidgetPlacementariaToolbar=this;
this.inherited(arguments);
if(this.connectToFirstLink){
var ai=this.allItems;
var si=this.selIdx;
_2.forEach(ai,_5.hitch(this,function(node,idx){
this.setItemIdx(node,idx);
if(_b.contains(node,this.selectedClassname)){
this.selIdx=idx;
}
this._pressItem(idx,false);
var _19f=_15("a",node)[0];
_a.set(_19f,"tabindex","-1");
_a.remove(_19f,"aria-pressed");
_b.remove(_19f,this.selectedClassname);
if(this.changeSelectOnClick){
this._connects.push(on(_19f,"click",_5.hitch(this,function(_1a0){
var _1a1=this.getItemIdx(_19f);
this._pressItem(this._oldIdx,false);
this._pressItem(_1a1,true);
this._oldIdx=_1a1;
})));
}
this._connects.push(on(node,"keypress",function(_1a2){
var code=null;
if(!_1a2){
_1a2=win.event;
}
if(_1a2){
code=_1a2.keyCode||_1a2.charCode;
}
if(code===_14.SPACE||code===_14.ENTER){
try{
var item=_15("a",node)[0];
if(item){
item.click();
}
_1a2.preventDefault(),_1a2.stopPropagation();
}
catch(ee){
}
}
}));
}));
this._pressItem(this.selIdx,true);
this._oldIdx=this.selIdx;
}
},_kickIn:function(item,i){
this.inherited(arguments);
if(this.connectToFirstLink){
_a.set(item,"tabindex","0");
}
},_nodeIsHidden:function(node){
var _1a3=false;
try{
while(node){
if(_d.get(node,"display")==="none"){
_1a3=true;
break;
}
node=node.parentNode;
}
}
catch(ee){
}
return _1a3;
},_pressItem:function(idx,yn){
if(idx>=0){
var el=this.allItems[idx];
if(el){
if(yn){
_b.add(el,this.selectedClassname);
_a.set(el,{"aria-pressed":"true","tabindex":"0"});
var _1a4=_9.byId("lotusTitleBar");
if(_1a4&&!this._nodeIsHidden(el)){
_1a4.focus();
}
var _1a5=_3d(el);
if(_1a5){
wp.setTitle(_1a5);
}
}else{
_b.remove(el,this.selectedClassname);
_a.set(el,{"aria-pressed":"false","tabindex":"-1"});
}
}
}
}});
_5.setObject("lconn.core.WidgetPlacement",wp);
return wp;
});

dojo.provide("lconn.core.config.nls.widgetbundles")._built=true;
dojo.provide("lconn.core.config.nls.widgetbundles.en");
lconn.core.config.nls.widgetbundles.en={"Forum":"Forums","feedReader":"Feed Reader","importantBookmarksDescription":"Collect bookmarks to web resources that are important to your community.","lc_box":{"Box.description":"This widget allows users to work with files in a specific folder in the box.","Box":"Box","Box.sequenceNumber":"Box {0}"},"filesDescription":"Upload, share and work with community files and folders.","lc_clib":{"Gallery.description":"Showcase files in this community.","Gallery":"Gallery","CustomLibrary.description":"Use a document repository in your community.","Library.description":"Work with files using drafts, reviewers, and publishing.","librarysummary.description":"Use a document repository in your community.","CustomLibrary":"Linked Library","librarysummary":"Document Repository","Library":"Library","MediaGallery.description":"Share photos and videos with the community.","Library.sequenceNumber":"Library {0}","CustomLibrary.sequenceNumber":"Linked Library {0}","MediaGallery":"Media Gallery"},"Activities":"Activities","subcommunityDescription":"Bring together a subset of members within an existing community.","widgetPalette":"Widget Palette","SubcommunityNav":"Subcommunities","forumDescription":"Discuss topics and share ideas.","ImportantBookmarks":"Important Bookmarks","tagsDescription":"Group interesting content using meaningful keywords to make it easier to find.","eventsDescription":"Post important community events such as seminars and training. ","formiwidget":{"FeaturedSurvey.sequenceNumber":"Featured Survey {0}","Surveys.desc":"Create surveys to allow community members to give useful feedback on any subject.","FeaturedSurvey.desc":"Display a survey on your community home page.","FeaturedSurvey":"Featured Survey","Surveys":"Surveys"},"Updates":"Recent Updates","blogsDescription":"Quickly and dynamically share your news and views with community members.","wikiDescription":"Share resources with your community and collaborate with colleagues.","memberSummaryDescription":"People who are part of this community.  Share information and collaborate with members to bring your community to life.","commActivitesDescription":"Track your community\'s goals, organize tasks and assign to-do items.","sharepointFilesDescription":"View and edit your SharePoint files in your community.","Tags":"Tags","RelatedCommunities":"Related Communities","relatedCommunitiesDescription":"Build links to other communities.  ","CommunityUpdates":"Community Updates","Blog":"Blog","SharepointFiles":"SharePoint Files","galleryDescription":"Share photos and videos with the community.","lc_sand":{"sand_thingsInCommon":"Things in Common","sand_simComm":"Similar Communities","sand_DYK":"Do You Know","sand_recomItems":"Recommendations","sand_socialPath":"Who Connects Us?","sand_recomComm":"Recommendations"},"MyLibrary":"My Library","RecentUpdates":"Recent Updates","Wiki":"Wiki","commBookmarks":"Make useful web resources available directly from your community.","updatesDescription":"Update your community status to let other members know what you are doing.","ideationBlogsDescription":"Collaborate with community members to contribute and vote on ideas.","Files":"Files","StatusUpdates":"Status Updates","Bookmarks":"Bookmarks","RichContent":"Rich Content","Calendar":{"default":"Events","view":"Upcoming Events"},"calendarDescription":"Post important community events such as seminars and training. ","RichContentDescription":"Craft rich content for your community. Post text, links, images and more.","descriptionDescription":"An overview of what your community is for.  The description should reflect the community\'s goals and values.","commFeeds":"Add feeds to relevant web sites to your community.","IdeationBlog":"Ideation Blog","MembersSummary":"Members","Feeds":"Feeds","lc_default":{"commonTags":"Organization Tags","friends":"Network","board":"The Board","socialTags":"Tags","linkRoll":"My Links","filesReader":"Files","multiFeedReader":"Recent Posts","backgroundInfo":"Background","multiWidget":"Profile Information","contactInfo":"Contact Information","structTags":"Structured Tags","reportStructure":"Report-to Chain"},"Members":"Members","description":"Community Description"};

;if(!dojo._hasResource["lconn.core.WidgetPlacement"]){
dojo._hasResource["lconn.core.WidgetPlacement"]=true;
dojo.provide("lconn.core.WidgetPlacement");
dojo.requireLocalization("lconn.core.config","widgetbundles");




dojo.deprecated("lconn.core.WidgetPlacement","Use ic-core.WidgetPlacement instead.","5.5");
}


;if(!dojo._hasResource["lconn.core.util.Cookie"]){
dojo._hasResource["lconn.core.util.Cookie"]=true;
dojo.provide("lconn.core.util.Cookie");
lconn.core.util.Cookie={secureString:function(){
if(window.ibmConfig.forceSSL){
return "; secure";
}
return "";
}};
}


;if(!dojo._hasResource["com.ibm.lconn.layout.insights.NewRelic"]){
dojo._hasResource["com.ibm.lconn.layout.insights.NewRelic"]=true;
dojo.provide("com.ibm.lconn.layout.insights.NewRelic");


dojo.deprecated("com.ibm.lconn.layout.insights.NewRelic","Use the AMD module ic-ui/layout/insights/NewRelic instead","5.5");
}


;if(!dojo._hasResource["com.ibm.lconn.layout.insights.tracker"]){
dojo._hasResource["com.ibm.lconn.layout.insights.tracker"]=true;
dojo.provide("com.ibm.lconn.layout.insights.tracker");


dojo.deprecated("com.ibm.lconn.layout.insights.tracker","Use the AMD module ic-ui/layout/insights/tracker instead","5.5");
}


;if(!dojo._hasResource["lconn.communities.bizCard.newRelicTracker"]){
dojo._hasResource["lconn.communities.bizCard.newRelicTracker"]=true;
dojo.provide("lconn.communities.bizCard.newRelicTracker");




lconn.communities.bizCard.newRelicTracker={prefix:"ic.communities",navAction:"navClicked",navAction:function(_1,_2,_3,_4){
com.ibm.lconn.layout.insights.tracker.track("ic.communities.navclicked",{navId:_4,widgetDef:_3,communityUuid:_1,userUuid:_2});
}};
}


;if(!dojo._hasResource["lconn.communities.bizCard.core"]){
dojo._hasResource["lconn.communities.bizCard.core"]=true;
dojo.provide("lconn.communities.bizCard.core");
dojo.requireLocalization("lconn.communities.bizCard","ui");






lconn.communities.bizCard.core={messages:dojo.i18n.getLocalization("lconn.communities.bizCard","ui"),_firstActionShown:false,_communityActionsNode:null,_nonCommunityActionBar:false,_messageWidget:null,_messageDiv:null,_navMenuOpen:false,_subMenuOpen:false,_currentMenuSelection:0,_mouseOpenNavMenu:false,_mouseOpenSubMenu:false,_openMenuDelay:600,_openingNavMenuTimer:null,_openingSubMenuTimer:null,_hideMenuDelay:1500,_closingNavMenuTimer:null,_closingSubMenuTimer:null,_tabNavPanel:null,openComposeEmail:function(_1){
var _2=false;
var _3=document.getElementsByTagName("body")[0];
if(dojo.hasClass(_3,"dijit_a11y")){
_2=true;
}
var _4=630;
if(dojo.isIE){
_4+=30;
}
if(_2){
_4+=50;
}
var _5="width=1000,height="+_4+",scrollbars=yes,resizable=yes,location=no,status=no,toolbar=no,menubar=no";
window.open(_1,"",_5);
return false;
},enableTopButton:function(_6,_7){
var _8=dojo.byId(_6);
if(_8){
dojo.connect(_8,"onclick",null,function(_9){
_7(_9);
if(_9!=null){
dojo.stopEvent(_9);
}
return false;
});
this.keyPressHandle=dojo.connect(_8,"onkeypress",function(_a){
if(_a!=null){
if(_a.keyCode==dojo.keys.DOWN_ARROW){
_7(_a);
dojo.stopEvent(_a);
dojo.disconnect(this.keyPressHandle);
}
}
return false;
});
}
},setJoinCommunityReqCookie:function(){
document.cookie="JoinCommunityReqURL="+location.href+"; expires="+new Date(new Date().getTime()+365*24*60*60*1000).toGMTString()+"; path="+location.href;
},isNotEmpty:function(_b){
return _b!=null&&_b!="";
},buildActionsMenu:function(_c){
if(!dojo.exists("dijit.byId")){
return;
}
var _d=this.messages;
try{
var _e=dijit.byId("CommunitiesActionsMenuMain");
if(_e!=null){
_e.destroyRecursive();
}
}
catch(exception1){
console.log(exception1);
}
dojo["require"]("dijit.Menu");
var _f=new dijit.Menu({"class":"lotusPlain",id:"CommunitiesActionsMenuMain"});
var _10=false;
if(lconn.core.WidgetPlacement!=null&&lconn.core.WidgetPlacement.isInWidgetFullpageMode){
_10=true;
}
if(_c.showGoToComm==true){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.gotoComm"],"GOTOCOMM"));
}
if(_c.editSubEnabled==true){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.edit"],"EDITSUBURL"));
if(lconn.core.WidgetPlacement.isOverviewLinkSelected()){
if(_c.customizeEnabled){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.theme.customize"],"CUSTOMIZE"));
if(lconn.core.WidgetPlacement._freeLayout){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.theme.changelayout"],"CHANGELAYOUT"));
}
}
}else{
if(_c.customizeEnabled){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.theme.customize"],"CUSTOMIZEURL"));
if(lconn.core.WidgetPlacement._freeLayout){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.theme.changelayout"],"CHANGELAYOUTURL"));
}
}
}
}
if(_c.editEnabled==true){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.edit"],"EDITURL"));
if(lconn.core.WidgetPlacement.isOverviewLinkSelected()){
if(_c.createSubEnabled==true){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.create"],"CREATESUB"));
}
if(_c.customizeEnabled){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.theme.customize"],"CUSTOMIZE"));
if(lconn.core.WidgetPlacement._freeLayout){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.theme.changelayout"],"CHANGELAYOUT"));
}
}
}else{
if(_c.createSubEnabled==true){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.create"],"CREATESUBURL"));
}
if(_c.customizeEnabled){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.theme.customize"],"CUSTOMIZEURL"));
if(lconn.core.WidgetPlacement._freeLayout){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.theme.changelayout"],"CHANGELAYOUTURL"));
}
}
}
}
if(_c.moderateEnabled==true){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.moderate"],"MODERATE"));
}
if(this.isNotEmpty(_c.memberJoinURL)){
if(_c.canJoinCommunity==true){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.join"],"JOIN"));
}else{
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.requestToJoin"],"REQUESTJOIN"));
}
}
if(_c.mailEnabled==true){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.email"],"EMAIL"));
}
if(this.isNotEmpty(_c.leaveUrl)){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.leave"],"LEAVE"));
}
if(_c.showCommunityMoveAction){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.move"],"MOVE"));
}
if(this.isNotEmpty(_c.deleteUrl)){
_f.addChild(lconn.communities.bizCard.core.buildActionsMenuItem(_d["label.top.buttons.delete"],"DELETE"));
}
var _11=function(_12){
if(_12!=null){
if(_12.action=="MOVE"){
lconn.communities.bizCard.core.moveCommunity(_c);
}else{
if(_12.action=="GOTOCOMM"){
location.href=lconn.communities.bizCard.core.community.homeUrl;
}else{
if(_12.action=="EMAIL"){
lconn.communities.bizCard.core.openComposeEmail(lconn.communities.bizCard.core.getComposeURL(lconn.communities.bizCard.core.community));
}else{
if(_12.action=="CUSTOMIZE"){
lconn.core.applicationPalette.showPalette();
}else{
if(_12.action=="CUSTOMIZEURL"){
location.href=lconn.communities.bizCard.core.community.customizeUrl;
}else{
if(_12.action=="CHANGELAYOUT"){
lconn.core.applicationPalette.showPalette(lconn.core.applicationPalette.CHANGE_LAYOUT_TAB);
}else{
if(_12.action=="CHANGELAYOUTURL"){
location.href=lconn.communities.bizCard.core.community.changeLayoutUrl;
}else{
if(_12.action=="EDIT"){
displayCommunityEdit();
}else{
if(_12.action=="EDITURL"){
location.href=lconn.communities.bizCard.core.community.editUrl;
}else{
if(_12.action=="MODERATE"){
location.href=_c.moderationServiceUrl+_c.uuid;
}else{
if(_12.action=="METRICS"){
location.href=_c.metricsServiceUrl.replace("${0}",_c.uuid);
}else{
if(_12.action=="EDITSUB"){
displaySubcommunityEdit();
}else{
if(_12.action=="EDITSUBURL"){
location.href=lconn.communities.bizCard.core.community.editSubUrl;
}else{
if(_12.action=="DELETE"){
lconn.communities.bizCard.core.confirmCommunityDeletion(_c);
}else{
if(_12.action=="CREATESUB"){
displaySubcommunityCreate();
}else{
if(_12.action=="CREATESUBURL"){
location.href=lconn.communities.bizCard.core.community.createSubUrl;
}else{
if(_12.action=="LEAVE"){
lconn.communities.bizCard.core.confirmCommunityLeave();
}else{
if(_12.action=="JOIN"){
lconn.communities.bizCard.core.setJoinCommunityReqCookie();
lconn.communities.bizCard.core.doDangerousAction(lconn.communities.bizCard.core.community.memberJoinURL);
}else{
if(_12.action=="REQUESTJOIN"){
lconn.communities.bizCard.core.doDangerousAction(lconn.communities.bizCard.core.community.memberJoinURL);
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
}
};
dojo.connect(_f,"onItemClick",_11);
return _f;
},buildActionsMenuItem:function(_13,_14){
var _15="communityMenu_"+_14;
dojo["require"]("dijit.Menu");
var _16=new dijit.MenuItem({label:_13,id:_15});
_16.action=_14;
return _16;
},openActionsMenu:function(evt){
try{
var _17=lconn.communities.bizCard.core.buildActionsMenu(lconn.communities.bizCard.core.community);
if(evt.target.id!=null){
dojo.attr(evt.target,"aria-owns",evt.target.id+"_dropdown");
}
menuUtility.openMenu(evt,_17.id);
dojo.stopEvent(evt);
}
catch(e){
console.log(e);
}
},getComposeURL:function(_18){
var _19=lconn.core.bizCard.bizCardUtils.getBaseURL("hgroup");
return _19+"/service/html/composeemail?communityUuid="+_18.uuid;
},joinComm:function(){
lconn.communities.bizCard.core.setJoinCommunityReqCookie();
lconn.communities.bizCard.core.doDangerousAction(lconn.communities.bizCard.core.community.memberJoinURL);
},setCommunitiesReqCookie:function(){
var _1a=location.href.substr(0,location.href.indexOf("/service"));
_1a=_1a.substr(_1a.indexOf("/",_1a.indexOf("://")+3));
document.cookie="CommunitiesReqURL="+location.href+"; expires="+new Date(new Date().getTime()+365*24*60*60*1000).toGMTString()+"; path="+_1a+lconn.core.util.Cookie.secureString();
},addCommunityActionsMenuUI:function(_1b){
var _1c=this.messages;
var _1d=this._getCommunityActionsNode();
if(_1d!=null){
if(!_1b.authContextAuthenticated){
if(this._nonCommunityActionBar==false){
var li=this.createActionListItem();
li.innerHTML=_1b.translatedLoginLinkToParticipate;
dojo.place(li,_1d);
dojo.connect(li,"onclick",function(){
lconn.core.auth.login();
});
dojo.publish("CommunityActionBar",[{type:"CreatedLogin",community:_1b,node:li}]);
}
return;
}
if(!_1b.showMemberActions&&this.isNotEmpty(_1b.memberJoinURL)&&!_1b.isSuperAdmin){
var li=dojo.byId("joinDisplayActionsBtnLi");
if(li==null){
li=this.createActionListItem();
dojo.attr(li,"id","joinDisplayActionsBtnLi");
if(_1b.canJoinCommunity==true){
li.innerHTML="<a id=\"joinDisplayActionsBtn\" href=\"javascript:lconn.communities.bizCard.core.joinComm();\" role=\"button\" title=\""+_1c["label.top.buttons.join.title"]+"\" alt=\""+_1c["label.top.buttons.join"]+"\">"+_1c["label.top.buttons.join"]+"</a>";
}else{
li.innerHTML="<a id=\"joinDisplayActionsBtn\" href=\""+_1b.memberJoinURL+"\" role=\"button\" title=\""+_1c["label.top.buttons.requestToJoin.title"]+"\" alt=\""+_1c["label.top.buttons.requestToJoin"]+"\">"+_1c["label.top.buttons.requestToJoin"]+"</a>";
}
dojo.place(li,_1d);
}else{
if(_1b.canJoinCommunity==true){
li.innerHTML="<a id=\"joinDisplayActionsBtn\" href=\"javascript:lconn.communities.bizCard.core.joinComm();\" role=\"button\" aria-owns=\"joinDisplayActionsBtn\" title=\""+_1c["label.top.buttons.join.title"]+"\" alt=\""+_1c["label.top.buttons.join"]+"\">"+_1c["label.top.buttons.join"]+"</a>";
}else{
li.innerHTML="<a id=\"joinDisplayActionsBtn\" href=\""+_1b.memberJoinURL+"\" role=\"button\" aria-owns=\"joinDisplayActionsBtn\" title=\""+_1c["label.top.buttons.requestToJoin.title"]+"\" alt=\""+_1c["label.top.buttons.requestToJoin"]+"\">"+_1c["label.top.buttons.requestToJoin"]+"</a>";
}
}
dojo.publish("CommunityActionBar",[{type:"CreatedJoin",community:_1b,node:li}]);
}
if(_1b.showMemberActions||_1b.isSuperAdmin){
var _1e=dojo.byId("displayActionsBtn");
if(_1e){
var _1f=_1e.parentNode;
dojo.destroy(_1f);
this._firstActionShown=false;
}
var li=this.createActionListItem();
li.innerHTML="<a id=\"displayActionsBtn\" href=\"javascript:;\" role=\"button\" aria-haspopup=\"true\">"+_1c["label.top.buttons.com.actions"]+" <img class=\"lotusArrow lotusDropDownSprite\" src=\""+dijit._Widget.prototype._blankGif+"\" role=\"presentation\" alt=\"\"/>"+"<span role=\"presentation\" class=\"lotusAltText\">&#x25bc;</span>"+"</a>";
dojo.place(li,_1d);
this.community=_1b;
this.enableTopButton("displayActionsBtn",lconn.communities.bizCard.core.openActionsMenu);
dojo.publish("CommunityActionBar",[{type:"CreatedAction",community:_1b,node:li}]);
}
dojo.publish("CommunityActionBar",[{type:"Created",community:_1b}]);
}
},buildDropdownNavMenu:function(){
var _20=dojo.byId("leftNavMenu");
_20.parentNode.removeChild(_20);
dojo.attr(_20,"id","dropdownNavMenu");
dojo.addClass(_20,"lotusHidden");
var _21=dojo.byId("dropdownNavMenuContainer");
dojo.place(_20,_21,"last");
},addCommunityNavMenuUI:function(_22,_23){
var _24=this.messages;
this.community=_23;
lconn.communities.bizCard.core.buildDropdownNavMenu();
lconn.communities.bizCard.core.enableMenuButtons(true);
lconn.communities.bizCard.core.updateCommunityBanner(_23);
},enableMenuButtons:function(_25){
var _26=dojo.byId("dropdownNavMenuTitleLink");
var _27=dojo.byId("dropdownNavMenuTitleLinkAnc");
dojo.connect(_26,"onclick",this,function(evt){
lconn.communities.bizCard.core.toggleDropdownNavMenu();
if(evt!=null){
dojo.stopEvent(evt);
}
return false;
});
dojo.connect(document,"onclick",this,function(evt){
lconn.communities.bizCard.core.hideDropdownMenu("dropdownNavMenu");
});
var _28=dojo.byId("dropdownNavMenuContainer");
dojo.connect(_28,"onmouseenter",this,function(evt){
lconn.communities.bizCard.core.autoOpenMenu("dropdownNavMenu");
if(evt!=null){
dojo.stopEvent(evt);
}
return false;
});
dojo.connect(_28,"onmouseleave",this,function(evt){
if(this._mouseOpenNavMenu){
var _29=true;
if(dojo.isIE){
var _2a=document.elementFromPoint(evt.clientX,evt.clientY);
if(_2a){
_29=this.hasLeftMenu("dropdownNavMenuContainer",_2a);
}
}
if(_29){
this._mouseOpenNavMenu=false;
lconn.communities.bizCard.core.autoCloseMenu("dropdownNavMenu");
}
}
if(this._openingNavMenuTimer!=null){
try{
clearTimeout(this._openingNavMenuTimer);
}
catch(e){
}
this._openingNavMenuTimer=null;
}
if(evt!=null){
dojo.stopEvent(evt);
}
return false;
});
var _2b=dojo.query("li","dropdownNavMenu");
var _2c=null;
dojo.forEach(_2b,function(_2d,ii){
dojo.connect(_2d,"onkeydown",_2d,function(evt){
if(evt){
_2c=evt.keyCode||evt.charCode;
switch(_2c){
case dojo.keys.ENTER:
case dojo.keys.SPACE:
var _2e=dojo.query("a",this)[0];
if(_2e){
_2e.click();
}
dojo.stopEvent(evt);
break;
case dojo.keys.UP_ARROW:
case dojo.keys.DOWN_ARROW:
if(_25){
lconn.communities.bizCard.core.moveMenuSelection("dropdownNavMenu",_2c);
dojo.stopEvent(evt);
}
break;
case dojo.keys.ESCAPE:
case dojo.keys.TAB:
lconn.communities.bizCard.core.hideDropdownMenu("dropdownNavMenu");
dojo.stopEvent(evt);
break;
}
}
});
});
lconn.communities.bizCard.core.enableSubcommunitiesMenu();
var elm=dojo.byId("dropdownNavMenuContainer");
while(elm&&elm.parentNode){
elm=elm.parentNode;
if(dojo.hasClass(elm,"lotusInner")){
dojo.removeClass(elm,"lotusInner");
break;
}else{
if(dojo.hasClass(elm,"lotusColLeft")){
break;
}
}
}
},enableSubcommunitiesMenu:function(){
var _2f=this.messages;
var _30=dojo.byId("dropdownSubMenu");
if(_30){
header=_30.getElementsByTagName("h3")[0];
if(header){
header.parentNode.removeChild(header);
var _31=dojo.byId("dropdownSubMenuSelection");
_31.innerHTML=_2f["label.subcommunities"];
var _32=dojo.byId("dropdownSubMenuTitleLink");
var _33=dojo.byId("dropdownSubMenuTitleLinkAnc");
dojo.connect(_32,"onclick",this,function(evt){
lconn.communities.bizCard.core.toggleDropdownSubMenu();
if(evt!=null){
dojo.stopEvent(evt);
}
return false;
});
dojo.connect(document,"onclick",this,function(evt){
lconn.communities.bizCard.core.hideDropdownMenu("dropdownSubMenu");
});
dojo.removeClass(dojo.byId("dropdownSubMenuContainer"),"lotusHidden");
var _34=dojo.byId("dropdownSubMenuContainer");
dojo.connect(_34,"onmouseenter",this,function(evt){
lconn.communities.bizCard.core.autoOpenMenu("dropdownSubMenu");
if(evt!=null){
dojo.stopEvent(evt);
}
return false;
});
dojo.connect(_34,"onmouseleave",this,function(evt){
if(this._mouseOpenSubMenu){
var _35=true;
if(dojo.isIE){
var _36=document.elementFromPoint(evt.clientX,evt.clientY);
if(_36){
_35=this.hasLeftMenu("dropdownSubMenuContainer",_36);
}
}
if(_35){
this._mouseOpenSubMenu=false;
lconn.communities.bizCard.core.autoCloseMenu("dropdownSubMenu");
}
}
if(this._openingSubMenuTimer!=null){
try{
clearTimeout(this._openingSubMenuTimer);
}
catch(e){
}
this._openingSubMenuTimer=null;
}
if(evt!=null){
dojo.stopEvent(evt);
}
return false;
});
var _37=dojo.query("li","dropdownSubMenu");
var _38=null;
dojo.forEach(_37,function(_39,ii){
dojo.connect(_39,"onkeydown",_39,function(evt){
if(evt){
_38=evt.keyCode||evt.charCode;
switch(_38){
case dojo.keys.ENTER:
case dojo.keys.SPACE:
var _3a=dojo.query("a",this)[0];
if(_3a){
_3a.click();
}
dojo.stopEvent(evt);
break;
case dojo.keys.UP_ARROW:
case dojo.keys.DOWN_ARROW:
lconn.communities.bizCard.core.moveMenuSelection("dropdownSubMenu",_38);
dojo.stopEvent(evt);
break;
case dojo.keys.ESCAPE:
case dojo.keys.TAB:
lconn.communities.bizCard.core.hideDropdownMenu("dropdownSubMenu");
dojo.stopEvent(evt);
break;
}
}
});
});
}
}
},adjustMenuPosition:function(_3b){
var _3c,_3d;
var _3e,_3f;
var _40,_41;
var _42,_43,_44;
var _45,_46;
var _47=dojo.window.getBox();
_3c=dojo.byId(_3b);
_3d=_3c.getBoundingClientRect();
_45=_3d.bottom-_3d.top;
var _48=_47.h-_3d.bottom;
if(_48<0){
_40=dojo.byId("lotusMain");
if(!_40){
_40=dojo.query(".lotusMain")[0];
}
if(_40){
_41=_40.getBoundingClientRect();
}
if(_3b=="dropdownNavMenu"){
_3e=dojo.byId("dropdownNavMenuTitle");
}else{
_3e=dojo.byId("dropdownSubMenuTitle");
}
_3f=_3e.getBoundingClientRect();
_46=_3f.bottom-_3f.top;
_42=_3f.top;
_42=(_42<0)?0:_42;
if(_42>0){
if(_41){
var _49=(_41.top<0)?0:_41.top;
var _4a=(_3f.top-_49)-15;
_42=(_42>_4a)?_4a:_42;
}
}
var _4b=_47.h;
if(_41){
_4b=(_4b>_41.bottom)?_41.bottom:_4b;
}
_43=(_4b-_3f.bottom)-15;
_43=(_43<0)?0:_43;
if(_42>=_43){
if(_45>_42){
dojo.style(_3c,{"overflowY":"scroll","height":_42+"px"});
_44=_46+_42-1;
}else{
_44=_46+_45-1;
}
var _4c=-_44;
dojo.style(_3c,"top",_4c+"px");
}else{
if(_45>_43){
dojo.style(_3c,{"overflowY":"scroll","height":_43+"px"});
}
}
}
},hasLeftMenu:function(_4d,_4e){
var _4f=true;
try{
while(_4e){
if(_4e.id==_4d){
_4f=false;
break;
}else{
_4e=_4e.parentNode;
}
}
}
catch(e){
}
return _4f;
},moveMenuSelection:function(_50,key){
var _51=dojo.query("li",_50);
switch(key){
case dojo.keys.DOWN_ARROW:
if(this._currentMenuSelection<_51.length-1){
this._currentMenuSelection++;
}else{
this._currentMenuSelection=0;
}
this.updateSelectedEntry(_51,this._currentMenuSelection);
break;
case dojo.keys.UP_ARROW:
if(this._currentMenuSelection!=0){
this._currentMenuSelection--;
}else{
this._currentMenuSelection=_51.length-1;
}
this.updateSelectedEntry(_51,this._currentMenuSelection);
break;
}
},updateSelectedEntry:function(_52,_53){
dojo.forEach(_52,function(_54,ii){
if(ii==_53){
dojo.addClass(_54,"lotusSelected");
dojo.attr(_54,{"aria-pressed":"false","tabindex":"0"});
_54.focus();
}else{
dojo.removeClass(_54,"lotusSelected");
dojo.attr(_54,{"aria-pressed":"false","tabindex":"-1"});
}
});
},autoOpenMenu:function(_55){
if(_55=="dropdownNavMenu"){
lconn.communities.bizCard.core.hideDropdownMenu("dropdownSubMenu");
if(!this._mouseOpenNavMenu){
if(!this._openingNavMenuTimer){
this._openingNavMenuTimer=setInterval(function(){
lconn.communities.bizCard.core.timedOpenMenu("dropdownNavMenu");
},this._openMenuDelay);
}
}
try{
clearTimeout(this._closingNavMenuTimer);
}
catch(e){
}
this._closingNavMenuTimer=null;
}else{
lconn.communities.bizCard.core.hideDropdownMenu("dropdownNavMenu");
if(!this._mouseOpenNavMenu){
if(!this._openingSubMenuTimer){
this._openingSubMenuTimer=setInterval(function(){
lconn.communities.bizCard.core.timedOpenMenu("dropdownSubMenu");
},this._openMenuDelay);
}
}
try{
clearTimeout(this._closingSubMenuTimer);
}
catch(e){
}
this._closingSubMenuTimer=null;
}
},timedOpenMenu:function(_56){
if(_56=="dropdownNavMenu"){
this._mouseOpenNavMenu=true;
this.showDropdownMenu("dropdownNavMenu");
try{
clearTimeout(this._openingNavMenuTimer);
}
catch(e){
}
this._openingNavMenuTimer=null;
}else{
this._mouseOpenSubMenu=true;
this.showDropdownMenu("dropdownSubMenu");
try{
clearTimeout(this._openingSubMenuTimer);
}
catch(e){
}
this._openingSubMenuTimer=null;
}
},autoCloseMenu:function(_57){
if(_57=="dropdownNavMenu"){
if(!this._mouseOpenNavMenu){
if(!this._closingNavMenuTimer){
this._closingNavMenuTimer=setInterval(function(){
lconn.communities.bizCard.core.timedCloseMenu("dropdownNavMenu");
},this._hideMenuDelay);
}
}
}else{
if(!this._mouseOpenSubMenu){
if(!this._closingSubMenuTimer){
this._closingSubMenuTimer=setInterval(function(){
lconn.communities.bizCard.core.timedCloseMenu("dropdownSubMenu");
},this._hideMenuDelay);
}
}
}
},timedCloseMenu:function(_58){
if(_58=="dropdownNavMenu"){
this.hideDropdownMenu("dropdownNavMenu");
try{
clearTimeout(this._closingNavMenuTimer);
}
catch(e){
}
this._closingNavMenuTimer=null;
}else{
this.hideDropdownMenu("dropdownSubMenu");
try{
clearTimeout(this._closingSubMenuTimer);
}
catch(e){
}
this._closingSubMenuTimer=null;
}
},updateCommunityBanner:function(_59){
var _5a=this.messages;
var _5b="";
var _5c=null;
var _5d=null;
var _5e=null;
_5c=dojo.query(".lotusPlaceBar .lotusRightCorner .lotusInner")[0];
if(_5c){
_5d=_5c.getElementsByTagName("h2")[0];
}
if(_59.parentName!=null&&_59.parentName.length>0){
_5e=_59.externalAllowed?"external":_59.parentType;
_5b+=this.formatCommunity(_59.parentName,_59.parentUrl,_5e);
_5b+="<div class=\"comNavInline comNavArrow\"><div class=\"comNavInline\"><img class=\"lotusSprite lotusArrow lotusTwistyClosed\" src=\""+dojo.config.blankGif+"\" alt=\"\" title=\"\"/></img></div><span class=\"lotusAltText\">&#9658;</span></div>";
}
_5e=_59.externalAllowed?"external":_59.communityType;
_5b+=this.formatCommunity(_59.name,null,_5e);
if(_5d){
dojo.place(_5b,_5d,"only");
}
},formatCommunity:function(_5f,url,_60){
var _61="";
if(url){
var _62=this.messages["tooltip.startpage"];
_61+="<a class=\"lotusBold comNavInline\" role=\"button\" href=\""+url+"\" title=\""+_62+"\">";
_61+=this.formatImage(_60);
_61+=_5f+"</a>";
}else{
_61+="<div class=\"comNavInline\">"+this.formatImage(_60)+_5f+"</div>";
}
return _61;
},formatImage:function(_63){
var _64="";
if(_63!="public"){
if(_63=="external"){
_64+="<span class=\"lotusLeft comNavIcon\">";
_64+="<img class=\"lotusui30 lconnIconListSharedExternal\" src=\""+dojo.config.blankGif+"\" alt=\""+this.messages["label.external.members.allowed"]+"\" title=\""+this.messages["label.external.members.allowed"]+"\" />";
_64+="</span>";
_64+="<span class=\"lotusAltText\">"+this.messages["label.external.members.allowed"]+" </span>";
}else{
if(_63=="private"){
_64+="<span class=\"lotusLeft comNavIcon\">";
_64+="<img class=\"iconsStates16 iconsStates16-CheckedOut\" src=\""+dojo.config.blankGif+"\" alt=\""+this.messages["label.private.community.alt.text"]+"\" title=\""+this.messages["label.private.community.alt.text"]+"\" />";
_64+="</span>";
_64+="<span class=\"lotusAltText\">"+this.messages["label.private.community.alt.text"]+" </span>";
}else{
_64+="<span class=\"lotusLeft comNavIcon\">";
_64+="<img class=\"iconsOther16 iconsOther16-ModeratedCommunity16\" src=\""+dojo.config.blankGif+"\" alt=\""+this.messages["label.moderated.community.alt.text"]+"\" title=\""+this.messages["label.moderated.community.alt.text"]+"\"/>";
_64+="</span>";
_64+="<span class=\"lotusAltText\">"+this.messages["label.moderated.community.alt.text"]+" </span>";
}
}
}
return _64;
},toggleDropdownNavMenu:function(){
if(this._subMenuOpen){
this.hideDropdownMenu("dropdownSubMenu");
}
lconn.communities.bizCard.core.toggleDropdownMenu("dropdownNavMenu");
},toggleDropdownSubMenu:function(){
if(this._navMenuOpen){
lconn.communities.bizCard.core.hideDropdownMenu("dropdownNavMenu");
}
lconn.communities.bizCard.core.toggleDropdownMenu("dropdownSubMenu");
},toggleDropdownMenu:function(_65){
var _66=(_65=="dropdownNavMenu")?this._navMenuOpen:this._subMenuOpen;
if(_66){
lconn.communities.bizCard.core.hideDropdownMenu(_65);
}else{
lconn.communities.bizCard.core.showDropdownMenu(_65);
}
},hideDropdownMenu:function(_67){
var _68=dojo.byId(_67);
if(_68){
if(_67=="dropdownNavMenu"&&this._navMenuOpen){
dojo.byId("dropdownNavMenuTitleLinkAnc").focus();
dojo.addClass(_68,"lotusHidden");
this._mouseOpenNavMenu=false;
this._navMenuOpen=false;
}else{
if(_67=="dropdownSubMenu"&&this._subMenuOpen){
dojo.byId("dropdownSubMenuTitleLinkAnc").focus();
dojo.addClass(_68,"lotusHidden");
this._mouseOpenSubMenu=false;
this._subMenuOpen=false;
}
}
}
},showDropdownMenu:function(_69){
var _6a=dojo.byId(_69);
if(_6a){
if(_69=="dropdownNavMenu"){
this._navMenuOpen=true;
}else{
if(_69=="dropdownSubMenu"){
this._subMenuOpen=true;
}
}
dojo.style(_6a,{"top":"auto","overflowY":"hidden","overflow":"hidden","height":"auto"});
dojo.removeClass(_6a,"lotusHidden");
this.adjustMenuPosition(_69);
this._currentMenuSelection=0;
var _6b=dojo.query("li",_6a);
this.updateSelectedEntry(_6b,this._currentMenuSelection);
}
},addParentCommunity:function(_6c){
var _6d=this.messages;
var _6e="";
if(_6c.parentName!=null&&_6c.parentName.length>0){
_6e+="<div class=\"lotusMenuSection lotusIndent10\">";
_6e+="<h3>";
_6e+="<div class=\"lotusIndent15 communityLink\">";
_6e+="<a class=\"lotusBold\" style=\"display:inline\" role=\"button\" href=\""+_6c.parentUrl+"\" title=\""+_6d["tooltip.startpage"]+"\">";
if(_6c.parentType!="public"){
if(_6c.parentType=="private"){
_6e+="<img class=\"iconsStates16 iconsStates16-CheckedOut\" src=\""+dojo.config.blankGif+"\" alt=\""+_6d["label.private.community.alt.text"]+"\" title=\""+_6d["label.private.community.alt.text"]+"\" />";
_6e+="<span class=\"lotusAltText\">"+_6d["label.private.community.alt.text"]+" </span>";
}else{
_6e+="<img class=\"iconsOther16 iconsOther16-ModeratedCommunity16\" src=\""+dojo.config.blankGif+"\" alt=\""+_6d["label.moderated.community.alt.text"]+"\" title=\""+_6d["label.moderated.community.alt.text"]+"\"/>";
_6e+="<span class=\"lotusAltText\">"+_6d["label.moderated.community.alt.text"]+" </span>";
}
}
_6e+=" "+_6c.parentName+"</a>";
_6e+="</div> </h3>";
_6e+="</div><!--end section-->";
}
return _6e;
},addSubCommunities:function(_6f){
var _70=this.messages;
var _71="";
if(_6f.subcommunities!=null&&_6f.subcommunities.length>0){
_71="\t\t\t<div class=\"lotusMenuSection\" role=\"navigation\" aria-label = \""+_70["label.subcommunities"]+"\">\t\t\t\t<h3>\t\t\t\t\t<label for=\""+_6f.uuid+"_subtwisty\" id=\""+_6f.uuid+"_subtwisty_label\" class=\"lotusAccess\">\t\t\t\t\t"+_70["label.collapse"]+" "+_70["label.subcommunities"]+"\t\t\t\t\t</label>\t\t\t\t\t<a role=\"button\" \t\t\t\t\t\t\ttitle=\""+_70["label.collapse"]+"\" href=\"javascript:;\" \t\t\t\t\t\t\tonfocus=\"lconn.communities.bizCard.core.setReaderContent('"+_6f.uuid+"_subtwisty_label', true);\"\t\t\t\t\t\t\tonblur=\"lconn.communities.bizCard.core.setReaderContent('"+_6f.uuid+"_subtwisty_label', false);\"\t\t\t\t\t\t\tonclick=\"lconn.communities.bizCard.core.toggleSection('"+_6f.uuid+"_subtwisty"+"','"+_6f.uuid+"_comm_subLinks"+"','"+_6f.uuid+"_subAltOpen"+"');\"\t\t\t\t\t>\t\t\t\t\t\t<span id=\""+_6f.uuid+"_subtwisty\" class=\"lotusSprite lotusArrow lotusTwistyOpen\"></span> \t\t\t\t\t\t<span id=\""+_6f.uuid+"_subAltOpen\" class=\"lotusAltText\">&#x25bc;</span>\t\t\t\t\t\t<span id=\""+_6f.uuid+"_subAltClosed\" class=\"lotusHidden\">&#x25BA;</span>\t\t\t\t\t\t<span> "+_70["label.subcommunities"]+"</span>\t\t\t\t\t</a>\t\t\t\t</h3>\t\t\t\t<div id=\""+_6f.uuid+"_comm_subLinks\" class=\"lotusMenuSubsection\">\t\t\t\t\t<ul role=\"toolbar\" aria-label=\""+_70["label.subcommunities"]+"\">";
for(var i=0;i<_6f.subcommunities.length;i++){
var _72=_6f.subcommunities[i];
var _73=_72.name;
if(dojo.exists("lconn.core.globalization.bidiUtil.enforceTextDirection")){
_73=lconn.core.globalization.bidiUtil.enforceTextDirection(_73);
}
_71+="\t\t\t\t\t\t<li role=\"button\" >\t\t\t\t\t\t\t<a href=\""+_72.url+"\" title=\""+_72.name+"\">"+_73+"</a>\t\t\t\t\t\t</li>";
}
_71+="\t\t\t\t\t</ul>\t\t\t\t</div>\t\t\t</div>";
}
return _71;
},setReaderContent:function(id,_74){
var _75=dojo.byId(id);
if(_75!=null){
if(_74){
_75.setAttribute("aria-live","polite");
}else{
_75.removeAttribute("aria-live");
}
}
},toggleSection:function(_76,_77,_78,_79){
var _7a=this.messages;
var _7b=dojo.byId(_76);
var _7c=dojo.byId(_77);
var _7d=dojo.byId(_78);
var _7e=dojo.byId(_76+"_label");
if(_7c.style.display=="none"){
_7c.style.display="block";
dojo.removeClass(_7b,"lotusTwistyClosed");
dojo.addClass(_7b,"lotusTwistyOpen");
dojo.attr(_7b,"title",_7a["label.collapse"]);
if(dojo.cookie&&typeof _79=="string"){
dojo.cookie(_79,1);
}
_7d.innerHTML="&#x25bc;";
if(_7e){
_7e.innerHTML=_7a["label.collapse"]+" "+_7a["label.subcommunities"];
}
}else{
_7c.style.display="none";
dojo.removeClass(_7b,"lotusTwistyOpen");
dojo.addClass(_7b,"lotusTwistyClosed");
dojo.attr(_7b,"title",_7a["label.expand"]);
if(dojo.cookie&&typeof _79=="string"){
dojo.cookie(_79,0);
}
_7d.innerHTML="&#x25ba;";
if(_7e){
_7e.innerHTML=_7a["label.expand"]+" "+_7a["label.subcommunities"];
}
}
},showFollowConfirmation:function(_7f){
var _80=dojo.byId("lotusContent");
if(_80!=null){
if(this._messageDiv==null){
this._messageDiv=document.createElement("div");
dojo.attr(this._messageDiv,"role","alert");
dojo.attr(this._messageDiv,"aria-live","assertive");
_80.insertBefore(this._messageDiv,_80.firstChild);
}else{
this.clearMessage();
}
this._messageWidget=new com.ibm.oneui.controls.MessageBox({canClose:true,_strings:{icon_alt:this.messages["label.msgbox.success"],a11y_label:this.messages["label.msgbox.success.a11y"],close_btn_title:this.messages["label.msgbox.close"],close_btn_alt:this.messages["label.msgbox.close"]},type:com.ibm.oneui.controls.MessageBox.TYPE.SUCCESS,msg:_7f},dojo.byId(this._messageDiv));
}
},clearMessage:function(){
if(this._messageWidget){
this._messageWidget.destroy();
}
},follow:function(){
if(!dojo.exists("dijit.byId")){
return;
}
var _81=this.messages;
var _82=function(_83,_84){
var _85;
if((lconn.communities.bizCard.bizCard.currentCommunity&&lconn.communities.bizCard.bizCard.currentCommunity.memberJoinURL)||(lconn.communities.bizCard.core.community&&lconn.communities.bizCard.core.community.memberJoinURL)){
_85="label.action.confirm.community.after.follow.nonmember";
}else{
_85="label.action.confirm.community.after.follow.member";
}
lconn.communities.bizCard.core.showFollowConfirmation(_81[_85]);
var _86=dijit.byId("communityMenu_FOLLOW");
if(_86==null){
_86=dijit.byId("communityMenu_UNFOLLOW");
}
if(_86!=null){
dojo.attr(_86,"label",_81["label.top.buttons.unfollow"]);
dojo.attr(_86,"title",_81["label.top.buttons.unfollow.title"]);
_86.onClick=function(){
lconn.communities.bizCard.core.unFollow();
};
}
var _87=dojo.byId("followDisplayActionsBtn");
if(_87!=null){
_87.innerHTML=_81["label.top.buttons.unfollow"];
if(dojo.isIE){
_87.onclick=function(){
lconn.communities.bizCard.core.unFollow();
};
}else{
_87.setAttribute("onclick","lconn.communities.bizCard.core.unFollow()");
}
dojo.attr(_87,"title",_81["label.top.buttons.unfollow.title"]);
_87.setAttribute("aria-label",_81["label.top.buttons.unfollow"]);
}
dojo.publish("lconn.comm.commFollowed",[lconn.communities.bizCard.core.community.uuid]);
};
var url=lconn.communities.bizCard.core.community.followUrl;
if(url==null){
url=lconn.communities.bizCard.core.community.unfollowUrl;
url=url.replace("memberunfollowsubmit","memberfollowsubmit");
}
if(window.SemTagSvcConfig!=null&&SemTagSvcConfig.proxyURL!=null){
var ph=new lconn.core.url.ProxyUrlHelper(SemTagSvcConfig.proxyURL);
url=ph.getProxifiedURL(url);
}
dojo.xhrGet({url:url,headers:{"X-Update-Nonce":"true"},load:_82,error:this.getFollowErrorCallback()});
return false;
},getFollowErrorCallback:function(){
return function(_88,_89){
console.log("follow errorCallBack callback: "+_88);
var _8a=lconn.communities.bizCard.core.messages;
var _8b;
if(_89.xhr.status==401){
_8b=_8a["label.msg.action.failed.need.login"];
}else{
_8b=_8a["label.msg.action.failed"].replace("${0}",_88);
}
var _8c=dojo.byId("lotusContent");
if(_8c!=null){
var _8d="followCommunityConfirmId";
var _8e=dojo.byId(_8d);
if(_8e!=null){
_8e.innerHTML="";
_8e.parentNode.removeChild(_8e);
}
var _8f=document.createElement("div");
dojo.addClass(_8f,"lotusMessage2");
dojo.attr(_8f,"role","alert");
dojo.attr(_8f,"id",_8d);
dojo.attr(_8f,"aria-live","assertive");
_8f.innerHTML="<img class=\"lconnSprite lconnSprite-iconError16\" title=\""+_8a["label.msg.error"]+"\" alt=\""+_8a["label.msg.error"]+"\" src=\""+dijit._Widget.prototype._blankGif+"\">";
var _90=document.createElement("span");
_90.innerHTML=_8b;
_8f.appendChild(_90);
_8c.insertBefore(_8f,_8c.firstChild);
}
};
},unFollow:function(){
if(!dojo.exists("dijit.byId")){
return;
}
var _91=this.messages;
var _92=function(_93,_94){
lconn.communities.bizCard.core.showFollowConfirmation(_91["label.action.confirm.community.after.unfollow"]);
var _95=dijit.byId("communityMenu_UNFOLLOW");
if(_95==null){
_95=dijit.byId("communityMenu_FOLLOW");
}
if(_95!=null){
dojo.attr(_95,"label",_91["label.top.buttons.follow"]);
dojo.attr(_95,"title",_91["label.top.buttons.follow.title"]);
_95.onClick=function(){
lconn.communities.bizCard.core.follow();
};
}
var _96=dojo.byId("followDisplayActionsBtn");
if(_96!=null){
_96.innerHTML=_91["label.top.buttons.follow"];
if(dojo.isIE){
_96.onclick=function(){
lconn.communities.bizCard.core.follow();
};
}else{
_96.setAttribute("onclick","lconn.communities.bizCard.core.follow()");
}
_96.setAttribute("aria-label",_91["label.top.buttons.follow"]);
dojo.attr(_96,"title",_91["label.top.buttons.follow.title"]);
}
dojo.publish("lconn.comm.commUnFollowed",[lconn.communities.bizCard.core.community.uuid]);
};
var url=lconn.communities.bizCard.core.community.unfollowUrl;
if(url==null){
url=lconn.communities.bizCard.core.community.followUrl;
url=url.replace("memberfollowsubmit","memberunfollowsubmit");
}
if(window.SemTagSvcConfig!=null&&SemTagSvcConfig.proxyURL!=null){
var ph=new lconn.core.url.ProxyUrlHelper(SemTagSvcConfig.proxyURL);
url=ph.getProxifiedURL(url);
}
dojo.xhrGet({url:url,headers:{"X-Update-Nonce":"true"},load:_92,error:this.getFollowErrorCallback()});
return false;
},addFollowActionsMenuUI:function(_97){
if(!dojo.exists("dijit.byId")){
return;
}
var _98=this.messages;
var _99=dojo.byId("followActionBar");
var _9a=dijit.byId("followDropDownMenu");
var _9b=this._getCommunityActionsNode();
if(_97.isCommunityOverview&&this.isNotEmpty(_97.followUrl)){
var li=this.createActionListItem();
li.innerHTML="<a id=\"followDisplayActionsBtn\" href=\"javascript:void(0);\" role=\"button\" onclick=\"lconn.communities.bizCard.core.follow()\" title=\""+_98["label.top.buttons.follow.title"]+"\">"+_98["label.top.buttons.follow"]+"</a>";
dojo.place(li,_9b);
dojo.publish("FollowActionBar",[{type:"CreatedFollow",community:_97,node:li}]);
}else{
if(_97.isCommunityOverview&&this.isNotEmpty(_97.unfollowUrl)){
var li=this.createActionListItem();
li.innerHTML="<a id=\"followDisplayActionsBtn\" href=\"javascript:void(0);\" role=\"button\" onclick=\"lconn.communities.bizCard.core.unFollow()\" title=\""+_98["label.top.buttons.unfollow.title"]+"\">"+_98["label.top.buttons.unfollow"]+"</a>";
dojo.place(li,_9b);
dojo.publish("FollowActionBar",[{type:"CreatedunFollow",community:_97,node:li}]);
}else{
if(_9a!=null){
if(this.isNotEmpty(_97.followUrl)){
var _9c=lconn.communities.bizCard.core.buildActionsMenuItem(_98["label.top.buttons.follow"],"FOLLOW");
_9c.onClick=function(){
lconn.communities.bizCard.core.follow();
};
dojo.attr(_9c,"title",_98["label.top.buttons.follow.title"]);
_9a.addChild(_9c);
}else{
if(this.isNotEmpty(_97.unfollowUrl)){
var _9c=lconn.communities.bizCard.core.buildActionsMenuItem(_98["label.top.buttons.unfollow"],"UNFOLLOW");
_9c.onClick=function(){
lconn.communities.bizCard.core.unFollow();
};
dojo.attr(_9c,"title",_98["label.top.buttons.unfollow.title"]);
_9a.addChild(_9c);
}
}
}
}
}
},startUp:function(_9d,_9e){
_9d.isCommunityOverview=true;
this.addFollowActionsMenuUI(_9d);
this.addCommunityActionsMenuUI(_9d);
_9d.subcommunities=_9e.subcommunities;
var _9f=dojo.byId("subcommArea");
if(_9f){
_9f.innerHTML=this.addSubCommunities(_9d);
}
lconn.communities.bizCard.core.community=_9d;
var _a0=dojo.byId("lotusTitleBar");
var _a1=dojo.byId("tabNavigation");
if(_a0!=undefined&&_a0!=null){
if(_a1==undefined||_a1!=null){
_a1=document.createElement("a");
_a1.setAttribute("id","tabNavigation");
_a1.setAttribute("name","tabNavigation");
if(_a0.firstChild){
_a0.insertBefore(_a1,_a0.firstChild);
}else{
_a0.appendChild(_a1);
}
}
}
var _a2;
var _a3=dojo.byId("lotusNavBar");
if(_a3){
try{
_a2=new lconn.core.WidgetPlacement.aria.Toolbar("lotusNavBar");
}
catch(ee){
_a2=new lconn.core.aria.Toolbar("lotusNavBar");
}
if(communityActionData.enableNewRelicTracking==true){
dojo.query("li",_a3).forEach(function(_a4){
dojo.connect(_a4,"onclick",null,function(){
lconn.communities.bizCard.newRelicTracker.navAction(communityActionData.uuid,communityActionData.userUuid,dojo.attr(this,"widgetdefid"),this.id);
return false;
});
});
}
}
},createActionListItem:function(){
var _a5=dojo.create("li");
dojo.addClass(_a5,"lotusNowrap");
if(this._firstActionShown==false){
dojo.addClass(_a5,"lotusFirst");
this._firstActionShown=true;
}
return (_a5);
},_getCommunityActionsNode:function(){
var _a6=null;
if(this._communityActionsNode==null){
var _a7=dojo.byId("communityActionBar");
if(_a7!=null){
var _a6=this._getParentNode(_a7);
if(_a6!=null){
this._firstActionShown=dojo.query(".lotusFirst",_a6).length!=0;
this._nonCommunityActionBar=true;
if(_a7.tagName.toLowerCase()=="span"){
var _a8=dojo.create("li",{id:"communityActionBar",style:{display:"none"}});
dojo.place(_a8,_a7,"replace");
}
}
if(_a6==null){
_a6=dojo.create("ul",{"id":"communityActions","class":"lotusInlinelist lotusActions lotusRight"});
dojo.place(_a6,_a7,"first");
}
this._communityActionsNode=_a6;
}
}
return (this._communityActionsNode);
},_getParentNode:function(_a9){
var _aa=null;
var _ab=_a9.parentNode;
if(_ab!=null){
if(_ab.nodeName.toLowerCase()=="li"){
_ab=_ab.parentNode;
}
if(_ab.nodeName.toLowerCase()=="ul"){
_aa=_ab;
}
}
return (_aa);
},writeTabbedNavigation:function(_ac){
this.setupTabbedStyles();
this.setupTabbedContainers(_ac);
this.updateTabbedCommunityLogo("tabbedImage",_ac);
this.updateTabbedParentCommunityName("tabNavParentName",_ac);
this.updateTabbedCommunityName("tabNavCommunityName",_ac);
this.updateTabbedSubcommunitiesMenu();
this.updateTabbedApplicationsMenu("bizCardNavMenu","tabNavContainer");
this.fixNavOnScroll();
},setupTabbedStyles:function(){
var _ad="";
_ad+="<style>";
_ad+=".lotusui30 .tabNavBar   {height:64px; padding:12px 20px 12px 20px; background-color:white; background-image:none; z-index:850;}";
_ad+=".lotusui30 .tabNavBar    div#lotusTitleBar{padding-right:20px; background-color:white; background-image:none; height:42px; border-bottom-width:0px}";
_ad+=".lotusui30 .tabNavBar   .tabNavImage {background-color:white; background-image:none; float:left; display:inline;}";
_ad+=".lotusui30 .tabNavBar   .tabNavCommunityName {background-color:white; background-image:none; padding-left:20px; padding-right:20px; display:inline-block; font-size:20px; color:#292929; font-weight:bold; vertical-align:top}";
_ad+=".lotusui30 .tabNavBar   .tabNavCommunityName div {padding-top: 0px;}";
_ad+=".lotusui30 .tabNavBar   .tabNavParentName {background-color:white; background-image:none; padding-left:20px; padding-right:20px; display:inline; font-size:13px; color:#292929; font-weight:bold; vertical-align:top}";
_ad+=".lotusui30 .tabNavBar   .tabNavParentName a {text-decoration: none;}";
_ad+=".lotusui30 .tabNavBar   .tabNavParentName .comNavIcon {margin: 1px 4px 5px 0px;}";
_ad+=".lotusui30 .tabNavBar   .tabNavSubcommunityName {padding-left:20px; padding-right:20px; display:block; font-size:16px; color:#292929; font-weight:bold; vertical-align:top}";
_ad+=".lotusui30 .tabNavBar   .tabNavSubcommunityName div {padding-top: 0px;}";
_ad+=".lotusui30 .tabNavBar   .tabNavSubcommunityName .comNavIcon {margin: 1px 4px 5px 0px;}";
_ad+=".lotusui30 .tabNavBar    div#tabNavSearch {padding-left:20px; padding-right:20px; display:inline; top:0;}";
_ad+=".lotusui30 .tabNavBar    div.lotusTitleBar .lotusSearch {top:0}";
_ad+=".lotusui30 .tabNavBar   .lotusTitleBar .lotusSearch .lotusLayout {background-color:white; background-image:none; font-size:10px; padding:2px;}";
_ad+=".lotusui30 .tabNavBar   .tabNavItemInline {display:inline;}";
_ad+=".lotusui30 .tabNavBar   .tabNavItemInBlk {display:inline-block;}";
_ad+=".lotusui30 .tabNavBar   .tabNavFullWidth {width:100%;}";
_ad+=".lotusui30 .tabNavBar   .tabNavOverflowHidden {overflow:hidden !important;}";
_ad+=".lotusui30 .tabNavBar   .tabNavTextEllipsis {overflow:hidden; white-space:nowrap; text-overflow:ellipsis}";
_ad+=".lotusui30 .tabNavBar   .tabNavTabBar {position:relative;left:0px; }";
_ad+=".lotusui30 .tabNavBar   .tabNavPlaceBar {height:25px;padding-left:20px;padding-right:0px;padding-top:1px;background-color:white; background-image:none; border:0px; overflow:hidden;}";
_ad+=".lotusui30 .tabNavBar   .lotusTabs li a {font-size:13px; color:#676767; text-transform:none; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width:150px}";
_ad+=".lotusui30 .tabNavBar   .tabNavScrollCon {margin-left:8px; margin-right:8px; height:27px}";
_ad+=".lotusui30 .tabNavBar   .tabNavScrollBtnU {bottom:4px; margin-left:0; margin-right:0;}";
_ad+=".lotusui30 .tabNavBar   .tabNavScrollBtn {border:1px solid black; margin-left:0px; margin-right:0px}";
_ad+=".lotusui30 .tabNavBar   .tabNavScrollBtnA {padding:2px;}";
_ad+=".lotusui30 .tabNavBar   .tabNavScrollBtnDisabled {opacity:0.3;}";
_ad+=".lotusui30 .tabNavBar   .tabNavActionsMenu {display:inline;top:0px;font-size:14px;margin-top:3px;}";
_ad+=".lotusui30 .tabNavBar   .tabNavSubSel {font-size:13px; font-weight:normal; color:#676767;}";
_ad+=".lotusui30 .tabNavFixed {height:66px; padding:2px 20px 2px 20px; position: fixed; left: 0; top: 0; width: 100%; background-color:white; background-image:none; z-index:850; box-shadow:2px 2px #e8e8e8;}";
_ad+=".lotusui30 .tabNavFixed div#tabNavSearch {padding-left:20px; padding-right:20px;}";
_ad+=".lotusui30 .tabNavFixed div.lotusTitleBar .lotusSearch {top:5px; right:45px}";
_ad+=".lotusui30 .tabNavFixed .tabNavPlaceBar {height:25px;padding-left:20px;padding-right:40px; background-color:white; background-image:none; border:0px; overflow:hidden;}";
_ad+="div#tabNavSubMenuContainer {margin-top: 7px; }";
_ad+="div#tabNavSubMenuContainer div#tabNavSubMenu {overflow:hidden; position:relative; top:0px; left:0px; width:180px; z-index:5; background-color:white; background-image:none; border:1px solid rgb(202, 202, 202);}";
_ad+="div#tabNavSubMenuContainer div#tabNavSubMenu ul {list-style-type:none; margin:0px; padding:0px;}";
_ad+="div#tabNavSubMenuContainer div#tabNavSubMenu li {text-decoration: none; text-shadow: none; box-shadow:none !important; content:none; font-size:10px; font-weight: normal; margin-top: 0px; margin-bottom: 0px; padding:0px;}";
_ad+="div#tabNavSubMenuContainer div#tabNavSubMenu li.lotusSelected {text-decoration: none; text-shadow: none; box-shadow:none !important; content:none; font-size:10px; font-weight: normal; margin-top: 0px; margin-bottom: 0px; padding:0px; background-color:#e9f1f3;}";
_ad+="div#tabNavSubMenuContainer div#tabNavSubMenu li a, ";
_ad+="div#tabNavSubMenuContainer div#tabNavSubMenu li a:before {text-decoration: none; text-shadow: none; box-shadow:none !important; content:none; font-size:10px; font-weight: normal; margin-top: 0px; margin-bottom: 0px; padding:2px 5px; width:100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}";
_ad+="div#tabNavSubMenuContainer div#tabNavSubMenu li a:hover,";
_ad+="div#tabNavSubMenuContainer div#tabNavSubMenu li a:focus,";
_ad+="div#tabNavSubMenuContainer div#tabNavSubMenu li:focus a,";
_ad+="div#tabNavSubMenuContainer div#tabNavSubMenu li.lotusSelected a  {text-decoration: none; text-shadow: none; box-shadow:none !important; font-size:10px; font-weight:bold; color:black; background-color:#e9f1f3; margin-top: 0px; margin-bottom: 0px; padding:2px 5px; width:100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}";
_ad+="</style>";
var _ae=dojo.query("body")[0];
dojo.place(_ad,_ae,"first");
},setupTabbedContainers:function(_af){
var _b0="";
var _b1;
var _b2=dojo.byId("lotusTitleBar");
if(!_b2){
_b2=dojo.query(".lotusTitleBar")[0];
}
var _b3=dojo.byId("lotusPlaceBar");
if(!_b3){
_b3=dojo.query(".lotusPlaceBar")[0];
}
if(_b2&&_b3){
dojo.attr(_b2,"id","lotusTitleBar");
_b0="<div id=\"tabNavBar\" class=\"tabNavBar\"></div>";
dojo.place(_b0,_b2,"before");
_b2.parentNode.removeChild(_b2);
_b3.parentNode.removeChild(_b3);
dojo.place(_b2,tabNavBar,"last");
dojo.place(_b3,tabNavBar,"last");
_b0="<div id=\"tabbedImage\" class=\"tabNavImage\"></div>";
dojo.place(_b0,_b2,"first");
var _b4=dojo.query(".lotusRightCorner",_b2)[0];
if(!_b4){
_b4=dojo.query(".lotusWrapper",_b2)[0];
}
if(_b4){
dojo.addClass(_b4,"tabNavItemInBlk");
}
if(_af.parentName!=null&&_af.parentName.length>0){
_b0="<div id=\"tabNavParentName\" class=\"tabNavParentName tabNavTextEllipsis\"></div>";
_b0+="<div id=\"tabNavCommunityName\" class=\"tabNavSubcommunityName tabNavTextEllipsis\"></div>";
}else{
_b0="<div id=\"tabNavParentName\" class=\"lotusHidden\"></div>";
_b0+="<div id=\"tabNavCommunityName\" class=\"tabNavCommunityName tabNavTextEllipsis\"></div>";
}
_b0+="<div class=\"lotusHidden \" id=\"tabNavSubMenuContainer\">";
_b0+="<div id=\"tabNavSubMenuTitle\">";
_b0+="<div id=\"tabNavSubMenuTitleLinkAnc\" class=\"tabNavItemInline\">";
_b0+="<div id=\"tabNavSubMenuSelection\" class=\"tabNavSubSel tabNavItemInline\"> </div>";
_b0+="<div class=\"tabNavItemInline\"><img class=\"lotusArrow lotusDropDownSprite\" src=\""+dojo.config.blankGif+"\" alt=\"\" title=\"\" role=\"presentation\"></img><span class=\"lotusAltText\">&#9660;</span></span></div>";
_b0+="</div>";
_b0+="</div>";
_b0+="<div id=\"tabNavSubMenu\" class=\"lotusHidden\"></div>";
_b0+="</div>";
titleBarContents=dojo.query(".lotusInner",_b2)[0];
if(titleBarContents){
dojo.place(_b0,titleBarContents,"first");
}
dojo.removeClass(_b4,"lotusRightCorner");
dojo.removeClass(_b4,"lotusWrapper");
dojo.removeClass(titleBarContents,"lotusInner");
var _b5=dojo.byId("subcommArea");
if(_b5){
_b5.parentNode.removeChild(_b5);
var _b6=dojo.byId("tabNavSubMenu");
if(_b6){
dojo.place(_b5,_b6,"first");
}
}
var _b7=dojo.query(".lotusRightCorner",_b3)[0];
var _b8=dojo.query(".lotusInner",_b7)[0];
dojo.addClass(_b3,"tabNavPlaceBar");
if(_b7){
dojo.addClass(_b7,"tabNavItemInBlk flushLeft tabNavFullWidth");
}
var _b9=dojo.query(".lotusInner",_b3)[0];
if(_b9){
dojo.addClass(_b9,"tabNavItemInBlk tabNavFullWidth");
}
dojo.removeClass(_b3,"lotusPlaceBar lotusTitleBarExt");
if(_b8){
_b1=_b8.getElementsByTagName("h2")[0];
if(_b1){
_b1.parentNode.removeChild(_b1);
}
_b0="<div class=\"tabNavItemInBlk tabNavOverflowHidden\">";
_b0+="<div id=\"tabNavScrollLeftBtn\" class=\"lotusTabs\"></div>";
_b0+="<div class=\"tabNavItemInBlk tabNavOverflowHidden\" id=\"tabNavScrollContainer\">";
_b0+="<div id=\"tabNavContainer\" class=\"lotusTabs tabNavItemInBlk tabNavTabBar\"></div>";
_b0+="</div>";
_b0+="<div id=\"tabNavScrollRightBtn\" class=\"lotusTabs\"></div>";
_b0+="</div>";
dojo.place(_b0,_b8,"first");
}
actionsBar=dojo.query(".lotusTitleBarExt",_b3)[0];
if(actionsBar){
dojo.addClass(actionsBar,"tabNavActionsMenu");
dojo.removeClass(actionsBar,"lotusTitleBarExt");
}
}
},clearTopBanner:function(){
var _ba;
var _bb=dojo.query(".lotusColLeft .vcomm")[0];
if(_bb){
dojo.addClass(_bb,"lotusHidden");
}
var _bc=dojo.byId("lotusTitleBar");
if(!_bc){
_bc=dojo.query(".lotusTitleBar")[0];
}
if(_bc){
var _bd=dojo.query(".lotusInner",_bc)[0];
if(_bd){
_ba=_bd.getElementsByTagName("h2")[0];
if(_ba){
_ba.parentNode.removeChild(_ba);
}
}
if(dojo.hasClass(_bc,"lotusTitleBar2")){
dojo.addClass(_bc,"lotusTitleBar");
dojo.removeClass(_bc,"lotusTitleBar2 lotusTitlebar2Tabs");
}
}
var _be=dojo.query(".lotusPlaceBar .lotusRightCorner .lotusInner")[0];
if(_be){
_ba=_be.getElementsByTagName("h2")[0];
if(_ba){
_ba.parentNode.removeChild(_ba);
}
}
},updateTabbedCommunityLogo:function(_bf,_c0){
var _c1=this.messages;
var _c2=new lconn.core.bizCard.bizCardUtils.out();
var _c3=lconn.core.HTMLUtil.escapeInlineText(_c0.name);
_c2.write("<a title=\""+_c1["tooltip.startpage"]+"\" href=\""+_c0.homeUrl+"\" tabindex=\"-1\"><img src=\""+_c0.imageUrl+"\" width=\"64\" height=\"64\" alt=\"\" class=\"discussCommunityLogo lotusForceLineHeight\" /></a>");
var _bf=dojo.byId(_bf);
if(_bf){
dojo.place(_c2.buffer,_bf,"first");
}
},updateTabbedParentCommunityName:function(_c4,_c5){
if(_c5.parentName!=null&&_c5.parentName.length>0){
var _c6="";
var _c7=_c5.externalAllowed?"external":_c5.parentType;
_c6+=this.formatTabCommunity(_c5.parentName,_c5.parentUrl,_c7);
var _c4=dojo.byId(_c4);
if(_c4){
dojo.place(_c6,_c4,"first");
}
}
},updateTabbedCommunityName:function(_c8,_c9){
var _ca="";
var _cb=_c9.externalAllowed?"external":_c9.communityType;
_ca+=this.formatTabCommunity(_c9.name,null,_cb);
var _c8=dojo.byId(_c8);
if(_c8){
dojo.place(_ca,_c8,"first");
}
},formatTabCommunity:function(_cc,url,_cd){
var _ce="";
if(url){
var _cf=this.messages["tooltip.startpage"];
_ce+="<a class=\"lotusBold comNavInline\" role=\"button\" href=\""+url+"\" title=\""+_cf+"\">";
_ce+=this.formatTabImage(_cd);
_ce+=_cc+"</a>";
}else{
_ce+="<div class=\"comNavInline\">"+this.formatTabImage(_cd)+_cc+"</div>";
}
return _ce;
},formatTabImage:function(_d0){
var _d1="";
if(_d0!="public"){
if(_d0=="external"){
_d1+="<span class=\"lotusLeft comNavIcon\">";
_d1+="<img class=\"lotusui30 lconnIconListSharedExternal\" src=\""+dojo.config.blankGif+"\" alt=\""+this.messages["label.external.members.allowed"]+"\" title=\""+this.messages["label.external.members.allowed"]+"\" />";
_d1+="</span>";
_d1+="<span class=\"lotusAltText\">"+this.messages["label.external.members.allowed"]+" </span>";
}else{
if(_d0=="private"){
_d1+="<span class=\"lotusLeft comNavIcon\">";
_d1+="<img class=\"iconsStates16 iconsStates16-CheckedOut\" src=\""+dojo.config.blankGif+"\" alt=\""+this.messages["label.private.community.alt.text"]+"\" title=\""+this.messages["label.private.community.alt.text"]+"\" />";
_d1+="</span>";
_d1+="<span class=\"lotusAltText\">"+this.messages["label.private.community.alt.text"]+" </span>";
}else{
_d1+="<span class=\"lotusLeft comNavIcon\">";
_d1+="<img class=\"iconsOther16 iconsOther16-ModeratedCommunity16\" src=\""+dojo.config.blankGif+"\" alt=\""+this.messages["label.moderated.community.alt.text"]+"\" title=\""+this.messages["label.moderated.community.alt.text"]+"\"/>";
_d1+="</span>";
_d1+="<span class=\"lotusAltText\">"+this.messages["label.moderated.community.alt.text"]+" </span>";
}
}
}
return _d1;
},updateTabbedSubcommunitiesMenu:function(){
var _d2=this.messages;
var _d3;
var _d4=dojo.byId("tabNavSubMenu");
if(_d4){
header=_d4.getElementsByTagName("h3")[0];
if(header){
header.parentNode.removeChild(header);
}
var _d5=dojo.query("li","tabNavSubMenu");
var _d6=_d5.length;
if(_d6>0){
var _d7=dojo.byId("tabNavSubMenuSelection");
if(_d6==1){
_d3=_d2["label.one.subcommunity"].replace("${0}",_d6);
}else{
_d3=_d2["label.mult.subcommunities"].replace("${0}",_d6);
}
_d7.innerHTML=_d3;
var _d8=dojo.byId("tabNavSubMenuTitleLink");
var _d9=dojo.byId("tabNavSubMenuTitleLinkAnc");
dojo.connect(_d9,"onclick",this,function(evt){
this.toggleTabNavMenu("tabNavSubMenu");
if(evt!=null){
dojo.stopEvent(evt);
}
return false;
});
dojo.connect(document,"onclick",this,function(evt){
this.hideTabNavMenu("tabNavSubMenu");
});
var _da=null;
dojo.forEach(_d5,function(_db,ii){
dojo.connect(_db,"onkeydown",_db,function(evt){
if(evt){
_da=evt.keyCode||evt.charCode;
switch(_da){
case dojo.keys.ENTER:
case dojo.keys.SPACE:
var _dc=dojo.query("a",this)[0];
if(_dc){
_dc.click();
}
dojo.stopEvent(evt);
break;
case dojo.keys.UP_ARROW:
case dojo.keys.DOWN_ARROW:
lconn.communities.bizCard.core.moveMenuSelection("tabNavSubMenu",_da);
dojo.stopEvent(evt);
break;
case dojo.keys.ESCAPE:
case dojo.keys.TAB:
lconn.communities.bizCard.core.hideDropdownMenu("tabNavSubMenu");
dojo.stopEvent(evt);
break;
}
}
});
});
var _dd=dojo.byId("tabNavSubMenuContainer");
dojo.addClass(_dd,"tabNavItemInBlk");
dojo.removeClass(_dd,"lotusHidden");
}
}
},toggleTabNavMenu:function(_de){
if(this._subMenuOpen){
this.hideTabNavMenu(_de);
}else{
this.showTabNavMenu(_de);
}
},showTabNavMenu:function(_df){
var _e0=dojo.byId(_df);
if(_e0){
dojo.style(_e0,{"top":"auto","overflowY":"hidden","overflow":"hidden","height":"auto"});
dojo.removeClass(_e0,"lotusHidden");
this._subMenuOpen=true;
this.adjustTabMenuPosition(_df);
this._currentMenuSelection=0;
var _e1=dojo.query("li",_e0);
this.updateSelectedEntry(_e1,this._currentMenuSelection);
}
},hideTabNavMenu:function(_e2){
if(this._subMenuOpen){
var _e3=dojo.byId(_e2);
if(_e3){
dojo.byId("tabNavSubMenuTitleLinkAnc").focus();
dojo.addClass(_e3,"lotusHidden");
this._subMenuOpen=false;
}
}
},adjustTabMenuPosition:function(_e4){
var _e5,_e6;
var _e7,_e8;
var _e9,_ea;
var _eb,_ec,_ed;
var _ee,_ef;
var _f0=dojo.window.getBox();
_e5=dojo.byId(_e4);
_e6=_e5.getBoundingClientRect();
_ee=_e6.bottom-_e6.top;
var _f1=_f0.h-_e6.bottom;
if(_f1<0){
_e9=dojo.byId("lotusMain");
if(!_e9){
_e9=dojo.query(".lotusMain")[0];
}
if(_e9){
_ea=_e9.getBoundingClientRect();
}
if(_e4=="dropdownNavMenu"){
_e7=dojo.byId("dropdownNavMenuTitle");
}else{
_e7=dojo.byId("tabNavSubMenuTitle");
}
_e8=_e7.getBoundingClientRect();
_ef=_e8.bottom-_e8.top;
_eb=_e8.top;
_eb=(_eb<0)?0:_eb;
if(_eb>0){
if(_ea){
var _f2=(_ea.top<0)?0:_ea.top;
var _f3=(_e8.top-_f2)-15;
_eb=(_eb>_f3)?_f3:_eb;
}
}
var _f4=_f0.h;
if(_ea){
_f4=(_f4>_ea.bottom)?_ea.bottom:_f4;
}
_ec=(_f4-_e8.bottom)-15;
_ec=(_ec<0)?0:_ec;
if(_eb>=_ec){
if(_ee>_eb){
dojo.style(_e5,{"overflowY":"scroll","height":_eb+"px"});
_ed=_ef+_eb-1;
}else{
_ed=_ef+_ee-1;
}
var _f5=-_ed;
dojo.style(_e5,"top",_f5+"px");
}else{
if(_ee>_ec){
dojo.style(_e5,{"overflowY":"scroll","height":_ec+"px"});
}
}
}
},updateTabbedApplicationsMenu:function(_f6,_f7){
var _f8=0;
var _f9=dojo.byId(_f6);
if(_f9){
dojo.attr(_f9,{"class":"lotusTabs tabNavItemInline","role":"tablist"});
_f9.parentNode.removeChild(_f9);
dojo.attr(_f9,"id","tabbedNavList");
dojo.addClass(_f9,"lotusHidden");
var _fa=dojo.byId(_f7);
dojo.place(_f9,_fa,"last");
var _fb=dojo.query("li",_fa);
dojo.forEach(_fb,function(_fc,ii){
if(dojo.hasClass(_fc,"lotusSelected")){
_f8=ii;
}
dojo.attr(_fc,{"tabindex":"-1","role":"tab"});
_fc.removeAttribute("aria-pressed");
});
this._tabNavPanel=new lconn.communities.bizCard.core.navTabPanel("tabbedNavList",{"selIdx":_f8});
this.adjustTabbedMenuSize();
dojo.removeClass(_f9,"lotusHidden");
dojo.connect(window,"onresize",this,this.adjustTabbedMenuSize);
}
},adjustTabbedMenuSize:function(){
var _fd=dojo.byId("lotusPlaceBar");
if(!_fd){
_fd=dojo.query(".lotusPlaceBar")[0];
}
var _fe=dojo.byId("tabNavScrollContainer");
var _ff=dojo.byId("tabNavContainer");
var _100=dojo.query(".tabNavActionsMenu .lotusActions")[0];
if(_fd&&_fe&&_ff&&_100){
try{
var _101=_fd.getBoundingClientRect();
var _102=_101.right-_101.left;
var _103=_100.getBoundingClientRect();
var _104=_103.right-_103.left;
var _105=_ff.getBoundingClientRect();
var _106=_105.right-_105.left;
var _107=dojo.byId("tabNavScrollLeftBtn");
var _108=dojo.byId("tabNavScrollRightBtn");
var _109=((_102-_104)-25);
if(_106>_109){
_ff.style.width=_106+"px";
this._tabNavPanel.enableTabbedScrollButtons(_107,_108);
var _10a=dojo.byId("tabNavScrollLeft");
var _10b=_10a.getBoundingClientRect();
var _10c=_10b.right-_10b.left;
var _10d=((2*_10c)+50);
_109-=_10d;
_fe.style.width=_109+"px";
dojo.addClass(_fe,"tabNavScrollCon");
this._tabNavPanel._scrollLeftLimit=(_109-_106)+5;
}else{
if(dojo.hasClass(_107,"tabNavItemInline")){
dojo.addClass(_107,"lotusHidden");
dojo.removeClass(_107,"tabNavItemInline");
dojo.addClass(_108,"lotusHidden");
dojo.removeClass(_108,"tabNavItemInline");
_fe.style.width=_106+"px";
dojo.removeClass(_fe,"tabNavScrollCon");
}
_ff.style.left=0;
}
}
catch(e){
console.log(e);
}
}
},fixNavOnScroll:function(){
var _10e=dojo.query(".tabNavBar")[0];
if(_10e){
var _10f=_10e.getBoundingClientRect();
var _110=dojo.window.getBox();
var _111=_110.t+_10f.top;
dojo.connect(window,"onscroll",this,function(_112){
var _113=dojo.hasClass(_10e,"tabNavFixed");
var _114=dojo.docScroll().y;
if(_114>=_111+10){
if(!_113){
dojo.addClass(_10e,"tabNavFixed");
}
}else{
if(_114<=_111-10){
if(_113){
dojo.removeClass(_10e,"tabNavFixed");
}
}
}
});
}
},doDangerousAction:function(link){
var _115=document.createElement("FORM");
_115.action=link;
_115.method="post";
document.getElementsByTagName("body")[0].appendChild(_115);
lconn.communities.bizCard.core.submitFormWithNonces(_115);
},submitFormWithNonces:function(form){
lconn.communities.bizCard.core.addNonceToForm(form);
lconn.communities.bizCard.core.setNonceCookie();
form.submit();
},setNonceCookie:function(){
var name="X-Update-Nonce=";
document.cookie=name+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;";
document.cookie=name+lconn.communities.bizCard.core.getNonce()+"; expires="+new Date(new Date().getTime()+1500).toGMTString()+"; path=/";
},addNonceToForm:function(form){
var _116=document.createElement("INPUT");
_116.setAttribute("type","hidden");
_116.name="X-Update-Nonce";
_116.value=lconn.communities.bizCard.core.getNonce();
form.appendChild(_116);
},getNonce:function(){
if(typeof lconn.communities.bizCard.core.community!="undefined"&&typeof lconn.communities.bizCard.core.community.dangerousurlnonce!="undefined"){
return lconn.communities.bizCard.core.community.dangerousurlnonce;
}
return window.dangerousurlnonce;
}};
dojo.provide("lconn.communities.bizCard.core.navTabPanel");


dojo.declare("lconn.communities.bizCard.core.navTabPanel",lconn.core.aria.TabPanel,{selectedWidgetClass:"lotusSelected",selIdx:0,_scrollLeftLimit:0,constructor:function(){
this.inherited(arguments);
this.cycle=false;
dojo.forEach(this.allItems,function(_117,ii){
dojo.removeClass(_117,"lotusSelected");
dojo.removeClass(_117,"lotusBold");
dojo.attr(_117,{"tabindex":"-1","role":"tab","aria-selected":"false"});
_117.removeAttribute("aria-pressed");
var _118=dojo.query("a",_117)[0];
dojo.attr(_118,{"tabindex":"-1"});
});
this._selectWidgetItem(this.selIdx,true,this.selectedWidgetClass);
},_activate:function(item,_119){
return this.inherited(arguments);
},_selectItem:function(si,_11a){
if(typeof _11a==="undefined"){
_11a=false;
}
this._setItemVisuals();
this.inherited(arguments);
if(!_11a){
this.allItems[this.selIdx].focus();
}
},_selectWidgetItem:function(si,_11b,_11c){
if(typeof _11b==="undefined"){
_11b=false;
}
if(typeof _11c==="undefined"){
_11c=this.selectedWidgetClass;
}
this._setItemVisuals(_11c);
this.inherited(arguments);
if(!_11b){
this.allItems[this.selIdx].focus();
}
},_setItemVisuals:function(_11d){
var _11e=this.allItems[this.selIdx];
dojo.forEach(this.allItems,function(_11f,ii){
dojo.attr(_11f,{"tabindex":"-1","role":"tab","aria-selected":"false"});
if(typeof _11d!="undefined"){
dojo.removeClass(_11f,_11d);
}
});
dojo.attr(_11e,{"tabindex":"0","role":"tab","aria-selected":"true"});
if(typeof _11d!="undefined"){
dojo.addClass(_11e,_11d);
}
},enableTabbedScrollButtons:function(_120,_121){
dojo.addClass(_120,"tabNavItemInline");
dojo.removeClass(_120,"lotusHidden");
dojo.addClass(_121,"tabNavItemInline");
dojo.removeClass(_121,"lotusHidden");
if(!dojo.byId("tabNavScrollLeft")){
var _122;
_122="<ul class=\"lotusTabs tabNavItemInBlk tabNavScrollBtnU\">";
_122+="<li class=\"tabNavScrollBtn\"><a href=\"javascript:;\" role=\"button\" id=\"tabNavScrollLeft\" class=\"tabNavScrollBtnA\" tabindex=\"-1\">";
_122+="<img class=\"dijitTabStripIcon dijitTabStripSlideLeftIcon\" role=\"presentation\" alt=\"\" src=\""+dojo.config.blankGif+"\" >";
_122+="<span role=\"presentation\" class=\"lotusAltText\">&#9664;</span>";
_122+="</a></li>";
_122+="</ul>";
dojo.place(_122,_120,"last");
_122="<ul class=\"lotusTabs tabNavItemInBlk tabNavScrollBtnU\">";
_122+="<li class=\"tabNavScrollBtn\"><a href=\"javascript:;\" role=\"button\" id=\"tabNavScrollRight\" class=\"tabNavScrollBtnA tabNavScrollBtnDisabled\" tabindex=\"-1\">";
_122+="<img class=\"dijitTabStripIcon dijitTabStripSlideRightIcon\" role=\"presentation\" alt=\"\" src=\""+dojo.config.blankGif+"\" >";
_122+="<span role=\"presentation\" class=\"lotusAltText\">&#9654;</span>";
_122+="</a></li>";
_122+="</ul>";
dojo.place(_122,_121,"last");
dojo.connect(dojo.byId("tabNavScrollLeft"),"onclick",this,function(evt){
this.scrollTabs("l");
return false;
});
dojo.connect(dojo.byId("tabNavScrollRight"),"onclick",this,function(evt){
this.scrollTabs("r");
return false;
});
}
},scrollTabs:function(dir){
var _123=0;
var _124=0;
var _125=100;
var _126=dojo.byId("tabNavScrollLeft");
var _127=dojo.byId("tabNavScrollRight");
var _128=dojo.byId("tabNavContainer");
var _129=_128.style.left;
var _123=0;
var _12a=_129.indexOf("px");
if(_12a>-1){
_123=Number(_129.substr(0,_12a));
}
if(dir=="r"){
dojo.removeClass(_126,"tabNavScrollBtnDisabled");
_124=_123+_125;
if(_124>0){
_124=0;
dojo.addClass(_127,"tabNavScrollBtnDisabled");
}
_128.style.left=_124+"px";
}else{
dojo.removeClass(_127,"tabNavScrollBtnDisabled");
_124=_123-_125;
if(_124<this._scrollLeftLimit){
_124=this._scrollLeftLimit;
dojo.addClass(_126,"tabNavScrollBtnDisabled");
}
_128.style.left=_124+"px";
}
}});
}


;if(!dojo._hasResource["lconn.communities.bizCard.bizCardUI"]){
dojo._hasResource["lconn.communities.bizCard.bizCardUI"]=true;
dojo.provide("lconn.communities.bizCard.bizCardUI");






dojo.requireLocalization("lconn.communities.bizCard","ui");
lconn.communities.bizCard.bizCardUI={messages:dojo.i18n.getLocalization("lconn.communities.bizCard","ui"),mainNodeId:"bc_document_node_comm",getMenuData:function(_1,_2,_3,_4,_5,_6){
var _7=this.messages;
var _8=_7["label.overview"];
var _9="";
if(lconn.core.bizCard.bizCardUtils.standaloneCSSloaded){
_9=" lotusui";
}
var _a=lconn.core.HTMLUtil.escapeInlineText(_1.name);
_5.write("<div id='container "+_9+"' style='width: 32em; border: 1px solid #e0e0e0; -moz-border-radius:7px;background-color:#F5F8FF;padding:10px 0px 8px 10px;'>");
_5.write("  <div id='navigationLinks' style='clear:left; border-bottom:1px solid #e0e0e0;padding: 0px 0pt 5px 0px;margin:0;'>");
_5.write("      <a href='"+_1.homeOverviewUrl+"' title=\""+_8+"\" class='action'>"+_8+"</a>");
this.writeLinksforPopupCard(_5,_1);
_5.write("  </div><br/>");
if(_1.imageUrl!=null&&_1.imageUrl!=""){
_5.write("  <img src='"+_1.imageUrl+"' alt=\""+_a+"\" title=\""+_a+"\" height='95' width='95' style='float:left;margin: 0px 10px 10px 10px; padding:2px !important; border:1px solid #c2c2c2;background-color:#fff;'/>");
}
_5.write("  <div  style='height:9em;overflow:hidden;'>");
_5.write("  <h2 style='font-size:1.1em;margin:0;margin-right:20px;padding:0;'>"+_1.name+"<span id='membersCount' style='font-size:.9em;color:#999;font-weight:normal;'> ("+_1.membercount+" "+_7["label.members"]+")</span></h2>");
if(_1.tags!=null&&_1.tags!=""){
_5.write("  <div style='font-size:.9em;color:#999;padding:0;margin:0;'>"+_7["label.tags"]+" "+_1.tags+"</div>");
}
if(_1.description!=null&&_1.description!=""){
_5.write("  <p id='communityDescription' style='font-size:.9em;padding:3px 5px 0 0;margin:0;'>");
_5.write("      "+_1.description);
_5.write("  </p>                        ");
}
_5.write("  </div>                      ");
_5.write("</div><!-- end container -->");
},getInlineMarkup:function(_b,_c,_d,_e){
if(_b.showNewNavigation){
this.getInlineMarkupDropdown(_b,_c,_d,_e);
return;
}
var _f=this.messages;
var _10=_d;
var _11=((!dojo.cookie)?true:(dojo.cookie("community.inline.card.links")!=0));
var _12="";
var _13=_f["label.collapse"];
var _14="lotusTwistyOpen";
if(_11){
_14="lotusTwistyOpen";
}else{
_14="lotusTwistyClosed";
_12="style=\"display: none\"";
_13=_f["label.expand"];
}
_10.write("<style>.lotusui30 img.lotusForceLineHeight { line-height: 1; }</style>");
if(lconn.core.bizCard.bizCardUtils.standaloneCSSloaded){
_10.write("<div id=\""+this.mainNodeId+"\" role=\"document\" style=\"width:220px\">");
}
_10.write("<div class=\"lotusMenu\" role=\"navigation\" aria-label=\""+_f["label.nav.landmark.comm"]+"\"><div class=\"lotusBottomCorner\"><div class=\"lotusInner\">");
_10.write(lconn.communities.bizCard.core.addParentCommunity(_b));
_10.write("<div class=\"lotusMenuSection\">");
_10.write("<h3 class=\"\"><div class=\"lotusIndent10\"><a id=\""+_b.uuid+"_twisty\" class=\"lotusSprite lotusArrow "+_14+"\" href=\"javascript:lconn.communities.bizCard.core.toggleSection('"+_b.uuid+"_twisty"+"','"+_b.uuid+"_comm_appLinks"+"','"+_b.uuid+"_commAltText"+"','"+"community.inline.card.links"+"');\" title=\""+_13+"\"><span id=\""+_b.uuid+"_commAltText\" class=\"lotusAltText\">&#x25bc;</span></a>");
_10.write("<table cellpadding=\"0\" cellspacing=\"0\" class=\"lotusLayout\" role=\"presentation\" width=\"155px\"><tr><td>");
_10.write("<a href=\""+_b.homeUrl+"\" class=\"discussCommunityLink lotusBold\" title=\""+_f["tooltip.startpage"]+"\">");
if(_b.communityType!="public"){
var _15=lconn.core.bizCard.bizCardUtils.getBaseURL("hgroup");
if(_b.communityType=="private"){
_10.write("<img class='iconsStates16 iconsStates16-CheckedOut' src='"+dojo.config.blankGif+"' alt='"+_f["label.private.community.alt.text"]+"' title='"+_f["label.private.community.alt.text"]+"' /> ");
}else{
_10.write("<img class='lconnSprite lconnSprite-iconModeratedCommunity16' src='"+dojo.config.blankGif+"' alt='"+_f["label.moderated.community.alt.text"]+"' title='"+_f["label.moderated.community.alt.text"]+"' /> ");
}
var _16=document.getElementsByTagName("body")[0];
if(dojo.hasClass(_16,"lotusImagesOff")){
_10.write("<br>");
}
}
_10.write(_b.name+"</a>");
_10.write("</td></tr></table>");
_10.write("</div>");
_10.write("</h3>");
_10.write("<div id=\""+_b.uuid+"_comm_appLinks\" class=\"lotusMenuSubsection\" "+_12+">");
_10.write("<ul id=\"bizCardNav\" role=\"toolbar\" aria-label=\""+_f["label.nav.landmark.comm"]+"\">");
var _17=lconn.core.HTMLUtil.escapeInlineText(_b.name);
_10.write("<li class=\"lconnCommLogo\" role=\"presentation\" tabindex=\"-1\"><a title=\""+_f["tooltip.startpage"]+"\" href=\""+_b.homeUrl+"\" tabindex=\"-1\"><img src=\""+_b.imageUrl+"\" width=\"155\" height=\"155\" alt=\""+_f["tooltip.startpage"]+"\" class=\"discussCommunityLogo lotusForceLineHeight\" /></a></li>");
this.writeLinks(_10,_b,_e,_11);
if(_b.metricsEnabled){
_10.write("<li role=\"button\"");
if(_e=="metrics"){
_10.write(" class=\"lotusSelected\" ");
}
_10.write("><a href='"+_b.metricsServiceUrl.replace("${0}",_b.uuid)+"' title='"+_f["label.metrics.link"]+"'>"+_f["label.metrics.link"]+"</a></li>");
}
if(_b.moderateEnabled){
_10.write("<li role=\"button\"");
if(_e=="moderation"){
_10.write(" class=\"lotusSelected\" ");
}
_10.write("><a href='"+_b.moderationServiceUrl+_b.uuid+"' title='"+_f["label.moderation.link"]+"'>"+_f["label.moderation.link"]+"</a></li>");
}
_10.write("</ul>");
_10.write("</div><!--end subsection-->");
_10.write("</div><!--end section-->");
_10.write(lconn.communities.bizCard.core.addSubCommunities(_b));
_10.write("</div></div></div><!--end menu-->");
if(lconn.core.bizCard.bizCardUtils.standaloneCSSloaded){
_10.write("</div>");
var _18=this.mainNodeId;
var _19=function(){
var el=dojo.byId(_18);
if(!el){
setTimeout(_19,250);
return;
}
var _1a=" lotusui lotusui30dojo lotusui30_body lotusui30_fonts lotusui30 lotusSpritesOn";
if(dojo.isIE==7){
_1a+=" lotusui_ie lotusui_ie7";
}else{
if(dojo.isIE){
_1a+=" lotusui_ie";
}
}
el.className+=_1a;
};
_19();
}
},getInlineMarkupDropdown:function(_1b,_1c,_1d,_1e){
if(_1b.showTabbedNavigation){
lconn.communities.bizCard.core.clearTopBanner();
}
var _1f=this.messages;
var _20=_1d;
var _21=((!dojo.cookie)?true:(dojo.cookie("community.inline.card.links")!=0));
var _22="";
var _23=_1f["label.collapse"];
var _24="lotusTwistyOpen";
if(_21){
_24="lotusTwistyOpen";
}else{
_24="lotusTwistyClosed";
_22="style=\"display: none\"";
_23=_1f["label.expand"];
}
_20.write("<style>.lotusui30 img.lotusForceLineHeight { line-height: 1; }</style>");
if(lconn.core.bizCard.bizCardUtils.standaloneCSSloaded){
_20.write("<div id=\""+this.mainNodeId+"\" role=\"document\" style=\"width:220px\">");
}
_20.write("<div class=\"lotusMenu\" role=\"navigation\" aria-label=\""+_1f["label.nav.landmark.comm"]+"\"><div class=\"lotusBottomCorner\"><div class=\"lotusInner\">");
_20.write("<div class=\"lotusMenuSection\">");
_20.write("<div id=\""+_1b.uuid+"_comm_appLinks\" class=\"lotusMenuSubsection\" "+_22+">");
_20.write("<ul id=\"bizCardNav\" role=\"toolbar\" aria-label=\""+_1f["label.nav.landmark.comm"]+"\">");
var _25=lconn.core.HTMLUtil.escapeInlineText(_1b.name);
_20.write("<li class=\"lconnCommLogo\" role=\"presentation\" tabindex=\"-1\"><a title=\""+_1f["tooltip.startpage"]+"\" href=\""+_1b.homeUrl+"\" tabindex=\"-1\"><img src=\""+_1b.imageUrl+"\" width=\"155\" height=\"155\" alt=\""+_1f["tooltip.startpage"]+"\" class=\"discussCommunityLogo lotusForceLineHeight\" /></a></li>");
_20.write("</ul>");
_20.write("<div class=\"lotusHidden\" id=\"leftNavMenu\">");
_20.write("<ul id=\"bizCardNavMenu\" role=\"toolbar\" aria-label=\""+_1f["label.nav.landmark.comm"]+"\">");
this.writeLinks(_20,_1b,_1e,_21);
if(_1b.metricsEnabled){
_20.write("<li role=\"button\"");
if(_1e=="metrics"){
_20.write(" class=\"lotusSelected\" ");
}
_20.write("><a href='"+_1b.metricsServiceUrl.replace("${0}",_1b.uuid)+"' title='"+_1f["label.metrics.link"]+"'>"+_1f["label.metrics.link"]+"</a></li>");
}
if(_1b.moderateEnabled){
_20.write("<li role=\"button\"");
if(_1e=="moderation"){
_20.write(" class=\"lotusSelected\" ");
}
_20.write("><a href='"+_1b.moderationServiceUrl+_1b.uuid+"' title='"+_1f["label.moderation.link"]+"'>"+_1f["label.moderation.link"]+"</a></li>");
}
_20.write("</ul>");
_20.write("</div><!--end subsection-->");
_20.write("</div><!--end section-->");
_20.write("</div>");
var _26=dojo.byId("lotusMain");
if(!_26){
_26=dojo.query(".lotusMain")[0];
}
if(_26){
_26.style.overflowY="visible";
_26.style.minHeight="800px";
}
this.writeSelectedLink(_20,_1b,_1e,_21);
_20.write("<div id=\"dropdownSubMenuContainer\" class=\"lotusHidden\">");
_20.write("<div id=\"dropdownSubMenuTitle\">");
_20.write("<ul><li class=\"lotusSelected\" id=\"dropdownSubMenuTitleLink\">");
_20.write("<a href=\"javascript:;\" title=\"\" id=\"dropdownSubMenuTitleLinkAnc\" aria-haspopup=\"true\">");
_20.write("<div id=\"dropdownSubMenuSelection\"></div>");
_20.write("<span class=\"lotusRight\"><span id=\"dropdownSubMenuIcon\" class=\"lotusSprite lotusArrow lotusTwistyOpen\"><span class=\"lotusAltText\">&#9660;</span></span></span>");
_20.write("</a></li></ul>");
_20.write("</div>");
_20.write("<div id=\"dropdownSubMenu\" class=\"lotusHidden\">");
_20.write("<div id=\"subcommArea\">");
_20.write(lconn.communities.bizCard.core.addSubCommunities(_1b));
_20.write("</div><!--end section-->");
_20.write("</div>");
_20.write("</div>");
_20.write("</div></div></div><!--end menu-->");
if(lconn.core.bizCard.bizCardUtils.standaloneCSSloaded){
_20.write("</div>");
var _27=this.mainNodeId;
var _28=function(){
var el=dojo.byId(_27);
if(!el){
setTimeout(_28,250);
return;
}
var _29=" lotusui lotusui30dojo lotusui30_body lotusui30_fonts lotusui30 lotusSpritesOn";
if(dojo.isIE==7){
_29+=" lotusui_ie lotusui_ie7";
}else{
if(dojo.isIE){
_29+=" lotusui_ie";
}
}
el.className+=_29;
};
_28();
}
},writeLinksforPopupCard:function(_2a,_2b){
for(var i=0;_2b.links!=null&&i<_2b.links.length;i++){
_2a.write("&nbsp;&nbsp;|&nbsp;<a href='"+_2b.links[i].url+"' title='"+_2b.links[i].label+"' class='action'>"+_2b.links[i].label+"</a>");
}
},composePageTitle:function(_2c,_2d){
var _2e=this.messages["label.window.title"];
var _2f="";
var _30="";
if(_2c){
_2f=lconn.core.HTMLUtil.escapeInlineText(_2c);
}
if(_2d){
_30=lconn.core.HTMLUtil.escapeText(_2d);
}
return dojo.string.substitute(_2e,[_2f,_30]);
},writeSelectedLink:function(_31,_32,_33,_34){
var _35=this.messages;
var _36;
_31.write("<div id=\"dropdownNavMenuContainer\">");
if(_33=="metrics"||_33=="moderation"){
_31.write("<div id=\"dropdownNavMenuTitle\">");
_31.write("<ul><li class=\"lotusSelected\" id=\"dropdownNavMenuTitleLink\">");
if(_33=="metrics"){
_36=lconn.core.HTMLUtil.escapeText(_35["label.metrics.link"]);
}else{
_36=lconn.core.HTMLUtil.escapeText(_35["label.moderation.link"]);
}
_31.write("<a href=\"javascript:void(0);\" title=\"\" id=\"dropdownNavMenuTitleLinkAnc\" aria-haspopup=\"true\">");
_31.write("<div id=\"dropdownNavMenuSelection\">"+_36+"</div>");
_31.write("<span class=\"lotusRight\"><span id=\"dropdownNavMenuIcon\" class=\"lotusSprite lotusArrow lotusTwistyOpen\"><span class=\"lotusAltText\">&#9660;</span></span></span>");
_31.write("</a></li></ul>");
_31.write("</div>");
}else{
var _36=_35["label.overview"];
for(var i=0;_32.links!=null&&i<_32.links.length;i++){
var _37=_32.links[i];
if(_33==_37.id){
_36=lconn.core.HTMLUtil.escapeText(_37.label);
break;
}
}
_31.write("<div id=\"dropdownNavMenuTitle\">");
_31.write("<ul><li class=\"lotusSelected\" id=\"dropdownNavMenuTitleLink\">");
_31.write("<a href=\"javascript:void(0);\" title=\"\" id=\"dropdownNavMenuTitleLinkAnc\" aria-haspopup=\"true\">");
_31.write("<div id=\"dropdownNavMenuSelection\">"+_36+"</div>");
_31.write("<span class=\"lotusRight\"><span id=\"dropdownNavMenuIcon\" class=\"lotusSprite lotusArrow lotusTwistyOpen\"><span class=\"lotusAltText\">&#9660;</span></span></span>");
_31.write("</a></li></ul>");
_31.write("</div>");
}
_31.write("</div>");
},writeLinks:function(_38,_39,_3a,_3b){
var _3c=this.messages;
_38.write("<li role=\"button\"><a href=\""+_39.homeOverviewUrl+"\" title=\""+_3c["tooltip.overview"]+"\">"+_3c["label.overview"]+"</a></li>");
for(var i=0;_39.links!=null&&i<_39.links.length;i++){
var _3d=_39.links[i];
if(_3d.id=="RecentUpdates"||_3d.id=="StatusUpdates"){
this.writeLink(_3d,_38,_3a);
}
}
for(var i=0;_39.links!=null&&i<_39.links.length;i++){
var _3d=_39.links[i];
if(_3d.id=="Members"){
this.writeLink(_3d,_38,_3a);
break;
}
}
this.writeColLinks(_39,_38,_3a,"banner");
this.writeColLinks(_39,_38,_3a,"col1");
this.writeColLinks(_39,_38,_3a,"col2");
this.writeColLinks(_39,_38,_3a,"col3");
return;
},writeColLinks:function(_3e,_3f,_40,_41){
for(var i=0;_3e.links!=null&&i<_3e.links.length;i++){
var _42=_3e.links[i];
if(_42.id!="RecentUpdates"&&_42.id!="StatusUpdates"&&_42.id!="Members"){
if(_42.uiLocation.indexOf(_41)!=-1){
this.writeLink(_42,_3f,_40);
}
}
}
},writeLink:function(_43,_44,_45){
_44.write("<li role=\"button\" widgetdefid=\""+_43.id+"\"");
if(_45==_43.id){
_44.write(" class=\"lotusSelected\" ");
}
var _46=lconn.core.HTMLUtil.escapeText(_43.label);
_44.write("><a href=\""+_43.url+"\" title=\""+_46+"\">"+_46+"</a></li>");
},addCommunityActionsMenu:function(_47){
_47.showGoToComm=true;
lconn.communities.bizCard.core.community=_47;
if(lconn.communities.bizCard.core.isNotEmpty(_47.unfollowUrl)){
dojo.publish("lconn.comm.commFollowed",[_47.uuid]);
}
try{
lconn.communities.bizCard.core.addFollowActionsMenuUI(_47);
}
catch(e){
}
try{
lconn.communities.bizCard.core.addCommunityActionsMenuUI(_47);
}
catch(e){
}
try{
if(_47.showTabbedNavigation){
lconn.communities.bizCard.core.writeTabbedNavigation(_47);
}else{
if(_47.showNewNavigation){
lconn.communities.bizCard.core.addCommunityNavMenuUI("dropdownNavMenuTitle",_47);
}
}
}
catch(e){
console.log(e);
}
}};
}


;if(!dojo._hasResource["lconn.communities.bizCard.bizCard"]){
dojo._hasResource["lconn.communities.bizCard.bizCard"]=true;
dojo.provide("lconn.communities.bizCard.bizCard");






ic_comm_communityUuid="";
ic_comm_communityName="";
ic_comm_communityType="";
ic_comm_communitiesSvcRef="";
lconn.communities.bizCard.bizCard={messages:{},servletUrl:null,requestor:null,initited:false,init:function(){
this.servletUrl=lconn.core.bizCard.bizCardUtils.getBaseURL("hgroup")+"/service/json/communityview?communityUuid=@@@UUID@@@";
if(this.initited==false){
dojo.requireLocalization("lconn.communities.bizCard","ui");
this.messages=dojo.i18n.getLocalization("lconn.communities.bizCard","ui");
this.requestor=new LCSemTagUtil.crossDomainRequest();
if(dojo.exists("lconn.bizCard.publish")){
lconn.bizCard.publish("lconn/bizCard/communities/init",this);
}
this.initited=true;
}
},updateGlobalVars:function(_1){
ic_comm_communityUuid=_1.uuid;
ic_comm_communityName=_1.name;
ic_comm_communityType=_1.communityType;
ic_comm_communitiesSvcRef=lconn.core.bizCard.bizCardUtils.getBaseURL("hgroup");
},getIdMethod:function(_2){
return _2.uuid?_2.uuid:null;
},convMethod:function(_3){
return _3;
},customTrim:function(_4){
return _4.replace(/^\s+/,"").replace(/\s+$/,"");
},processTag:function(_5){
try{
if(!this.initited){
lconn.core.bizCard.bizCardUtils.init();
LCSemTagMenu.init();
this.init();
}
this.processHcard(_5);
}
catch(e){
console.log(e);
}
},processHcard:function(_6){
var _7=this.getNameElement(_6);
if(!_7){
return;
}
if(this.isInline(_6)){
var _8={"target":_7};
this.getTagFromServer(_8);
}else{
lconn.core.bizCard.bizCardUtils.addHover(_7,lconn.communities.bizCard.bizCard.showHover,lconn.communities.bizCard.bizCard.showMenu);
}
_7.setAttribute("aria-label",this.messages["label.semtag.hover.altA11Y"]);
},isInline:function(_9){
return this.getHcardAttributeValue("X-community-display-inline",_9);
},loadHcardCommunity:function(_a){
var _b=new Object();
var _c=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcomm",_a);
var _d=_c.getElementsByTagName("*");
for(i=0;i<_d.length;i++){
var _e=_d[i];
if(_e.className){
var _f=_e.className.split(" ");
for(j=0;j<_f.length;j++){
var c=_f[j];
var _10=this.getHcardAttributeValue(c,_c);
if(_10){
_b[c]=_10;
}
}
}
}
return _b;
},getHcardAttributeValue:function(_11,_12){
switch(_11){
case ("name"):
return this.getHcardTypedAttribute(_12,_11,"name");
case ("uuid"):
return this.getHcardTypedAttribute(_12,_11,"uuid");
case ("selectedWidgetId"):
return this.getHcardTypedAttribute(_12,_11,"selectedWidgetId");
}
var _13=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcomm",_12);
var _14=lconn.core.bizCard.bizCardUtils.getElementsByClassName(_11,_13,1);
if(_14.length>0&&_14[0].tagName.match(/^abbr$/i)){
return _14[0].getAttribute("title");
}
switch(_11){
case ("uuid"):
var _15=lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_14[0]);
if(_15){
return _15;
}else{
return this.getHcardAttributeValue("name",_12);
}
break;
case ("name"):
var _16=lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_14[0]);
if(_16){
return _16;
}
break;
case ("selectedWidgetId"):
var _17=lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_14[0]);
if(_17){
return _17;
}
break;
case ("X-community-display-inline"):
if(_14.length>0){
return true;
}else{
return false;
}
default:
return lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_14[0]);
break;
}
},getHcardTypedAttribute:function(_18,_19,_1a){
var _1b=new Object();
var _1c=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcomm",_18);
var _1d=lconn.core.bizCard.bizCardUtils.getElementsByClassName(_19,_1c);
for(i=0;i<_1d.length;i++){
var _1e=_1d[i];
_1b=lconn.core.bizCard.bizCardUtils.getTypedValue(_1e,_1a);
}
return _1b;
},showHover:function(_1f){
try{
lconn.core.bizCard.bizCardUtils.showHover(_1f,lconn.communities.bizCard.bizCard.showMenu);
if(!LCSemTagMenu.preventFocus){
this.focus();
}
}
catch(e){
console.log("Error in lconn.communities.bizCard.bizCard.showHover");
console.log(e);
}
},showMenu:function(_20){
LCSemTagMenu.waitCursor();
lconn.communities.bizCard.bizCard.getTagFromServer(_20);
},getTagFromServer:function(_21){
var _22=null;
var _23=null;
if(_21!=null&&_21.target!=null&&_21.target.className=="name"){
_22=_21.target;
_23=_21;
LCSemTagMenu.currentElem=_22;
}else{
_22=LCSemTagMenu.currentElem;
_23={target:_22,original:_21};
if(_22==null&&_21!=null){
_23=_21;
_22=_21.target;
}
}
var _24=this.customTrim(this.getElementUuid(_22));
var _25={"UUID":_24};
var _26="lconn.communities.bizCard.bizCard.dispatch";
var _27=_24;
if(lconn.core.bizCard.bizCardUtils.isDebug){
window.status="Community.getTagFromServer sending request for: "+_24+")";
}
lconn.core.bizCard.bizCardUtils.getBizCardData(this.servletUrl+"&preventCache="+new Date().getTime(),_25,_26,this.requestor,this.requestReturn,_23,_27);
},requestReturn:function(_28,_29,_2a){
if(_28==false){
console.log("lconn.communities.bizCard.bizCard.requestReturn: Error occurring while rendering the community bizcard");
console.log("lconn.communities.bizCard.bizCard.requestReturn: Error Details: "+_29);
}else{
if(lconn.core.bizCard.bizCardUtils.isDebug){
window.status="Community.requestReturn: success="+_28;
}
var _2b=_28?lconn.communities.bizCard.bizCard.convMethod(_29):{};
var _2c=lconn.core.bizCard.bizCardUtils.getLiveElementFromEvent(_2a);
lconn.communities.bizCard.bizCard.fillCommunityJsonMoreFromDom(_2b,_2c);
lconn.communities.bizCard.bizCard.update(_2b,_2c,_2a);
}
},fillCommunityJsonMoreFromDom:function(_2d,_2e){
if(lconn.core.bizCard.bizCardUtils.isDebug){
window.status="Community.fillCommunityJsonMoreFromDom";
}
if(!_2d.name){
var _2f=lconn.core.bizCard.bizCardUtils.findNameElementInHcard(_2e);
if(_2f){
_2d.name=lconn.core.bizCard.bizCardUtils.getTextValue(_2f);
}
}
if(!_2d.uuid){
var _30=this.getElementUuid(_2e);
_2d.uuid=_30;
}
},update:function(_31,_32,_33){
if(lconn.core.bizCard.bizCardUtils.isDebug){
window.status="Community.update";
}
this.currentCommunity=_31;
var _34=null;
dojo.query(".vcomm").forEach(function(_35){
_34=_35;
});
if(_34&&this.isInline(_34)){
var out=new lconn.core.bizCard.bizCardUtils.out();
var _36=this.getHcardAttributeValue("selectedWidgetId",_34).selectedWidgetId;
lconn.communities.bizCard.bizCardUI.getInlineMarkup(_31,"ltr",out,_36);
var _37=lconn.core.bizCard.bizCardUtils.getElementsByClassName("personinlinemenu",_34,1);
if(_37.length>0){
_37[0].innerHTML=out.buffer;
}else{
var _38=document.createElement("span");
_38.className="personinlinemenu";
_38.innerHTML=out.buffer;
try{
_34.appendChild(_38);
}
catch(e){
console.log("Error: attempt place inline bizcard menu under vcomm classed element failed.  parentVcomm=["+_34+"]");
console.log(e);
}
}
if(dojo.exists("lconn.core.WidgetPlacement")){
new lconn.core.WidgetPlacement.aria.Toolbar("bizCardNav");
}
lconn.communities.bizCard.bizCardUI.addCommunityActionsMenu(_31);
if(lconn.communities.bizCard.core.community.enableNewRelicTracking==true){
var _39=dojo.byId("bizCardNavMenu");
if(_39!=null){
var _3a=function(_3b,_3c){
var _3d=dojo.attr(this,"widgetdefid");
if(_3d==null){
_3d=this.textContent;
}
lconn.communities.bizCard.newRelicTracker.navAction(_3b,_3c,_3d,this.id);
return false;
};
dojo.query("li",_39).forEach(function(_3e){
dojo.connect(_3e,"onclick",null,dojo.partial(_3a,lconn.communities.bizCard.core.community.uuid,lconn.communities.bizCard.core.community.userUuid));
});
}
}
}else{
var _3f=new Array();
var _40="personMenuActions";
var _41=new lconn.core.bizCard.bizCardUtils.out();
var _42=new lconn.core.bizCard.bizCardUtils.out();
lconn.communities.bizCard.bizCardUI.getMenuData(_31,"ltr",_3f,_40,_41,_42);
lconn.core.bizCard.bizCardUtils.setMenuData(_33,_3f,_40,lconn.core.bizCard.bizCardUtils.getMenuHeaderJson(_41.buffer,-100));
}
this.updateGlobalVars(_31);
},dispatch:function(_43){
var _44=this.getIdMethod(_43);
this.requestor.dispatch(_44,_43);
},getElementUuid:function(_45){
var _46;
var _47=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcomm",_45);
if(_47!=null){
_46=this.getHcardAttributeValue("uuid",_47);
_46=_46.uuid;
}
return _46;
},getNameElement:function(_48){
if(_48.className!="vcomm"){
_48=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcomm",_48);
}
var _49=lconn.core.bizCard.bizCardUtils.getElementsByClassName("name",_48,1)[0];
return _49;
}};
(function(win){
win.SemTagSvcConfig=win.SemTagSvcConfig||{};
win.livetextCfg=win.livetextCfg||[];
var _4a;
try{
var _4b=lconn.core.url.getServiceUrl(lconn.core.config.services.communities);
_4a=_4b.uri;
}
catch(e){
if(win.SemTagSvcConfig.communitiesSvc){
_4a=win.SemTagSvcConfig.communitiesSvc;
}
}
if(_4a){
win.SemTagSvcConfig.baseUrl=_4a;
win.livetextCfg.push({"id":"hgroup","match":".vcomm","tagHandler":lconn.communities.bizCard.bizCard,"loaded":true,"baseURL":_4a});
}
}(window));
}


;if(!dojo._hasResource["lconn.communities.bizCard.dialogs.leaveConfirm"]){
dojo._hasResource["lconn.communities.bizCard.dialogs.leaveConfirm"]=true;
dojo.provide("lconn.communities.bizCard.dialogs.leaveConfirm");


dojo.requireLocalization("lconn.communities.bizCard","ui");
dojo.declare("lconn.communities.bizCard.dialogs.leaveConfirm",[dijit.Dialog],{stringResources:dojo.i18n.getLocalization("lconn.communities.bizCard","ui"),templateString:"<div dojoAttachPoint=\"containerNode\" id=\"dialog_communities\" class=\"lotusui30dojo lotusDialogWrapper\" tabindex=\"-1\" waiRole=\"dialog\" waiState=\"labelledby-${id}_title\">            <div style=\"width:600px\" aria-labelledby=\"${id}_title\" role=\"region\">\t\t\t\t<div dojoAttachPoint=\"dialogBorder\" class=\"lotusDialogBorder\" aria-labelledby=\"${id}_content\">\t\t\t\t\t<div class=\"lotusDialog lotusForm2 lotusLeftLabels _lotusDelete\"> \t\t\t\t\t\t<div dojoAttachPoint=\"titleBar\" class=\"lotusDialogHeader\"> \t\t\t\t\t\t\t<div dojoAttachPoint=\"titleNode\" id=\"${id}_title\" class=\"lotusHeading\">${dlgTitle}</div> \t\t\t\t\t\t\t<a class=\"lotusDialogClose\" role=\"button\" href=\"javascript:;\" title=\"${closeAnchorTitle}\"  dojoAttachEvent=\"onkeypress:onEnterCancelClicked,onclick:onCancelClicked\">\t\t\t\t\t\t\t\t<img dojoAttachEvent=\"onclick:onCancelClicked\" alt=\"${closeImageAltText}\" src=\""+dojo.config.blankGif+"\"/>\t\t\t\t\t\t\t\t<span class=\"lotusAltText\">X</span>\t\t\t\t\t\t\t</a> \t\t\t\t\t\t</div>\t\t\t\t\t\t<div>                            <div class=\"lotusDialogContent\" id=\"${id}_content\">\t\t\t\t\t\t\t\t${dlgContent}\t\t\t\t\t\t\t</div><!--end lotusDialogContent-->\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class=\"lotusDialogFooter\">\t\t\t\t\t\t\t<button dojoAttachPoint=\"okButtonNode\" class=\"lotusBtn\" dojoAttachEvent=\"onclick:onOkClicked\">${okButtonValue}</button>\t\t\t\t\t\t\t<button dojoAttachPoint=\"closeButtonNode\" dojoAttachPoint=\"closeText\" class=\"lotusBtn\" dojoAttachEvent=\"onclick:onCancelClicked\">${closeButtonValue}</button>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t</div><!--end lotusDialogBorder-->\t\t\t</div>\t\t</div>",callback:null,dlgContent:null,postMixInProperties:function(){
this.dlgTitle=this.stringResources["label.leaveConfirm.dlgTitle"];
this.okButtonValue=this.stringResources["label.leaveConfirm.okButtonValue"];
this.closeButtonValue=this.stringResources["label.leaveConfirm.closeButtonValue"];
this.closeAnchorTitle=this.closeImageAltText=this.stringResources["label.msgbox.close"];
this.inherited(arguments);
},postCreate:function(){
dojo.attr(this.dialogBorder,"style",{width:"auto"});
this.inherited(arguments);
dojo.removeClass(this.containerNode,"dijitContentPane");
},onOkClicked:function(){
this.hide();
if(this.callback!=null){
this.callback();
}
},onCancelClicked:function(){
this.hide();
},onEnterCancelClicked:function(_1){
if(_1.keyCode==13){
this.onCancelClicked();
}
}});
}


;if(!dojo._hasResource["lconn.communities.bizCard.core_internal"]){
dojo._hasResource["lconn.communities.bizCard.core_internal"]=true;
dojo.provide("lconn.communities.bizCard.core_internal");












lconn.communities.bizCard.core=dojo.mixin(lconn.communities.bizCard.core,{CommunityDelete:function(){
lconn.communities.bizCard.core.doDangerousAction(lconn.communities.bizCard.core.community.deleteUrl);
},CommunityLeave:function(){
lconn.communities.bizCard.core.doDangerousAction(lconn.communities.bizCard.core.community.leaveUrl);
},confirmCommunityDeletion:function(_1){
var _2=_1.subcommunities.length;
var _3={"communityTitle":ic_comm_communityName,"callback":this.CommunityDelete,"numSubs":_2,"userName":_1.userName};
if((_1.trashEnabled==true)&&(_1.trashUIEnabled==true)){
var _4=new lconn.communities.bizCard.dialogs.deleteConfirmTrash(_3);
}else{
var _4=new lconn.communities.bizCard.dialogs.deleteConfirm(_3);
}
_4.show();
},confirmCommunityLeave:function(){
var _5="label.action.confirm.community.before.leave";
if(this.community.groupSupportEnabled){
_5="label.action.confirm.community.before.leave.groupEnabled";
}
var _6=new lconn.communities.bizCard.dialogs.leaveConfirm({"dlgContent":this.messages[_5],"callback":this.CommunityLeave});
_6.show();
},moveCommunity:function(_7){
if(lconn.core.config.services.communities){
net.jazz.ajax.xdloader.batch_load_async(["lconn.comm.controls.dialog.MoveSubCommunity","lconn.comm.controls.dialog.MoveCommunity","lconn.comm.controls.data.CommunityItem"],function(){
dojo.mixin(lconn.communities.bizCard.core,{communityMoveCallback:function(_8,_9,_a){
if(_a.status==lconn.comm.controls.data.CommunityItem.errorCode.SUCCESS){
if(_9==lconn.comm.controls.dialog.MoveSubCommunity.moveType.NAMES_NEED_CHECK){
location.href=_8+"&successMessage=move.success";
}else{
location.href=_8+"&successMessage=move.success.toTopLevel";
}
}else{
location.href=_8+"&errorMessage=move.error.generic";
}
},moveCommunity_internal:function(_b){
if(_b.subcommunities.length!=0){
var _c=this.messages["move.error.hasSubs.alert.body"];
var _d=this.messages["move.error.hasSubs.alert.title"];
var _e=new lconn.core.DialogUtil.alert(_d,"<span>"+_c+"</span>",null);
}else{
var _f=new lconn.comm.controls.data.CommunityItem(_b.uuid);
var _10=null;
var _11=lconn.core.url.getServiceUrl(lconn.core.config.services.communities)+"/service/html/communityoverview?communityUuid="+_f.getId();
var cb=dojo.hitch(this,"communityMoveCallback",_11);
var _12=_f.isInternal();
var _13=_f.getOrgId();
var _14={CommunityItemToMove:_f,internalOnly:_12,orgid:_13,isSuperAdmin:_b.isSuperAdmin,callback:cb};
var _15=_f.getParentUuid();
if(_15!=null){
_14=dojo.mixin(_14,{skipId:_15});
_10=new lconn.comm.controls.dialog.MoveSubCommunity(_14);
}else{
_14=dojo.mixin(_14,{skipId:_b.uuid});
_10=new lconn.comm.controls.dialog.MoveCommunity(_14);
}
_10.show();
}
}});
lconn.communities.bizCard.core.moveCommunity_internal(_7);
});
}else{
console.error("Community Move code not loaded - Community App not deployed.");
}
}});
}


;if(!dojo._hasResource["lconn.communities.bizCard.bizCardUI_internal"]){
dojo._hasResource["lconn.communities.bizCard.bizCardUI_internal"]=true;
dojo.provide("lconn.communities.bizCard.bizCardUI_internal");




}


;if(!dojo._hasResource["lconn.communities.bizCard.bizCard_internal"]){
dojo._hasResource["lconn.communities.bizCard.bizCard_internal"]=true;
dojo.provide("lconn.communities.bizCard.bizCard_internal");




}


;if(!dojo._hasResource["lconn.core.people"]){
dojo._hasResource["lconn.core.people"]=true;
dojo.provide("lconn.core.people");
}


;if(!dojo._hasResource["lotuslive.widgets.awareness"]){
dojo._hasResource["lotuslive.widgets.awareness"]=true;
dojo.provide("lotuslive.widgets.awareness");
SemTagSvc.awareness={MAX_TIMEOUT:50,loadResources:function(_1){
var _2=["/stbaseapi/latest/baseComps.js?lang="+_1.locale];
var _3=["/stwebclient/latest/livenameLight.js","/stwebclient/latest/apps/lotuslive/lotuslive.js"];
var _4=["/stwebclient/latest/dojo.blue/sametime/themes/WebClientAllNoTundra.css"];
var _5=document.getElementsByTagName("head")[0];
for(var i=0;i<_2.length;i++){
SemTagSvc.awareness.loadScript(stproxyConfig.server+_2[i]);
}
for(var i=0;i<_4.length;i++){
var _6=document.createElement("link");
_6.type="text/css";
_6.rel="stylesheet";
_6.href=stproxyConfig.server+_4[i];
_5.appendChild(_6);
}
for(var i=0;i<_3.length;i++){
SemTagSvc.awareness.loadScriptDelayed(stproxyConfig.server+_3[i]);
}
},postLogin:function(_7){
SemTagSvc.awareness.log("SemTagSvc.awareness.postLogin");
stproxy.addOnLoad(function(){
stproxy.uiControl.addOnLoad(function(){
SemTagSvc.awareness.log("******************************* stproxy.uiControl.addOnLoad");
var _8=(typeof (SemTagMenu)!="undefined"?SemTagMenu:LCSemTagMenu);
_8.awarenessCtrl=new SemTagAwareness();
_8.awarenessCtrl.open(SemTagPerson.currentPerson,"javlinAwarenessIcon","javlinAwarenessStatusMsg");
});
});
return true;
},handleError:function(_9,_a){
SemTagSvc.awareness.log("SemTagSvc.awareness.handleError: "+_9+"-"+_a);
},loadScript:function(_b){
var _c=document.createElement("script");
_c.type="text/javascript";
_c.src=_b;
document.getElementsByTagName("head")[0].appendChild(_c);
},loadScriptDelayed:function(_d,_e){
var _e=(!_e?0:_e);
if((typeof (stproxy)=="undefined"&&_e<SemTagSvc.awareness.MAX_TIMEOUT)||(!dijit._Widget||!dijit._Widget.prototype)){
console.log("Waiting... "+_d);
window.setTimeout(function(){
SemTagSvc.awareness.loadScriptDelayed(_d,_e+1);
},1000);
}else{
if(_e<SemTagSvc.awareness.MAX_TIMEOUT){
console.log("Loading... "+_d);
SemTagSvc.awareness.loadScript(_d);
}
}
},log:function(_f){
if(typeof (SemTagUtil)!="undefined"){
if(SemTagSvc.trace){
SemTagUtil.log(_f);
}
}else{
console.log(_f);
}
}};
function SemTagAwareness(){
this.connection=null;
this.chatNodeConnection=null;
this.livename=null;
this.statusMessage=null;
this.oDisabledMenu={"dnd":stproxy.awareness.DND,"dndMobile":stproxy.awareness.DND_MOBILE,"offline":stproxy.awareness.OFFLINE};
this.open=function(_10,_11,_12){
if(!_10.email.internet){
return;
}
this.oBizData={uid:_10.uid,email:_10.email.internet,iconId:_11,statusId:_12};
this.livename=new sametime.LiveName({"userId":_10.email.internet,"hideDisplayName":true,"disableRightClick":true,"statusMessageNodes":[dojo.byId(_12)]});
if(this.livename.model){
SemTagSvc.awareness.log("SemTagAwareness.open:  "+_10.email.internet+" , status - "+this.livename.model.status);
this.connection=dojo.connect(this.livename.model,"onUpdate",dojo.hitch(this,this.update,false));
this.update();
}else{
SemTagSvc.awareness.log("SemTagAwareness.open: this.livename.model is null ");
}
};
this.update=function(_13){
var _14=false;
var _15=dojo.byId("javlinActionsExpanded");
if(_15){
_14=dojo.getAttr(_15,"aria-expanded");
}
if(this.livename&&this.livename.model&&this.livename.model.status!=stproxy.awareness.UNKNOWN){
SemTagSvc.awareness.log("SemTagAwareness.update - status: "+this.livename.model.status);
this.chatNodeConnection=null;
var _16=dojo.byId(this.oBizData.iconId);
if(!_13){
_16.style.display="";
_16.appendChild(this.livename.domNode);
dojo.byId(this.oBizData.statusId+"Container").style.display="";
}
var _17=false;
for(var s in this.oDisabledMenu){
if(this.oDisabledMenu[s]==this.livename.model.status){
_17=true;
break;
}
}
if((typeof (SemTagPerson.externalAction)!="undefined")&&(SemTagPerson.externalAction!=null)){
var _18=dojo.byId(SemTagPerson.externalAction);
if(_18){
if(!_17){
if(!this.chatNodeConnection){
this.chatNodeConnection=dojo.connect(_18,"onclick",function(e){
var _19=(typeof (SemTagMenu)!="undefined"?SemTagMenu:LCSemTagMenu);
stproxy.openChat(_19.awarenessCtrl.livename.model.id);
dojo.stopEvent(e);
});
_18.removeAttribute("disabled");
dojo.removeClass(_18,"lotusBtnDisabled");
}
}else{
_18.setAttribute("disabled","disabled");
dojo.addClass(_18,"lotusBtnDisabled");
}
}
}else{
_13=(_14=="true"?true:_13);
var _1a="javlinFooterActionChat"+(_13?"-expand":"");
var _18=dojo.byId(_1a);
if(_18){
if(!_17){
if(!this.chatNodeConnection){
this.chatNodeConnection=dojo.connect(_18,"onclick",function(e){
var _1b=(typeof (SemTagMenu)!="undefined"?SemTagMenu:LCSemTagMenu);
stproxy.openChat(_1b.awarenessCtrl.livename.model.id);
dojo.stopEvent(e);
});
dojo.removeClass(_18);
_18.setAttribute("aria-disabled","false");
}
}else{
dojo.addClass(_18,"disabledLink");
_18.setAttribute("aria-disabled","true");
}
}
}
}else{
SemTagSvc.awareness.log("SemTagAwareness.update: this.livename.model is null or this.livename.model.status is UNKNOWN");
}
};
this.close=function(){
if(this.chatNodeConnection){
dojo.disconnect(this.chatNodeConnection);
}
dojo.disconnect(this.connection);
if(this.livename){
this.livename.destroy();
}
};
};
}

dojo.provide("lotuslive.widgets.nls.LotusLiveBizCard")._built=true;
dojo.provide("lotuslive.widgets.nls.LotusLiveBizCard.en_us");
lotuslive.widgets.nls.LotusLiveBizCard.en_us={"footerActions":"Actions","conf_invite_subj":"Please join my meeting","send_email":"Send E-mail","skype_call":"Skype Call","a11y_photo":"photo","a11y_ariaLabelNewWindow":"(This link opens a new window)","footerMoreActions":"More Actions","view_person":"Profile","hover_text":"Business card for @@@1@@@","create_activity":"Start an Activity","start_chat":"Chat","a11y_hover":"more information","conference":"Invite to a Meeting","conf_invite_body":"Hello, please join my web conference at ","shared_files":"Files","add_to_buddylist":"Add to Buddy List"};

;if(!dojo._hasResource["lotuslive.widgets.LotusLiveBizCard"]){
dojo._hasResource["lotuslive.widgets.LotusLiveBizCard"]=true;
dojo.provide("lotuslive.widgets.LotusLiveBizCard");






dojo.requireLocalization("lotuslive.widgets","LotusLiveBizCard");
lotuslive.widgets.LotusLiveBizCard={services:[],initited:false,bundle:null,hideDelay:2000,timeouts:new Array(),cardWidth:430,cardHeight:200,getTimeout:10000,profileUrl:"/contacts/profiles/view/@@@UID@@@",servletUrl:"/contacts/javlin/get?@@@QUERY@@@",noPhotoUrl:"/contacts/profiles/photo/@@@UID@@@/1",personMenuCompactSeparator:"&ensp;<span style='color: #aaa;'>|</span>",personMenuActivityIdParam:"ll_user_id=@@@ENC_UID@@@",personMenuActivityNameParam:"ll_user_name=@@@ENC_FN@@@",personMenuActivityEmailParam:"ll_email=@@@ENC_INTERNET@@@",personMenuActivityParamSeparator:"%2C",keyboardHandler:null,isShowing:false,isInOrgProfile:function(){
return (gllConnectionsData.appName=="profiles"&&gllConnectionsData.srvUrls.ic_profiles_view);
},init:function(){
if(this.initited==false){
this.bundle=dojo.i18n.getLocalization("lotuslive.widgets","LotusLiveBizCard");
this.oData=gllConnectionsData;
if(this.isInOrgProfile()){
this.profileUrl=gllConnectionsData.srvUrls.ic_profiles_view;
}
this.oData.locale=dojo.locale;
this.oData.entitlements.imenabled=this.oData.entitlements.imenabled&&!(dojo.isIE<=6);
if(this.oData.entitlements.imenabled){
if(this.oData.disableSTWidget){
SemTagSvc.awareness.loadResources(this.oData);
}
}
this.initited=true;
}
},getIdMethod:function(_1){
return (_1.email&&_1.email.internet)?_1.email.internet:null;
},convMethod:function(_2){
return _2;
},processTag:function(_3){
try{
if(!this.initited){
lconn.core.bizCard.bizCardUtils.init();
LCSemTagMenu.init();
this.init();
}
this.processHcard(_3);
}
catch(e){
console.log(e);
}
},processHcard:function(_4){
setTimeout(dojo.hitch(this,"_processHcard",_4),0);
},_processHcard:function(_5){
if(lconn.core.bizCard.bizCardUtils.isDebug){
console.log("Processing at lotuslive.widgets.LotusLiveBizCard.processHcard for "+(dojo.isIE?_5.innerText:_5.textContent));
}
var _6="";
var _7=dojo.query(".x-lconn-userid",_5);
if(_7&&_7[0]){
var _8=_7.length;
var _9=_7[0];
_6=_9.innerHTML;
}else{
var _a=dojo.query(".x-lconn-email",_5);
if(_a&&_a[0]){
var _b=_a.length;
var _c=_a[0];
_6=_c.innerHTML;
}
}
var _d=(dojo.hasClass(_5,"fn")?_5:null)||dojo.query(".fn",_5)[0];
if(_d){
var _e=_d.innerHTML;
var _f=_d.childNodes;
if(_f.length>0){
for(var i=0;i<_f.length;i++){
if(_f[i].nodeType==3){
_e=_f[i].data;
break;
}
}
}
var _f=_d.childNodes;
if(_f.length>0&&_f[0].nodeName.toLowerCase()=="img"){
_e=_f[0].getAttribute("alt")||_f[0].getAttribute("title");
}
if(_6&&_6.length>0){
var _10="";
if(this.isInOrgProfile()){
var _10=this.profileUrl.replace(/{id}/,_6).replace(/{lang}/,this.oData.locale);
}else{
var _10=this.profileUrl.replace(/@@@UID@@@/,_6);
}
if((_d.tagName.toLowerCase()!="img")&&(_5.getAttribute("type")!="PersonMentionsNode")&&!_d.getAttribute("onclick")){
if(dojo.attr(_d,"target")!="_blank"&&_d.ownerDocument.body.className.toLowerCase().search(/(^| )cke_editable( |$)/)<0){
dojo.connect(_d,"onclick",function(){
window.location=_10;
});
}
_d.href=_10;
}
var _11=false;
var _12=_5.parentNode;
if(_12&&_12.className=="namelink"){
_12.href=_10;
_11=true;
}
}
var _13=document.createElement("a");
_13.className="menu_drop_icon";
_13.setAttribute("href","javascript:void(0);");
_13.setAttribute("role","button");
var _14=this.bundle["hover_text"];
_e=(_e.indexOf("@")==0)?_e.replace("@",""):_e;
_14=_14.replace("@@@1@@@",_e);
_13.title=dojo.trim(_14);
var _15=document.createElement("span");
_15.className="lotusAltText";
_15.innerHTML="&#x25bc;";
_13.appendChild(_15);
dojo.connect(_13,"onclick",function(_16){
lotuslive.widgets.LotusLiveBizCard.displayLotusLiveJavlinCard(_13,_d,_6,_e);
dojo.stopEvent(_16);
});
dojo.connect(_13,"onfocus",function(_17){
LCSemTagMenu.a11yMode=true;
LCSemTagMenu.originalActiveEl=_17.target;
});
var _18=dojo.query("a.menu_drop_icon",_11?_12.parentNode:_5)[0];
if(_18){
_18.parentNode.removeChild(_18);
}
if(_11){
var _19=_12.parentNode;
_19.appendChild(_13);
}else{
var _1a=_d.nextSibling;
if(!_1a){
_5.appendChild(_13);
}else{
if(_1a.className!="menu_drop_icon"){
_5.insertBefore(_13,_1a);
}
}
}
_d.title=dojo.trim(_d.title);
}
},displayLotusLiveJavlinCard:function(_1b,_1c,_1d,_1e){
console.log("Entering displayLotusLiveJavlinCard");
var url=this.servletUrl.replace(/@@@QUERY@@@/,"uid="+_1d)+"&preventCache="+new Date().getTime();
var req=new XMLHttpRequest();
req.onreadystatechange=function(){
if(req.readyState==4&&req.status==200){
if(typeof (SemTagPerson)=="undefined"){
SemTagPerson={};
}
var x=req.responseText.match(/<body[^>]*>((.|[\n\r])*)<\/body>/im);
var _1f=eval(x[1]);
lotuslive.widgets.LotusLiveBizCard.displayLotusLiveJavlinCardFromJson(true,_1f,_1b,_1c,_1d,_1e);
}
};
req.open("GET",url,true);
req.setRequestHeader("CSRF_TOKEN",dojo.cookie("token"));
req.send();
console.log("Exiting displayLotusLiveJavlinCard");
},displayLotusLiveJavlinCardFromJson:function(_20,_21,_22,_23,_24,_25){
console.log("Entering displayLotusLiveJavlinCardFromJson");
if(_20){
var _26=(typeof (SemTagSvcConfig)!="undefined"&&SemTagSvcConfig.isBidiRTL);
var dir=(_26)?"rtl":"ltr";
var _27=(_26)?"right":"left";
var _28=(_26)?"left":"right";
var _29=[],n=0;
_29[n++]="<div class=\"personMenu\">"+"<div id=\"A11YBlank\" tabindex=\"0\" class=\"a11y\" >&nbsp;</div>"+"<div class=\"semtag_header\"><ul class=\"topActionHolder\">";
var uid;
if(_21.X.uid){
uid=_21.X.uid;
}else{
uid=_24;
}
if(_21.X.profileUrl){
_29[n++]="<li class=\"topAction\"><a href=\""+_21.X.profileUrl+"\" target=\"_top\">"+this.bundle["view_person"]+"</a></li>";
}
_29[n++]="<li class=\"topAction\"><a href=\"/files/app#/person/"+uid+"\" target=\"_top\">"+this.bundle["shared_files"]+"</a></li>"+"<li class=\"topAction topActionClose\"><a href=\"javascript:void(0);\" aria-label=\"Close\" title=\"Close\" role=\"button\">X</a></li></ul>"+"<div style=\"clear: both;\"></div>"+"<span class=\"photoCard\" style=\"float: "+_27+";\"><img src=\""+(_21.photo?_21.photo:this.noPhotoUrl.replace(/@@@UID@@@/,uid))+"\" alt=\"\"></span>"+"<div class=\"businessCard\" style=\"float: "+_28+";\"><ul dir=\""+dir+"\">";
var _2a;
if(_21.fn){
_2a=this.sanitize(_21.fn);
}else{
_2a=this.sanitize(_25);
}
if(typeof _21.X!="undefined"&&!_21.X.uid){
_2a="<span class='lotusInactive'>"+_2a+"</span>";
}
_29[n++]="<li class='cardName lotusBreakWord'><span id='javlinAwarenessIcon' style='display:none;'></span>"+_2a+"</li>";
if(_21.title){
_29[n++]="<li class='lotusBreakWord'>"+this.sanitize(_21.title)+"</li>";
}
var _2b=false;
if(_21.org&&_21.org.name){
if(_21.X.orgid){
_2b="<a href=\"/contacts/orgprofiles/partnerPage/"+_21.X.orgid+"\" target=\"_top\">"+this.sanitize(_21.org.name)+"</a>";
}else{
_2b=this.sanitize(_21.org.name);
}
}
if(_2b){
_29[n++]="<li class='lotusBreakWord'>"+_2b+"</li>";
}
if(_21.X&&_21.X.address){
_29[n++]="<li class='lotusBreakWord'>"+this.sanitize(_21.X.address).replace(/(\n|\r\n)/g,"<br/>")+"</li>";
}
_29[n++]="<li class='spacer'>&nbsp;</li>";
var _2c=false;
if(_21.email&&_21.email.internet){
_2c=_21.email.internet;
}
if(_2c){
_29[n++]="<li class='lotusBreakWord'><a href=\"mailto:"+_2c+"\" target=\"_top\">"+_2c+"</a></li>";
}
if(_21.tel&&_21.tel.voice){
_29[n++]="<li class='phone'>"+this.sanitize(_21.tel.voice)+"</li>";
}
if(_21.isaguest||_21.isInactive){
_29[n++]="<li><div class=\"guestWarning\">"+(_21.isaguest?_21.isaguest:"")+(_21.isInactive?_21.isInactive:"")+"</div></li>";
}
if(this.oData.entitlements.imenabled&&_21.imEntitled){
_29[n++]="<li><div id=\"javlinAwarenessStatusMsgContainer\" class=\"lotusComment\" style=\"display:none;\"><div class=\"lotusCommentHeader\">&nbsp;</div>"+"<div class=\"lotusCommentBody\"><div id=\"javlinAwarenessStatusMsg\"></div></div></div></li>";
}
if(this.oData.entitlements.meeting&&_21.bh_meetings){
var _2d="";
var _2e=function(_2f){
_2d=_2f;
};
var _30=function(_31){
console.log("in xhrErrorMtgId: "+_31);
};
var _32=this.oData.srvUrls.meeting+"/getAccessCode";
dojo.xhrGet({url:_32,sync:true,load:_2e,error:_30});
}
_29[n++]="</ul></div></div><div style=\"clear: both; border-top: 1px solid rgb(221, 221, 221);\">";
var _33=n,_34=true;
_29[n++]="<div id=\"javlinActionsCompact\" class=\"personMenuActionsCompact\" style=\"padding: 5px;\" dir=\""+dir+"\">";
var _35=this.bundle["footerActions"];
if(this.oData.entitlements.imenabled&&_21.imEntitled){
_29[n++]="<a id=\"javlinFooterActionChat\" role=\"button\" class=\"disabledLink\" aria-disabled=\"true\" aria-label=\""+this.bundle["start_chat"]+"\" href=\"javascript:void(0);\">"+this.bundle["start_chat"]+"</a>";
if((typeof gllConnectionsData!=="undefined"&&!gllConnectionsData.isVersePreview)||(typeof gllConnectionsData=="undefined")){
_29[n++]=this.personMenuCompactSeparator;
}
_35=this.bundle["footerMoreActions"];
_34=false;
}
var _36=(typeof gllConnectionsData!=="undefined"&&gllConnectionsData.isVersePreview)?"visibility:hidden;":"visibility:visible;";
_29[n++]="&ensp;<a target=\"_top\" id=\"javlinActionMore\" href=\"javascript:;\" role=\"button\" aria-haspopup=\"true\" aria-controls=\"javlinActionsExpanded\" style=\""+_36+"\">"+_35+"&ensp;<span class=\"lotusSprite lotusArrow lotusDropDownSprite\" id=\"javlinActionMore-dropArrow\"></span><span class=\"lotusAltText\">&#x25bc;</span></a>";
_29[n++]="</div></div><table class=\"personMenuActions\" dir=\""+dir+"\" id=\"javlinActionsExpanded\" style=\"display: none;\" role=\"toolbar\" aria-label=\"Person Actions menu\" aria-expanded=\"false\"><tbody>";
if(_2c){
if(this.oData.entitlements.imenabled&&_21.imEntitled){
_29[n++]="<tr><td><a id=\"javlinFooterActionChat-expand\" class=\"disabledLink\" aria-disabled=\"true\" aria-label=\""+this.bundle["start_chat"]+"\" href=\"javascript:void(0);\">"+this.bundle["start_chat"]+"</a></td></tr>";
}
if(this.oData.entitlements.meeting&&_21.bh_meetings&&_2d&&_2d.length>0){
_29[n++]="<tr><td><a href=\"mailto:"+encodeURIComponent(_2c)+"?body="+encodeURIComponent(this.bundle["conf_invite_body"])+this.oData.srvUrls.meeting+"/join%3Fid="+_2d+"%0A&amp;subject="+encodeURIComponent(this.bundle["conf_invite_subj"])+"\" target=\"_top\""+" aria-label=\""+this.bundle["conference"]+this.bundle["a11y_ariaLabelNewWindow"]+"\">"+this.bundle["conference"]+"</a></td></tr>";
_34=false;
}
if(this.oData.entitlements.bh_activities&&_21.bh_activities){
_29[n++]="<tr><td><a href=\"/activities/service/html/createActivity#"+this.updateCreateActivity(uid,_2a,_2c)+"\" target=\"_blank\""+" aria-label=\""+this.bundle["create_activity"]+this.bundle["a11y_ariaLabelNewWindow"]+"\">"+this.bundle["create_activity"]+"</a></td></tr>";
_34=false;
}
}
_29[n++]="</tbody></table><div id=\"A11YLast\" tabindex=\"0\" class=\"a11y\" >&nbsp;</div></div>";
if(_34){
_29.splice(_33,_29.length-_33);
_29[_33]="</div><div id=\"A11YLast\" tabindex=\"0\" class=\"a11y\" >&nbsp;</div></div>";
}
personCard=_29.join("");
this.isShowing=true;
}
this.adjustPositionAndDisplayJavlinCard(_22,_24,personCard,_26);
if(!_34){
dojo.connect(dojo.byId("javlinActionMore"),"onclick",dojo.hitch(this,this.showAllActions));
}
dojo.connect(dojo.byId("A11YBlank"),"onfocus",dojo.hitch(this,this.focusA11Y));
dojo.connect(dojo.byId("A11YLast"),"onfocus",dojo.hitch(this,this.focusA11Y));
if(this.oData.entitlements.imenabled){
SemTagPerson={currentPerson:_21};
if(stproxy&&stproxy.isLoggedIn){
SemTagSvc.awareness.log("Logging in.....");
stproxy.login.loginByToken(_21.caller,null,null,SemTagSvc.awareness.postLogin,SemTagSvc.awareness.handleError);
}else{
SemTagSvc.awareness.postLogin();
}
}
console.log("Exiting displayLotusLiveJavlinCardFromJson");
},updateCreateActivity:function(uid,_37,_38){
var _39="";
if(uid){
_39+=this.personMenuActivityIdParam;
var _3a=encodeURIComponent(uid);
_39=_39.replace(/@@@ENC_UID@@@/,_3a);
_39+=this.personMenuActivityParamSeparator;
}
if(_37){
_39+=this.personMenuActivityNameParam;
var _3b=encodeURIComponent(_37);
_39=_39.replace(/@@@ENC_FN@@@/,_3b);
_39+=this.personMenuActivityParamSeparator;
}
_39+=this.personMenuActivityEmailParam;
var _3c=encodeURIComponent(_38);
_39=_39.replace(/@@@ENC_INTERNET@@@/,_3c);
return _39;
},adjustPositionAndDisplayJavlinCard:function(_3d,_3e,_3f,_40){
var _41=12;
var _42=12;
var _43=this.findPosition(_3d,true);
var _44=parseInt(_43.x);
var top=parseInt(_43.y)-_42;
var _45,_46,d=document;
if(typeof window.innerWidth!="undefined"){
_45=window.innerWidth;
_46=window.innerHeight;
}else{
if(d.documentElement&&typeof d.documentElement.clientWidth!="undefined"&&d.documentElement.clientWidth!=0){
_45=d.documentElement.clientWidth;
_46=d.documentElement.clientHeight;
}else{
if(d.body&&typeof d.body.clientWidth!="undefined"){
_45=d.body.clientWidth;
_46=d.body.clientHeight;
}
}
}
var _47=(document.body.scrollLeft>document.documentElement.scrollLeft)?document.body.scrollLeft:document.documentElement.scrollLeft;
if((_44+lotuslive.widgets.LotusLiveBizCard.cardWidth)>(_45+_47)){
var _48=(_44+lotuslive.widgets.LotusLiveBizCard.cardWidth)-_45-_47;
_44-=_48;
}
var _49=(document.body.scrollTop>document.documentElement.scrollTop)?document.body.scrollTop:document.documentElement.scrollTop;
if((top+lotuslive.widgets.LotusLiveBizCard.cardHeight)>(_46+_49)){
var _48=(top+lotuslive.widgets.LotusLiveBizCard.cardHeight)-_46-_49;
top-=_48;
}
this.displayJavlinCard(_3e,_3f,_44,top);
},displayJavlinCard:function(_4a,_4b,_4c,top){
var _4d=document.getElementById("javlinDiv");
if(_4d!=null){
_4d.parentNode.removeChild(_4d);
lotuslive.widgets.LotusLiveBizCard.clearTimeouts();
}
var _4e="javlinDiv";
var _4f=document.createElement("div");
_4f.id=_4e;
_4f.setAttribute("role","dialog");
_4f.setAttribute("aria-label","Business Card");
_4f.setAttribute("aria-labelledby",_4e);
_4f.innerHTML=_4b;
dojo.connect(_4f,"onmouseout",dojo.hitch(lotuslive.widgets.LotusLiveBizCard,"mouseout",_4e));
dojo.connect(_4f,"onmouseover",dojo.hitch(lotuslive.widgets.LotusLiveBizCard,"mouseover"));
_4f.style.position="absolute";
_4f.style.left=_4c+"px";
_4f.style.top=top+"px";
_4f.style.display="block";
_4f.style.zIndex="1001";
document.body.appendChild(_4f);
var _50=_4f.getElementsByTagName("li");
if(0<_50.length){
_50[0].firstChild.focus();
}
if(!LCSemTagMenu.a11yMode){
lotuslive.widgets.LotusLiveBizCard.startHideTimer(_4e,lotuslive.widgets.LotusLiveBizCard.hideDelay);
}else{
if(!this.keyboardHandler){
this.keyboardHandler=dojo.connect(dojo.doc.body,"onkeydown",dojo.hitch(lotuslive.widgets.LotusLiveBizCard,"a11y"));
}
}
dojo.query(".topAction > a").connect("onclick",dojo.hitch(lotuslive.widgets.LotusLiveBizCard,"removeElementById",_4e));
var _51=dojo.query("#javlinActionsExpanded a");
if(_51.length>0){
_51.forEach(function(_52){
if(!dojo.hasClass(_52,"disabledLink")||!dojo.hasAttr(_52,"aria-disabled","true")){
dojo.connect(_52,"onclick",dojo.hitch(lotuslive.widgets.LotusLiveBizCard,"removeElementById",_4e));
}
});
}
lotuslive.widgets.LotusLiveBizCard.autoHideJavlinCard(_4e);
},showAllActions:function(_53){
if(this.oData.entitlements.imenabled&&LCSemTagMenu.awarenessCtrl){
LCSemTagMenu.awarenessCtrl.update(true);
}
var _54=dojo.byId("javlinActionsExpanded");
if(_54){
_54.style.display="";
dojo.attr(_54,"aria-expanded","true");
}
var _55=dojo.byId("javlinActionsCompact");
if(_55){
_55.style.display="none";
}
if(LCSemTagMenu.a11yMode){
var _56=_54.getElementsByTagName("a");
if(0<_56.length){
_56[0].focus();
}
}
dojo.stopEvent(_53);
},findPosition:function(_57,_58){
if(window.LCSemTagMenu&&window.LCSemTagMenu.getPosition){
return window.LCSemTagMenu.getPosition(_57,_58);
}else{
console.log("Error getting position");
return {x:0,y:0,w:0,h:0};
}
},clearTimeouts:function(){
for(i=0;i<lotuslive.widgets.LotusLiveBizCard.timeouts.length;i++){
window.clearTimeout(lotuslive.widgets.LotusLiveBizCard.timeouts[i]);
}
},mouseout:function(_59){
menuElem=document.getElementById(_59);
lotuslive.widgets.LotusLiveBizCard.startHideTimer(_59,lotuslive.widgets.LotusLiveBizCard.hideDelay);
},autoHideJavlinCard:function(_5a){
lotuslive.widgets.LotusLiveBizCard.mouseout(_5a);
},startHideTimer:function(_5b,_5c){
var _5d=(typeof (_5c)=="number"?_5c:lotuslive.widgets.LotusLiveBizCard.hideDelay);
if(0<_5d){
lotuslive.widgets.LotusLiveBizCard.timeouts.push(window.setTimeout("lotuslive.widgets.LotusLiveBizCard.endHideTimer(\""+_5b+"\")",_5d));
}
},endHideTimer:function(_5e){
lotuslive.widgets.LotusLiveBizCard.removeElementById(_5e);
},mouseover:function(){
lotuslive.widgets.LotusLiveBizCard.clearTimeouts();
},getHtmlText:function(_5f){
if(!_5f){
return null;
}
var a=[];
for(var i=0;c=_5f.childNodes[i];i++){
if(c.nodeType==3){
a.push(c.nodeValue);
}
}
return a.length>0?a.join(""):null;
},removeElementById:function(_60){
var _61=document.getElementById(_60);
_61.parentNode.removeChild(_61);
this.isShowing=false;
if(LCSemTagMenu.awarenessCtrl){
console.debug("awareness cleanup");
LCSemTagMenu.awarenessCtrl.close();
}
if(this.keyboardHandler){
dojo.disconnect(this.keyboardHandler);
this.keyboardHandler=null;
}
},getHcardAttributeValue:function(_62,_63){
switch(_62){
case ("email"):
return this.getHcardTypedAttribute(_63,_62,"internet");
case ("tel"):
return this.getHcardTypedAttribute(_63,_62,"voice");
case ("adr"):
return this.getHcardTypedAttribute(_63,_62,"intl");
}
var _64=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",_63);
var _65=lconn.core.bizCard.bizCardUtils.getElementsByClassName(_62,_64,1);
if(_65.length>0&&_65[0].tagName.match(/^abbr$/i)){
return _65[0].getAttribute("title");
}
switch(_62){
case ("fn"):
var fn=lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_65[0]);
if(fn){
return fn;
}else{
return this.getHcardAttributeValue("n",_63);
}
break;
case ("n"):
if(_65.length>0){
var _66=_65[0];
var _67="";
var _68=["honorific-prefix","given-name","additional-name","family-name","honorific-suffix"];
for(var i=0;i<5;i++){
var n=lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(lconn.core.bizCard.bizCardUtils.getElementsByClassName(_68[i],_66,1)[0]);
if(n){
_67+=n+" ";
}
}
return _67;
}
return "";
break;
case ("photo"):
var _69=_65[0];
if(_69){
return _69.getAttribute("src");
}else{
return;
}
break;
case ("X-sametime-status"):
var _6a=_65[0];
if(!_6a){
return "";
}
var _6b=_6a.getAttribute("value");
if(_6b){
return _6b;
}else{
return lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_6a);
}
break;
case ("X-person-display-inline"):
if(_65.length>0){
return true;
}else{
return false;
}
case ("street-address"):
case ("post-office-box"):
case ("extended-address"):
case ("locality"):
case ("region"):
case ("postal-code"):
case ("country-name"):
case ("title"):
case ("role"):
case ("org"):
default:
return lconn.core.bizCard.bizCardUtils.getSinglePropertyValue(_65[0]);
break;
}
},getHcardTypedAttribute:function(_6c,_6d,_6e){
var _6f=new Object();
var _70=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",_6c);
var _71=lconn.core.bizCard.bizCardUtils.getElementsByClassName(_6d,_70);
for(var i=0;i<_71.length;i++){
var _72=_71[i];
if(_6d=="email"&&_72.nodeName.toLowerCase()=="a"&&_72.href.match(/^mailto:/)){
var _73=_72.href.indexOf("?");
if(_73>-1){
_6f[_6e]=_72.href.slice(7,_73);
}else{
_6f[_6e]=_72.href.slice(7);
}
continue;
}
_6f=lconn.core.bizCard.bizCardUtils.getTypedValue(_72,_6e);
}
return _6f;
},getElementEmail:function(_74){
var _75;
var _76=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",_74);
if(_76){
_75=this.getHcardAttributeValue("email",_76);
_75=_75.internet;
}else{
if(_74.nodeName.toLowerCase()=="a"&&_74.href.match(/^mailto:/)){
_75=_74.href.replace(/^mailto:/,"");
}
}
return _75;
},getElementUserId:function(_77){
var _78="";
var _79=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",_77);
if(_79){
_78=this.getHcardAttributeValue("x-lconn-userid",_79);
}
return _78;
},getNameElement:function(_7a){
if(_7a.className!="vcard"){
_7a=lconn.core.bizCard.bizCardUtils.getParentByClassName("vcard",_7a);
}
var _7b=lconn.core.bizCard.bizCardUtils.getElementsByClassName("fn",_7a,1)[0];
if(!_7b){
_7b=lconn.core.bizCard.bizCardUtils.getElementsByClassName("n",_7a,1)[0];
}
return _7b;
},sanitize:function(str,_7c){
if(/&amp;/.test(str)){
str=str.replace(/&amp;/g,"&");
}
var _7d=(_7c)?document.createElement("pre"):document.createElement("span");
var _7e=document.createTextNode(str);
_7d.appendChild(_7e);
return _7d.innerHTML;
},a11y:function(_7f){
if(_7f.keyCode==27){
if(this.isShowing){
lotuslive.widgets.LotusLiveBizCard.endHideTimer("javlinDiv");
if(LCSemTagMenu.originalActiveEl){
LCSemTagMenu.originalActiveEl.focus();
}
}
}else{
if(_7f.keyCode==40){
var _80=_7f.target;
if(_80&&_80.getAttribute("aria-haspopup")){
lotuslive.widgets.LotusLiveBizCard.showAllActions(_7f);
}
}
}
},focusA11Y:function(ev){
var _81=ev.target;
if(_81.id=="A11YLast"){
var tag=document.getElementById("javlinDiv");
if(LCSemTagMenu.a11yMode){
var _82=tag.getElementsByTagName("li");
if(0<_82.length){
_82[0].firstChild.focus();
}
LCSemTagMenu.stopEvent(ev);
}
}else{
if(_81.id=="A11YBlank"){
var _83=document.getElementById("javlinActionsExpanded");
if(_83&&_83.style.display=="none"){
document.getElementById("javlinActionMore").focus();
}else{
var _82=_83.getElementsByTagName("a");
if(0<_82.length){
_82[_82.length-1].focus();
}
LCSemTagMenu.stopEvent(ev);
}
}
}
}};
window.livetextCfg.push({"id":"hcard","match":".vcard","processEnclosedTags":false,"tagHandler":lotuslive.widgets.LotusLiveBizCard,"loaded":true,"baseURL":""});
}


;define("ic-core/util/connectionsUrlUtil",["dojo/io-query","dojo/string","dojo/_base/array","dojo/_base/url"],function(_1,_2,_3,_4){
"use strict";
var _5="/wikis/home(|\\?[^/#]*#!)/wiki/([^/?#]+)(/page/[^/?#]+)?",_6="/blogs/([^/?#]+)(|/entry/[^/?#]+)",_7="/forums/html/(topic|forum)\\?([^#]+)",_8="/service/html/";
return {isConnectionsFileUrl:function(_9){
return !!this.getFileId(_9);
},shouldOpenPreview:function(_a){
var _b=_c(_a);
if(_b){
var _d=["fullpageWidgetId","communityUuid","debug"];
var _e=["fullpageWidgetId","file"];
if(!_f(_b.parameters,_d)||!_f(_b.fragmentParameters,_e)){
return false;
}
return !!_b.fragmentParameters.file||false;
}
_b=_10(_a);
if(_b){
var _d=["debug"];
var _e=[];
if(!_f(_b.parameters,_d)||!_f(_b.fragmentParameters,_e)){
return false;
}
return !!(_b.type==="file"&&_b.id)||false;
}
return false;
},shouldOpenConnectionsPreview:function(url){
if(_11(url)){
return false;
}
var uri=new _4(url),_12;
if(uri.host!==window.location.host){
return false;
}
if(!this.isConnectionsFileUrl(url)){
return false;
}
_12=this.getFileId(url);
if(_12.indexOf("{")===0){
return false;
}
return true;
},isConnectionsFolderUrl:function(url){
return !!this.getFolderId(url);
},isCommunityWidgetUrl:function(url){
return !!_c(url);
},isFilesAppUrl:function(url){
return !!_10(url);
},getUrlType:function(url){
try{
var _13=decodeURIComponent(url);
}
catch(e){
console.error(e);
return "";
}
var _14="";
if(!!_13.match(new RegExp(_5))){
_14="wiki";
}else{
if(!!_13.match(new RegExp(_6))){
_14="blog";
}else{
if(!!_13.match(new RegExp("/communities"+_8+"community[^?]+\\?[^?#/]+"))){
_14="community";
}else{
if(!!_13.match(new RegExp("/activities"+_8+"mainpage(|[^#/]+)(|#[^?#/]+)"))){
_14="activity";
}else{
if(!!_13.match(new RegExp(_7))){
_14="forum";
}
}
}
}
}
return _14;
},getFileId:function(url){
var _15=_c(url);
if(_15){
return _15.fragmentParameters.file||null;
}
_15=_10(url);
if(_15){
return (_15.type==="file"&&_15.id)||null;
}
_15=_16(url);
if(_15){
return _15.id||null;
}
return null;
},getFolderId:function(url){
var _17=_c(url);
if(_17){
return _17.fragmentParameters.folder||null;
}
_17=_10(url);
if(_17){
return (_17.type==="folder"&&_17.id)||null;
}
return null;
},getDownloadFileUrl:function(url){
if(_11(url)){
return url;
}
var _18=this.getFileId(url);
if(_18){
var _19;
if(_1a(url)){
_19=url.substring(0,url.indexOf("/files/"));
}else{
_19=url.substring(0,url.indexOf("/communities/"));
}
return _2.substitute(_19+"/files/form/anonymous/api/document/${fileId}/media",{fileId:_18});
}else{
return "";
}
},getViewFileUrl:function(url){
},getViewFileJS:function(url){
}};
function _c(url){
try{
var _1b=decodeURIComponent(url);
}
catch(e){
console.error(e);
return null;
}
var _1c=_1b.match(new RegExp("/communities"+_8+"[^?]+\\?([^#]*)#(\\S+)"));
if(!_1c){
return null;
}
var _1d=_1.queryToObject(_1c[1]);
var _1e=_1.queryToObject(_1c[2]);
if(_1d.communityUuid&&(_1d.fullpageWidgetId||_1e.fullpageWidgetId)){
return {parameters:_1d,fragmentParameters:_1e};
}else{
return null;
}
};
function _10(url){
try{
var _1f=decodeURIComponent(url);
}
catch(e){
console.error(e);
return null;
}
var _20=_1f.match(new RegExp("/app(|#|\\?([^#/]*)#)/([^/]+)/([^?/#]*)(\\?([^?]*))?"));
if(!_20){
return null;
}
var _21,_22;
if(_20[1].indexOf("#")!==-1){
_21=_20[2];
_22=_20[6];
}else{
_21=_20[6];
_22=undefined;
}
var _23=_1.queryToObject(_21||"");
var _24=_1.queryToObject(_22||"");
var _25=_20[3];
var id=_20[4];
return {type:_25,id:id,parameters:_23,fragmentParameters:_24};
};
function _16(url){
try{
var _26=decodeURIComponent(url);
}
catch(e){
console.error(e);
return null;
}
var _27=_26.match(new RegExp("/form/(anonymous/)?api/(library/[^/]+/)?document/([^/]+)/media(/[^/#?]+/|/[^/#?]+|/|)(\\?|#|$)"));
if(!_27){
return null;
}
var id=_27[3];
return {id:id};
};
function _1a(url){
return !!_10(url);
};
function _11(url){
return !!_16(url);
};
function _f(_28,_29){
for(var _2a in _28){
if(_3.indexOf(_29,_2a)===-1){
return false;
}
}
return true;
};
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["lconn.share"]=true;

;if(!dojo._hasResource["lconn.share.util.DateFormat"]){
dojo._hasResource["lconn.share.util.DateFormat"]=true;
(function(){
dojo.provide("lconn.share.util.DateFormat");




var _1=lconn.core.globalization.BidiDateUtil;
dojo.declare("lconn.share.util.DateFormat",null,{MILLS_IN_DAY:86400000,_nls:dojo.getObject("lconn.share.util.DateFormat.prototype._nls"),constructor:function(_2,_3){
this.dt=_2||new Date();
if(_3){
for(var _4 in _3){
this[_4]=_3[_4];
}
}
this._transform=dojo.hitch(this,this.substitute);
},nls:function(){
if(!this._nls){
throw "Resource bundle must be set to lconn.share.util.DateFormat.prototype._nls prior to use";
}
return this._nls;
},substitute:function(_5,_6){
var _5=this[_6];
if(typeof _5=="function"){
_5=_5.apply(this,[]);
}
if(typeof _5=="undefined"||_5==null){
_5="${"+_6+"}";
}
return _5;
},toTimestamp:function(){
return this.format(this.nls().DATE.FULL);
},format:function(s){
return dojo.string.substitute(s,null,this._transform);
},formatByAge:function(_7){
_7=_7||this.nls().DATE.RELATIVE_TIME;
var _8=this.delta();
if(_8<7&&_8>=-1){
if(_8>=2){
return this.format(_7.DAY);
}else{
if(_8==1){
return this.format(_7.YESTERDAY);
}else{
if(_8==0){
return this.format(_7.TODAY);
}else{
if(_8==-1&&_7.TOMORROW){
return this.format(_7.TOMORROW);
}
}
}
}
}else{
if(new Date().getFullYear()==this.dt.getFullYear()){
return this.format(_7.MONTH);
}
}
return this.format(_7.YEAR);
},formatByAgeToHtml:function(_9,d){
var _a=this.formatByAge(_9);
var _b=d.createElement("SPAN");
_b.appendChild(d.createTextNode(_a?_a:this.dt.toString()));
_b.title=(_9&&_9.FULL)?this.format(_9.FULL):this.format(this.nls().DATE.RELATIVE_TIME.FULL);
return _b;
},delta:function(){
if(typeof this._delta!="undefined"){
return this._delta;
}
this._delta=lconn.share.util.DateFormat.delta(this.dt,new Date());
return this._delta;
},getDays:function(){
if(!this._days){
lconn.share.util.DateFormat.prototype._days=dojo.date.locale.getNames("days","wide");
}
return this._days;
},getDaysAbbr:function(){
if(!this._daysAbbr){
lconn.share.util.DateFormat.prototype._daysAbbr=dojo.date.locale.getNames("days","abbr");
}
return this._daysAbbr;
},getMonths:function(){
if(!this._months){
lconn.share.util.DateFormat.prototype._months=dojo.date.locale.getNames("months","abbr");
}
if(_1.isGregorian()){
return this._months;
}else{
return _1.getDateComponent("months","abbr");
}
},getMonthsWide:function(){
if(!this._monthsWide){
lconn.share.util.DateFormat.prototype._monthsWide=dojo.date.locale.getNames("months","wide");
}
if(_1.isGregorian()){
return this._monthsWide;
}else{
return _1.getDateComponent("months","wide");
}
},getMonthsShort:function(){
if(!this._monthsShort){
lconn.share.util.DateFormat.prototype._monthsShort=this.nls().DATE.MONTHS_ABBR;
}
if(_1.isGregorian()){
return this._monthsShort;
}else{
return _1.getDateComponent("months","abbr");
}
},Z:function(){
if(!this._Z){
var _c="-";
var _d=this.dt.getTimezoneOffset();
if(_d<0){
_d=Math.abs(_d);
_c="+";
}
var _e=Math.floor(_d/60);
_d%=60;
if(_e<10){
_e="0"+_e;
}
if(_d<10){
_d="0"+_d;
}
_c+=_e+""+_d;
this._Z=_c;
}
return this._Z;
},ZZZZ_REGEX:/\(([^\)]+)\)/,ZZZZ:function(){
if(!this._ZZ){
if(dojo.isIE){
var _f=this.dt.toString().split(" ");
this._ZZ=(_f.length>2)?_f[_f.length-2]:this.Z();
}else{
var r=this.ZZZZ_REGEX.exec(this.dt.toString());
this._ZZ=r?r[1]:this.Z();
}
}
return this._ZZ;
},YYYY:function(){
if(_1.isGregorian()){
return this.dt.getFullYear();
}else{
return _1.fromGregorian(this.dt).getFullYear();
}
},EEE:function(_10){
var day=this.dt.getDay();
if(_10>0){
day=(day+7-_10)%7;
}
return this.getDaysAbbr()[day];
},EEEE:function(_11){
var day=this.dt.getDay();
if(_11>0){
day=(day+7-_11)%7;
}
return this.getDays()[day];
},EEee:function(_12){
var _13=this.delta()+(_12?_12:0);
return (_13==0)?this.nls().DATE.TODAY_U:(_13==1)?this.nls().DATE.YESTERDAY_U:this.EEEE(_12);
},eeEE:function(_14){
var _15=this.delta()+(_14?_14:0);
return (_15==0)?this.nls().DATE.TODAY:(_15==1)?this.nls().DATE.YESTERDAY:this.EEEE(_14);
},MMMM:function(){
if(_1.isGregorian()){
return this.getMonthsWide()[this.dt.getMonth()];
}else{
return this.getMonthsWide()[_1.fromGregorian(this.dt).getMonth()];
}
},MMM:function(){
if(_1.isGregorian()){
return this.getMonths()[this.dt.getMonth()];
}else{
return this.getMonths()[_1.fromGregorian(this.dt).getMonth()];
}
},MM:function(){
if(_1.isGregorian()){
var i=this.dt.getMonth()+1;
}else{
var i=_1.fromGregorian(this.dt).getMonth()+1;
}
return (i>9)?i:("0"+i);
},Mmm:function(){
if(_1.isGregorian()){
return this.dt.getMonthsShort()[this.dt.getMonth()];
}else{
return this.getMonthsShort()[_1.fromGregorian(this.dt).getMonth()];
}
},d:function(){
if(_1.isGregorian()){
return this.dt.getDate();
}else{
return _1.fromGregorian(this.dt).getDate();
}
},dd:function(){
if(_1.isGregorian()){
var i=this.dt.getDate();
}else{
var i=_1.fromGregorian(this.dt).getDate();
}
return (i>9)?i:("0"+i);
},a:function(){
return this.dt.getHours()<12?this.nls().DATE.AM:this.nls().DATE.PM;
},HH:function(){
var i=this.dt.getHours();
return (i>9)?i:("0"+i);
},hh:function(){
var _16=this.dt.getHours();
if(_16>12){
_16-=12;
}else{
if(_16==0){
_16=12;
}
}
return (_16>9)?_16:("0"+_16);
},mm:function(){
var _17=this.dt.getMinutes();
return (_17<10)?"0"+_17:_17;
},ss:function(){
var _18=this.dt.getSeconds();
return (_18<10)?"0"+_18:_18;
},date:function(){
if(_1.isGregorian()){
return dojo.date.locale.format(this.dt,{selector:"date",formatLength:"short",locale:djConfig.locale});
}else{
return _1.formatBidiDate(this.dt,{selector:"date",formatLength:"short",locale:djConfig.locale});
}
},date_long:function(){
if(_1.isGregorian()){
return dojo.date.locale.format(this.dt,{selector:"date",formatLength:"long",locale:djConfig.locale});
}else{
return _1.formatBidiDate(this.dt,{selector:"date",formatLength:"long",locale:djConfig.locale});
}
},time:function(){
return dojo.date.locale.format(this.dt,{selector:"time",formatLength:"short",locale:djConfig.locale});
},time_long:function(){
return dojo.date.locale.format(this.dt,{selector:"time",formatLength:"long",locale:djConfig.locale});
}});
lconn.share.util.date={REPLACE:/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,MILLS_IN_DAY:86400000,toTimestamp:function(_19,nls){
return lconn.share.util.date.format(_19,nls.FULL,nls);
},formatByAge:function(_1a,_1b,nls){
var now=new Date();
var qud=lconn.share.util.date;
var _1c=qud.delta(_1a,now);
if(_1c<7&&_1c>=-1){
if(_1c>=2){
return qud.format(_1a,_1b.DAY,nls);
}else{
if(_1c==1){
return qud.format(_1a,_1b.YESTERDAY,nls);
}else{
if(_1c==0){
return qud.format(_1a,_1b.TODAY,nls);
}else{
if(_1c==-1&&_1b.TOMORROW){
return qud.format(_1a,_1b.TOMORROW,nls);
}
}
}
}
}else{
if(now.getFullYear()==_1a.getFullYear()){
return qud.format(_1a,_1b.MONTH,nls);
}
}
return qud.format(_1a,_1b.YEAR,nls);
},format:function(_1d,_1e,nls){
var qud=lconn.share.util.date;
var re=qud.REPLACE;
re.lastIndex=0;
var _1f=_1e.replace(re,function(_20,key,_21){
var f=qud[key];
var s=f?f(_1d,nls):"${"+key+"}";
return s;
});
return _1f;
},delta:function(_22,nls){
return lconn.share.util.DateFormat.delta(_22,new Date());
},getDays:function(){
var qud=lconn.share.util.date;
if(!qud._days){
qud._days=dojo.date.locale.getNames("days","wide");
}
return qud._days;
},getDaysAbbr:function(){
var qud=lconn.share.util.date;
if(!qud._daysAbbr){
qud._daysAbbr=dojo.date.locale.getNames("days","abbr");
}
return qud._daysAbbr;
},getMonths:function(){
var qud=lconn.share.util.date;
if(!qud._months){
qud._months=dojo.date.locale.getNames("months","abbr");
}
if(_1.isGregorian()){
return qud._months;
}else{
return _1.getDateComponent("months","abbr");
}
},getMonthsWide:function(){
var qud=lconn.share.util.date;
if(!qud._monthsWide){
qud._monthsWide=dojo.date.locale.getNames("months","wide");
}
if(_1.isGregorian()){
return qud._monthsWide;
}else{
return _1.getDateComponent("months","wide");
}
},Z:function(_23,nls){
var _24="-";
var _25=_23.getTimezoneOffset();
if(_25<0){
_25=Math.abs(_25);
_24="+";
}
var _26=Math.floor(_25/60);
_25%=60;
if(_26<10){
_26="0"+_26;
}
if(_25<10){
_25="0"+_25;
}
_24+=_26+""+_25;
return _24;
},ZZZZ_REGEX:/\(([^\)]+)\)/,ZZZZ:function(_27,nls){
var _28;
var qud=lconn.share.util.date;
if(dojo.isIE){
var _29=_27.toString().split(" ");
_28=(_29.length>2)?_29[_29.length-2]:qud.Z(_27,nls);
}else{
var re=qud.ZZZZ_REGEX;
re.lastIndex=0;
var r=re.exec(_27.toString());
_28=r?r[1]:qud.Z(_27,nls);
}
return _28;
},YYYY:function(_2a,nls){
if(_1.isGregorian()){
return _2a.getFullYear();
}else{
return _1.fromGregorian(_2a).getFullYear();
}
},EEE:function(_2b,nls,_2c){
var day=_2b.getDay();
if(_2c>0){
day=(day+7-_2c)%7;
}
return lconn.share.util.date.getDaysAbbr()[day];
},EEEE:function(_2d,nls,_2e){
var day=_2d.getDay();
if(_2e>0){
day=(day+7-_2e)%7;
}
return lconn.share.util.date.getDays()[day];
},EEee:function(_2f,nls,_30){
var _31=lconn.share.util.date.delta(_2f)+(_30?_30:0);
return (_31==0)?nls.TODAY_U:(_31==1)?nls.YESTERDAY_U:lconn.share.util.date.EEEE(_2f,nls,_30);
},eeEE:function(_32,nls,_33){
var _34=lconn.share.util.date.delta(_32)+(_33?_33:0);
return (_34==0)?nls.TODAY:(_34==1)?nls.YESTERDAY:lconn.share.util.date.EEEE(_32,nls,_33);
},MMMM:function(_35,nls){
if(_1.isGregorian()){
return lconn.share.util.date.getMonthsWide()[_35.getMonth()];
}else{
return lconn.share.util.date.getMonthsWide()[_1.fromGregorian(_35).getMonth()];
}
},MMM:function(_36,nls){
if(_1.isGregorian()){
return lconn.share.util.date.getMonths()[_36.getMonth()];
}else{
return lconn.share.util.date.getMonthsWide()[_1.fromGregorian(_36).getMonth()];
}
},MM:function(_37,nls){
if(_1.isGregorian()){
var i=_37.getMonth()+1;
}else{
var i=_1.fromGregorian(_37).getMonth()+1;
}
return (i>9)?i:("0"+i);
},Mmm:function(_38,nls){
if(_1.isGregorian()){
return nls.MONTHS_ABBR[_38.getMonth()];
}else{
return lconn.share.util.date.getMonths()[_1.fromGregorian(_38).getMonth()];
}
},d:function(_39,nls){
if(_1.isGregorian()){
return _39.getDate();
}else{
return _1.fromGregorian(_39).getDate();
}
},dd:function(_3a,nls){
if(_1.isGregorian()){
var i=_3a.getDate();
}else{
var i=_1.fromGregorian(_3a).getDate();
}
return (i>9)?i:("0"+i);
},a:function(_3b,nls){
return _3b.getHours()<12?nls.AM:nls.PM;
},HH:function(_3c,nls){
var i=_3c.getHours();
return (i>9)?i:("0"+i);
},hh:function(_3d,nls){
var _3e=_3d.getHours();
if(_3e>12){
_3e-=12;
}else{
if(_3e==0){
_3e=12;
}
}
return (_3e>9)?_3e:("0"+_3e);
},mm:function(_3f,nls){
var _40=_3f.getMinutes();
return (_40<10)?"0"+_40:_40;
},ss:function(_41,nls){
var _42=_41.getSeconds();
return (_42<10)?"0"+_42:_42;
},date:function(_43,nls){
if(_1.isGregorian()){
return dojo.date.locale.format(_43,{selector:"date",formatLength:"short",locale:djConfig.locale});
}else{
return _1.formatBidiDate(_43,{selector:"date",formatLength:"short",locale:djConfig.locale});
}
},date_long:function(_44,nls){
if(_1.isGregorian()){
return dojo.date.locale.format(_44,{selector:"date",formatLength:"long",locale:djConfig.locale});
}else{
return _1.formatBidiDate(_44,{selector:"date",formatLength:"long",locale:djConfig.locale});
}
},time:function(_45,nls){
return dojo.date.locale.format(_45,{selector:"time",formatLength:"short",locale:djConfig.locale});
},time_long:function(_46,nls){
return dojo.date.locale.format(_46,{selector:"time",formatLength:"long",locale:djConfig.locale});
}};
lconn.share.util.DateFormat.delta=function(_47,to){
var _48=_47.getTime();
var _49=new Date(to.getTime());
_49.setHours(0);
_49.setMinutes(0);
_49.setSeconds(0);
_49.setMilliseconds(0);
var _4a=_49.getTime()-_48;
var _4b=Math.ceil(_4a/(lconn.share.util.DateFormat.prototype.MILLS_IN_DAY));
return _4b;
};
})();
}


;if(!dojo._hasResource["lconn.core.unicode"]){
dojo._hasResource["lconn.core.unicode"]=true;
dojo.provide("lconn.core.unicode");
lconn.core.unicode={lengthUtf8:function(s){
var _1=0;
var _2=s.length;
for(var i=0;i<_2;i++){
var c=s.charCodeAt(i);
if(c<=127){
_1++;
}else{
if(c<=2047){
_1+=2;
}else{
if(c<=65535){
_1+=3;
if((c>>11)==27){
_1++;
i++;
}
}else{
_1+=4;
}
}
}
}
return _1;
},getCharIndexForUtf8Index:function(s,_3){
var _4=0;
var _5=s.length;
for(var i=0;i<_5;i++){
var c=s.charCodeAt(i);
if(c<=127){
_4++;
}else{
if(c<=2047){
_4+=2;
}else{
if(c<=65535){
_4+=3;
if((c>>11)==27){
_4++;
i++;
}
}else{
_4+=4;
}
}
}
if(_4>_3){
return i;
}
}
return -1;
}};
}


;if(!dojo._hasResource["lconn.share.util.text"]){
dojo._hasResource["lconn.share.util.text"]=true;
dojo.provide("lconn.share.util.text");




(function(){
var _1=dojo.getObject("lconn.share.util.text._SIZE");
lconn.share.util.text=dojo.clone(lconn.core.util.text);
lconn.share.util.text._SIZE=_1;
lconn.share.util.text.trimToLength=lconn.core.util.text.trimToByteLength;
lconn.share.util.text.lengthUtf8=lconn.core.util.text.getByteLength;
lconn.share.util.text.formatSize=function(){
var _2,_3;
if(arguments.length==2){
_2=arguments[0];
_3=arguments[1];
}else{
_3=arguments[0];
}
if(typeof _3=="undefined"||_3==null||typeof _3=="string"){
return _3;
}
var _2=_2||lconn.share.util.text._SIZE;
if(!_2){
throw "Must pass nls to formatSize or set the lconn.share.util.text._SIZE property during init";
}
if(_3>10*1024*1024*1024){
return dojo.string.substitute(_2.GB,[dojo.number.format(Math.ceil(_3*10/(1024*1024*1024))/10)]);
}else{
if(_3>=1*1024*1024*1024){
return dojo.string.substitute(_2.GB,[dojo.number.format(Math.ceil(_3*100/(1024*1024*1024))/100)]);
}else{
if(_3>100*1024*1024){
return dojo.string.substitute(_2.MB,[dojo.number.format(Math.ceil(_3/(1024*1024)))]);
}else{
if(_3>10*1024*1024){
return dojo.string.substitute(_2.MB,[dojo.number.format(Math.ceil(_3*10/(1024*1024))/10)]);
}else{
if(_3>=1*1024*1024){
return dojo.string.substitute(_2.MB,[dojo.number.format(Math.ceil(_3*100/(1024*1024))/100)]);
}else{
if(_3>1*1024){
return dojo.string.substitute(_2.KB,[dojo.number.format(Math.ceil(_3/1024))]);
}
}
}
}
}
}
return dojo.string.substitute(_2.KB,[dojo.number.format(_3>0?1:0)]);
};
})();
}


;if(!dojo._hasResource["lconn.share.util.html"]){
dojo._hasResource["lconn.share.util.html"]=true;
dojo.provide("lconn.share.util.html");


dojo.deprecated("Use lconn.core.util.html -- will be removed after","5.0");
lconn.share.util.html=lconn.core.util.html;
}


;if(!dojo._hasResource["lconn.share.util.message"]){
dojo._hasResource["lconn.share.util.message"]=true;
dojo.provide("lconn.share.util.message");




dojo.requireLocalization("lconn.core","strings");
(function(m){
m.level={"info":{id:"info",alt:"INFO",imgClassName:"lconnSprite lconnSprite-iconAttention16",className:"lotusMessage lotusInfo"},"warning":{id:"warning",alt:"WARNING",imgClassName:"lconnSprite lconnSprite-iconWarning16",className:"lotusMessage lotusWarning"},"error":{id:"error",alt:"ERROR",imgClassName:"lconnSprite lconnSprite-iconError16",className:"lotusMessage lotusFormError"},"confirm":{id:"confirm",alt:"CONFIRM",imgClassName:"lconnSprite lconnSprite-iconConfirmation16",className:"lotusMessage lotusConfirm"}};
m.defaultLevel="info";
m.nls=dojo.i18n.getLocalization("lconn.core","strings");
m._createErrorContent=function(_1,_2){
var _3=_2.nls||m.nls;
var _4=_2.error;
if(_4&&_4.message&&_4.message!=_4.code){
var d=document;
var _5=d.createElement("span");
_5.className="qkrErrorDetailsText";
_5.appendChild(d.createElement("br"));
_5.appendChild(d.createTextNode(_4.message));
_5.style.display="none";
var _6=d.createElement("a");
_6.appendChild(d.createTextNode(_3.ERROR_DETAILS_LINK||"..."));
_6.className="qkrErrorDetailsLink";
_6.href="javascript:;";
_6.title=_3.ERROR_DETAILS_TOOLTIP||"";
_6.onclick=function(){
_5.style.display="";
_6.style.display="none";
};
if(typeof _1=="string"){
_1=d.createTextNode(_1);
}
if(!dojo.isArray(_1)){
_1=[_1];
}
_1.push(d.createTextNode(" "));
_1.push(_6);
_1.push(_5);
}
return _1;
};
m.setMessage=function(_7,_8,_9,_a){
var d=document;
_a=_a||{};
var _b=dojo.mixin({INFO:m.nls.rs_messagebox_info_icon_alt,WARNING:m.nls.rs_messagebox_warning_icon_alt,SUCCSS:m.nls.rs_messagebox_success_icon_alt,ERROR:m.nls.rs_messagebox_error_icon_alt,CLOSE:m.nls.rs_messagebox_close_btn_title},_a.nls);
var _c=_a.container||_7;
if(!_8){
_c.style.display="none";
return;
}
dijit.setWaiState(_c,"live","assertive");
dijit.setWaiRole(_c,"alert");
while(_7.firstChild){
_7.removeChild(_7.firstChild);
}
var _d=_b.INFO;
var _e=com.ibm.oneui.controls.MessageBox.TYPE.INFO;
var _f=true;
if(_9=="warning"){
_d=_b.WARNING;
_e=com.ibm.oneui.controls.MessageBox.TYPE.WARNING;
}else{
if(_9=="success"){
_d=_b.SUCCESS;
_e=com.ibm.oneui.controls.MessageBox.TYPE.SUCCESS;
}else{
if(_9=="error"){
_d=_b.ERROR;
_e=com.ibm.oneui.controls.MessageBox.TYPE.ERROR;
_f=false;
}
}
}
if(!dojo.isArray(_8)){
_8=[_8];
}
dojo.forEach(_8,function(_10){
var div=_7.appendChild(d.createElement("div"));
var mb=new com.ibm.oneui.controls.MessageBox({canClose:_f,type:_e,msg:_10,_strings:{a11y_label:_d,icon_alt:_d,close_btn_alt:_b.CLOSE,close_btn_title:_b.CLOSE}},div);
div.firstChild.style.marginBottom="0px";
if(_f&&_a.focusPostClose){
dojo.connect(mb,"onClose",dojo.partial(m.remove,div,_a.focusPostClose));
}
});
_c.style.display="";
};
m.remove=function(el,_11,e){
if(e){
dojo.stopEvent(e);
}
el.style.display="none";
setTimeout(function(){
dijit.focus(_11);
},10);
};
})(lconn.share.util.message);
}


;if(!dojo._hasResource["lconn.share.util.validation"]){
dojo._hasResource["lconn.share.util.validation"]=true;
dojo.provide("lconn.share.util.validation");




lconn.share.util.validation.TAG_LENGTH=100;
lconn.share.util.validation.FILENAME_LENGTH=252;
lconn.share.util.validation.COLLECTIONNAME_LENGTH=256;
lconn.share.util.validation.COLLECTIONNAME_LENGTH_ON_LABEL=252;
lconn.share.util.validation.DESCRIPTION_LENGTH=2048;
lconn.share.util.validation.COMMENT_LENGTH=50*1024;
lconn.share.util.validation.INVALID_FILENAME_CHARS=/[\\\/\:\*\?\<\>\|\"]/g;
lconn.share.util.validation.EMPTY_FILENAME=/^[.\s\u3000]*$/;
lconn.share.util.validation.validateTextLength=function(s,_1){
if(!s){
return true;
}
var _2=lconn.share.util.text.lengthUtf8(s);
return (_2<=_1);
};
lconn.share.util.validation.addRequiredIndicator=function(el){
var d=document;
var _3=d.createElement("span");
_3.className="lotusFormRequired";
_3.appendChild(d.createTextNode("*"));
el.appendChild(_3);
};
lconn.share.util.validation.addInlineErrorRow=function(_4,_5,id,_6){
if(arguments.length==3){
_6=id;
id=_5;
_5=_4;
_4=null;
}
var d=document;
dojo.addClass(_5,"lotusFormErrorField");
var _7=_5;
var _8;
while(_7&&!(_7.nodeName.toLowerCase()=="tr"&&dojo.hasClass(_7,"lotusFormFieldRow"))){
_8=_7;
_7=_7.parentNode;
}
var _4=_8.parentNode;
var _9;
var _a;
var _b=(_4.previousSibling&&dojo.hasClass(_4.previousSibling,"_qkrErrorRow"))?_4.previousSibling:null;
if(_b){
var td=dojo.query("TD._qkrErrorColumn",_b)[0];
var ul=td.getElementsByTagName("UL")[0];
if(!ul){
if(td.errorId==id){
return;
}
ul=d.createElement("ul");
ul.className="lotusList";
var li=d.createElement("li");
li.errorId=td.errorId;
while(td.firstChild){
var a=td.firstChild;
td.removeChild(a);
li.appendChild(a);
}
ul.appendChild(li);
td.appendChild(ul);
td.errorId=null;
}else{
if(dojo.some(td.getElementsByTagName("li"),function(a){
return a.errorId==id;
})){
return;
}
}
var li=_a=d.createElement("li");
ul.appendChild(li);
ul.style.display="";
_9=li;
}else{
var _c=lconn.share.util.html.countCells(_4);
var _d=lconn.share.util.html.countCells(_4,_8);
var tr=d.createElement("tr");
tr.className="_qkrErrorRow";
if(_d>0){
var td=d.createElement("td");
dojo.attr(td,"colSpan",_d);
tr.appendChild(td);
}
var td=_a=d.createElement("td");
dojo.attr(td,"colSpan",_c-_d);
td.className="_qkrErrorColumn";
tr.appendChild(td);
_4.parentNode.insertBefore(tr,_4);
_9=td;
}
_9.errorId=id;
lconn.share.util.message.setMessage(_9,_6,"error",{canClose:false});
};
lconn.share.util.validation.removeInlineErrorRow=function(_e,_f,id){
var _10=_e.previousSibling;
if(!_10||!dojo.hasClass(_10,"_qkrErrorRow")){
return;
}
if(dojo.hasClass(_f,"lotusFormErrorField")){
if(id){
var _11=_10.getElementsByTagName("LI");
for(var i=0;i<_11.length;i++){
var li=_11[i];
if(li.errorId==id){
var p=li.parentNode;
p.removeChild(li);
if(!p.firstChild){
p.style.display="none";
}
break;
}
}
var td=dojo.query("TD._qkrErrorColumn",_10)[0];
if(td&&_11.length==1){
var li=_11[0];
td.errorId=li.errorId;
while(td.firstChild){
td.removeChild(td.firstChild);
}
while(li.firstChild){
var el=li.firstChild;
li.removeChild(el);
td.appendChild(el);
}
return;
}
if(!(_11.length==0&&td&&td.errorId==id)){
return;
}
}
dojo.removeClass(_f,"lotusFormErrorField");
}
_e.parentNode.removeChild(_10);
};
lconn.share.util.validation.setFormError=function(el,_12,_13){
_13=_13||{};
var d=document;
var _14=el.nodeName.toLowerCase();
var div;
var _15=_13.isWarning;
var nls=_13.nls;
if(_14=="div"){
div=el;
}else{
var _16=dojo.query("table.lotusFormTable:first-child > tbody",el)[0];
if(!_16){
throw "Can't find tbody";
}
var _17=_15?"table.lotusFormTable:first-child > tbody tr._qkrWarningRow td:first-child > div":"table.lotusFormTable:first-child > tbody tr._qkrErrorRow td:first-child > div";
div=dojo.query(_17,_16)[0];
if(!div){
var _18=_16.getElementsByTagName("tr")[0];
var _19=(_18?lconn.share.util.html.countCells(_18):1);
var tr=d.createElement("tr");
tr.className=_15?"_qkrWarningRow":"_qkrErrorRow";
var td=d.createElement("td");
td.className="_qkrErrorColumn";
dojo.attr(td,"colSpan",_19);
tr.appendChild(td);
if(_18){
_16.insertBefore(tr,_18);
}else{
_16.appendChild(tr);
}
}
var _1a=_15?"warning":"error";
lconn.share.util.message.setMessage(td,_12,_1a,{canClose:false});
}
};
lconn.share.util.validation.removeFormErrors=function(_1b){
dojo.forEach(dojo.query("tr._qkrErrorRow",_1b),function(el){
el.style.display="none";
});
dojo.forEach(dojo.query("tr._qkrWarningRow",_1b),function(el){
el.style.display="none";
});
dojo.forEach(dojo.query("td._qkrErrorColumn",_1b),function(el){
el.parentNode.parentNode.removeChild(el.parentNode);
});
dojo.forEach(dojo.query(".lotusFormErrorField",_1b),function(el){
dojo.removeClass(el,"lotusFormErrorField");
});
};
}


;define("ic-core/config/features",["dojo/has","dojox/lang/functional"],function(_1,_2){
"use strict";
var _3=window.gatekeeperConfig||{};
_2.forIn(_3,function(_4,_5){
_1.add(_5,_4);
});
return _1;
});


;if(!dojo._hasResource["lconn.core.lcTextArea.mixins.ITextBoxControl"]){
dojo._hasResource["lconn.core.lcTextArea.mixins.ITextBoxControl"]=true;
dojo.provide("lconn.core.lcTextArea.mixins.ITextBoxControl");




dojo.declare("lconn.core.lcTextArea.mixins.ITextBoxControl",lconn.core.lcTextArea.mixins.ITextBoxUtils,{showRemainingLimit:50,maxLength:1000,charRemainingDisplay:null,charRemainingAriaText:"",reachedCharLimitCallback:null,textPopulatedCallback:null,onFocusCallback:null,onBlurCallback:null,_charRemainingDisplayNode:null,_charRemainingAriaNode:null,_previousCharLimitCall:false,_showingCharsRemaining:false,_previousEmpty:true,resetBox:function(){
this._setInitialState();
},_showShadowText:function(){
if(this._showingShadowText){
return;
}
this.setText(this.shadowText);
this._showingShadowText=true;
},_hideShadowText:function(){
if(!this._showingShadowText){
return;
}
if(this.shadowText==this.getText()){
this.setText("");
}
this._showingShadowText=false;
},_setInitialState:function(){
this._showShadowText();
if(this.resetFeature){
this.resetFeature();
}
if(this.charRemainingDisplay){
var _1=dojo.query(".charDisplay",this.charRemainingDisplay);
this._charRemainingDisplayNode=(_1&&_1.length>0)?_1[0]:this.charRemainingDisplay;
var _2=dojo.query(".ariaCharLabel",this.charRemainingDisplay);
this._charRemainingAriaNode=(_2&&_2.length>0)?_2[0]:null;
}
this._showingCharsRemaining=true;
this._calculateRemainingChars();
this._previousCharLimitCall=false;
this._previousEmpty=true;
},_showCharsRemaining:function(_3){
if(_3>this.showRemainingLimit){
if(this._showingCharsRemaining){
dojo.style(this.charRemainingDisplay,"display","none");
this._charRemainingDisplayNode.innerHTML="";
if(this._charRemainingAriaNode){
this._charRemainingAriaNode.innerHTML="";
}
this._showingCharsRemaining=false;
}
}else{
if(!(this._showingCharsRemaining)){
dojo.style(this.charRemainingDisplay,"display","inline");
this._showingCharsRemaining=true;
}
this._charRemainingDisplayNode.innerHTML=_3;
if(this._charRemainingAriaNode){
this._charRemainingAriaNode.innerHTML=this.charRemainingAriaText;
}
}
},_calculateRemainingChars:function(){
var _4=this.getText();
var _5=lconn.core.util.text.trim(_4).length?lconn.core.util.text.length(_4):0;
var _6=(!this._showingShadowText)?this.maxLength-_5:this.maxLength;
if(this._charRemainingDisplayNode){
this._showCharsRemaining(_6);
}
if(this.reachedCharLimitCallback){
if(_6<0){
this.reachedCharLimitCallback(true);
this._previousCharLimitCall=true;
}else{
if(_6>=0&&this._previousCharLimitCall){
this.reachedCharLimitCallback(false);
this._previousCharLimitCall=false;
}
}
}
if(this.textPopulatedCallback){
if((!_5==0&&!this._showingShadowText)!=!this._previousEmpty){
this.textPopulatedCallback(_5==0||this._showingShadowText);
this._previousEmpty=!this._previousEmpty;
}
}
},_onFocus:function(){
if(this._showingShadowText){
this._hideShadowText();
}
if(this.onFocusCallback){
this.onFocusCallback();
}
},_onBlur:function(){
if(this.getText().length==0){
this._showShadowText();
}else{
if(this.isIE11){
this._calculateRemainingChars();
}
}
if(this.onBlurCallback){
this.onBlurCallback();
}
},_onKeyDown:function(ev){
if(this.keyDownCallback&&dojo.isFunction(this.keyDownCallback)){
this.keyDownCallback(ev);
}
},_onKeyPress:function(){
if(dojo.isChrome&&this._showingShadowText){
this._hideShadowText();
}
setTimeout(dojo.hitch(this,function(){
this._calculateRemainingChars();
}),50);
},_onResize:function(_7){
dojo.publish("lconn/core/basictextbox/resized",[{height:_7.container.$.clientHeight,editor:_7}]);
}});
}


;if(!dojo._hasResource["lconn.core.lcTextArea.mixins.ITextBoxSupport"]){
dojo._hasResource["lconn.core.lcTextArea.mixins.ITextBoxSupport"]=true;
dojo.provide("lconn.core.lcTextArea.mixins.ITextBoxSupport");
(function(){
function _1(){
if(this.textAreaNode&&typeof this.textAreaNode.value!=="undefined"){
return true;
}else{
console.warn("ITextBoxSupport requires that the mixed-in class has a textAreaNode member with a value");
return false;
}
};
dojo.declare("lconn.core.lcTextArea.mixins.ITextBoxSupport",null,{getText:function(){
return _1.apply(this)?this.textAreaNode.value.replace(/^\s*/,""):null;
},setText:function(_2){
if(_1.apply(this)){
this.textAreaNode.value=_2;
}
}});
})();
}


;if(!dojo._hasResource["lconn.core.lcTextArea.mixins.IMentionsSupport"]){
dojo._hasResource["lconn.core.lcTextArea.mixins.IMentionsSupport"]=true;
dojo.provide("lconn.core.lcTextArea.mixins.IMentionsSupport");
(function(){
function _1(){
if(!this._mentionsHelper){
console.warn("IMentionsSupport requires that the mixed-in class has a _mentionsHelper member");
return false;
}
return true;
};
dojo.declare("lconn.core.lcTextArea.mixins.IMentionsSupport",null,{_mentionsHelper:null,getTrackedMentions:function(){
return _1.apply(this)?this._mentionsHelper.getTextAsJson():null;
},getText:function(){
return _1.apply(this)?this._mentionsHelper.getText().replace(/^\s*/,""):null;
},setText:function(_2){
if(_1.apply(this)){
this._mentionsHelper.setText(_2);
}
},addMentionsCallback:function(_3,_4){
if(_1.apply(this)){
this._mentionsHelper.addCallback(_3,_4);
}
},setTypeAheadHeader:function(s){
if(_1.apply(this)){
this._mentionsHelper.setTypeaheadHeader(s);
}
},formatForPlaintext:function(_5){
return _5.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");
},setValue:function(_6,_7){
if(this._mentionsHelper&&this._mentionsHelper._isTracking){
this._mentionsHelper.cancelMention();
}
if(_7){
_6=this.formatForPlaintext(_6);
}
if(_1.apply(this)){
this._mentionsHelper.setValue(_6);
}else{
var _8=dojo.toDom(_6.replace(/(\r\n|\n|\r)/gm,""));
dojo.empty(this.textAreaNode);
this.textAreaNode.appendChild(_8);
}
},getValue:function(_9){
if(_9){
if(this._mentionsHelper&&this._mentionsHelper._isTracking){
if(dojo.isChrome){
this._mentionsHelper.plainTextChromeCancelMention();
}else{
this._mentionsHelper.cancelMention();
}
}
return _1.apply(this)?this._mentionsHelper.getText(_9).replace(/^\s*/,""):null;
}else{
return this.textAreaNode.innerHTML;
}
}});
})();
}


;if(!dojo._hasResource["lconn.core.lcTextArea.mixins.Mentions"]){
dojo._hasResource["lconn.core.lcTextArea.mixins.Mentions"]=true;
dojo.provide("lconn.core.lcTextArea.mixins.Mentions");




(function(){
function _1(_2){
var _3=dojox.html.entities.encode("<span.*class=\"vcard\".*>.?<(span|a).*class=\"fn.*>.*</(span|a)>.?<span.*>.*</span>.?</span>");
var _4=function(_5){
return dojox.html.entities.decode(_5);
};
_2=dojox.html.entities.encode(_2);
return _2.replace(new RegExp(_3,"gim"),_4);
};
lconn.core.lcTextArea.mixins.Mentions={getDataMentions:function(_6){
var _7=dojo.query("a.fn",_6)[0],_8=_7?_7.textContent||_7.innerText:"",_9=_8.indexOf("@")==0,_a=_9?_8.substring(1,_8.length):_8,_b=dojo.query(".x-lconn-userid",_6)[0],_c=_b?_b.textContent||_b.innerText:"";
return {"displayName":dojox.html.entities.decode(_a),"userId":_c,"type":"PersonMentions","hasSymbol":_9};
},getRTEPlainMention:function(_d){
var _e=this.getDataMentions(_d);
return "@{{"+_e.userId+"|"+_e.displayName+(_e.hasSymbol?"|notify":"")+"}}";
},formatSetValue:function(_f,_10){
_f=_f.replace(/data-mentions="(\{.*?\})"/gi,"data-mentions='$1'");
return lconn.core.util.text.htmlify(_10?_f:_1(_f));
},formatGetValue:function(_11){
_11=_11.replace(/<br>(<\/p>)/gi,"$1");
_11=_11.replace(/<p>(.*)<\/p>/,"$1");
_11=_11.replace(/<\/p><p>|<br>/gi,"\n");
_11=_11.replace(/\u200b/gi,"");
var _12=dojo.toDom("<div>"+_11+"</div>");
var _13="";
if(_12&&_12.childNodes){
dojo.forEach(_12.childNodes,function(_14){
if(_14.nodeName=="SPAN"&&_14.className=="vcard"){
_13+=this.getRTEPlainMention(_14);
}else{
if(_14.nodeType==1){
_13+=_14.nodeName=="A"?(dojo.isFF?_14.innerHTML:_14.innerText):_14.outerHTML;
}else{
if(_14.data){
_13+=_14.data;
}
}
}
},this);
}else{
if(_12&&_12.data){
_13+=_12.data;
}
}
return _13;
}};
})();
}


;if(!dojo._hasResource["lconn.core.lcTextArea.mixins.IMentionsSupportRTE"]){
dojo._hasResource["lconn.core.lcTextArea.mixins.IMentionsSupportRTE"]=true;
dojo.provide("lconn.core.lcTextArea.mixins.IMentionsSupportRTE");




(function(){
function _1(){
if(!this._editor){
console.warn("IMentionsSupportRTE requires that the mixed-in class has an _editor member");
return false;
}
return true;
};
function _2(_3,_4){
var _5;
if(_3.nodeType===1&&_3.className=="vcard"){
_5=_3.getAttribute("data-mentions");
if(_5){
_4.push(dojo.fromJson(_5));
}else{
_4.push(lconn.core.lcTextArea.mixins.Mentions.getDataMentions(_3));
}
}else{
var _6=_3.data||_3.innerText||_3.textContent;
if(_3.nodeName=="BR"){
_6="\n";
}
if(_6&&_6!=""&&_6!="\u200b"){
_4.push({type:"text",value:_6.replace("\u200b","").replace(/\u00A0/gi," ")});
}
}
};
dojo.declare("lconn.core.lcTextArea.mixins.IMentionsSupportRTE",null,{getTrackedMentions:function(){
if(!_1.apply(this)){
return null;
}
var _7=dojo.toDom(this._editor.getData());
var _8=[];
dojo.forEach(_7.childNodes,function(_9){
if(_9.nodeName=="P"||_9.nodeName=="BR"){
dojo.forEach(_9.childNodes,function(_a){
_2(_a,_8);
});
_8.push({type:"html",value:"\n"});
}else{
_2(_9,_8);
}
});
return {textData:_8};
},cancelActiveMentions:function(){
if(this._editor&&this._editor.plugins&&this._editor.plugins.mentions){
this._editor.plugins.mentions.cancelActiveMentions(this._editor);
}
},formatForPlaintext:function(_b){
return _b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");
},getValue:function(_c){
this.cancelActiveMentions();
var _d=this._editor.document.getBody().getHtml();
_d=_d.replace(/data-cke-saved-href=+"(?:[^\\"]+|\\.)*"/gi,"");
if(_c){
_d=lconn.core.lcTextArea.mixins.Mentions.formatGetValue(_d);
}else{
_d=_d.replace(/<p>(.*)<\/p>/,"$1");
_d=_d.replace(/<br>/gi,"");
_d=_d.replace(/<\/p><p>/gi,"<br>");
_d=_d.replace(/^\s*/,"");
_d=_d.replace(/&nbsp;/gi," ");
_d=dojox.html.entities.decode(_d);
}
return _d;
},setValue:function(_e,_f){
this.cancelActiveMentions();
if(_f){
_e=this.formatForPlaintext(_e);
}
_e=_e.replace(/data-cke-saved-href=+"(?:[^\\"]+|\\.)*"/gi,"");
_e=lconn.core.lcTextArea.mixins.Mentions.formatSetValue(_e,_f);
if(this._editor&&this._editor.document){
this._editor.document.getBody().setHtml(_e);
var _10=this._editor.document.$.querySelectorAll("span.vcard");
if(dojo.exists("SemTagSvc")){
dojo.forEach(_10,function(_11){
_11.setAttribute("contenteditable",false);
SemTagSvc.parseDom(0,_11);
});
}
}
}});
})();
}


;if(!dojo._hasResource["lconn.core.widget.mentions.MentionsUtils"]){
dojo._hasResource["lconn.core.widget.mentions.MentionsUtils"]=true;
dojo.provide("lconn.core.widget.mentions.MentionsUtils");




dojo.declare("lconn.core.widget.mentions.MentionsUtils",null,{disableBizCard:false,includeRangy:function(cb){
if(net.jazz.ajax.xdloader.load_async){
net.jazz.ajax.xdloader.load_async("lconn.core.ext.rangy.rangyCore",cb);
}
},rangeSelectNode:function(_1,_2){
if(_1){
if(this.isAnyMentionsNode(_1)){
_2.selectNodeContents(_1.getTextNode());
}else{
if(this.isAnyMentionsDomNode(_1)){
var _3=_1.getElementsByTagName("a");
if(_3&&_3.length==1){
_2.selectNodeContents(_3[0].firstChild);
}
}else{
_2.selectNodeContents(_1);
}
}
}
return _2;
},rangeMoveToNodeStart:function(_4,_5){
if(_4){
_5=this.rangeSelectNode(_4,_5);
_5.collapse(true);
}
return _5;
},rangeMoveToNodeEnd:function(_6,_7){
if(_6){
_7=this.rangeSelectNode(_6,_7);
_7.collapse(false);
}
return _7;
},isAnyMentionsDomNode:function(_8){
return this.isPersonMentionsDomNode(_8)||this.isMentionsDomNode(_8);
},isMentionsDomNode:function(_9){
var _a=dojo.attr(_9,"type");
var _b=false;
if(_a){
_b=_a.indexOf("MentionsNode")!=-1;
}
return _b;
},isPersonMentionsDomNode:function(_c){
return (dojo.attr(_c,"type")=="PersonMentionsNode");
},isAnyMentionsNode:function(_d){
return _d.className&&_d.className.indexOf("MentionsNode")!=-1;
},isMentionsNode:function(_e){
return _e.className&&_e.className=="MentionsNode";
},isPersonMentionsNode:function(_f){
return _f.className&&_f.className=="PersonMentionsNode";
},isSelectedNode:function(_10){
return _10==this._currentNode;
},setSelectedNode:function(_11){
this._currentNode=_11;
},isInputNode:function(_12){
return _12==this.textAreaNode;
},isTextNode:function(_13){
return _13.nodeType==3;
},isStartOfTextNode:function(_14){
return _14.startOffset==0&&_14.startContainer.nodeType==3;
},isEndOfTextNode:function(_15){
var _16=_15.startContainer;
return (_15.endOffset>=_16.length-1)&&_16.nodeType==3;
},saveSelectionIE:function(sel){
if(dojo.isIE){
this._rangySelection=sel;
}
},connectEvents:function(){
dojo.connect(this.textAreaNode,"onkeypress",this,this.keyListener);
dojo.connect(this.textAreaNode,"onpaste",this,this.pasteListener);
dojo.connect(this.textAreaNode,"onblur",this,this.blurListener);
dojo.connect(this.textAreaNode,"onfocus",this,this.focusListener);
dojo.connect(this.textAreaNode,"oncut",this,this.cutListener);
dojo.connect(this.textAreaNode,"onclick",this,this.clickListener);
if(dojo.isWebKit||dojo.isMozilla){
dojo.connect(this.textAreaNode,"compositionstart",this,this.compositionStart);
dojo.connect(this.textAreaNode,"compositionupdate",this,this.compositionUpdate);
dojo.connect(this.textAreaNode,"compositionend",this,this.compositionEnd);
}
dojo.connect(this.textAreaNode,"onmousedown",this,this.mouseDownListener);
dojo.connect(this.textAreaNode,"onmousemove",this,this.mouseMoveListener);
dojo.connect(this.textAreaNode,"onmouseup",this,this.mouseUpListener);
dojo.connect(this.textAreaNode,"ondrop",this,this.cancelEvent);
dojo.connect(this.textAreaNode,"ondragover",this,this.cancelEvent);
},compositionStart:function(e){
this.printDebug("Started composition from IME: "+e.data);
this._isComposition=true;
if(!this._isTracking){
if(e.data==String.fromCharCode(this.trackedKeyCode)){
e.keyCode=this.trackedKeyCode;
this.keyListener(e);
}
}
},compositionUpdate:function(e){
this.printDebug("Updated composition from IME: "+e.data);
if(this.eventHandles["onkeypress"]){
setTimeout(dojo.hitch(this,this.eventHandles.onkeypress),50);
}
},compositionEnd:function(e){
this.printDebug("Ended composition from IME: "+e.data);
if(this._isTracking){
var _17=this._currentNode;
_17.value=_17.value+e.data;
var _18=_17.getTextNode();
this.updateTrack(_17.value);
}
if(this.eventHandles["onkeypress"]){
setTimeout(dojo.hitch(this,this.eventHandles.onkeypress),50);
}
this._isComposition=false;
},cancelEvent:function(e,_19){
e.preventDefault();
if(_19){
e.cancelBubble=true;
if(e.stopPropagation){
e.stopPropagation();
}
}
return false;
},stringSplice:function(_1a,idx,_1b,_1c){
return (_1a.slice(0,idx)+(_1c||"")+_1a.slice(idx+Math.abs(_1b)));
},setTypeaheadHeader:function(s){
if(this._registeredTypes){
var _1d=dojo.filter(this._registeredTypes,function(_1e){
return _1e._type=="PersonMentionsType";
});
if(_1d.length>0){
if(_1d[0]&&_1d[0]._typeahead){
typeahead=_1d[0]._typeahead;
if(typeahead.setHeaderMessage){
typeahead.setHeaderMessage(s);
}else{
if(typeahead._popupWidget){
typeahead._popupWidget.HeaderMessage=s;
}
typeahead.HeaderMessage=s;
}
}
}
}
},_fixRangySelection:function(sel){
sel.removeAllRangesEx=dojo.partial(function(me){
try{
this.docSelection.empty();
if(this.docSelection.type!="None"){
var tmp=dojo.create("input",{type:"text",style:"display: none"},me.textAreaNode,"after");
var _1f=tmp.createTextRange();
_1f.select();
this.docSelection.empty();
me.textAreaNode.parentNode.removeChild(tmp);
}
}
catch(ex){
}
this.anchorNode=sel.focusNode=null;
this.anchorOffset=sel.focusOffset=0;
this.rangeCount=0;
this.isCollapsed=true;
this._ranges.length=0;
},this);
sel.setSingleRangeEx=function(_20){
if(dojo.isIE<8){
this.removeAllRangesEx();
}else{
this.removeAllRanges();
}
try{
this.addRange(_20);
}
catch(err){
}
};
},getSelection:function(){
var _21,_22;
if(dojo.isIE&&window.rangy){
if(!this._rangySelection){
rangy.init();
_21=rangy.getSelection();
_21.refresh();
this._fixRangySelection(_21);
this._rangySelection=_21;
}else{
_21=this._rangySelection;
}
var _23=null;
if(_21.rangeCount>0){
_22=_21.getRangeAt(0);
_23=_22.startContainer;
}
if(!_23||typeof _23.nodeValue==="unknown"){
_21=rangy.getSelection();
_21.refresh();
this._fixRangySelection(_21);
this._rangySelection=_21;
_22=_21.getRangeAt(0);
_23=_22.startContainer;
}
if(_23==dojo.body()){
_23=this.textAreaNode;
if(_23.childNodes.length==0){
_23.appendChild(document.createTextNode(""));
_22=this.rangeMoveToNodeEnd(_23.firstChild,_22);
}
}else{
if(_23==this.textAreaNode){
if(_23.childNodes.length==0){
_23.appendChild(document.createTextNode(""));
_22=this.rangeMoveToNodeEnd(_23.firstChild,_22);
}else{
_22=this.rangeMoveToNodeEnd(_23.childNodes[_22.startOffset],_22);
}
}
}
}else{
if(window.getSelection){
_21=window.getSelection();
}else{
if(document.selection){
_21=document.selection.createRange();
}
}
if(_21.getRangeAt&&_21.rangeCount>0){
_22=_21.getRangeAt(0);
}else{
if(document.createRange){
_22=document.createRange();
if(_21.anchorNode&&_21.focusNode){
_22.setStart(_21.anchorNode,_21.anchorOffset);
_22.setEnd(_21.focusNode,_21.focusOffset);
}
}else{
if(document.selection.createRange){
_22=document.selection.createRange();
var _24=_22.duplicate();
_24.moveToElementText(this.textAreaNode);
_24.setEndPoint("EndToEnd",_22);
_22.startOffset=_24.text.length-_22.text.length;
_22.endOffset=_22.startOffset+_22.text.length;
}
}
}
}
this.printDebug("Node: "+this.getRangeText(_22)+" -- Start: "+_22.startOffset+"    End: "+_22.endOffset);
return {selection:_21,range:_22};
},getRangeText:function(_25){
if(dojo.isIE){
if(_25&&_25.startContainer){
return _25.startContainer.data;
}
}else{
return _25.startContainer.textContent;
}
return "";
},setRange:function(_26,_27,_28,_29){
_26.setEnd(_27,_29);
var _2a=_26.cloneRange();
_26.setStart(_27,_28);
return {nodeRange:_2a,selectionRange:_26};
},updateRange:function(_2b,_2c){
var _2d=this.getSelection();
_2b=this.getTextNode(_2b);
var _2e=_2b.data.length;
var sel=_2d.selection;
var _2f=_2d.range;
var _30=null;
var _31;
if(_2c<=_2e){
_31=this.setRange(_2f,_2b,_2c,_2c);
}else{
_31=this.setRange(_2f,_2b,_2e,_2e);
}
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_31.selectionRange);
}else{
sel.removeAllRanges();
sel.addRange(_31.selectionRange);
}
_30=_31.nodeRange;
this.printDebug("NodeRange: "+this.getRangeText(_30)+" -- Start: "+_30.startOffset+"    End: "+_30.endOffset);
this.printDebug("SelectionRange: "+this.getRangeText(_2f)+" -- Start: "+_2f.startOffset+"    End: "+_2f.endOffset);
return {nodeRange:_30,selectionRange:_2f};
},setRangeBeforeNode:function(_32){
curSel=this.getSelection();
var _33=curSel.range;
var sel=curSel.selection;
if(dojo.isIE<9){
if(_32.nodeType!=3){
_33.moveToElementText(_32);
_33.select();
}
}else{
_33.setStartBefore(_32);
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_33);
}else{
sel.removeAllRanges();
sel.addRange(_33);
}
}
},setRangeAfterNode:function(_34){
curSel=this.getSelection();
var _35=curSel.range;
var sel=curSel.selection;
if(dojo.isIE<9){
if(_34.nodeType!=3){
_35.moveToElementText(_34);
_35.select();
}
}else{
_35.setStartAfter(_34);
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_35);
}else{
sel.removeAllRanges();
sel.addRange(_35);
}
}
},showBizCardHover:function(e,_36){
if(e&&_36&&!this.disableBizCard){
var evt=null;
if(document.createEvent){
evt=document.createEvent("KeyboardEvent");
if(evt.initKeyEvent){
evt.initKeyEvent("keypress",false,false,null,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.keyCode,e.charCode);
}else{
evt.initKeyboardEvent("keypress",false,false,null,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.keyCode,e.charCode);
}
_36.dispatchEvent(evt);
}else{
if(document.createEventObject){
evt=document.createEventObject();
if(typeof e.type!=="unknown"&&e.type=="keypress"){
evt.keyCode=e.keyCode;
evt.ctrlKey=e.ctrlKey;
evt.altKey=e.altKey;
evt.shiftKey=e.shiftKey;
evt.repeat=false;
evt.cancelBubble=true;
evt.returnValue=false;
evt.target=_36;
}
}
}
var _37=dojo.byId("bc_document_node");
if(!_37){
_37=dojo.byId("bc_document_node_comm");
}
if(_37){
var _38=_37.id;
_37.id="bc_document_node_hidden";
}
this._activeBizCard=true;
if(evt){
if(lconn.profiles.bizCard.bizCard&&dojo.isFunction(lconn.profiles.bizCard.bizCard.showMenu)){
LCSemTagMenu.showHover(evt,lconn.profiles.bizCard.bizCard.showMenu);
}
if(this._currentNode&&dojo.byId("semtagmenu").firstChild){
this.setAriaLabel(this._resourceBundle.SELECTED_MENTION+" "+dojo.attr(dojo.byId("semtagmenu").firstChild,"aria-label"),[this._currentNode.linkNode.innerHTML]);
}
}
if(_37){
_37.id=_38;
}
setTimeout(dojo.hitch(this,function(){
this.textAreaNode.focus();
}),10);
}
},hideBizCardHover:function(){
if(window.LCSemTagMenu&&!this.disableBizCard){
LCSemTagMenu.hide();
}
},getIdxFromId:function(_39){
var idx=0;
var id=_39.id;
var idx=parseInt(id.slice(-2));
if(isNaN(idx)){
idx=parseInt(id.slice(-1));
}
return idx;
},getTextNode:function(_3a){
var _3b=null;
if(_3a){
if(_3a.nodeType==3){
_3b=_3a;
}else{
if(_3a.firstChild){
_3b=this.getTextNode(_3a.firstChild);
}
}
}
return _3b;
},setText:function(_3c){
if(dojo.isIE){
this.textAreaNode.innerText=_3c;
}else{
this.textAreaNode.innerHTML=_3c;
}
},getText:function(_3d){
return (this.getNodeText(this.textAreaNode,_3d)).replace(new RegExp("\u200b","g"),"");
},getNodeText:function(_3e,_3f){
var _40="";
if(_3e){
dojo.forEach(_3e.childNodes,function(_41,i){
if(_41.nodeName=="BR"){
_40+="\n";
}else{
if(_3f&&_41.className=="vcard"){
_40+=this.getPlainMention(_41);
}else{
var _42=this.getTextNode(_41);
if(_42){
var _43=_42.data;
if(_43.charCodeAt(0)==128&&_43.length==1){
_43="";
}
_40+=_43;
}
}
}
},this);
}
if(dojo.isWebKit){
_40=_40.replace("\u200b","");
if(_40.charCodeAt(0)==128&&_40.length==1){
_40="";
}
}
return _40;
},getPlainMention:function(_44){
var _45="";
var _46="";
var _47=this.getTextNode(_44);
var _48=false;
if(_47&&_47.data.search(this.bidiActivatorChar(_47.data))==0){
_45=_47.data.replace(this.bidiActivatorChar(_47.data),"");
_48=true;
}else{
_45=_47.data;
}
var _49=dojo.query(".x-lconn-userid",_44)[0];
if(_49){
_46=dojo.isFF?_49.innerHTML:_49.innerText;
}
return this.activatorChar+"{{"+_46+"|"+_45+(_48?"|notify":"")+"}}";
},getTextAsJson:function(){
var _4a=[];
var _4b=this.textAreaNode.childNodes;
for(var i=0;i<_4b.length;i++){
var _4c=_4b[i];
var _4d="text";
if(_4c.id){
if(_4c.id.indexOf("mentionsNode_")!=-1){
var _4e=this.getNodeAttributes(_4c.id);
if(_4e){
if(_4e.isComplete){
_4a.push(_4e.toJsonString());
}else{
_4a.push({type:"text",value:_4e.value});
}
}
}
}else{
var _4f=_4c.data;
if(_4f&&_4f!=""&&_4f!="\u200b"&&_4c.nodeName!="BR"){
_4f=_4f.replace("\u200b","");
_4f=_4f.replace(/\u00A0/g," ");
_4a.push({type:"text",value:_4f});
}else{
if(_4c.nodeName=="BR"){
_4a.push({type:"html",value:"\n"});
}else{
if(_4c.nodeName=="A"){
_4a.push({type:"text",value:(_4c.innerText||_4c.textContent)});
}
}
}
}
}
return {textData:_4a};
},moveToPreviousNode:function(_50,_51,sel){
_50=this.adjustRangeWebKit(_50,_51);
var _52=null;
var _53=dojo.indexOf(this.textAreaNode.childNodes,_50);
if(_53>0){
_52=this.textAreaNode.childNodes[_53-1];
if(_52.nodeType==3){
if(_52.length==0){
this.moveToPreviousNode(_52,_51,sel);
}else{
if(dojo.isIE>8&&_52.length==1&&_52.data.charAt(0)=="\u200b"){
this.moveToPreviousNode(_52,_51,sel);
}else{
_51.setStart(_52,_52.length);
_51.setEnd(_52,_52.length);
}
}
if(window.LCSemTagMenu&&!this.disableBizCard){
LCSemTagMenu.hide();
}
}else{
if(dojo.isIE>7){
var _54=this.getTextNode(_52);
try{
_51.setStart(_54,0);
_51.setEnd(_54,_54.data.length);
}
catch(err){
}
}else{
_51.selectNode(_52);
}
this._currentNode=this.getNodeAttributes(_52.id);
}
}else{
if(_50){
_51.setStart(_50,0);
_51.setEnd(_50,0);
}else{
_51.selectNodeContents(this.textAreaNode);
}
}
if(sel&&_51){
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_51);
}else{
sel.removeAllRanges();
sel.addRange(_51);
}
this.saveSelectionIE(sel);
}
return _52;
},moveToNextNode:function(_55,_56,sel){
_55=this.adjustRangeWebKit(_55,_56);
var _57=null;
var _58=dojo.indexOf(this.textAreaNode.childNodes,_55);
if(_58<this.textAreaNode.childNodes.length-1){
_57=this.textAreaNode.childNodes[_58+1];
if(_57.nodeType==3){
if(_57.length==0){
this.moveToNextNode(_57,_56,sel);
}else{
_56.setStart(_57,0);
_56.setEnd(_57,0);
}
if(window.LCSemTagMenu&&!this.disableBizCard){
LCSemTagMenu.hide();
}
}else{
if(dojo.isIE>7){
var _59=this.getTextNode(_57);
if(_59){
_56.setStart(_59,0);
_56.setEnd(_59,_59.data.length);
}
}else{
_56.selectNode(_57);
}
this._currentNode=this.getNodeAttributes(_57.id);
}
}else{
if(_55){
_56.setStart(_55,_55.length);
_56.setEnd(_55,_55.length);
}else{
_56.selectNodeContents(this.textAreaNode);
}
}
if(sel&&_56){
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_56);
}else{
sel.removeAllRanges();
sel.addRange(_56);
}
this.saveSelectionIE(sel);
}
return _57;
},adjustRangeWebKit:function(_5a,_5b){
if(dojo.isWebKit){
while(_5a&&_5a.parentElement&&_5a.parentElement!=this.textAreaNode){
_5b.selectNode(_5b.startContainer);
_5a=_5b.startContainer;
}
}
return _5a;
},setReadOnly:function(){
dojo.attr(this.textAreaNode,"contenteditable",false);
},setEditable:function(){
dojo.attr(this.textAreaNode,"contenteditable",true);
},removeSelection:function(e){
if(e){
e.preventDefault();
}
var _5c=this.getSelection();
var sel=_5c.selection;
var _5d=_5c.range;
_5c.selection.collapseToStart();
if(dojo.isIE){
sel.refresh();
_5d=sel.getRangeAt(0);
}
var _5e=null;
if(_5d.startContainer==_5d.endContainer){
var _5f=_5d.startContainer;
while(_5f&&_5f.parentNode&&_5f.parentNode!=this.textAreaNode){
_5f=_5f.parentNode;
}
_5e=this.getNodeAttributes(_5f.id);
this._currentNode=(_5e==this._currentNode)?null:this._currentNode;
if(_5e){
if(this._isTracking){
var _60=_5d.startOffset;
_5d.extractContents();
_5e.setValue(_5d.startContainer.data);
_5d.setStart(_5d.startContainer,_60);
_5d.setEnd(_5d.startContainer,_60);
sel.removeAllRanges();
sel.addRange(_5d);
this.saveSelectionIE(sel);
}else{
this.removeMentionNode(_5e);
}
}
}
if(!_5e){
var _61=_5d.extractContents();
dojo.forEach(_61.childNodes,function(_62){
if(_62){
var _63=this.getNodeAttributes(_62.id);
if(_63){
this._currentNode=(_63==this._currentNode)?null:this._currentNode;
this.removeMentionNode(_63);
}
}
},this);
}
if(_5d.startContainer==this.textAreaNode){
if(dojo.isSafari){
_5d=this.mergeAdjacentTextNodes(_5d,this.textAreaNode.childNodes[_5d.startOffset]);
}else{
var _5f=this.textAreaNode.childNodes[_5d.startOffset];
if(_5f){
_5d.setStart(_5f,0);
_5d.setEnd(_5f,0);
}
}
}else{
try{
_5d.setStart(_5d.startContainer,_5d.startOffset);
_5d.setEnd(_5d.startContainer,_5d.startOffset);
}
catch(err){
}
}
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_5d);
this.saveSelectionIE(sel);
}else{
sel.removeAllRanges();
sel.addRange(_5d);
}
_61=null;
return _5d;
},mergeAdjacentTextNodes:function(_64,_65){
var _66="";
var _67=0;
if(_65&&_65.nodeType==3){
var _68=_65.previousSibling;
var _69=_65.nextSibling;
if(_68&&_68.nodeType==3){
_66+=_68.data;
_67+=_68.data.length;
_68.parentNode.removeChild(_68);
}
_66+=_65.data;
if(_69&&_69.nodeType==3){
_66+=_69.data;
_69.parentNode.removeChild(_69);
}
var _6a=document.createTextNode(_66);
_65=_65.parentNode.replaceChild(_6a,_65);
_64.setStart(_6a,_67);
_64.setEnd(_6a,_67);
}
return _64;
},completeMention:function(_6b){
var _6c=this.getSelection();
var sel=_6c.selection;
var _6d=_6c.range;
var _6e=this._currentNode;
_6e.setComplete(true,_6b,this.disableBizCard);
this.clearImeNodeIE(_6e);
this.setAriaLabel(this._resourceBundle.COMPLETED_MENTION,[_6e.value]);
this.resetTypeaheadAria();
var _6f=this.typeaheadField?this.typeaheadField._popupWidget:null;
if(_6f&&dojo.isIE){
dojo.removeClass(_6f.domNode.parentNode,"lconnTypeAhead");
}
if(this.eventHandles["onCreateMention"]){
this.eventHandles.onCreateMention(_6e);
}
var _70=_6e.domNode;
if(_70){
var _71,_72=null;
if(dojo.isWebKit||dojo.isIE>7){
_71=document.createTextNode("\u200b");
_72=document.createTextNode("\u200b");
}else{
_71=document.createTextNode("");
_72=document.createTextNode("");
}
if(!_70.previousSibling){
this.textAreaNode.insertBefore(_71,_70);
}else{
if(dojo.isWebKit){
prevSib=_70.previousSibling;
if(prevSib.nodeType==3&&prevSib.data===""){
prevSib.data="\u200b";
}
}
}
if(!_70.nextSibling||(dojo.isIE&&_70.nextSibling.length==0)){
this.textAreaNode.insertBefore(_72,_70.nextSibling);
}else{
if(dojo.isWebKit){
nextSib=_70.nextSibling;
if(nextSib.nodeType==3&&nextSib.data===""){
nextSib.data="\u200b";
}
}
}
}
_6d=this.rangeMoveToNodeStart(_70.nextSibling,_6d);
if(dojo.isIE>7){
_6d.setStart(_6d.startContainer,1);
_6d.setEnd(_6d.endContainer,1);
}
try{
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_6d);
}else{
sel.removeAllRanges();
sel.addRange(_6d);
}
}
catch(err){
this.printDebug("Setting backup range on Mention Completion.");
sel=rangy.getSelection();
var _6d=rangy.createRangyRange();
_6d.selectNode(_70);
_6d.collapse();
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_6d);
}else{
sel.removeAllRanges();
sel.addRange(_6d);
}
this.saveSelectionIE(sel);
}
this.saveSelectionIE(sel);
this.getSelection();
this.updateTrack(_6e.value);
this.stopTrack();
},clearImeNodeIE:function(_73){
if(dojo.isIE&&_73&&_73.linkNode){
var _74=_73.linkNode.nextSibling;
if(_74&&_74.nodeType==3){
_74.data="";
}
}
},removeMentionNode:function(_75){
var _76=_75.domNode.nextSibling;
this._trackedMentions.splice(dojo.indexOf(this._trackedMentions,_75),1);
var _77=_75.domNode;
if(_77&&_77.parentNode&&_77.parentNode.nodeType!=11){
if(dojo.isIE==8&&this.textAreaNode.firstChild.data==""){
this.textAreaNode.replaceChild(document.createTextNode("\u200b"),_77);
}else{
this.textAreaNode.removeChild(_77);
}
}
if(this.eventHandles["onRemoveMention"]){
this.eventHandles.onRemoveMention(_75);
}
this.setAriaLabel(this._resourceBundle.REMOVED_MENTION,[_75.value]);
this.resetTypeaheadAria();
_75.destroy();
return _76;
},convertMentionNodeToText:function(_78,_79){
var _7a=_78.domNode.nextSibling;
this.clearImeNodeIE(this._currentNode);
this._trackedMentions.splice(dojo.indexOf(this._trackedMentions,_78),1);
var _7b=_78.domNode;
if(_7b&&_7b.parentNode&&_7b.parentNode.nodeType!=11){
this.textAreaNode.removeChild(_7b);
}
this.setAriaLabel(this._resourceBundle.CANCELLED_MENTION,[_78.value]);
this.resetTypeaheadAria();
var _7c=document.createTextNode(_78.value);
this.textAreaNode.scrollTop=_78.domNode.offsetTop-this.textAreaNode.offsetTop;
this.textAreaNode.insertBefore(_7c,_7a);
if(this.eventHandles["onRemoveMention"]){
this.eventHandles.onRemoveMention(_78);
}
if(!_79){
var _7d=this.getSelection();
var sel=_7d.selection;
var _7e=_7d.range;
var _7f=_7c.data.length;
_7e.setStart(_7c,_7f);
_7e.setEnd(_7c,_7f);
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_7e);
}else{
sel.removeAllRanges();
sel.addRange(_7e);
}
this.saveSelectionIE(sel);
}
_78.destroy();
return _7c;
},resetTypeaheadAria:function(){
dojo.attr(this.textAreaNode,"role","textbox");
dojo.removeAttr(this.textAreaNode,"aria-expanded");
dojo.removeAttr(this.textAreaNode,"aria-activedescendant");
dojo.removeAttr(this.textAreaNode,"aria-owns");
},removeMentionById:function(_80){
var _81=this.getNodeAttributes(_80);
if(_81!=null){
nextNode=this.removeMentionNode(_81);
}
return nextNode;
},handleResumeMention:function(sel,_82){
var _83=_82.startContainer;
if(_83&&this._currentNode&&!this._currentNode.isComplete){
var _84=this._currentNode.getTextNode();
while(_83&&_83.nodeType==3&&(_83.data==""||_83.data=="\u200b")){
_83=_83.previousSibling;
}
if(_83&&_83.nodeType==1&&this.isAnyMentionsDomNode(_83)){
if(_83.getElementsByTagName("a")[0]){
_83=_83.getElementsByTagName("a")[0].firstChild;
}
}
if(_83&&_84&&(document.activeElement==this.textAreaNode&&_83!=window.document)&&(_83.data!=_84.data||(_83.data==_84.data&&_83!=_84&&_82.startOffset!=0))){
if(dojo.isIE>8&&!_82.collapsed&&!(_82.endContainer&&_82.endContainer==this._currentNode.domNode)){
this.convertMentionNodeToText(this._currentNode,true);
this.stopTrack();
}
}else{
if(_83&&_82.startContainer!=_83){
_82.setStart(_83,_83.data.length);
_82.setEnd(_83,_83.data.length);
sel.removeAllRanges();
sel.addRange(_82);
this.saveSelectionIE(sel);
}
}
}
},addCallback:function(_85,_86){
this.eventHandles[_85]=_86;
},printDebug:function(msg){
if(dojo.config.isDebug){
var d=new Date();
if(console.debug){
console.debug("["+d.toLocaleTimeString()+"."+d.getMilliseconds()+"] MentionsHelper: "+msg);
}else{
console.log("["+d.toLocaleTimeString()+"."+d.getMilliseconds()+"] MentionsHelper: "+msg);
}
}
},simulateKeyPressEvent:function(el,key){
var _87=document.createEvent("KeyboardEvent");
var _88=typeof _87.initKeyboardEvent!=="undefined"?"initKeyboardEvent":"initKeyEvent";
_87[_88]("keypress",false,false,window,false,false,false,false,key,0);
el.dispatchEvent(_87);
},setAriaLabel:function(_89,_8a){
if(!this.ariaLabel){
this.ariaLabel=dojo.create("div",{id:"mentionsAria_"+this.idx,"aria-label":"What do you want to share?","aria-live":"polite","aria-atomic":"true",style:"position: absolute; top:-9999px"});
if(dojo.isIE){
dojo.style(this.ariaLabel,{position:"absolute",top:"-9999px"});
}
}
this.ariaLabel[dojo.isIE?"innerText":"innerHTML"]=(_8a?dojo.string.substitute(_89,_8a):_89)||"";
},preventDefault:function(e){
e.preventDefault();
if(dojo.isIE>8){
window.event.returnValue=false;
}
},handleLegacyFF_EmptyNode:function(_8b){
if(dojo.isFF<4&&this.textAreaNode.childNodes.length==1){
var _8c=this.textAreaNode.childNodes[0];
if(_8b.startContainer==_8c&&_8c.nodeType==3&&_8c.data=="\n"){
var _8d=document.createTextNode(" ");
this.replaceBlank=true;
this.textAreaNode.appendChild(_8d);
this.textAreaNode.removeChild(this.textAreaNode.childNodes[0]);
_8b.setStart(_8d,1);
_8b.setEnd(_8d,1);
}
}else{
this.replaceBlank=false;
}
return _8b;
},skipBlankSpaces:function(_8e){
while(_8e&&_8e.nodeType==3&&(_8e.data==""||_8e.data=="\u200b")){
_8e=_8e.previousSibling;
}
return _8e;
}});
}


;if(!dojo._hasResource["lconn.core.widget.mentions.MentionsKeyHandlers"]){
dojo._hasResource["lconn.core.widget.mentions.MentionsKeyHandlers"]=true;
dojo.provide("lconn.core.widget.mentions.MentionsKeyHandlers");


dojo.declare("lconn.core.widget.mentions.MentionsKeyHandlers",null,{hasNoKeyModifiers:function(e){
return !e.shiftKey&&!e.ctrlKey&&!e.altKey&&!e.metaKey;
},canActivate:function(_1){
var _2=_1.charCodeAt(0);
return !this._isTracking&&(_2==32||_2==160||_1==""||_1=="\u200b"||_1=="NaN");
},handleActivatorKey:function(e){
var _3=this.getSelection();
if(dojo.isIE==8){
if(_3.range.startOffset==0){
try{
_3.selection.refresh();
_3.range.refresh();
}
catch(err){
}
}
}
var _4=_3.selection;
var _5=_3.range;
var _6=_5.startOffset;
var _7=_5.endOffset;
var _8=this.textAreaNode;
var _9=_8.childNodes;
if(_5.startContainer!=_5.endContainer||_5.startOffset!=_5.endOffset){
this.removeSelection(null,_5);
}
if(_5.startContainer==_8&&_9.length>0){
var _a=(_6>0)?_9[_6-1]:_9[0];
if(_a.nodeName=="BR"){
var _b=_a.nextSibling;
if(_b&&_b.nodeType!=3){
_a=_8.insertBefore(document.createTextNode(""),_b);
}else{
_a=_b;
}
}
if(_a){
_5=this.updateRange(_a,_a.data.length).nodeRange;
_6=_5.startOffset;
_4.removeAllRanges();
_4.addRange(_5);
}
}
var _c=this.getRangeText(_5);
if(e.type=="compositionupdate"){
_c=_c.slice(0,_c.length-1);
}
var _d="";
if(_c&&!(dojo.isIE&&_c=="\u200b")){
_d=_c.substring(_6-1,_6);
}else{
var _e=this.skipBlankSpaces(_5.startContainer);
if(_e&&_e.nodeType==3){
_d=_e.data.substring(_e.data.length-1);
}
}
if(this.canActivate(_d)){
this.preventDefault(e);
this.addTrack();
this.saveSelectionIE(_4);
return true;
}else{
return false;
}
},isLeftArrow:function(e){
return e.charCode==0&&e.keyCode==dojo.keys.LEFT_ARROW;
},moveToPrevious:function(_f,_10){
var _11=_f.startOffset;
var _12=null;
if(_10!=this.textAreaNode){
if(this.isAnyMentionsDomNode(_f.startContainer)){
this._currentNode=this.getNodeAttributes(_f.startContainer.id);
if(dojo.isIE&&window.rangy){
_f.selectNode(_f.startContainer);
}else{
var _13=_10.getElementsByTagName("a")[0].firstChild;
_f.setStart(_13,0);
_f.setEnd(_13,_13.data.length);
}
}else{
if(_10&&_10.nodeName=="BR"){
_12=_10.previousSibling;
}else{
if(_10&&_10.nodeType==3&&_10.parentNode==this.textAreaNode){
var _14=dojo.isIE?(!_10.previousSibling)||(_10.previousSibling&&!this.isMentionsDomNode(_10.previousSibling)):true;
if(_14&&(_11==0||_10.data==""||_10.data=="\u200b")){
_12=this.skipBlankSpaces(_10.previousSibling);
if(_12&&_12.nodeName=="BR"){
_12=_12.previousSibling;
}
}else{
var _15=_11-1;
_f.setStart(_f.startContainer,_15);
_f.setEnd(_f.startContainer,_15);
if(dojo.isIE>7&&_15==0){
if(dojo.isIE==8){
var _16=_10;
while(_16.previousSibling&&_16.previousSibling.nodeType==3){
_16=_16.previousSibling;
}
if(_16.previousSibling&&this.isMentionsDomNode(_16.previousSibling)){
_10=_16.previousSibling;
}
}
if(_10.previousSibling&&this.isMentionsDomNode(_10.previousSibling)){
_10=_10.previousSibling;
}
_f=this.moveToPrevious(_f,_10);
}
}
}else{
if(_10&&_10.nodeType==3&&_10.parentNode){
var _17=this.getNodeAttributes(_10.parentNode.parentNode.id);
if(this.isAnyMentionsDomNode(_10.parentNode.parentNode)&&this._currentNode!=_17){
this._currentNode=_17;
if(dojo.isIE&&window.rangy){
if(dojo.isIE>7){
var _18=this.getTextNode(_17.domNode);
_f.setStart(_18,0);
_f.setEnd(_18,_18.data.length);
}else{
_f.selectNode(_17.domNode);
}
}else{
var _13=_17.domNode.getElementsByTagName("a")[0].firstChild;
_f.setStart(_13,0);
_f.setEnd(_13,_13.data.length);
}
}else{
var _19=_10;
var _12=_19?_19.previousSibling:null;
while(!_12&&_19){
if(_19==this.textAreaNode){
break;
}
_19=_19.parentNode;
_12=_19?_19.previousSibling:null;
}
}
}else{
var _19=_10;
var _12=_19?_19.previousSibling:null;
while(!_12&&_19){
if(_19==this.textAreaNode){
break;
}
_19=_19.parentNode;
_12=_19?_19.previousSibling:null;
}
}
}
}
}
if(_12){
if(_12.nodeType==3){
this._currentNode=null;
_f.setStart(_12,_12.data.length);
_f.setEnd(_12,_12.data.length);
}else{
if(_12.nodeName=="BR"){
_f=this.moveToPrevious(_f,_12);
}else{
if(this.isAnyMentionsDomNode(_12)){
this._currentNode=this.findTrackedMentionById(_12.id);
if(dojo.isIE&&window.rangy){
var _18=_12.className=="vcard"?this.skipBlankSpaces(_10.previousSibling):this.getTextNode(_10);
_f.setStartBefore(_18.nextSibling,0);
_f.setEndBefore(_18.nextSibling,0);
}else{
if(_10.previousSibling.className=="vcard"){
_12=_10.previousSibling;
}else{
_12=_10;
}
_f.setStartBefore(_12,0);
_f.setEndBefore(_12,0);
_12=_10;
}
}
}
}
}
}else{
if(!dojo.isIE){
var _1a=null;
if(_f.startOffset==_f.endOffset){
var _1b=this.textAreaNode.childNodes.length;
if(_f.startOffset==0){
_1a=this.textAreaNode.childNodes[0];
}else{
if(_f.endOffset>=_1b){
_1a=this.textAreaNode.childNodes[_1b-1];
if(_1a.nodeType==3){
_f.setStart(_1a,_1a.data.length);
_f.setEnd(_1a,_1a.data.length);
}
}else{
_1a=this.textAreaNode.childNodes[_f.endOffset-1];
}
}
}else{
_1a=this.textAreaNode.childNodes[_f.startOffset];
}
if(_1a){
_f=this.moveToPrevious(_f,_1a);
}
}
}
return _f;
},moveToNext:function(_1c,_1d){
var _1e=_1c.startOffset;
var _1f=null;
if(_1d!=this.textAreaNode){
if(this.isAnyMentionsDomNode(_1c.startContainer)){
this._currentNode=this.getNodeAttributes(_1c.startContainer.id);
if(dojo.isIE&&window.rangy){
_1c.selectNode(_1c.startContainer);
}else{
var _20=_1d.getElementsByTagName("a")[0].firstChild;
_1c.setStart(_20,0);
_1c.setEnd(_20,_20.data.length);
}
}else{
if(_1d&&_1d.nodeName=="BR"){
_1f=_1d.nextSibling;
}else{
if(_1d&&_1d.nodeType==3&&_1d.parentNode==this.textAreaNode){
if(_1e==_1d.data.length||_1d.data==""||_1d.data=="\u200b"){
_1f=_1d.nextSibling;
while(_1f&&_1f.nodeType==3&&(_1f.data==""||_1f.data=="\u200b")){
_1f=_1f.nextSibling;
}
if(_1f&&_1f.nodeName=="BR"){
_1f=_1f.nextSibling;
}
}else{
_1c.setStart(_1c.startContainer,_1e+1);
_1c.setEnd(_1c.startContainer,_1e+1);
}
}else{
if(_1d&&_1d.nodeType==3&&_1d.parentNode){
var _21=this.getNodeAttributes(_1d.parentNode.parentNode.id);
if(this.isAnyMentionsDomNode(_1d.parentNode.parentNode)&&this._currentNode!=_21){
this._currentNode=_21;
if(dojo.isIE&&window.rangy){
_1c.selectNode(_21.domNode);
}else{
var _20=_21.domNode.getElementsByTagName("a")[0].firstChild;
_1c.setStart(_20,0);
_1c.setEnd(_20,_20.data.length);
}
}else{
var _22=_1d;
var _1f=_22?_22.nextSibling:null;
while(_22&&_22.parentNode!=this.textAreaNode){
_22=_22.parentNode;
_1f=_22?_22.nextSibling:null;
}
}
}else{
var _22=_1d;
var _1f=_22?_22.nextSibling:null;
while(_22&&_22.parentNode!=this.textAreaNode){
_22=_22.parentNode;
_1f=_22?_22.nextSibling:null;
}
}
}
}
}
if(_1f){
if(_1f.nodeType==3){
this._currentNode=null;
var _23=_1d.parentNode;
var _24=false;
if(dojo.isWebKit&&_23&&_23.parentNode&&this.isAnyMentionsDomNode(_23.parentNode)){
_24=true;
}
var pos=(_1f.data.charAt(0)=="\u200b"||(dojo.isWebKit&&!_24))?1:0;
_1c.setStart(_1f,pos);
_1c.setEnd(_1f,pos);
}else{
if(_1f.nodeName=="BR"){
_1c=this.moveToNext(_1c,_1f);
}else{
if(this.isAnyMentionsDomNode(_1f)){
this._currentNode=this.getNodeAttributes(_1f.id);
if(dojo.isIE&&window.rangy){
if(dojo.isIE>7){
var _25;
if(_1d.nextSibling.className=="vcard"){
_25=this.getTextNode(_1d.nextSibling);
}else{
_25=this.getTextNode(_1d);
}
_1c.setStartAfter(_25,0);
_1c.setEndAfter(_25,0);
_25=this.getTextNode(_1d);
}else{
_1c.selectNode(_1f);
}
}else{
if(_1d.nextSibling.className=="vcard"){
_1f=_1d.nextSibling;
}else{
_1f=_1d;
}
_1c.setStartAfter(_1f,0);
_1c.setEndAfter(_1f,0);
_1f=_1d;
}
}
}
}
}
}else{
if(!dojo.isIE){
var _26=null;
var _27=this.textAreaNode.childNodes.length;
if(_1c.endOffset>=_27){
_26=null;
}else{
var _28=_1c.endOffset-1;
if(_28>0){
_26=this.textAreaNode.childNodes[_28];
}else{
_26=this.textAreaNode.childNodes[0];
_1c.setStart(_26,0);
_1c.setEnd(_26,0);
}
}
if(_26){
_1c=this.moveToNext(_1c,_26);
}
}
}
return _1c;
},handleLeftArrowMain:function(e){
if(!e.shiftKey&&!e.ctrlKey){
this.preventDefault(e);
var _29=this.getSelection();
var sel=_29.selection;
var _2a=_29.range;
if(!_2a.collapsed){
if(dojo.isFF){
sel.collapseToStart();
}
_2a.collapse(true);
}
var _2b="";
var _2c="";
if(_2a.startContainer.nodeType==3){
_2b=_2a.startContainer.data;
_2c=_2b.replace("/200","");
}
var _2d=_2a.startOffset-(_2b.length-_2c.length);
var _2e=_2a.endOffset-(_2b.length-_2c.length);
if(this._isTracking){
var _2f=this._currentNode.getTextNode();
var _30=_2a.cloneRange();
_30.setStart(_2f,1);
_30.setEnd(_2f,_2f.data.length);
compareStartPoints=_2a.compareBoundaryPoints(Range.START_TO_START,_30);
compareEndPoints=_2a.compareBoundaryPoints(Range.END_TO_END,_30);
if(compareStartPoints!=0){
_2a.setStart(_2a.startContainer,_2d-1);
_2a.setEnd(_2a.endContainer,_2e-1);
}
}else{
_2a=this.moveToPrevious(_2a,_2a.startContainer);
}
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_2a);
}else{
sel.removeAllRanges();
sel.addRange(_2a);
}
this.saveSelectionIE(sel);
this.getSelection();
}else{
if(dojo.isIE){
setTimeout(dojo.hitch(this,function(){
var _31=this.getSelection();
_31.selection.refresh();
this._rangySelection=_31.selection;
},50));
}
}
},isRightArrow:function(e){
return e.charCode==0&&e.keyCode==dojo.keys.RIGHT_ARROW;
},handleRightArrowMain:function(e){
if(!e.shiftKey&&!e.ctrlKey){
this.preventDefault(e);
var _32=this.getSelection();
var sel=_32.selection;
var _33=_32.range;
if(!_33.collapsed){
if(dojo.isFF){
sel.collapseToEnd();
}
_33.collapse(false);
}
var _34="";
var _35="";
if(_33.startContainer.nodeType==3){
_34=_33.startContainer.data;
_35=_34.replace("/200","");
}
var _36=_33.startOffset-(_34.length-_35.length);
var _37=_33.endOffset-(_34.length-_35.length);
if(!e.shiftKey){
_33.collapse(true);
}
if(this._isTracking){
var _38=this._currentNode.getTextNode();
var _39=_33.cloneRange();
_39.setStart(_38,0);
_39.setEnd(_38,_38.data.length);
compareStartPoints=_33.compareBoundaryPoints(Range.START_TO_START,_39);
compareEndPoints=_33.compareBoundaryPoints(Range.END_TO_END,_39);
if(compareEndPoints!=0){
_33.setStart(_33.startContainer,_36+1);
_33.setEnd(_33.endContainer,_37+1);
}
}else{
_33=this.moveToNext(_33,_33.startContainer);
}
if(_33){
sel.removeAllRanges();
sel.addRange(_33);
this.saveSelectionIE(sel);
this.getSelection();
}
}else{
if(dojo.isIE){
setTimeout(dojo.hitch(this,function(){
var _3a=this.getSelection();
_3a.selection.refresh();
this._rangySelection=_3a.selection;
},50));
}
}
},isEscape:function(e){
return (e.charCode==0&&e.keyCode==dojo.keys.ESCAPE)||(dojo.isIE>8&&e.charCode==dojo.keys.ESCAPE&&e.keyCode==dojo.keys.ESCAPE);
},handleEscape:function(e){
if(this._isTracking){
this.convertMentionNodeToText(this._currentNode);
this.stopTrack(e);
e.cancelBubble=true;
if(e.stopPropagation){
e.stopPropagation();
}
this.cancelEvent(e);
}
},isTab:function(e){
return e.charCode==0&&e.keyCode==dojo.keys.TAB;
},handleTab:function(e){
if(this._isTracking){
}
},isBoldHotkey:function(e){
return e.keyCode==66&&(e.ctrlKey||e.metaKey);
},isItalicsHotkey:function(e){
return e.keyCode==73&&(e.ctrlKey||e.metaKey);
},isUnderlineHotkey:function(e){
return e.keyCode==85&&(e.ctrlKey||e.metaKey);
},isPasteHotkey:function(e){
return (e.keyCode==86||e.keyCode==118||e.charCode==86||e.charCode==118)&&(e.ctrlKey||e.metaKey)||(e.shiftKey&&e.keyCode==45);
},handlePrePaste:function(e){
if(dojo.isIE){
var _3b=(this.textAreaNode.innerText=="");
this.preventDefault(e);
this.tempTextArea.value=clipboardData.getData("Text");
if(_3b){
this.setText("");
if(dojo.isIE==8){
this._rangySelection=null;
}
}
}
var _3c=this.getSelection();
var sel=_3c.selection;
var _3d=_3c.range;
if((dojo.isWebKit||dojo.isIE)&&this.textAreaNode.childNodes.length==0){
var t=document.createTextNode("\u200b");
this.textAreaNode.appendChild(t);
_3d.setStart(t,1);
_3d.setEnd(t,1);
sel.removeAllRanges();
sel.addRange(_3d);
this.saveSelectionIE(sel);
}
this._prePasteSel=sel;
this._prePasteRange=_3d;
if(dojo.isWebKit){
this.tempTextArea.value=e.clipboardData?e.clipboardData.getData("text/plain"):"";
}else{
if(!dojo.isIE){
dojo.style(this.tempTextArea,{visibility:"visible"});
this._isPasteFocusLoss=true;
this.tempTextArea.focus();
}
}
if(this._postPasteTimeout){
clearTimeout(this._postPasteTimeout);
this._postPasteTimeout=null;
}
this._postPasteTimeout=setTimeout(dojo.hitch(this,this.postPaste),50);
},isBackspace:function(e){
return e.charCode==0&&e.keyCode==dojo.keys.BACKSPACE;
},handleBackspace:function(e){
var _3e=this.getSelection();
var sel=_3e.selection;
var _3f=_3e.range;
var _40=_3f.startContainer;
this.convertMentionNodeToText(this._currentNode);
this.stopTrack(e);
this.closeTypeahead();
e.cancelBubble=true;
if(e.stopPropagation){
e.stopPropagation();
}
this.cancelEvent(e);
},isDelete:function(e){
return (e.charCode==0&&e.keyCode==dojo.keys.DELETE)||(dojo.isMac&&e.ctrlKey&&(e.charCode==100||e.keyCode==68))||(e.keyCode==46&&e.keyChar!="."&&!(dojo.isIE==8));
},isSpace:function(e){
return (e.charCode||e.keyCode)==dojo.keys.SPACE&&this._isTracking;
},isCtrlEnter:function(e){
return (e.ctrlKey&&e.charCode==0&&e.keyCode==dojo.keys.ENTER)||e.keyCode==10;
},isEnter:function(e){
return !e.ctrlKey&&!e.metaKey&&((e.charCode==0&&e.keyCode==dojo.keys.ENTER)||(dojo.isIE>8&&e.charCode==dojo.keys.ENTER&&e.keyCode==dojo.keys.ENTER));
},isTrackedKey:function(e){
return this._isTracking&&((e.ctrlKey&&e.altKey&&e.charCode!=0)||(!e.ctrlKey&&!e.metaKey&&!(e.altKey&&e.keyCode==18)&&!(e.shiftKey&&e.keyCode==16)&&(e.charCode!=0||e.data!=null)))&&!(e.keyCode==33||e.keyCode==34||e.keyCode==35||e.keyCode==36);
},isUpDownArrow:function(e){
return e.charCode==0&&(e.keyCode==dojo.keys.UP_ARROW||e.keyCode==dojo.keys.DOWN_ARROW);
},handleUpDownArrow:function(e){
if(this._isTracking&&e){
this.preventDefault(e);
if(this.getActiveType_IsShowing()){
this.getActiveType_Field()._onKey(e);
var _41=this.getActiveType_Popup().getHighlightedOption();
_41&&dojo.attr(this.textAreaNode,"aria-activedescendant",_41.id);
}
}else{
if(dojo.isIE){
setTimeout(dojo.hitch(this,function(){
var _42=this.getSelection();
_42.selection.refresh();
this._rangySelection=_42.selection;
},50));
}
}
}});
}


;if(!dojo._hasResource["lconn.core.widget.mentions.MentionsTypeaheadUtils"]){
dojo._hasResource["lconn.core.widget.mentions.MentionsTypeaheadUtils"]=true;
dojo.provide("lconn.core.widget.mentions.MentionsTypeaheadUtils");
dojo.declare("lconn.core.widget.mentions.MentionsTypeaheadUtils",null,{_registeredTypes:null,_activeType:null,registerActivatorType:function(_1){
if(!this._registeredTypes){
this._registeredTypes=[];
}
var _2=dojo.some(this._registeredTypes,function(_3){
return _3._type==_1._type;
});
if(!_2){
this._registeredTypes.push(_1);
var _4=_1.templateClass;
if(!dojo.exists(_4)){
dojo.require(_4);
}
}else{
this.printDebug("Type: "+_1._type+" has already been registered, please remove existing registration.");
}
},unregisterActivatorType:function(_5){
var _6=[];
dojo.forEach(this._registeredTypes,function(_7,i){
if(_7._type==_5){
_6.push(i);
}
});
for(i=0;i<_6.length;i++){
var _8=this._registeredTypes.splice(_6[i],1);
_8.destroy();
}
},isTrackedKeyCode:function(e){
var _9=false;
var _a=null;
var _b=this;
if(e.keyCode==16){
e.charCode=58;
}
if(!this._isTracking&&(e.charCode||e.keyCode)&&e.charCode!=dojo.keys.SPACE&&e.keyCode!=dojo.keys.ENTER){
this._lastActivatorTrack+=String.fromCharCode(e.charCode);
}else{
if(e.keyCode!=(dojo.keys.BACKSPACE||dojo.keys.DELETE)){
var _c=this.getSelection();
var _d=_c.selection;
var _e=_c.range;
var _f=_e.endContainer;
var _10=null;
while(_f&&_f.nodeType==3&&_f.parentNode==this.textAreaNode&&_f.data==""&&this.textAreaNode.childNodes.length>0){
_10=_f.previousSibling;
this.textAreaNode.removeChild(_f);
_f=_10;
}
var _11;
if(!this.disableURLPreview){
var _12=_f&&_f.data=="\u200b"&&_f.previousSibling&&_f.previousSibling.data?_f.previousSibling:_f;
_11=this.detectURL(_12);
}
if(_11&&_11!=this.textAreaNode&&_11.parentNode!=null){
_e.setStartAfter(_11);
_e.setEndAfter(_11);
_d.removeAllRanges();
_d.addRange(_e);
this.saveSelectionIE(_d);
}
this._lastActivatorTrack="";
}
}
if(!this.disableMentions&&this._registeredTypes){
dojo.some(this._registeredTypes,function(_13){
if(_b.enableActivateAnyKey){
_9=!(((e.ctrlKey||e.metaKey)&&!e.altKey&&e.charCode!=0)||_b.isRightArrow(e)||(e.charCode||e.keyCode)==dojo.keys.SPACE||_b.isLeftArrow(e)||_b.isRightArrow(e)||_b.isUpDownArrow(e)||_b.isEscape(e)||_b.isTab(e)||_b.isBoldHotkey(e)||_b.isItalicsHotkey(e)||_b.isUnderlineHotkey(e)||_b.isPasteHotkey(e)||_b.isBackspace(e)||_b.isDelete(e)||_b.isCtrlEnter(e)&&_b.isEnter(e));
}else{
if(_13._activatorChar){
_9=(e.charCode||e.keyCode)==_13._activatorChar.charCodeAt(0);
}else{
if(_13._activatorString){
isTrackedString=(_13._activatorString==this._lastActivatorTrack);
}
}
}
if(_9){
_a=_13;
return true;
}else{
_a=null;
}
});
if(_a){
if(this._activeSelectMouseEvent){
dojo.disconnect(this._activeSelectMouseEvent);
}
this._activeType=_a;
this._activeSelectMouseEvent=dojo.connect(this.getActiveType_Field(),"_selectOption",this,this.selectOption);
}
}
return _9;
},handleActiveType_KeyPress:function(e){
},handleActiveType_HideResults:function(){
if(this._activeType){
this._activeType.hideResults();
}
},handleTypeaheadKeyInput:function(){
var pw=this.getActiveType_Popup();
if(pw){
var _14=this._currentNode;
var _15=_14.value;
var _16=pw.getHighlightedOption();
if(_16){
var _17=this.getActiveType_Field().id;
var _18=pw.items[_16.getAttribute("item")];
if(_18){
if(dojo.indexOf([_17+"_popup_searchDir",_17+"_popup_resultsNode"],_16.id)===-1){
this.completeMention(_18);
this.textAreaNode.scrollTop=_14.domNode.offsetTop-this.textAreaNode.offsetTop;
}
}else{
if(_16.id==(_17+"_popup_searchDir")){
pw.searchDirectory();
pw._blurOptionNode();
}
}
}else{
this.handleUpDownArrow();
}
}
},getActiveType_VOffset:function(){
return this._activeType&&dojo.isFunction(this._activeType.getVOffset)&&this._activeType.getVOffset()||0;
},getActiveType_Field:function(){
return this._activeType&&dojo.isFunction(this._activeType.getTypeaheadField)?this._activeType.getTypeaheadField():null;
},getActiveType_Popup:function(){
return this._activeType?this._activeType.getTypeaheadPopup():null;
},getActiveType_Results:function(){
return this._activeType?this._activeType.getTypeaheadResults():null;
},getActiveType_IsShowing:function(){
return this._activeType?this.getActiveType_Field()._opened:false;
},getActiveType_NodeTemplateClass:function(){
return this._activeType?this._activeType.templateClass:null;
},setActiveType_FieldValue:function(_19){
if(this._activeType){
this._activeType.setTypeaheadValue(_19);
}
}});
}


;dojo.cache("lconn.core", "widget/mentions/templates/MentionsNode.html", "<span class=\"vcard\" type=\"${className}\" id=\"mentionsNode_${idx}\" tabindex=\"-1\"><a dojoAttachPoint=\"linkNode\" class=\"fn lotusPerson hasHover\">${value}</a></span>");

;if(!dojo._hasResource["lconn.core.widget.mentions.MentionsNode"]){
dojo._hasResource["lconn.core.widget.mentions.MentionsNode"]=true;
dojo.provide("lconn.core.widget.mentions.MentionsNode");






(function(){
var _1="mentions";
dojo.declare("lconn.core.widget.mentions.MentionsNode",[dijit._Widget,dijit._Templated],{templatePath:dojo.moduleUrl("lconn.core","widget/mentions/templates/MentionsNode.html"),widgetsInTemplate:false,idx:0,symbol:"@",bidiSymbol:function(){
var _2=lconn.core.globalization.bidiUtil.isRTLValue(this.value);
return !dojo.isBodyLtr()&&!_2?lconn.core.globalization.bidiUtil.enforceTextDirection(this.symbol,"ltr"):this.symbol;
},type:_1,value:"",data:"",isComplete:false,textRange:null,constructor:function(_3){
if(_3){
dojo.safeMixin(this,_3);
}
this.className="MentionsNode";
},postCreate:function(){
this.inherited(arguments);
this.setValue(this.value);
dojo.connect(this.textAreaNode,"ondrop",this,this.cancelEvent);
dojo.connect(this.textAreaNode,"ondragover",this,this.cancelEvent);
dojo.connect(this.domNode,"onresizestart",this,this.preventResize);
},preventResize:function(e){
return false;
},disableBizCardFocus:function(e){
var _4=dojo.attr(this.domNode.parentNode,"disableBizCardFocus");
if(_4){
e.preventDefault();
this.domNode.parentNode.focus();
}
},cancelEvent:function(e){
e.preventDefault();
return false;
},setValue:function(_5){
this.value=_5;
if(dojo.isIE){
this.linkNode.innerText=this.value;
}else{
this.linkNode.innerHTML=this.value;
}
},setData:function(_6){
this.data=_6;
},setTextRange:function(_7){
this.textRange=_7;
},setComplete:function(_8){
this.isComplete=_8;
dojo.attr(this.domNode,"contentEditable",!_8);
dojo.forEach(this.domNode.childNodes,function(_9,i){
if(_9&&_9.nodeType=="1"){
dojo.attr(_9,"contentEditable",!_8);
}
});
},toString:function(){
return this.value;
},toJsonString:function(){
return {type:this.type,value:this.value,data:this.data};
},getTextNode:function(){
if(this.linkNode){
return this.linkNode.firstChild;
}else{
return null;
}
},getLinkValueNode:function(){
var _a=null;
for(i=0;i<this.linkNode.childNodes.length;i++){
var _b=this.linkNode.childNodes[i];
if(_b.nodeType==3){
_a=_b;
}
}
return _a;
}});
lconn.core.widget.mentions.MentionsNode.TYPE=_1;
})();
}


;dojo.cache("lconn.core", "widget/mentions/templates/URLMentionsNode.html", "<span type=\"${className}\" id=\"mentionsNode_${idx}\" tabindex=\"-1\"><a dojoAttachPoint=\"linkNode\">${value}</a></span>");

;if(!dojo._hasResource["lconn.core.widget.mentions.URLMentionsNode"]){
dojo._hasResource["lconn.core.widget.mentions.URLMentionsNode"]=true;
dojo.provide("lconn.core.widget.mentions.URLMentionsNode");






(function(){
var _1="URLMentions";
dojo.declare("lconn.core.widget.mentions.URLMentionsNode",[lconn.core.widget.mentions.MentionsNode],{templatePath:dojo.moduleUrl("lconn.core","widget/mentions/templates/URLMentionsNode.html"),_hasSymbol:false,symbol:"",type:_1,hasPreview:false,constructor:function(_2){
this.className="URLMentionsNode";
},setValue:function(_3){
this.value=_3;
if(dojo.isIE){
this.linkNode.innerText=this.value;
}else{
this.linkNode.innerHTML=this.value;
}
var _4=this.value;
if(this.value.indexOf("://")==-1){
_4="http:"+"//"+_4;
}
this.href=_4;
dojo.attr(this.linkNode,"class","");
dojo.attr(this.linkNode,"target","_blank");
dojo.attr(this.linkNode,"href",_4);
},toJsonString:function(){
return {type:this.type,value:this.value,hasSymbol:this._hasSymbol,hasPreview:this.hasPreview,previewData:(this.previewNode&&this.previewNode.data)?this.previewNode.data:"",href:this.href};
}});
lconn.core.widget.mentions.URLMentionsNode.TYPE=_1;
})();
}


;if(!dojo._hasResource["lconn.core.widget.mentions.URLPreviewMixin"]){
dojo._hasResource["lconn.core.widget.mentions.URLPreviewMixin"]=true;
dojo.provide("lconn.core.widget.mentions.URLPreviewMixin");




(function(){
var _1=/\b(?:(?:https?|ftp|file):\/\/|www\.|ftp\.)(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/gim;
dojo.declare("lconn.core.widget.mentions.URLPreviewMixin",null,{disableURLPreview:false,matchURL:function(_2){
return _2.match(_1);
},detectURL:function(_3){
var _4=_3;
if(!this.disableURLPreview&&_3&&_3.nodeType==3&&this.textAreaNode!=null&&_3.parentNode==this.textAreaNode){
var _5=null;
var _6=_3.data;
if(_6){
var _7=this.matchURL(_6);
if(_7&&_7.length>0){
for(i=0;i<_7.length;i++){
_5=_6.split(_7[i],2);
this.textAreaNode.insertBefore(document.createTextNode(_5[0]),_3);
var _8=document.createElement("span");
_8.id=this.textAreaNode.id+"_mentionsNode_"+this._idx;
this.textAreaNode.insertBefore(_8,_3);
urlMentionsNode=new lconn.core.widget.mentions.URLMentionsNode({idx:this._idx},_8.id);
urlMentionsNode.setValue(_7[i]);
urlMentionsNode.setComplete(true);
this._idx++;
this._trackedMentions.push(urlMentionsNode);
_4=urlMentionsNode.domNode;
_6=_5[1];
if(i==_7.length-1&&_6){
this.textAreaNode.insertBefore(document.createTextNode(_6),_3);
}
}
_4=_3.previousSibling;
this.textAreaNode.removeChild(_3);
for(i=0;i<_7.length;i++){
dojo.publish("lconn/core/mentions/url/entered",[{url:_7[i],mentionsHelper:this}]);
}
}else{
if(_7&&_7[0]){
var _8=document.createElement("span");
_8.id=this.textAreaNode.id+"_mentionsNode_"+this._idx;
this.textAreaNode.replaceChild(_8,_3);
_4=new lconn.core.widget.mentions.MentionsNode({idx:this._idx},_8.id);
_4.setValue(_7[0]);
this._idx++;
this._trackedMentions.push(_4);
_4=_4.domNode;
}else{
_4=null;
}
}
}
if(_4&&_4!=_3){
var _9,_a=null;
if(dojo.isWebKit||dojo.isIE){
_9=document.createTextNode("\u200b");
_a=document.createTextNode("\u200b");
}else{
_9=document.createTextNode("");
_a=document.createTextNode("");
}
if(!_4.previousSibling){
this.textAreaNode.insertBefore(_9,_4);
}
if(!_4.nextSibling){
this.textAreaNode.insertBefore(_a,_4.nextSibling);
_4=_a;
}else{
if(_4.nodeType!=3){
_4=_4.nextSibling;
if(dojo.isWebKit||dojo.isIE){
if(_4.nodeType==3&&_4.data!="\u200b"){
_4.data="\u200b";
}
}
}
}
}
}
return _4;
},removeURLPreview:function(){
if(this._urlPreview){
this._urlPreview.destroy();
this._urlPreview=null;
}
if(this._urlPreviewNode){
this._urlPreviewNode.hasPreview=false;
this._urlPreviewNode.previewNode=null;
this._urlPreviewNode=null;
}
}});
})();
}


;if(!dojo._hasResource["lconn.core.widget.mentions.MentionsHelper"]){
dojo._hasResource["lconn.core.widget.mentions.MentionsHelper"]=true;
dojo.provide("lconn.core.widget.mentions.MentionsHelper");














dojo.requireLocalization("com.ibm.social.ublog","Mentions");
(function(_1){
function _2(_3){
return dijit.getWaiState(_3,"describedby")==="semtagmenu";
};
var _4=!!navigator.userAgent.match(/Trident\/7\./);
dojo.declare("lconn.core.widget.mentions.MentionsHelper",[lconn.core.widget.mentions.MentionsUtils,lconn.core.widget.mentions.MentionsKeyHandlers,lconn.core.widget.mentions.MentionsTypeaheadUtils,lconn.core.widget.mentions.URLPreviewMixin],{MENTION_REGEX:/<[sS][pP][aA][nN] class="?vcard"?><[sS][pP][aA][nN] class="?fn"?>([^<>]+)<\/[sS][pP][aA][nN]><[sS][pP][aA][nN] class="?x-lconn-userid"?>([^<>]+)<\/[sS][pP][aA][nN]><\/[sS][pP][aA][nN]>/g,SMARTCLOUD_ENV:"SmartCloud",activatorChar:"@",bidiActivatorChar:function(_5){
var _6=lconn.core.globalization.bidiUtil.isRTLValue(_5);
return !dojo.isBodyLtr()&&!_6?lconn.core.globalization.bidiUtil.enforceTextDirection(this.activatorChar,"ltr"):this.activatorChar;
},_trackedMentions:null,_isTracking:false,_currentNode:null,_rangySelection:null,_lastActivatorTrack:"",inputField:null,eventHandles:null,multiline:false,disableBizCard:false,enableActivateAnyKey:false,disableMentions:false,_helperInstanceCounter:[0],constructor:function(_7){
if(_7){
dojo.safeMixin(this,_7);
}
this._resourceBundle=dojo.i18n.getLocalization("com.ibm.social.ublog","Mentions");
if(dojo.isIE){
try{
document.execCommand("AutoUrlDetect",false,false);
}
catch(e){
}
this.includeRangy(dojo.hitch(this,"initRangy"));
}
this._trackedMentions=[];
if(!this.eventHandles){
this.eventHandles=[];
}
this._idx=0;
this.initTypeahead();
},initRangy:function(){
if(window.rangy){
rangy.config.preferTextRange=true;
}
},initTypeahead:function(){
var _8=this._helperInstanceCounter[0]++;
this.textAreaNode=dojo.create("div",{className:"lotusText lotusMentionsDiv bidiAware",contentEditable:"true",id:"mentionstextAreaNode_"+_8,"aria-labelledby":"mentionstextAreaNode_"+_8,"data-notOpenEE":"true","data-commentInput":"true","role":"textbox","aria-multiline":"true","aria-autocomplete":"inline"});
if(dojo.isIE){
this.textAreaNode.appendChild(document.createTextNode(dojo.isIE==8?"\u200b":""));
}
if(this.isEE){
this.domNode=dojo.create("div",{id:"mentionsTypeaheadNode_"+_8,className:"lotusOffScreen"});
}else{
this.domNode=dojo.create("div",{id:"mentionsTypeaheadNode_"+_8});
}
var _9;
if(this.inputField){
_9=dojo.position(this.inputField,true);
dojo.place(this.textAreaNode,this.inputField,"before");
dojo.style(this.inputField,"display","none");
}
dojo.place(this.domNode,dojo.body());
if(_9){
dojo.style(this.domNode,{top:(_9.y+_9.h-5)+"px"});
}
this.tempTextArea=dojo.create("textarea",{style:"position: absolute; visibility: hidden; top: -9999px"});
if(dojo.isIE){
dojo.style(this.tempTextArea,{position:"absolute",visibility:"hidden",top:"-9999px"});
}
dojo.place(this.tempTextArea,this.textAreaNode,"after");
this.setAriaLabel(this.placeholder);
dojo.place(this.ariaLabel,this.textAreaNode,"after");
this.connectEvents();
dojo.subscribe("com/ibm/social/incontext/typeahead/onDisplayChange",this,"resultListOpened");
dojo.subscribe("com/ibm/social/incontext/typeahead/closeTypeahead",this,"closeTypeahead");
},closeTypeahead:function(){
this.handleActiveType_HideResults();
this.resetTypeaheadAria();
},resultListOpened:function(pw){
if(pw&&this.getActiveType_Field()&&this.getActiveType_Popup()&&pw.id==this.getActiveType_Popup().id){
var _a=pw.domNode;
dojo.attr(_a,"aria-live","polite");
dojo.attr(this.textAreaNode,"role","combobox");
dojo.attr(this.textAreaNode,"aria-autocomplete","inline");
dojo.attr(this.textAreaNode,"aria-expanded","true");
dojo.attr(this.textAreaNode,"aria-owns",this.getActiveType_Popup().id);
dojo.attr(this.textAreaNode,"aria-activedescendant",pw.id);
this.setAriaLabel("");
this.resizeTypeahead(_a);
}
},resizeTypeahead:function(_b){
var _c,_d,_e,_f,_10,_11;
var _12=this._currentNode;
if(_12){
if(this.isEE){
this.applyEEStyles(_b);
}
_e=dijit.getViewport().h;
_f=dojo.position(_12.linkNode,true);
_c=_f.y;
_d=_e-_f.y-_f.h;
_10=_b.parenNode?_b.parenNode.clientHeight:_b.clientHeight;
if(_d>_10||_d>_c){
_11=_c+_f.h;
}else{
_11=_c-_10;
if(_c<_10){
_11=2;
dojo.style(this.isEE?_b:_b.parentNode,{height:_c-_f.h+7+"px"});
}
}
dojo.style(_b.parentNode,{top:_11+"px"});
}
},applyEEStyles:function(_13){
dojo.style(_13.parentNode,{left:"15px",height:"auto",overflowY:"hidden"});
dojo.style(_13,{overflow:"auto",height:"auto"});
if(!dojo.isIE){
dojo.style(_13.parentNode,{overflow:"visible",border:""});
dojo.style(_13,{border:"",overflowX:"hidden"});
}
},mouseDownListener:function(e){
if(document.activeElement==this.textAreaNode){
this.mouseDown=true;
}
},mouseMoveListener:function(e){
if(this.mouseDown&&document.activeElement==this.textAreaNode){
if(window.LCSemTagMenu){
window.LCSemTagMenu.preventFocus=true;
}
}
},mouseUpListener:function(e){
if(this.mouseDown){
if(window.LCSemTagMenu){
window.LCSemTagMenu.preventFocus=false;
}
this.mouseDown=false;
}
},selectOption:function(){
var _14=this._currentNode;
var _15=_14.value;
var _16=this.getSelection();
var _17=_16.range;
var _18=null;
_18=this.getActiveType_Field().getItem();
if(_18){
this.completeMention(_18);
}else{
if(dojo.isIE){
this._stopBlur=true;
var _16=this.getSelection();
var sel=_16.selection;
this.saveSelectionIE(sel);
}
this.setActiveType_FieldValue(this.stringSplice(_15,0,1));
this.search();
}
},createMentionsSpan:function(_19,idx){
if(dojo.isFF<4){
var _1a=[];
dojo.forEach(this.textAreaNode.childNodes,function(_1b){
if((_1b.nodeType===3&&_1b.data==="\n")||(_1b.nodeName=="BR"&&(_1b.hasAttribute("_moz_dirty")||dojo.attr(_1b,"type")=="_moz"))){
_1a.push(_1b);
}
});
dojo.forEach(_1a,function(_1c){
this.textAreaNode.removeChild(_1c);
},this);
}
var _1d={idx:idx};
this.saveSelectionIE(sel);
var _1e=this.getSelection();
var sel=_1e.selection;
var _1f=_1e.range;
var _20=document.createElement("span");
_20.id=this.textAreaNode.id+"_mentionsNode_"+idx;
_1f.insertNode(_20);
try{
var _21=dojo.getObject(this.getActiveType_NodeTemplateClass());
if(!_21){
throw "No mention template class available";
}
var _22=new _21(_1d,_20.id);
if(dojo.isIE){
dojo.attr(_22.domNode,"unselectable","on");
}
_22.setValue(String.fromCharCode(this.trackedKeyCode));
_22.setValue("\u200b");
this.setAriaLabel(this._resourceBundle.CREATED_MENTION);
this._currentNode=_22;
var _23=_22.domNode;
if(_23){
var _24,_25=null;
if(dojo.isWebKit){
_24=document.createTextNode("\u200b");
_25=document.createTextNode("\u200b");
}else{
if(dojo.isIE>7){
if(!this._isTracking){
_24=document.createTextNode("\u200b");
_25=document.createTextNode("\u200b");
}else{
if(!!(window.event)&&window.event.keyCode==50&&window.event.ctrlKey&&window.event.altKey){
_24=document.createTextNode("");
_25=document.createTextNode("");
}else{
if(!!(window.event)&&window.event.keyCode==50){
_24=document.createTextNode("");
_25=document.createTextNode("\u200b");
}else{
_24=document.createTextNode("");
_25=document.createTextNode("\u200b");
}
}
}
}else{
_24=document.createTextNode("");
_25=document.createTextNode("");
}
}
if(!_23.previousSibling){
this.textAreaNode.insertBefore(_24,_23);
}
if(!_23.nextSibling){
this.textAreaNode.insertBefore(_25,_23.nextSibling);
}
}
_1f=this.rangeMoveToNodeEnd(_22,_1f);
sel.removeAllRanges();
sel.addRange(_1f);
return _22;
}
catch(e){
console.log(e);
}
},addTrack:function(){
this._isTracking=true;
if(dojo.isIE){
this._stopBlur=true;
var _26=this.getSelection();
var sel=_26.selection;
this.saveSelectionIE(sel);
}
this.setActiveType_FieldValue("");
var _27=this.createMentionsSpan("",this._idx);
this._idx++;
this._trackedMentions.push(_27);
this._currentNode=_27;
this.positionTypeahead();
dojo.publish("lconn/core/mentions/startTrack");
},updateTrack:function(_28){
console.log("Updating the tracking/search Value:: "+_28);
this._isTracking=true;
if(dojo.isIE){
this._stopBlur=true;
var _29=this.getSelection();
var sel=_29.selection;
this.saveSelectionIE(sel);
}
if(!this.enableActivateAnyKey){
_28=_28.substring(1,_28.length);
}
this.setActiveType_FieldValue(_28);
this.search();
},stopTrack:function(){
this._isTracking=false;
if(dojo.isIE){
this._stopBlur=true;
var _2a=this.getSelection();
var sel=_2a.selection;
this.saveSelectionIE(sel);
}
this.handleActiveType_HideResults();
this.setActiveType_FieldValue("");
this.search();
this._currentNode=null;
this.printDebug(this._trackedMentions);
dojo.publish("lconn/core/mentions/stopTrack",Array.prototype.slice.call(arguments));
},cancelMention:function(){
this.convertMentionNodeToText(this._currentNode);
this.stopTrack();
},plainTextChromeCancelMention:function(){
var _2b=this._currentNode.domNode.previousSibling;
_2b.data+=this._currentNode.value;
this.removeMentionNode(this._currentNode);
this.stopTrack();
var _2c=this.getSelection();
var sel=_2c.selection;
var _2d=_2c.range;
_2d.setStart(_2b,_2b.data.length);
_2d.setEnd(_2b,_2b.data.length);
sel.removeAllRanges();
sel.addRange(_2d);
},search:function(){
var _2e=this.getActiveType_Field();
if(_2e){
if(_2e.searchTimer){
_2e.searchTimer.remove();
_2e.searchTimer=null;
}
_2e.searchTimer=_2e.defer(dojo.hitch(_2e,_2e._startSearchFromInput),50);
}
},positionTypeahead:function(){
var _2f=this._currentNode;
if(_2f){
var pos=dojo.position(_2f.domNode,true);
if(dojo._isBodyLtr()){
dojo.style(this.getActiveType_Field().domNode,{left:pos.x+"px",top:(pos.y+pos.h-this.getActiveType_VOffset())+"px"});
}else{
var _30=dijit.getViewport().w;
var _31=_30-pos.x-pos.w;
dojo.style(this.getActiveType_Field().domNode,{right:_31+"px",top:(pos.y+pos.h-this.getActiveType_VOffset())+"px"});
}
dojo.style(this.domNode,{top:(pos.y+pos.h-5)+"px"});
}
},clickListener:function(e){
this.preventDefault(e);
this.textAreaNode.focus();
if(dojo.isFF<4){
if(this.textAreaNode.childNodes.length==0){
var t=document.createTextNode("\n");
this.textAreaNode.appendChild(t);
}
}
var _32=this.getSelection();
var sel=_32.selection;
var _33=_32.range;
if(this._isTracking){
if(!dojo.isIE){
this.handleResumeMention(sel,_33);
}else{
if(dojo.isIE&&window.rangy){
setTimeout(dojo.hitch(this,function(){
this._rangySelection=sel;
_33=sel.getRangeAt(0);
this.printDebug("After Key: "+this.getRangeText(_33)+" -- Start: "+_33.startOffset+"    End: "+_33.endOffset);
this.handleResumeMention(sel,_33);
}),50);
}
}
}else{
this._currentNode=null;
if(dojo.isIE&&window.rangy){
setTimeout(dojo.hitch(this,function(){
sel.refresh();
this._rangySelection=sel;
_33=sel.getRangeAt(0);
if(sel.anchorNode.parentNode.nodeName==("A"||"SPAN")&&sel.anchorNode.parentNode.nodeType==1){
var t=document.createTextNode("\u200b");
this.textAreaNode.appendChild(t);
_33.setStart(t,t.data.length);
_33.setEnd(t,t.data.length);
sel.removeAllRanges();
sel.addRange(_33);
this.saveSelectionIE(sel);
}
this.printDebug("After Key: "+this.getRangeText(_33)+" -- Start: "+_33.startOffset+"    End: "+_33.endOffset);
}),50);
}
}
if(this.eventHandles["onclick"]){
this.eventHandles.onclick();
}
},findNextNode:function(idx,_34){
var _35=-1;
var _36=this.textAreaNode.childNodes[idx+_34];
if(_36){
_35=_36.nodeType;
}
return {"nodeType":_35,"newNode":_36};
},getNodeAttributes:function(_37){
dojo.deprecated("MentionsHelper.getNodeAttributes","The name of this method is misleading. Use MentionsHelper.findTrackedMentionById(nodeId) instead","5.0");
return this.findTrackedMentionById(_37);
},findTrackedMentionById:function(_38){
var _39=null;
dojo.every(this._trackedMentions,function(_3a){
if(_38==_3a.id){
_39=_3a;
return false;
}
return true;
},this);
return _39;
},setValue:function(_3b){
dojo.empty(this.textAreaNode);
var _3c=dojo.toDom(_1.htmlify(_3b));
this.textAreaNode.appendChild(_3c);
},keyListener:function(e){
if((document.activeElement!=this.textAreaNode)&&(!dojo.isIE&&!dojo.keys.BACKSPACE)){
return;
}
if(dojo.isIE&&e.keyCode==20){
return;
}
var _3d=(dojo.isIE==9&&dojo.config.locale=="de-de"&&e.keyCode==16&&this._isTracking);
if(dojo.isIE&&document.selection&&this._isTracking){
var _3e=this.getSelection();
var sel=_3e.selection;
var _3f=_3e.range;
var _40,_41;
var _42=document.selection.createRange();
var _43=_42.duplicate();
_43.moveToElementText(this.textAreaNode);
_43.setEndPoint("EndToEnd",_42);
_40=_43.text.length-_42.text.length;
_41=_40+_42.text.length;
var _44=_43.text.substr(_40,_41);
if(_40!=_41){
if(_3f.startContainer&&_3f.startContainer.parentNode==this._currentNode.linkNode){
if(e.charCode>0){
this.cancelMention();
this.textAreaNode.innerHTML=this.textAreaNode.innerHTML.replace(/&nbsp;/,"");
this.textAreaNode.innerHTML=this.textAreaNode.innerHTML.replace(_44,"");
return;
}
}
}
}else{
if(this._isTracking){
var _3e=this.getSelection();
var sel=_3e.selection;
var _3f=_3e.range;
if(!_3f.collapsed){
var _45=_3f.startContainer,_46=_3f.endContainer,_47=false;
if(dojo.isChrome&&this.textAreaNode.firstChild.textContent=="\u200b"&&this.textAreaNode.firstElementChild&&this.textAreaNode.firstElementChild==this._currentNode.domNode){
_47=true;
}
if((_45.parentNode||_46.parentNode)==this._currentNode.linkNode||_47){
this._currentNode.value="";
this.cancelMention();
}
}
}
}
if(dojo.isIE&&e.keyCode==229&&e.charCode!=229||(dojo.isIE&&this._isComposition&&e.keycode!=229&&e.keyCode==dojo.keys.SPACE)){
this._isComposition=true;
this._wasComposition=false;
if(this._currentNode){
dojo.style(this._currentNode.domNode,"color","#1970b0");
}
if(this._isTracking&&this._currentNode.linkNode){
if(!this._currentNode.linkNode.nextSibling){
var _3e=this.getSelection();
var sel=_3e.selection;
sel.refresh();
this._rangySelection=sel;
_3f=sel.getRangeAt(0);
var _48=this._currentNode;
if(_3f.startContainer&&_3f.startContainer.data){
_3f.startContainer.data="";
var _49=_48.getTextNode();
_48.setTextRange(this.updateRange(_49,_49.length).nodeRange);
}
}
setTimeout(dojo.hitch(this,function(){
var _4a=(this._currentNode&&this._currentNode.linkNode&&this._currentNode.linkNode.nextSibling)?this._currentNode.linkNode.nextSibling:null;
if(_4a&&_4a.nodeType==3&&_4a.data.length>1){
if(dojo.isIE==8){
var _4b=this._currentNode.value+_4a.data.replace(/[\n\r\t]/g,"");
}else{
var _4b=this._currentNode.value+_4a.data.substring(0,_4a.data.length-1).replace(/[\n\r\t]/g,"");
}
this.updateTrack(_4b);
}
}),50);
}
}else{
if(dojo.isIE&&this._isComposition&&e.keycode!=229&&e.keyCode!=dojo.keys.SPACE){
this._wasComposition=true;
this._isComposition=false;
if(this._currentNode){
dojo.style(this._currentNode.domNode,"color","");
}
}
}
var _4c=false;
if(!this._isTracking){
_4c=this.isTrackedKeyCode(e);
if(_4c){
_4c=this.handleActivatorKey(e);
}
}
if(this.enableActivateAnyKey&&this.getActiveType_Field()&&(e.charCode||e.keyCode)==dojo.keys.SPACE&&this._isTracking&&this.getActiveType_Field().results.length<2){
this.convertMentionNodeToText(this._currentNode);
this.stopTrack();
_4c=false;
}
var _3e=this.getSelection();
var sel=_3e.selection;
var _3f=_3e.range;
if(dojo.isIE&&e.keyCode==229&&e.charCode!=229){
var _4d=this.getRangeText(_3f);
if(_4d){
_3f.startOffset=_4d.length;
_3f.endOffset=_4d.length;
if(this._isTracking){
this._currentNode.value=_4d;
this.updateTrack(_4d);
}
}
}
if(dojo.isFF<4){
_3f=this.handleLegacyFF_EmptyNode(_3f);
sel.removeAllRanges();
sel.addRange(_3f);
}
_4e=_3f.startOffset;
_4f=_3f.endOffset;
if(this.isRightArrow(e)){
if(dojo._isBodyLtr()){
this.handleRightArrowMain(e);
}else{
this.handleLeftArrowMain(e);
}
}else{
if(this.isLeftArrow(e)){
if(dojo._isBodyLtr()){
this.handleLeftArrowMain(e);
}else{
this.handleRightArrowMain(e);
}
}else{
if(this.isUpDownArrow(e)){
this.handleUpDownArrow(e);
}else{
if(this.isEscape(e)){
this.handleEscape(e);
}else{
if(this.isTab(e)){
this.handleTab(e);
}else{
if(this.isBoldHotkey(e)||this.isItalicsHotkey(e)||this.isUnderlineHotkey(e)){
this.cancelEvent(e);
}else{
if(this.isPasteHotkey(e)){
this.handlePrePaste(e);
}else{
if(this.isBackspace(e)){
if(dojo.isIE&&!this._isTracking){
sel.refresh();
}
var _48=this._currentNode;
var _4e=_3f.startOffset;
var _4f=_3f.endOffset;
if(this._isTracking){
this.preventDefault(e);
var _50=_48.value;
var _51=0;
if(_4e==_4f){
if(_4e==0&&_4f==0){
_50=this.stringSplice(_50,_4e,_50.length);
_51=_4e;
}else{
this.setAriaLabel(_50.slice(_4f-1,-1));
_50=this.stringSplice(_50,_4f-1,1);
_51=_4f-1;
}
}else{
_50=this.stringSplice(_50,_4e,_4f-_4e);
_51=_4e;
}
if(_50!=""){
_48.setValue(_50);
this.updateTrack(_48.value);
if(dojo.isIE&&window.rangy){
var _3f=rangy.createRangyRange();
_3f.setStart(_48.linkNode.firstChild,_51);
_3f.setEnd(_48.linkNode.firstChild,_51);
sel.setSingleRangeEx(_3f);
}else{
_48.setTextRange(this.updateRange(_48.linkNode,_51).nodeRange);
}
}else{
var _52=_48.domNode.previousSibling;
var _53=this.removeMentionNode(_48,true);
this.stopTrack();
_3f=this.rangeMoveToNodeStart(_53,_3f);
sel.removeAllRanges();
sel.addRange(_3f);
this.saveSelectionIE(sel);
if(dojo.isSafari){
this.safariNodeFix(_52);
}
}
}else{
if(_3f.startContainer!=this.textAreaNode){
if(_4e==_4f&&_3f.startContainer==_3f.endContainer&&_3f.startContainer.parentNode!=null){
if(_3f.startContainer.nodeValue==""||_3f.startContainer.nodeValue=="\u200b"||(dojo.indexOf(this.textAreaNode.childNodes,_3f.startContainer)>0&&_3f.startContainer.nodeType==3&&_3f.startOffset==0)){
_48=this.moveToPreviousNode(_3f.startContainer,_3f,sel);
_3e=this.getSelection();
sel=_3e.selection;
_3f=_3e.range;
_4e=_3f.startOffset;
_4f=_3f.endOffset;
if(this._currentNode){
_48=this._currentNode;
}
}
if(!_48){
var _54=_3f.startContainer;
if(_54!=this.textAreaNode){
while(_54&&_54.parentNode!=this.textAreaNode){
_54=_54.parentNode;
}
if(this.isAnyMentionsDomNode(_54)){
_48=dijit.byId(_54.id);
}
}
}
if(_48!=null&&dojo.indexOf(this._trackedMentions,_48)!=-1){
this.preventDefault(e);
this.moveToPreviousNode(_48.domNode,_3f,sel);
_3e=this.getSelection();
sel=_3e.selection;
_3f=_3e.range;
_4e=_3f.startOffset;
_4f=_3f.endOffset;
this.removeMentionNode(_48);
this._currentNode=null;
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_3f);
}else{
sel.removeAllRanges();
sel.addRange(_3f);
}
}else{
if(dojo.isIE&&_48&&_48.previousSibling){
_48=_48.previousSibling;
_4e=dojo.indexOf(this.textAreaNode.childNodes,_48);
while(_48&&_48.nodeType==3&&(_48.data==""||_48.data=="\u200b")&&_4e>0){
_4e=_4e-1;
_53=this.textAreaNode.childNodes[_4e];
if(_53){
this.textAreaNode.removeChild(_48);
_48=_53;
}
}
_4e=dojo.indexOf(this.textAreaNode.childNodes,_48);
}else{
_48=_3f.startContainer;
}
while(_48&&_48.nodeType==3&&(_48.data==""||_48.data=="\u200b")){
_48.data="";
_4e=_4e-1;
_4f=_4f-1;
_53=this.textAreaNode.childNodes[_4e];
if(_53&&_53.nodeType==3&&_53.data==""){
this.textAreaNode.removeChild(_48);
}
_48=_53;
}
if((this.multiline&&_48&&_48.nodeName=="BR")&&!(dojo.isIE==7)){
this.preventDefault(e);
var _55=_48.previousSibling;
this.textAreaNode.removeChild(_48);
}else{
if(dojo.isIE>7&&_48&&_48.nodeType==3&&_3f.startOffset==1&&_3f.endOffset==1&&_48.data.charAt(0)=="\u200b"){
_48=this.moveToPreviousNode(_48,_3f,sel);
_3e=this.getSelection();
sel=_3e.selection;
_3f=_3e.range;
_4e=_3f.startOffset;
_4f=_3f.endOffset;
if(this.isAnyMentionsDomNode(_48)){
this.moveToPreviousNode(_48,_3f,sel);
this.removeMentionById(_48.id);
}
this._currentNode=null;
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_3f);
}else{
sel.removeAllRanges();
sel.addRange(_3f);
}
}else{
if(dojo.isIE&&window.rangy){
setTimeout(dojo.hitch(this,function(){
sel.refresh();
this._rangySelection=sel;
_3f=sel.getRangeAt(0);
this.printDebug("After Key: "+this.getRangeText(_3f)+" -- Start: "+_3f.startOffset+"    End: "+_3f.endOffset);
}),500);
}
}
}
if(dojo.isSafari){
if(this.eventHandles["onkeypress"]){
setTimeout(dojo.hitch(this,this.eventHandles.onkeypress),50);
}
return false;
}
}
}else{
if(!dojo.isIE&&!_4){
this.removeSelection(e,_3f);
}
}
}else{
this.preventDefault(e);
_4e=_4e-1;
_4f=_4f-1;
if(_4e<0){
_4e=0;
}
if(_4f<0){
_4f=0;
}
var _48=this.textAreaNode.childNodes[_4e];
if(_4e==_4f){
while(_48&&_48.nodeType==3&&(_48.data==""||_48.data=="\u200b")){
_48.data="";
_4e=_4e-1;
_4f=_4f-1;
_53=this.textAreaNode.childNodes[_4e];
if(_53&&_53.nodeType==3&&(_53.data==""||_53.data=="\u200b")){
this.textAreaNode.removeChild(_48);
}
_48=_53;
}
if(_48!=null){
if(_48.nodeType==3){
_3f=this.updateRange(_48,_48.data.length).nodeRange;
_4f=_3f.endOffset;
_48.data=this.stringSplice(_48.data,_4f-1,1);
this.updateRange(_48,_4f);
}else{
if(_48.nodeName=="BR"){
if((_48.hasAttribute&&_48.hasAttribute("_moz_dirty"))||dojo.attr(_48,"type")=="_moz"){
var _55=_48.previousSibling;
this.textAreaNode.removeChild(_48);
_48=_55;
while(_55&&_55.nodeName!="BR"){
_55=_48.previousSibling;
this.textAreaNode.removeChild(_48);
if(this.isAnyMentionsDomNode(_48)){
this.removeMentionById(_48.id);
}
_48=_55;
}
}
while(_48&&_48.nodeName=="BR"){
var _55=_48.previousSibling;
this.textAreaNode.removeChild(_48);
_48=_55;
}
this.moveToNextNode(_48,_3f,sel);
_3e=this.getSelection();
sel=_3e.selection;
_3f=_3e.range;
_4e=_3f.startOffset;
_4f=_3f.endOffset;
}else{
if(_48.id||(_48.nodeName=="SPAN"&&_48.className.indexOf("vcard")>-1)){
if(_48.id){
_53=this.removeMentionById(_48.id);
}else{
var _56=_48.previousSibling;
this._trackedMentions.splice(dojo.indexOf(this._trackedMentions,_48),1);
this.textAreaNode.removeChild(_48);
if(this.eventHandles["onRemoveMention"]){
this.eventHandles.onRemoveMention(mentionNode);
}
this.updateRange(_56,_56.length);
}
this._currentNode=null;
}else{
if(dojo.isFF){
if(_48.nodeType==3&&_48.data!="\n"){
_3f.setStart(_48,_48.data.length);
_3f.setEnd(_48,_48.data.length);
_4f=_48.data.length;
_48.data=this.stringSplice(_48.data,_4f-1,1);
this.updateRange(_48,_4f);
}
}
}
}
}
}
}else{
this.removeSelection(e,_3f);
}
}
}
if(dojo.isWebKit){
this.textAreaNode.normalize();
}
}else{
if(this.isDelete(e)){
if(dojo.isIE&&!this._isTracking){
sel.refresh();
_3f=sel.getRangeAt(0);
}
var _48=this._currentNode;
var _4e=_3f.startOffset;
var _4f=_3f.endOffset;
if(this._isTracking){
this.preventDefault(e);
var _50=_48.value;
var _51=0;
if(_4e==_4f){
_50=this.stringSplice(_50,_4f,1);
_51=_4f;
}else{
_50=this.stringSplice(_50,_4e,_4f-_4e);
_51=_4e;
}
if(_50.charAt(0)==this.activatorChar){
_48.setValue(_50);
var _49=_48.getTextNode();
if(dojo.isIE&&window.rangy){
var _3f=rangy.createRangyRange();
_3f.setStart(_49,_51);
_3f.setEnd(_49,_51);
sel.setSingleRangeEx(_3f);
this.saveSelectionIE(sel);
}else{
_48.setTextRange(this.updateRange(_49,_51).nodeRange);
}
this.updateTrack(_48.value);
}else{
var _52=_48.domNode.previousSibling;
var _53=this.removeMentionNode(_48,true);
this.stopTrack();
_3f=this.rangeMoveToNodeStart(_53,_3f);
sel.removeAllRanges();
sel.addRange(_3f);
this.saveSelectionIE(sel);
if(dojo.isSafari){
this.safariNodeFix(_52);
}
}
}else{
if(_3f.startContainer!=this.textAreaNode){
if(_4e==_4f&&_3f.startContainer==_3f.endContainer){
if(dojo.isIE){
var _54=_3f.startContainer;
while(_54.parentNode&&_54.parentNode!=this.textAreaNode){
_54=_54.parentNode;
}
}
if(_3f.startOffset==_3f.startContainer.length){
this.moveToNextNode(_3f.startContainer,_3f,sel);
_3e=this.getSelection();
sel=_3e.selection;
_3f=_3e.range;
_4e=_3f.startOffset;
_4f=_3f.endOffset;
_48=this._currentNode;
}
if(_48!=null&&dojo.indexOf(this._trackedMentions,_48)!=-1){
this.preventDefault(e);
this.moveToPreviousNode(_48.domNode,_3f,sel);
_3e=this.getSelection();
sel=_3e.selection;
_3f=_3e.range;
_4e=_3f.startOffset;
_4f=_3f.endOffset;
this.removeMentionNode(_48);
this._currentNode=null;
if(dojo.isIE&&window.rangy){
sel.setSingleRangeEx(_3f);
}else{
sel.removeAllRanges();
sel.addRange(_3f);
}
}else{
if(dojo.isIE&&window.rangy){
setTimeout(dojo.hitch(this,function(){
sel.refresh();
this._rangySelection=sel;
_3f=sel.getRangeAt(0);
this.printDebug("After Key: "+this.getRangeText(_3f)+" -- Start: "+_3f.startOffset+"    End: "+_3f.endOffset);
}),50);
}
}
}else{
if(!dojo.isIE&&!_4){
this.removeSelection(e,_3f);
}
}
}else{
this.preventDefault(e);
var _48=this.textAreaNode.childNodes[_4e];
var _53=null;
if(_4e==_4f){
while(_48&&_48.nodeType==3&&_53&&(_53.data==""||_53.data=="\u200b")){
_48.data="";
_4e=_4e-1;
_4f=_4f-1;
_53=this.textAreaNode.childNodes[_4e];
if(_53&&_53.nodeType==3&&(_53.data==""||_53.data=="\u200b")){
this.textAreaNode.removeChild(_48);
}
_48=_53;
}
if(_48!=null){
if(_48.nodeType==3){
_3f.selectNode(_48);
_4f=_3f.endOffset;
_48.data=this.stringSplice(_48.data,_4f-1,1);
}else{
if(_48.nodeName=="BR"){
this.textAreaNode.removeChild(_48);
}else{
_53=this.removeMentionById(_48.id);
this._currentNode=null;
}
}
}
}else{
this.removeSelection(e,_3f);
}
}
}
if(dojo.isWebKit){
this.textAreaNode.normalize();
}
}else{
if(this.isCtrlEnter(e)){
this.preventDefault(e);
if(lconn.profiles.bizCard.bizCard&&!this.disableBizCard){
e.keyCode=13;
if(dojo.isIE>8){
window.event.keyCode=13;
}
lconn.profiles.bizCard.bizCard.keystrokeHandler(e);
}
}else{
if(this.isEnter(e)){
if(!e.ctrlKey&&!e.metaKey&&this._isTracking&&this.getActiveType_IsShowing()){
this.preventDefault(e);
this.selectTypeaheadOption();
}else{
this.preventDefault(e);
if(this.getActiveType_Field()&&this._isTracking&&!this.getActiveType_IsShowing()){
this.convertMentionNodeToText(this._currentNode);
this.stopTrack();
_4c=false;
}
if(this.multiline){
var br=document.createElement("br");
if(_3f.startContainer!=this.textAreaNode&&_3f.startContainer.parentNode!=this.textAreaNode){
_3f.setStart(this.textAreaNode,this.textAreaNode.childNodes.length);
_3f.setEnd(this.textAreaNode,this.textAreaNode.childNodes.length);
}
var _57=document.createTextNode("");
var _58=null;
if(dojo.isWebKit||dojo.isIE){
_58=document.createTextNode("\u200b");
}else{
if(dojo.isIE==8){
_58=document.createTextNode("\u200b");
}else{
_58=document.createTextNode("");
}
}
if(dojo.isIE){
var _54=_3f.startContainer;
while(_54.parentNode&&_54.parentNode!=this.textAreaNode){
_54=_54.parentNode;
}
if(this.isAnyMentionsDomNode(_54)){
_3f=this.moveToNext(_3f,_54);
}
}
_3f.insertNode(_57);
_3f.setStartAfter(_57);
sel.removeAllRanges();
sel.addRange(_3e.range);
_3f.insertNode(br);
_3f.setStartAfter(br);
sel.removeAllRanges();
sel.addRange(_3e.range);
_3f.insertNode(_58);
_3f.setStartAfter(_58);
sel.removeAllRanges();
sel.addRange(_3e.range);
if(dojo.isIE){
_3f.setStartAfter(br);
}
var _56=document.createElement("span");
_3f.cloneRange().insertNode(_56);
this.textAreaNode.scrollTop=_56.offsetTop-this.textAreaNode.offsetTop;
_56.parentNode.removeChild(_56);
this.saveSelectionIE(sel);
}
}
this.printDebug(dojo.toJson(this.getTextAsJson()));
}else{
if((_4c||this.isTrackedKey(e)||_3d)&&!this._isComposition&&e.keyCode!=20){
this.preventDefault(e);
var _48=this._currentNode;
if(!_48){
var _54=_3f.startContainer;
while(_54&&_54.parentNode&&_54.parentNode!=this.textAreaNode){
_54=_54.parentNode;
}
_48=this.getNodeAttributes(_54.id);
this._currentNode=_48;
}
if(_48){
var _59=_48.value;
var _50=_59.replace("\u200b","");
if(dojo.isIE){
var _5a=_3f.endOffset-(_59.length-_50.length)+1;
}else{
var _5a=_3f.endOffset-(_59.length-_50.length);
}
if(_4e!=_4f){
_3f=this.removeSelection(e,_3f);
_59=_48.value;
_50=_59.replace("\u200b","");
_5a=_3f.startOffset;
}
if(!_3d){
_48.setValue(this.stringSplice(_50,_5a,0,String.fromCharCode(e.charCode||e.keyCode)));
var _49=_48.getTextNode();
var _51=_5a+1;
if(_51>_49.length){
_51=_49.length;
}
if(dojo.isIE&&window.rangy){
try{
var _5b=rangy.createRangyRange();
_5b.setStart(_49,_51);
_5b.setEnd(_49,_51);
sel.setSingleRangeEx(_5b);
this.saveSelectionIE(sel);
}
catch(err){
this.printDebug("Setting backup range on Mention Char addition.");
sel=rangy.getSelection();
var _5b=rangy.createRange();
_5b.setStart(_49,_49.data.length);
_5b.setEnd(_49,_49.data.length);
sel.removeAllRanges();
sel.addRange(_5b);
this.saveSelectionIE(sel);
}
}else{
_48.setTextRange(this.updateRange(_49,_51).nodeRange);
}
}
this.updateTrack(_48.value);
this.positionTypeahead();
this.textAreaNode.scrollTop=_48.domNode.offsetTop-this.textAreaNode.offsetTop;
if(this.isSpace(e)&&(this.getActiveType_IsShowing()&&this.getActiveType_Field().results==0)){
this.convertMentionNodeToText(_48);
this.stopTrack();
}
if(_4c){
dojo.publish("lconn/core/mentions/started",[{editor:this.textAreaNode,node:this._currentNode,cancel:dojo.hitch(this,this.cancelMention)}]);
}
}
}else{
if((e.charCode||e.keyCode==33||e.keyCode==34||e.keyCode==35||e.keyCode==36)&&e.charCode!=229||e.keyCode!=229){
if(this._isTracking){
var _3e=this.getSelection();
var sel=_3e.selection;
var _3f=_3e.range;
if(e.keyCode==35&&e.charCode!=35){
this.preventDefault(e);
if(e.shiftKey){
_3f.setEnd(_3f.startContainer,_3f.startContainer.data.length);
}else{
_3f.setStart(_3f.startContainer,_3f.startContainer.data.length);
_3f.setEnd(_3f.startContainer,_3f.startContainer.data.length);
}
sel.removeAllRanges();
sel.addRange(_3f);
this.saveSelectionIE(sel);
}else{
if(e.keyCode==36&&e.charCode!=36){
if(!dojo.isIE){
this.preventDefault(e);
}
if(e.shiftKey){
_3f.setStart(_3f.startContainer,0);
if(dojo.isIE==8){
_3f.setStart(_3f.startContainer,_3f.startContainer.data.length);
}
}else{
_3f.setStart(_3f.startContainer,1);
_3f.setEnd(_3f.startContainer,1);
}
sel.removeAllRanges();
sel.addRange(_3f);
this.saveSelectionIE(sel);
}
}
}else{
if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&this._currentNode){
this.removeMentionNode(this._currentNode);
this._currentNode=null;
}
}
this.displayBizCard(e);
if(dojo.isIE&&window.rangy&&e.keyCode!=dojo.keys.SHIFT){
setTimeout(dojo.hitch(this,function(){
_3f=sel.getRangeAt(0);
sel.refresh();
this._rangySelection=sel;
this.printDebug("After Key: "+this.getRangeText(_3f)+" -- Start: "+_3f.startOffset+"    End: "+_3f.endOffset);
if(!this.getRangeText(_3f)){
this.handleResumeMention(sel,_3f);
}
if(_3f.startContainer&&this._currentNode&&!(_3f.startContainer==this._currentNode.domNode||_3f.startContainer==this._currentNode.getTextNode())){
if(this._isTracking){
this.convertMentionNodeToText(this._currentNode,true);
this.stopTrack();
}
}
if(!this._currentNode&&window.LCSemTagMenu&&!this.disableBizCard){
LCSemTagMenu.hide();
}
}),1);
}else{
setTimeout(dojo.hitch(this,function(){
var _5c=this.getSelection();
var _5d=_5c.range;
var _5e=_5d.startContainer.data;
if(this.replaceBlank&&_5e.indexOf(" ")==0){
var _5f=_5e.replace(" ","");
var _60=_5d.endOffset-(_5e.length-_5f.length);
_5d.startContainer.data=_5f;
_5d.setStart(_5d.startContainer,_60);
_5d.setEnd(_5d.startContainer,_60);
sel.removeAllRanges();
sel.addRange(_5d);
}
if(_5d.startContainer&&this._currentNode&&!(_5d.startContainer==this._currentNode.domNode||_5d.startContainer==this._currentNode.getTextNode())){
if(this._isTracking){
this.convertMentionNodeToText(this._currentNode,true);
this.stopTrack();
}
}
if(!this._currentNode&&window.LCSemTagMenu&&!this.disableBizCard){
LCSemTagMenu.hide();
}
if(this.getActiveType_IsShowing()){
dojo.attr(this.textAreaNode,"role","combobox");
dojo.attr(this.textAreaNode,"aria-autocomplete","inline");
dojo.attr(this.textAreaNode,"aria-expanded","true");
}else{
dojo.attr(this.textAreaNode,"role","textbox");
dojo.removeAttr(this.textAreaNode,"aria-autocomplete");
dojo.removeAttr(this.textAreaNode,"aria-activedescendant");
dojo.removeAttr(this.textAreaNode,"aria-expanded");
}
}),50);
}
}else{
if(dojo.isIE&&this._wasComposition&&this._isTracking){
this.preventDefault(e);
setTimeout(dojo.hitch(this,function(){
sel.refresh();
this._rangySelection=sel;
_3f=sel.getRangeAt(0);
var _61=this._currentNode;
if(_61&&_3f.startContainer&&_3f.startContainer.data){
_61.setValue(_61.value+_3f.startContainer.data);
_3f.startContainer.data="";
var _62=_61.getTextNode();
_61.setTextRange(this.updateRange(_62,_62.length).nodeRange);
this.updateTrack(_61.value);
}
this._wasComposition=false;
}),50);
}
}
}
}
}
}
}
}
}
}
}
}
}
}
this.displayBizCard(e);
if(dojo.isFF<4){
if(this.textAreaNode.childNodes.length==0){
var t=document.createTextNode("\n");
this.textAreaNode.appendChild(t);
}
}
if(this.eventHandles["onkeypress"]){
setTimeout(dojo.hitch(this,this.eventHandles.onkeypress),50);
}
},displayBizCard:function(e){
if(this._currentNode){
this.printDebug("Current Node:"+this._currentNode);
try{
if(_2(this._currentNode.linkNode)&&!this.disableBizCard){
this.showBizCardHover(e,this._currentNode.linkNode);
}
}
catch(e){
this.printDebug("Failed to show bizcard for Mention");
}
}else{
if(window.LCSemTagMenu&&!this.disableBizCard){
LCSemTagMenu.hide();
}
}
},pasteListener:function(e){
if(!dojo.isFF){
this.preventDefault(e);
}
if(dojo.isWebKit||dojo.isIE){
this.handlePrePaste(e);
}
if(dojo.isFF){
var _63=this.getSelection();
var sel=_63.selection;
var _64=_63.range;
if(_64.startContainer!=_64.endContainer||_64.startOffset!=_64.endOffset){
this.removeSelection(null,_64);
if(_64.startContainer!=this.textAreaNode){
_64.setStartBefore(_64.startContainer);
}
}
var _65=document.createElement("span");
_65.id=this.textAreaNode.id+"_pasteSpan";
_64.insertNode(_65);
this._prePasteSel=sel;
this._prePasteRange=_64;
if(_65.nextSibling){
_64.setEnd(_65.nextSibling,0);
}
setTimeout(dojo.hitch(this,this.handleFFPaste),5);
}
if(this.eventHandles["onkeypress"]){
this.eventHandles.onkeypress();
}
},handleFFPaste:function(){
var _66=this.getSelection();
var sel=_66.selection;
var _67=_66.range;
var _68=this._prePasteRange.startContainer;
var _69=this._prePasteRange.endContainer;
var _6a=this._prePasteRange.startOffset;
if(_68==this.textAreaNode&&_68.childNodes.length>0){
_68=this.textAreaNode.childNodes[_6a];
_6a=0;
}
_67.setStart(_68,_6a);
var _6b=_67.extractContents();
while(_68&&_68!=_69){
var _6c=_68.nextSibling;
if(_68.nodeType!=3&&!this.isAnyMentionsDomNode(_68)){
this.textAreaNode.removeChild(_68);
}
_68=_6c;
}
var _6d=document.createTextNode(_6b.textContent);
if(this._prePasteRange.startContainer!=this.textAreaNode){
this.textAreaNode.insertBefore(_6d,_69);
}else{
if(this.textAreaNode.childNodes.length>0){
this.textAreaNode.insertBefore(_6d,this.textAreaNode.childNodes[this._prePasteRange.startOffset]);
}else{
this.textAreaNode.appendChild(_6d,_69);
}
}
if(!this.disableURLPreview){
_6d=this.detectURL(_6d);
}
if(_6d){
_67.setStartAfter(_6d);
_67.setEndAfter(_6d);
}
if(this.eventHandles["onkeypress"]){
this.eventHandles.onkeypress();
}
},postPaste:function(){
var _6e=this.getSelection();
var sel=_6e.selection;
var _6f=_6e.range;
this.textAreaNode.focus();
this._isPasteFocusLoss=false;
_6f.setStart(this._prePasteRange.startContainer,this._prePasteRange.startOffset);
_6f.setEnd(this._prePasteRange.endContainer,this._prePasteRange.endOffset);
sel.removeAllRanges();
sel.addRange(_6f);
if(_6f.startContainer!=_6f.endContainer||_6f.startOffset!=_6f.endOffset){
this.removeSelection(null,_6f);
}
var _70=document.createTextNode(this.tempTextArea.value);
var _71=null;
if(this._isTracking){
_71=this._currentNode;
value=_71.value;
var _72=_6f.endOffset;
if(_6f.startOffset!=_6f.endOffset){
this.removeSelection(null,_6f);
_72=_6f.startOffset;
}
var _73=(dojo.isIE)?this.tempTextArea.innerText:this.tempTextArea.value;
_71.setValue(this.stringSplice(value,_72,0,_73));
var _74=_71.getTextNode();
var _75=_72+_73.length;
if(_75>_74.length){
_75=_74.length;
}
if(dojo.isIE&&window.rangy){
var _6f=rangy.createRangyRange();
_6f.setStart(_74,_75);
_6f.setEnd(_74,_75);
sel.setSingleRangeEx(_6f);
}else{
_71.setTextRange(this.updateRange(_74,_75).nodeRange);
_6f=this.updateRange(_74,_75).nodeRange;
}
this.updateTrack(_71.value);
var _76=document.createElement("span");
_6f.cloneRange().insertNode(_76);
this.textAreaNode.scrollTop=_76.offsetTop-this.textAreaNode.offsetTop;
_76.parentNode.removeChild(_76);
this.saveSelectionIE(sel);
if(this.tempTextArea.value.length>100){
this.convertMentionNodeToText(this._currentNode);
this.stopTrack();
}
}else{
if(dojo.isIE){
_6e=this.getSelection();
sel=_6e.selection;
sel.refresh();
_6f=sel.getRangeAt(0);
}
_6f.insertNode(_70);
var _77=_6f.endContainer;
if(_77==this.textAreaNode){
var idx=-1;
if(dojo.isIE&&window.rangy){
idx=_6f.endOffset;
}else{
idx=_6f.endOffset-1;
}
if(idx<0){
idx=0;
}else{
if(idx>=this.textAreaNode.childNodes.length){
idx=this.textAreaNode.childNodes.length-1;
}
}
var _78=this.textAreaNode.childNodes[idx];
var _79=this.detectURL(_70);
if(_79){
_78=_79;
}
if(_78){
if(_78.nodeType!=3){
_78=this.getTextNode(_78);
}
_6f.setStart(_78,_78.data.length);
_6f.setEnd(_78,_78.data.length);
}
}else{
_78=this.getTextNode(_77.nextSibling);
if(_78){
_6f.setStart(_78,_78.data.length);
_6f.setEnd(_78,_78.data.length);
}
}
var _76=document.createElement("span");
_6f.cloneRange().insertNode(_76);
this.textAreaNode.scrollTop=_76.offsetTop-this.textAreaNode.offsetTop;
_76.parentNode.removeChild(_76);
sel.removeAllRanges();
sel.addRange(_6f);
this.saveSelectionIE(sel);
this.displayBizCard(null);
}
if(this.eventHandles["onkeypress"]){
this.eventHandles.onkeypress();
}
this.tempTextArea.value="";
dojo.style(this.tempTextArea,{visibility:"hidden"});
},cutListener:function(e){
var _7a=this.getSelection();
var _7b=_7a.range;
if(_7b.cloneContents){
var _7c=_7b.cloneContents();
dojo.forEach(_7c.childNodes,function(_7d){
if(_7d){
var _7e=this.getNodeAttributes(_7d.id);
if(_7e){
this._currentNode=(_7e==this._currentNode)?null:this._currentNode;
if(dojo.isIE){
if(_7e.linkNode){
dojo.query(".x-lconn-userid",_7e.linkNode)[0].innerHTML="";
}
}
this._trackedMentions.splice(dojo.indexOf(this._trackedMentions,_7e),1);
}
}
},this);
_7c=null;
}
if(this.eventHandles["onkeypress"]){
this.eventHandles.onkeypress();
}
},resetBox:function(){
if(dojo.isIE&&window.rangy){
try{
var _7f=this.getSelection();
var sel=_7f.selection;
sel.removeAllRanges();
this.saveSelectionIE(sel);
}
catch(err){
}
}
this._trackedMentions.length=0;
if(this._isTracking){
this.convertMentionNodeToText(this._currentNode,true);
this.stopTrack();
}
this.setShadowText();
},setShadowText:function(){
this.placeholder=dojo.attr(this.textAreaNode,"placeholder");
if(this.placeholder){
dojo.style(this.textAreaNode,"color","#666");
this.setText(this.placeholder);
if(dojo.isWebKit){
dojo.style(this.textAreaNode,"-webkit-user-select","none");
}
}
},setText:function(_80){
dojo.empty(this.textAreaNode);
this.MENTION_REGEX.lastIndex=0;
var _81=this.MENTION_REGEX.exec(_80);
if(_81==null){
if(dojo.isIE==8){
dojo.place(document.createTextNode("\u200b"),this.textAreaNode);
}
dojo.place(document.createTextNode(_80),this.textAreaNode);
return;
}
this.MENTION_REGEX.lastIndex=0;
while(true){
var _82=this.MENTION_REGEX.lastIndex;
var _81=this.MENTION_REGEX.exec(_80);
var _83=_81!=null?_81.index:_80.length;
if(_83>_82){
var s=_80.substring(_82,_83);
var el=document.createTextNode(s);
var _84=this.getSelection();
var sel=_84.selection;
var _85=_84.range;
_85.insertNode(el);
_85.setStartAfter(el);
sel.removeAllRanges();
sel.addRange(_85);
}
if(_81==null){
break;
}else{
var _86=false;
var _87=_81[1];
if(_87.indexOf(this.activatorChar)==0){
_87=_87.substring(1);
_86=true;
}
var _88=_81[2];
this.addTrack();
var _89=this._currentNode;
this.completeMention({name:_87,userid:_88});
if(!_86){
_89.removeSymbol();
}
}
}
},blurListener:function(e){
dojo.publish("lconn/core/mentions/blur");
this.setShadowText();
this.setAriaLabel(this.placeholder);
if(this._isTracking&&!this._stopBlur){
var _8a=document.activeElement.id;
var _8b=this.getActiveType_Field()?this.getActiveType_Popup():null;
var _8c="";
if(_8b){
if(dojo.isIE){
dojo.removeClass(_8b.domNode.parentNode,"lconnTypeAhead");
}
_8c=_8b?_8b.id:"";
if(dojo.isIE&&_8a!=_8c||!dojo.isIE&&!dojo.isChrome){
this.closeTypeahead();
}
}
}
this._stopBlur=false;
if(this.eventHandles["onblur"]){
this.eventHandles.onblur();
}
},focusListener:function(e){
dojo.publish("lconn/core/mentions/focus",[this._isTracking]);
if(dojo.isWebKit){
dojo.style(this.textAreaNode,"-webkit-user-select","auto");
}
dojo.style(this.textAreaNode,"color","#000");
if(this.placeholder){
if(this.placeholder==this.getText()){
this.setText("");
setTimeout(dojo.hitch(this,function(){
this.getSelection();
}),5);
if(dojo.isWebKit){
var _8d=document.createRange();
_8d.selectNodeContents(this.textAreaNode);
var sel=this.getSelection().selection;
sel.removeAllRanges();
sel.addRange(_8d);
}
}
}
if(dojo.isIE==8){
if(this.textAreaNode.firstChild&&this.textAreaNode.firstChild.data==""){
this.textAreaNode.firstChild.data="\u200b";
}
this.preventDefault(e);
}
var _8e=this.getSelection();
var sel=_8e.selection;
var _8d=_8e.range;
if((dojo.isWebKit)&&this.textAreaNode.childNodes.length==0){
var t=document.createTextNode("\u200b");
this.textAreaNode.appendChild(t);
_8d.setStart(t,1);
_8d.setEnd(t,1);
sel.removeAllRanges();
sel.addRange(_8d);
this.saveSelectionIE(sel);
}
if(!this._isPasteFocusLoss){
this.handleResumeMention(sel,_8d);
}
var _8f=_8d.startContainer;
if(dojo.isIE==8&&_8f.previousSibling&&_8f.previousSibling.tagName=="SPAN"&&(_8f.previousSibling.className.indexOf("vcard")!=-1)){
_8f=_8f.previousSibling;
}else{
while(_8f&&_8f.parentNode&&_8f.parentNode!=this.textAreaNode){
_8f=_8f.parentNode;
}
}
mentionNode=this.getNodeAttributes(_8f.id);
if(mentionNode){
this._currentNode=mentionNode;
}else{
if(dojo.isIE){
dojo.forEach(this.textAreaNode.childNodes,function(_90){
if(_90.tagName=="SPAN"){
mentionNode=_90;
}
});
this._currentNode=mentionNode;
}
}
if(this._currentNode){
if(this._activeBizCard&&!dojo.isIE){
setTimeout(dojo.hitch(this,function(){
var _91=this.getSelection();
var sel=_91.selection;
var _92=_91.range;
var _93=this.getTextNode(this._currentNode.domNode);
if(_93){
if(!dojo.isIE){
_92.setStart(_93,0);
_92.setEnd(_93,_93.data.length);
}else{
_92.selectNode(_93);
}
}
sel.removeAllRanges();
sel.addRange(_92);
this._activeBizCard=false;
try{
if(this._currentNode&&_2(this._currentNode.linkNode)&&!this.disableBizCard){
this.showBizCardHover(e,this._currentNode.linkNode);
}
}
catch(e){
this.printDebug("Failed to show bizcard for Mention");
}
}),5);
}else{
if(dojo.isIE==8){
var t=document.createTextNode("\u200b");
this.textAreaNode.appendChild(t);
_8d.setStart(t,1);
_8d.setEnd(t,1);
sel.removeAllRanges();
sel.addRange(_8d);
this.saveSelectionIE(sel);
if(!this._isTracking){
this._currentNode=null;
}
}
}
}else{
if(window.LCSemTagMenu&&!this.disableBizCard){
LCSemTagMenu.hide();
}else{
if(dojo.isIE&&this.textAreaNode.innerHTML==""){
this.setText("");
}
}
}
if(dojo.isFF<4){
if(this.textAreaNode.childNodes.length==0){
var t=document.createTextNode("\n");
this.textAreaNode.appendChild(t);
}
}
if(this.eventHandles["onfocus"]){
this.eventHandles.onfocus();
}
},selectTypeaheadOption:function(){
if(this.handleTypeaheadKeyInput){
this.handleTypeaheadKeyInput.apply(this,arguments);
}
},safariNodeFix:function(_94){
curSel=this.getSelection();
range=curSel.range;
sel=curSel.selection;
this.textAreaNode.normalize();
if(_94){
if(_94.nodeType!=3){
_94=this.getTextNode(_94);
}
var _95=Math.min(_94.length,_94.data.length);
if(_95<0){
range.selectNodeContents(this.textAreaNode);
if(this.textAreaNode.childNodes.length==0){
this.textAreaNode.appendChild(document.createElement("br"));
}
}else{
range.setStart(_94,_95);
range.setEnd(_94,_95);
}
}else{
range.selectNodeContents(this.textAreaNode);
if(this.textAreaNode.childNodes.length==0){
this.textAreaNode.appendChild(document.createElement("br"));
}
}
sel.removeAllRanges();
sel.addRange(range);
},getMentions:function(){
return this._trackedMentions;
},cleanUp:function(){
if(this._registeredTypes){
dojo.forEach(this._registeredTypes,function(_96){
if(_96){
_96.cleanUp();
}
});
}
}});
})(lconn.core.util.text);
}


;if(!dojo._hasResource["lconn.core.widget.mentions.MentionsType"]){
dojo._hasResource["lconn.core.widget.mentions.MentionsType"]=true;
dojo.provide("lconn.core.widget.mentions.MentionsType");
dojo.declare("lconn.core.widget.mentions.MentionsType",null,{_id:"",_type:"MentionsType",_activatorChar:"~",_typeaheadFeed:"",_typeahead:null,_typeaheadArgs:{},parentNode:null,typeaheadDataStore:null,templateClass:"lconn.core.widget.mentions.MentionsNode",constructor:function(_1){
if(_1){
dojo.safeMixin(this,_1);
}
this.initPlaceholderField();
if(!this.typeaheadDataStore){
this.initDefaultDataStore();
}else{
this.initFromDataStore();
}
this.initTypeaheadArgs();
this.initTypeahead();
this.postTypeaheadInit();
},initPlaceholderField:function(){
this._typeahead=dojo.create("input",{type:"text",id:this.parentNode.id+"_"+this._type});
if(this.parentNode){
dojo.place(this._typeahead,this.parentNode);
}
},initTypeaheadArgs:function(){
dojo.mixin(this._typeaheadArgs,{id:this._typeahead.id,minChars:1,searchDelay:400,multipleValues:false,store:this.typeaheadDataStore});
},initTypeahead:function(){
},initDefaultDataStore:function(){
},initFromDataStore:function(){
if(this.typeaheadDataStore){
this._typeaheadFeed=this.typeaheadDataStore.url;
this._extendedTypeAhead=this.typeaheadDataStore.extendedTypeAheadUrl;
}else{
throw "No data store available!";
}
},postTypeaheadInit:function(){
this._typeahead.focusNode.preventFocus=true;
dojo.addClass(this._typeahead,"lotusMentionsTypeaheadField");
dojo.addClass(this._typeahead.domNode,"lotusMentionsTypeaheadField");
},setTypeaheadValue:function(_2){
if(this._typeahead&&this._typeahead.focusNode){
this._typeahead.focusNode.value=_2;
}
},hideResults:function(){
if(this._typeahead){
this._typeahead._hideResultList();
}
},getTypeaheadField:function(){
return this._typeahead;
},getTypeaheadPopup:function(){
if(this._typeahead){
return this._typeahead._popupWidget;
}
},getTypeaheadResults:function(){
if(this._typeahead){
return this._typeahead.results;
}
},getVOffset:function(){
if(this._typeahead){
return this._typeahead._vOffset;
}
}});
}


;if(!dojo._hasResource["lconn.core.widget.mentions.PersonMentionsNode"]){
dojo._hasResource["lconn.core.widget.mentions.PersonMentionsNode"]=true;
dojo.provide("lconn.core.widget.mentions.PersonMentionsNode");








(function(){
var _1="PersonMentions";
dojo.declare("lconn.core.widget.mentions.PersonMentionsNode",[lconn.core.widget.mentions.MentionsNode],{type:_1,_hasSymbol:true,_userData:null,EXTERNAL_PROP:"EXTERNAL",constructor:function(_2){
this.className="PersonMentionsNode";
},setUserId:function(_3){
this.setData(_3);
},getUserId:function(){
return this.data;
},getUserData:function(){
return this._userData;
},setUserData:function(_4){
this._userData=_4;
this.setValue(this._userData.name);
this.setUserId(this._userData.userid);
},getUserExternalMode:function(){
return dojo.getObject("ext.mode",false,this.getUserData());
},getUserOrgId:function(){
return dojo.getObject("ext.orgId",false,this.getUserData());
},isUserExternal:function(){
return this.getUserExternalMode()===this.EXTERNAL_PROP;
},setComplete:function(_5,_6,_7){
this.setUserData(_6);
if(dojo.exists("com.ibm.lconn.layout.people")){
var _8=com.ibm.lconn.layout.people.createLink({name:this.bidiSymbol()+this.value,userid:this.data});
}
if(!_8){
_8=dojo.create("span",{"aria-describedby":"semtagmenu",className:"fn lotusBold",innerHTML:this.bidiSymbol()+this.value+"<span style='display: none;' class='x-lconn-userid'>"+this.data+"</span>"});
}
this.linkNode=dojo.place(_8,this.linkNode,"replace");
if(!_7&&window.SemTagSvc&&SemTagSvc.parseDom){
SemTagSvc.parseDom(0,this.domNode);
}
dojo.attr(this.linkNode,"target","_blank");
this.inherited(arguments);
},removeSymbol:function(){
var _9=this.getLinkValueNode();
var _a=_9.data;
if(_a.search(this.bidiSymbol())==0){
_a=this.stringSplice(_a,0,this.bidiSymbol().length);
_9.data=_a;
this._hasSymbol=false;
}
},addSymbol:function(){
var _b=this.getLinkValueNode();
var _c=_b.data;
if(_c.search(this.bidiSymbol())!=0){
_c=this.stringSplice(_c,0,0,this.bidiSymbol());
_b.data=_c;
this._hasSymbol=true;
}
},toString:function(){
return this.value;
},toJsonString:function(){
var _d={type:this.type,displayName:this.value,hasSymbol:this._hasSymbol,userId:this.data};
if(this._userData){
_d.userData=this._userData;
}
return _d;
},parseNode:function(_e){
if(_e){
this.setUserId(_e.firstChild.href.split("uid=")[1]);
this.setValue(_e.textContent||_e.innerText);
}
},getTextNode:function(){
if(this.linkNode){
return this.linkNode.firstChild;
}else{
return null;
}
},stringSplice:function(_f,idx,_10,_11){
return (_f.slice(0,idx)+(_11||"")+_f.slice(idx+Math.abs(_10)));
}});
lconn.core.widget.mentions.PersonMentionsNode.TYPE=_1;
})();
}


;if(!dojo._hasResource["lconn.core.widget.mentions.PersonMentionsType"]){
dojo._hasResource["lconn.core.widget.mentions.PersonMentionsType"]=true;
dojo.provide("lconn.core.widget.mentions.PersonMentionsType");














dojo.declare("lconn.core.widget.mentions.PersonMentionsType",lconn.core.widget.mentions.MentionsType,{_type:"PersonMentionsType",_activatorChar:"@",templateClass:"lconn.core.widget.mentions.PersonMentionsNode",isPersonAndGroup:false,noResultsMsg:"",headerMsg:"",disableSearchDirectory:false,disableBizCard:false,initDefaultDataStore:function(){
var _1={filterBy:"displayName",count:15};
if(lconn.core.widget.mentions.PersonMentionsType.SEARCH_URL){
this._typeaheadFeed=lconn.core.widget.mentions.PersonMentionsType.SEARCH_URL+(this.network&&this.network.oauth?"/oauth":"/anonymous")+"/people/typeahead";
this._extendedTypeAheadFeed=lconn.core.widget.mentions.PersonMentionsType.OPENSOCIAL_URL+(this.network&&this.network.oauth?"/oauth":"/anonymous")+"/rest/people/@public/@all";
this.typeaheadDataStore=new lconn.core.HybridPeopleDataStoreOpenSocial({url:this._typeaheadFeed,queryParam:"name",extendedTypeAheadUrl:this._extendedTypeAheadFeed,extendedQueryParam:"filterValue",openSocialParameters:_1,network:this.network});
}else{
this._typeaheadFeed=lconn.core.widget.mentions.PersonMentionsType.OPENSOCIAL_URL+(this.network&&this.network.oauth?"/oauth":"/anonymous")+"/rest/people/@public/@all";
this.typeaheadDataStore=new lconn.core.PeopleDataStoreOpenSocial({url:this._typeaheadFeed,queryParam:"filterValue",openSocialParameters:_1,network:this.network});
}
},initTypeaheadArgs:function(){
this.inherited(arguments);
dojo.mixin(this._typeaheadArgs,{isPersonAndGroup:this.isPersonAndGroup,NoResultsMessage:this.noResultsMsg,HeaderMessage:this.headerMsg,"class":"typeAhead",minChars:2,multipleValues:false,searchDelay:600,disableSearchDirectory:this.disableSearchDirectory,disableBizCard:this.disableBizCard});
},initTypeahead:function(){
this._typeahead=new lconn.core.PeopleTypeAhead(this._typeaheadArgs,this._typeahead);
this._typeahead._vOffset=4;
},cleanUp:function(){
if(this._typeahead){
this._typeahead.destroyRecursive();
this._typeahead=null;
}
}});
if(lconn.core.config.services.search){
lconn.core.widget.mentions.PersonMentionsType.SEARCH_URL=lconn.core.url.getServiceUrl(lconn.core.config.services.search);
}
lconn.core.widget.mentions.PersonMentionsType.OPENSOCIAL_URL=lconn.core.url.getServiceUrl(lconn.core.config.services.opensocial);
}


;if(!dojo._hasResource["lconn.core.lcTextArea.providers.MentionsProvider"]){
dojo._hasResource["lconn.core.lcTextArea.providers.MentionsProvider"]=true;
dojo.provide("lconn.core.lcTextArea.providers.MentionsProvider");






dojo.mixin(lconn.core.lcTextArea.providers,{addMentionsFeature:function(_1,_2,_3,_4){
var _4=_4||{};
_4.inputField=_1;
_4.eventHandles=_2;
_4.multiline=true;
if(_4.context&&_4.network){
_4.context.network=_4.network;
}
if(_3){
_4.memberStore=_3;
}
var _5=null;
try{
_5=new lconn.core.widget.mentions.MentionsHelper(_4);
var _6=lconn.core.auth.getUser();
if(!(_6&&_6.isExternal)){
var _7=new lconn.core.widget.mentions.PersonMentionsType({parentNode:_5.domNode,context:_4.context,network:_4.network});
_5.registerActivatorType(_7);
}
}
catch(e){
if(dojo.config.isDebug){
console.debug("Error creating @mentions helper");
console.debug(e);
}
_5=null;
}
return _5;
}});
dojo.declare("lconn.core.lcTextArea.providers.MentionsProvider",null,{});
}

dojo.provide("lconn.core.lcTextArea.widgets.nls.BasicTextBox")._built=true;
dojo.provide("lconn.core.lcTextArea.widgets.nls.BasicTextBox.en_us");
lconn.core.lcTextArea.widgets.nls.BasicTextBox.en_us={"CKE_LITE_TITLE":"Text Area","SHADOW_TEXT":"What are you working on right now?"};

;if(!dojo._hasResource["lconn.core.lcTextArea.widgets.BasicTextBox"]){
dojo._hasResource["lconn.core.lcTextArea.widgets.BasicTextBox"]=true;
(function(){
dojo.provide("lconn.core.lcTextArea.widgets.BasicTextBox");
























dojo.requireLocalization("lconn.core.lcTextArea.widgets","BasicTextBox");
var _1=18,_2=11;
var _3=lconn.core.config.features;
function _4(_5,_6){
_5=dojo.isIE==8?_5.replace(/<\/p><p>/gi,"\n").replace(/<br \/><br \/>/gi,"<br />"):_5.replace(/<br \/>/gi,"\n");
var _7=dojo.toDom(_5),_8="";
if(dojo.isIE==8){
_8=_7.innerHTML=="&nbsp;"?"":(_7.innerText||"");
}else{
_8=_7.textContent||"";
}
if(_6){
var _9=dojo.query(".x-lconn-userid",_7);
_9.forEach(function(_a){
_8=_8.replace(_a.innerText||_a.textContent,"");
});
_8=_8.replace(/\u200b/gi,"");
}
return _8=="\xa0"?"":_8;
};
function _b(_c){
return "<span style=\"color:#666\">"+_c+"</span>";
};
function _d(_e){
return _e.useRTE||_3("ckeditor-lite-mentions");
};
function _f(fn){
if(!_d(this)){
return;
}
if(this._editor){
fn.call(this);
}else{
this.onRTELoadFn.push(fn);
}
};
function _10(_11){
if(_11&&dojo.isFunction(_11.remove)){
_11.remove();
}
};
dojo.declare("lconn.core.lcTextArea.widgets.BasicTextBox",[dijit._Widget,dijit._Templated,lconn.core.lcTextArea.mixins.ITextBoxUtils,lconn.core.lcTextArea.mixins.ITextBoxControl],{templateString:"<div class=\"lotusFieldEmphasis\"><textarea class=\"lotusText bidiAware\" dojoAttachPoint=\"textAreaNode\" autocomplete=\"off\">${shadowText}</textarea></div>",onRTELoadFn:[],shadowText:"",title:"",xhrHandler:null,mentionsEnabled:true,useRTE:false,keyDownCallback:null,isEE:false,_subs:[],_mentions:[],disableURLPreview:false,network:null,constructor:function(_12,_13){
this._strings=dojo.i18n.getLocalization("lconn.core.lcTextArea.widgets","BasicTextBox");
this.shadowText=this.shadowText||this._strings.SHADOW_TEXT;
this.title=_12.title||this._strings.CKE_LITE_TITLE;
this.onRTELoadFn=[];
},destroy:function(_14){
dojo.forEach(this._subs,dojo.unsubscribe);
this._subs=null;
this._mentions=null;
if(this._editor){
this._editor.destroy();
this._editor=null;
}
while(this.onRTELoadFn.length>0){
this.onRTELoadFn.pop();
}
this.inherited(arguments);
},buildRendering:function(){
if(_d(this)){
dijit._WidgetBase.prototype.buildRendering.apply(this,arguments);
var _15=this;
var _16=_15.height||(_15.textBoxRows||3)*_1+_2;
this.setDataStore(this.dataStore);
this.setNetwork(this.network);
if(_15.onLoadCallback&&dojo.isFunction(_15.onLoadCallback)){
_15.onRTELoadFn.push(_15.onLoadCallback);
}
lconn.core.ckeditor.appendTo(this.domNode,{lite:true,autoGrow:_15.isEE,height:_16,width:_15.width,title:_15.title,autoGrow_minHeight:_16,disableURLDetect:_15.disableURLPreview,on:{instanceReady:function(ev){
_15._editor=ev.editor;
ev.editor.editable().on("keyup",function(ev){
_15._onKeyPress.call(_15,ev.data.$);
});
ev.editor.editable().on("input",function(ev){
_15._onKeyPress.call(_15,ev.data.$);
});
ev.editor.editable().on("keydown",function(ev){
_15._onKeyDown.call(_15,ev.data);
});
ev.editor.editable().on("drop",function(ev){
_15._onKeyPress.call(_15,ev.data.$);
});
ev.editor.on("paste",function(ev){
_15._onKeyPress.call(_15,ev.data.$);
});
if(_15.isEE){
ev.editor.on("resize",function(ev){
_15._onResize(ev.editor);
});
}
dojo.forEach(_15.onRTELoadFn,function(fn){
fn.call(_15);
});
_15.addCustomCSS(_15.customCSS);
},focus:function(){
_15._onFocus.apply(_15,arguments);
},blur:function(){
_15._onBlur.apply(_15,arguments);
}}});
dojo.addClass(this.domNode,"lconnRTE");
}else{
this.inherited(arguments);
}
},postCreate:function(){
this._mixInSupport();
if(!_d(this)){
dojo.attr(this.textAreaNode,"title",this.shadowText);
var _17={};
_17["onkeypress"]=dojo.hitch(this,this._onKeyPress);
_17["onfocus"]=dojo.hitch(this,this._onFocus);
_17["onblur"]=dojo.hitch(this,this._onBlur);
if(this.mentionsEnabled){
this._mentionsHelper=lconn.core.lcTextArea.providers.addMentionsFeature(this.textAreaNode,_17,null,{network:this.xhrHandler,context:this.context});
this.textAreaNode=this._mentionsHelper.textAreaNode;
dojo.addClass(this.textAreaNode,"bidiAware");
this._subs.push(dojo.subscribe("lconn/core/mentions/url/entered",dojo.hitch(this,this.handleURLInput)));
}
lconn.core.globalization.bidiUtil.enforceTextDirectionOnPage(this.textAreaNode);
}
this.resetBox();
if(_d(this)){
_f.call(this,this.onLoad);
this._subs.push(dojo.subscribe("lconn/core/ckeditor/url/entered",dojo.hitch(this,this.handleURLInput)));
if(this.mentionsEnabled){
this._subs.push(dojo.subscribe("lconn/microblogging/mention/completed",dojo.hitch(this,this.handleMention)));
this._subs.push(dojo.subscribe("lconn/microblogging/mention/removed",dojo.hitch(this,this.handleRemoveMention)));
}
}else{
this.onLoad();
}
},resetBox:function(){
if(_d(this)){
_f.call(this,function(){
this.cancelActiveMentions();
this._setInitialState();
});
}else{
this.inherited(arguments);
}
this._mentions=[];
},resetFeature:function(){
if(this._mentionsHelper){
this._mentionsHelper.resetBox();
}
},_mixInSupport:function(){
if(this.mentionsEnabled){
if(_d(this)){
dojo.safeMixin(this,new lconn.core.lcTextArea.mixins.IMentionsSupportRTE());
}else{
dojo.safeMixin(this,new lconn.core.lcTextArea.mixins.IMentionsSupport());
}
}
},_showShadowText:function(){
if(_d(this)){
if(this.shadowText){
_f.call(this,function(){
this._editor.document.getBody().setHtml("<span style=\"color:#666\">"+this.shadowText+"</span>");
this._showingShadowText=true;
});
}
}else{
dojo.attr(this.textAreaNode,"placeholder",this.shadowText);
if(dojo.isIE){
dojo.style(this.textAreaNode,"color","#666");
this.inherited(arguments);
}else{
this.setText("");
this._showingShadowText=true;
}
}
},_hideShadowText:function(){
if(!this._showingShadowText){
return;
}
if(_d(this)){
_f.call(this,function(){
this._editor.document.getBody().setHtml("");
this._showingShadowText=false;
});
}else{
dojo.removeAttr(this.textAreaNode,"placeholder");
if(dojo.isIE){
dojo.style(this.textAreaNode,"color","#000");
this.inherited(arguments);
}else{
this._showingShadowText=false;
}
}
},setRows:function(_18){
if(_d(this)){
_f.call(this,function(){
this._editor.resize("100%",_18*_1+_2,true,true);
});
}else{
this.textAreaNode.rows=_18;
}
},collapseTextBox:function(){
if(_d(this)){
this.removeCustomCSS("lotusTextExpanded");
this.addCustomCSS("lotusTextCollapsed");
}else{
dojo.addClass(this.textAreaNode,"lotusTextCollapsed");
}
},expandTextBox:function(){
if(_d(this)){
this.removeCustomCSS("lotusTextCollapsed");
this.addCustomCSS("lotusTextExpanded");
}else{
dojo.removeClass(this.textAreaNode,"lotusTextCollapsed");
}
},setReadOnly:function(){
_d(this)?this._editor.setReadOnly(true):dojo.attr(this.textAreaNode,"readonly","readonly");
},setEditable:function(){
_d(this)?this._editor.setReadOnly(false):dojo.removeAttr(this.textAreaNode,"readonly");
},setFocus:function(){
if(_d(this)){
_f.call(this,function(){
this._editor.focus();
});
}else{
this.textAreaNode.focus();
}
this._hideShadowText();
},getText:function(){
var _19="";
if(_d(this)){
if(this._editor){
this._editor.keepMentionActive=true;
_19=_4(this._editor.getData(),this.mentionsEnabled);
this._editor.keepMentionActive=false;
}
}else{
_19=this.textAreaNode.value;
}
return _19;
},setText:function(_1a,_1b){
if(_d(this)){
_f.call(this,function(){
this.setValue(_1a,_1b);
});
}else{
this.textAreaNode.value=_1a;
}
},setEditorAttr:function(_1c,_1d){
if(_d(this)){
_f.call(this,function(){
this._editor.document.getBody().setAttribute(_1c,_1d);
});
}else{
this.textAreaNode.setAttribute(_1c,_1d);
}
},getMentions:function(){
if(!this.mentionsEnabled){
throw "The mentions feature is not enabled";
}
return _d(this)?this._mentions:this._mentionsHelper&&this._mentionsHelper.getMentions();
},handleURLInput:function(_1e){
if(_1e.mentionsHelper===this._mentionsHelper||_1e.editor&&_1e.editor===this._editor){
dojo.publish("lconn/microblogging/url/entered",[{textbox:this,url:_1e.url}]);
}
},handleMention:function(_1f){
if(!_1f){
console.log("Incomplete mention topic received");
return;
}
if(_1f.editor===this._editor&&_1f.mention){
this._mentions.push(_1f);
}
var _20=this.shouldNotify(_1f&&_1f.mention);
if(!_20){
_10(_1f);
}else{
if(dojo.isFunction(_20.then)){
_20.then(function(){
},dojo.partial(_10,_1f));
}
}
},handleRemoveMention:function(_21){
if(!_21){
console.log("Incomplete mention topic received");
return;
}
if(_21.editor===this._editor){
this._mentions=dojo.filter(this._mentions,function(_22){
return _22.node!=_21.node;
});
}
},shouldNotify:function(_23){
return true;
},setTypeAheadHeader:function(s){
if(_d(this)){
_f.call(this,function(){
this._editor.plugins.mentions.setTypeaheadHeader(s);
});
}else{
this._mentionsHelper&&this._mentionsHelper.setTypeaheadHeader(s);
}
},addMentionsCallback:function(_24,_25){
if(_d(this)){
_f.call(this,function(){
this._editor.plugins.mentions.addCallback(_24,_25,this._editor);
});
}else{
this._mentionsHelper&&this._mentionsHelper.addCallback(_24,_25);
}
},setDataStore:function(_26){
if(_26){
_f.call(this,function(){
this._editor.plugins.mentions.setDataStore(_26);
});
}
},setNetwork:function(_27){
if(_27){
_f.call(this,function(){
this._editor.plugins.mentions.setNetwork(_27);
});
}
},addCustomCSS:function(_28){
if(_28){
_f.call(this,function(){
_28.split(" ").forEach(function(_29){
this._editor.document.getBody().addClass(_29);
this._editor.ui.space("contents").addClass(_29);
},this);
});
}
},removeCustomCSS:function(_2a){
if(_2a){
_f.call(this,function(){
this._editor.document.getBody().removeClass(_2a);
this._editor.ui.space("contents").removeClass(_2a);
});
}
},isFocused:function(){
if(_d(this)){
return this._editor&&this._editor.focusManager&&this._editor.focusManager.hasFocus;
}
},onLoad:function(){
dojo.publish("lconn/core/lcTextArea/BasicTextBox/loaded",[this]);
}});
})();
}


;if(!dojo._hasResource["lconn.core.widget.mentions.MentionsDataFormatter"]){
dojo._hasResource["lconn.core.widget.mentions.MentionsDataFormatter"]=true;
dojo.provide("lconn.core.widget.mentions.MentionsDataFormatter");
dojo.declare("lconn.core.widget.mentions.MentionsDataFormatter",null,{mentionsContainer:null,fnContainer:null,idContainer:null,constructor:function(){
this._createMentionsContainer();
},formatData:function(_1){
var _2="";
var _3=_1&&_1.textData||[];
dojo.forEach(_3,dojo.hitch(this,function(_4){
if(_4.type==="text"||_4.type==="html"){
_2=_2.concat(_4.value);
}else{
_2=_2.concat(this._createMentionsMarkup(_4));
}
}));
return _2;
},_createMentionsContainer:function(){
this.container=dojo.create("div");
var _5=dojo.create("span",{className:"vcard"},this.container);
this.fnContainer=dojo.create("span",{className:"fn"},_5);
this.idContainer=dojo.create("span",{className:"x-lconn-userid"},_5);
},_createMentionsMarkup:function(_6){
var _7=_6.displayName?dojox.html.entities.encode(_6.displayName):"";
this.fnContainer.innerHTML=(_6.hasSymbol)?"@".concat(_7):_7;
this.idContainer.innerHTML=_6.userId||"";
return dojox.html.entities.decode(this.container.innerHTML);
}});
}


;if(!dojo._hasResource["lconn.share.legacytypeahead.TypeAhead"]){
dojo._hasResource["lconn.share.legacytypeahead.TypeAhead"]=true;
dojo.provide("lconn.share.legacytypeahead.TypeAhead");


dojo.declare("lconn.share.legacytypeahead.TypeAhead",[dijit.form.ComboBox],{formatItem:function(_1,_2){
if(!_2){
return _1;
}else{
return _1=_1.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");
}
},formatItemHtml:function(_3){
return this.formatItem(_3,true);
},minChars:1,hasDownArrow:false,multipleValues:true,token:"",selectOnTab:true,autoSearchKeys:[dojo.keys.DOWN_ARROW],autoSearchChars:[],autoSelectKeys:[],autoSelectChars:[],autoCompleteAnySelectChar:false,hintText:null,hideEmptyResults:false,autoComplete:false,postMixInProperties:function(){
if(dojo.version.minor>5){
delete this.hasDownArrow;
}
this.inherited(arguments);
},postCreate:function(){
var _4=this.focusNode;
var _5=this.domNode;
var _6=this.id+"_dommyDiv";
if(!dojo.byId(_6)){
var _7=document.createElement("div");
dijit.setWaiRole(_7,"presentation");
dojo.attr(_7,"aria-labelledby",_5.name);
_7.style.dispaly="none";
var _8=dojo.create("div",{id:_6,role:"textbox",style:{display:"none"}});
dojo.attr(_8,"aria-labelledby",_5.name);
_7.appendChild(_8);
dojo.body().appendChild(_7);
}
var _9=_4.style.fontFamily||"";
if(!this.downArrowNode){
this.downArrowNode=_5.parentNode.appendChild(dojo.create("div",{style:{display:"none"}}));
}
dijit.setWaiState(_5,"owns",_6);
dijit.setWaiRole(_5,"combobox");
this.inherited(arguments);
_4.style.fontFamily=_9;
this.updateHintText();
this.subscribe("lconn/core/typeahead/open",function(){
if(dojo.getObject("ibm.connections.sharedialog")){
ibm.connections.sharedialog.preventCloseOnEsc();
}
});
this.subscribe("lconn/core/typeahead/close",function(){
setTimeout(function(){
if(dojo.getObject("ibm.connections.sharedialog")){
ibm.connections.sharedialog.enableCloseOnEsc();
}
},100);
});
},_hideResultList:function(){
if(dojo.version.minor>5){
this.closeDropDown(true);
return;
}
this.inherited(arguments);
},_hideResultList:function(){
if(dojo.version.minor>5){
this.closeDropDown(true);
return;
}
this.inherited(arguments);
},_onFocus:function(_a){
this.updateHintText(null,true);
this.inherited(arguments);
},_onBlur:function(_b){
if(this.searchTimer){
(dojo.version.minor>=9)?this.searchTimer.remove():clearTimeout(this.searchTimer);
}
this.inherited(arguments);
this.updateHintText();
},setValue:function(){
this.inherited(arguments);
this.updateHintText();
},updateHintText:function(_c,_d){
if(_c){
this.hintText=_c;
}
var _e=this.focusNode;
if(this.hintText){
if(!_e.title){
_e.title=this.hintText;
}
if(!this._focused&&(_e.value==""||!_e.hasInput)){
_e.hasInput=false;
_e.style.color="#666";
_e.value=this.hintText||"";
if(dijit.focus.curNode==_e){
dijit.focus.curNode.blur();
}
}else{
if(!_e.hasInput){
_e.hasInput=true;
_e.style.color="#000";
if(_e.value!=""){
_e.value="";
if(_d&&dojo.isFF){
setTimeout(function(){
dijit.focus(_e);
},1);
}
}
if(_d&&dojo.isIE){
try{
dijit.selectInputText(_e,0,0);
}
catch(e){
}
}
}
}
}
},_normalize:function(_f,_10,_11){
var _12=this._getCaretPos(this.focusNode);
var _13=this.focusNode.value;
_f.lastIndex=0;
var pre=_13.substring(0,_12)+_10;
pre=pre.replace(_f,this.token);
_f.lastIndex=0;
var _14=_13.substring(_12);
_14=dojo.trim(_14).replace(_f,this.token);
if(pre&&_14&&dojo.isIE>8&&this.token==" "&&_11){
_13=pre+this.token+_14;
}else{
_13=pre+_14;
}
if(_13!=this.focusNode.value){
this.focusNode.value=_13;
this._setCaretPos(this.focusNode,pre.length);
}
},_onKeyPress:function(evt){
var key=evt.charOrCode;
if(this.multipleValues&&this.autoReplace&&evt.keyChar){
this.autoReplace.lastIndex=0;
if(this.autoReplace.exec(evt.keyChar)){
dojo.stopEvent(evt);
this._normalize(this.autoReplace,this.token);
key=evt.keyChar=this.token;
}
}
if(evt.altKey||(evt.ctrlKey&&(key!="x"&&key!="v"))||evt.key==dojo.keys.SHIFT){
return;
}
var _15=false;
var opt={};
var pw=this._popupWidget;
var dk=dojo.keys;
if(this._isShowingNow){
pw.handleKey(key);
}
if(!this._isShowingNow&&(dojo.indexOf(this.autoSearchKeys,evt.keyCode)>=0||dojo.indexOf(this.autoSearchChars,evt.keyChar)>=0)){
dojo.stopEvent(evt);
this._prev_key_backspace=false;
this._prev_key_esc=false;
_15=true;
opt.searchImmediately=true;
opt.highlightFirstOption=true;
}else{
if(dojo.indexOf(this.autoSelectKeys,evt.keyCode)>=0||dojo.indexOf(this.autoSelectChars,evt.keyChar)>=0){
this._prev_key_backspace=false;
this._prev_key_esc=false;
if(this.autoCompleteAnySelectChar){
if(this._isShowingNow){
var _16=pw.getHighlightedOption();
if(!_16){
try{
pw.highlightFirstOption();
_16=pw.getHighlightedOption();
}
catch(e){
}
}
if(_16){
if(!_16.selectHandler&&_16!=pw.nextButton&&_16!=pw.previousButton){
evt.preventDefault();
pw.attr("value",{target:_16});
}
}
}
this._lastQuery=null;
this._hideResultList();
}else{
dojo.stopEvent(evt);
_15=true;
opt.searchImmediately=true;
opt.highlightFirstOption=true;
opt.autoselectSingleResult=true;
}
}else{
switch(key){
case dk.PAGE_DOWN:
case dk.DOWN_ARROW:
if(!this._isShowingNow||this._prev_key_esc){
this._arrowPressed();
}else{
this._announceOption(pw.getHighlightedOption());
}
dojo.stopEvent(evt);
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
case dk.PAGE_UP:
case dk.UP_ARROW:
if(this._isShowingNow){
this._announceOption(pw.getHighlightedOption());
}
dojo.stopEvent(evt);
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
case dk.ENTER:
var _16;
if(this._isShowingNow&&(_16=pw.getHighlightedOption())){
if(_16.selectHandler){
if(_16.selectHandler(evt)){
return;
}
break;
}else{
if(_16==pw.nextButton){
this._nextSearch(1);
dojo.stopEvent(evt);
break;
}else{
if(_16==pw.previousButton){
this._nextSearch(-1);
dojo.stopEvent(evt);
break;
}
}
}
}else{
if(this._isShowingNow){
this._hideResultList();
}
break;
}
evt.preventDefault();
case dk.TAB:
if(!this.selectOnTab&&key==dk.TAB){
break;
}
var _17=this.attr("displayedValue");
if(pw&&((pw.getHighlightedOption()&&pw.getHighlightedOption().selectHandler)||_17==pw._messages["previousMessage"]||_17==pw._messages["nextMessage"])){
break;
}
if(this._isShowingNow){
this._prev_key_backspace=false;
this._prev_key_esc=false;
if(pw.getHighlightedOption()){
pw.attr("value",{target:pw.getHighlightedOption()});
}
this._lastQuery=null;
this._hideResultList();
}
break;
case dk.ESCAPE:
this._prev_key_backspace=false;
this._prev_key_esc=true;
if(this._isShowingNow){
dojo.stopEvent(evt);
this._hideResultList();
if(this.originalValue){
var _18=this._getCaretPos(this.focusNode);
this.focusNode.value=this.originalValue;
this._setCaretPos(this.focusNode,_18);
}
this.originalValue=null;
}
break;
case dk.DELETE:
case dk.BACKSPACE:
this._prev_key_esc=false;
this._prev_key_backspace=true;
_15=true;
break;
case dk.RIGHT_ARROW:
case dk.LEFT_ARROW:
this._prev_key_backspace=false;
this._prev_key_esc=false;
break;
default:
this._prev_key_backspace=false;
this._prev_key_esc=false;
_15=typeof key=="string"||key==229;
if(key==229){
opt.isIMEMode=true;
}
}
}
}
if(this.searchTimer){
(dojo.version.minor>=9)?this.searchTimer.remove():clearTimeout(this.searchTimer);
}
},_arrowPressed:function(){
if(!this.disabled&&!this.readOnly&&this.hasDownArrow){
dojo.addClass(this.downArrowNode,"dijitArrowButtonActive");
}
},_numTokensPreceding:function(str,pos){
var i=-1,_19=0;
while(i<pos){
i=str.indexOf(this.token,i+1);
if(i==-1){
i=str.length;
}else{
if(i<pos){
_19++;
}
}
}
return _19;
},_autoCompleteText:function(_1a){
var fn=this.focusNode;
var _1b=this._getCaretPos(fn);
dijit.selectInputText(fn,fn.value.length);
var _1c;
if(this.multipleValues){
_1c=fn.value.split(this.token);
}else{
_1c=[fn.value];
}
var _1d=0;
if(this.multipleValues){
_1d=this._numTokensPreceding(fn.value,_1b);
}
if(this.multipleValues&&this.token!=" "&&_1d>0){
_1a=" "+_1a;
}
var _1e=this.ignoreCase?"toLowerCase":"substr";
if(dojo.string.trim(_1a[_1e](0)).indexOf(dojo.string.trim(_1c[_1d][_1e](0)))==0){
if(_1b+1>fn.value.length||fn.value.charAt(_1b)==this.token){
var end=_1b+_1a.length-_1c[_1d].length;
_1c[_1d]=_1a;
fn.value=_1c.join(this.token);
dijit.selectInputText(fn,_1b,end);
}
}else{
_1c[_1d]=_1a;
fn.value=_1c.join(this.token);
var _1f=0;
for(var i=0;i<_1d;i++){
_1f+=_1c[i].length;
}
_1f+=this.token.length*_1d;
dijit.selectInputText(fn,_1f,_1f+_1a.length);
}
},_openResultList:function(_20,_21){
if(!this.domNode||this.disabled||this.readOnly||(_21.query!=this._lastQuery)){
return;
}
this._popupWidget.clearResultList();
if(!_20.length&&(this.hideEmptyResults||_21.hideEmptyResults)){
this._hideResultList();
return;
}
var _22=(_20.length>0)?new String(this.formatItem(_20[0])):null;
if(_22&&this.autoComplete&&!this._prev_key_backspace&&(_21.query!="")){
this._autoCompleteText(_22);
}
_21._maxOptions=this._maxOptions;
this._popupWidget.createOptions(_20,_21,dojo.hitch(this,"_getMenuLabelFromItem"));
if(_21.queryOptions.autoselectAnyResult||(_21.queryOptions.autoselectSingleResult&&_20.length==1)){
var pw=this._popupWidget;
var _23;
try{
pw.highlightFirstOption();
_23=pw.getHighlightedOption();
}
catch(e){
}
if(_23&&typeof _23.item!="string"){
pw.attr("value",{target:_23});
}
if(this._isShowingNow){
this._hideResultList();
}
return;
}
var _24=(dojo.version.minor>=9)?dijit.form.ComboBox.prototype.closeDropDown:dijit.form.ComboBox.prototype._hideResultList;
dijit.form.ComboBox.prototype._hideResultList=function(){
};
this._showResultList();
if(dojo.version.minor>=9){
dijit.form.ComboBox.prototype.closeDropDown=_24;
}else{
dijit.form.ComboBox.prototype._hideResultList=_24;
}
if(_21.direction){
if(1==_21.direction){
this._popupWidget.highlightFirstOption();
}else{
if(-1==_21.direction){
this._popupWidget.highlightLastOption();
}
}
this._announceOption(this._popupWidget.getHighlightedOption());
}else{
if(_21.queryOptions.highlightFirstOption){
this._popupWidget.highlightFirstOption();
this._announceOption(this._popupWidget.getHighlightedOption());
}else{
if(_22==_21.query){
this._popupWidget.highlightFirstOption();
}
}
}
},_showResultList:function(){
this.inherited(arguments);
var fn=this.focusNode;
var pw=this._popupWidget;
if(this._isShowingNow&&pw&&pw.id&&!dijit.getWaiState(fn,"activedescendant")){
dijit.setWaiState(fn,"activedescendant",pw.id);
}
},_announceOption:function(_25){
if(_25==null){
return;
}
var _26;
if(_25==this._popupWidget.nextButton||_25==this._popupWidget.previousButton||_25==this._popupWidget.searchButton){
_26=_25.innerHTML;
}else{
_26=this.formatItem(_25.item);
}
var _27=this._getCaretPos(this.focusNode);
if(this.multipleValues){
var _28=this.focusNode.value.split(this.token);
var _29=this._numTokensPreceding(this.focusNode.value,_27);
var q=this._lastQuery;
if(this.multipleValues&&this.token!=" "&&_29>0){
q=" "+q;
}
_28[_29]=q;
this.focusNode.value=_28.join(this.token);
}else{
this.focusNode.value=this.focusNode.value.substring(0,_27);
}
this._setCaretPos(this.focusNode,_27);
dijit.setWaiState(this.focusNode,"activedescendant",dojo.attr(_25,"id"));
this._autoCompleteText(_26);
},formatItemForInput:function(_2a){
var _2b=this.formatItem(_2a);
var key=_2b;
return key;
},_selectOption:function(evt){
var tgt=null;
if(!evt){
evt={target:this._popupWidget.getHighlightedOption()};
}
if(dojo.version.minor>=9&&evt.nodeType=="1"){
evt={target:evt};
}
if(!evt.target){
this.attr("displayedValue",this.attr("displayedValue"));
return;
}else{
tgt=evt.target;
}
if(!evt.noHide){
this._hideResultList();
}
if(!this.noUpdateOnSelect){
this._doSelect(tgt);
}
this.onSelect(tgt.item);
lconn.core.globalization.bidiUtil.enforceTextDirectionOnPage();
},_doSelect:function(tgt){
var _2c=this.formatItemForInput(tgt.item);
if(this.multipleValues){
var _2d=this.keyArr[this.keyIdx];
this.keyArr[this.keyIdx]=(this.keyIdx!=0&&this.token!=" "?" ":"")+_2c;
_2c=this.keyArr.join(this.token);
var _2e=this.token+(this.token!=" "?" ":"");
if(_2c.length>=_2e.length&&_2c.substring(_2c.length-_2e.length)!=_2e){
_2c+=_2e;
}
}else{
this.item=tgt.item;
}
this.attr("value",_2c);
this._setCaretPos(this.focusNode,_2c.length);
},onSelect:function(_2f){
},_startSearchFromInput:function(opt){
if(this.multipleValues&&this.autoReplace){
var _30=(opt&&opt.isIMEMode);
this._normalize(this.autoReplace,"",_30);
}
var _31=this.originalValue=this.focusNode.value;
var _32=_31;
if(this.multipleValues){
this.keyArr=_31.split(this.token);
this.caretPos=this._getCaretPos(this.focusNode);
this.keyIdx=this._numTokensPreceding(_31,this.caretPos);
_32=this.keyArr[this.keyIdx];
}
_32=dojo.string.trim(_32);
if(this.shouldStartSearch(_32)){
this._startSearch(_32,opt);
}else{
this._hideResultList();
}
},shouldStartSearch:function(_33){
var _34;
if(this.store&&this.store.shouldStartSearch){
_34=this.store.shouldStartSearch(_33);
}
if(typeof _34=="undefined"){
var _35=this.minChars;
if(_33.length>=_35){
return true;
}
var _36=0;
var _37=encodeURIComponent(_33);
var _38=Math.min(_37.length,_35);
for(var i=0;i<_38;i++){
_36++;
if(_37.charAt(i)=="%"){
i+=2;
}
}
_34=_36>=_35;
}
return _34;
},_startSearch:function(key,opt){
opt=opt||{};
if(!this._popupWidget){
var _39=this.id+"_popup";
this._popupWidget=this.dropDown=new dijit.form._ComboBoxMenu({onChange:dojo.hitch(this,this._selectOption),id:_39});
dijit.setWaiRole(this._popupWidget.domNode,"listbox");
dijit.removeWaiState(this.focusNode,"activedescendant");
dijit.setWaiState(this.textbox,"owns",_39);
}
this.item=null;
var _3a=dojo.clone(this.query);
this._lastInput=key;
this._lastQuery=_3a=key;
var _3b=dojo.hitch(this,function(_3c,_3d){
var _3e={queryOptions:dojo.mixin({ignoreCase:this.ignoreCase,deep:true},opt),query:_3c,onComplete:dojo.hitch(this,"_openResultList"),onError:function(_3f){
console.error("dijit.form.ComboBox: "+_3f);
dojo.hitch(_3d,"_hideResultList")();
},start:0,count:this.pageSize};
dojo.mixin(_3e,_3d.fetchProperties);
var _40=_3d.store.fetch(_3e);
var _41=function(_42,_43){
_42.start+=_42.count*_43;
_42.direction=_43;
this.store.fetch(_42);
};
this._nextSearch=this._popupWidget.onPage=dojo.hitch(this,_41,_40);
},_3a,this);
var _44=opt.searchImmediately?1:this.getSearchDelay(_3a);
this.searchTimer=(dojo.version.minor>=9)?this.defer(_3b,_44):setTimeout(_3b,_44);
},getSearchDelay:function(_45){
if(this.store&&this.store.getSearchDelay){
return this.store.getSearchDelay(_45);
}else{
return this.searchDelay;
}
},getAttribute:function(_46){
if(this.item&&this.item[_46]){
return this.item[_46];
}else{
return "";
}
},getTextBoxValue:function(){
return this.focusNode.value;
},_getMenuLabelFromItem:function(_47){
var _48=this.formatItemHtml(_47);
var key="";
if(this.multipleValues){
key=dojo.string.trim(this.keyArr[this.keyIdx]);
}else{
key=dojo.string.trim(this.focusNode.value);
}
key=key.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");
var _49=_48.toLowerCase();
var _4a=key.toLowerCase();
var _4b=0;
var _4c=null;
var _4d=_4a.split(/\s/);
var sbf=[];
for(var i=0;i<_4d.length;i++){
var s=_4d[i];
var _4c=_49.indexOf(s,_4b);
if(_4c!=-1){
sbf.push(_48.substring(_4b,_4c));
sbf.push("<b>");
sbf.push(_48.substring(_4c,_4c+s.length));
sbf.push("</b>");
_4b=_4c+s.length;
}
}
sbf.push(_48.substring(_4b));
return {html:true,label:sbf.join("")};
}});
}


;dojo.cache("lconn.share", "widget/templates/TypeAhead.html", "<span><input type=\"text\" autocomplete=\"off\" ${nameAttrSetting} id=\"widget_${id}\" size=\"${size}\" dojoAttachEvent=\"onkeypress:_onKeyPress, onkeyup:_onKeyUp\" dojoAttachPoint=\"domNode,textbox,focusNode,comboNode,_popupStateNode\" waiState=\"haspopup-true,autocomplete-list,expanded-false\" waiRole=\"combobox\" /><span style=\"display:none\" dojoAttachPoint=\"_buttonNode\"></span></span>");

;if(!dojo._hasResource["lconn.share.widget.TypeAhead"]){
dojo._hasResource["lconn.share.widget.TypeAhead"]=true;
dojo.provide("lconn.share.widget.TypeAhead");






dojo.declare("lconn.share.widget.TypeAhead",[lconn.share.legacytypeahead.TypeAhead],{className:"lotusText",size:"",pageSize:15,templateString:null,templatePath:dojo.moduleUrl("lconn.share","widget/templates/TypeAhead.html"),multipleValues:false,hasDownArrow:false,minChars:2,searchDelay:400,nameAttr:"name",searchOpts:null,postMixInProperties:function(){
if(dojo.version.minor>5){
delete this.hasDownArrow;
}
this.inherited(arguments);
this.baseClass=this.className;
},formatItem:function(_1){
if(_1[this.nameAttr]){
return _1[this.nameAttr];
}
return _1;
},formatItemHtml:function(_2){
var s=(_2[this.nameAttr])?_2[this.nameAttr]:_2;
var el=document.createElement("div");
el.appendChild(document.createTextNode(s));
return el.innerHTML;
},decorateItem:function(el,_3){
},_hideResultList:function(){
if(dojo.version.minor>5){
this.closeDropDown(true);
return;
}
this.inherited(arguments);
},_hideResultList:function(){
if(dojo.version.minor>5){
this.closeDropDown(true);
return;
}
this.inherited(arguments);
},_startSearch:function(_4,_5){
var _6={};
if(this.searchOpts){
_6=dojo.mixin(_6,this.searchOpts);
}
if(_5){
_6=dojo.mixin(_6,_5);
}
if(!this._popupWidget){
var _7=this.id+"_popup";
this._popupWidget=this.dropDown=new lconn.share.widget.TypeAheadMenu({_strings:this._strings,onChange:dojo.hitch(this,this._selectOption),decorateItem:dojo.hitch(this,this.decorateItem),id:_7});
dijit.removeWaiState(this.focusNode,"activedescendant");
dijit.setWaiState(this.textbox,"owns",_7);
if(this.popupClassName){
dojo.addClass(this.dropDown.domNode,this.popupClassName);
}
}
this.item=null;
var _8=dojo.clone(this.query);
this._lastQuery=_8=_4;
if(this.searchTimer){
(dojo.version.minor>=9)?this.searchTimer.remove():clearTimeout(this.searchTimer);
}
var _9=dojo.hitch(this,function(_a,_b){
var _c=this.store.fetch({queryOptions:dojo.mixin({ignoreCase:this.ignoreCase,deep:true},_6),query:_a,onComplete:dojo.hitch(this,"_openResultList"),onError:function(_d){
dojo.hitch(_b,"_hideResultList")();
},start:0,count:this.pageSize});
var _e=function(_f,_10){
_f.start+=_f.count*_10;
_f.direction=_10;
this.store.fetch(_f);
};
this._nextSearch=this._popupWidget.onPage=dojo.hitch(this,_e,_c);
},_8,this);
var _11=_6.searchImmediately?1:this.searchDelay;
this.searchTimer=(dojo.version.minor>=9)?this.defer(_9,_11):setTimeout(_9,_11);
},_openResultList:function(){
if(!this._focused){
return;
}
return this.inherited(arguments);
}});
dojo.declare("lconn.share.widget.TypeAheadMenu",[dijit.form._ComboBoxMenu],{templateString:"<ul role='listbox' class='dijitReset dijitMenu lotusui30dojo' dojoAttachPoint='containerNode' dojoAttachEvent='onmousedown:_onMouseDown,onmouseup:_onMouseUp,onmouseover:_onMouseOver,onmouseout:_onMouseOut' tabIndex='-1' style='overflow:\"auto\";'>"+"<li class='dijitMenuItem dijitMenuPreviousButton' dojoAttachPoint='previousButton'></li>"+"<li class='dijitMenuItem dijitMenuItemRtl resultsNode' dojoAttachPoint='resultsNode'></li>"+"<li class='dijitMenuItem dijitMenuNextButton' dojoAttachPoint='nextButton'></li>"+"</ul>",_messages:null,postCreate:function(){
this.resultsNode.selectHandler=dojo.hitch(this,function(evt){
dojo.stopEvent(evt);
return true;
});
this.inherited("postCreate",arguments);
},setValue:function(_12){
if(_12.target.item){
this.value=_12;
this.onChange(_12);
}
},_onMouseUp:function(evt){
if(evt.target!=this.resultsNode){
this.inherited("_onMouseUp",arguments);
}
},_onMouseOver:function(evt){
if(evt.target===this.domNode){
return;
}
var tgt=evt.target;
if(!(tgt==this.previousButton||tgt==this.nextButton||tgt==this.resultsNode)){
while(!tgt.item){
tgt=tgt.parentNode;
}
}
this._focusOptionNode(tgt);
},_blurOptionNode:function(){
if(this._highlighted_option){
dojo.removeClass(this._highlighted_option,"dijitMenuItemHover");
this._highlighted_option=null;
}
this.inherited(arguments);
},_focusOptionNode:function(_13){
if(this._highlighted_option!=_13){
this._blurOptionNode();
this._highlighted_option=_13;
dojo.addClass(this._highlighted_option,"dijitMenuItemHover");
}
this.inherited(arguments);
},createOptions:function(_14,_15,_16){
dojo.publish("lconn/core/typeahead/open");
this.clearResultList();
this.previousButton.style.display=(!_15.start||_15.start==0)?"none":"";
dojo.attr(this.previousButton,"id",this.id+"_prev");
dojo.forEach(_14,function(_17,i){
if(_15.count&&i>=_15.count){
return;
}
var _18=this._createOption(_17,_16);
_18.className=this.isLeftToRight()?"dijitMenuItem":"dijitMenuItem dijitMenuItemRtl";
dojo.attr(_18,"id",this.id+i);
if(this.decorateItem){
this.decorateItem(_18,_17);
}
this.domNode.style.width="";
this.domNode.insertBefore(_18,this.nextButton);
},this);
this.nextButton.style.display=(_15.count&&_15.count<_14.length)?"":"none";
dojo.attr(this.nextButton,"id",this.id+"_next");
var el=this.resultsNode;
if(_14.length==0){
var _19=lconn.share.util.text.trimToLength(dojo.string.substitute(this._strings.NO_RESULTS,[_15.query]),55);
while(el.firstChild){
el.removeChild(el.firstChild);
}
el.appendChild(document.createTextNode(_19));
el.item=_19;
this.domNode.insertBefore(el,this.nextButton);
}
},_createOption:function(_1a,_1b){
var _1c=_1b(_1a);
var _1d=document.createElement("li");
dijit.setWaiRole(_1d,"option");
if(_1a.userid){
dojo.attr(_1d,"exid",_1a.userid);
}
if(_1c.html){
_1d.innerHTML=_1c.label;
}else{
_1d.appendChild(document.createTextNode(_1c.label));
}
if(_1d.innerHTML==""){
_1d.innerHTML="&nbsp;";
}
_1d.item=_1a;
return _1d;
},clearResultList:function(){
var _1e=this.previousButton;
var _1f=this.nextButton;
while(_1e.nextSibling&&_1e.nextSibling!=_1f){
this.domNode.removeChild(_1e.nextSibling);
}
},getListLength:function(){
return this.domNode.childNodes.length-2-(this.resultsNode.parentNode?1:0);
},onClose:function(){
dojo.publish("lconn/core/typeahead/close");
this.inherited(arguments);
}});
}


;if(!dojo._hasResource["lconn.share.widget.TagTypeAhead"]){
dojo._hasResource["lconn.share.widget.TagTypeAhead"]=true;
dojo.provide("lconn.share.widget.TagTypeAhead");


dojo.declare("lconn.share.widget.TagTypeAhead",[lconn.share.widget.TypeAhead],{autoReplace:/[\s\u3000,]+/g,autoSelectChars:[" ","\u3000",","],libraryId:null,userLibrary:null,minChars:1,decorateItem:function(el,_1){
if(_1.weight>=1){
dojo.addClass(el,"lotusAlignRight");
el.style.listStyle="none";
var _2=document.createElement("span");
_2.className="lotusLeft";
while(el.firstChild){
_2.appendChild(el.firstChild);
}
el.appendChild(_2);
var _2=document.createElement("span");
_2.className="lotusMeta";
_2.appendChild(document.createTextNode("\xa0"));
_2.appendChild(document.createTextNode(_1.weight));
el.appendChild(_2);
}
},_startSearch:function(_3,_4){
_4=_4||{};
_4.userLibrary=_4.userLibrary||this.userLibrary;
_4.libraryId=_4.libraryId||this.libraryId;
arguments[1]=_4;
this.inherited(arguments);
}});
}


;if(!dojo._hasResource["lconn.share.util.uri"]){
dojo._hasResource["lconn.share.util.uri"]=true;
dojo.provide("lconn.share.util.uri");


lconn.share.util.uri.parseUri=lconn.core.url.parse;
lconn.share.util.uri.writeUri=lconn.core.url.write;
lconn.share.util.uri.rewriteUri=lconn.core.url.rewrite;
lconn.share.util.uri.splitQuery=lconn.core.url.splitQuery;
lconn.share.util.uri.getRequestParameters=lconn.core.url.getRequestParameters;
lconn.share.util.uri.writeParameters=lconn.core.url.writeParameters;
lconn.share.util.uri.makeAtomUrlIESafe=function(_1){
if(dojo.isIE&&_1){
_1=lconn.core.url.parse(_1);
_1.queryParameters.format="xml";
_1=lconn.core.url.write(_1);
}
return _1;
};
}


;if(!dojo._hasResource["lconn.share.util._dom"]){
dojo._hasResource["lconn.share.util._dom"]=true;
dojo.provide("lconn.share.util._dom");
lconn.share.util.dom={XML_DECLARATION:"<?xml version=\"1.0\" encoding=\"UTF-8\"?>",XML_DECLARATION_WITH_ENTITIES:"<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE html [<!ENTITY amp \"&#38;#38;\"><!ENTITY lt \"&#60;#60;\"><!ENTITY gt \"&#62;#62;\"><!ENTITY nbsp \"&#32;\"><!ENTITY apos \"&#39;\"><!ENTITY quot \"&#34;\">]>",NAMESPACES:{ATOM:{LONG:"http://www.w3.org/2005/Atom",SHORT:"atom"},DOCUMENTS_ATOM:{LONG:"urn:ibm.com/td",SHORT:"td"},APP:{LONG:"http://www.w3.org/2007/app",SHORT:"app"},CMISRA:{LONG:"http://docs.oasis-open.org/ns/cmis/restatom/200908/",SHORT:"cmisra"},CMISM:{LONG:"http://docs.oasis-open.org/ns/cmis/messaging/200908/",SHORT:"cmism"},LCMIS:{LONG:"http://www.ibm.com/xmlns/prod/sn/cmis",SHORT:"lcmis"},CMIS:{LONG:"http://docs.oasis-open.org/ns/cmis/core/200908/",SHORT:"cmis"}},NAMESPACE_PREFIX:{},xmlText:function(_1){
return (_1)?(dojo.isIE?(_1.text?_1.text:_1.innerText):_1.textContent):_1;
},isNamedNS:function(el,_2,_3){
var _4=el.localName;
if(dojo.isIE){
if(!_4){
_4=el.baseName;
}
}
if(_3){
return _4==_2&&_3.LONG==el.namespaceURI;
}
return el.nodeName==_2;
},getChildElementTextContentNS:function(el,_5,_6){
if(!el){
return null;
}
var c;
var _7=el.childNodes;
if(dojo.isIE){
for(var i=0;c=_7[i];i++){
var _8=c.localName;
if(!_8){
_8=c.baseName;
}
if(_8==_5&&(_6==null||c.namespaceURI==_6.LONG)){
if(c.innerText){
return c.innerText;
}
var a=[];
for(var j=0;c2=c.childNodes[j];j++){
if(c2.nodeType==3){
a.push(c2.nodeValue);
}
}
return a.join("");
}
}
}else{
var _7=el.getElementsByTagNameNS(_6.LONG,_5);
for(var i=0,c;c=_7[i];i++){
if(c.parentNode==el){
if(c.textContent){
return c.textContent;
}
var a=[];
for(var j=0;c2=c.childNodes[j];j++){
if(c2.nodeType==3){
a.push(c2.nodeValue);
}
}
return a.join("");
}
}
}
return null;
}};
var dom=lconn.share.util.dom;
var n1=dom.NAMESPACES;
for(var key in n1){
var value=n1[key];
dom[key+"_NAMESPACE"]=value;
dom.NAMESPACE_PREFIX[value.SHORT]=value.LONG;
}
}


;if(!dojo._hasResource["lconn.share.util.atom"]){
dojo._hasResource["lconn.share.util.atom"]=true;
dojo.provide("lconn.share.util.atom");


lconn.share.util.atom._htmlText=function(el){
if(!el){
return null;
}
var a=[];
for(var j=0;c=el.childNodes[j];j++){
if(c.nodeType==3){
a.push(c.nodeValue);
}
}
return a.length>0?a.join(""):null;
};
lconn.share.util.atom.getErrorCode=function(_1,_2){
var _3=lconn.share.util.atom.getError(_1,_2);
return (_3?_3.code:null);
};
lconn.share.util.atom._CMIS_ERROR_CODES={"objectNotFound":"ItemNotFound","permissionDenied":"AccessDenied","contentAlreadyExists":"ItemExists","updateConflict":"ConcurrentModification","nameConstraintViolation":"InvalidPath"};
lconn.share.util.atom.getError=function(_4,_5,_6){
if(_4 instanceof Error&&_4.code){
return _4;
}
var _7=null;
var _8=_4;
_4=_4||{};
_5=_5||{};
var _9=_5.xhr;
var _a;
try{
if(_9){
_a=_9.status;
}
}
catch(e){
}
var _b;
try{
if(_9){
var h=_9.getResponseHeader("X-LConn-Auth");
_b=(h=="true"||h=="false");
}
}
catch(e){
}
if(dojo.isIE&&_a==1223){
_a=204;
}
var _c=false;
_c=_c||_4 instanceof Error;
_c=_c||(_a>0&&!(_a>=200&&_a<300));
_c=_c||(dojo.isIE&&_4.number==-2147024891);
if(_6&&_6.requireData){
_c=_c||(_5.handleAs=="xml"&&!_4.documentElement);
_c=_c||(dojo.indexOf(["json","json-comment-filtered"],_5.handleAs)!=-1&&(!_8||typeof _8!="object"));
}
if(_c){
_7=new Error();
if("cancel"==_4.dojoType&&_5.error&&typeof _5.error=="object"){
var _d=_5.error;
if(_d.name=="NS_ERROR_FILE_ACCESS_DENIED"){
_7.message=_7.code="FileAccessDenied";
}
}
if(!_7.code&&dojo.indexOf(["cancel","timeout","unauthenticated"],_4.dojoType)!=-1){
_7.message=_7.code=_7.dojoType=_4.dojoType;
}
if(!_7.code&&dojo.isIE&&_4.number==-2147024891){
_7.message=_7.code="FileDoesNotExist";
}
if(!_7.code&&_a==412&&_9&&_9.responseXML&&_9.responseXML.documentElement&&lconn.share.util.dom.isNamedNS(_9.responseXML.documentElement,"entry",lconn.share.util.dom.NAMESPACES.ATOM)){
_7.message=_7.code="ConcurrentModification";
_7.entry=_9.responseXML.documentElement;
}
if(!_7.code&&_9&&_9.responseXML&&_9.responseXML.documentElement){
var el=_9.responseXML.documentElement;
var _e=lconn.share.util.dom.getChildElementTextContentNS(el,"errorCode",lconn.share.util.dom.DOCUMENTS_ATOM_NAMESPACE);
if(!_e){
_e=lconn.share.util.dom.getChildElementTextContentNS(el,"code",lconn.share.util.dom.LCMIS_NAMESPACE);
if(_e){
_e=lconn.share.util.atom._CMIS_ERROR_CODES[_e]||"unknown";
}
}
var _f=(_e?dojo.trim(_e):"");
if(_f.length>0){
_7.message=_7.code=_f;
_7.el=el;
_7.message=lconn.share.util.dom.getChildElementTextContentNS(el,"errorMessage",lconn.share.util.dom.DOCUMENTS_ATOM_NAMESPACE);
if(!_7.message){
_7.message=lconn.share.util.dom.getChildElementTextContentNS(el,"message",lconn.share.util.dom.LCMIS_NAMESPACE);
}
if(_f=="ConstraintViolation"){
_7.violationType=lconn.share.util.dom.getChildElementTextContentNS(el,"violationType",lconn.share.util.dom.DOCUMENTS_ATOM_NAMESPACE);
}
if(_f=="QuotaViolation"){
_7.libraryQuota=parseInt(lconn.share.util.dom.getChildElementTextContentNS(el,"libraryQuota",lconn.share.util.dom.DOCUMENTS_ATOM_NAMESPACE));
_7.librarySize=parseInt(lconn.share.util.dom.getChildElementTextContentNS(el,"librarySize",lconn.share.util.dom.DOCUMENTS_ATOM_NAMESPACE));
_7.uploadSize=parseInt(lconn.share.util.dom.getChildElementTextContentNS(el,"uploadSize",lconn.share.util.dom.DOCUMENTS_ATOM_NAMESPACE));
}else{
if(_f=="ExtensionViolation"){
_7.extension=lconn.share.util.dom.getChildElementTextContentNS(el,"extension",lconn.share.util.dom.DOCUMENTS_ATOM_NAMESPACE);
}
}
}
}
if(!_7.code&&_a==404){
if(_b==false){
_7.message=_7.dojoType=_7.code="timeout";
}else{
_7.message=_7.code="ItemNotFound";
}
}
if(!_7.code&&(_a==502||_a==504)){
_7.message=_7.code="ProxyTimeout";
}
if(!_7.code){
_7.message=_7.code="unknown";
}
if(_a==412&&_7.code=="InvalidUser"){
_7.message=_7.code="SessionInvalidated";
}
}
return _7;
};
lconn.share.util.atom.getJsonResponseFromHtml=function(d){
var r={};
try{
if(d&&d.body){
var _10=dojo.filter(d.getElementsByTagName("meta"),function(el){
return el.name=="status";
})[0];
r.status=_10?parseInt(_10.content):200||200;
try{
var _11=lconn.share.util.atom._htmlText(d.body);
var _12=dojo.fromJson(_11);
if(typeof _12=="object"){
r.contents=_12;
}
}
catch(e){
console.log("util::getJsonResponseFromHtml DEBUG innerHTML not JSON");
}
}
}
catch(e){
console.log("util::getJsonResponseFromHtml DEBUG unable to access body");
}
return r;
};
lconn.share.util.atom.getJsonError=function(r){
if(r&&r.status==404){
var _13=new Error();
_13.message=_13.code="ItemNotFound";
return _13;
}
if(!r||!r.contents||typeof r.contents!="object"){
var _13=new Error();
_13.message=_13.code="unknown";
return _13;
}
if(r.status==412){
var _13=new Error();
_13.message=_13.code="ConcurrentModification";
_13.entry=r.contents;
return _13;
}else{
if(typeof r.contents.errorCode=="string"){
var _13=new Error();
_13.message=r.contents.errorMessage;
_13.code=r.contents.errorCode;
for(var key in r.contents){
if(key!="errorCode"&&key!="errorMessage"){
_13[key]=r.contents[key];
}
}
return _13;
}else{
if(typeof r.contents.code=="string"){
var _13=new Error();
_13.message=r.contents.message;
_13.code=lconn.share.util.atom._CMIS_ERROR_CODES[r.contents.code]||"unknown";
for(var key in r.contents){
if(key!="code"&&key!="message"){
_13[key]=r.contents[key];
}
}
return _13;
}else{
if(r.status<200||r.status>=300){
var _13=new Error();
_13.message=_13.code="unknown";
return _13;
}
}
}
}
return null;
};
lconn.share.util.atom.detectLoginForMultipartResponse=function(_14,_15){
var _16=false;
if(_14&&!(_14 instanceof Error)){
var _17;
try{
_17=_14.body;
}
catch(e){
}
if(_17&&!dojo.hasClass(_17,"X-LConn-API-Response")){
_16=true;
console.log("util::detectLoginForMultipartAtomResponse DEBUG The body of the document does not have the expected class");
}
}
return _16;
};
lconn.share.util.atom.createOperationId=function(){
var s=dojo._toArray(arguments).join("_");
if(s.length>256){
s=s.substring(0,256);
}
return dojo.trim(s);
};
}


;if(!dojo._hasResource["lconn.share.util.Network"]){
dojo._hasResource["lconn.share.util.Network"]=true;
dojo.provide("lconn.share.util.Network");








dojo.declare("lconn.share.util.Network",null,{csrf:{cookie:"X-Update-Nonce",header:"X-Update-Nonce",param:"nonce"},_handleAsMap:{"text":"Text","html":"Text","xml":"Xml","json":"Json","json-embedded":"Json","json-comment-optional":"Json","json-comment-filtered":"Json"},constructor:function(_1){
if(_1){
dojo.mixin(this,_1);
}
this.inflight=[];
},_validate:function(_2){
if(!_2){
throw "opts is a required argument";
}
if(!_2.url){
throw "url is a required argument";
}
},_getNonce:function(_3){
var _4=null;
if(_3&&_3.nonce){
_4=_3.nonce;
}
var _5=this.getAuthenticatedUser();
if(!_4&&_5&&_5.nonce){
_4=_5.nonce;
}
var _6=dojo.cookie(this.csrf.cookie);
if(!_4&&_6){
_4=_6;
}
return _4||"true";
},_setDefaults:function(_7,_8){
var _9=this.getAuthenticatedUser();
_8.verb=_7=_7.toLowerCase();
switch(_7){
case "put":
case "post":
case "delete":
_8.auth=_8.auth||{};
if(typeof _8.auth.preventReload=="undefined"){
_8.auth.preventReload=true;
}
if(typeof _8.timeout=="undefined"){
_8.timeout=(dojo.getObject("lconn.share.config.services.timeout.update")||10)*1000;
}
break;
default:
if(typeof _8.timeout=="undefined"){
_8.timeout=(dojo.getObject("lconn.share.config.services.timeout.request")||10)*1000;
}
}
_8.nonce=this._getNonce(_8);
_8.failOk=true;
if(_7=="get"&&_8.requireData!==false){
_8.requireData=true;
}
var _a=_8.ifMatch;
_8.headers=_8.headers||{};
if(!_a&&_8.headers["If-Match"]){
_a=_8.headers["If-Match"];
}
delete _8.headers["If-Match"];
_a=dojo.trim(_a||"");
var _b=(_8.auth?_8.auth.secured:undefined);
if(_9&&_b!=false&&(_b==true||this.isSecuredUrl(_8.url))){
if(_a.length>0){
_a+=":";
}
_a+="uid="+_9.id;
}
if(_a.length>0){
_8.ifMatch=_a;
}else{
delete _8.ifMatch;
}
if(_8.handleAs=="xml"&&dojo.isIE){
var _c=lconn.share.util.uri.parseUri(_8.url);
if(!_c.queryParameters.format){
_c.queryParameters.format="xml";
_8.url=lconn.share.util.uri.writeUri(_c);
}
}
},_setXmlDefaults:function(_d,_e){
this._validate(_e);
_e.handleAs="xml";
this._setDefaults(_d,_e);
},_setJsonDefaults:function(_f,_10){
this._validate(_10);
_10.handleAs=_10.handleAs||"json";
this._setDefaults(_f,_10);
},_setTextDefaults:function(_11,_12){
this._validate(_12);
_12.handleAs=_12.handleAs||"text";
this._setDefaults(_11,_12);
},_setMultipartDefaults:function(_13,_14){
this._validate(_14);
if(typeof _14.timeout=="undefined"){
_14.timeout=(dojo.getObject("lconn.share.config.services.timeout.upload")||0)*1000;
}
_14.handleAs=_14.handleAs||"json-embedded";
this._setDefaults(_13,_14);
},_addDirectives:function(_15,_16,_17,_18,_19){
if(_17){
_15.headers=_15.headers||{};
_15.headers[this.csrf.header]=_15.nonce;
}
if(_18){
var uri=lconn.share.util.uri.parseUri(_15.url);
uri.queryParameters[this.csrf.param]=_15.nonce;
}
if(_19){
_15.content=_15.content||{};
_15.content[this.csrf.param]=_15.nonce;
}
for(var key in _16){
var _1a=_16[key];
if(typeof (_1a)!="undefined"&&_16.hasOwnProperty(key)){
if(_17){
_15.headers[key]=_1a;
}
if(_18){
uri.queryParameters[key]=_1a;
}
if(_19){
_15.content[key]=_1a;
}
}
}
if(_18){
_15.url=lconn.share.util.uri.writeUri(uri);
}
},_dfdcaller:function(f,_1b){
try{
return f(_1b,this.ioArgs);
}
catch(e){
console.error("Network._dfdcaller",e);
if(dojo.config.isDebug){
debugger;
}
throw e;
}
},cancel:function(){
for(var i=0,dfd;dfd=this.inflight[i];){
if(dfd.interruptible!==false){
this.inflight.splice(i,1);
try{
dfd.cancel();
}
catch(e){
console.error(e);
}
}else{
i++;
}
}
},get:function(_1c){
return this._delegate("get",_1c);
},head:function(_1d){
return this._delegate("head",_1d);
},put:function(_1e){
return this._delegate("put",_1e);
},post:function(_1f){
return this._delegate("post",_1f);
},_delegate:function(_20,_21){
this._validate(_21);
var _22=this._handleAsMap[_21.handleAs];
if(!_22){
throw ("Unsupported handleAs type "+_21.handleAs);
}
var op=this[_20.toLowerCase()+_22];
if(typeof (op)!="function"){
throw ("Unsupported operation "+_20+" for handleAs type "+_21.handleAs);
}
return op.apply(this,[_21]);
},_sendXhr:function(_23,_24,raw){
if(this.wrapOpts){
_24=this.wrapOpts(_24);
}
try{
if(_24.onUploadProgress){
var f=dojo._xhrObj;
dojo._xhrObj=function(){
var ret=f.apply(this,arguments);
dojo._xhrObj=f;
if(ret.upload){
ret.upload.addEventListener("progress",_24.onUploadProgress,false);
}
return ret;
};
}
var _25=this._dfdcaller;
var _26=_24.handle?dojo.hitch(_24,_25,_24.handle):null;
var _27=_24.load?dojo.hitch(_24,_25,_24.load):null;
var _28=_24.error?dojo.hitch(_24,_25,_24.error):null;
_24.handle=dojo.hitch(this,"_handle");
_24.load=_24.error=null;
if(_24.handleAs=="json-embedded"){
_24.handleAs="html";
_24._xhrHandleAs="json-embedded";
}
this.onNetwork(_24);
var dfd=dojo.xhr(_23,_24,raw);
this.inflight.push(dfd);
_24.dfd=dfd;
if(_23!="GET"||_24.background){
dfd.interruptible=false;
}
if(_26){
dfd.addBoth(_26);
}
if(_27){
dfd.addCallback(_27);
}
if(_28){
dfd.addErrback(_28);
}
return dfd;
}
catch(e){
this._openFailure(e,_24);
}
},_sendIframe:function(_29){
try{
var _2a=this._dfdcaller;
var _2b=_29.handle?dojo.hitch(_29,_2a,_29.handle):null;
var _2c=_29.load?dojo.hitch(_29,_2a,_29.load):null;
var _2d=_29.error?dojo.hitch(_29,_2a,_29.error):null;
_29.handle=dojo.hitch(this,"_handle");
_29.load=_29.error=null;
if(_29.handleAs=="json-embedded"){
_29.handleAs="html";
_29._xhrHandleAs="json-embedded";
}
this.onNetwork(_29);
var _2e=_29.content;
if(dojo.isIE&&_2e){
for(var key in _2e){
if(_2e[key]==undefined){
_2e[key]="";
}
}
}
var dfd=dojo.io.iframe.send(_29);
this.inflight.push(dfd);
_29.dfd=dfd;
dfd.interruptible=false;
if(_2b){
dfd.addBoth(_2b);
}
if(_2c){
dfd.addCallback(_2c);
}
if(_2d){
dfd.addErrback(_2d);
}
return dfd;
}
catch(e){
this._openFailure(e,_29);
}
},getXml:function(_2f){
this._setXmlDefaults("get",_2f);
this._addDirectives(_2f,{"If-Match":_2f.ifMatch},true,false,false);
return this._sendXhr("GET",_2f,false);
},headXml:function(_30){
this._setXmlDefaults("head",_30);
this._addDirectives(_30,{"If-Match":_30.ifMatch},true,false,false);
return this._sendXhr("HEAD",_30,false);
},postXml:function(_31){
this._setXmlDefaults("post",_31);
this._addDirectives(_31,{"If-Match":_31.ifMatch},true,false,false);
return this._sendXhr("POST",_31,true);
},putXml:function(_32){
this._setXmlDefaults("put",_32);
this._addDirectives(_32,{"X-Method-Override":"PUT","If-Match":_32.ifMatch},true,false,false);
return this._sendXhr("POST",_32,true);
},deleteXml:function(_33){
this._setXmlDefaults("delete",_33);
this._addDirectives(_33,{"X-Method-Override":"DELETE","If-Match":_33.ifMatch},true,false,false);
return this._sendXhr("POST",_33,true);
},getJson:function(_34){
this._setJsonDefaults("get",_34);
this._addDirectives(_34,{"If-Match":_34.ifMatch},true,false,false);
return this._sendXhr("GET",_34,false);
},postJson:function(_35){
this._setJsonDefaults("post",_35);
this._addDirectives(_35,{"If-Match":_35.ifMatch},true,false,false);
return this._sendXhr("POST",_35,false);
},getText:function(_36){
this._setTextDefaults("get",_36);
this._addDirectives(_36,{"If-Match":_36.ifMatch},true,false,false);
return this._sendXhr("GET",_36,false);
},putMultipart:function(_37){
this._setMultipartDefaults("put",_37);
this._addDirectives(_37,{"X-Method-Override":"PUT","If-Match":_37.ifMatch},false,true,true);
return this._sendIframe(_37);
},postMultipart:function(_38){
this._setMultipartDefaults("post",_38);
this._addDirectives(_38,{"If-Match":_38.ifMatch},false,true,true);
return this._sendIframe(_38);
},preload:function(app){
if(app.preload){
var dfd=new dojo.Deferred();
dfd.callback(true);
return dfd;
}else{
app.preload=true;
return dojo.io.iframe.send({handleAs:"html",url:app.routes._getSB("nonce"),noStatus:true,auth:{preventLogin:true}});
}
},onNetwork:function(_39){
},onNetworkEnd:function(_3a){
},_handle:function(_3b,_3c){
var ret;
try{
var _3d=_3c.args;
this.onNetworkEnd(_3d);
var dfd=_3d.dfd;
var i=dojo.indexOf(this.inflight,dfd);
if(i!=-1){
this.inflight.splice(i,1);
}
_3d.dfd=null;
_3d.ioArgs=_3c;
var _3e=lconn.share.util.atom.getError(_3b,_3c,_3d);
if(!_3e&&_3d._xhrHandleAs=="json-embedded"){
_3b=lconn.share.util.atom.getJsonResponseFromHtml(_3b);
_3e=lconn.share.util.atom.getJsonError(_3b);
}
ret=(_3e)?_3e:_3b;
}
catch(e){
console.error(e);
throw e;
}
return ret;
},_openFailure:function(e,_3f){
console.error(e);
this.onNetworkEnd(_3f);
e=new Error(e);
e.dojoType="init";
var f=_3f.error||_3f.handle;
if(f){
f.apply(_3f,[e,{args:_3f}]);
}else{
throw e;
}
},getAuthenticatedUser:function(){
return null;
},isSecuredUrl:function(url){
return false;
},onError:function(_40,_41){
return _40;
}});
}


;if(!dojo._hasResource["lconn.share.util.configUtil"]){
dojo._hasResource["lconn.share.util.configUtil"]=true;


(function(){
var _1=function(_2,_3,_4){
var _5=null;
if(_2){
_5=dojo.getObject(_3,false,_2);
}
if(_5==null){
_5=dojo.getObject(_4);
}
return _5;
};
var _6=function(_7,_8,_9){
var _a=dojo.getObject(_8,false,_7);
if(typeof _a=="undefined"){
return _9;
}else{
return _a;
}
};
dojo.mixin(dojo.provide("lconn.share.util.configUtil"),{isExternalDefault:function(_b){
return !!_1(_b,"policy.isExternalDefault","lconn.share.config.features.isExternalDefault");
},isSharingIntentEnabled:function(_c){
return !!_1(_c,"policy.isExternalEnabled","lconn.share.config.features.sharingIntent");
},isFollowingEnabled:function(_d){
return !!_1(_d,"policy.following","lconn.share.config.features.following");
},isReshareEnabled:function(_e){
return !!_1(_e,"policy.resharing.enabled","lconn.share.config.features.resharing.enabled");
},getResharingDefault:function(_f){
return !!_1(_f,"policy.resharing.defaultValue","lconn.share.config.features.resharing.default");
},isFileSyncEnabled:function(_10){
var _11=null;
if(_10){
_11=dojo.getObject("policy.capabilities.canSync.files.personal",false,_10);
}
if(_11==null){
_11=dojo.getObject("policy.fileSyncEnabled",false,_10);
}
if(_11==null){
_11=dojo.getObject("lconn.share.config.features.fileSync.enabled");
}
return _11;
},canSyncPersonalFile:function(_12){
return _6(_12,"policy.capabilities.canSync.files.personal",false);
},canSyncCommunityFile:function(_13){
return _6(_13,"policy.capabilities.canSync.files.community",false);
},canSyncPersonalFolder:function(_14){
return _6(_14,"policy.capabilities.canSync.folders.personal",false);
},canSyncCommunityFolder:function(_15){
return _6(_15,"policy.capabilities.canSync.folders.community",false);
},isPreviewEnabled:function(_16){
return !!_1(_16,"policy.previewEnabled","lconn.share.config.features.preview");
},canCreatePublicFiles:function(_17){
return _6(_17,"policy.capabilities.canCreate.files.public",true);
},canCreatePublicFolders:function(_18){
return _6(_18,"policy.capabilities.canCreate.folders.public",true);
},canCreateExternalFiles:function(_19){
return _6(_19,"policy.capabilities.canCreate.files.external",true);
},canCreateExternalFolders:function(_1a){
return _6(_1a,"policy.capabilities.canCreate.folders.external",true);
},canCreateInternalFiles:function(_1b){
return _6(_1b,"policy.capabilities.canCreate.files.internal",true);
},canCreateInternalFolders:function(_1c){
return _6(_1c,"policy.capabilities.canCreate.folders.internal",true);
},canViewPublicFiles:function(_1d){
return _6(_1d,"policy.capabilities.canView.files.public",true);
},canViewPublicFolders:function(_1e){
return _6(_1e,"policy.capabilities.canView.folders.public",true);
},canViewEveryPeople:function(_1f){
return _6(_1f,"policy.capabilities.canView.person.everyone",true);
},canViewGroups:function(_20){
return _6(_20,"policy.capabilities.canView.groups",true);
},canViewcommunities:function(_21){
if(!_21){
return true;
}
return _6(_21,"policy.capabilities.canView.communities",false);
},getMaxFileSize:function(_22){
return _1(_22,"policy.maxFileSize","lconn.share.config.services.maxFileSize");
},getSimpleUploadMaxFileSize:function(_23){
return _6(_23,"policy.simpleUploadMaxFileSize",500*1024*1024);
},isRoundTripEditingEnabled:function(_24){
return _6(_24,"policy.roundTripEditingEnabled",false);
},getHomeUrl:function(_25){
return _6(_25,"homeURL",null);
},getSecuredHomeUrl:function(_26){
return _6(_26,"securedHomeURL",null);
},isNestedFolderEnabled:function(_27){
return lconn.core.config.features("files-nested-folder");
},isIndependentScrollbarsEnabled:function(_28){
return lconn.core.config.features("files-independent-scrollbars");
},isHikariThemeEnabled:function(_29){
return lconn.core.theme.getCurrentThemeId()==="hikari";
},isFilePickerDnDEnabled:function(_2a){
return lconn.core.config.features("files-picker-dnd");
},isCustomViewEnabled:function(_2b){
return lconn.core.config.features("files-enable-custom-view");
},isSharedByMeViewEnabled:function(_2c){
if(!lconn.core.config.features("files-nested-folder")){
return true;
}else{
return lconn.core.config.features("files-enable-shared-by-me-view-for-nested-folder");
}
},isPublicFoldersViewEnabled:function(_2d){
if(!lconn.core.config.features("files-nested-folder")){
return true;
}else{
return lconn.core.config.features("files-enable-public-folders-view-for-nested-folder");
}
},isFolderZipDownloadEnabled:function(_2e){
if(!lconn.core.config.features("files-nested-folder")){
return true;
}else{
return lconn.core.config.features("files-enable-folder-zip-download-for-nested-folder");
}
},isFileZipDownloadEnabled:function(_2f){
return lconn.core.config.features("files-enable-file-zip-download");
},isFileLeftNavigationPinnedExpandableEnabled:function(_30){
if(!lconn.core.config.features("files-nested-folder")){
return true;
}else{
return lconn.core.config.features("files-left-navigation-pinned-expandable");
}
},isFileLeftNavigationShareFolderExpandableEnabled:function(_31){
if(!lconn.core.config.features("files-nested-folder")){
return true;
}else{
return lconn.core.config.features("files-left-navigation-sharefolder-expandable");
}
},isRecentPeopleLauncherEnabled:function(_32){
return lconn.core.config.features("files-enable-recent-people-link");
},isReplaceFolderContributorToEditorEnabled:function(_33){
return true;
},isGrantFileEditPermissionToFolderEditorOnlyEnabled:function(_34){
return lconn.core.config.features("files-grant-file-edit-permission-to-folder-editor-only");
},isFileTreeDndEnabled:function(_35){
return lconn.core.config.features("files-tree-dnd");
},isSingleFileDndRightToRightEnabled:function(_36){
return lconn.core.config.features("files-dnd-single-right-to-right");
},isSingleFolderDndRightToRightEnabled:function(_37){
return lconn.core.config.features("folders-dnd-single-right-to-right");
},isMultipleFileAndFolderDndEnabled:function(_38){
return lconn.core.config.features("files-folders-dnd-multiple");
},isTitlebarEnabledForNestedFolder:function(_39){
return lconn.core.config.features("files-nested-folder")&&lconn.core.config.features("files-nested-folder-enable-titlebar");
},isBoxlinksEnabledForCkeditor:function(_3a){
return lconn.core.config.features("box-enable-links-in-ckeditor");
},isSearchPanelEnabled:function(_3b){
return lconn.core.config.features("files-nested-folder")&&lconn.core.config.features("files-nested-folder-enable-titlebar")&&lconn.core.config.features("search-history-view-ui")||!lconn.core.config.features("files-nested-folder")&&lconn.core.config.features("search-history-view-ui");
},isFilesViewDescriptionHidden:function(_3c){
return lconn.core.config.features("files-view-hide-description");
}});
})();
}

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["ic-share"]=true;

;define("ic-share/fileviewer/sbw/StatefulBackedWidget",["dojo/_base/declare","dijit/_WidgetBase","dojo/aspect","dojo/_base/array","dojo/_base/lang","dojo/query","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-style"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
var _b=_1([_2],{constructor:function(){
this._bindingsProcessed=false;
this._bindings=[];
_3.after(this,"postCreate",_5.hitch(this,"_processBindings"));
},add:function(_c){
if(this._bindingsProcessed){
this._processBinding(_c);
}else{
this._bindings.push(_c);
}
},modelChanged:function(_d){
_d._watchHandle.unwatch();
this._processBinding(_d);
},_processBindings:function(){
_4.forEach(this._bindings,this._processBinding,this);
this._bindingsProcessed=true;
},_processBinding:function(_e){
_e._watchHandle=_e.source.model.watch(_e.source.key,_5.hitch(this,"_onPropertyUpdated",_e));
this._onPropertyUpdated(_e);
},_onPropertyUpdated:function(_f){
var _10,_11;
_10=_f.target.node;
if(typeof _10==="string"){
if(_10===_b.DOM_NODE){
_10=this.domNode;
}else{
_10=_6(_10,this.domNode)[0];
if(!_10){
_b._warn("No node found for selector",_f.target.node);
}
}
}
_11=_b._getValue(_f);
switch(_f.target.type){
case "class":
if(!_10){
_10=this.domNode;
}
if(!_f._previous){
_f._previous=[];
}
_4.forEach(_f._previous,function(_12){
_8.remove(_10,_12);
});
_8.add(_10,_11);
if(_4.indexOf(_f._previous,_11)===-1){
_f._previous.push(_11);
}
break;
case "style":
if(!_10){
_10=this.domNode;
}
if(!_f.target.style){
_b._warn("Target missing style name",_f.target);
return;
}
_a.set(_10,_f.target.style,_11);
if(_f.target.style.indexOf("-")>0){
_a.set(_10,_b._toCamelCase(_f.target.style),_11);
}
break;
case "child":
if(!_11){
return;
}
if(!_10){
_b._warn("No node found for target",_f.target);
return;
}
_9.empty(_10);
if(typeof _11.placeAt==="function"){
_11.placeAt(_10);
}else{
_10.appendChild(_11);
}
break;
case "attribute":
if(!_10){
_10=this.domNode;
}
if(!_f.target.attribute){
_b._warn("Target missing attribute name",_f.target);
return;
}
_7.set(_10,_f.target.attribute,_11);
break;
default:
if(!_10){
_b._warn("No node found for target",_f.target);
return;
}
_7.set(_10,"innerHTML",_11);
break;
}
}});
_b.DOM_NODE="__domNode__";
_b._warn=function(_13,_14){
console.warn(_13,_14);
};
_b._getValue=function(_15){
var _16=_15.source.model.get(_15.source.key),_17;
if(_15.source.field){
_16=_5.getObject(_15.source.field,false,_16);
}
if(typeof _15.transform==="function"){
_17=_15.transform(_16,_15);
}else{
if(_15.transform){
_17=_15.transform[_16];
}
}
return _17||_16||"";
};
_b._toCamelCase=function(_18){
var _19=_18.indexOf("-",1),_1a;
while(_19>0&&_19<_18.length-1){
_1a=_18.charAt(_19+1).toUpperCase();
_18=_18.slice(0,_19)+_1a+_18.slice(_19+2);
_19=_18.indexOf("-");
}
return _18;
};
return _b;
});


;define("ic-share/fileviewer/sbw/transforms",["dojo/_base/lang"],function(_1){
"use strict";
return {keyDashValue:function(){
return function(_2,_3){
return _3.source.key+"-"+(_2||"default");
};
},nls:function(_4){
return function(_5){
return _1.getObject((""+_5).toUpperCase(),false,_4)||"";
};
},ctor:function(_6,_7){
return function(_8){
var _9={value:_8};
_9[_7]=_8;
return new _6(_9);
};
},px:function(){
return function(_a){
return _a?_a+"px":"0";
};
}};
});


;define("ic-share/fileviewer/sbw/BindingsInTemplateMixin",["dojo/_base/declare","dojo/_base/lang","dojo/query","dojo/dom-attr","dojo/_base/array","./transforms"],function(_1,_2,_3,_4,_5,_6){
var _7="data-sbw-bind",_8,_9="i",_a="(?:",_b=")",_c="?",_d="^",_e="$",_f="([a-z_${][a-z0-9_$.{}]*)",_10="([-a-z0-9{}_]+)",_11="([-a-z{}_]+)",_12="(\\(ctor\\))"+_c,_13="([a-z_${][a-z0-9_${}]*)",_14,_15,_16,_17,_18=1,_19=2,_1a=3,_1b=4,_1c=5;
_14=_a+"="+_11+_b+_c;
_15=_a+":"+_10+_b+_c+_14;
_16=_a+"!"+_12+_13+_b+_c;
_17=_d+_f+_15+_16+_e;
_8=_1([],{postCreate:function(){
this.inherited(arguments);
if(_4.has(this.domNode,_7)){
this._parse(this.domNode);
}
_3("["+_7+"]",this.domNode).forEach(_2.hitch(this,"_parse"));
},_parse:function(_1d){
_5.forEach(_4.get(_1d,_7).replace(/\s/g,"").split(","),_2.hitch(this,function(_1e){
if(!_1e){
return;
}
var _1f=_8._parse(_1e,this,this.model,_1d);
if(!_1f){
console.warn("Invalid binding string:",_1e);
}else{
this.add(_1f);
}
}));
}});
_8._parse=function(_20,_21,_22,_23){
var _24=new RegExp(_17,_9),_25=_24.exec(_20),_26,key,_27,_28,_29;
if(!_25||!_25[_18]){
return;
}
_26={source:{model:_22},target:{node:_23}};
key=_8._resolve(_25[_18],_21);
if(key.indexOf(".")>-1){
_26.source.field=key.slice(key.indexOf(".")+1);
key=key.slice(0,key.indexOf("."));
}
_26.source.key=key;
_27=_8._resolve(_25[_19],_21);
_28=_8._resolve(_25[_1a],_21);
if(_27==="class"){
_26.target.type="class";
}else{
if(_27==="child"){
_26.target.type="child";
}else{
if(_27==="style"){
_26.target.type="style";
_26.target.style=_28;
}else{
if(_27){
_26.target.type="attribute";
_26.target.attribute=_27;
}
}
}
}
_29=_8._resolve(_25[_1c],_21);
if(_29){
_26.transform=_2.getObject(_29,false,_21);
if(_25[_1b]){
_26.transform=_6.ctor(_26.transform);
}else{
if(!_26.transform&&_6[_29]){
_26.transform=_6[_29]();
}else{
if(typeof _26.transform==="function"){
_26.transform=_2.hitch(_21,_26.transform);
}
}
}
}
return _26;
};
_8._resolve=function(_2a,_2b){
var _2c="\\{([^{}]+)\\}",_2d=(new RegExp(_2c)).exec(_2a);
while(_2d){
_2a=_2a.replace(_2d[0],_2.getObject(_2d[1],false,_2b));
_2d=(new RegExp(_2c)).exec(_2a);
}
return _2a;
};
return _8;
});


;define("ic-share/fileviewer/sbw/StatefulBackedTemplatedWidget",["dojo/_base/declare","./StatefulBackedWidget","dijit/_TemplatedMixin","./BindingsInTemplateMixin"],function(_1,_2,_3,_4){
"use strict";
return _1([_2,_3,_4],{});
});


;define("dojo/text!ic-share/fileviewer/templates/FileViewerImpl.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div>\n  <div style="display: block;" class="ics-viewer-overlay">&nbsp;</div>\n  <div class="ics-viewer-event-interceptor"></div>\n  <div class="ics-viewer ics-viewer-details-expanded" data-dojo-attach-point="viewerContent" role="dialog" aria-labelledby="${ariaLabelId}">\n    <div class="ics-viewer-banner" data-sbw-bind="panelSize:style=margin-{panelLocation}!_getBannerMarginRight">\n      <div class="ics-viewer-title">\n        <span data-dojo-attach-point="fileTypeIconNode"></span>\n        <div class="ics-viewer-title-name-container">\n           <a class="ics-viewer-title-name" href="javascript:;" role="button" data-dojo-attach-point="firstFocusable,titleLinked" id="${ariaLabelId}"></a>\n           <div data-dojo-attach-point="externalIconDiv" class="lotusHidden">\n              <img src="${blank}" title="${fileTypeExternal}" class="ics-viewer-icon externalIcon" alt="${fileTypeExternal}" /></a>\n              <span class="lotusAltText fileViewerIconText">${fileTypeExternal}</span></a>\n           </div>\n           <div data-dojo-attach-point="myFileSyncIconDiv" class="lotusHidden">\n              <img src="${blank}" title="${myFileSync}" class="ics-viewer-icon myFileSyncIcon" alt="${myFileSync}" /></a>\n              <span class="lotusAltText fileViewerIconText">${myFileSync}</span></a>\n           </div>\n        </div>\n      </div>\n      <ul class="ics-viewer-toolbar" data-dojo-attach-point="actionContainer"></ul>\n    </div>\n    <div class="ics-viewer-content" data-dojo-attach-point="previewContainer" data-sbw-bind="panelSize:style=margin-{panelLocation}!px">\n      <div class="ics-message-container ics-viewer-welcome-container" data-dojo-attach-point="welcomeContainer"></div>\n      <div class="ics-viewer-overlay ics-viewer-welcome-overlay">&nbsp;</div>\n      <div class="ics-message-container" data-dojo-attach-point="messageContainer"></div>\n      <div class="ics-viewer-nav ics-viewer-nav-prev" data-dojo-attach-point="previous">\n         <a href="javascript:;" data-dojo-attach-event="onclick:_previous" data-dojo-attach-point="previousArrow" tabindex="-1" aria-describedby="${id}_describe_previous" role="button">\n            <img class="ics-viewer-nav-icon" src="${blank}" data-dojo-attach-point="previousImage" alt="" />\n            <span class="lotusAltText"> &#9668; </span>\n            <div class="ics-viewer-nav-file">\n               <img data-dojo-attach-point="previousIcon" src="${blank}" class="lconn-ftype16" alt="" />\n               <span data-dojo-attach-point="previousName"></span>\n            </div>\n         </a>\n         <span class="lotusAccess" id="${id}_describe_previous">${nls.NAVIGATION.PREVIOUS_A11Y}</span>\n      </div>\n      <div class="ics-viewer-nav ics-viewer-nav-next" data-dojo-attach-point="next">\n         <a href="javascript:;" data-dojo-attach-event="onclick:_next" data-dojo-attach-point="nextArrow" tabindex="-1" aria-describedby="${id}_describe_next" role="button">\n            <img class="ics-viewer-nav-icon" src="${blank}" data-dojo-attach-point="nextImage" alt="" />\n            <span class="lotusAltText"> &#9658; </span>\n            <div class="ics-viewer-nav-file">\n               <img data-dojo-attach-point="nextIcon" src="${blank}" class="lconn-ftype16" alt="" />\n               <span data-dojo-attach-point="nextName"></span>\n            </div>\n         </a>\n         <span class="lotusAccess" id="${id}_describe_next">${nls.NAVIGATION.NEXT_A11Y}</span>\n      </div>\n    </div>\n      \n    <div class="ics-viewer-details" data-sbw-bind="panelSize:style=width!px" data-dojo-attach-point="shelfContainer">\n      <div class="ics-viewer-details-shelf">\n        <div class="ics-shelf ics-info selected">\n          <h3 data-dojo-attach-point="panelNavContainer">${nls.SECTION.ABOUT.NAME}</h3>\n          <div data-dojo-attach-point="panelContainer" class="ics-viewer-panel-container" tabindex="-1">\n            <div class="info-section">\n              <p class="ics-info-filename" title="${file.args.name}">${file.args.name}</p>\n              <p class="ics-info-filesize">${fileSize}</p>\n            </div>\n            <div class="info-section info-section-updated">\n              <p class="ics-info-updated" data-dojo-attach-point="lastUpdated"></p>\n            </div>\n            <div class="info-section info-section-detailsLink">\n              <a href="${file.args.links.details}" data-dojo-attach-point="lastFocusable,fileDetails">${nls.SECTION.ABOUT.VIEW_FILE_DETAILS}</a>\n              <a href="javascript:;" data-dojo-attach-point="lastFocusable,fileDetailsCCM" data-dojo-attach-event="click:onLinkClicked">${nls.SECTION.ABOUT.VIEW_FILE_DETAILS}</a>\n              <span class="lotusAccess" style="width:100px;">${nls.SECTION.ABOUT.A11Y}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n');

;define("dojo/text!ic-share/fileviewer/preview/templates/VideoJSPreview.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-viewer-video-preview" data-dojo-attach-point="videoPreview">\n   <span class="align-helper"></span>\n   <div class="ics-video-widget vjsVideo" data-dojo-attach-point="videoContainer" data-dojo-attach-event="onclick:_cancelEvent, onkeydown:_keyEvents">\n      <video id="${id}" class="video-js vjs-default-skin" controls autoplay preload="none" width="${videoWidth}" height="${videoHeight}" data-dojo-attach-point="vjsVideo">\n         <source src="${videoURL}" type="${videoType}" />\n         <p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web browser that <a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p>\n      </video>\n   </div>\n</div>\n');

;define("ic-share/fileviewer/video/video-js/video-dev",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin"],function(_1,_2,_3){
document.createElement("video");
document.createElement("audio");
document.createElement("track");
var _4=function(id,_5,_6){
var _7;
if(typeof id==="string"){
if(id.indexOf("#")===0){
id=id.slice(1);
}
if(_4.players[id]){
if(_5){
_4.log.warn("Player \""+id+"\" is already initialised. Options will not be applied.");
}
if(_6){
_4.players[id].ready(_6);
}
return _4.players[id];
}else{
_7=_4.el(id);
}
}else{
_7=id;
}
if(!_7||!_7.nodeName){
throw new TypeError("The element or ID supplied is not valid. (videojs)");
}
return _7["player"]||new _4.Player(_7,_5,_6);
};
var _8=window["videojs"]=_4;
_4.CDN_VERSION="4.12";
_4.ACCESS_PROTOCOL=("https:"==document.location.protocol?"https://":"http://");
_4["VERSION"]="4.12.14";
_4.options={"techOrder":["html5","flash"],"html5":{},"flash":{},"width":300,"height":150,"defaultVolume":0,"playbackRates":[],"inactivityTimeout":2000,"children":{"mediaLoader":{},"posterImage":{},"loadingSpinner":{},"textTrackDisplay":{},"bigPlayButton":{},"controlBar":{},"errorDisplay":{},"textTrackSettings":{}},"language":document.getElementsByTagName("html")[0].getAttribute("lang")||navigator.languages&&navigator.languages[0]||navigator.userLanguage||navigator.language||"en","languages":{},"notSupportedMessage":"No compatible source was found for this video."};
if(_4.CDN_VERSION!=="GENERATED"+"_CDN_VSN"){
_8.options["flash"]["swf"]=_4.ACCESS_PROTOCOL+"vjs.zencdn.net/"+_4.CDN_VERSION+"/video-js.swf";
}
_4.addLanguage=function(_9,_a){
if(_4.options["languages"][_9]!==undefined){
_4.options["languages"][_9]=_4.util.mergeOptions(_4.options["languages"][_9],_a);
}else{
_4.options["languages"][_9]=_a;
}
return _4.options["languages"];
};
_4.players={};
if(typeof define==="function"&&define["amd"]){
define("videojs",[],function(){
return _8;
});
}else{
if(typeof exports==="object"&&typeof module==="object"){
module["exports"]=_8;
}
}
_4.CoreObject=_4["CoreObject"]=function(){
};
_4.CoreObject.extend=function(_b){
var _c,_d;
_b=_b||{};
_c=_b["init"]||_b.init||this.prototype["init"]||this.prototype.init||function(){
};
_d=function(){
_c.apply(this,arguments);
};
_d.prototype=_4.obj.create(this.prototype);
_d.prototype.constructor=_d;
_d.extend=_4.CoreObject.extend;
_d.create=_4.CoreObject.create;
for(var _e in _b){
if(_b.hasOwnProperty(_e)){
_d.prototype[_e]=_b[_e];
}
}
return _d;
};
_4.CoreObject.create=function(){
var _f=_4.obj.create(this.prototype);
this.apply(_f,arguments);
return _f;
};
_4.on=function(_10,_11,fn){
if(_4.obj.isArray(_11)){
return _12(_4.on,_10,_11,fn);
}
var _13=_4.getData(_10);
if(!_13.handlers){
_13.handlers={};
}
if(!_13.handlers[_11]){
_13.handlers[_11]=[];
}
if(!fn.guid){
fn.guid=_4.guid++;
}
_13.handlers[_11].push(fn);
if(!_13.dispatcher){
_13.disabled=false;
_13.dispatcher=function(_14){
if(_13.disabled){
return;
}
_14=_4.fixEvent(_14);
var _15=_13.handlers[_14.type];
if(_15){
var _16=_15.slice(0);
for(var m=0,n=_16.length;m<n;m++){
if(_14.isImmediatePropagationStopped()){
break;
}else{
_16[m].call(_10,_14);
}
}
}
};
}
if(_13.handlers[_11].length==1){
if(_10.addEventListener){
_10.addEventListener(_11,_13.dispatcher,false);
}else{
if(_10.attachEvent){
_10.attachEvent("on"+_11,_13.dispatcher);
}
}
}
};
_4.off=function(_17,_18,fn){
if(!_4.hasData(_17)){
return;
}
var _19=_4.getData(_17);
if(!_19.handlers){
return;
}
if(_4.obj.isArray(_18)){
return _12(_4.off,_17,_18,fn);
}
var _1a=function(t){
_19.handlers[t]=[];
_4.cleanUpEvents(_17,t);
};
if(!_18){
for(var t in _19.handlers){
_1a(t);
}
return;
}
var _1b=_19.handlers[_18];
if(!_1b){
return;
}
if(!fn){
_1a(_18);
return;
}
if(fn.guid){
for(var n=0;n<_1b.length;n++){
if(_1b[n].guid===fn.guid){
_1b.splice(n--,1);
}
}
}
_4.cleanUpEvents(_17,_18);
};
_4.cleanUpEvents=function(_1c,_1d){
var _1e=_4.getData(_1c);
if(_1e.handlers[_1d].length===0){
delete _1e.handlers[_1d];
if(_1c.removeEventListener){
_1c.removeEventListener(_1d,_1e.dispatcher,false);
}else{
if(_1c.detachEvent){
_1c.detachEvent("on"+_1d,_1e.dispatcher);
}
}
}
if(_4.isEmpty(_1e.handlers)){
delete _1e.handlers;
delete _1e.dispatcher;
delete _1e.disabled;
}
if(_4.isEmpty(_1e)){
_4.removeData(_1c);
}
};
_4.fixEvent=function(_1f){
function _20(){
return true;
};
function _21(){
return false;
};
if(!_1f||!_1f.isPropagationStopped){
var old=_1f||window.event;
_1f={};
for(var key in old){
if(key!=="layerX"&&key!=="layerY"&&key!=="keyLocation"){
if(!(key=="returnValue"&&old.preventDefault)){
_1f[key]=old[key];
}
}
}
if(!_1f.target){
_1f.target=_1f.srcElement||document;
}
_1f.relatedTarget=_1f.fromElement===_1f.target?_1f.toElement:_1f.fromElement;
_1f.preventDefault=function(){
if(old.preventDefault){
old.preventDefault();
}
_1f.returnValue=false;
_1f.isDefaultPrevented=_20;
_1f.defaultPrevented=true;
};
_1f.isDefaultPrevented=_21;
_1f.defaultPrevented=false;
_1f.stopPropagation=function(){
if(old.stopPropagation){
old.stopPropagation();
}
_1f.cancelBubble=true;
_1f.isPropagationStopped=_20;
};
_1f.isPropagationStopped=_21;
_1f.stopImmediatePropagation=function(){
if(old.stopImmediatePropagation){
old.stopImmediatePropagation();
}
_1f.isImmediatePropagationStopped=_20;
_1f.stopPropagation();
};
_1f.isImmediatePropagationStopped=_21;
if(_1f.clientX!=null){
var doc=document.documentElement,_22=document.body;
_1f.pageX=_1f.clientX+(doc&&doc.scrollLeft||_22&&_22.scrollLeft||0)-(doc&&doc.clientLeft||_22&&_22.clientLeft||0);
_1f.pageY=_1f.clientY+(doc&&doc.scrollTop||_22&&_22.scrollTop||0)-(doc&&doc.clientTop||_22&&_22.clientTop||0);
}
_1f.which=_1f.charCode||_1f.keyCode;
if(_1f.button!=null){
_1f.button=(_1f.button&1?0:(_1f.button&4?1:(_1f.button&2?2:0)));
}
}
return _1f;
};
_4.trigger=function(_23,_24){
var _25=(_4.hasData(_23))?_4.getData(_23):{};
var _26=_23.parentNode||_23.ownerDocument;
if(typeof _24==="string"){
_24={type:_24,target:_23};
}
_24=_4.fixEvent(_24);
if(_25.dispatcher){
_25.dispatcher.call(_23,_24);
}
if(_26&&!_24.isPropagationStopped()&&_24.bubbles!==false){
_4.trigger(_26,_24);
}else{
if(!_26&&!_24.defaultPrevented){
var _27=_4.getData(_24.target);
if(_24.target[_24.type]){
_27.disabled=true;
if(typeof _24.target[_24.type]==="function"){
_24.target[_24.type]();
}
_27.disabled=false;
}
}
}
return !_24.defaultPrevented;
};
_4.one=function(_28,_29,fn){
if(_4.obj.isArray(_29)){
return _12(_4.one,_28,_29,fn);
}
var _2a=function(){
_4.off(_28,_29,_2a);
fn.apply(this,arguments);
};
_2a.guid=fn.guid=fn.guid||_4.guid++;
_4.on(_28,_29,_2a);
};
function _12(fn,_2b,_2c,_2d){
_4.arr.forEach(_2c,function(_2e){
fn(_2b,_2e,_2d);
});
};
var _2f=Object.prototype.hasOwnProperty;
_4.createEl=function(_30,_31){
var el;
_30=_30||"div";
_31=_31||{};
el=document.createElement(_30);
_4.obj.each(_31,function(_32,val){
if(_32.indexOf("aria-")!==-1||_32=="role"){
el.setAttribute(_32,val);
}else{
el[_32]=val;
}
});
return el;
};
_4.capitalize=function(_33){
return _33.charAt(0).toUpperCase()+_33.slice(1);
};
_4.obj={};
_4.obj.create=Object.create||function(obj){
function F(){
};
F.prototype=obj;
return new F();
};
_4.obj.each=function(obj,fn,_34){
for(var key in obj){
if(_2f.call(obj,key)){
fn.call(_34||this,key,obj[key]);
}
}
};
_4.obj.merge=function(_35,_36){
if(!_36){
return _35;
}
for(var key in _36){
if(_2f.call(_36,key)){
_35[key]=_36[key];
}
}
return _35;
};
_4.obj.deepMerge=function(_37,_38){
var key,_39,_3a;
_37=_4.obj.copy(_37);
for(key in _38){
if(_2f.call(_38,key)){
_39=_37[key];
_3a=_38[key];
if(_4.obj.isPlain(_39)&&_4.obj.isPlain(_3a)){
_37[key]=_4.obj.deepMerge(_39,_3a);
}else{
_37[key]=_38[key];
}
}
}
return _37;
};
_4.obj.copy=function(obj){
return _4.obj.merge({},obj);
};
_4.obj.isPlain=function(obj){
return !!obj&&typeof obj==="object"&&obj.toString()==="[object Object]"&&obj.constructor===Object;
};
_4.obj.isArray=Array.isArray||function(arr){
return Object.prototype.toString.call(arr)==="[object Array]";
};
_4.isNaN=function(num){
return num!==num;
};
_4.bind=function(_3b,fn,uid){
if(!fn.guid){
fn.guid=_4.guid++;
}
var ret=function(){
return fn.apply(_3b,arguments);
};
ret.guid=(uid)?uid+"_"+fn.guid:fn.guid;
return ret;
};
_4.cache={};
_4.guid=1;
_4.expando="vdata"+(new Date()).getTime();
_4.getData=function(el){
var id=el[_4.expando];
if(!id){
id=el[_4.expando]=_4.guid++;
}
if(!_4.cache[id]){
_4.cache[id]={};
}
return _4.cache[id];
};
_4.hasData=function(el){
var id=el[_4.expando];
return !(!id||_4.isEmpty(_4.cache[id]));
};
_4.removeData=function(el){
var id=el[_4.expando];
if(!id){
return;
}
delete _4.cache[id];
try{
delete el[_4.expando];
}
catch(e){
if(el.removeAttribute){
el.removeAttribute(_4.expando);
}else{
el[_4.expando]=null;
}
}
};
_4.isEmpty=function(obj){
for(var _3c in obj){
if(obj[_3c]!==null){
return false;
}
}
return true;
};
_4.hasClass=function(_3d,_3e){
return ((" "+_3d.className+" ").indexOf(" "+_3e+" ")!==-1);
};
_4.addClass=function(_3f,_40){
if(!_4.hasClass(_3f,_40)){
_3f.className=_3f.className===""?_40:_3f.className+" "+_40;
}
};
_4.removeClass=function(_41,_42){
var _43,i;
if(!_4.hasClass(_41,_42)){
return;
}
_43=_41.className.split(" ");
for(i=_43.length-1;i>=0;i--){
if(_43[i]===_42){
_43.splice(i,1);
}
}
_41.className=_43.join(" ");
};
_4.TEST_VID=_4.createEl("video");
(function(){
var _44=document.createElement("track");
_44.kind="captions";
_44.srclang="en";
_44.label="English";
_4.TEST_VID.appendChild(_44);
})();
_4.USER_AGENT=navigator.userAgent;
_4.IS_IPHONE=(/iPhone/i).test(_4.USER_AGENT);
_4.IS_IPAD=(/iPad/i).test(_4.USER_AGENT);
_4.IS_IPOD=(/iPod/i).test(_4.USER_AGENT);
_4.IS_IOS=_4.IS_IPHONE||_4.IS_IPAD||_4.IS_IPOD;
_4.IOS_VERSION=(function(){
var _45=_4.USER_AGENT.match(/OS (\d+)_/i);
if(_45&&_45[1]){
return _45[1];
}
})();
_4.IS_ANDROID=(/Android/i).test(_4.USER_AGENT);
_4.ANDROID_VERSION=(function(){
var _46=_4.USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i),_47,_48;
if(!_46){
return null;
}
_47=_46[1]&&parseFloat(_46[1]);
_48=_46[2]&&parseFloat(_46[2]);
if(_47&&_48){
return parseFloat(_46[1]+"."+_46[2]);
}else{
if(_47){
return _47;
}else{
return null;
}
}
})();
_4.IS_OLD_ANDROID=_4.IS_ANDROID&&(/webkit/i).test(_4.USER_AGENT)&&_4.ANDROID_VERSION<2.3;
_4.IS_FIREFOX=(/Firefox/i).test(_4.USER_AGENT);
_4.IS_CHROME=(/Chrome/i).test(_4.USER_AGENT);
_4.IS_IE8=(/MSIE\s8\.0/).test(_4.USER_AGENT);
_4.TOUCH_ENABLED=!!(("ontouchstart" in window)||window.DocumentTouch&&document instanceof window.DocumentTouch);
_4.BACKGROUND_SIZE_SUPPORTED="backgroundSize" in _4.TEST_VID.style;
_4.setElementAttributes=function(el,_49){
_4.obj.each(_49,function(_4a,_4b){
if(_4b===null||typeof _4b==="undefined"||_4b===false){
el.removeAttribute(_4a);
}else{
el.setAttribute(_4a,(_4b===true?"":_4b));
}
});
};
_4.getElementAttributes=function(tag){
var obj,_4c,_4d,_4e,_4f;
obj={};
_4c=","+"autoplay,controls,loop,muted,default"+",";
if(tag&&tag.attributes&&tag.attributes.length>0){
_4d=tag.attributes;
for(var i=_4d.length-1;i>=0;i--){
_4e=_4d[i].name;
_4f=_4d[i].value;
if(typeof tag[_4e]==="boolean"||_4c.indexOf(","+_4e+",")!==-1){
_4f=(_4f!==null)?true:false;
}
obj[_4e]=_4f;
}
}
return obj;
};
_4.getComputedDimension=function(el,_50){
var _51="";
if(document.defaultView&&document.defaultView.getComputedStyle){
_51=document.defaultView.getComputedStyle(el,"").getPropertyValue(_50);
}else{
if(el.currentStyle){
_51=el["client"+_50.substr(0,1).toUpperCase()+_50.substr(1)]+"px";
}
}
return _51;
};
_4.insertFirst=function(_52,_53){
if(_53.firstChild){
_53.insertBefore(_52,_53.firstChild);
}else{
_53.appendChild(_52);
}
};
_4.browser={};
_4.el=function(id){
if(id.indexOf("#")===0){
id=id.slice(1);
}
return document.getElementById(id);
};
_4.formatTime=function(_54,_55){
_55=_55||_54;
var s=Math.floor(_54%60),m=Math.floor(_54/60%60),h=Math.floor(_54/3600),gm=Math.floor(_55/60%60),gh=Math.floor(_55/3600);
if(isNaN(_54)||_54===Infinity){
h=m=s="-";
}
h=(h>0||gh>0)?h+":":"";
m=(((h||gm>=10)&&m<10)?"0"+m:m)+":";
s=(s<10)?"0"+s:s;
return h+m+s;
};
_4.blockTextSelection=function(){
document.body.focus();
document.onselectstart=function(){
return false;
};
};
_4.unblockTextSelection=function(){
document.onselectstart=function(){
return true;
};
};
_4.trim=function(str){
return (str+"").replace(/^\s+|\s+$/g,"");
};
_4.round=function(num,dec){
if(!dec){
dec=0;
}
return Math.round(num*Math.pow(10,dec))/Math.pow(10,dec);
};
_4.createTimeRange=function(_56,end){
if(_56===undefined&&end===undefined){
return {length:0,start:function(){
throw new Error("This TimeRanges object is empty");
},end:function(){
throw new Error("This TimeRanges object is empty");
}};
}
return {length:1,start:function(){
return _56;
},end:function(){
return end;
}};
};
_4.setLocalStorage=function(key,_57){
try{
var _58=window.localStorage||false;
if(!_58){
return;
}
_58[key]=_57;
}
catch(e){
if(e.code==22||e.code==1014){
_4.log("LocalStorage Full (VideoJS)",e);
}else{
if(e.code==18){
_4.log("LocalStorage not allowed (VideoJS)",e);
}else{
_4.log("LocalStorage Error (VideoJS)",e);
}
}
}
};
_4.getAbsoluteURL=function(url){
if(!url.match(/^https?:\/\//)){
url=_4.createEl("div",{innerHTML:"<a href=\""+url+"\">x</a>"}).firstChild.href;
}
return url;
};
_4.parseUrl=function(url){
var div,a,_59,_5a,_5b;
_5a=["protocol","hostname","port","pathname","search","hash","host"];
a=_4.createEl("a",{href:url});
_59=(a.host===""&&a.protocol!=="file:");
if(_59){
div=_4.createEl("div");
div.innerHTML="<a href=\""+url+"\"></a>";
a=div.firstChild;
div.setAttribute("style","display:none; position:absolute;");
document.body.appendChild(div);
}
_5b={};
for(var i=0;i<_5a.length;i++){
_5b[_5a[i]]=a[_5a[i]];
}
if(_5b.protocol==="http:"){
_5b.host=_5b.host.replace(/:80$/,"");
}
if(_5b.protocol==="https:"){
_5b.host=_5b.host.replace(/:443$/,"");
}
if(_59){
document.body.removeChild(div);
}
return _5b;
};
function _5c(_5d,_5e){
var _5f,_60,_61;
_5f=Array.prototype.slice.call(_5e);
_60=function(){
};
_61=window["console"]||{"log":_60,"warn":_60,"error":_60};
if(_5d){
_5f.unshift(_5d.toUpperCase()+":");
}else{
_5d="log";
}
_4.log.history.push(_5f);
_5f.unshift("VIDEOJS:");
if(_61[_5d].apply){
_61[_5d].apply(_61,_5f);
}else{
_61[_5d](_5f.join(" "));
}
};
_4.log=function(){
_5c(null,arguments);
};
_4.log.history=[];
_4.log.error=function(){
_5c("error",arguments);
};
_4.log.warn=function(){
_5c("warn",arguments);
};
_4.findPosition=function(el){
var box,_62,_63,_64,_65,_66,_67,_68,top;
if(el.getBoundingClientRect&&el.parentNode){
box=el.getBoundingClientRect();
}
if(!box){
return {left:0,top:0};
}
_62=document.documentElement;
_63=document.body;
_64=_62.clientLeft||_63.clientLeft||0;
_65=window.pageXOffset||_63.scrollLeft;
_66=box.left+_65-_64;
_67=_62.clientTop||_63.clientTop||0;
_68=window.pageYOffset||_63.scrollTop;
top=box.top+_68-_67;
return {left:_4.round(_66),top:_4.round(top)};
};
_4.arr={};
_4.arr.forEach=function(_69,_6a,_6b){
if(_4.obj.isArray(_69)&&_6a instanceof Function){
for(var i=0,len=_69.length;i<len;++i){
_6a.call(_6b||_4,_69[i],i,_69);
}
}
return _69;
};
_4.xhr=function(_6c,_6d){
var XHR,_6e,_6f,_70,_71,_72,_73,_74,_75;
if(typeof _6c==="string"){
_6c={uri:_6c};
}
_8.util.mergeOptions({method:"GET",timeout:45*1000},_6c);
_6d=_6d||function(){
};
_74=function(){
window.clearTimeout(_73);
_6d(null,_6e,_6e.response||_6e.responseText);
};
_75=function(err){
window.clearTimeout(_73);
if(!err||typeof err==="string"){
err=new Error(err);
}
_6d(err,_6e);
};
XHR=window.XMLHttpRequest;
if(typeof XHR==="undefined"){
XHR=function(){
try{
return new window.ActiveXObject("Msxml2.XMLHTTP.6.0");
}
catch(e){
}
try{
return new window.ActiveXObject("Msxml2.XMLHTTP.3.0");
}
catch(f){
}
try{
return new window.ActiveXObject("Msxml2.XMLHTTP");
}
catch(g){
}
throw new Error("This browser does not support XMLHttpRequest.");
};
}
_6e=new XHR();
_6e.uri=_6c.uri;
_6f=_4.parseUrl(_6c.uri);
_70=window.location;
_72=(_6f.protocol+_6f.host)!==(_70.protocol+_70.host);
if(_72&&window.XDomainRequest&&!("withCredentials" in _6e)){
_6e=new window.XDomainRequest();
_6e.onload=_74;
_6e.onerror=_75;
_6e.onprogress=function(){
};
_6e.ontimeout=function(){
};
}else{
_71=(_6f.protocol=="file:"||_70.protocol=="file:");
_6e.onreadystatechange=function(){
if(_6e.readyState===4){
if(_6e.timedout){
return _75("timeout");
}
if(_6e.status===200||_71&&_6e.status===0){
_74();
}else{
_75();
}
}
};
if(_6c.timeout){
_73=window.setTimeout(function(){
if(_6e.readyState!==4){
_6e.timedout=true;
_6e.abort();
}
},_6c.timeout);
}
}
try{
_6e.open(_6c.method||"GET",_6c.uri,true);
}
catch(err){
return _75(err);
}
if(_6c.withCredentials){
_6e.withCredentials=true;
}
if(_6c.responseType){
_6e.responseType=_6c.responseType;
}
try{
_6e.send();
}
catch(err){
return _75(err);
}
return _6e;
};
_4.util={};
_4.util.mergeOptions=function(_76,_77){
var key,_78,_79;
_76=_4.obj.copy(_76);
for(key in _77){
if(_77.hasOwnProperty(key)){
_78=_76[key];
_79=_77[key];
if(_4.obj.isPlain(_78)&&_4.obj.isPlain(_79)){
_76[key]=_4.util.mergeOptions(_78,_79);
}else{
_76[key]=_77[key];
}
}
}
return _76;
};
_4.EventEmitter=function(){
};
_4.EventEmitter.prototype.allowedEvents_={};
_4.EventEmitter.prototype.on=function(_7a,fn){
var ael=this.addEventListener;
this.addEventListener=Function.prototype;
_4.on(this,_7a,fn);
this.addEventListener=ael;
};
_4.EventEmitter.prototype.addEventListener=_4.EventEmitter.prototype.on;
_4.EventEmitter.prototype.off=function(_7b,fn){
_4.off(this,_7b,fn);
};
_4.EventEmitter.prototype.removeEventListener=_4.EventEmitter.prototype.off;
_4.EventEmitter.prototype.one=function(_7c,fn){
_4.one(this,_7c,fn);
};
_4.EventEmitter.prototype.trigger=function(_7d){
var _7e=_7d.type||_7d;
if(typeof _7d==="string"){
_7d={type:_7e};
}
_7d=_4.fixEvent(_7d);
if(this.allowedEvents_[_7e]&&this["on"+_7e]){
this["on"+_7e](_7d);
}
_4.trigger(this,_7d);
};
_4.EventEmitter.prototype.dispatchEvent=_4.EventEmitter.prototype.trigger;
_4.Component=_4.CoreObject.extend({init:function(_7f,_80,_81){
this.player_=_7f;
this.options_=_4.obj.copy(this.options_);
_80=this.options(_80);
this.id_=_80["id"]||(_80["el"]&&_80["el"]["id"]);
if(!this.id_){
this.id_=((_7f.id&&_7f.id())||"no_player")+"_component_"+_4.guid++;
}
this.name_=_80["name"]||null;
this.el_=_80["el"]||this.createEl();
this.children_=[];
this.childIndex_={};
this.childNameIndex_={};
this.initChildren();
this.ready(_81);
if(_80.reportTouchActivity!==false){
this.enableTouchActivity();
}
}});
_4.Component.prototype.dispose=function(){
this.trigger({type:"dispose","bubbles":false});
if(this.children_){
for(var i=this.children_.length-1;i>=0;i--){
if(this.children_[i].dispose){
this.children_[i].dispose();
}
}
}
this.children_=null;
this.childIndex_=null;
this.childNameIndex_=null;
this.off();
if(this.el_.parentNode){
this.el_.parentNode.removeChild(this.el_);
}
_4.removeData(this.el_);
this.el_=null;
};
_4.Component.prototype.player_=true;
_4.Component.prototype.player=function(){
return this.player_;
};
_4.Component.prototype.options_;
_4.Component.prototype.options=function(obj){
if(obj===undefined){
return this.options_;
}
return this.options_=_4.util.mergeOptions(this.options_,obj);
};
_4.Component.prototype.el_;
_4.Component.prototype.createEl=function(_82,_83){
return _4.createEl(_82,_83);
};
_4.Component.prototype.localize=function(_84){
var _85=this.player_.language(),_86=this.player_.languages();
if(_86&&_86[_85]&&_86[_85][_84]){
return _86[_85][_84];
}
return _84;
};
_4.Component.prototype.el=function(){
return this.el_;
};
_4.Component.prototype.contentEl_;
_4.Component.prototype.contentEl=function(){
return this.contentEl_||this.el_;
};
_4.Component.prototype.id_;
_4.Component.prototype.id=function(){
return this.id_;
};
_4.Component.prototype.name_;
_4.Component.prototype.name=function(){
return this.name_;
};
_4.Component.prototype.children_;
_4.Component.prototype.children=function(){
return this.children_;
};
_4.Component.prototype.childIndex_;
_4.Component.prototype.getChildById=function(id){
return this.childIndex_[id];
};
_4.Component.prototype.childNameIndex_;
_4.Component.prototype.getChild=function(_87){
return this.childNameIndex_[_87];
};
_4.Component.prototype.addChild=function(_88,_89){
var _8a,_8b,_8c;
if(typeof _88==="string"){
_8c=_88;
_89=_89||{};
_8b=_89["componentClass"]||_4.capitalize(_8c);
_89["name"]=_8c;
_8a=new window["videojs"][_8b](this.player_||this,_89);
}else{
_8a=_88;
}
this.children_.push(_8a);
if(typeof _8a.id==="function"){
this.childIndex_[_8a.id()]=_8a;
}
_8c=_8c||(_8a.name&&_8a.name());
if(_8c){
this.childNameIndex_[_8c]=_8a;
}
if(typeof _8a["el"]==="function"&&_8a["el"]()){
this.contentEl().appendChild(_8a["el"]());
}
return _8a;
};
_4.Component.prototype.removeChild=function(_8d){
if(typeof _8d==="string"){
_8d=this.getChild(_8d);
}
if(!_8d||!this.children_){
return;
}
var _8e=false;
for(var i=this.children_.length-1;i>=0;i--){
if(this.children_[i]===_8d){
_8e=true;
this.children_.splice(i,1);
break;
}
}
if(!_8e){
return;
}
this.childIndex_[_8d.id()]=null;
this.childNameIndex_[_8d.name()]=null;
var _8f=_8d.el();
if(_8f&&_8f.parentNode===this.contentEl()){
this.contentEl().removeChild(_8d.el());
}
};
_4.Component.prototype.initChildren=function(){
var _90,_91,_92,_93,_94,_95,_96;
_90=this;
_91=_90.options();
_92=_91["children"];
if(_92){
_96=function(_97,_98){
if(_91[_97]!==undefined){
_98=_91[_97];
}
if(_98===false){
return;
}
_90[_97]=_90.addChild(_97,_98);
};
if(_4.obj.isArray(_92)){
for(var i=0;i<_92.length;i++){
_93=_92[i];
if(typeof _93=="string"){
_94=_93;
_95={};
}else{
_94=_93.name;
_95=_93;
}
_96(_94,_95);
}
}else{
_4.obj.each(_92,_96);
}
}
};
_4.Component.prototype.buildCSSClass=function(){
return "";
};
_4.Component.prototype.on=function(_99,_9a,_9b){
var _9c,_9d,fn,_9e,_9f,_a0;
if(typeof _99==="string"||_4.obj.isArray(_99)){
_4.on(this.el_,_99,_4.bind(this,_9a));
}else{
_9c=_99;
_9d=_9a;
fn=_4.bind(this,_9b);
_a0=this;
_9e=function(){
_a0.off(_9c,_9d,fn);
};
_9e.guid=fn.guid;
this.on("dispose",_9e);
_9f=function(){
_a0.off("dispose",_9e);
};
_9f.guid=fn.guid;
if(_99.nodeName){
_4.on(_9c,_9d,fn);
_4.on(_9c,"dispose",_9f);
}else{
if(typeof _99.on==="function"){
_9c.on(_9d,fn);
_9c.on("dispose",_9f);
}
}
}
return this;
};
_4.Component.prototype.off=function(_a1,_a2,_a3){
var _a4,_a5,_a6,fn,_a7;
if(!_a1||typeof _a1==="string"||_4.obj.isArray(_a1)){
_4.off(this.el_,_a1,_a2);
}else{
_a4=_a1;
_a6=_a2;
fn=_4.bind(this,_a3);
this.off("dispose",fn);
if(_a1.nodeName){
_4.off(_a4,_a6,fn);
_4.off(_a4,"dispose",fn);
}else{
_a4.off(_a6,fn);
_a4.off("dispose",fn);
}
}
return this;
};
_4.Component.prototype.one=function(_a8,_a9,_aa){
var _ab,_ac,fn,_ad,_ae;
if(typeof _a8==="string"||_4.obj.isArray(_a8)){
_4.one(this.el_,_a8,_4.bind(this,_a9));
}else{
_ab=_a8;
_ac=_a9;
fn=_4.bind(this,_aa);
_ad=this;
_ae=function(){
_ad.off(_ab,_ac,_ae);
fn.apply(this,arguments);
};
_ae.guid=fn.guid;
this.on(_ab,_ac,_ae);
}
return this;
};
_4.Component.prototype.trigger=function(_af){
_4.trigger(this.el_,_af);
return this;
};
_4.Component.prototype.isReady_;
_4.Component.prototype.isReadyOnInitFinish_=true;
_4.Component.prototype.readyQueue_;
_4.Component.prototype.ready=function(fn){
if(fn){
if(this.isReady_){
fn.call(this);
}else{
if(this.readyQueue_===undefined){
this.readyQueue_=[];
}
this.readyQueue_.push(fn);
}
}
return this;
};
_4.Component.prototype.triggerReady=function(){
this.isReady_=true;
var _b0=this.readyQueue_;
this.readyQueue_=[];
if(_b0&&_b0.length>0){
for(var i=0,j=_b0.length;i<j;i++){
_b0[i].call(this);
}
this.trigger("ready");
}
};
_4.Component.prototype.hasClass=function(_b1){
return _4.hasClass(this.el_,_b1);
};
_4.Component.prototype.addClass=function(_b2){
_4.addClass(this.el_,_b2);
return this;
};
_4.Component.prototype.removeClass=function(_b3){
_4.removeClass(this.el_,_b3);
return this;
};
_4.Component.prototype.show=function(){
this.removeClass("vjs-hidden");
return this;
};
_4.Component.prototype.hide=function(){
this.addClass("vjs-hidden");
return this;
};
_4.Component.prototype.lockShowing=function(){
this.addClass("vjs-lock-showing");
return this;
};
_4.Component.prototype.unlockShowing=function(){
this.removeClass("vjs-lock-showing");
return this;
};
_4.Component.prototype.disable=function(){
this.hide();
this.show=function(){
};
};
_4.Component.prototype.width=function(num,_b4){
return this.dimension("width",num,_b4);
};
_4.Component.prototype.height=function(num,_b5){
return this.dimension("height",num,_b5);
};
_4.Component.prototype.dimensions=function(_b6,_b7){
return this.width(_b6,true).height(_b7);
};
_4.Component.prototype.dimension=function(_b8,num,_b9){
if(num!==undefined){
if(num===null||_4.isNaN(num)){
num=0;
}
if((""+num).indexOf("%")!==-1||(""+num).indexOf("px")!==-1){
this.el_.style[_b8]=num;
}else{
if(num==="auto"){
this.el_.style[_b8]="";
}else{
this.el_.style[_b8]=num+"px";
}
}
if(!_b9){
this.trigger("resize");
}
return this;
}
if(!this.el_){
return 0;
}
var val=this.el_.style[_b8];
var _ba=val.indexOf("px");
if(_ba!==-1){
return parseInt(val.slice(0,_ba),10);
}else{
return parseInt(this.el_["offset"+_4.capitalize(_b8)],10);
}
};
_4.Component.prototype.onResize;
_4.Component.prototype.emitTapEvents=function(){
var _bb,_bc,_bd,_be,_bf,_c0,_c1,_c2,_c3,_c4;
_bb=0;
_bc=null;
_c3=10;
_c4=200;
this.on("touchstart",function(_c5){
if(_c5.touches.length===1){
_bc=_4.obj.copy(_c5.touches[0]);
_bb=new Date().getTime();
_be=true;
}
});
this.on("touchmove",function(_c6){
if(_c6.touches.length>1){
_be=false;
}else{
if(_bc){
_c0=_c6.touches[0].pageX-_bc.pageX;
_c1=_c6.touches[0].pageY-_bc.pageY;
_c2=Math.sqrt(_c0*_c0+_c1*_c1);
if(_c2>_c3){
_be=false;
}
}
}
});
_bf=function(){
_be=false;
};
this.on("touchleave",_bf);
this.on("touchcancel",_bf);
this.on("touchend",function(_c7){
_bc=null;
if(_be===true){
_bd=new Date().getTime()-_bb;
if(_bd<_c4){
_c7.preventDefault();
this.trigger("tap");
}
}
});
};
_4.Component.prototype.enableTouchActivity=function(){
var _c8,_c9,_ca;
if(!this.player().reportUserActivity){
return;
}
_c8=_4.bind(this.player(),this.player().reportUserActivity);
this.on("touchstart",function(){
_c8();
this.clearInterval(_c9);
_c9=this.setInterval(_c8,250);
});
_ca=function(_cb){
_c8();
this.clearInterval(_c9);
};
this.on("touchmove",_c8);
this.on("touchend",_ca);
this.on("touchcancel",_ca);
};
_4.Component.prototype.setTimeout=function(fn,_cc){
fn=_4.bind(this,fn);
var _cd=setTimeout(fn,_cc);
var _ce=function(){
this.clearTimeout(_cd);
};
_ce.guid="vjs-timeout-"+_cd;
this.on("dispose",_ce);
return _cd;
};
_4.Component.prototype.clearTimeout=function(_cf){
clearTimeout(_cf);
var _d0=function(){
};
_d0.guid="vjs-timeout-"+_cf;
this.off("dispose",_d0);
return _cf;
};
_4.Component.prototype.setInterval=function(fn,_d1){
fn=_4.bind(this,fn);
var _d2=setInterval(fn,_d1);
var _d3=function(){
this.clearInterval(_d2);
};
_d3.guid="vjs-interval-"+_d2;
this.on("dispose",_d3);
return _d2;
};
_4.Component.prototype.clearInterval=function(_d4){
clearInterval(_d4);
var _d5=function(){
};
_d5.guid="vjs-interval-"+_d4;
this.off("dispose",_d5);
return _d4;
};
_4.Button=_4.Component.extend({init:function(_d6,_d7){
_4.Component.call(this,_d6,_d7);
this.emitTapEvents();
this.on("tap",this.onClick);
this.on("click",this.onClick);
this.on("focus",this.onFocus);
this.on("blur",this.onBlur);
}});
_4.Button.prototype.createEl=function(_d8,_d9){
var el;
_d9=_4.obj.merge({className:this.buildCSSClass(),"role":"button","aria-live":"polite",title:this.localize(this.buttonText)||"",tabIndex:0},_d9);
el=_4.Component.prototype.createEl.call(this,_d8,_d9);
if(!_d9.innerHTML){
this.contentEl_=_4.createEl("div",{className:"vjs-control-content"});
this.controlText_=_4.createEl("span",{className:"vjs-control-text",innerHTML:this.localize(this.buttonText)||"Need Text"});
this.contentEl_.appendChild(this.controlText_);
el.appendChild(this.contentEl_);
}
return el;
};
_4.Button.prototype.buildCSSClass=function(){
return "vjs-control "+_4.Component.prototype.buildCSSClass.call(this);
};
_4.Button.prototype.onClick=function(){
};
_4.Button.prototype.onFocus=function(){
_4.on(document,"keydown",_4.bind(this,this.onKeyPress));
};
_4.Button.prototype.onKeyPress=function(_da){
if(_da.which==32||_da.which==13){
_da.preventDefault();
this.onClick();
}
};
_4.Button.prototype.onBlur=function(){
_4.off(document,"keydown",_4.bind(this,this.onKeyPress));
};
_4.Slider=_4.Component.extend({init:function(_db,_dc){
_4.Component.call(this,_db,_dc);
this.bar=this.getChild(this.options_["barName"]);
this.handle=this.getChild(this.options_["handleName"]);
this.on("mousedown",this.onMouseDown);
this.on("touchstart",this.onMouseDown);
this.on("focus",this.onFocus);
this.on("blur",this.onBlur);
this.on("click",this.onClick);
this.on(_db,"controlsvisible",this.update);
this.on(_db,this.playerEvent,this.update);
}});
_4.Slider.prototype.createEl=function(_dd,_de){
_de=_de||{};
_de.className=_de.className+" vjs-slider";
_de=_4.obj.merge({"role":"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},_de);
return _4.Component.prototype.createEl.call(this,_dd,_de);
};
_4.Slider.prototype.onMouseDown=function(_df){
_df.preventDefault();
_4.blockTextSelection();
this.addClass("vjs-sliding");
this.on(document,"mousemove",this.onMouseMove);
this.on(document,"mouseup",this.onMouseUp);
this.on(document,"touchmove",this.onMouseMove);
this.on(document,"touchend",this.onMouseUp);
this.onMouseMove(_df);
};
_4.Slider.prototype.onMouseMove=function(){
};
_4.Slider.prototype.onMouseUp=function(){
_4.unblockTextSelection();
this.removeClass("vjs-sliding");
this.off(document,"mousemove",this.onMouseMove);
this.off(document,"mouseup",this.onMouseUp);
this.off(document,"touchmove",this.onMouseMove);
this.off(document,"touchend",this.onMouseUp);
this.update();
};
_4.Slider.prototype.update=function(){
if(!this.el_){
return;
}
var _e0,_e1=this.getPercent(),_e2=this.handle,bar=this.bar;
if(typeof _e1!=="number"||_e1!==_e1||_e1<0||_e1===Infinity){
_e1=0;
}
_e0=_e1;
if(_e2){
var box=this.el_,_e3=box.offsetWidth,_e4=_e2.el().offsetWidth,_e5=(_e4)?_e4/_e3:0,_e6=1-_e5,_e7=_e1*_e6;
_e0=_e7+(_e5/2);
_e2.el().style.left=_4.round(_e7*100,2)+"%";
}
if(bar){
bar.el().style.width=_4.round(_e0*100,2)+"%";
}
};
_4.Slider.prototype.calculateDistance=function(_e8){
var el,box,_e9,_ea,_eb,_ec,_ed,_ee,_ef;
el=this.el_;
box=_4.findPosition(el);
_eb=_ec=el.offsetWidth;
_ed=this.handle;
if(this.options()["vertical"]){
_ea=box.top;
if(_e8.changedTouches){
_ef=_e8.changedTouches[0].pageY;
}else{
_ef=_e8.pageY;
}
if(_ed){
var _f0=_ed.el().offsetHeight;
_ea=_ea+(_f0/2);
_ec=_ec-_f0;
}
return Math.max(0,Math.min(1,((_ea-_ef)+_ec)/_ec));
}else{
_e9=box.left;
if(_e8.changedTouches){
_ee=_e8.changedTouches[0].pageX;
}else{
_ee=_e8.pageX;
}
if(_ed){
var _f1=_ed.el().offsetWidth;
_e9=_e9+(_f1/2);
_eb=_eb-_f1;
}
return Math.max(0,Math.min(1,(_ee-_e9)/_eb));
}
};
_4.Slider.prototype.onFocus=function(){
this.on(document,"keydown",this.onKeyPress);
};
_4.Slider.prototype.onKeyPress=function(_f2){
if(_f2.which==37||_f2.which==40){
_f2.preventDefault();
this.stepBack();
}else{
if(_f2.which==38||_f2.which==39){
_f2.preventDefault();
this.stepForward();
}
}
};
_4.Slider.prototype.onBlur=function(){
this.off(document,"keydown",this.onKeyPress);
};
_4.Slider.prototype.onClick=function(_f3){
_f3.stopImmediatePropagation();
_f3.preventDefault();
};
_4.SliderHandle=_4.Component.extend();
_4.SliderHandle.prototype.defaultValue=0;
_4.SliderHandle.prototype.createEl=function(_f4,_f5){
_f5=_f5||{};
_f5.className=_f5.className+" vjs-slider-handle";
_f5=_4.obj.merge({innerHTML:"<span class=\"vjs-control-text\">"+this.defaultValue+"</span>"},_f5);
return _4.Component.prototype.createEl.call(this,"div",_f5);
};
_4.Menu=_4.Component.extend();
_4.Menu.prototype.addItem=function(_f6){
this.addChild(_f6);
_f6.on("click",_4.bind(this,function(){
this.unlockShowing();
}));
};
_4.Menu.prototype.createEl=function(){
var _f7=this.options().contentElType||"ul";
this.contentEl_=_4.createEl(_f7,{className:"vjs-menu-content"});
var el=_4.Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});
el.appendChild(this.contentEl_);
_4.on(el,"click",function(_f8){
_f8.preventDefault();
_f8.stopImmediatePropagation();
});
return el;
};
_4.MenuItem=_4.Button.extend({init:function(_f9,_fa){
_4.Button.call(this,_f9,_fa);
this.selected(_fa["selected"]);
}});
_4.MenuItem.prototype.createEl=function(_fb,_fc){
return _4.Button.prototype.createEl.call(this,"li",_4.obj.merge({className:"vjs-menu-item",innerHTML:this.localize(this.options_["label"])},_fc));
};
_4.MenuItem.prototype.onClick=function(){
this.selected(true);
};
_4.MenuItem.prototype.selected=function(_fd){
if(_fd){
this.addClass("vjs-selected");
this.el_.setAttribute("aria-selected",true);
}else{
this.removeClass("vjs-selected");
this.el_.setAttribute("aria-selected",false);
}
};
_4.MenuButton=_4.Button.extend({init:function(_fe,_ff){
_4.Button.call(this,_fe,_ff);
this.update();
this.on("keydown",this.onKeyPress);
this.el_.setAttribute("aria-haspopup",true);
this.el_.setAttribute("role","button");
}});
_4.MenuButton.prototype.update=function(){
var menu=this.createMenu();
if(this.menu){
this.removeChild(this.menu);
}
this.menu=menu;
this.addChild(menu);
if(this.items&&this.items.length===0){
this.hide();
}else{
if(this.items&&this.items.length>1){
this.show();
}
}
};
_4.MenuButton.prototype.buttonPressed_=false;
_4.MenuButton.prototype.createMenu=function(){
var menu=new _4.Menu(this.player_);
if(this.options().title){
menu.contentEl().appendChild(_4.createEl("li",{className:"vjs-menu-title",innerHTML:_4.capitalize(this.options().title),tabindex:-1}));
}
this.items=this["createItems"]();
if(this.items){
for(var i=0;i<this.items.length;i++){
menu.addItem(this.items[i]);
}
}
return menu;
};
_4.MenuButton.prototype.createItems=function(){
};
_4.MenuButton.prototype.buildCSSClass=function(){
return this.className+" vjs-menu-button "+_4.Button.prototype.buildCSSClass.call(this);
};
_4.MenuButton.prototype.onFocus=function(){
};
_4.MenuButton.prototype.onBlur=function(){
};
_4.MenuButton.prototype.onClick=function(){
this.one("mouseout",_4.bind(this,function(){
this.menu.unlockShowing();
this.el_.blur();
}));
if(this.buttonPressed_){
this.unpressButton();
}else{
this.pressButton();
}
};
_4.MenuButton.prototype.onKeyPress=function(_100){
if(_100.which==32||_100.which==13){
if(this.buttonPressed_){
this.unpressButton();
}else{
this.pressButton();
}
_100.preventDefault();
}else{
if(_100.which==27){
if(this.buttonPressed_){
this.unpressButton();
}
_100.preventDefault();
}
}
};
_4.MenuButton.prototype.pressButton=function(){
this.buttonPressed_=true;
this.menu.lockShowing();
this.el_.setAttribute("aria-pressed",true);
if(this.items&&this.items.length>0){
this.items[0].el().focus();
}
};
_4.MenuButton.prototype.unpressButton=function(){
this.buttonPressed_=false;
this.menu.unlockShowing();
this.el_.setAttribute("aria-pressed",false);
};
_4.MediaError=function(code){
if(typeof code==="number"){
this.code=code;
}else{
if(typeof code==="string"){
this.message=code;
}else{
if(typeof code==="object"){
_4.obj.merge(this,code);
}
}
}
if(!this.message){
this.message=_4.MediaError.defaultMessages[this.code]||"";
}
};
_4.MediaError.prototype.code=0;
_4.MediaError.prototype.message="";
_4.MediaError.prototype.status=null;
_4.MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];
_4.MediaError.defaultMessages={1:"You aborted the video playback",2:"A network error caused the video download to fail part-way.",3:"The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",4:"The video could not be loaded, either because the server or network failed or because the format is not supported.",5:"The video is encrypted and we do not have the keys to decrypt it."};
for(var _101=0;_101<_4.MediaError.errorTypes.length;_101++){
_4.MediaError[_4.MediaError.errorTypes[_101]]=_101;
_4.MediaError.prototype[_4.MediaError.errorTypes[_101]]=_101;
}
(function(){
var _102,_103,_104,i;
_4.browser.fullscreenAPI;
_102=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];
_103=_102[0];
for(i=0;i<_102.length;i++){
if(_102[i][1] in document){
_104=_102[i];
break;
}
}
if(_104){
_4.browser.fullscreenAPI={};
for(i=0;i<_104.length;i++){
_4.browser.fullscreenAPI[_103[i]]=_104[i];
}
}
})();
_4.Player=_4.Component.extend({init:function(tag,_105,_106){
this.tag=tag;
tag.id=tag.id||"vjs_video_"+_4.guid++;
this.tagAttributes=tag&&_4.getElementAttributes(tag);
_105=_4.obj.merge(this.getTagSettings(tag),_105);
this.language_=_105["language"]||_4.options["language"];
this.languages_=_105["languages"]||_4.options["languages"];
this.cache_={};
this.poster_=_105["poster"]||"";
this.controls_=!!_105["controls"];
tag.controls=false;
_105.reportTouchActivity=false;
this.isAudio(this.tag.nodeName.toLowerCase()==="audio");
_4.Component.call(this,this,_105,_106);
if(this.controls()){
this.addClass("vjs-controls-enabled");
}else{
this.addClass("vjs-controls-disabled");
}
if(this.isAudio()){
this.addClass("vjs-audio");
}
_4.players[this.id_]=this;
if(_105["plugins"]){
_4.obj.each(_105["plugins"],function(key,val){
this[key](val);
},this);
}
this.listenForUserActivity();
}});
_4.Player.prototype.language_;
_4.Player.prototype.language=function(_107){
if(_107===undefined){
return this.language_;
}
this.language_=_107;
return this;
};
_4.Player.prototype.languages_;
_4.Player.prototype.languages=function(){
return this.languages_;
};
_4.Player.prototype.options_=_4.options;
_4.Player.prototype.dispose=function(){
this.trigger("dispose");
this.off("dispose");
_4.players[this.id_]=null;
if(this.tag&&this.tag["player"]){
this.tag["player"]=null;
}
if(this.el_&&this.el_["player"]){
this.el_["player"]=null;
}
if(this.tech){
this.tech.dispose();
}
_4.Component.prototype.dispose.call(this);
};
_4.Player.prototype.getTagSettings=function(tag){
var _108,_109,_10a={"sources":[],"tracks":[]};
_108=_4.getElementAttributes(tag);
_109=_108["data-setup"];
if(_109!==null){
_4.obj.merge(_108,_4.JSON.parse(_109||"{}"));
}
_4.obj.merge(_10a,_108);
if(tag.hasChildNodes()){
var _10b,_10c,_10d,i,j;
_10b=tag.childNodes;
for(i=0,j=_10b.length;i<j;i++){
_10c=_10b[i];
_10d=_10c.nodeName.toLowerCase();
if(_10d==="source"){
_10a["sources"].push(_4.getElementAttributes(_10c));
}else{
if(_10d==="track"){
_10a["tracks"].push(_4.getElementAttributes(_10c));
}
}
}
}
return _10a;
};
_4.Player.prototype.createEl=function(){
var el=this.el_=_4.Component.prototype.createEl.call(this,"div"),tag=this.tag,_10e;
tag.removeAttribute("width");
tag.removeAttribute("height");
_10e=_4.getElementAttributes(tag);
_4.obj.each(_10e,function(attr){
if(attr=="class"){
el.className=_10e[attr];
}else{
el.setAttribute(attr,_10e[attr]);
}
});
tag.id+="_html5_api";
tag.className="vjs-tech";
tag["player"]=el["player"]=this;
this.addClass("vjs-paused");
this.width(this.options_["width"],true);
this.height(this.options_["height"],true);
tag.initNetworkState_=tag.networkState;
if(tag.parentNode){
tag.parentNode.insertBefore(el,tag);
}
_4.insertFirst(tag,el);
this.el_=el;
this.on("loadstart",this.onLoadStart);
this.on("waiting",this.onWaiting);
this.on(["canplay","canplaythrough","playing","ended"],this.onWaitEnd);
this.on("seeking",this.onSeeking);
this.on("seeked",this.onSeeked);
this.on("ended",this.onEnded);
this.on("play",this.onPlay);
this.on("firstplay",this.onFirstPlay);
this.on("pause",this.onPause);
this.on("progress",this.onProgress);
this.on("durationchange",this.onDurationChange);
this.on("fullscreenchange",this.onFullscreenChange);
return el;
};
_4.Player.prototype.loadTech=function(_10f,_110){
if(this.tech){
this.unloadTech();
}
if(_10f!=="Html5"&&this.tag){
_4.Html5.disposeMediaElement(this.tag);
this.tag=null;
}
this.techName=_10f;
this.isReady_=false;
var _111=function(){
this.player_.triggerReady();
};
var _112=_4.obj.merge({"source":_110,"parentEl":this.el_},this.options_[_10f.toLowerCase()]);
if(_110){
this.currentType_=_110.type;
if(_110.src==this.cache_.src&&this.cache_.currentTime>0){
_112["startTime"]=this.cache_.currentTime;
}
this.cache_.src=_110.src;
}
this.tech=new window["videojs"][_10f](this,_112);
this.tech.ready(_111);
};
_4.Player.prototype.unloadTech=function(){
this.isReady_=false;
this.tech.dispose();
this.tech=false;
};
_4.Player.prototype.onLoadStart=function(){
this.removeClass("vjs-ended");
this.error(null);
if(!this.paused()){
this.trigger("firstplay");
}else{
this.hasStarted(false);
}
};
_4.Player.prototype.hasStarted_=false;
_4.Player.prototype.hasStarted=function(_113){
if(_113!==undefined){
if(this.hasStarted_!==_113){
this.hasStarted_=_113;
if(_113){
this.addClass("vjs-has-started");
this.trigger("firstplay");
}else{
this.removeClass("vjs-has-started");
}
}
return this;
}
return this.hasStarted_;
};
_4.Player.prototype.onLoadedMetaData;
_4.Player.prototype.onLoadedData;
_4.Player.prototype.onLoadedAllData;
_4.Player.prototype.onPlay=function(){
this.removeClass("vjs-ended");
this.removeClass("vjs-paused");
this.addClass("vjs-playing");
this.hasStarted(true);
};
_4.Player.prototype.onWaiting=function(){
this.addClass("vjs-waiting");
};
_4.Player.prototype.onWaitEnd=function(){
this.removeClass("vjs-waiting");
};
_4.Player.prototype.onSeeking=function(){
this.addClass("vjs-seeking");
};
_4.Player.prototype.onSeeked=function(){
this.removeClass("vjs-seeking");
};
_4.Player.prototype.onFirstPlay=function(){
if(this.options_["starttime"]){
this.currentTime(this.options_["starttime"]);
}
this.addClass("vjs-has-started");
};
_4.Player.prototype.onPause=function(){
this.removeClass("vjs-playing");
this.addClass("vjs-paused");
};
_4.Player.prototype.onTimeUpdate;
_4.Player.prototype.onProgress=function(){
if(this.bufferedPercent()==1){
this.trigger("loadedalldata");
}
};
_4.Player.prototype.onEnded=function(){
this.addClass("vjs-ended");
if(this.options_["loop"]){
this.currentTime(0);
this.play();
}else{
if(!this.paused()){
this.pause();
}
}
};
_4.Player.prototype.onDurationChange=function(){
var _114=this.techGet("duration");
if(_114){
if(_114<0){
_114=Infinity;
}
this.duration(_114);
if(_114===Infinity){
this.addClass("vjs-live");
}else{
this.removeClass("vjs-live");
}
}
};
_4.Player.prototype.onVolumeChange;
_4.Player.prototype.onFullscreenChange=function(){
if(this.isFullscreen()){
this.addClass("vjs-fullscreen");
}else{
this.removeClass("vjs-fullscreen");
}
};
_4.Player.prototype.onError;
_4.Player.prototype.cache_;
_4.Player.prototype.getCache=function(){
return this.cache_;
};
_4.Player.prototype.techCall=function(_115,arg){
if(this.tech&&!this.tech.isReady_){
this.tech.ready(function(){
this[_115](arg);
});
}else{
try{
this.tech[_115](arg);
}
catch(e){
_4.log(e);
throw e;
}
}
};
_4.Player.prototype.techGet=function(_116){
if(this.tech&&this.tech.isReady_){
try{
return this.tech[_116]();
}
catch(e){
if(this.tech[_116]===undefined){
_4.log("Video.js: "+_116+" method not defined for "+this.techName+" playback technology.",e);
}else{
if(e.name=="TypeError"){
_4.log("Video.js: "+_116+" unavailable on "+this.techName+" playback technology element.",e);
this.tech.isReady_=false;
}else{
_4.log(e);
}
}
throw e;
}
}
return;
};
_4.Player.prototype.play=function(){
this.techCall("play");
return this;
};
_4.Player.prototype.pause=function(){
this.techCall("pause");
return this;
};
_4.Player.prototype.paused=function(){
return (this.techGet("paused")===false)?false:true;
};
_4.Player.prototype.currentTime=function(_117){
if(_117!==undefined){
this.techCall("setCurrentTime",_117);
return this;
}
return this.cache_.currentTime=(this.techGet("currentTime")||0);
};
_4.Player.prototype.duration=function(_118){
if(_118!==undefined){
this.cache_.duration=parseFloat(_118);
return this;
}
if(this.cache_.duration===undefined){
this.onDurationChange();
}
return this.cache_.duration||0;
};
_4.Player.prototype.remainingTime=function(){
return this.duration()-this.currentTime();
};
_4.Player.prototype.buffered=function(){
var _119=this.techGet("buffered");
if(!_119||!_119.length){
_119=_4.createTimeRange(0,0);
}
return _119;
};
_4.Player.prototype.bufferedPercent=function(){
var _11a=this.duration(),_11b=this.buffered(),_11c=0,_11d,end;
if(!_11a){
return 0;
}
for(var i=0;i<_11b.length;i++){
_11d=_11b.start(i);
end=_11b.end(i);
if(end>_11a){
end=_11a;
}
_11c+=end-_11d;
}
return _11c/_11a;
};
_4.Player.prototype.bufferedEnd=function(){
var _11e=this.buffered(),_11f=this.duration(),end=_11e.end(_11e.length-1);
if(end>_11f){
end=_11f;
}
return end;
};
_4.Player.prototype.volume=function(_120){
var vol;
if(_120!==undefined){
vol=Math.max(0,Math.min(1,parseFloat(_120)));
this.cache_.volume=vol;
this.techCall("setVolume",vol);
_4.setLocalStorage("volume",vol);
return this;
}
vol=parseFloat(this.techGet("volume"));
return (isNaN(vol))?1:vol;
};
_4.Player.prototype.muted=function(_121){
if(_121!==undefined){
this.techCall("setMuted",_121);
return this;
}
return this.techGet("muted")||false;
};
_4.Player.prototype.supportsFullScreen=function(){
return this.techGet("supportsFullScreen")||false;
};
_4.Player.prototype.isFullscreen_=false;
_4.Player.prototype.isFullscreen=function(isFS){
if(isFS!==undefined){
this.isFullscreen_=!!isFS;
return this;
}
return this.isFullscreen_;
};
_4.Player.prototype.isFullScreen=function(isFS){
_4.log.warn("player.isFullScreen() has been deprecated, use player.isFullscreen() with a lowercase \"s\")");
return this.isFullscreen(isFS);
};
_4.Player.prototype.requestFullscreen=function(){
var _122=_4.browser.fullscreenAPI;
this.isFullscreen(true);
if(_122){
_4.on(document,_122["fullscreenchange"],_4.bind(this,function(e){
this.isFullscreen(document[_122.fullscreenElement]);
if(this.isFullscreen()===false){
_4.off(document,_122["fullscreenchange"],arguments.callee);
}
this.trigger("fullscreenchange");
}));
this.el_[_122.requestFullscreen]();
}else{
if(this.tech.supportsFullScreen()){
this.techCall("enterFullScreen");
}else{
this.enterFullWindow();
this.trigger("fullscreenchange");
}
}
return this;
};
_4.Player.prototype.requestFullScreen=function(){
_4.log.warn("player.requestFullScreen() has been deprecated, use player.requestFullscreen() with a lowercase \"s\")");
return this.requestFullscreen();
};
_4.Player.prototype.exitFullscreen=function(){
var _123=_4.browser.fullscreenAPI;
this.isFullscreen(false);
if(_123){
document[_123.exitFullscreen]();
}else{
if(this.tech.supportsFullScreen()){
this.techCall("exitFullScreen");
}else{
this.exitFullWindow();
this.trigger("fullscreenchange");
}
}
return this;
};
_4.Player.prototype.cancelFullScreen=function(){
_4.log.warn("player.cancelFullScreen() has been deprecated, use player.exitFullscreen()");
return this.exitFullscreen();
};
_4.Player.prototype.enterFullWindow=function(){
this.isFullWindow=true;
this.docOrigOverflow=document.documentElement.style.overflow;
_4.on(document,"keydown",_4.bind(this,this.fullWindowOnEscKey));
document.documentElement.style.overflow="hidden";
_4.addClass(document.body,"vjs-full-window");
this.trigger("enterFullWindow");
};
_4.Player.prototype.fullWindowOnEscKey=function(_124){
if(_124.keyCode===27){
if(this.isFullscreen()===true){
this.exitFullscreen();
}else{
this.exitFullWindow();
}
}
};
_4.Player.prototype.exitFullWindow=function(){
this.isFullWindow=false;
_4.off(document,"keydown",this.fullWindowOnEscKey);
document.documentElement.style.overflow=this.docOrigOverflow;
_4.removeClass(document.body,"vjs-full-window");
this.trigger("exitFullWindow");
};
_4.Player.prototype.selectSource=function(_125){
for(var i=0,j=this.options_["techOrder"];i<j.length;i++){
var _126=_4.capitalize(j[i]),tech=window["videojs"][_126];
if(!tech){
_4.log.error("The \""+_126+"\" tech is undefined. Skipped browser support check for that tech.");
continue;
}
if(tech.isSupported()){
for(var a=0,b=_125;a<b.length;a++){
var _127=b[a];
if(tech["canPlaySource"](_127)){
return {source:_127,tech:_126};
}
}
}
}
return false;
};
_4.Player.prototype.src=function(_128){
if(_128===undefined){
return this.techGet("src");
}
if(_4.obj.isArray(_128)){
this.sourceList_(_128);
}else{
if(typeof _128==="string"){
this.src({src:_128});
}else{
if(_128 instanceof Object){
if(_128.type&&!window["videojs"][this.techName]["canPlaySource"](_128)){
this.sourceList_([_128]);
}else{
this.cache_.src=_128.src;
this.currentType_=_128.type||"";
this.ready(function(){
if(window["videojs"][this.techName].prototype.hasOwnProperty("setSource")){
this.techCall("setSource",_128);
}else{
this.techCall("src",_128.src);
}
if(this.options_["preload"]=="auto"){
this.load();
}
if(this.options_["autoplay"]){
this.play();
}
});
}
}
}
}
return this;
};
_4.Player.prototype.sourceList_=function(_129){
var _12a=this.selectSource(_129);
if(_12a){
if(_12a.tech===this.techName){
this.src(_12a.source);
}else{
this.loadTech(_12a.tech,_12a.source);
}
}else{
this.setTimeout(function(){
this.error({code:4,message:this.localize(this.options()["notSupportedMessage"])});
},0);
this.triggerReady();
}
};
_4.Player.prototype.load=function(){
this.techCall("load");
return this;
};
_4.Player.prototype.currentSrc=function(){
return this.techGet("currentSrc")||this.cache_.src||"";
};
_4.Player.prototype.currentType=function(){
return this.currentType_||"";
};
_4.Player.prototype.preload=function(_12b){
if(_12b!==undefined){
this.techCall("setPreload",_12b);
this.options_["preload"]=_12b;
return this;
}
return this.techGet("preload");
};
_4.Player.prototype.autoplay=function(_12c){
if(_12c!==undefined){
this.techCall("setAutoplay",_12c);
this.options_["autoplay"]=_12c;
return this;
}
return this.techGet("autoplay",_12c);
};
_4.Player.prototype.loop=function(_12d){
if(_12d!==undefined){
this.techCall("setLoop",_12d);
this.options_["loop"]=_12d;
return this;
}
return this.techGet("loop");
};
_4.Player.prototype.poster_;
_4.Player.prototype.poster=function(src){
if(src===undefined){
return this.poster_;
}
if(!src){
src="";
}
this.poster_=src;
this.techCall("setPoster",src);
this.trigger("posterchange");
return this;
};
_4.Player.prototype.controls_;
_4.Player.prototype.controls=function(bool){
if(bool!==undefined){
bool=!!bool;
if(this.controls_!==bool){
this.controls_=bool;
if(bool){
this.removeClass("vjs-controls-disabled");
this.addClass("vjs-controls-enabled");
this.trigger("controlsenabled");
}else{
this.removeClass("vjs-controls-enabled");
this.addClass("vjs-controls-disabled");
this.trigger("controlsdisabled");
}
}
return this;
}
return this.controls_;
};
_4.Player.prototype.usingNativeControls_;
_4.Player.prototype.usingNativeControls=function(bool){
if(bool!==undefined){
bool=!!bool;
if(this.usingNativeControls_!==bool){
this.usingNativeControls_=bool;
if(bool){
this.addClass("vjs-using-native-controls");
this.trigger("usingnativecontrols");
}else{
this.removeClass("vjs-using-native-controls");
this.trigger("usingcustomcontrols");
}
}
return this;
}
return this.usingNativeControls_;
};
_4.Player.prototype.error_=null;
_4.Player.prototype.error=function(err){
if(err===undefined){
return this.error_;
}
if(err===null){
this.error_=err;
this.removeClass("vjs-error");
return this;
}
if(err instanceof _4.MediaError){
this.error_=err;
}else{
this.error_=new _4.MediaError(err);
}
this.trigger("error");
this.addClass("vjs-error");
_4.log.error("(CODE:"+this.error_.code+" "+_4.MediaError.errorTypes[this.error_.code]+")",this.error_.message,this.error_);
return this;
};
_4.Player.prototype.ended=function(){
return this.techGet("ended");
};
_4.Player.prototype.seeking=function(){
return this.techGet("seeking");
};
_4.Player.prototype.seekable=function(){
return this.techGet("seekable");
};
_4.Player.prototype.userActivity_=true;
_4.Player.prototype.reportUserActivity=function(_12e){
this.userActivity_=true;
};
_4.Player.prototype.userActive_=true;
_4.Player.prototype.userActive=function(bool){
if(bool!==undefined){
bool=!!bool;
if(bool!==this.userActive_){
this.userActive_=bool;
if(bool){
this.userActivity_=true;
this.removeClass("vjs-user-inactive");
this.addClass("vjs-user-active");
this.trigger("useractive");
}else{
this.userActivity_=false;
if(this.tech){
this.tech.one("mousemove",function(e){
e.stopPropagation();
e.preventDefault();
});
}
this.removeClass("vjs-user-active");
this.addClass("vjs-user-inactive");
this.trigger("userinactive");
}
}
return this;
}
return this.userActive_;
};
_4.Player.prototype.listenForUserActivity=function(){
var _12f,_130,_131,_132,_133,_134,_135,_136,_137;
_12f=_4.bind(this,this.reportUserActivity);
_130=function(e){
if(e.screenX!=_136||e.screenY!=_137){
_136=e.screenX;
_137=e.screenY;
_12f();
}
};
_131=function(){
_12f();
this.clearInterval(_132);
_132=this.setInterval(_12f,250);
};
_133=function(_138){
_12f();
this.clearInterval(_132);
};
this.on("mousedown",_131);
this.on("mousemove",_130);
this.on("mouseup",_133);
this.on("keydown",_12f);
this.on("keyup",_12f);
_134=this.setInterval(function(){
if(this.userActivity_){
this.userActivity_=false;
this.userActive(true);
this.clearTimeout(_135);
var _139=this.options()["inactivityTimeout"];
if(_139>0){
_135=this.setTimeout(function(){
if(!this.userActivity_){
this.userActive(false);
}
},_139);
}
}
},250);
};
_4.Player.prototype.playbackRate=function(rate){
if(rate!==undefined){
this.techCall("setPlaybackRate",rate);
return this;
}
if(this.tech&&this.tech["featuresPlaybackRate"]){
return this.techGet("playbackRate");
}else{
return 1;
}
};
_4.Player.prototype.isAudio_=false;
_4.Player.prototype.isAudio=function(bool){
if(bool!==undefined){
this.isAudio_=!!bool;
return this;
}
return this.isAudio_;
};
_4.Player.prototype.networkState=function(){
return this.techGet("networkState");
};
_4.Player.prototype.readyState=function(){
return this.techGet("readyState");
};
_4.Player.prototype.textTracks=function(){
return this.tech&&this.tech["textTracks"]();
};
_4.Player.prototype.remoteTextTracks=function(){
return this.tech&&this.tech["remoteTextTracks"]();
};
_4.Player.prototype.addTextTrack=function(kind,_13a,_13b){
return this.tech&&this.tech["addTextTrack"](kind,_13a,_13b);
};
_4.Player.prototype.addRemoteTextTrack=function(_13c){
return this.tech&&this.tech["addRemoteTextTrack"](_13c);
};
_4.Player.prototype.removeRemoteTextTrack=function(_13d){
this.tech&&this.tech["removeRemoteTextTrack"](_13d);
};
_4.ControlBar=_4.Component.extend();
_4.ControlBar.prototype.options_={loadEvent:"play",children:{"playToggle":{},"currentTimeDisplay":{},"timeDivider":{},"durationDisplay":{},"remainingTimeDisplay":{},"liveDisplay":{},"progressControl":{},"fullscreenToggle":{},"volumeControl":{},"muteToggle":{},"playbackRateMenuButton":{},"subtitlesButton":{},"captionsButton":{},"chaptersButton":{}}};
_4.ControlBar.prototype.createEl=function(){
return _4.createEl("div",{className:"vjs-control-bar"});
};
_4.LiveDisplay=_4.Component.extend({init:function(_13e,_13f){
_4.Component.call(this,_13e,_13f);
}});
_4.LiveDisplay.prototype.createEl=function(){
var el=_4.Component.prototype.createEl.call(this,"div",{className:"vjs-live-controls vjs-control"});
this.contentEl_=_4.createEl("div",{className:"vjs-live-display",innerHTML:"<span class=\"vjs-control-text\">"+this.localize("Stream Type")+"</span>"+this.localize("LIVE"),"aria-live":"off"});
el.appendChild(this.contentEl_);
return el;
};
_4.PlayToggle=_4.Button.extend({init:function(_140,_141){
_4.Button.call(this,_140,_141);
this.on(_140,"play",this.onPlay);
this.on(_140,"pause",this.onPause);
}});
_4.PlayToggle.prototype.buttonText="Play";
_4.PlayToggle.prototype.buildCSSClass=function(){
return "vjs-play-control "+_4.Button.prototype.buildCSSClass.call(this);
};
_4.PlayToggle.prototype.onClick=function(){
if(this.player_.paused()){
if(this.player_.remainingTime()<0.25&&this.player_.techName=="Flash"){
this.player_.currentTime(0);
}
this.player_.play();
}else{
this.player_.pause();
}
};
_4.PlayToggle.prototype.onPlay=function(){
this.removeClass("vjs-paused");
this.addClass("vjs-playing");
this.el_.children[0].children[0].innerHTML=this.localize("Pause");
this.el_.title=this.localize("Pause");
};
_4.PlayToggle.prototype.onPause=function(){
this.removeClass("vjs-playing");
this.addClass("vjs-paused");
this.el_.children[0].children[0].innerHTML=this.localize("Play");
this.el_.title=this.localize("Play");
};
_4.CurrentTimeDisplay=_4.Component.extend({init:function(_142,_143){
_4.Component.call(this,_142,_143);
this.on(_142,"timeupdate",this.updateContent);
}});
_4.CurrentTimeDisplay.prototype.createEl=function(){
var el=_4.Component.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-controls vjs-control"});
this.contentEl_=_4.createEl("div",{className:"vjs-current-time-display",innerHTML:"<span class=\"vjs-control-text\">Current Time </span>"+"0:00","aria-live":"off"});
el.appendChild(this.contentEl_);
return el;
};
_4.CurrentTimeDisplay.prototype.updateContent=function(){
var time=(this.player_.scrubbing)?this.player_.getCache().currentTime:this.player_.currentTime();
this.contentEl_.innerHTML="<span class=\"vjs-control-text\">"+this.localize("Current Time")+"</span> "+_4.formatTime(time,this.player_.duration());
};
_4.DurationDisplay=_4.Component.extend({init:function(_144,_145){
_4.Component.call(this,_144,_145);
this.on(_144,"timeupdate",this.updateContent);
this.on(_144,"loadedmetadata",this.updateContent);
}});
_4.DurationDisplay.prototype.createEl=function(){
var el=_4.Component.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-controls vjs-control"});
this.contentEl_=_4.createEl("div",{className:"vjs-duration-display",innerHTML:"<span class=\"vjs-control-text\">"+this.localize("Duration Time")+"</span> "+"0:00","aria-live":"off"});
el.appendChild(this.contentEl_);
return el;
};
_4.DurationDisplay.prototype.updateContent=function(){
var _146=this.player_.duration();
if(_146){
this.contentEl_.innerHTML="<span class=\"vjs-control-text\">"+this.localize("Duration Time")+"</span> "+_4.formatTime(_146);
}
};
_4.TimeDivider=_4.Component.extend({init:function(_147,_148){
_4.Component.call(this,_147,_148);
}});
_4.TimeDivider.prototype.createEl=function(){
return _4.Component.prototype.createEl.call(this,"div",{className:"vjs-time-divider",innerHTML:"<div><span>/</span></div>"});
};
_4.RemainingTimeDisplay=_4.Component.extend({init:function(_149,_14a){
_4.Component.call(this,_149,_14a);
this.on(_149,"timeupdate",this.updateContent);
}});
_4.RemainingTimeDisplay.prototype.createEl=function(){
var el=_4.Component.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-controls vjs-control"});
this.contentEl_=_4.createEl("div",{className:"vjs-remaining-time-display",innerHTML:"<span class=\"vjs-control-text\">"+this.localize("Remaining Time")+"</span> "+"-0:00","aria-live":"off"});
el.appendChild(this.contentEl_);
return el;
};
_4.RemainingTimeDisplay.prototype.updateContent=function(){
if(this.player_.duration()){
this.contentEl_.innerHTML="<span class=\"vjs-control-text\">"+this.localize("Remaining Time")+"</span> "+"-"+_4.formatTime(this.player_.remainingTime());
}
};
_4.FullscreenToggle=_4.Button.extend({init:function(_14b,_14c){
_4.Button.call(this,_14b,_14c);
}});
_4.FullscreenToggle.prototype.buttonText="Fullscreen";
_4.FullscreenToggle.prototype.buildCSSClass=function(){
return "vjs-fullscreen-control "+_4.Button.prototype.buildCSSClass.call(this);
};
_4.FullscreenToggle.prototype.onClick=function(){
if(!this.player_.isFullscreen()){
this.player_.requestFullscreen();
this.controlText_.innerHTML=this.localize("Non-Fullscreen");
this.el_.title=this.localize("Non-Fullscreen");
}else{
this.player_.exitFullscreen();
this.controlText_.innerHTML=this.localize("Fullscreen");
this.el_.title=this.localize("Fullscreen");
}
};
_4.ProgressControl=_4.Component.extend({init:function(_14d,_14e){
_4.Component.call(this,_14d,_14e);
}});
_4.ProgressControl.prototype.options_={children:{"seekBar":{}}};
_4.ProgressControl.prototype.createEl=function(){
return _4.Component.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"});
};
_4.SeekBar=_4.Slider.extend({init:function(_14f,_150){
_4.Slider.call(this,_14f,_150);
this.on(_14f,"timeupdate",this.updateARIAAttributes);
_14f.ready(_4.bind(this,this.updateARIAAttributes));
}});
_4.SeekBar.prototype.options_={children:{"loadProgressBar":{},"playProgressBar":{},"seekHandle":{}},"barName":"playProgressBar","handleName":"seekHandle"};
_4.SeekBar.prototype.playerEvent="timeupdate";
_4.SeekBar.prototype.createEl=function(){
return _4.Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder","aria-label":"video progress bar","title":this.localize("Progress")});
};
_4.SeekBar.prototype.updateARIAAttributes=function(){
var time=(this.player_.scrubbing)?this.player_.getCache().currentTime:this.player_.currentTime();
this.el_.setAttribute("aria-valuenow",_4.round(this.getPercent()*100,2));
this.el_.setAttribute("aria-valuetext",_4.formatTime(time,this.player_.duration()));
};
_4.SeekBar.prototype.getPercent=function(){
return this.player_.currentTime()/this.player_.duration();
};
_4.SeekBar.prototype.onMouseDown=function(_151){
_4.Slider.prototype.onMouseDown.call(this,_151);
this.player_.scrubbing=true;
this.player_.addClass("vjs-scrubbing");
this.videoWasPlaying=!this.player_.paused();
this.player_.pause();
};
_4.SeekBar.prototype.onMouseMove=function(_152){
var _153=this.calculateDistance(_152)*this.player_.duration();
if(_153==this.player_.duration()){
_153=_153-0.25;
}
this.player_.currentTime(_153);
};
_4.SeekBar.prototype.onMouseUp=function(_154){
_4.Slider.prototype.onMouseUp.call(this,_154);
this.player_.scrubbing=false;
this.player_.removeClass("vjs-scrubbing");
if(this.videoWasPlaying){
this.player_.play();
}
};
_4.SeekBar.prototype.stepForward=function(){
if(this.player_.currentTime()+5>this.player_.duration()){
this.player_.currentTime(this.player_.duration()-0.25);
}else{
this.player_.currentTime(this.player_.currentTime()+5);
}
};
_4.SeekBar.prototype.stepBack=function(){
if(this.player_.currentTime()-5<0){
this.player_.currentTime(0);
}else{
this.player_.currentTime(this.player_.currentTime()-5);
}
};
_4.LoadProgressBar=_4.Component.extend({init:function(_155,_156){
_4.Component.call(this,_155,_156);
this.on(_155,"progress",this.update);
}});
_4.LoadProgressBar.prototype.createEl=function(){
return _4.Component.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:"<span class=\"vjs-control-text\"><span>"+this.localize("Loaded")+"</span>: 0%</span>"});
};
_4.LoadProgressBar.prototype.update=function(){
var i,_157,end,part,_158=this.player_.buffered(),_159=this.player_.duration(),_15a=this.player_.bufferedEnd(),_15b=this.el_.children,_15c=function(time,end){
var _15d=(time/end)||0;
return (_15d*100)+"%";
};
this.el_.style.width=_15c(_15a,_159);
for(i=0;i<_158.length;i++){
_157=_158.start(i),end=_158.end(i),part=_15b[i];
if(!part){
part=this.el_.appendChild(_4.createEl());
}
part.style.left=_15c(_157,_15a);
part.style.width=_15c(end-_157,_15a);
}
for(i=_15b.length;i>_158.length;i--){
this.el_.removeChild(_15b[i-1]);
}
};
_4.PlayProgressBar=_4.Component.extend({init:function(_15e,_15f){
_4.Component.call(this,_15e,_15f);
}});
_4.PlayProgressBar.prototype.createEl=function(){
return _4.Component.prototype.createEl.call(this,"div",{className:"vjs-play-progress",innerHTML:"<span class=\"vjs-control-text\"><span>"+this.localize("Progress")+"</span>: 0%</span>"});
};
_4.SeekHandle=_4.SliderHandle.extend({init:function(_160,_161){
_4.SliderHandle.call(this,_160,_161);
this.on(_160,"timeupdate",this.updateContent);
}});
_4.SeekHandle.prototype.defaultValue="00:00";
_4.SeekHandle.prototype.createEl=function(){
return _4.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-seek-handle","aria-live":"off"});
};
_4.SeekHandle.prototype.updateContent=function(){
var time=(this.player_.scrubbing)?this.player_.getCache().currentTime:this.player_.currentTime();
this.el_.innerHTML="<span class=\"vjs-control-text\">"+_4.formatTime(time,this.player_.duration())+"</span>";
};
_4.VolumeControl=_4.Component.extend({init:function(_162,_163){
_4.Component.call(this,_162,_163);
if(_162.tech&&_162.tech["featuresVolumeControl"]===false){
this.addClass("vjs-hidden");
}
this.on(_162,"loadstart",function(){
if(_162.tech["featuresVolumeControl"]===false){
this.addClass("vjs-hidden");
}else{
this.removeClass("vjs-hidden");
}
});
}});
_4.VolumeControl.prototype.options_={children:{"volumeBar":{}}};
_4.VolumeControl.prototype.createEl=function(){
return _4.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"});
};
_4.VolumeBar=_4.Slider.extend({init:function(_164,_165){
_4.Slider.call(this,_164,_165);
this.on(_164,"volumechange",this.updateARIAAttributes);
_164.ready(_4.bind(this,this.updateARIAAttributes));
}});
_4.VolumeBar.prototype.updateARIAAttributes=function(){
this.el_.setAttribute("aria-valuenow",_4.round(this.player_.volume()*100,2));
this.el_.setAttribute("aria-valuetext",_4.round(this.player_.volume()*100,2)+"%");
};
_4.VolumeBar.prototype.options_={children:{"volumeLevel":{},"volumeHandle":{}},"barName":"volumeLevel","handleName":"volumeHandle"};
_4.VolumeBar.prototype.playerEvent="volumechange";
_4.VolumeBar.prototype.createEl=function(){
return _4.Slider.prototype.createEl.call(this,"div",{className:"vjs-volume-bar","aria-label":"volume level","title":this.localize("Volume")});
};
_4.VolumeBar.prototype.onMouseMove=function(_166){
if(this.player_.muted()){
this.player_.muted(false);
}
this.player_.volume(this.calculateDistance(_166));
};
_4.VolumeBar.prototype.getPercent=function(){
if(this.player_.muted()){
return 0;
}else{
return this.player_.volume();
}
};
_4.VolumeBar.prototype.stepForward=function(){
this.player_.volume(this.player_.volume()+0.1);
};
_4.VolumeBar.prototype.stepBack=function(){
this.player_.volume(this.player_.volume()-0.1);
};
_4.VolumeLevel=_4.Component.extend({init:function(_167,_168){
_4.Component.call(this,_167,_168);
}});
_4.VolumeLevel.prototype.createEl=function(){
return _4.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:"<span class=\"vjs-control-text\"></span>"});
};
_4.VolumeHandle=_4.SliderHandle.extend();
_4.VolumeHandle.prototype.defaultValue="00:00";
_4.VolumeHandle.prototype.createEl=function(){
return _4.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-volume-handle"});
};
_4.MuteToggle=_4.Button.extend({init:function(_169,_16a){
_4.Button.call(this,_169,_16a);
this.on(_169,"volumechange",this.update);
if(_169.tech&&_169.tech["featuresVolumeControl"]===false){
this.addClass("vjs-hidden");
}
this.on(_169,"loadstart",function(){
if(_169.tech["featuresVolumeControl"]===false){
this.addClass("vjs-hidden");
}else{
this.removeClass("vjs-hidden");
}
});
}});
_4.MuteToggle.prototype.createEl=function(){
return _4.Button.prototype.createEl.call(this,"div",{className:"vjs-mute-control vjs-control",title:this.localize("Mute"),innerHTML:"<div><span class=\"vjs-control-text\">"+this.localize("Mute")+"</span></div>"});
};
_4.MuteToggle.prototype.onClick=function(){
this.player_.muted(this.player_.muted()?false:true);
};
_4.MuteToggle.prototype.update=function(){
var vol=this.player_.volume(),_16b=3;
if(vol===0||this.player_.muted()){
_16b=0;
}else{
if(vol<0.33){
_16b=1;
}else{
if(vol<0.67){
_16b=2;
}
}
}
if(this.player_.muted()){
if(this.el_.children[0].children[0].innerHTML!=this.localize("Unmute")){
this.el_.children[0].children[0].innerHTML=this.localize("Unmute");
this.el_.title=this.localize("Unmute");
}
}else{
if(this.el_.children[0].children[0].innerHTML!=this.localize("Mute")){
this.el_.children[0].children[0].innerHTML=this.localize("Mute");
this.el_.title=this.localize("Mute");
}
}
for(var i=0;i<4;i++){
_4.removeClass(this.el_,"vjs-vol-"+i);
}
_4.addClass(this.el_,"vjs-vol-"+_16b);
};
_4.VolumeMenuButton=_4.MenuButton.extend({init:function(_16c,_16d){
_4.MenuButton.call(this,_16c,_16d);
this.on(_16c,"volumechange",this.volumeUpdate);
if(_16c.tech&&_16c.tech["featuresVolumeControl"]===false){
this.addClass("vjs-hidden");
}
this.on(_16c,"loadstart",function(){
if(_16c.tech["featuresVolumeControl"]===false){
this.addClass("vjs-hidden");
}else{
this.removeClass("vjs-hidden");
}
});
this.addClass("vjs-menu-button");
}});
_4.VolumeMenuButton.prototype.createMenu=function(){
var menu=new _4.Menu(this.player_,{contentElType:"div"});
var vc=new _4.VolumeBar(this.player_,this.options_["volumeBar"]);
vc.on("focus",function(){
menu.lockShowing();
});
vc.on("blur",function(){
menu.unlockShowing();
});
menu.addChild(vc);
return menu;
};
_4.VolumeMenuButton.prototype.onClick=function(){
_4.MuteToggle.prototype.onClick.call(this);
_4.MenuButton.prototype.onClick.call(this);
};
_4.VolumeMenuButton.prototype.createEl=function(){
return _4.Button.prototype.createEl.call(this,"div",{className:"vjs-volume-menu-button vjs-menu-button vjs-control",innerHTML:"<div><span class=\"vjs-control-text\">"+this.localize("Mute")+"</span></div>"});
};
_4.VolumeMenuButton.prototype.volumeUpdate=_4.MuteToggle.prototype.update;
_4.PlaybackRateMenuButton=_4.MenuButton.extend({init:function(_16e,_16f){
_4.MenuButton.call(this,_16e,_16f);
this.updateVisibility();
this.updateLabel();
this.on(_16e,"loadstart",this.updateVisibility);
this.on(_16e,"ratechange",this.updateLabel);
}});
_4.PlaybackRateMenuButton.prototype.buttonText="Playback Rate";
_4.PlaybackRateMenuButton.prototype.className="vjs-playback-rate";
_4.PlaybackRateMenuButton.prototype.createEl=function(){
var el=_4.MenuButton.prototype.createEl.call(this);
this.labelEl_=_4.createEl("div",{className:"vjs-playback-rate-value",innerHTML:1});
el.appendChild(this.labelEl_);
return el;
};
_4.PlaybackRateMenuButton.prototype.createMenu=function(){
var menu=new _4.Menu(this.player());
var _170=this.player().options()["playbackRates"];
if(_170){
for(var i=_170.length-1;i>=0;i--){
menu.addChild(new _4.PlaybackRateMenuItem(this.player(),{"rate":_170[i]+"x"}));
}
}
return menu;
};
_4.PlaybackRateMenuButton.prototype.updateARIAAttributes=function(){
this.el().setAttribute("aria-valuenow",this.player().playbackRate());
};
_4.PlaybackRateMenuButton.prototype.onClick=function(){
var _171=this.player().playbackRate();
var _172=this.player().options()["playbackRates"];
var _173=_172[0];
for(var i=0;i<_172.length;i++){
if(_172[i]>_171){
_173=_172[i];
break;
}
}
this.player().playbackRate(_173);
};
_4.PlaybackRateMenuButton.prototype.playbackRateSupported=function(){
return this.player().tech&&this.player().tech["featuresPlaybackRate"]&&this.player().options()["playbackRates"]&&this.player().options()["playbackRates"].length>0;
};
_4.PlaybackRateMenuButton.prototype.updateVisibility=function(){
if(this.playbackRateSupported()){
this.removeClass("vjs-hidden");
}else{
this.addClass("vjs-hidden");
}
};
_4.PlaybackRateMenuButton.prototype.updateLabel=function(){
if(this.playbackRateSupported()){
this.labelEl_.innerHTML=this.player().playbackRate()+"x";
}
};
_4.PlaybackRateMenuItem=_4.MenuItem.extend({contentElType:"button",init:function(_174,_175){
var _176=this.label=_175["rate"];
var rate=this.rate=parseFloat(_176,10);
_175["label"]=_176;
_175["selected"]=rate===1;
_4.MenuItem.call(this,_174,_175);
this.on(_174,"ratechange",this.update);
}});
_4.PlaybackRateMenuItem.prototype.onClick=function(){
_4.MenuItem.prototype.onClick.call(this);
this.player().playbackRate(this.rate);
};
_4.PlaybackRateMenuItem.prototype.update=function(){
this.selected(this.player().playbackRate()==this.rate);
};
_4.PosterImage=_4.Button.extend({init:function(_177,_178){
_4.Button.call(this,_177,_178);
this.update();
_177.on("posterchange",_4.bind(this,this.update));
}});
_4.PosterImage.prototype.dispose=function(){
this.player().off("posterchange",this.update);
_4.Button.prototype.dispose.call(this);
};
_4.PosterImage.prototype.createEl=function(){
var el=_4.createEl("div",{className:"vjs-poster",tabIndex:-1});
if(!_4.BACKGROUND_SIZE_SUPPORTED){
this.fallbackImg_=_4.createEl("img");
el.appendChild(this.fallbackImg_);
}
return el;
};
_4.PosterImage.prototype.update=function(){
var url=this.player().poster();
this.setSrc(url);
if(url){
this.show();
}else{
this.hide();
}
};
_4.PosterImage.prototype.setSrc=function(url){
var _179;
if(this.fallbackImg_){
this.fallbackImg_.src=url;
}else{
_179="";
if(url){
_179="url(\""+url+"\")";
}
this.el_.style.backgroundImage=_179;
}
};
_4.PosterImage.prototype.onClick=function(){
this.player_.play();
};
_4.LoadingSpinner=_4.Component.extend({init:function(_17a,_17b){
_4.Component.call(this,_17a,_17b);
}});
_4.LoadingSpinner.prototype.createEl=function(){
return _4.Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner"});
};
_4.BigPlayButton=_4.Button.extend();
_4.BigPlayButton.prototype.createEl=function(){
return _4.Button.prototype.createEl.call(this,"div",{className:"vjs-big-play-button",innerHTML:"<span aria-hidden=\"true\"></span>","aria-label":"play video"});
};
_4.BigPlayButton.prototype.onClick=function(){
this.player_.play();
};
_4.ErrorDisplay=_4.Component.extend({init:function(_17c,_17d){
_4.Component.call(this,_17c,_17d);
this.update();
this.on(_17c,"error",this.update);
}});
_4.ErrorDisplay.prototype.createEl=function(){
var el=_4.Component.prototype.createEl.call(this,"div",{className:"vjs-error-display"});
this.contentEl_=_4.createEl("div");
el.appendChild(this.contentEl_);
return el;
};
_4.ErrorDisplay.prototype.update=function(){
if(this.player().error()){
this.contentEl_.innerHTML=this.localize(this.player().error().message);
}
};
(function(){
var _17e;
_4.MediaTechController=_4.Component.extend({init:function(_17f,_180,_181){
_180=_180||{};
_180.reportTouchActivity=false;
_4.Component.call(this,_17f,_180,_181);
if(!this["featuresProgressEvents"]){
this.manualProgressOn();
}
if(!this["featuresTimeupdateEvents"]){
this.manualTimeUpdatesOn();
}
this.initControlsListeners();
if(!this["featuresNativeTextTracks"]){
this.emulateTextTracks();
}
this.initTextTrackListeners();
}});
_4.MediaTechController.prototype.initControlsListeners=function(){
var _182,_183;
_182=this.player();
_183=function(){
if(_182.controls()&&!_182.usingNativeControls()){
this.addControlsListeners();
}
};
this.ready(_183);
this.on(_182,"controlsenabled",_183);
this.on(_182,"controlsdisabled",this.removeControlsListeners);
this.ready(function(){
if(this.networkState&&this.networkState()>0){
this.player().trigger("loadstart");
}
});
};
_4.MediaTechController.prototype.addControlsListeners=function(){
var _184;
this.on("mousedown",this.onClick);
this.on("touchstart",function(_185){
_184=this.player_.userActive();
});
this.on("touchmove",function(_186){
if(_184){
this.player().reportUserActivity();
}
});
this.on("touchend",function(_187){
_187.preventDefault();
});
this.emitTapEvents();
this.on("tap",this.onTap);
};
_4.MediaTechController.prototype.removeControlsListeners=function(){
this.off("tap");
this.off("touchstart");
this.off("touchmove");
this.off("touchleave");
this.off("touchcancel");
this.off("touchend");
this.off("click");
this.off("mousedown");
};
_4.MediaTechController.prototype.onClick=function(_188){
if(_188.button!==0){
return;
}
if(this.player_.remainingTime()<0.25&&this.player_.techName=="Flash"){
this.player_.currentTime(0);
}
if(this.player().controls()){
if(this.player().paused()){
this.player().play();
}else{
this.player().pause();
}
}
};
_4.MediaTechController.prototype.onTap=function(){
this.player().userActive(!this.player().userActive());
};
_4.MediaTechController.prototype.manualProgressOn=function(){
this.manualProgress=true;
this.trackProgress();
};
_4.MediaTechController.prototype.manualProgressOff=function(){
this.manualProgress=false;
this.stopTrackingProgress();
};
_4.MediaTechController.prototype.trackProgress=function(){
this.progressInterval=this.setInterval(function(){
var _189=this.player().bufferedPercent();
if(this.bufferedPercent_!=_189){
this.player().trigger("progress");
}
this.bufferedPercent_=_189;
if(_189===1){
this.stopTrackingProgress();
}
},500);
};
_4.MediaTechController.prototype.stopTrackingProgress=function(){
this.clearInterval(this.progressInterval);
};
_4.MediaTechController.prototype.manualTimeUpdatesOn=function(){
var _18a=this.player_;
this.manualTimeUpdates=true;
this.on(_18a,"play",this.trackCurrentTime);
this.on(_18a,"pause",this.stopTrackingCurrentTime);
this.one("timeupdate",function(){
this["featuresTimeupdateEvents"]=true;
this.manualTimeUpdatesOff();
});
};
_4.MediaTechController.prototype.manualTimeUpdatesOff=function(){
var _18b=this.player_;
this.manualTimeUpdates=false;
this.stopTrackingCurrentTime();
this.off(_18b,"play",this.trackCurrentTime);
this.off(_18b,"pause",this.stopTrackingCurrentTime);
};
_4.MediaTechController.prototype.trackCurrentTime=function(){
if(this.currentTimeInterval){
this.stopTrackingCurrentTime();
}
this.currentTimeInterval=this.setInterval(function(){
this.player().trigger("timeupdate");
},250);
};
_4.MediaTechController.prototype.stopTrackingCurrentTime=function(){
this.clearInterval(this.currentTimeInterval);
this.player().trigger("timeupdate");
};
_4.MediaTechController.prototype.dispose=function(){
if(this.manualProgress){
this.manualProgressOff();
}
if(this.manualTimeUpdates){
this.manualTimeUpdatesOff();
}
_4.Component.prototype.dispose.call(this);
};
_4.MediaTechController.prototype.setCurrentTime=function(){
if(this.manualTimeUpdates){
this.player().trigger("timeupdate");
}
};
_4.MediaTechController.prototype.initTextTrackListeners=function(){
var _18c=this.player_,_18d,_18e=function(){
var _18f=_18c.getChild("textTrackDisplay"),_190;
if(_18f){
_18f.updateDisplay();
}
};
_18d=this.textTracks();
if(!_18d){
return;
}
_18d.addEventListener("removetrack",_18e);
_18d.addEventListener("addtrack",_18e);
this.on("dispose",_4.bind(this,function(){
_18d.removeEventListener("removetrack",_18e);
_18d.removeEventListener("addtrack",_18e);
}));
};
_4.MediaTechController.prototype.emulateTextTracks=function(){
var _191=this.player_,_192,_193,_194;
if(!window["WebVTT"]){
_194=document.createElement("script");
_194.src=_191.options()["vtt.js"]||"../node_modules/vtt.js/dist/vtt.js";
_191.el().appendChild(_194);
window["WebVTT"]=true;
}
_193=this.textTracks();
if(!_193){
return;
}
_192=function(){
var i,_195,_196;
_196=_191.getChild("textTrackDisplay"),_196.updateDisplay();
for(i=0;i<this.length;i++){
_195=this[i];
_195.removeEventListener("cuechange",_4.bind(_196,_196.updateDisplay));
if(_195.mode==="showing"){
_195.addEventListener("cuechange",_4.bind(_196,_196.updateDisplay));
}
}
};
_193.addEventListener("change",_192);
this.on("dispose",_4.bind(this,function(){
_193.removeEventListener("change",_192);
}));
};
_4.MediaTechController.prototype.textTracks_;
_4.MediaTechController.prototype.textTracks=function(){
this.player_.textTracks_=this.player_.textTracks_||new _4.TextTrackList();
return this.player_.textTracks_;
};
_4.MediaTechController.prototype.remoteTextTracks=function(){
this.player_.remoteTextTracks_=this.player_.remoteTextTracks_||new _4.TextTrackList();
return this.player_.remoteTextTracks_;
};
_17e=function(self,kind,_197,_198,_199){
var _19a=self.textTracks(),_19b;
_199=_199||{};
_199["kind"]=kind;
if(_197){
_199["label"]=_197;
}
if(_198){
_199["language"]=_198;
}
_199["player"]=self.player_;
_19b=new _4.TextTrack(_199);
_19a.addTrack_(_19b);
return _19b;
};
_4.MediaTechController.prototype.addTextTrack=function(kind,_19c,_19d){
if(!kind){
throw new Error("TextTrack kind is required but was not provided");
}
return _17e(this,kind,_19c,_19d);
};
_4.MediaTechController.prototype.addRemoteTextTrack=function(_19e){
var _19f=_17e(this,_19e["kind"],_19e["label"],_19e["language"],_19e);
this.remoteTextTracks().addTrack_(_19f);
return {track:_19f};
};
_4.MediaTechController.prototype.removeRemoteTextTrack=function(_1a0){
this.textTracks().removeTrack_(_1a0);
this.remoteTextTracks().removeTrack_(_1a0);
};
_4.MediaTechController.prototype.setPoster=function(){
};
_4.MediaTechController.prototype["featuresVolumeControl"]=true;
_4.MediaTechController.prototype["featuresFullscreenResize"]=false;
_4.MediaTechController.prototype["featuresPlaybackRate"]=false;
_4.MediaTechController.prototype["featuresProgressEvents"]=false;
_4.MediaTechController.prototype["featuresTimeupdateEvents"]=false;
_4.MediaTechController.prototype["featuresNativeTextTracks"]=false;
_4.MediaTechController.withSourceHandlers=function(Tech){
Tech["registerSourceHandler"]=function(_1a1,_1a2){
var _1a3=Tech.sourceHandlers;
if(!_1a3){
_1a3=Tech.sourceHandlers=[];
}
if(_1a2===undefined){
_1a2=_1a3.length;
}
_1a3.splice(_1a2,0,_1a1);
};
Tech.selectSourceHandler=function(_1a4){
var _1a5=Tech.sourceHandlers||[],can;
for(var i=0;i<_1a5.length;i++){
can=_1a5[i]["canHandleSource"](_1a4);
if(can){
return _1a5[i];
}
}
return null;
};
Tech.canPlaySource=function(_1a6){
var sh=Tech.selectSourceHandler(_1a6);
if(sh){
return sh["canHandleSource"](_1a6);
}
return "";
};
Tech.prototype.setSource=function(_1a7){
var sh=Tech.selectSourceHandler(_1a7);
if(!sh){
if(Tech["nativeSourceHandler"]){
sh=Tech["nativeSourceHandler"];
}else{
_4.log.error("No source hander found for the current source.");
}
}
this.disposeSourceHandler();
this.off("dispose",this.disposeSourceHandler);
this.currentSource_=_1a7;
this.sourceHandler_=sh["handleSource"](_1a7,this);
this.on("dispose",this.disposeSourceHandler);
return this;
};
Tech.prototype.disposeSourceHandler=function(){
if(this.sourceHandler_&&this.sourceHandler_["dispose"]){
this.sourceHandler_["dispose"]();
}
};
};
_4.media={};
})();
_4.Html5=_4.MediaTechController.extend({init:function(_1a8,_1a9,_1aa){
var _1ab,_1ac,i,node,_1ad,_1ae;
if(_1a9["nativeCaptions"]===false||_1a9["nativeTextTracks"]===false){
this["featuresNativeTextTracks"]=false;
}
_4.MediaTechController.call(this,_1a8,_1a9,_1aa);
this.setupTriggers();
var _1af=_1a9["source"];
if(_1af&&(this.el_.currentSrc!==_1af.src||(_1a8.tag&&_1a8.tag.initNetworkState_===3))){
this.setSource(_1af);
}
if(this.el_.hasChildNodes()){
_1ab=this.el_.childNodes;
_1ac=_1ab.length;
_1ae=[];
while(_1ac--){
node=_1ab[_1ac];
_1ad=node.nodeName.toLowerCase();
if(_1ad==="track"){
if(!this["featuresNativeTextTracks"]){
_1ae.push(node);
}else{
this.remoteTextTracks().addTrack_(node["track"]);
}
}
}
for(i=0;i<_1ae.length;i++){
this.el_.removeChild(_1ae[i]);
}
}
if(_4.TOUCH_ENABLED&&_1a8.options()["nativeControlsForTouch"]===true){
this.useNativeControls();
}
_1a8.ready(function(){
if(this.src()&&this.tag&&this.options_["autoplay"]&&this.paused()){
delete this.tag["poster"];
this.play();
}
});
this.triggerReady();
}});
_4.Html5.prototype.dispose=function(){
_4.Html5.disposeMediaElement(this.el_);
_4.MediaTechController.prototype.dispose.call(this);
};
_4.Html5.prototype.createEl=function(){
var _1b0=this.player_,_1b1,_1b2,i,el=_1b0.tag,_1b3,_1b4,_1b5;
if(!el||this["movingMediaElementInDOM"]===false){
if(el){
_1b5=el.cloneNode(false);
_4.Html5.disposeMediaElement(el);
el=_1b5;
_1b0.tag=null;
}else{
el=_4.createEl("video");
_1b3=_8.util.mergeOptions({},_1b0.tagAttributes);
if(!_4.TOUCH_ENABLED||_1b0.options()["nativeControlsForTouch"]!==true){
delete _1b3.controls;
}
_4.setElementAttributes(el,_4.obj.merge(_1b3,{id:_1b0.id()+"_html5_api","class":"vjs-tech"}));
}
el["player"]=_1b0;
if(_1b0.options_.tracks){
for(i=0;i<_1b0.options_.tracks.length;i++){
_1b1=_1b0.options_.tracks[i];
_1b2=document.createElement("track");
_1b2.kind=_1b1.kind;
_1b2.label=_1b1.label;
_1b2.srclang=_1b1.srclang;
_1b2.src=_1b1.src;
if("default" in _1b1){
_1b2.setAttribute("default","default");
}
el.appendChild(_1b2);
}
}
_4.insertFirst(el,_1b0.el());
}
var _1b6=["autoplay","preload","loop","muted"];
for(i=_1b6.length-1;i>=0;i--){
var attr=_1b6[i];
var _1b7={};
if(typeof _1b0.options_[attr]!=="undefined"){
_1b7[attr]=_1b0.options_[attr];
}
_4.setElementAttributes(el,_1b7);
}
return el;
};
_4.Html5.prototype.setupTriggers=function(){
for(var i=_4.Html5.Events.length-1;i>=0;i--){
this.on(_4.Html5.Events[i],this.eventHandler);
}
};
_4.Html5.prototype.eventHandler=function(evt){
if(evt.type=="error"&&this.error()){
this.player().error(this.error().code);
}else{
evt.bubbles=false;
this.player().trigger(evt);
}
};
_4.Html5.prototype.useNativeControls=function(){
var tech,_1b8,_1b9,_1ba,_1bb;
tech=this;
_1b8=this.player();
tech.setControls(_1b8.controls());
_1b9=function(){
tech.setControls(true);
};
_1ba=function(){
tech.setControls(false);
};
_1b8.on("controlsenabled",_1b9);
_1b8.on("controlsdisabled",_1ba);
_1bb=function(){
_1b8.off("controlsenabled",_1b9);
_1b8.off("controlsdisabled",_1ba);
};
tech.on("dispose",_1bb);
_1b8.on("usingcustomcontrols",_1bb);
_1b8.usingNativeControls(true);
};
_4.Html5.prototype.play=function(){
this.el_.play();
};
_4.Html5.prototype.pause=function(){
this.el_.pause();
};
_4.Html5.prototype.paused=function(){
return this.el_.paused;
};
_4.Html5.prototype.currentTime=function(){
return this.el_.currentTime;
};
_4.Html5.prototype.setCurrentTime=function(_1bc){
try{
this.el_.currentTime=_1bc;
}
catch(e){
_4.log(e,"Video is not ready. (Video.js)");
}
};
_4.Html5.prototype.duration=function(){
return this.el_.duration||0;
};
_4.Html5.prototype.buffered=function(){
return this.el_.buffered;
};
_4.Html5.prototype.volume=function(){
return this.el_.volume;
};
_4.Html5.prototype.setVolume=function(_1bd){
this.el_.volume=_1bd;
};
_4.Html5.prototype.muted=function(){
return this.el_.muted;
};
_4.Html5.prototype.setMuted=function(_1be){
this.el_.muted=_1be;
};
_4.Html5.prototype.width=function(){
return this.el_.offsetWidth;
};
_4.Html5.prototype.height=function(){
return this.el_.offsetHeight;
};
_4.Html5.prototype.supportsFullScreen=function(){
if(typeof this.el_.webkitEnterFullScreen=="function"){
if(/Android/.test(_4.USER_AGENT)||!/Chrome|Mac OS X 10.5/.test(_4.USER_AGENT)){
return true;
}
}
return false;
};
_4.Html5.prototype.enterFullScreen=function(){
var _1bf=this.el_;
if("webkitDisplayingFullscreen" in _1bf){
this.one("webkitbeginfullscreen",function(){
this.player_.isFullscreen(true);
this.one("webkitendfullscreen",function(){
this.player_.isFullscreen(false);
this.player_.trigger("fullscreenchange");
});
this.player_.trigger("fullscreenchange");
});
}
if(_1bf.paused&&_1bf.networkState<=_1bf.HAVE_METADATA){
this.el_.play();
this.setTimeout(function(){
_1bf.pause();
_1bf.webkitEnterFullScreen();
},0);
}else{
_1bf.webkitEnterFullScreen();
}
};
_4.Html5.prototype.exitFullScreen=function(){
this.el_.webkitExitFullScreen();
};
_4.Html5.prototype.returnOriginalIfBlobURI_=function(_1c0,_1c1){
var _1c2=/^blob\:/i;
if(_1c1&&_1c0&&_1c2.test(_1c0)){
return _1c1;
}
return _1c0;
};
_4.Html5.prototype.src=function(src){
var _1c3=this.el_.src;
if(src===undefined){
return this.returnOriginalIfBlobURI_(_1c3,this.source_);
}else{
this.setSrc(src);
}
};
_4.Html5.prototype.setSrc=function(src){
this.el_.src=src;
};
_4.Html5.prototype.load=function(){
this.el_.load();
};
_4.Html5.prototype.currentSrc=function(){
var _1c4=this.el_.currentSrc;
if(!this.currentSource_){
return _1c4;
}
return this.returnOriginalIfBlobURI_(_1c4,this.currentSource_.src);
};
_4.Html5.prototype.poster=function(){
return this.el_.poster;
};
_4.Html5.prototype.setPoster=function(val){
this.el_.poster=val;
};
_4.Html5.prototype.preload=function(){
return this.el_.preload;
};
_4.Html5.prototype.setPreload=function(val){
this.el_.preload=val;
};
_4.Html5.prototype.autoplay=function(){
return this.el_.autoplay;
};
_4.Html5.prototype.setAutoplay=function(val){
this.el_.autoplay=val;
};
_4.Html5.prototype.controls=function(){
return this.el_.controls;
};
_4.Html5.prototype.setControls=function(val){
this.el_.controls=!!val;
};
_4.Html5.prototype.loop=function(){
return this.el_.loop;
};
_4.Html5.prototype.setLoop=function(val){
this.el_.loop=val;
};
_4.Html5.prototype.error=function(){
return this.el_.error;
};
_4.Html5.prototype.seeking=function(){
return this.el_.seeking;
};
_4.Html5.prototype.seekable=function(){
return this.el_.seekable;
};
_4.Html5.prototype.ended=function(){
return this.el_.ended;
};
_4.Html5.prototype.defaultMuted=function(){
return this.el_.defaultMuted;
};
_4.Html5.prototype.playbackRate=function(){
return this.el_.playbackRate;
};
_4.Html5.prototype.setPlaybackRate=function(val){
this.el_.playbackRate=val;
};
_4.Html5.prototype.networkState=function(){
return this.el_.networkState;
};
_4.Html5.prototype.readyState=function(){
return this.el_.readyState;
};
_4.Html5.prototype.textTracks=function(){
if(!this["featuresNativeTextTracks"]){
return _4.MediaTechController.prototype.textTracks.call(this);
}
return this.el_.textTracks;
};
_4.Html5.prototype.addTextTrack=function(kind,_1c5,_1c6){
if(!this["featuresNativeTextTracks"]){
return _4.MediaTechController.prototype.addTextTrack.call(this,kind,_1c5,_1c6);
}
return this.el_.addTextTrack(kind,_1c5,_1c6);
};
_4.Html5.prototype.addRemoteTextTrack=function(_1c7){
if(!this["featuresNativeTextTracks"]){
return _4.MediaTechController.prototype.addRemoteTextTrack.call(this,_1c7);
}
var _1c8=document.createElement("track");
_1c7=_1c7||{};
if(_1c7["kind"]){
_1c8["kind"]=_1c7["kind"];
}
if(_1c7["label"]){
_1c8["label"]=_1c7["label"];
}
if(_1c7["language"]||_1c7["srclang"]){
_1c8["srclang"]=_1c7["language"]||_1c7["srclang"];
}
if(_1c7["default"]){
_1c8["default"]=_1c7["default"];
}
if(_1c7["id"]){
_1c8["id"]=_1c7["id"];
}
if(_1c7["src"]){
_1c8["src"]=_1c7["src"];
}
this.el().appendChild(_1c8);
this.remoteTextTracks().addTrack_(_1c8.track);
return _1c8;
};
_4.Html5.prototype.removeRemoteTextTrack=function(_1c9){
if(!this["featuresNativeTextTracks"]){
return _4.MediaTechController.prototype.removeRemoteTextTrack.call(this,_1c9);
}
var _1ca,i;
this.remoteTextTracks().removeTrack_(_1c9);
_1ca=this.el()["querySelectorAll"]("track");
for(i=0;i<_1ca.length;i++){
if(_1ca[i]===_1c9||_1ca[i]["track"]===_1c9){
_1ca[i]["parentNode"]["removeChild"](_1ca[i]);
break;
}
}
};
_4.Html5.isSupported=function(){
try{
_4.TEST_VID["volume"]=0.5;
}
catch(e){
return false;
}
return !!_4.TEST_VID.canPlayType;
};
_4.MediaTechController.withSourceHandlers(_4.Html5);
(function(){
var _1cb=_4.Html5.prototype.setSource,_1cc=_4.Html5.prototype.disposeSourceHandler;
_4.Html5.prototype.setSource=function(_1cd){
var _1ce=_1cb.call(this,_1cd);
this.source_=_1cd.src;
return _1ce;
};
_4.Html5.prototype.disposeSourceHandler=function(){
this.source_=undefined;
return _1cc.call(this);
};
})();
_4.Html5["nativeSourceHandler"]={};
_4.Html5["nativeSourceHandler"]["canHandleSource"]=function(_1cf){
var _1d0,ext;
function _1d1(type){
try{
return _4.TEST_VID.canPlayType(type);
}
catch(e){
return "";
}
};
if(_1cf.type){
return _1d1(_1cf.type);
}else{
if(_1cf.src){
_1d0=_1cf.src.match(/\.([^.\/\?]+)(\?[^\/]+)?$/i);
ext=_1d0&&_1d0[1];
return _1d1("video/"+ext);
}
}
return "";
};
_4.Html5["nativeSourceHandler"]["handleSource"]=function(_1d2,tech){
tech.setSrc(_1d2.src);
};
_4.Html5["nativeSourceHandler"]["dispose"]=function(){
};
_4.Html5["registerSourceHandler"](_4.Html5["nativeSourceHandler"]);
_4.Html5.canControlVolume=function(){
var _1d3=_4.TEST_VID.volume;
try{
_4.TEST_VID.volume=(_1d3/2)+0.1;
}
catch(e){
return false;
}
return _1d3!==_4.TEST_VID.volume;
};
_4.Html5.canControlPlaybackRate=function(){
var _1d4=_4.TEST_VID.playbackRate;
try{
_4.TEST_VID.playbackRate=(_1d4/2)+0.1;
}
catch(e){
return false;
}
return _1d4!==_4.TEST_VID.playbackRate;
};
_4.Html5.supportsNativeTextTracks=function(){
var _1d5;
_1d5=!!_4.TEST_VID.textTracks;
if(_1d5&&_4.TEST_VID.textTracks.length>0){
_1d5=typeof _4.TEST_VID.textTracks[0]["mode"]!=="number";
}
if(_1d5&&_4.IS_FIREFOX){
_1d5=false;
}
return _1d5;
};
_4.Html5.prototype["featuresVolumeControl"]=_4.Html5.canControlVolume();
_4.Html5.prototype["featuresPlaybackRate"]=_4.Html5.canControlPlaybackRate();
_4.Html5.prototype["movingMediaElementInDOM"]=!_4.IS_IOS;
_4.Html5.prototype["featuresFullscreenResize"]=true;
_4.Html5.prototype["featuresProgressEvents"]=true;
_4.Html5.prototype["featuresNativeTextTracks"]=_4.Html5.supportsNativeTextTracks();
(function(){
var _1d6,_1d7=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,_1d8=/^video\/mp4/i;
_4.Html5.patchCanPlayType=function(){
if(_4.ANDROID_VERSION>=4){
if(!_1d6){
_1d6=_4.TEST_VID.constructor.prototype.canPlayType;
}
_4.TEST_VID.constructor.prototype.canPlayType=function(type){
if(type&&_1d7.test(type)){
return "maybe";
}
return _1d6.call(this,type);
};
}
if(_4.IS_OLD_ANDROID){
if(!_1d6){
_1d6=_4.TEST_VID.constructor.prototype.canPlayType;
}
_4.TEST_VID.constructor.prototype.canPlayType=function(type){
if(type&&_1d8.test(type)){
return "maybe";
}
return _1d6.call(this,type);
};
}
};
_4.Html5.unpatchCanPlayType=function(){
var r=_4.TEST_VID.constructor.prototype.canPlayType;
_4.TEST_VID.constructor.prototype.canPlayType=_1d6;
_1d6=null;
return r;
};
_4.Html5.patchCanPlayType();
})();
_4.Html5.Events="loadstart,suspend,abort,error,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,playing,waiting,seeking,seeked,ended,durationchange,timeupdate,progress,play,pause,ratechange,volumechange".split(",");
_4.Html5.disposeMediaElement=function(el){
if(!el){
return;
}
el["player"]=null;
if(el.parentNode){
el.parentNode.removeChild(el);
}
while(el.hasChildNodes()){
el.removeChild(el.firstChild);
}
el.removeAttribute("src");
if(typeof el.load==="function"){
(function(){
try{
el.load();
}
catch(e){
}
})();
}
};
_4.Flash=_4.MediaTechController.extend({init:function(_1d9,_1da,_1db){
_4.MediaTechController.call(this,_1d9,_1da,_1db);
var _1dc=_1da["source"],_1dd=_1d9.id()+"_flash_api",_1de=_1d9.options_,_1df=_4.obj.merge({"readyFunction":"videojs.Flash.onReady","eventProxyFunction":"videojs.Flash.onEvent","errorEventProxyFunction":"videojs.Flash.onError","autoplay":_1de.autoplay,"preload":_1de.preload,"loop":_1de.loop,"muted":_1de.muted},_1da["flashVars"]),_1e0=_4.obj.merge({"wmode":"opaque","bgcolor":"#000000"},_1da["params"]),_1e1=_4.obj.merge({"id":_1dd,"name":_1dd,"class":"vjs-tech"},_1da["attributes"]);
if(_1dc){
this.ready(function(){
this.setSource(_1dc);
});
}
_4.insertFirst(this.el_,_1da["parentEl"]);
if(_1da["startTime"]){
this.ready(function(){
this.load();
this.play();
this["currentTime"](_1da["startTime"]);
});
}
if(_4.IS_FIREFOX){
this.ready(function(){
this.on("mousemove",function(){
this.player().trigger({"type":"mousemove","bubbles":false});
});
});
}
_1d9.on("stageclick",_1d9.reportUserActivity);
this.el_=_4.Flash.embed(_1da["swf"],this.el_,_1df,_1e0,_1e1);
}});
_4.Flash.prototype.dispose=function(){
_4.MediaTechController.prototype.dispose.call(this);
};
_4.Flash.prototype.play=function(){
this.el_.vjs_play();
};
_4.Flash.prototype.pause=function(){
this.el_.vjs_pause();
};
_4.Flash.prototype.src=function(src){
if(src===undefined){
return this["currentSrc"]();
}
return this.setSrc(src);
};
_4.Flash.prototype.setSrc=function(src){
src=_4.getAbsoluteURL(src);
this.el_.vjs_src(src);
if(this.player_.autoplay()){
var tech=this;
this.setTimeout(function(){
tech.play();
},0);
}
};
_4.Flash.prototype["setCurrentTime"]=function(time){
this.lastSeekTarget_=time;
this.el_.vjs_setProperty("currentTime",time);
_4.MediaTechController.prototype.setCurrentTime.call(this);
};
_4.Flash.prototype["currentTime"]=function(time){
if(this.seeking()){
return this.lastSeekTarget_||0;
}
return this.el_.vjs_getProperty("currentTime");
};
_4.Flash.prototype["currentSrc"]=function(){
if(this.currentSource_){
return this.currentSource_.src;
}else{
return this.el_.vjs_getProperty("currentSrc");
}
};
_4.Flash.prototype.load=function(){
this.el_.vjs_load();
};
_4.Flash.prototype.poster=function(){
this.el_.vjs_getProperty("poster");
};
_4.Flash.prototype["setPoster"]=function(){
};
_4.Flash.prototype.seekable=function(){
var _1e2=this.duration();
if(_1e2===0){
return _4.createTimeRange();
}
return _4.createTimeRange(0,this.duration());
};
_4.Flash.prototype.buffered=function(){
if(!this.el_.vjs_getProperty){
return _4.createTimeRange();
}
return _4.createTimeRange(0,this.el_.vjs_getProperty("buffered"));
};
_4.Flash.prototype.duration=function(){
if(!this.el_.vjs_getProperty){
return 0;
}
return this.el_.vjs_getProperty("duration");
};
_4.Flash.prototype.supportsFullScreen=function(){
return false;
};
_4.Flash.prototype.enterFullScreen=function(){
return false;
};
(function(){
var api=_4.Flash.prototype,_1e3="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),_1e4="error,networkState,readyState,seeking,initialTime,startOffsetTime,paused,played,ended,videoTracks,audioTracks,videoWidth,videoHeight".split(","),i;
function _1e5(attr){
var _1e6=attr.charAt(0).toUpperCase()+attr.slice(1);
api["set"+_1e6]=function(val){
return this.el_.vjs_setProperty(attr,val);
};
};
function _1e7(attr){
api[attr]=function(){
return this.el_.vjs_getProperty(attr);
};
};
for(i=0;i<_1e3.length;i++){
_1e7(_1e3[i]);
_1e5(_1e3[i]);
}
for(i=0;i<_1e4.length;i++){
_1e7(_1e4[i]);
}
})();
_4.Flash.isSupported=function(){
return _4.Flash.version()[0]>=10;
};
_4.MediaTechController.withSourceHandlers(_4.Flash);
_4.Flash["nativeSourceHandler"]={};
_4.Flash["nativeSourceHandler"]["canHandleSource"]=function(_1e8){
var type;
if(!_1e8.type){
return "";
}
type=_1e8.type.replace(/;.*/,"").toLowerCase();
if(type in _4.Flash.formats){
return "maybe";
}
return "";
};
_4.Flash["nativeSourceHandler"]["handleSource"]=function(_1e9,tech){
tech.setSrc(_1e9.src);
};
_4.Flash["nativeSourceHandler"]["dispose"]=function(){
};
_4.Flash["registerSourceHandler"](_4.Flash["nativeSourceHandler"]);
_4.Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"};
_4.Flash["onReady"]=function(_1ea){
var el,_1eb;
el=_4.el(_1ea);
_1eb=el&&el.parentNode&&el.parentNode["player"];
if(_1eb){
el["player"]=_1eb;
_4.Flash["checkReady"](_1eb.tech);
}
};
_4.Flash["checkReady"]=function(tech){
if(!tech.el()){
return;
}
if(tech.el().vjs_getProperty){
tech.triggerReady();
}else{
this.setTimeout(function(){
_4.Flash["checkReady"](tech);
},50);
}
};
_4.Flash["onEvent"]=function(_1ec,_1ed){
var _1ee=_4.el(_1ec)["player"];
_1ee.trigger(_1ed);
};
_4.Flash["onError"]=function(_1ef,err){
var _1f0=_4.el(_1ef)["player"];
var msg="FLASH: "+err;
if(err=="srcnotfound"){
_1f0.error({code:4,message:msg});
}else{
_1f0.error(msg);
}
};
_4.Flash.version=function(){
var _1f1="0,0,0";
try{
_1f1=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1];
}
catch(e){
try{
if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){
_1f1=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1];
}
}
catch(err){
}
}
return _1f1.split(",");
};
_4.Flash.embed=function(swf,_1f2,_1f3,_1f4,_1f5){
var code=_4.Flash.getEmbedCode(swf,_1f3,_1f4,_1f5),obj=_4.createEl("div",{innerHTML:code}).childNodes[0],par=_1f2.parentNode;
_1f2.parentNode.replaceChild(obj,_1f2);
obj[_4.expando]=_1f2[_4.expando];
var _1f6=par.childNodes[0];
setTimeout(function(){
_1f6.style.display="block";
},1000);
return obj;
};
_4.Flash.getEmbedCode=function(swf,_1f7,_1f8,_1f9){
var _1fa="<object type=\"application/x-shockwave-flash\" ",_1fb="",_1fc="",_1fd="";
if(_1f7){
_4.obj.each(_1f7,function(key,val){
_1fb+=(key+"="+val+"&amp;");
});
}
_1f8=_4.obj.merge({"movie":swf,"flashvars":_1fb,"allowScriptAccess":"always","allowNetworking":"all"},_1f8);
_4.obj.each(_1f8,function(key,val){
_1fc+="<param name=\""+key+"\" value=\""+val+"\" />";
});
_1f9=_4.obj.merge({"data":swf,"width":"100%","height":"100%"},_1f9);
_4.obj.each(_1f9,function(key,val){
_1fd+=(key+"=\""+val+"\" ");
});
return _1fa+_1fd+">"+_1fc+"</object>";
};
_4.Flash.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"};
_4.Flash.streamFromParts=function(_1fe,_1ff){
return _1fe+"&"+_1ff;
};
_4.Flash.streamToParts=function(src){
var _200={connection:"",stream:""};
if(!src){
return _200;
}
var _201=src.indexOf("&");
var _202;
if(_201!==-1){
_202=_201+1;
}else{
_201=_202=src.lastIndexOf("/")+1;
if(_201===0){
_201=_202=src.length;
}
}
_200.connection=src.substring(0,_201);
_200.stream=src.substring(_202,src.length);
return _200;
};
_4.Flash.isStreamingType=function(_203){
return _203 in _4.Flash.streamingFormats;
};
_4.Flash.RTMP_RE=/^rtmp[set]?:\/\//i;
_4.Flash.isStreamingSrc=function(src){
return _4.Flash.RTMP_RE.test(src);
};
_4.Flash.rtmpSourceHandler={};
_4.Flash.rtmpSourceHandler["canHandleSource"]=function(_204){
if(_4.Flash.isStreamingType(_204.type)||_4.Flash.isStreamingSrc(_204.src)){
return "maybe";
}
return "";
};
_4.Flash.rtmpSourceHandler["handleSource"]=function(_205,tech){
var _206=_4.Flash.streamToParts(_205.src);
tech["setRtmpConnection"](_206.connection);
tech["setRtmpStream"](_206.stream);
};
_4.Flash["registerSourceHandler"](_4.Flash.rtmpSourceHandler);
_4.MediaLoader=_4.Component.extend({init:function(_207,_208,_209){
_4.Component.call(this,_207,_208,_209);
if(!_207.options_["sources"]||_207.options_["sources"].length===0){
for(var i=0,j=_207.options_["techOrder"];i<j.length;i++){
var _20a=_4.capitalize(j[i]),tech=window["videojs"][_20a];
if(tech&&tech.isSupported()){
_207.loadTech(_20a);
break;
}
}
}else{
_207.src(_207.options_["sources"]);
}
}});
_4.TextTrackMode={"disabled":"disabled","hidden":"hidden","showing":"showing"};
_4.TextTrackKind={"subtitles":"subtitles","captions":"captions","descriptions":"descriptions","chapters":"chapters","metadata":"metadata"};
(function(){
_4.TextTrack=function(_20b){
var tt,id,mode,kind,_20c,_20d,cues,_20e,_20f,_210,prop;
_20b=_20b||{};
if(!_20b["player"]){
throw new Error("A player was not provided.");
}
tt=this;
if(_4.IS_IE8){
tt=document.createElement("custom");
for(prop in _4.TextTrack.prototype){
tt[prop]=_4.TextTrack.prototype[prop];
}
}
tt.player_=_20b["player"];
mode=_4.TextTrackMode[_20b["mode"]]||"disabled";
kind=_4.TextTrackKind[_20b["kind"]]||"subtitles";
_20c=_20b["label"]||"";
_20d=_20b["language"]||_20b["srclang"]||"";
id=_20b["id"]||"vjs_text_track_"+_4.guid++;
if(kind==="metadata"||kind==="chapters"){
mode="hidden";
}
tt.cues_=[];
tt.activeCues_=[];
cues=new _4.TextTrackCueList(tt.cues_);
_20e=new _4.TextTrackCueList(tt.activeCues_);
_210=false;
_20f=_4.bind(tt,function(){
this["activeCues"];
if(_210){
this["trigger"]("cuechange");
_210=false;
}
});
if(mode!=="disabled"){
tt.player_.on("timeupdate",_20f);
}
Object.defineProperty(tt,"kind",{get:function(){
return kind;
},set:Function.prototype});
Object.defineProperty(tt,"label",{get:function(){
return _20c;
},set:Function.prototype});
Object.defineProperty(tt,"language",{get:function(){
return _20d;
},set:Function.prototype});
Object.defineProperty(tt,"id",{get:function(){
return id;
},set:Function.prototype});
Object.defineProperty(tt,"mode",{get:function(){
return mode;
},set:function(_211){
if(!_4.TextTrackMode[_211]){
return;
}
mode=_211;
if(mode==="showing"){
this.player_.on("timeupdate",_20f);
}
this.trigger("modechange");
}});
Object.defineProperty(tt,"cues",{get:function(){
if(!this.loaded_){
return null;
}
return cues;
},set:Function.prototype});
Object.defineProperty(tt,"activeCues",{get:function(){
var i,l,_212,ct,cue;
if(!this.loaded_){
return null;
}
if(this["cues"].length===0){
return _20e;
}
ct=this.player_.currentTime();
i=0;
l=this["cues"].length;
_212=[];
for(;i<l;i++){
cue=this["cues"][i];
if(cue["startTime"]<=ct&&cue["endTime"]>=ct){
_212.push(cue);
}else{
if(cue["startTime"]===cue["endTime"]&&cue["startTime"]<=ct&&cue["startTime"]+0.5>=ct){
_212.push(cue);
}
}
}
_210=false;
if(_212.length!==this.activeCues_.length){
_210=true;
}else{
for(i=0;i<_212.length;i++){
if(_213.call(this.activeCues_,_212[i])===-1){
_210=true;
}
}
}
this.activeCues_=_212;
_20e.setCues_(this.activeCues_);
return _20e;
},set:Function.prototype});
if(_20b.src){
_214(_20b.src,tt);
}else{
tt.loaded_=true;
}
if(_4.IS_IE8){
return tt;
}
};
_4.TextTrack.prototype=_4.obj.create(_4.EventEmitter.prototype);
_4.TextTrack.prototype.constructor=_4.TextTrack;
_4.TextTrack.prototype.allowedEvents_={"cuechange":"cuechange"};
_4.TextTrack.prototype.addCue=function(cue){
var _215=this.player_.textTracks(),i=0;
if(_215){
for(;i<_215.length;i++){
if(_215[i]!==this){
_215[i].removeCue(cue);
}
}
}
this.cues_.push(cue);
this["cues"].setCues_(this.cues_);
};
_4.TextTrack.prototype.removeCue=function(_216){
var i=0,l=this.cues_.length,cue,_217=false;
for(;i<l;i++){
cue=this.cues_[i];
if(cue===_216){
this.cues_.splice(i,1);
_217=true;
}
}
if(_217){
this.cues.setCues_(this.cues_);
}
};
var _214,_218,_213;
_214=function(src,_219){
_4.xhr(src,_4.bind(this,function(err,_21a,_21b){
if(err){
return _4.log.error(err);
}
_219.loaded_=true;
_218(_21b,_219);
}));
};
_218=function(_21c,_21d){
if(typeof window["WebVTT"]!=="function"){
return window.setTimeout(function(){
_218(_21c,_21d);
},25);
}
var _21e=new window["WebVTT"]["Parser"](window,window["vttjs"],window["WebVTT"]["StringDecoder"]());
_21e["oncue"]=function(cue){
_21d.addCue(cue);
};
_21e["onparsingerror"]=function(_21f){
_4.log.error(_21f);
};
_21e["parse"](_21c);
_21e["flush"]();
};
_213=function(_220,_221){
var k;
if(this==null){
throw new TypeError("\"this\" is null or not defined");
}
var O=Object(this);
var len=O.length>>>0;
if(len===0){
return -1;
}
var n=+_221||0;
if(Math.abs(n)===Infinity){
n=0;
}
if(n>=len){
return -1;
}
k=Math.max(n>=0?n:len-Math.abs(n),0);
while(k<len){
if(k in O&&O[k]===_220){
return k;
}
k++;
}
return -1;
};
})();
_4.TextTrackList=function(_222){
var list=this,prop,i=0;
if(_4.IS_IE8){
list=document.createElement("custom");
for(prop in _4.TextTrackList.prototype){
list[prop]=_4.TextTrackList.prototype[prop];
}
}
_222=_222||[];
list.tracks_=[];
Object.defineProperty(list,"length",{get:function(){
return this.tracks_.length;
}});
for(;i<_222.length;i++){
list.addTrack_(_222[i]);
}
if(_4.IS_IE8){
return list;
}
};
_4.TextTrackList.prototype=_4.obj.create(_4.EventEmitter.prototype);
_4.TextTrackList.prototype.constructor=_4.TextTrackList;
_4.TextTrackList.prototype.allowedEvents_={"change":"change","addtrack":"addtrack","removetrack":"removetrack"};
(function(){
var _223;
for(_223 in _4.TextTrackList.prototype.allowedEvents_){
_4.TextTrackList.prototype["on"+_223]=null;
}
})();
_4.TextTrackList.prototype.addTrack_=function(_224){
var _225=this.tracks_.length;
if(!(""+_225 in this)){
Object.defineProperty(this,_225,{get:function(){
return this.tracks_[_225];
}});
}
_224.addEventListener("modechange",_4.bind(this,function(){
this.trigger("change");
}));
this.tracks_.push(_224);
this.trigger({type:"addtrack",track:_224});
};
_4.TextTrackList.prototype.removeTrack_=function(_226){
var i=0,l=this.length,_227=null,_228;
for(;i<l;i++){
_228=this[i];
if(_228===_226){
this.tracks_.splice(i,1);
break;
}
}
this.trigger({type:"removetrack",track:_226});
};
_4.TextTrackList.prototype.getTrackById=function(id){
var i=0,l=this.length,_229=null,_22a;
for(;i<l;i++){
_22a=this[i];
if(_22a.id===id){
_229=_22a;
break;
}
}
return _229;
};
_4.TextTrackCueList=function(cues){
var list=this,prop;
if(_4.IS_IE8){
list=document.createElement("custom");
for(prop in _4.TextTrackCueList.prototype){
list[prop]=_4.TextTrackCueList.prototype[prop];
}
}
_4.TextTrackCueList.prototype.setCues_.call(list,cues);
Object.defineProperty(list,"length",{get:function(){
return this.length_;
}});
if(_4.IS_IE8){
return list;
}
};
_4.TextTrackCueList.prototype.setCues_=function(cues){
var _22b=this.length||0,i=0,l=cues.length,_22c;
this.cues_=cues;
this.length_=cues.length;
_22c=function(i){
if(!(""+i in this)){
Object.defineProperty(this,""+i,{get:function(){
return this.cues_[i];
}});
}
};
if(_22b<l){
i=_22b;
for(;i<l;i++){
_22c.call(this,i);
}
}
};
_4.TextTrackCueList.prototype.getCueById=function(id){
var i=0,l=this.length,_22d=null,cue;
for(;i<l;i++){
cue=this[i];
if(cue.id===id){
_22d=cue;
break;
}
}
return _22d;
};
(function(){
"use strict";
_4.TextTrackDisplay=_4.Component.extend({init:function(_22e,_22f,_230){
_4.Component.call(this,_22e,_22f,_230);
_22e.on("loadstart",_4.bind(this,this.toggleDisplay));
_22e.ready(_4.bind(this,function(){
if(_22e.tech&&_22e.tech["featuresNativeTextTracks"]){
this.hide();
return;
}
var i,_231,_232;
_22e.on("fullscreenchange",_4.bind(this,this.updateDisplay));
_231=_22e.options_["tracks"]||[];
for(i=0;i<_231.length;i++){
_232=_231[i];
this.player_.addRemoteTextTrack(_232);
}
}));
}});
_4.TextTrackDisplay.prototype.toggleDisplay=function(){
if(this.player_.tech&&this.player_.tech["featuresNativeTextTracks"]){
this.hide();
}else{
this.show();
}
};
_4.TextTrackDisplay.prototype.createEl=function(){
return _4.Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"});
};
_4.TextTrackDisplay.prototype.clearDisplay=function(){
if(typeof window["WebVTT"]==="function"){
window["WebVTT"]["processCues"](window,[],this.el_);
}
};
var _233=function(_234,_235){
return "rgba("+parseInt(_234[1]+_234[1],16)+","+parseInt(_234[2]+_234[2],16)+","+parseInt(_234[3]+_234[3],16)+","+_235+")";
};
var _236="#222";
var _237="#ccc";
var _238={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:"\"Andale Mono\", \"Lucida Console\", monospace",monospaceSerif:"\"Courier New\", monospace",proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:"\"Comic Sans MS\", Impact, fantasy",script:"\"Monotype Corsiva\", cursive",smallcaps:"\"Andale Mono\", \"Lucida Console\", monospace, sans-serif"};
var _239=function(el,_23a,rule){
try{
el.style[_23a]=rule;
}
catch(e){
}
};
_4.TextTrackDisplay.prototype.updateDisplay=function(){
var _23b=this.player_.textTracks(),i=0,_23c;
this.clearDisplay();
if(!_23b){
return;
}
for(;i<_23b.length;i++){
_23c=_23b[i];
if(_23c["mode"]==="showing"){
this.updateForTrack(_23c);
}
}
};
_4.TextTrackDisplay.prototype.updateForTrack=function(_23d){
if(typeof window["WebVTT"]!=="function"||!_23d["activeCues"]){
return;
}
var i=0,_23e,_23f,_240=this.player_["textTrackSettings"].getValues(),_241,cues=[];
for(;i<_23d["activeCues"].length;i++){
cues.push(_23d["activeCues"][i]);
}
window["WebVTT"]["processCues"](window,_23d["activeCues"],this.el_);
i=cues.length;
while(i--){
_23f=cues[i].displayState;
if(_240.color){
_23f.firstChild.style.color=_240.color;
}
if(_240.textOpacity){
_239(_23f.firstChild,"color",_233(_240.color||"#fff",_240.textOpacity));
}
if(_240.backgroundColor){
_23f.firstChild.style.backgroundColor=_240.backgroundColor;
}
if(_240.backgroundOpacity){
_239(_23f.firstChild,"backgroundColor",_233(_240.backgroundColor||"#000",_240.backgroundOpacity));
}
if(_240.windowColor){
if(_240.windowOpacity){
_239(_23f,"backgroundColor",_233(_240.windowColor,_240.windowOpacity));
}else{
_23f.style.backgroundColor=_240.windowColor;
}
}
if(_240.edgeStyle){
if(_240.edgeStyle==="dropshadow"){
_23f.firstChild.style.textShadow="2px 2px 3px "+_236+", 2px 2px 4px "+_236+", 2px 2px 5px "+_236;
}else{
if(_240.edgeStyle==="raised"){
_23f.firstChild.style.textShadow="1px 1px "+_236+", 2px 2px "+_236+", 3px 3px "+_236;
}else{
if(_240.edgeStyle==="depressed"){
_23f.firstChild.style.textShadow="1px 1px "+_237+", 0 1px "+_237+", -1px -1px "+_236+", 0 -1px "+_236;
}else{
if(_240.edgeStyle==="uniform"){
_23f.firstChild.style.textShadow="0 0 4px "+_236+", 0 0 4px "+_236+", 0 0 4px "+_236+", 0 0 4px "+_236;
}
}
}
}
}
if(_240.fontPercent&&_240.fontPercent!==1){
_241=window.parseFloat(_23f.style.fontSize);
_23f.style.fontSize=(_241*_240.fontPercent)+"px";
_23f.style.height="auto";
_23f.style.top="auto";
_23f.style.bottom="2px";
}
if(_240.fontFamily&&_240.fontFamily!=="default"){
if(_240.fontFamily==="small-caps"){
_23f.firstChild.style.fontVariant="small-caps";
}else{
_23f.firstChild.style.fontFamily=_238[_240.fontFamily];
}
}
}
};
_4.TextTrackMenuItem=_4.MenuItem.extend({init:function(_242,_243){
var _244=this.track=_243["track"],_245=_242.textTracks(),_246,_247;
if(_245){
_246=_4.bind(this,function(){
var _248=this.track["mode"]==="showing",_244,i,l;
if(this instanceof _4.OffTextTrackMenuItem){
_248=true;
i=0,l=_245.length;
for(;i<l;i++){
_244=_245[i];
if(_244["kind"]===this.track["kind"]&&_244["mode"]==="showing"){
_248=false;
break;
}
}
}
this.selected(_248);
});
_245.addEventListener("change",_246);
_242.on("dispose",function(){
_245.removeEventListener("change",_246);
});
}
_243["label"]=_244["label"]||_244["language"]||"Unknown";
_243["selected"]=_244["default"]||_244["mode"]==="showing";
_4.MenuItem.call(this,_242,_243);
if(_245&&_245.onchange===undefined){
this.on(["tap","click"],function(){
if(typeof window.Event!=="object"){
try{
_247=new window.Event("change");
}
catch(err){
}
}
if(!_247){
_247=document.createEvent("Event");
_247.initEvent("change",true,true);
}
_245.dispatchEvent(_247);
});
}
}});
_4.TextTrackMenuItem.prototype.onClick=function(){
var kind=this.track["kind"],_249=this.player_.textTracks(),mode,_24a,i=0;
_4.MenuItem.prototype.onClick.call(this);
if(!_249){
return;
}
for(;i<_249.length;i++){
_24a=_249[i];
if(_24a["kind"]!==kind){
continue;
}
if(_24a===this.track){
_24a["mode"]="showing";
}else{
_24a["mode"]="disabled";
}
}
};
_4.OffTextTrackMenuItem=_4.TextTrackMenuItem.extend({init:function(_24b,_24c){
_24c["track"]={"kind":_24c["kind"],"player":_24b,"label":_24c["kind"]+" off","default":false,"mode":"disabled"};
_4.TextTrackMenuItem.call(this,_24b,_24c);
this.selected(true);
}});
_4.CaptionSettingsMenuItem=_4.TextTrackMenuItem.extend({init:function(_24d,_24e){
_24e["track"]={"kind":_24e["kind"],"player":_24d,"label":_24e["kind"]+" settings","default":false,mode:"disabled"};
_4.TextTrackMenuItem.call(this,_24d,_24e);
this.addClass("vjs-texttrack-settings");
}});
_4.CaptionSettingsMenuItem.prototype.onClick=function(){
this.player().getChild("textTrackSettings").show();
};
_4.TextTrackButton=_4.MenuButton.extend({init:function(_24f,_250){
var _251,_252;
_4.MenuButton.call(this,_24f,_250);
_251=this.player_.textTracks();
if(this.items.length<=1){
this.hide();
}
if(!_251){
return;
}
_252=_4.bind(this,this.update);
_251.addEventListener("removetrack",_252);
_251.addEventListener("addtrack",_252);
this.player_.on("dispose",function(){
_251.removeEventListener("removetrack",_252);
_251.removeEventListener("addtrack",_252);
});
}});
_4.TextTrackButton.prototype.createItems=function(){
var _253=[],_254,_255;
if(this instanceof _4.CaptionsButton&&!(this.player().tech&&this.player().tech["featuresNativeTextTracks"])){
_253.push(new _4.CaptionSettingsMenuItem(this.player_,{"kind":this.kind_}));
}
_253.push(new _4.OffTextTrackMenuItem(this.player_,{"kind":this.kind_}));
_255=this.player_.textTracks();
if(!_255){
return _253;
}
for(var i=0;i<_255.length;i++){
_254=_255[i];
if(_254["kind"]===this.kind_){
_253.push(new _4.TextTrackMenuItem(this.player_,{"track":_254}));
}
}
return _253;
};
_4.CaptionsButton=_4.TextTrackButton.extend({init:function(_256,_257,_258){
_4.TextTrackButton.call(this,_256,_257,_258);
this.el_.setAttribute("aria-label","Captions Menu");
}});
_4.CaptionsButton.prototype.kind_="captions";
_4.CaptionsButton.prototype.buttonText="Captions";
_4.CaptionsButton.prototype.className="vjs-captions-button";
_4.CaptionsButton.prototype.update=function(){
var _259=2;
_4.TextTrackButton.prototype.update.call(this);
if(this.player().tech&&this.player().tech["featuresNativeTextTracks"]){
_259=1;
}
if(this.items&&this.items.length>_259){
this.show();
}else{
this.hide();
}
};
_4.SubtitlesButton=_4.TextTrackButton.extend({init:function(_25a,_25b,_25c){
_4.TextTrackButton.call(this,_25a,_25b,_25c);
this.el_.setAttribute("aria-label","Subtitles Menu");
}});
_4.SubtitlesButton.prototype.kind_="subtitles";
_4.SubtitlesButton.prototype.buttonText="Subtitles";
_4.SubtitlesButton.prototype.className="vjs-subtitles-button";
_4.ChaptersButton=_4.TextTrackButton.extend({init:function(_25d,_25e,_25f){
_4.TextTrackButton.call(this,_25d,_25e,_25f);
this.el_.setAttribute("aria-label","Chapters Menu");
}});
_4.ChaptersButton.prototype.kind_="chapters";
_4.ChaptersButton.prototype.buttonText="Chapters";
_4.ChaptersButton.prototype.className="vjs-chapters-button";
_4.ChaptersButton.prototype.createItems=function(){
var _260=[],_261,_262;
_262=this.player_.textTracks();
if(!_262){
return _260;
}
for(var i=0;i<_262.length;i++){
_261=_262[i];
if(_261["kind"]===this.kind_){
_260.push(new _4.TextTrackMenuItem(this.player_,{"track":_261}));
}
}
return _260;
};
_4.ChaptersButton.prototype.createMenu=function(){
var _263=this.player_.textTracks()||[],i=0,l=_263.length,_264,_265,_266=this.items=[];
for(;i<l;i++){
_264=_263[i];
if(_264["kind"]==this.kind_){
if(!_264.cues){
_264["mode"]="hidden";
window.setTimeout(_4.bind(this,function(){
this.createMenu();
}),100);
}else{
_265=_264;
break;
}
}
}
var menu=this.menu;
if(menu===undefined){
menu=new _4.Menu(this.player_);
menu.contentEl().appendChild(_4.createEl("li",{className:"vjs-menu-title",innerHTML:_4.capitalize(this.kind_),tabindex:-1}));
}
if(_265){
var cues=_265["cues"],cue,mi;
i=0;
l=cues.length;
for(;i<l;i++){
cue=cues[i];
mi=new _4.ChaptersTrackMenuItem(this.player_,{"track":_265,"cue":cue});
_266.push(mi);
menu.addChild(mi);
}
this.addChild(menu);
}
if(this.items.length>0){
this.show();
}
return menu;
};
_4.ChaptersTrackMenuItem=_4.MenuItem.extend({init:function(_267,_268){
var _269=this.track=_268["track"],cue=this.cue=_268["cue"],_26a=_267.currentTime();
_268["label"]=cue.text;
_268["selected"]=(cue["startTime"]<=_26a&&_26a<cue["endTime"]);
_4.MenuItem.call(this,_267,_268);
_269.addEventListener("cuechange",_4.bind(this,this.update));
}});
_4.ChaptersTrackMenuItem.prototype.onClick=function(){
_4.MenuItem.prototype.onClick.call(this);
this.player_.currentTime(this.cue.startTime);
this.update(this.cue.startTime);
};
_4.ChaptersTrackMenuItem.prototype.update=function(){
var cue=this.cue,_26b=this.player_.currentTime();
this.selected(cue["startTime"]<=_26b&&_26b<cue["endTime"]);
};
})();
(function(){
"use strict";
_4.TextTrackSettings=_4.Component.extend({init:function(_26c,_26d){
_4.Component.call(this,_26c,_26d);
this.hide();
_4.on(this.el().querySelector(".vjs-done-button"),"click",_4.bind(this,function(){
this.saveSettings();
this.hide();
}));
_4.on(this.el().querySelector(".vjs-default-button"),"click",_4.bind(this,function(){
this.el().querySelector(".vjs-fg-color > select").selectedIndex=0;
this.el().querySelector(".vjs-bg-color > select").selectedIndex=0;
this.el().querySelector(".window-color > select").selectedIndex=0;
this.el().querySelector(".vjs-text-opacity > select").selectedIndex=0;
this.el().querySelector(".vjs-bg-opacity > select").selectedIndex=0;
this.el().querySelector(".vjs-window-opacity > select").selectedIndex=0;
this.el().querySelector(".vjs-edge-style select").selectedIndex=0;
this.el().querySelector(".vjs-font-family select").selectedIndex=0;
this.el().querySelector(".vjs-font-percent select").selectedIndex=2;
this.updateDisplay();
}));
_4.on(this.el().querySelector(".vjs-fg-color > select"),"change",_4.bind(this,this.updateDisplay));
_4.on(this.el().querySelector(".vjs-bg-color > select"),"change",_4.bind(this,this.updateDisplay));
_4.on(this.el().querySelector(".window-color > select"),"change",_4.bind(this,this.updateDisplay));
_4.on(this.el().querySelector(".vjs-text-opacity > select"),"change",_4.bind(this,this.updateDisplay));
_4.on(this.el().querySelector(".vjs-bg-opacity > select"),"change",_4.bind(this,this.updateDisplay));
_4.on(this.el().querySelector(".vjs-window-opacity > select"),"change",_4.bind(this,this.updateDisplay));
_4.on(this.el().querySelector(".vjs-font-percent select"),"change",_4.bind(this,this.updateDisplay));
_4.on(this.el().querySelector(".vjs-edge-style select"),"change",_4.bind(this,this.updateDisplay));
_4.on(this.el().querySelector(".vjs-font-family select"),"change",_4.bind(this,this.updateDisplay));
if(_26c.options()["persistTextTrackSettings"]){
this.restoreSettings();
}
}});
_4.TextTrackSettings.prototype.createEl=function(){
return _4.Component.prototype.createEl.call(this,"div",{className:"vjs-caption-settings vjs-modal-overlay",innerHTML:_26e()});
};
_4.TextTrackSettings.prototype.getValues=function(){
var el,_26f,_270,_271,_272,_273,_274,_275,_276,_277,name,_278;
el=this.el();
_272=_279(el.querySelector(".vjs-edge-style select"));
_273=_279(el.querySelector(".vjs-font-family select"));
_274=_279(el.querySelector(".vjs-fg-color > select"));
_270=_279(el.querySelector(".vjs-text-opacity > select"));
_275=_279(el.querySelector(".vjs-bg-color > select"));
_26f=_279(el.querySelector(".vjs-bg-opacity > select"));
_276=_279(el.querySelector(".window-color > select"));
_271=_279(el.querySelector(".vjs-window-opacity > select"));
_278=window["parseFloat"](_279(el.querySelector(".vjs-font-percent > select")));
_277={"backgroundOpacity":_26f,"textOpacity":_270,"windowOpacity":_271,"edgeStyle":_272,"fontFamily":_273,"color":_274,"backgroundColor":_275,"windowColor":_276,"fontPercent":_278};
for(name in _277){
if(_277[name]===""||_277[name]==="none"||(name==="fontPercent"&&_277[name]===1)){
delete _277[name];
}
}
return _277;
};
_4.TextTrackSettings.prototype.setValues=function(_27a){
var el=this.el(),_27b;
_27c(el.querySelector(".vjs-edge-style select"),_27a.edgeStyle);
_27c(el.querySelector(".vjs-font-family select"),_27a.fontFamily);
_27c(el.querySelector(".vjs-fg-color > select"),_27a.color);
_27c(el.querySelector(".vjs-text-opacity > select"),_27a.textOpacity);
_27c(el.querySelector(".vjs-bg-color > select"),_27a.backgroundColor);
_27c(el.querySelector(".vjs-bg-opacity > select"),_27a.backgroundOpacity);
_27c(el.querySelector(".window-color > select"),_27a.windowColor);
_27c(el.querySelector(".vjs-window-opacity > select"),_27a.windowOpacity);
_27b=_27a.fontPercent;
if(_27b){
_27b=_27b.toFixed(2);
}
_27c(el.querySelector(".vjs-font-percent > select"),_27b);
};
_4.TextTrackSettings.prototype.restoreSettings=function(){
var _27d;
try{
_27d=JSON.parse(window.localStorage.getItem("vjs-text-track-settings"));
}
catch(e){
}
if(_27d){
this.setValues(_27d);
}
};
_4.TextTrackSettings.prototype.saveSettings=function(){
var _27e;
if(!this.player_.options()["persistTextTrackSettings"]){
return;
}
_27e=this.getValues();
try{
if(!_4.isEmpty(_27e)){
window.localStorage.setItem("vjs-text-track-settings",JSON.stringify(_27e));
}else{
window.localStorage.removeItem("vjs-text-track-settings");
}
}
catch(e){
}
};
_4.TextTrackSettings.prototype.updateDisplay=function(){
var _27f=this.player_.getChild("textTrackDisplay");
if(_27f){
_27f.updateDisplay();
}
};
function _279(_280){
var _281;
if(_280.selectedOptions){
_281=_280.selectedOptions[0];
}else{
if(_280.options){
_281=_280.options[_280.options.selectedIndex];
}
}
return _281.value;
};
function _27c(_282,_283){
var i,_284;
if(!_283){
return;
}
for(i=0;i<_282.options.length;i++){
_284=_282.options[i];
if(_284.value===_283){
break;
}
}
_282.selectedIndex=i;
};
function _26e(){
return "<div class=\"vjs-tracksettings\">"+"<div class=\"vjs-tracksettings-colors\">"+"<div class=\"vjs-fg-color vjs-tracksetting\">"+"<label class=\"vjs-label\">Foreground</label>"+"<select>"+"<option value=\"\">---</option>"+"<option value=\"#FFF\">White</option>"+"<option value=\"#000\">Black</option>"+"<option value=\"#F00\">Red</option>"+"<option value=\"#0F0\">Green</option>"+"<option value=\"#00F\">Blue</option>"+"<option value=\"#FF0\">Yellow</option>"+"<option value=\"#F0F\">Magenta</option>"+"<option value=\"#0FF\">Cyan</option>"+"</select>"+"<span class=\"vjs-text-opacity vjs-opacity\">"+"<select>"+"<option value=\"\">---</option>"+"<option value=\"1\">Opaque</option>"+"<option value=\"0.5\">Semi-Opaque</option>"+"</select>"+"</span>"+"</div>"+"<div class=\"vjs-bg-color vjs-tracksetting\">"+"<label class=\"vjs-label\">Background</label>"+"<select>"+"<option value=\"\">---</option>"+"<option value=\"#FFF\">White</option>"+"<option value=\"#000\">Black</option>"+"<option value=\"#F00\">Red</option>"+"<option value=\"#0F0\">Green</option>"+"<option value=\"#00F\">Blue</option>"+"<option value=\"#FF0\">Yellow</option>"+"<option value=\"#F0F\">Magenta</option>"+"<option value=\"#0FF\">Cyan</option>"+"</select>"+"<span class=\"vjs-bg-opacity vjs-opacity\">"+"<select>"+"<option value=\"\">---</option>"+"<option value=\"1\">Opaque</option>"+"<option value=\"0.5\">Semi-Transparent</option>"+"<option value=\"0\">Transparent</option>"+"</select>"+"</span>"+"</div>"+"<div class=\"window-color vjs-tracksetting\">"+"<label class=\"vjs-label\">Window</label>"+"<select>"+"<option value=\"\">---</option>"+"<option value=\"#FFF\">White</option>"+"<option value=\"#000\">Black</option>"+"<option value=\"#F00\">Red</option>"+"<option value=\"#0F0\">Green</option>"+"<option value=\"#00F\">Blue</option>"+"<option value=\"#FF0\">Yellow</option>"+"<option value=\"#F0F\">Magenta</option>"+"<option value=\"#0FF\">Cyan</option>"+"</select>"+"<span class=\"vjs-window-opacity vjs-opacity\">"+"<select>"+"<option value=\"\">---</option>"+"<option value=\"1\">Opaque</option>"+"<option value=\"0.5\">Semi-Transparent</option>"+"<option value=\"0\">Transparent</option>"+"</select>"+"</span>"+"</div>"+"</div>"+"<div class=\"vjs-tracksettings-font\">"+"<div class=\"vjs-font-percent vjs-tracksetting\">"+"<label class=\"vjs-label\">Font Size</label>"+"<select>"+"<option value=\"0.50\">50%</option>"+"<option value=\"0.75\">75%</option>"+"<option value=\"1.00\" selected>100%</option>"+"<option value=\"1.25\">125%</option>"+"<option value=\"1.50\">150%</option>"+"<option value=\"1.75\">175%</option>"+"<option value=\"2.00\">200%</option>"+"<option value=\"3.00\">300%</option>"+"<option value=\"4.00\">400%</option>"+"</select>"+"</div>"+"<div class=\"vjs-edge-style vjs-tracksetting\">"+"<label class=\"vjs-label\">Text Edge Style</label>"+"<select>"+"<option value=\"none\">None</option>"+"<option value=\"raised\">Raised</option>"+"<option value=\"depressed\">Depressed</option>"+"<option value=\"uniform\">Uniform</option>"+"<option value=\"dropshadow\">Dropshadow</option>"+"</select>"+"</div>"+"<div class=\"vjs-font-family vjs-tracksetting\">"+"<label class=\"vjs-label\">Font Family</label>"+"<select>"+"<option value=\"\">Default</option>"+"<option value=\"monospaceSerif\">Monospace Serif</option>"+"<option value=\"proportionalSerif\">Proportional Serif</option>"+"<option value=\"monospaceSansSerif\">Monospace Sans-Serif</option>"+"<option value=\"proportionalSansSerif\">Proportional Sans-Serif</option>"+"<option value=\"casual\">Casual</option>"+"<option value=\"script\">Script</option>"+"<option value=\"small-caps\">Small Caps</option>"+"</select>"+"</div>"+"</div>"+"</div>"+"<div class=\"vjs-tracksettings-controls\">"+"<button class=\"vjs-default-button\">Defaults</button>"+"<button class=\"vjs-done-button\">Done</button>"+"</div>";
};
})();
_4.JSON;
if(typeof window.JSON!=="undefined"&&typeof window.JSON.parse==="function"){
_4.JSON=window.JSON;
}else{
_4.JSON={};
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
_4.JSON.parse=function(text,_285){
var j;
function walk(_286,key){
var k,v,_287=_286[key];
if(_287&&typeof _287==="object"){
for(k in _287){
if(Object.prototype.hasOwnProperty.call(_287,k)){
v=walk(_287,k);
if(v!==undefined){
_287[k]=v;
}else{
delete _287[k];
}
}
}
}
return _285.call(_286,key,_287);
};
text=String(text);
cx.lastIndex=0;
if(cx.test(text)){
text=text.replace(cx,function(a){
return "\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);
});
}
if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){
j=eval("("+text+")");
return typeof _285==="function"?walk({"":j},""):j;
}
throw new SyntaxError("JSON.parse(): invalid or malformed JSON data");
};
}
_4.autoSetup=function(){
var _288,_289,_28a,i,e;
var vids=document.getElementsByTagName("video");
var _28b=document.getElementsByTagName("audio");
var _28c=[];
if(vids&&vids.length>0){
for(i=0,e=vids.length;i<e;i++){
_28c.push(vids[i]);
}
}
if(_28b&&_28b.length>0){
for(i=0,e=_28b.length;i<e;i++){
_28c.push(_28b[i]);
}
}
if(_28c&&_28c.length>0){
for(i=0,e=_28c.length;i<e;i++){
_289=_28c[i];
if(_289&&_289.getAttribute){
if(_289["player"]===undefined){
_288=_289.getAttribute("data-setup");
if(_288!==null){
_28a=_8(_289);
}
}
}else{
_4.autoSetupTimeout(1);
break;
}
}
}else{
if(!_4.windowLoaded){
_4.autoSetupTimeout(1);
}
}
};
_4.autoSetupTimeout=function(wait){
setTimeout(_4.autoSetup,wait);
};
if(document.readyState==="complete"){
_4.windowLoaded=true;
}else{
_4.one(window,"load",function(){
_4.windowLoaded=true;
});
}
_4.autoSetupTimeout(1);
_4.plugin=function(name,init){
_4.Player.prototype[name]=init;
};
(function(root){
var _28d=root.vttjs={};
var _28e=_28d.VTTCue;
var _28f=_28d.VTTRegion;
var _290=root.VTTCue;
var _291=root.VTTRegion;
_28d.shim=function(){
_28d.VTTCue=_28e;
_28d.VTTRegion=_28f;
};
_28d.restore=function(){
_28d.VTTCue=_290;
_28d.VTTRegion=_291;
};
}(this));
(function(root,_292){
var _293="auto";
var _294={"":true,"lr":true,"rl":true};
var _295={"start":true,"middle":true,"end":true,"left":true,"right":true};
function _296(_297){
if(typeof _297!=="string"){
return false;
}
var dir=_294[_297.toLowerCase()];
return dir?_297.toLowerCase():false;
};
function _298(_299){
if(typeof _299!=="string"){
return false;
}
var _29a=_295[_299.toLowerCase()];
return _29a?_299.toLowerCase():false;
};
function _29b(obj){
var i=1;
for(;i<arguments.length;i++){
var cobj=arguments[i];
for(var p in cobj){
obj[p]=cobj[p];
}
}
return obj;
};
function _29c(_29d,_29e,text){
var cue=this;
var _29f=(/MSIE\s8\.0/).test(navigator.userAgent);
var _2a0={};
if(_29f){
cue=document.createElement("custom");
}else{
_2a0.enumerable=true;
}
cue.hasBeenReset=false;
var _2a1="";
var _2a2=false;
var _2a3=_29d;
var _2a4=_29e;
var _2a5=text;
var _2a6=null;
var _2a7="";
var _2a8=true;
var _2a9="auto";
var _2aa="start";
var _2ab=50;
var _2ac="middle";
var _2ad=50;
var _2ae="middle";
Object.defineProperty(cue,"id",_29b({},_2a0,{get:function(){
return _2a1;
},set:function(_2af){
_2a1=""+_2af;
}}));
Object.defineProperty(cue,"pauseOnExit",_29b({},_2a0,{get:function(){
return _2a2;
},set:function(_2b0){
_2a2=!!_2b0;
}}));
Object.defineProperty(cue,"startTime",_29b({},_2a0,{get:function(){
return _2a3;
},set:function(_2b1){
if(typeof _2b1!=="number"){
throw new TypeError("Start time must be set to a number.");
}
_2a3=_2b1;
this.hasBeenReset=true;
}}));
Object.defineProperty(cue,"endTime",_29b({},_2a0,{get:function(){
return _2a4;
},set:function(_2b2){
if(typeof _2b2!=="number"){
throw new TypeError("End time must be set to a number.");
}
_2a4=_2b2;
this.hasBeenReset=true;
}}));
Object.defineProperty(cue,"text",_29b({},_2a0,{get:function(){
return _2a5;
},set:function(_2b3){
_2a5=""+_2b3;
this.hasBeenReset=true;
}}));
Object.defineProperty(cue,"region",_29b({},_2a0,{get:function(){
return _2a6;
},set:function(_2b4){
_2a6=_2b4;
this.hasBeenReset=true;
}}));
Object.defineProperty(cue,"vertical",_29b({},_2a0,{get:function(){
return _2a7;
},set:function(_2b5){
var _2b6=_296(_2b5);
if(_2b6===false){
throw new SyntaxError("An invalid or illegal string was specified.");
}
_2a7=_2b6;
this.hasBeenReset=true;
}}));
Object.defineProperty(cue,"snapToLines",_29b({},_2a0,{get:function(){
return _2a8;
},set:function(_2b7){
_2a8=!!_2b7;
this.hasBeenReset=true;
}}));
Object.defineProperty(cue,"line",_29b({},_2a0,{get:function(){
return _2a9;
},set:function(_2b8){
if(typeof _2b8!=="number"&&_2b8!==_293){
throw new SyntaxError("An invalid number or illegal string was specified.");
}
_2a9=_2b8;
this.hasBeenReset=true;
}}));
Object.defineProperty(cue,"lineAlign",_29b({},_2a0,{get:function(){
return _2aa;
},set:function(_2b9){
var _2ba=_298(_2b9);
if(!_2ba){
throw new SyntaxError("An invalid or illegal string was specified.");
}
_2aa=_2ba;
this.hasBeenReset=true;
}}));
Object.defineProperty(cue,"position",_29b({},_2a0,{get:function(){
return _2ab;
},set:function(_2bb){
if(_2bb<0||_2bb>100){
throw new Error("Position must be between 0 and 100.");
}
_2ab=_2bb;
this.hasBeenReset=true;
}}));
Object.defineProperty(cue,"positionAlign",_29b({},_2a0,{get:function(){
return _2ac;
},set:function(_2bc){
var _2bd=_298(_2bc);
if(!_2bd){
throw new SyntaxError("An invalid or illegal string was specified.");
}
_2ac=_2bd;
this.hasBeenReset=true;
}}));
Object.defineProperty(cue,"size",_29b({},_2a0,{get:function(){
return _2ad;
},set:function(_2be){
if(_2be<0||_2be>100){
throw new Error("Size must be between 0 and 100.");
}
_2ad=_2be;
this.hasBeenReset=true;
}}));
Object.defineProperty(cue,"align",_29b({},_2a0,{get:function(){
return _2ae;
},set:function(_2bf){
var _2c0=_298(_2bf);
if(!_2c0){
throw new SyntaxError("An invalid or illegal string was specified.");
}
_2ae=_2c0;
this.hasBeenReset=true;
}}));
cue.displayState=undefined;
if(_29f){
return cue;
}
};
_29c.prototype.getCueAsHTML=function(){
return WebVTT.convertCueToDOMTree(window,this.text);
};
root.VTTCue=root.VTTCue||_29c;
_292.VTTCue=_29c;
}(this,(this.vttjs||{})));
(function(root,_2c1){
var _2c2={"":true,"up":true};
function _2c3(_2c4){
if(typeof _2c4!=="string"){
return false;
}
var _2c5=_2c2[_2c4.toLowerCase()];
return _2c5?_2c4.toLowerCase():false;
};
function _2c6(_2c7){
return typeof _2c7==="number"&&(_2c7>=0&&_2c7<=100);
};
function _2c8(){
var _2c9=100;
var _2ca=3;
var _2cb=0;
var _2cc=100;
var _2cd=0;
var _2ce=100;
var _2cf="";
Object.defineProperties(this,{"width":{enumerable:true,get:function(){
return _2c9;
},set:function(_2d0){
if(!_2c6(_2d0)){
throw new Error("Width must be between 0 and 100.");
}
_2c9=_2d0;
}},"lines":{enumerable:true,get:function(){
return _2ca;
},set:function(_2d1){
if(typeof _2d1!=="number"){
throw new TypeError("Lines must be set to a number.");
}
_2ca=_2d1;
}},"regionAnchorY":{enumerable:true,get:function(){
return _2cc;
},set:function(_2d2){
if(!_2c6(_2d2)){
throw new Error("RegionAnchorX must be between 0 and 100.");
}
_2cc=_2d2;
}},"regionAnchorX":{enumerable:true,get:function(){
return _2cb;
},set:function(_2d3){
if(!_2c6(_2d3)){
throw new Error("RegionAnchorY must be between 0 and 100.");
}
_2cb=_2d3;
}},"viewportAnchorY":{enumerable:true,get:function(){
return _2ce;
},set:function(_2d4){
if(!_2c6(_2d4)){
throw new Error("ViewportAnchorY must be between 0 and 100.");
}
_2ce=_2d4;
}},"viewportAnchorX":{enumerable:true,get:function(){
return _2cd;
},set:function(_2d5){
if(!_2c6(_2d5)){
throw new Error("ViewportAnchorX must be between 0 and 100.");
}
_2cd=_2d5;
}},"scroll":{enumerable:true,get:function(){
return _2cf;
},set:function(_2d6){
var _2d7=_2c3(_2d6);
if(_2d7===false){
throw new SyntaxError("An invalid or illegal string was specified.");
}
_2cf=_2d7;
}}});
};
root.VTTRegion=root.VTTRegion||_2c8;
_2c1.VTTRegion=_2c8;
}(this,(this.vttjs||{})));
(function(_2d8){
var _2d9=Object.create||(function(){
function F(){
};
return function(o){
if(arguments.length!==1){
throw new Error("Object.create shim only accepts one parameter.");
}
F.prototype=o;
return new F();
};
})();
function _2da(_2db,_2dc){
this.name="ParsingError";
this.code=_2db.code;
this.message=_2dc||_2db.message;
};
_2da.prototype=_2d9(Error.prototype);
_2da.prototype.constructor=_2da;
_2da.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};
function _2dd(_2de){
function _2df(h,m,s,f){
return (h|0)*3600+(m|0)*60+(s|0)+(f|0)/1000;
};
var m=_2de.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);
if(!m){
return null;
}
if(m[3]){
return _2df(m[1],m[2],m[3].replace(":",""),m[4]);
}else{
if(m[1]>59){
return _2df(m[1],m[2],0,m[4]);
}else{
return _2df(0,m[1],m[2],m[4]);
}
}
};
function _2e0(){
this.values=_2d9(null);
};
_2e0.prototype={set:function(k,v){
if(!this.get(k)&&v!==""){
this.values[k]=v;
}
},get:function(k,dflt,_2e1){
if(_2e1){
return this.has(k)?this.values[k]:dflt[_2e1];
}
return this.has(k)?this.values[k]:dflt;
},has:function(k){
return k in this.values;
},alt:function(k,v,a){
for(var n=0;n<a.length;++n){
if(v===a[n]){
this.set(k,v);
break;
}
}
},integer:function(k,v){
if(/^-?\d+$/.test(v)){
this.set(k,parseInt(v,10));
}
},percent:function(k,v){
var m;
if((m=v.match(/^([\d]{1,3})(\.[\d]*)?%$/))){
v=parseFloat(v);
if(v>=0&&v<=100){
this.set(k,v);
return true;
}
}
return false;
}};
function _2e2(_2e3,_2e4,_2e5,_2e6){
var _2e7=_2e6?_2e3.split(_2e6):[_2e3];
for(var i in _2e7){
if(typeof _2e7[i]!=="string"){
continue;
}
var kv=_2e7[i].split(_2e5);
if(kv.length!==2){
continue;
}
var k=kv[0];
var v=kv[1];
_2e4(k,v);
}
};
function _2e8(_2e9,cue,_2ea){
var _2eb=_2e9;
function _2ec(){
var ts=_2dd(_2e9);
if(ts===null){
throw new _2da(_2da.Errors.BadTimeStamp,"Malformed timestamp: "+_2eb);
}
_2e9=_2e9.replace(/^[^\sa-zA-Z-]+/,"");
return ts;
};
function _2ed(_2ee,cue){
var _2ef=new _2e0();
_2e2(_2ee,function(k,v){
switch(k){
case "region":
for(var i=_2ea.length-1;i>=0;i--){
if(_2ea[i].id===v){
_2ef.set(k,_2ea[i].region);
break;
}
}
break;
case "vertical":
_2ef.alt(k,v,["rl","lr"]);
break;
case "line":
var vals=v.split(","),_2f0=vals[0];
_2ef.integer(k,_2f0);
_2ef.percent(k,_2f0)?_2ef.set("snapToLines",false):null;
_2ef.alt(k,_2f0,["auto"]);
if(vals.length===2){
_2ef.alt("lineAlign",vals[1],["start","middle","end"]);
}
break;
case "position":
vals=v.split(",");
_2ef.percent(k,vals[0]);
if(vals.length===2){
_2ef.alt("positionAlign",vals[1],["start","middle","end"]);
}
break;
case "size":
_2ef.percent(k,v);
break;
case "align":
_2ef.alt(k,v,["start","middle","end","left","right"]);
break;
}
},/:/,/\s/);
cue.region=_2ef.get("region",null);
cue.vertical=_2ef.get("vertical","");
cue.line=_2ef.get("line","auto");
cue.lineAlign=_2ef.get("lineAlign","start");
cue.snapToLines=_2ef.get("snapToLines",true);
cue.size=_2ef.get("size",100);
cue.align=_2ef.get("align","middle");
cue.position=_2ef.get("position",{start:0,left:0,middle:50,end:100,right:100},cue.align);
cue.positionAlign=_2ef.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},cue.align);
};
function _2f1(){
_2e9=_2e9.replace(/^\s+/,"");
};
_2f1();
cue.startTime=_2ec();
_2f1();
if(_2e9.substr(0,3)!=="-->"){
throw new _2da(_2da.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+_2eb);
}
_2e9=_2e9.substr(3);
_2f1();
cue.endTime=_2ec();
_2f1();
_2ed(_2e9,cue);
};
var _2f2={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"\u200e","&rlm;":"\u200f","&nbsp;":"\xa0"};
var _2f3={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"};
var _2f4={v:"title",lang:"lang"};
var _2f5={rt:"ruby"};
function _2f6(_2f7,_2f8){
function _2f9(){
if(!_2f8){
return null;
}
function _2fa(_2fb){
_2f8=_2f8.substr(_2fb.length);
return _2fb;
};
var m=_2f8.match(/^([^<]*)(<[^>]+>?)?/);
return _2fa(m[1]?m[1]:m[2]);
};
function _2fc(e){
return _2f2[e];
};
function _2fd(s){
while((m=s.match(/&(amp|lt|gt|lrm|rlm|nbsp);/))){
s=s.replace(m[0],_2fc);
}
return s;
};
function _2fe(_2ff,_300){
return !_2f5[_300.localName]||_2f5[_300.localName]===_2ff.localName;
};
function _301(type,_302){
var _303=_2f3[type];
if(!_303){
return null;
}
var _304=_2f7.document.createElement(_303);
_304.localName=_303;
var name=_2f4[type];
if(name&&_302){
_304[name]=_302.trim();
}
return _304;
};
var _305=_2f7.document.createElement("div"),_306=_305,t,_307=[];
while((t=_2f9())!==null){
if(t[0]==="<"){
if(t[1]==="/"){
if(_307.length&&_307[_307.length-1]===t.substr(2).replace(">","")){
_307.pop();
_306=_306.parentNode;
}
continue;
}
var ts=_2dd(t.substr(1,t.length-2));
var node;
if(ts){
node=_2f7.document.createProcessingInstruction("timestamp",ts);
_306.appendChild(node);
continue;
}
var m=t.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);
if(!m){
continue;
}
node=_301(m[1],m[3]);
if(!node){
continue;
}
if(!_2fe(_306,node)){
continue;
}
if(m[2]){
node.className=m[2].substr(1).replace("."," ");
}
_307.push(m[1]);
_306.appendChild(node);
_306=node;
continue;
}
_306.appendChild(_2f7.document.createTextNode(_2fd(t)));
}
return _305;
};
var _308=[1470,1472,1475,1478,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1520,1521,1522,1523,1524,1544,1547,1549,1563,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1645,1646,1647,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1765,1766,1774,1775,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1807,1808,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1969,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2036,2037,2042,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2074,2084,2088,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2112,2113,2114,2115,2116,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2142,2208,2210,2211,2212,2213,2214,2215,2216,2217,2218,2219,2220,8207,64285,64287,64288,64289,64290,64291,64292,64293,64294,64295,64296,64298,64299,64300,64301,64302,64303,64304,64305,64306,64307,64308,64309,64310,64312,64313,64314,64315,64316,64318,64320,64321,64323,64324,64326,64327,64328,64329,64330,64331,64332,64333,64334,64335,64336,64337,64338,64339,64340,64341,64342,64343,64344,64345,64346,64347,64348,64349,64350,64351,64352,64353,64354,64355,64356,64357,64358,64359,64360,64361,64362,64363,64364,64365,64366,64367,64368,64369,64370,64371,64372,64373,64374,64375,64376,64377,64378,64379,64380,64381,64382,64383,64384,64385,64386,64387,64388,64389,64390,64391,64392,64393,64394,64395,64396,64397,64398,64399,64400,64401,64402,64403,64404,64405,64406,64407,64408,64409,64410,64411,64412,64413,64414,64415,64416,64417,64418,64419,64420,64421,64422,64423,64424,64425,64426,64427,64428,64429,64430,64431,64432,64433,64434,64435,64436,64437,64438,64439,64440,64441,64442,64443,64444,64445,64446,64447,64448,64449,64467,64468,64469,64470,64471,64472,64473,64474,64475,64476,64477,64478,64479,64480,64481,64482,64483,64484,64485,64486,64487,64488,64489,64490,64491,64492,64493,64494,64495,64496,64497,64498,64499,64500,64501,64502,64503,64504,64505,64506,64507,64508,64509,64510,64511,64512,64513,64514,64515,64516,64517,64518,64519,64520,64521,64522,64523,64524,64525,64526,64527,64528,64529,64530,64531,64532,64533,64534,64535,64536,64537,64538,64539,64540,64541,64542,64543,64544,64545,64546,64547,64548,64549,64550,64551,64552,64553,64554,64555,64556,64557,64558,64559,64560,64561,64562,64563,64564,64565,64566,64567,64568,64569,64570,64571,64572,64573,64574,64575,64576,64577,64578,64579,64580,64581,64582,64583,64584,64585,64586,64587,64588,64589,64590,64591,64592,64593,64594,64595,64596,64597,64598,64599,64600,64601,64602,64603,64604,64605,64606,64607,64608,64609,64610,64611,64612,64613,64614,64615,64616,64617,64618,64619,64620,64621,64622,64623,64624,64625,64626,64627,64628,64629,64630,64631,64632,64633,64634,64635,64636,64637,64638,64639,64640,64641,64642,64643,64644,64645,64646,64647,64648,64649,64650,64651,64652,64653,64654,64655,64656,64657,64658,64659,64660,64661,64662,64663,64664,64665,64666,64667,64668,64669,64670,64671,64672,64673,64674,64675,64676,64677,64678,64679,64680,64681,64682,64683,64684,64685,64686,64687,64688,64689,64690,64691,64692,64693,64694,64695,64696,64697,64698,64699,64700,64701,64702,64703,64704,64705,64706,64707,64708,64709,64710,64711,64712,64713,64714,64715,64716,64717,64718,64719,64720,64721,64722,64723,64724,64725,64726,64727,64728,64729,64730,64731,64732,64733,64734,64735,64736,64737,64738,64739,64740,64741,64742,64743,64744,64745,64746,64747,64748,64749,64750,64751,64752,64753,64754,64755,64756,64757,64758,64759,64760,64761,64762,64763,64764,64765,64766,64767,64768,64769,64770,64771,64772,64773,64774,64775,64776,64777,64778,64779,64780,64781,64782,64783,64784,64785,64786,64787,64788,64789,64790,64791,64792,64793,64794,64795,64796,64797,64798,64799,64800,64801,64802,64803,64804,64805,64806,64807,64808,64809,64810,64811,64812,64813,64814,64815,64816,64817,64818,64819,64820,64821,64822,64823,64824,64825,64826,64827,64828,64829,64848,64849,64850,64851,64852,64853,64854,64855,64856,64857,64858,64859,64860,64861,64862,64863,64864,64865,64866,64867,64868,64869,64870,64871,64872,64873,64874,64875,64876,64877,64878,64879,64880,64881,64882,64883,64884,64885,64886,64887,64888,64889,64890,64891,64892,64893,64894,64895,64896,64897,64898,64899,64900,64901,64902,64903,64904,64905,64906,64907,64908,64909,64910,64911,64914,64915,64916,64917,64918,64919,64920,64921,64922,64923,64924,64925,64926,64927,64928,64929,64930,64931,64932,64933,64934,64935,64936,64937,64938,64939,64940,64941,64942,64943,64944,64945,64946,64947,64948,64949,64950,64951,64952,64953,64954,64955,64956,64957,64958,64959,64960,64961,64962,64963,64964,64965,64966,64967,65008,65009,65010,65011,65012,65013,65014,65015,65016,65017,65018,65019,65020,65136,65137,65138,65139,65140,65142,65143,65144,65145,65146,65147,65148,65149,65150,65151,65152,65153,65154,65155,65156,65157,65158,65159,65160,65161,65162,65163,65164,65165,65166,65167,65168,65169,65170,65171,65172,65173,65174,65175,65176,65177,65178,65179,65180,65181,65182,65183,65184,65185,65186,65187,65188,65189,65190,65191,65192,65193,65194,65195,65196,65197,65198,65199,65200,65201,65202,65203,65204,65205,65206,65207,65208,65209,65210,65211,65212,65213,65214,65215,65216,65217,65218,65219,65220,65221,65222,65223,65224,65225,65226,65227,65228,65229,65230,65231,65232,65233,65234,65235,65236,65237,65238,65239,65240,65241,65242,65243,65244,65245,65246,65247,65248,65249,65250,65251,65252,65253,65254,65255,65256,65257,65258,65259,65260,65261,65262,65263,65264,65265,65266,65267,65268,65269,65270,65271,65272,65273,65274,65275,65276,67584,67585,67586,67587,67588,67589,67592,67594,67595,67596,67597,67598,67599,67600,67601,67602,67603,67604,67605,67606,67607,67608,67609,67610,67611,67612,67613,67614,67615,67616,67617,67618,67619,67620,67621,67622,67623,67624,67625,67626,67627,67628,67629,67630,67631,67632,67633,67634,67635,67636,67637,67639,67640,67644,67647,67648,67649,67650,67651,67652,67653,67654,67655,67656,67657,67658,67659,67660,67661,67662,67663,67664,67665,67666,67667,67668,67669,67671,67672,67673,67674,67675,67676,67677,67678,67679,67840,67841,67842,67843,67844,67845,67846,67847,67848,67849,67850,67851,67852,67853,67854,67855,67856,67857,67858,67859,67860,67861,67862,67863,67864,67865,67866,67867,67872,67873,67874,67875,67876,67877,67878,67879,67880,67881,67882,67883,67884,67885,67886,67887,67888,67889,67890,67891,67892,67893,67894,67895,67896,67897,67903,67968,67969,67970,67971,67972,67973,67974,67975,67976,67977,67978,67979,67980,67981,67982,67983,67984,67985,67986,67987,67988,67989,67990,67991,67992,67993,67994,67995,67996,67997,67998,67999,68000,68001,68002,68003,68004,68005,68006,68007,68008,68009,68010,68011,68012,68013,68014,68015,68016,68017,68018,68019,68020,68021,68022,68023,68030,68031,68096,68112,68113,68114,68115,68117,68118,68119,68121,68122,68123,68124,68125,68126,68127,68128,68129,68130,68131,68132,68133,68134,68135,68136,68137,68138,68139,68140,68141,68142,68143,68144,68145,68146,68147,68160,68161,68162,68163,68164,68165,68166,68167,68176,68177,68178,68179,68180,68181,68182,68183,68184,68192,68193,68194,68195,68196,68197,68198,68199,68200,68201,68202,68203,68204,68205,68206,68207,68208,68209,68210,68211,68212,68213,68214,68215,68216,68217,68218,68219,68220,68221,68222,68223,68352,68353,68354,68355,68356,68357,68358,68359,68360,68361,68362,68363,68364,68365,68366,68367,68368,68369,68370,68371,68372,68373,68374,68375,68376,68377,68378,68379,68380,68381,68382,68383,68384,68385,68386,68387,68388,68389,68390,68391,68392,68393,68394,68395,68396,68397,68398,68399,68400,68401,68402,68403,68404,68405,68416,68417,68418,68419,68420,68421,68422,68423,68424,68425,68426,68427,68428,68429,68430,68431,68432,68433,68434,68435,68436,68437,68440,68441,68442,68443,68444,68445,68446,68447,68448,68449,68450,68451,68452,68453,68454,68455,68456,68457,68458,68459,68460,68461,68462,68463,68464,68465,68466,68472,68473,68474,68475,68476,68477,68478,68479,68608,68609,68610,68611,68612,68613,68614,68615,68616,68617,68618,68619,68620,68621,68622,68623,68624,68625,68626,68627,68628,68629,68630,68631,68632,68633,68634,68635,68636,68637,68638,68639,68640,68641,68642,68643,68644,68645,68646,68647,68648,68649,68650,68651,68652,68653,68654,68655,68656,68657,68658,68659,68660,68661,68662,68663,68664,68665,68666,68667,68668,68669,68670,68671,68672,68673,68674,68675,68676,68677,68678,68679,68680,126464,126465,126466,126467,126469,126470,126471,126472,126473,126474,126475,126476,126477,126478,126479,126480,126481,126482,126483,126484,126485,126486,126487,126488,126489,126490,126491,126492,126493,126494,126495,126497,126498,126500,126503,126505,126506,126507,126508,126509,126510,126511,126512,126513,126514,126516,126517,126518,126519,126521,126523,126530,126535,126537,126539,126541,126542,126543,126545,126546,126548,126551,126553,126555,126557,126559,126561,126562,126564,126567,126568,126569,126570,126572,126573,126574,126575,126576,126577,126578,126580,126581,126582,126583,126585,126586,126587,126588,126590,126592,126593,126594,126595,126596,126597,126598,126599,126600,126601,126603,126604,126605,126606,126607,126608,126609,126610,126611,126612,126613,126614,126615,126616,126617,126618,126619,126625,126626,126627,126629,126630,126631,126632,126633,126635,126636,126637,126638,126639,126640,126641,126642,126643,126644,126645,126646,126647,126648,126649,126650,126651,1114109];
function _309(_30a){
var _30b=[],text="",_30c;
if(!_30a||!_30a.childNodes){
return "ltr";
}
function _30d(_30e,node){
for(var i=node.childNodes.length-1;i>=0;i--){
_30e.push(node.childNodes[i]);
}
};
function _30f(_310){
if(!_310||!_310.length){
return null;
}
var node=_310.pop(),text=node.textContent||node.innerText;
if(text){
var m=text.match(/^.*(\n|\r)/);
if(m){
_310.length=0;
return m[0];
}
return text;
}
if(node.tagName==="ruby"){
return _30f(_310);
}
if(node.childNodes){
_30d(_310,node);
return _30f(_310);
}
};
_30d(_30b,_30a);
while((text=_30f(_30b))){
for(var i=0;i<text.length;i++){
_30c=text.charCodeAt(i);
for(var j=0;j<_308.length;j++){
if(_308[j]===_30c){
return "rtl";
}
}
}
}
return "ltr";
};
function _311(cue){
if(typeof cue.line==="number"&&(cue.snapToLines||(cue.line>=0&&cue.line<=100))){
return cue.line;
}
if(!cue.track||!cue.track.textTrackList||!cue.track.textTrackList.mediaElement){
return -1;
}
var _312=cue.track,_313=_312.textTrackList,_314=0;
for(var i=0;i<_313.length&&_313[i]!==_312;i++){
if(_313[i].mode==="showing"){
_314++;
}
}
return ++_314*-1;
};
function _315(){
};
_315.prototype.applyStyles=function(_316,div){
div=div||this.div;
for(var prop in _316){
if(_316.hasOwnProperty(prop)){
div.style[prop]=_316[prop];
}
}
};
_315.prototype.formatStyle=function(val,unit){
return val===0?0:val+unit;
};
function _317(_318,cue,_319){
var _31a=(/MSIE\s8\.0/).test(navigator.userAgent);
var _31b="rgba(255, 255, 255, 1)";
var _31c="rgba(0, 0, 0, 0.8)";
if(_31a){
_31b="rgb(255, 255, 255)";
_31c="rgb(0, 0, 0)";
}
_315.call(this);
this.cue=cue;
this.cueDiv=_2f6(_318,cue.text);
var _31d={color:_31b,backgroundColor:_31c,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};
if(!_31a){
_31d.writingMode=cue.vertical===""?"horizontal-tb":cue.vertical==="lr"?"vertical-lr":"vertical-rl";
_31d.unicodeBidi="plaintext";
}
this.applyStyles(_31d,this.cueDiv);
this.div=_318.document.createElement("div");
_31d={textAlign:cue.align==="middle"?"center":cue.align,font:_319.font,whiteSpace:"pre-line",position:"absolute"};
if(!_31a){
_31d.direction=_309(this.cueDiv);
_31d.writingMode=cue.vertical===""?"horizontal-tb":cue.vertical==="lr"?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext";
}
this.applyStyles(_31d);
this.div.appendChild(this.cueDiv);
var _31e=0;
switch(cue.positionAlign){
case "start":
_31e=cue.position;
break;
case "middle":
_31e=cue.position-(cue.size/2);
break;
case "end":
_31e=cue.position-cue.size;
break;
}
if(cue.vertical===""){
this.applyStyles({left:this.formatStyle(_31e,"%"),width:this.formatStyle(cue.size,"%")});
}else{
this.applyStyles({top:this.formatStyle(_31e,"%"),height:this.formatStyle(cue.size,"%")});
}
this.move=function(box){
this.applyStyles({top:this.formatStyle(box.top,"px"),bottom:this.formatStyle(box.bottom,"px"),left:this.formatStyle(box.left,"px"),right:this.formatStyle(box.right,"px"),height:this.formatStyle(box.height,"px"),width:this.formatStyle(box.width,"px")});
};
};
_317.prototype=_2d9(_315.prototype);
_317.prototype.constructor=_317;
function _31f(obj){
var _320=(/MSIE\s8\.0/).test(navigator.userAgent);
var lh,_321,_322,top;
if(obj.div){
_321=obj.div.offsetHeight;
_322=obj.div.offsetWidth;
top=obj.div.offsetTop;
var _323=(_323=obj.div.childNodes)&&(_323=_323[0])&&_323.getClientRects&&_323.getClientRects();
obj=obj.div.getBoundingClientRect();
lh=_323?Math.max((_323[0]&&_323[0].height)||0,obj.height/_323.length):0;
}
this.left=obj.left;
this.right=obj.right;
this.top=obj.top||top;
this.height=obj.height||_321;
this.bottom=obj.bottom||(top+(obj.height||_321));
this.width=obj.width||_322;
this.lineHeight=lh!==undefined?lh:obj.lineHeight;
if(_320&&!this.lineHeight){
this.lineHeight=13;
}
};
_31f.prototype.move=function(axis,_324){
_324=_324!==undefined?_324:this.lineHeight;
switch(axis){
case "+x":
this.left+=_324;
this.right+=_324;
break;
case "-x":
this.left-=_324;
this.right-=_324;
break;
case "+y":
this.top+=_324;
this.bottom+=_324;
break;
case "-y":
this.top-=_324;
this.bottom-=_324;
break;
}
};
_31f.prototype.overlaps=function(b2){
return this.left<b2.right&&this.right>b2.left&&this.top<b2.bottom&&this.bottom>b2.top;
};
_31f.prototype.overlapsAny=function(_325){
for(var i=0;i<_325.length;i++){
if(this.overlaps(_325[i])){
return true;
}
}
return false;
};
_31f.prototype.within=function(_326){
return this.top>=_326.top&&this.bottom<=_326.bottom&&this.left>=_326.left&&this.right<=_326.right;
};
_31f.prototype.overlapsOppositeAxis=function(_327,axis){
switch(axis){
case "+x":
return this.left<_327.left;
case "-x":
return this.right>_327.right;
case "+y":
return this.top<_327.top;
case "-y":
return this.bottom>_327.bottom;
}
};
_31f.prototype.intersectPercentage=function(b2){
var x=Math.max(0,Math.min(this.right,b2.right)-Math.max(this.left,b2.left)),y=Math.max(0,Math.min(this.bottom,b2.bottom)-Math.max(this.top,b2.top)),_328=x*y;
return _328/(this.height*this.width);
};
_31f.prototype.toCSSCompatValues=function(_329){
return {top:this.top-_329.top,bottom:_329.bottom-this.bottom,left:this.left-_329.left,right:_329.right-this.right,height:this.height,width:this.width};
};
_31f.getSimpleBoxPosition=function(obj){
var _32a=obj.div?obj.div.offsetHeight:obj.tagName?obj.offsetHeight:0;
var _32b=obj.div?obj.div.offsetWidth:obj.tagName?obj.offsetWidth:0;
var top=obj.div?obj.div.offsetTop:obj.tagName?obj.offsetTop:0;
obj=obj.div?obj.div.getBoundingClientRect():obj.tagName?obj.getBoundingClientRect():obj;
var ret={left:obj.left,right:obj.right,top:obj.top||top,height:obj.height||_32a,bottom:obj.bottom||(top+(obj.height||_32a)),width:obj.width||_32b};
return ret;
};
function _32c(_32d,_32e,_32f,_330){
function _331(b,axis){
var _332,_333=new _31f(b),_334=1;
for(var i=0;i<axis.length;i++){
while(b.overlapsOppositeAxis(_32f,axis[i])||(b.within(_32f)&&b.overlapsAny(_330))){
b.move(axis[i]);
}
if(b.within(_32f)){
return b;
}
var p=b.intersectPercentage(_32f);
if(_334>p){
_332=new _31f(b);
_334=p;
}
b=new _31f(_333);
}
return _332||_333;
};
var _335=new _31f(_32e),cue=_32e.cue,_336=_311(cue),axis=[];
if(cue.snapToLines){
var size;
switch(cue.vertical){
case "":
axis=["+y","-y"];
size="height";
break;
case "rl":
axis=["+x","-x"];
size="width";
break;
case "lr":
axis=["-x","+x"];
size="width";
break;
}
var step=_335.lineHeight,_337=step*Math.round(_336),_338=_32f[size]+step,_339=axis[0];
if(Math.abs(_337)>_338){
_337=_337<0?-1:1;
_337*=Math.ceil(_338/step)*step;
}
if(_336<0){
_337+=cue.vertical===""?_32f.height:_32f.width;
axis=axis.reverse();
}
_335.move(_339,_337);
}else{
var _33a=(_335.lineHeight/_32f.height)*100;
switch(cue.lineAlign){
case "middle":
_336-=(_33a/2);
break;
case "end":
_336-=_33a;
break;
}
switch(cue.vertical){
case "":
_32e.applyStyles({top:_32e.formatStyle(_336,"%")});
break;
case "rl":
_32e.applyStyles({left:_32e.formatStyle(_336,"%")});
break;
case "lr":
_32e.applyStyles({right:_32e.formatStyle(_336,"%")});
break;
}
axis=["+y","-x","+x","-y"];
_335=new _31f(_32e);
}
var _33b=_331(_335,axis);
_32e.move(_33b.toCSSCompatValues(_32f));
};
function _33c(){
};
_33c.StringDecoder=function(){
return {decode:function(data){
if(!data){
return "";
}
if(typeof data!=="string"){
throw new Error("Error - expected string data.");
}
return decodeURIComponent(encodeURIComponent(data));
}};
};
_33c.convertCueToDOMTree=function(_33d,_33e){
if(!_33d||!_33e){
return null;
}
return _2f6(_33d,_33e);
};
var _33f=0.05;
var _340="sans-serif";
var _341="1.5%";
_33c.processCues=function(_342,cues,_343){
if(!_342||!cues||!_343){
return null;
}
while(_343.firstChild){
_343.removeChild(_343.firstChild);
}
var _344=_342.document.createElement("div");
_344.style.position="absolute";
_344.style.left="0";
_344.style.right="0";
_344.style.top="0";
_344.style.bottom="0";
_344.style.margin=_341;
_343.appendChild(_344);
function _345(cues){
for(var i=0;i<cues.length;i++){
if(cues[i].hasBeenReset||!cues[i].displayState){
return true;
}
}
return false;
};
if(!_345(cues)){
for(var i=0;i<cues.length;i++){
_344.appendChild(cues[i].displayState);
}
return;
}
var _346=[],_347=_31f.getSimpleBoxPosition(_344),_348=Math.round(_347.height*_33f*100)/100;
var _349={font:_348+"px "+_340};
(function(){
var _34a,cue;
for(var i=0;i<cues.length;i++){
cue=cues[i];
_34a=new _317(_342,cue,_349);
_344.appendChild(_34a.div);
_32c(_342,_34a,_347,_346);
cue.displayState=_34a.div;
_346.push(_31f.getSimpleBoxPosition(_34a));
}
})();
};
_33c.Parser=function(_34b,_34c,_34d){
if(!_34d){
_34d=_34c;
_34c={};
}
if(!_34c){
_34c={};
}
this.window=_34b;
this.vttjs=_34c;
this.state="INITIAL";
this.buffer="";
this.decoder=_34d||new TextDecoder("utf8");
this.regionList=[];
};
_33c.Parser.prototype={reportOrThrowError:function(e){
if(e instanceof _2da){
this.onparsingerror&&this.onparsingerror(e);
}else{
throw e;
}
},parse:function(data){
var self=this;
if(data){
self.buffer+=self.decoder.decode(data,{stream:true});
}
function _34e(){
var _34f=self.buffer;
var pos=0;
while(pos<_34f.length&&_34f[pos]!=="\r"&&_34f[pos]!=="\n"){
++pos;
}
var line=_34f.substr(0,pos);
if(_34f[pos]==="\r"){
++pos;
}
if(_34f[pos]==="\n"){
++pos;
}
self.buffer=_34f.substr(pos);
return line;
};
function _350(_351){
var _352=new _2e0();
_2e2(_351,function(k,v){
switch(k){
case "id":
_352.set(k,v);
break;
case "width":
_352.percent(k,v);
break;
case "lines":
_352.integer(k,v);
break;
case "regionanchor":
case "viewportanchor":
var xy=v.split(",");
if(xy.length!==2){
break;
}
var _353=new _2e0();
_353.percent("x",xy[0]);
_353.percent("y",xy[1]);
if(!_353.has("x")||!_353.has("y")){
break;
}
_352.set(k+"X",_353.get("x"));
_352.set(k+"Y",_353.get("y"));
break;
case "scroll":
_352.alt(k,v,["up"]);
break;
}
},/=/,/\s/);
if(_352.has("id")){
var _354=new (self.vttjs.VTTRegion||self.window.VTTRegion)();
_354.width=_352.get("width",100);
_354.lines=_352.get("lines",3);
_354.regionAnchorX=_352.get("regionanchorX",0);
_354.regionAnchorY=_352.get("regionanchorY",100);
_354.viewportAnchorX=_352.get("viewportanchorX",0);
_354.viewportAnchorY=_352.get("viewportanchorY",100);
_354.scroll=_352.get("scroll","");
self.onregion&&self.onregion(_354);
self.regionList.push({id:_352.get("id"),region:_354});
}
};
function _355(_356){
_2e2(_356,function(k,v){
switch(k){
case "Region":
_350(v);
break;
}
},/:/);
};
try{
var line;
if(self.state==="INITIAL"){
if(!/\r\n|\n/.test(self.buffer)){
return this;
}
line=_34e();
var m=line.match(/^WEBVTT([ \t].*)?$/);
if(!m||!m[0]){
throw new _2da(_2da.Errors.BadSignature);
}
self.state="HEADER";
}
var _357=false;
while(self.buffer){
if(!/\r\n|\n/.test(self.buffer)){
return this;
}
if(!_357){
line=_34e();
}else{
_357=false;
}
switch(self.state){
case "HEADER":
if(/:/.test(line)){
_355(line);
}else{
if(!line){
self.state="ID";
}
}
continue;
case "NOTE":
if(!line){
self.state="ID";
}
continue;
case "ID":
if(/^NOTE($|[ \t])/.test(line)){
self.state="NOTE";
break;
}
if(!line){
continue;
}
self.cue=new (self.vttjs.VTTCue||self.window.VTTCue)(0,0,"");
self.state="CUE";
if(line.indexOf("-->")===-1){
self.cue.id=line;
continue;
}
case "CUE":
try{
_2e8(line,self.cue,self.regionList);
}
catch(e){
self.reportOrThrowError(e);
self.cue=null;
self.state="BADCUE";
continue;
}
self.state="CUETEXT";
continue;
case "CUETEXT":
var _358=line.indexOf("-->")!==-1;
if(!line||_358&&(_357=true)){
self.oncue&&self.oncue(self.cue);
self.cue=null;
self.state="ID";
continue;
}
if(self.cue.text){
self.cue.text+="\n";
}
self.cue.text+=line;
continue;
case "BADCUE":
if(!line){
self.state="ID";
}
continue;
}
}
}
catch(e){
self.reportOrThrowError(e);
if(self.state==="CUETEXT"&&self.cue&&self.oncue){
self.oncue(self.cue);
}
self.cue=null;
self.state=self.state==="INITIAL"?"BADWEBVTT":"BADCUE";
}
return this;
},flush:function(){
var self=this;
try{
self.buffer+=self.decoder.decode();
if(self.cue||self.state==="HEADER"){
self.buffer+="\n\n";
self.parse();
}
if(self.state==="INITIAL"){
throw new _2da(_2da.Errors.BadSignature);
}
}
catch(e){
self.reportOrThrowError(e);
}
self.onflush&&self.onflush();
return this;
}};
_2d8.WebVTT=_33c;
}(this,(this.vttjs||{})));
return _1([_2,_3],{});
});


;define("dojo/i18n!ic-share/fileviewer/video/video-js/lang/VideoJSStrings", {"Playback Rate":"Playback Rate","Progress":"Progress","Unmuted":"Unmuted","Unmute":"Unmute","Current Time":"Current Time","Play":"Play","Pause":"Pause","Duration Time":"Duration Time","Stream Type":"Stream Type","Fullscreen":"Fullscreen","captions off":"captions off","The video could not be loaded, either because the server or network failed or because the format is not supported.":"The video could not be loaded, either because the server or network failed or because the format is not supported.","Loaded":"Loaded","Chapters":"Chapters","subtitles off":"subtitles off","LIVE":"LIVE","You aborted the video playback.":"You aborted the video playback","Captions":"Captions","The video playback was aborted due to a corruption problem or because the video used features your browser did not support.":"The video playback was aborted due to a corruption problem or because the video used features your browser did not support.","No compatible source was found for this video.":"No compatible source was found for this video.","A network error caused the video download to fail part-way.":"A network error caused the video download to fail part-way.","Remaining Time":"Remaining Time","Language":"en","Mute":"Mute","Volume":"Volume","Subtitles":"Subtitles","Non-Fullscreen":"Non-Fullscreen"});

;define("dojo/i18n!ic-share/fileviewer/nls/FileViewerStrings", {"STREAM":{"LOADING":"Loading...","LOAD_MORE":"Load more..."},"CONFIRMATION_DIALOG":{"DIALOG_TITLE":"Confirm","TOOLTIP":"Perform action","PROMPT":"Are you sure you want to perform this action?","A11Y":"This button performs the current action.","ERROR":"An error occurred performing the action. Try again later.","CANCEL":"Cancel","NAME":"Action Confirmation","OK":"OK"},"TYPEAHEAD_BOX":{"COMMUNITY_FULL_SEARCH":"Community not listed? Use full search...","ADD_OPTIONAL_MESSAGE":"Add Optional Message","SHARE_ALT":"Share with this person","COMMUNITY":"Community","PERSON_SHADOW":"Type to find person","ROLE_LABEL":"Role","USER":"Person","ROLE_VIEW":"Reader","PERSON_FULL_SEARCH":"Person not listed? Use full search...","ROLE_EDIT":"Editor","PERSON_ARIA":"Type to find person.  Press shift tab to change between people, communities, and everyone in the organization.","COMMUNITY_SHADOW":"Type to find community","CANCEL":"Cancel","SAVE":"Save","COMMUNITY_ARIA":"Type to find community.  Press shift tab to change between people, communities, and everyone in the organization.","MEMBER_TYPE":"Member Type","SHARE":"Share"},"NAVIGATION":{"NEXT_A11Y":"This button navigates to the next file.","PREVIOUS_A11Y":"This button navigates to the previous file."},"LOST_AUTHENTICATION_DIALOG":{"DIALOG_TITLE":"Confirm","CANCEL":"Cancel","PROMPT":"Your IBM Connections session has timed out.${lineBreaks}Click OK to log back in or Cancel to close this dialog.","OK":"OK"},"EXPANDABLE_TEXT":{"READ_MORE":"Read More...","READ_LESS":"Read Less..."},"SPLIT_ACTION":{"BUTTON":{"CREATE":{"TITLE":"Create"},"UPLOAD":{"TITLE":"Upload"},"EDIT":{"TITLE":"Edit"}},"MENU":{"TITLE":"More editing options","A11Y":"This button opens a menu for more editing options."}},"ICON_TOOLTIP":"Download file","FILE_SYNCED":"Added to sync","DOCS_STATUS_MESSAGE":{"AUTOPUBLISH":{"IN_PROGRESS":"Your edits are being published. ${startLink}Refresh to see your changes.${endLink}","GENERIC":"You might need to refresh the page to see the latest changes.  ${startLink}Refresh${endLink}"},"CURRENT_EDITORS":"This file is currently being edited on the web by ${users}.","PUBLISH_SUCCESS":"You have successfully published a version of this file","PUBLISH_ERROR":{"TOO_LARGE":"The version could not be published because the document is too large.","DEFAULT":"The version could not be published because the Docs service is not available. Try again later.","CANNOT_REACH_REPOSITORY":"The version could not be published because the Docs server is unable to connect to the file repository.","SERVER_BUSY":"The version could not be published because the Docs server is busy. Try again later.","NOT_FOUND":"The version could not be published because the document was not found.","ACCESS_DENIED":"The version could not be published because access was denied.","CONVERSION_UNAVAILABLE":"The version could not be published because the Docs conversion service is not available. Try again later.","CONVERSION_TIMEOUT":"The version could not be published because the Docs conversion service is taking too long to convert the document. Try again later.","QUOTA_VIOLATION":"The version could not be published because of space restrictions. Remove other files to free enough space to publish this version."},"UNPUBLISHED_CHANGES":"There are edits to this draft that have not been published as a version.","NO_ENTITLEMENT_LINK":"This file can be edited online by people who have ${startLink}IBM Docs${endLink}.","PUBLISH_A_VERSION":"Publish a version","NO_ENTITLEMENT":"This file can be edited online by people who have IBM Docs."},"PREVIEW":{"ICON":{"PREVIEW_NOT_AVAILABLE":"No preview available for this file."},"VIEWER":{"NO_PUBLISHED_VERSION":"A published version of this file is not available for viewing.","AUTOPUBLISH_TIMEOUT":"The server is taking too long to respond.  The latest changes may not have been published.","PUBLISHING":"Publishing...","LOADING":"Loading...","IFRAME_TITLE":"Preview of this file"},"IMAGE":{"ZOOM_IN":"Zoom in","ZOOM_OUT":"Zoom out","RESET_ZOOM_A11Y":"This button resets the zoom level.","ZOOM_OUT_A11Y":"This button zooms out on the image.","ZOOM_IN_A11Y":"This button zooms in on the image.","RESET":"Reset","UNSAFE_PREVIEW":"This file cannot be previewed because it has not been scanned for viruses."},"VIDEO":{"UNSAFE_PREVIEW":"This file cannot be previewed because it has not been scanned for viruses."}},"TAG_WIDGET":{"ERROR":{"SAVE":{"DEFAULT":"The tag could not be created. Try again later."},"DELETE":{"DEFAULT":"The tag could not be deleted. Try again later."}},"ADD_TOOLTIP":"Save","EDIT_TAGS":"Edit tags"},"WINDOW_TITLE":{"FILE":"${fileName} - File","LOAD_ERROR":"Error accessing file"},"FILENAME_TOOLTIP":"Edit file name","COMMENT_BOX":{"POST":"Post","EXTERNAL_WARNING":"Comments might be seen by people external to your organization.","TITLE":"Comment text area","ERROR":"An error occurred validating the user you are attempting to mention.","CANNOT_ACCESS_CONTENT":"The following people that you mentioned cannot view the comment because they do not have access to the content:","CANCEL":"Cancel","SHADOW_TEXT":"Add a comment...","SAVE":"Save"},"FILE_VIEWER_TITLE":"File preview","DATE":{"CREATED":{"MONTH":"Created by ${user} on ${date_long}","TODAY":"Created by ${user} today at ${time}","YESTERDAY":"Created by ${user} yesterday at ${time}","DAY":"Created by ${user} on ${EEee} at ${time}","YEAR":"Created by ${user} on ${date_long}"},"LAST_UPDATED":{"MONTH":"Last updated by ${user} on ${date_long}","TODAY":"Last updated by ${user} today at ${time}","YESTERDAY":"Last updated by ${user} yesterday at ${time}","DAY":"Last updated by ${user} on ${EEee} at ${time}","YEAR":"Last updated by ${user} on ${date_long}"},"VERY_SHORT":{"MONTH":"${date_long}","TODAY":"Today","YESTERDAY":"Yesterday","DAY":"${EEee}","YEAR":"${date_long}"},"SHORT":{"MONTH":"${time} - ${date_long}","TODAY":"${time} - Today","YESTERDAY":"${time} - Yesterday","DAY":"${time} - ${EEee}","YEAR":"${time} - ${date_long}"},"LONG":{"MONTH":"${date_long}, ${time_long}","TODAY":"${EEEE}, ${date_long}, ${time_long}","YESTERDAY":"${EEEE}, ${date_long}, ${time_long}","DAY":"${EEEE}, ${date_long}, ${time_long}","YEAR":"${date_long}, ${time_long}"}},"SHARED_EXTERNALLY":"Shared externally","ACTION":{"DOWNLOAD_VERSION":{"TOOLTIP":"Download this version"},"UNLOCK":{"ERROR":"The file could not be unlocked because it has been deleted or is no longer shared with you.","A11Y":"Unlock this File","TITLE":"Unlock this File","SUCCESS":"The file is now unlocked.","NAME":"Unlock File"},"COPY_FILE":{"DIALOG_TITLE":"Confirm","TOOLTIP":"Give a copy of this file to a community","SUCCESS_MSG":"${file} has been copied to ${community}.","ERROR":"An error occurred copying the file. Try again later.","A11Y":"This button opens a dialog which lets you give a copy of this file to a community.","CANCEL":"Cancel","NAME":"Give Copy to Community","OK":"OK"},"DOWNLOAD":{"A11Y":"This button downloads the file.","TOOLTIP":"Download file"},"DOWNLOAD_DOCS_FILE":{"NEWER_DRAFT_EXISTS":{"DIALOG_TITLE":"Download a Version","OK":"Download Version","PROMPT":{"MONTH":"A newer draft, last edited on ${date}, has been detected.","TODAY":"A newer draft, last edited today at ${time}, has been detected.","YESTERDAY":"A newer draft, last edited yesterday at ${time}, has been detected.","DAY":"A newer draft, last edited on ${date}, has been detected.","YEAR":"A newer draft, last edited on ${date_long}, has been detected."},"PROMPT2":{"MONTH":"Are you sure you want to continue to download the version that was published on ${date}?","TODAY":"Are you sure you want to continue to download the version that was published today at ${time}?","YESTERDAY":"Are you sure you want to continue to download the version that was published yesterday at ${time}?","DAY":"Are you sure you want to continue to download the version that was published on ${date}?","YEAR":"Are you sure you want to continue to download the version that was published on ${date_long}?"}},"EMPTY_FILE_READER":{"DIALOG_TITLE":"Cannot Download the File","CANCEL":"Close","PROMPT":"There is no published version of this file to download.","PROMPT2":"Ask the file owner to publish a version of this file."},"EMPTY_FILE_EDITOR":{"DIALOG_TITLE":"Cannot Download the File","CANCEL":"Close","PROMPT":"There is no published version of this file to download.","PROMPT2":"Versions can be published from the Docs editor."}},"EDIT_COMMENT":{"TOOLTIP":"Edit this comment"},"OFFICE_EDITED":{"SUCCESS":"The file is being saved."},"GET_LINKS":{"LINK_FILE":"Link to file:","DIALOG_TITLE":"Get Links","TOOLTIP":"Link to file","LINK_PREVIEW":"Link to preview file:","OK":"Close","LINK_DOWNLOAD":"Link to download file:"},"EDIT_OFFICE":{"TITLE":"Editing options.","A11Y":"This button opens the file for editing in Microsoft Office Online inside of a new window.","NAME":"Edit in Microsoft Office Online","TOOLTIP":"Use Microsoft Office Online to edit this file"},"ADD_TO_FILES":{"VIEW_NOW":"View Now","A11Y":"This button adds the attachment to Files.","TOOLTIP":"Add to Files"},"LIKE":{"LIKE_A11Y":"This button likes the file.","UNLIKE":"Unlike the file","LIKED_SUCCESS":"You liked this file","UNLIKE_SUCCESS":"You unliked this file","UNLIKE_A11Y":"This button unlikes the file.","LIKE":"Like the file"},"TRASH":{"DIALOG_TITLE":"Confirm","TOOLTIP":"Delete this file","PROMPT":"Are you sure you want to move this file to the trash? Moving this file to the trash makes it unavailable to anyone with whom it is presently shared.","SUCCESS_MSG":"${file} has been moved to the trash.","A11Y":"This button moves the file to the trash.","ERROR":"An error occurred deleting the file. Try again later.","CANCEL":"Cancel","NAME":"Move to Trash","OK":"OK"},"CLOSE":{"A11Y":"This button closes the file viewer.","WARNING_DIALOG":{"DIALOG_TITLE":"Your file is still uploading.","CANCEL":"Wait for Upload","PROMPT":"Your file is still uploading. If you close before it completes, the upload will be canceled.","OK":"Close Anyway"},"TOOLTIP":"Close"},"EDIT_OFFICE_POWERPOINT":{"A11Y":"This button opens the file for editing in Microsoft PowerPoint Online inside of a new window.","TOOLTIP":"Use Microsoft PowerPoint Online to edit this file","NAME":"Edit in Microsoft PowerPoint Online"},"EDIT_FILENAME":{"ERROR":{"DEFAULT":"Error saving filename","CONFLICT":"Filename already exists"}},"DOWNLOAD_AS_PDF":{"ERROR":{"DEFAULT":"You were not able to download the file as a PDF.  Please try again later.","UNAUTHENTICATED":"Your session has timed out. You must log in again before you can download the file as a PDF.","NOT_FOUND":"The file could not be downloaded as a PDF because the file has been deleted or is no longer shared with you.","ACCESS_DENIED":"The file could not be downloaded as a PDF because the file has been deleted or is no longer shared with you."},"A11Y":"This button downloads the file as a PDF.","SUCCESS":"You have successfully downloaded the file as a PDF.","TOOLTIP":"Download this file as a PDF file","NAME":"Download as PDF","DOCS_ERRORS":{"NO_PUBLISHED_OR_EMPTY":"There is no published version of this file to download.  Versions can be published from the Docs editor."}},"DROPDOWN_BUTTON":"Dropdown button","LOG_IN":{"NAME":"Log In","TOOLTIP":"Log in to upload and share files, comment, and create folders"},"EDIT_DOC":{"A11Y":"This button opens the file for editing in Docs inside of a new window.","TOOLTIP":"Use IBM Docs to edit this file","NAME":"Edit in Docs"},"DELETE_VERSION":{"DIALOG_TITLE":"Confirm","TOOLTIP":"Delete this version","PROMPT":"You are about to delete version ${version}. Do you want to proceed?","DELETE_VERSION":"Delete version ${version}","DELETE_PRIOR":"Also delete all earlier versions","DELETE_VERSION_AND_PRIOR":"Delete version ${version} and all earlier versions","ERROR":"An error occurred deleting the version. Try again later.","CANCEL":"Cancel","OK":"OK"},"MODERATION":{"PROMPT":"The changes have been submitted for review. This file will not be available until the changes are approved.","DIALOG_TITLE":"Success","CANCEL":"OK"},"TOGGLE_SYNC":{"STOP_SYNC":{"ERROR":{"DEFAULT":"There was an error removing this file from sync. Try again later.","UNAUTHENTICATED":"Your session has timed out. You must log in again before you can remove this file from sync.","NOT_FOUND":"You cannot remove this file from sync because the file has been deleted or is no longer shared with you.","ACCESS_DENIED":"You cannot remove this file from sync because the file has been deleted or is no longer shared with you."},"A11Y":"This button removes the file from sync.","SUCCESS":"You have removed this file from sync.","TOOLTIP":"Remove this file from sync","NAME":"Remove from Sync"},"SYNC":{"ERROR":{"DEFAULT":"There was an error adding this file to sync. Try again later.","UNAUTHENTICATED":"Your session has timed out. You must log in again before you can add this file to sync.","NOT_FOUND":"You cannot add this file to sync because the file has been deleted or is no longer shared with you.","ACCESS_DENIED":"You cannot add this file to sync because the file has been deleted or is no longer shared with you."},"A11Y":"This button adds the file to sync.","SUCCESS":"You have added this file to sync.","TOOLTIP":"Add this file to sync","NAME":"Add to Sync"}},"TOGGLE_FAVORITE":{"FAVORITE_TOOLTIP":"Pin this file","FAVORITE_SUCCESS":"You pinned this file.","STOP_FAVORITEING_NAME":"Unpin","FAVORITE_A11Y":"This button pins the file.","STOP_FAVORITEING_SUCCESS":"You have unpinned this file.","STOP_FAVORITEING_TOOLTIP":"Unpin this file","FAVORITE_NAME":"Pin","STOP_FAVORITEING_A11Y":"This button unpins the file."},"EDIT_DESCRIPTION":{"ERROR":{"DEFAULT":"The description could not be saved. Try again later.","UNAUTHENTICATED":"Your session has timed out. You must log in again before you can update the description.","NOT_FOUND":"The description could not be saved because the file has been deleted or is no longer shared with you.","ACCESS_DENIED":"The description could not be saved because the file has been deleted or is no longer shared with you."},"TOOLTIP":"Edit description"},"RESTORE_VERSION":{"DIALOG_TITLE":"Confirm","TOOLTIP":"Restore this version","PROMPT":"You are about to replace the current version of this file with version ${version}. Do you want to proceed?","CHANGE_SUMMARY":"Restored from version ${version}","ERROR":"An error occurred restoring the version. Try again later.","CANCEL":"Cancel","OK":"OK"},"EDIT_OFFICE_EXCEL":{"A11Y":"This button opens the file for editing in Microsoft Excel Online inside of a new window.","TOOLTIP":"Use Microsoft Excel Online to edit this file","NAME":"Edit in Microsoft Excel Online"},"LOCK":{"ERROR":"The file could not be locked because it has been deleted or is no longer shared with you.","A11Y":"Lock this File","TITLE":"Lock this File","SUCCESS":"The file is now locked.","NAME":"Lock File"},"DELETE_COMMENT":{"ERROR":"An error occurred deleting the comment. Try again later.","DIALOG_TITLE":"Confirm","CANCEL":"Cancel","TOOLTIP":"Delete this comment","OK":"OK","PROMPT":"Are you sure you want to delete this comment?"},"FLAG":{"FILE":{"SUCCESS":"The file has been flagged and submitted for review.","PROMPT":"Provide a reason for flagging this file (optional):","ERROR":"Error flagging this file, please try again later.","TITLE":"Flag File","A11Y":"Flag this file as inappropriate","CANCEL":"Cancel","NAME":"Flag as Inappropriate","OK":"Flag"},"COMMENT":{"SUCCESS":"The comment has been flagged and submitted for review.","PROMPT":"Provide a reason for flagging this comment (optional):","ERROR":"Error flagging this comment, please try again later.","TITLE":"Flag Comment","A11Y":"Flag this comment as inappropriate","CANCEL":"Cancel","NAME":"Flag as Inappropriate","OK":"Flag"},"FILE_DIALOG":{"PROMPT":"The file has been flagged and submitted for review.","DIALOG_TITLE":"Success","CANCEL":"OK"}},"CREATE_FROM_TEMPLATE":{"PROMPT":{"PRES":"Create a presentation (PPT, PPTX or ODP file) from a template file. You can edit these presentations online in Docs.","TEXT":"Create a document (DOC, DOCX or ODT file) from a template file. You can edit these documents online in Docs.","SHEET":"Create a spreadsheet (XLS, XLSX or ODS file) from a template file. You can edit these spreadsheets online in Docs."},"ACTION_NAME":"Create File","CREATE_BUTTON":"Create","EXTERNAL_DESC":"External access allows files to be shared with external users (people outside of your organization or company), folders shared with external users, and communities with external people as members. You must set external access when uploading a file; it cannot be turned on later.","EXTERNAL_FIELD":"Files can be shared with people external to my organization","NAME_FIELD":"Name:","PRE_FILL_NAMES":{"XLT":"Untitled Spreadsheet","POTX":"Untitled Presentation","POT":"Untitled Presentation","XLTX":"Untitled Spreadsheet","DOT":"Untitled Document","OTP":"Untitled Presentation","OTS":"Untitled Spreadsheet","DOTX":"Untitled Document","OTT":"Untitled Document"},"A11Y":{"PRES":"Create a presentation (PPT, PPTX or ODP file) from a template file. You can edit these presentations online in Docs.","TEXT":"Create a document (DOC, DOCX or ODT file) from a template file. You can edit these documents online in Docs.","SHEET":"Create a spreadsheet (XLS, XLSX or ODS file) from a template file. You can edit these spreadsheets online in Docs."},"CANCEL":"Cancel","ERRORS":{"NAME_REQUIRED":"Document name is required.","ILLEGAL_NAME":"This is an illegal document title, please specify another one.","WARN_LONG_NAME":"The document name is too long.","TRIM_NAME":"Shorten the document name?","SESSION_TIMEOUT":"Your session has expired, please log in and try again.","SERVER_ERROR":"The Connections server is not available. Contact the server administrator and try again later.","DUPLICATE_NAME":"A duplicate file name was found. Enter a new name."},"NAME":"New from File"},"EDIT_ON_DESKTOP":{"A11Y":"Edit on desktop","TITLE":"Edit on desktop","NAME":"Edit on desktop"},"TEAR_OFF":{"DIALOG_TITLE":"Confirm","TOOLTIP":"Open in new window","CANCEL_ALT":"Cancel","OPEN_ANYWAY":"Open Anyway","A11Y":"Open in new window","ERROR_TEARING_OFF":"There was an error opening the new window.","OPEN":"Open","CANCEL":"No","OK":"Yes","UNSAVED_CHANGES_WARNING":"You have unsaved changes which will be lost. Do you want to open in a new window anyway?"},"RESIZE":{"RESIZE_BAR":"Resize the panel","USAGE":"Press left bracket or right bracket keys to resize the panel."},"ROUNDTRIP_EDIT":{"DIALOG_TITLE":"Edit on Desktop","REMINDER":"When you are done editing, publish a draft using the desktop file connectors.","IMPORTANT":"Important:","TOOLTIP":"Edit this document","PROMPT":"This feature allows you to edit using software installed on your computer.","SKIP_DIALOG":"Don\'t show this message again.","A11Y":"This button opens the file for editing locally.","CANCEL":"Cancel","INSTALL":"Before proceeding, ${startLink}install desktop file connectors${endLink}.","NAME":"Edit on Desktop","OK":"OK"},"EDIT_OFFICE_WORD":{"A11Y":"This button opens the file for editing in Microsoft Word Online inside of a new window.","TOOLTIP":"Use Microsoft Word Online to edit this file","NAME":"Edit in Microsoft Word Online"},"TOGGLE_PANEL":{"RESET_A11Y":"This button resets the side panel back to default size. The side panel is currently expanded.","SHOW_A11Y":"This button toggles the side panel open and closed. The side panel is currently closed.","HIDE":"Hide details panel","HIDE_A11Y":"This button toggles the side panel open and closed. The side panel is currently open.","SHOW":"Show details panel","RESET":"Reset panel size"},"UPLOAD_VERSION":{"A11Y":"This button opens a dialog which lets you upload a new version of this file.","NAME_SHORT":"Upload","TOOLTIP":"Upload a new version of this file","NAME":"Upload New Version","CHANGE_SUMMARY":"Optional change summary..."},"REFRESH":{"A11Y":"This button moves the file to the trash.","INFO_MSG":"Refresh to get the latest content. ${link}","ERROR":"An error occurred refreshing the File Viewer. Try again later.","TOOLTIP":"Refresh the File Viewer","NAME":"Refresh","SUCCESS_MSG":"The Content has successfully been refreshed."},"TOGGLE_FOLLOW":{"STOP_FOLLOWING_A11Y":"This button stops following the file.","FOLLOW_SUCCESS":"You are now following this file.","FOLLOW_TOOLTIP":"Follow this file","STOP_FOLLOWING_NAME":"Stop Following","FOLLOW_A11Y":"This button follows the file.","STOP_FOLLOWING_SUCCESS":"You have stopped following this file.","STOP_FOLLOWING_TOOLTIP":"Stop following this file","ERROR":{"FOLLOW":{"DEFAULT":"There was an error following this file. Try again later.","UNAUTHENTICATED":"Your session has timed out. You must log in again before you can follow this file.","NOT_FOUND":"You cannot follow this file because the file has been deleted or is no longer shared with you.","ACCESS_DENIED":"You cannot follow this file because the file has been deleted or is no longer shared with you."},"UNFOLLOW":{"DEFAULT":"There was an error unfollowing this file. Try again later.","UNAUTHENTICATED":"Your session has timed out. You must log in again before you can stop following this file.","NOT_FOUND":"You cannot stop following this file because the file has been deleted or is no longer shared with you.","ACCESS_DENIED":"You cannot stop following this file because the file has been deleted or is no longer shared with you."}},"FOLLOW_NAME":"Follow"},"VIEW_DOC":{"A11Y":"This button opens the file for viewing inside of a new browser window.","TOOLTIP":"Open in the Docs Viewer","NAME":"Open in Docs Viewer"},"STOP_SHARING":{"EFSS":{"DIALOG_TITLE":"Confirm","REMOVE_COMMUNITY_TOOLTIP":"Remove from the community ${communityName}","REMOVE_USER":"Are you sure you want to stop sharing with ${user}? If you stop sharing, ${user} will only be able to access this file through folders or if it is shared with everyone in your organization.","REMOVE_EVERYONE":"Are you sure you want to remove your organization\'s access to this file? If access is removed, then the file is removed from folders allowing organization-level access, and only the owner and people with whom it has been shared can view and work with it.","REMOVE_FOLDER":"Are you sure you want to remove this file from the folder ${folderName}?","CANCEL":"Cancel","REMOVE_USER_TOOLTIP":"Remove all shares with ${user}","REMOVE_EVERYONE_TOOLTIP":"Remove your organization\'s access","OK":"OK","REMOVE_FOLDER_TOOLTIP":"Remove from the folder ${folderName}","REMOVE_COMMUNITY":"Are you sure you want to remove this file from the community ${communityName}?"},"DIALOG_TITLE":"Confirm","REMOVE_COMMUNITY_TOOLTIP":"Remove from the community ${communityName}","REMOVE_USER":"Are you sure you want to stop sharing with ${user}? If you stop sharing, ${user} will only be able to access this file through folders or if it is shared with everyone in your organization.","REMOVE_EVERYONE":"Are you sure you want to remove your organization\'s access to this file? If access is removed, then the file is removed from folders and communities allowing organization-level access, and only the owner and people with whom it has been shared can view and work with it.","REMOVE_FOLDER":"Are you sure you want to remove this file from the folder ${folderName}?","CANCEL":"Cancel","REMOVE_USER_TOOLTIP":"Remove all shares with ${user}","REMOVE_EVERYONE_TOOLTIP":"Remove your organization\'s access","OK":"OK","REMOVE_FOLDER_TOOLTIP":"Remove from the folder ${folderName}","REMOVE_COMMUNITY":"Are you sure you want to remove this file from the community ${communityName}?"}},"OPEN_BY_ID_ERROR":{"DEFAULT":"An error occurred accessing the file. Try again later.","ACCESS_DENIED_ANON":"You do not have permission to view this file. If this is your file or it has been shared with you, you must log in first.","ACCESS_DENIED":"You do not have permission to view this file. The file is not shared with you.","NOT_FOUND":"The file you have requested has been deleted or moved. If someone sent you this link, check that it is correct.","UNAUTHENTICATED":"Your session has timed out. You must log in again before you can view the file."},"ERROR_VALIDATING_FILES_FILE":{"DIALOG_TITLE":"Cannot Access Link","CANCEL":"Cancel","PROMPT":"Something went wrong accessing the link.${lineBreaks}Click OK to be redirected to the page.","OK":"OK"},"NOTFOUND_FILE_DIALOG":{"PROMPT":"The file you have requested has been deleted or moved.","DIALOG_TITLE":"Error","CANCEL":"OK"},"SHARE":{"USERROLE":"${userRole} - ${sharedUserCount}","PROVISION_EXTERNAL_USER_DIALOG":{"PLURAL":{"DIALOG_TITLE":"Content Was Not Shared","SUCCESS":"Successfully provisioned user accounts.","TOOLTIP":"Provision external users","PROMPT":{"INVITE":"Invite these users as guests to share the content with them.","NO_ACCOUNT":"The following users do not have an account and no content was shared with them."},"ACTION":"Provision external users...","ERROR":"An error occured provisioning accounts. Try again later.","SUBMIT":"Proceed with invitations","CANCEL":"Cancel","NAME":"Provision External Users"},"ABSTRACT":{"DIALOG_TITLE":"Content Was Not Shared","SUCCESS":"Successfully provisioned user accounts.","TOOLTIP":"Provision external users","PROMPT":{"INVITE":"Invite these users as guests to share the content with them.","NO_ACCOUNT":"Some users do not have accounts and no content was shared with them."},"ACTION":"Provision external users...","ERROR":"An error occured provisioning accounts. Try again later.","SUBMIT":"Proceed with invitations","CANCEL":"Cancel","NAME":"Provision External Users"},"SINGULAR":{"DIALOG_TITLE":"Content Was Not Shared","SUCCESS":"Successfully provisioned user account.","TOOLTIP":"Provision external user","PROMPT":{"INVITE":"Invite this user as a guest to share the content with them.","NO_ACCOUNT":"The following user does not have an account and no content was shared with them."},"ACTION":"Provision external user...","ERROR":"An error occured provisioning the account. Try again later.","SUBMIT":"Proceed with invitation","CANCEL":"Cancel","NAME":"Provision External User"}},"MESSAGE_BOX":{"HINT_TEXT":"Optional message..."},"SHARE_SUCCESS":{"SUCCESS":"Successfully shared with ${user}"},"ADD_TOOLTIP":"Save","ACTION":{"MULTI":{"ADD":"Add People or Communities","ADD_PEOPLE":"Add People"},"EDIT":{"ADD":"Add Editor","ROLE":"Edit"},"OWNER":{"ROLE":"Owner"},"VIEW":{"ADD":"Add Reader","ROLE":"Reader"},"FOLDER":{"MOVE":"Move to Folder","ADD":"Add Folders","COMMUNITY_ADD":"Add To Folder"}},"PUBLIC":{"SHORT":"Everyone in my organization","LONG":{"ORG":"Everyone in ${org}","GENERIC":"Everyone in your organization"}},"EVERYONE":"Everyone in my organization","MULTI_SHARE_SUCCESS":{"SUCCESS":"The file was shared successfully."},"ROLES":{"EDIT":"Editors","OWNER":"Owner","VIEW":"Readers","FOLDER":"Shared with Folders"},"SHARE_INFO":{"PROMOTED":"${user} has been promoted to a higher sharing role."},"SHARE_FAIL":{"SELF":"You cannot share with yourself.","ERROR":"Unable to share with ${user} at this time.","EXISTING_USER":"This file is already shared with ${user}."}},"WELCOME":{"SUBTITLE":"Now you can view a file and its comments side-by-side.","TITLE":"We\'ve Combined File View and Details","LINES":{"LINE_1":"All the information and things you could do on the old page are found here.","LINE_2":"Comments, sharing, versions, and basic information are available to the side of the file."}},"COMMENT_WIDGET":{"EDITED_DATE":{"MONTH":"Edited on ${date_long}","TODAY":"Edited today at ${time}","YESTERDAY":"Edit yesterday at ${time}","DAY":"Edited on ${EEee} at ${time}","YEAR":"Edited on ${date_long}"},"EDITED":"(Edited)"},"SECTION":{"ABOUT":{"A11Y":"Activating this link will close the file viewer and direct you to the file details page for this file.","VIEW_FILE_DETAILS":"View File Details","NAME":"About This File"}},"THUMBNAIL":{"UPLOAD":"Save","SUCCESS":"The thumbnail was changed","TITLE":"Thumbnail","ERROR":"The thumbnail could not be saved. Try again later.","CHANGE_LINK":"Change Thumbnail...","EXT_ERROR":"Select a file with one of the following supported extensions: ${0}","CANCEL":"Cancel"},"LOAD_ERROR":{"DEFAULT":"Oops. There was an error accessing the link.","ACCESS_DENIED":"Contact the file owner to request permission to view this file."},"ENTRY":{"REMOVE":"Remove","EDIT":"Edit","CANCEL":"Cancel","USER_PICTURE":"${0}\'s Picture","DELETE":"Delete","FLAG":"Flag As Inappropriate","OK":"OK","RESTORE":"Restore"},"FILE_SIZE":{"B":"${0} B","GB":"${0} GB","MB":"${0} MB","TB":"${0} TB","KB":"${0} KB"},"PANEL":{"VERSIONS":{"TITLE":"Versions","FEED_LINK":"Feed for these versions","TITLE_WITH_COUNT":"Versions (${0})","FEED_TITLE":"Follow changes to this file through your feed reader"},"SHARING":{"MULTIPLE_SHARE":"This file is in ${fileNumber} folders or communities you do not have access to.","NO_SHARE":"This file has not been added to any folders yet.","COMMUNITY_FILE":"Files owned by a community cannot be shared to people or other communities.","ONE_SHARE":"This file is in 1 folder or community you do not have access to.","SHARED_WITH_FOLDERS":"Shared with Folders - ${count}","SEE_WHO_HAS_SHARED":"See who has shared","TITLE":"Sharing","LOGIN":"Log in","SHARED_WITH_COMMUNITY":"Shared with members of the community \'${0}\'","TITLE_WITH_COUNT":"Shared (${0})"},"COMMENTS":{"VERSION":"Version ${0}","TITLE":"Comments","FEED_LINK":"Feed for these comments","TITLE_WITH_COUNT":"Comments (${0})","FEED_TITLE":"Follow changes to these comments through your feed reader"},"ABOUT":{"SECURITY":"Security","DOWNLOADS_HEADER":"Views","DOWNLOADS_LAST_VERSION":"You last viewed version ${0} of this file","FILE_SIZE_HEADER":"File Size","DOWNLOADS_EXPAND_ICON":"Expand this icon to see who has viewed the file","GET_LINKS":"Get Links...","LIKES_HEADER":"Likes","DESCRIPTION_HEADER":"Description","DOWNLOADS_HEADER_MORE":"Views (${0})","DOWNLOADS_COUNT_FULL":"${downloads} - ${anonymousDownloads} anonymously","NO_TAGS":"No tags","ADD_TAGS":"Add tags","CURRENT_VERSION_HEADER":"Current Version ${versionNumber}","LIKES_EXPAND_ICON":"Expand this icon to see who has liked the file","NO_DESCRIPTION":"No description","ADD_DESCRIPTION":"Add a description","FILE_ENCRYPTED":"File content is encrypted. Encrypted file content is not searchable. File content cannot be viewed and cannot be edited with IBM Docs.","CREATED_HEADER":"Created","DOCS_DRAFT_CREATED_HEADER":"Draft Created","DOCS_CREATED_HEADER":"Created","UPDATED_HEADER":"Updated","DOCS_DRAFT_UPDATED_HEADER":"Draft Edited","TAGS_HEADER":"Tags","LINKS_HEADER":"Links","DOWNLOADS_LATEST_VERSION":"You have the latest version of this file","DOCS_UPDATED_HEADER":"Published","EXPAND_BUTTON":"Expand this button to see more information","CURRENT_VERSION_FILE_SIZE":"${fileSize} - Current Version","TITLE":"About","DOWNLOADS_COUNT":"${downloads}","DESCRIPTION_READ_MORE":"Read More...","ALL_VERSIONS_FILE_SIZE":"${fileSize} - All Versions"},"LOAD_ERROR":"There was an error accessing the metadata of this file."},"ERROR":"An error has occurred.","FILE_STATE":{"LOCKED_BY_YOU":{"MONTH":"Locked by you on ${date}.","TODAY":"Locked by you at ${time}.","YESTERDAY":"Locked by you yesterday at ${time}.","DAY":"Locked by you on ${date}.","YEAR":"Locked by you on ${date_long}."},"DOCS_FILE":"This is a Docs file. All edits must be made online.","LOCKED_BY_OTHER":{"MONTH":"Locked on ${date} by ${user}.","TODAY":"Locked at ${time} by ${user}.","YESTERDAY":"Locked yesterday at ${time} by ${user}.","DAY":"Locked on ${date} by ${user}.","YEAR":"Locked on ${date_long} by ${user}."}},"MORE_ACTIONS":{"A11Y":"Opens a drop-down menu with a list of more actions to perform on the file.","TITLE":"More Actions","PANELS":{"TITLE":"More","A11Y":"Opens a drop-down menu with a list of hidden panels"}},"COMMENTS":{"ERROR":{"SAVE":{"DEFAULT":"Your comment could not be saved. Try again later.","UNAUTHENTICATED":"Your session has timed out. You must log in again before you can save your comment.","NOT_FOUND":"Your comment could not be saved because the file has been deleted or is no longer shared with you.","ACCESS_DENIED":"Your comment could not be saved because the file has been deleted or is no longer shared with you."},"DELETE":{"DEFAULT":"Your comment could not be deleted. Try again later.","UNAUTHENTICATED":"Your session has timed out. You must log in again before you can delete your comment.","NOT_FOUND":"Your comment could not be deleted because the file has been deleted or is no longer shared with you.","ACCESS_DENIED":"Your comment could not be deleted because the file has been deleted or is no longer shared with you."}},"MODERATED":"The comment has been submitted for review and will be available when approved.","EMPTY":"There are no comments."},"EDIT_BOX":{"CANCEL":{"A11Y":"This button cancels the action of editing the file name.","TOOLTIP":"Cancel"},"INVALID_CHARACTERS":"Invalid character","INVALID_CHARACTERS_REMOVED":"Invalid characters removed","SAVE":"Save"},"VALIDATION":{"A11Y_TEXT":"Automatically shorten this text","SHARE_MESSAGE":{"WARN_TOO_LONG":"The message is too long.","TRIM":"Shorten message?"},"FILENAME":{"WARN_TOO_LONG":"Filename too long"},"TAGS":{"WARN_TOO_LONG":"One or more tags are too long.","TRIM":"Shorten tags?"},"TAG":{"WARN_TOO_LONG":"The tag is too long.","TRIM":"Shorten tag?"},"DESCRIPTION":{"WARN_TOO_LONG":"The description is too long.","TRIM":"Shorten description?"},"COMMENT":{"WARN_TOO_LONG":"The comment is too long.","TRIM":"Shorten comment?"}},"SHARE_LINK":{"MY_SHARES":"My Shares"},"UPLOAD_VERSION":{"TOO_LARGE":"${file} is larger than the ${size} file size allowed.","UPLOAD":"Upload","SUCCESS":"The new version was saved","CANCEL_UPLOAD":"Cancel upload","UPLOAD_AND_CHANGE_EXTENSION":"Upload and Change Extension","CHANGE_SUMMARY":"Optional change summary...","ERROR":"The new version could not be saved. Try again later.","PROGRESS_BAR_TITLE":"Uploading new version (${uploaded} of ${total} complete)","CANCEL":"Cancel","LINK":"Upload New Version..."},"SHARE_OPTIONS":{"MAKE_INTERNAL_SUCCESS":"This file can no longer be shared with people outside of your organization.","STOP_SHARE":"Stop Sharing","MAKE_PRIVATE_DIALOG":{"QUESTION_PUBLIC_E":"This file will no longer be visible to everyone in your organization, or shared with people or folders. This operation cannot be undone.","DIALOG_TITLE":"Stop Sharing File","QUESTION_PUBLIC":"This file will no longer be visible to everyone in your organization, or shared with people, folders, or communities. This operation cannot be undone.","QUESTION_E":"This file will no longer be shared with people, and will be removed from all folders except your private folders. This action cannot be undone.","PROMPT":"Are you sure you want to stop sharing this file?","QUESTION":"The file will no longer be shared with people or communities, and will be removed from all folders except your private folders. This action cannot be undone."},"MAKE_PRIVATE_SUCCESS":"This file is now private.","OWNER_ONLY":"Only the owner can share this file.","TITLE":"Sharing Options","MAKE_INTERNAL_DIALOG":{"PROMPT":"Making this file internal will mean it can no longer be shared with people outside of your organization. ${br}${br}Any shares with external people, communities or folders will be removed.${br}${br}Making a file internal is permanent and cannot be undone.","EFSS":{"PROMPT":"Making this file internal will mean it can no longer be shared with people outside of your organization. ${br}${br}Any shares with external people or folders will be removed.${br}${br}Making a file internal is permanent and cannot be undone.","DIALOG_TITLE":"Make Internal?"},"DIALOG_TITLE":"Make Internal?"},"MAKE_PRIVATE_ERROR":{"DEFAULT":"Unable to stop sharing the file. Try again later."},"EVERYONE":"Everyone can share this file.","PROPAGATION":"Allow others to share this file","MAKE_INTERNAL":"Stop Sharing Externally"}});

;define("ic-share/fileviewer/config/extensionmap",[],function(){
"use strict";
return {"123":"Data","12m":"Data","323":"Text","aac":"Audio","acs":"Data","acx":"Code","ai":"Graphic","aif":"Audio","aifc":"Audio","aiff":"Audio","asf":"Video","asp":"Code","asr":"Video","asx":"Video","au":"Audio","avi":"Video","axs":"Code","bas":"Text","bmp":"Graphic","c":"Text","cab":"Compressed","cgm":"Graphic","crd":"Contact","css":"Code","csv":"Data","dbs":"Data","dez":"Data","divx":"Video","dmg":"Compressed","doc":"WordProcessing","docm":"WordProcessing","docx":"WordProcessing","dot":"WordProcessing","dotm":"WordProcessing","dotx":"WordProcessing","drw":"Graphic","dxf":"Graphic","en4":"WordProcessing","ens":"Data","enw":"WordProcessing","eps":"Graphic","eshr":"Graphic","fcd":"Data","fcs":"Data","fla":"Flash","flv":"Video","flw":"Presentation","gif":"Graphic","gtar":"Compressed","gz":"Compressed","h":"Text","hgs":"Graphic","htm":"Code","html":"Code","html.zip":"Code","ibfpx2.flt":"Graphic","ibjpg2.flt":"Graphic","ibpcd2.flt":"Graphic","ibxbm2.flt":"Graphic","ibxpm2.flt":"Graphic","ich":"Pdf","ich6":"Pdf","ico":"Graphic","ief":"Graphic","img":"Graphic","iwp":"Pdf","jar":"Compressed","jfif":"Graphic","jpe":"Graphic","jpeg":"Graphic","jpg":"Graphic","js":"Code","jsp":"Code","jw":"Text","key":"Presentation","leg":"WordProcessing","log":"Text","lsf":"Video","lsx":"Video","lwp":"WordProcessing","lwp7":"WordProcessing","m3u":"Audio","m4a":"Audio","manu":"WordProcessing","mass":"Presentation","mcw":"Text","mid":"Audio","mov":"Video","movie":"Video","mp2":"Video","mp3":"Audio","mp4":"Video","mpa":"Video","mpe":"Video","mpeg":"Video","mpg":"Video","mpv2":"Video","msg":"Text","msw":"WordProcessing","mwkd":"Data","mwks":"Data","mwp":"WordProcessing","mwp2":"WordProcessing","mwpf":"WordProcessing","odc-present.zip":"Presentation","odc-sheet.zip":"Data","odc-text.zip":"WordProcessing","odp":"Presentation","ods":"Data","odt":"WordProcessing","ogg":"Audio","ogv":"Video","ope":"Presentation","ort":"WordProcessing","oss":"Data","otp":"Presentation","ots":"Data","ott":"WordProcessing","ow":"Text","pages":"WordProcessing","pbm":"Graphic","pcl":"WordProcessing","pcx":"Graphic","pdf":"Pdf","pfs":"Text","pgl":"Graphic","php":"Code","pic":"Graphic","pict":"Graphic","png":"Graphic","pntg":"Graphic","pot":"Presentation","potm":"Presentation","potx":"Presentation","pp2":"Presentation","pp97":"Presentation","ppam":"Presentation","pps":"Presentation","ppsm":"Presentation","ppsx":"Presentation","ppt":"Presentation","pptm":"Presentation","pptx":"Presentation","prz":"Presentation","ps":"Graphic","psd":"Graphic","psp6":"Graphic","qa":"Text","qad":"Data","qt":"Video","ra":"Audio","ram":"Audio","rar":"Compressed","ras":"Graphic","rgb":"Graphic","rmi":"Audio","rtf":"Text","rtx":"WordProcessing","sdw":"Graphic","shw3":"Presentation","sit":"Compressed","smc":"Presentation","smd":"Data","sms":"Data","snd":"Audio","sow":"Text","sqx":"Compressed","stc":"Data","sti":"Presentation","stm":"Code","stw":"WordProcessing","svg":"Graphic","svgz":"Graphic","svi":"Video","swf":"Flash","sxc":"Data","sxi":"Presentation","sxw":"WordProcessing","tar":"Compressed","taz":"Compressed","text":"Text","tgz":"Compressed","tif":"Graphic","tif6":"Graphic","tiff":"Graphic","tsv":"Text","tw":"Text","txt":"Text","uls":"Text","vcard":"Contact","vcf":"Contact","vcrd":"Contact","vw3":"Text","w6":"WordProcessing","w97":"WordProcessing","wav":"Audio","wbmp":"Graphic","webm":"Video","wg2":"Data","wk4":"Data","wk6":"Data","wm":"WordProcessing","wma":"Audio","wml":"Code","wmv":"Video","wp5":"WordProcessing","wp6":"WordProcessing","wpf":"WordProcessing","wpg":"Graphic","ws":"Text","xbm":"Graphic","xla":"Data","xlam":"Data","xlc":"Data","xlm":"Data","xls":"Data","xlsb":"Data","xlsm":"Data","xlsx":"Data","xlt":"Data","xltm":"Data","xltx":"Data","xlw":"Data","xml":"Code","xpm":"Graphic","xwd":"Graphic","xy":"Text","z":"Compressed","zip":"Compressed"};
});


;define("ic-share/fileviewer/config/documentTypes",["dojo/has","ic-core/config/properties"],function(_1,_2){
"use strict";
var _3={view:["doc","docx","odt","xls","xlsx","ods","ppt","pptx","odp","pdf","xlsm"],edit:["ppt","odp","ods","xls","txt","csv","docx","doc","odt","pptx","xlsx"],create:["ott","ots","otp","dot","xlt","pot","dotx","xltx","potx"]};
if(_1("fileviewer-dynamic-filetypes")){
Object.keys(_3).forEach(function(_4){
var _5=_2["com.ibm.docs.types."+_4];
if(_5){
_3[_4]=_3[_4].concat(_5.split(","));
}
});
}
return _3;
});


;define("dojo/text!ic-core/templates/bizcard.html", '<!-- ***************************************************************** -->\n<!--                                                                   -->\n<!-- IBM Confidential                                                  -->\n<!--                                                                   -->\n<!-- OCO Source Materials                                              -->\n<!--                                                                   -->\n<!-- Copyright IBM Corp. 2014, 2015                                    -->\n<!--                                                                   -->\n<!-- The source code for this program is not published or otherwise    -->\n<!-- divested of its trade secrets, irrespective of what has been      -->\n<!-- deposited with the U.S. Copyright Office.                         -->\n<!--                                                                   -->\n<!-- ***************************************************************** -->\n<span class="vcard" type="MentionsNode" contenteditable="false" data-mentions=\'{"displayName":"${displayName}","userId":"${userid}","type":"PersonMentions","hasSymbol":"${hasSymbol}"}\'><!--\n --><a class="fn url" href="${url}">${name}</a><!--  \n --><span class="x-lconn-userid" style="display:none">${userid}</span><!--  \n--></span>');

;define("ic-core/util/text",["dojo/cache","dojo/number","dojo/string","dojo/_base/config","dojo/_base/array","dojo/_base/lang","dojo/has","dojo/text!ic-core/templates/bizcard.html","ic-ui/layout/people","ic-core/config/services"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
var _b=/(mailto:|(([A-Za-z]{3,9}):\/\/))([-;:&=\+\$,\w]+@{1})?([-A-Za-z0-9\.]+)+:?(\d+)?((\/[-\+~%\/\.\w]+)?\??([-\+=&;%@\.\w]+)?#?([\w]+)?)?/gi;
var _c=/\r?\n/g,_d=/ {2}/g,_e=/@\{{2}([^|]+)\|([^|]+)(\|notify)?\}{2}/g,_f=/<span class="?vcard"?>\s*(?:<br\/?>)*\s*<span class="?fn"?>([^<>]+)<\/span>\s*(?:<br\/?>)*\s*<span class="?x-lconn-userid"?>([^<>]+)<\/span>\s*(?:<br\/?>)*\s*<\/span>/gi;
var _10={templateString:_8};
var _11=1024,_12=1024*_11,_13=1024*_12,_14=1024*_13;
return {CODE_MAP:[[128,1],[2048,2],[55296,3],[56320,4,56320,57343,2]],trimToByteLength:function(str,_15){
var _16="...";
_15=_15-_16.length;
var _17=this.CODE_MAP;
if(_15<=0){
return "";
}
var i=0,_18=0,len=str.length;
var _19=0,_1a,b;
while(i<len){
if(_19>=_15){
return str.substring(0,_18)+_16;
}
_1a=str.charCodeAt(i);
if(_1a<_17[0][0]){
_19+=_17[0][1];
}else{
if(_1a<_17[1][0]){
_19+=_17[1][1];
}else{
if(_1a<_17[2][0]){
_19+=_17[2][1];
}else{
if(i<_17[3][0]){
if(i+1<len){
b=str.charCodeAt(i+1);
if(b>=_17[3][2]&&b<=_17[3][3]){
_19+=_17[3][1];
i++;
}else{
_19+=_17[3][4];
}
}else{
_19+=_17[3][4];
}
}
}
}
}
i++;
if(_19==_15){
return str.substring(0,i)+_16;
}
if(_19>_15){
return str.substring(0,_18)+_16;
}
_18=i;
}
return str;
},getByteLength:function(str){
var _1b=this.CODE_MAP;
var i=0,len=str.length;
var _1c=0,_1d,b;
while(i<len){
_1d=str.charCodeAt(i);
if(_1d<_1b[0][0]){
_1c+=_1b[0][1];
}else{
if(_1d<_1b[1][0]){
_1c+=_1b[1][1];
}else{
if(_1d<_1b[2][0]){
_1c+=_1b[2][1];
}else{
if(i<_1b[3][0]){
if(i+1<len){
b=str.charCodeAt(i+1);
if(b>=_1b[3][2]&&b<=_1b[3][3]){
_1c+=_1b[3][1];
i++;
}else{
_1c+=_1b[3][4];
}
}else{
_1c+=_1b[3][4];
}
}
}
}
}
i++;
}
return _1c;
},possessive:function(s){
if(s&&s[s.length-1]!="s"){
s+="'s";
}else{
s+="'";
}
return s;
},getExtension:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf(".");
if(i!=-1){
return s.substring(i+1).toLowerCase();
}
return "";
},trimExtension:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf(".");
if(i!=-1){
return s.substring(0,i);
}
return s;
},getFilename:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf("\\");
var j=s.lastIndexOf("/");
if(i==j){
return s;
}
i=Math.max(i,j);
return s.substring(i+1);
},trimToLength:function(s,_1e,_1f){
if(!s){
return "";
}
s=this.trimEnd(s);
var _20="...";
if(_1f>0){
var i,l,_21=s.split(/[\s\u3000]/);
for(i=0;i<_21.length;i++){
if(_21[i].length>_1f){
l=s.indexOf(_21[i])+_1f;
if(l>_1e){
break;
}
return this.trimEnd(s.substring(0,l-_20.length))+_20;
}
}
}
if(s.length>_1e){
s=this.trimEnd(s.substring(0,_1e-_20.length))+_20;
}
return s;
},trim:function(s){
if(!s){
return "";
}
var e=/^[\s\u3000]*(.*?)[\s\u3000]*$/.exec(String(s));
return e?e[1]:s;
},trimEnd:function(s){
if(!s){
return "";
}
s+="";
s=/^(.*?)[\s\u3000]*$/.exec(s)[1];
return s;
},parseInt:function(s,def){
if(def===undefined){
def=0;
}
if(!s){
return def;
}
var a=parseInt(s,10);
return isNaN(a)?def:a;
},parseFloat:function(s,def){
if(def===undefined){
def=0;
}
if(!s){
return def;
}
var a=parseFloat(s);
return isNaN(a)?def:a;
},formatSize:function(nls,_22){
if(arguments.length<2){
_22=nls;
nls=undefined;
}
if(_22===undefined||_22===null||typeof _22=="string"){
return _22;
}
nls=nls||this._SIZE;
if(!nls){
throw "Must pass nls to formatSize or set the lconn.core.util.text._SIZE property during init";
}
if(_22>10*_14&&nls.TB){
return _3.substitute(nls.TB,[_2.format(Math.floor(_22*10/_14)/10)]);
}
if(_22>=_14&&nls.TB){
return _3.substitute(nls.TB,[_2.format(Math.floor(_22*100/_14)/100)]);
}
if(_22>10*_13){
return _3.substitute(nls.GB,[_2.format(Math.floor(_22*10/_13)/10)]);
}
if(_22>=_13){
return _3.substitute(nls.GB,[_2.format(Math.floor(_22*100/_13)/100)]);
}
if(_22>100*_12){
return _3.substitute(nls.MB,[_2.format(Math.floor(_22/_12))]);
}
if(_22>10*_12){
return _3.substitute(nls.MB,[_2.format(Math.floor(_22*10/_12)/10)]);
}
if(_22>=_12){
return _3.substitute(nls.MB,[_2.format(Math.floor(_22*100/_12)/100)]);
}
if(_22>1024){
return _3.substitute(nls.KB,[_2.format(Math.floor(_22/1024))]);
}
return _3.substitute(nls.KB,[_2.format(_22>0?1:0)]);
},length:function(s){
var ret=0;
var t=encodeURIComponent(s);
var _23,_24=0,_25=0;
while(true){
_25=t.indexOf("%",_24);
if(_25==-1){
ret+=(t.length-_24);
break;
}else{
ret+=(_25-_24);
_23=parseInt(t.substr(_25+1,2),16);
if(_23<192){
ret+=1;
_24=_25+3;
}else{
if(_23>=192&&_23<224){
ret+=1;
_24=_25+6;
}else{
if(_23>=224&&_23<240){
ret+=1;
_24=_25+9;
}else{
if(_23>=240&&_23<248){
ret+=1;
_24=_25+12;
}else{
if(_23>=248&&_23<252){
ret+=1;
_24=_25+15;
}else{
if(_23>=252){
ret+=1;
_24=_25+18;
}
}
}
}
}
}
}
}
return ret;
},lengthUtf8:function(s){
var _26=0;
var c,i,_27=s.length;
for(i=0;i<_27;i++){
c=s.charCodeAt(i);
if(c<=127){
_26++;
}else{
if(c<=2047){
_26+=2;
}else{
if(c<=65535){
_26+=3;
if((c>>11)==27){
_26++;
i++;
}
}else{
_26+=4;
}
}
}
}
return _26;
},getCharIndexForUtf8Index:function(s,max){
var _28=0;
var c,i,_29=s.length;
for(i=0;i<_29;i++){
c=s.charCodeAt(i);
if(c<=127){
_28++;
}else{
if(c<=2047){
_28+=2;
}else{
if(c<=65535){
_28+=3;
if((c>>11)==27){
_28++;
i++;
}
}else{
_28+=4;
}
}
}
if(_28>max){
return i;
}
}
return -1;
},encodeHeaderUtf8:function(s){
return "=?UTF-8?Q?"+encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,"=$1")+"?=";
},uniquifyStringList:function(_2a){
var s,_2b={},_2c=[];
if(_2a&&_2a.length>0){
for(s in _2a){
_2b[s]=1;
}
for(s in _2b){
_2c.push(s);
}
}
return _2c;
},htmlify:function(str,_2d){
var _2e;
str=str.replace(_c,"<br>");
if(_7("ie")===8){
while(str.indexOf("\\n")>-1){
str=str.replace("\\n","<BR>");
}
}
str=str.replace(_b,function(url){
var _2f=_9.getProfileUrl("","");
if(url.indexOf(_2f)==-1){
return "<a href=\""+url+"\">"+url+"</a>";
}
return url;
});
if(_2d){
str=str.replace(_d," &nbsp;");
}
str=this.htmlifyMentions(str);
return str;
},htmlifyMentions:function(str){
var _30;
_5.forEach([_e,_f],function(_31){
while(_30=_31.exec(str)){
var u=_30[0],_32,_33,_34,_35=true;
if(_31==_e){
_35=!!_30[3];
_34=_30[2];
_32=_35?"@"+_34:_34;
_33=_30[1];
}else{
_32=_30[1];
_35=_32.indexOf("@")==0;
_34=_35?_32.substring(1,_32.length):_32;
_33=_30[2];
}
var _36=_9.getProfileUrl({name:_34,userid:_33});
var l=_3.substitute(_8,{url:_36,name:_32,userid:_33,displayName:_34,hasSymbol:_35});
if(_4.isDebug){
l=_6.trim(l.replace(/<!--[\s\S]*?-->/g,""));
}
_31.lastIndex+=l.length-u.length;
str=str.replace(u,l);
}
});
return str;
}};
});


;define("ic-share/fileviewer/preview/util",["../config/extensionmap","dojo/string","dojo/i18n!../nls/FileViewerStrings","dojo/_base/lang","dojo/number","dojo/_base/array","../config/documentTypes","dojo/has","ic-core/util/text","dojo/topic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
var _b=1000,_c=["00000000-0000-0000-0001-000000000000","00000000-00000-0000-0001-00000000000000"],_d;
_d={clamp:function(_e,_f,_10){
if(_e>_10){
return _10;
}
if(_e<_f){
return _f;
}
return _e;
},formatFileSize:function(_11){
return _9.formatSize(_3.FILE_SIZE,_11);
},getIconClass:function(_12,_13){
if(_4.isFunction(_12.updateFromBean)){
_12.updateFromBean();
}
var _14,_15,_16=this.isDocsFile(_12)?"Docs":"",_17=_12.type;
if(_8("hikari-default-theme")||this.isDocsFile(_12)){
_15="iconsFileTypes${size} iconsFileTypes${size}-ft${category}${docsString}${size}";
if(!_4.isString(_17)||_17.length===0){
_14="Default";
}else{
_14=_4.getObject(_17,false,_1)||"Default";
}
}else{
_15="lconn-ftype${size} lconn-ftype${size}-${type}";
}
_13=_13||128;
return _2.substitute(_15,{size:_13,category:_14,docsString:_16,type:_17});
},isDocsFile:function(_18){
var _19="";
_19=_18.objectTypeId;
return _18._isDocsFile||_6.indexOf(_c,_19)!==-1;
},isFileSizeFormatted:function(_1a){
return !(Number(_1a)==_1a);
},isFileViewable:function(_1b){
var _1c=(_1b.args||{}).type;
return _6.indexOf(_7.view,_1c)>-1;
},isCCM:function(_1d){
if(_1d){
if(_1d.bean){
if(_1d.bean.get("libraryType")==="library"){
return true;
}
}else{
if(_1d.args){
if(_1d.args.libraryType==="library"){
return true;
}
}else{
if(_1d.libraryType==="library"){
return true;
}
}
}
}
return false;
},isPreviewSafe:function(_1e,_1f){
var _20=_1e.bean||_1e;
if(_20.malwareScanState==="unscanned"){
if(_1f){
_a.publish("ic-fileviewer/push/messages",{type:"warning",message:_1f,cancelable:false});
}
return false;
}
return true;
}};
return _d;
});


;define("ic-share/fileviewer/preview/VideoJSPreview",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/VideoJSPreview.html","dojo/_base/array","dojo/dom-construct","dojo/dom-style","dojo/dom-class","dojo/dom-attr","ic-core/config/services","ic-core/config/properties","ic-core/url","dojo/has","dojo/on","dojo/_base/lang","dijit/registry","dojo/topic","../video/video-js/video-dev","dojo/i18n!../video/video-js/lang/VideoJSStrings","dojo/i18n!../nls/FileViewerStrings","./util"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,on,_e,_f,_10,_11,_12,_13,_14){
"use strict";
var _15=["mp4","mov","flv","webm","ogg"];
var _16=["webm","ogg"];
var _17="video/flv";
var _18="video/mp4";
var _19=9/16;
var _1a=_c.getServiceUrl(_a.webresources);
var _1b=_1([_2,_3],{previewId:"video",templateString:_4,postMixInProperties:function(){
this.videoURL=this.file.args.links.download;
this.videoType=this._getVideoType();
this.id=_f.getUniqueId("fileviewer")+"_vjsVideo";
if(this.videoType=="video/flv"){
this.videoHeight="1080";
this.videoWidth="1920";
}else{
this.videoHeight="auto";
this.videoWidth="auto";
}
},_getVideoType:function(){
var _1c=this.file.args.type;
if(_1c==="mov"||_1c==="flv"||_d("ie")){
return _17;
}
if(_d("safari")&&_b.DeploymentModel!=="SmartCloud"){
return _17;
}
return _18;
},_onLoad:function(){
if(this.previewOptions&&this.previewOptions.volumeOnStart){
this.videojs.volume(this.previewOptions.unmuteOnStart);
}else{
this.videojs.volume(0);
}
this.videojs.play();
this.videojs.controls(true);
this.videojs.removeClass("vjs-preloaded");
this.videojs.on("fullscreenchange",function(){
_10.publish("ic-fileviewer/content/toggleClass",{className:"videojs-fullScreen"});
});
},postCreate:function(){
if(videojs){
videojs.options.flash.swf=_1a+"/web/ic-share/fileviewer/video/video-js/video-js.swf";
videojs.addLanguage("VideoJSLang",_12);
videojs.options.language="VideoJSLang";
try{
this.videojs=videojs(this.vjsVideo,{},_e.hitch(this,function(){
_6.create("div",{"style":"padding-top:"+(_19*100)+"%;"},this.videoContainer.children[0],"first");
_7.set(this.videoContainer.children[0],"height","auto");
_7.set(this.videoContainer.children[0],"width","auto");
_8.add(this.videoContainer,"loaded");
}));
this.videojs.controls(false);
this.videojs.addClass("vjs-waiting");
this.videojs.on("loadstart",_e.hitch(this,function(){
this.videojs.addClass("vjs-preloaded");
}));
this.videojs.on("loadedmetadata",_e.hitch(this,function(){
this._onLoad();
}));
this.videojs.on("error",_e.hitch(this,function(){
if(this.errorHandler){
this.errorHandler();
}
}));
}
catch(e){
}
}else{
}
},onError:function(){
if(this.errorHandler){
this.errorHandler();
}
},_cancelEvent:function(_1d){
_1d.stopPropagation();
},_keyEvents:function(_1e){
var _1f=_1e.charCode||_1e.keyCode;
if(_1f==37||_1f==40||_1f==38||_1f==39){
_1e.fidoIgnoreEvent=true;
}
if(this.videojs&&(this.videojs.isFullScreen()&&_1f==27)){
_1e.fidoIgnoreEvent=true;
}
},destroy:function destroy(){
if(this.videojs){
this.videojs.dispose();
}
this.inherited("destroy",[]);
}});
return {create:function(_20){
return new _1b(_20);
},_validateHTML5OnlyTypes:function(_21){
if(_5.indexOf(_16,_21.bean.get("type"))>-1){
if(_d("ie")){
return false;
}
}
return true;
},isSafeForPreview:function(_22){
var _23=_13.PREVIEW.VIDEO.UNSAFE_PREVIEW||"This file cannot be previewed because it has not been scanned for viruses.";
return _14.isPreviewSafe(_22,_23);
},isValid:function(_24){
return !(_d("ie")===8)&&_d("fileviewer-preview-videojs")&&_5.indexOf(_15,_24.bean.get("type"))>-1&&this._validateHTML5OnlyTypes(_24)&&this.isSafeForPreview(_24);
}};
});


;define("dojo/text!ic-share/fileviewer/preview/templates/VideoPreview.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-viewer-video-preview">\n	<span class="align-helper"></span>\n	<div class="ics-video-widget"\n	   data-dojo-attach-point="videoContainer"\n	   data-dojo-attach-event="onclick:_cancelEvent">\n	</div>\n</div>\n');

;define("dojo/i18n!ic-share/fileviewer/video/html5_video_player/nls/html5VideoPlayerStrings", {"videoPlayer":{"fullScreenButtonCloseAction":"Exit full screen mode by pressing ESC","timeDuration":"Length of video","videoDownload":"Your video is downloading.","scrubBar":"Go to a different place within the video.","invalidVideo":"An error has occurred. The video cannot be played.","playButton":"Play the video","pauseButton":"Pause the video","muteButton":"Unmute the video","volumeButton":"Mute the video","fullScreenButton":"Enter full screen mode","volumeBar":"Change the volume","videoPlayer":"Video Player","currentTimeDisplay":"Current time","collapseButton":"Exit full screen mode"}});

;define("ic-share/fileviewer/config/globals",[],function(){
"use strict";
return {};
});


;define("ic-share/fileviewer/video/HTML5VideoPlayer",["dojo","dojo/dom","dojo/dom-style","dojo/i18n!./html5_video_player/nls/html5VideoPlayerStrings","dojo/dom-attr","dojo/has","dojo/dom-construct","dojo/dom-geometry","dojo/dom-class","dojo/_base/window","dojo/_base/declare","dijit/_Widget","dojo/on","dojo/_base/lang","dojo/Evented","../config/globals"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,on,_d,_e,_f){
var _10=_b([_c,_e],{isA11y:false,nls:_4,prevId:null,nextId:null,isMini:null,originalVideoHeight:0,originalVideoWidth:0,initVolume:0.67,lastVolumeValue:0.67,volumeWidth:28,focused:false,controlsTimedOut:null,timeOutHandle:null,isMuted:false,isPlaying:false,isFullScreen:false,allowFullScreen:true,constructor:function(){
this.handles={};
this.volumeListeners={};
this.fullscreenListeners={};
this.isA11y=_9.contains(_a.doc.getElementsByTagName("body")[0],"dijit_a11y");
this.removeAccessibility=_f.isVerse;
},formatTime:function(_11){
var _12=Math.floor(_11/60);
var _13=Math.floor(_11-(_12*60));
var _14=_13>9?_13:"0"+_13;
var _15=0;
if(!_6("ie")){
_15+=_3.get(this.handles.fullScreen,"width")+_3.get(this.handles.fullScreen,"marginRight")+_3.get(this.handles.fullScreen,"marginLeft");
}
_15+=_3.get(this.handles.volumeBar,"width")+_3.get(this.handles.volumeBar,"marginRight")+_3.get(this.handles.volumeBar,"marginLeft");
_15+=_3.get(this.handles.volume,"width")+_3.get(this.handles.volume,"marginRight")+_3.get(this.handles.volume,"marginLeft");
_15+=_3.get(this.handles.durationTime,"width")+_3.get(this.handles.durationTime,"marginRight")+_3.get(this.handles.durationTime,"marginLeft");
_15+=_3.get(this.handles.controlsLineBreak,"width")+_3.get(this.handles.controlsLineBreak,"marginRight")+_3.get(this.handles.controlsLineBreak,"marginLeft");
_15+=_3.get(this.handles.currentTime,"width")+_3.get(this.handles.currentTime,"marginRight")+_3.get(this.handles.currentTime,"marginLeft");
totalWidth=_3.get(this.handles.controlBar,"width");
rightWidth=_3.get(this.handles.rightColumn,"width");
leftWidth=_3.get(this.handles.leftColumn,"width");
_3.set(this.handles.rightColumn,"width",_15+10+"px");
_3.set(this.handles.centerColumn,"width",(totalWidth-leftWidth-rightWidth-1)+"px");
this.handles.focusOnSeekContainer.setAttribute("aria-valuemax",this.handles.html5vid.duration);
this.handles.focusOnSeekContainer.setAttribute("aria-valuenow",this.handles.html5vid.currentTime);
return _12+":"+_14;
},getHandles:function(){
return this.handles;
},ariaTimeFormat:function(sec){
var m=Math.floor(sec/60)<10?""+Math.floor(sec/60):Math.floor(sec/60);
var s=Math.floor(sec-(m*60))<10?""+Math.floor(sec-(m*60)):Math.floor(sec-(m*60));
var _16;
var min="minutes";
var sec="seconds";
if(m==1){
min="minute";
}
if(s==1){
sec="second";
}
if(m!=0){
_16=m+" "+min+" "+s+" "+sec;
}else{
_16=s+" "+sec;
}
return _16;
},recalculateVideoSize:function(_17){
if(_17){
this.handles.html5vid.width=_17;
}
var _18=Math.ceil((this.handles.html5vid.videoHeight*this.handles.html5vid.width)/this.handles.html5vid.videoWidth);
this.handles.html5vid.height=_18;
this.originalVideoHeight=this.handles.html5vid.height;
this.originalVideoWidth=this.handles.html5vid.width;
if(this.handles.playOverlay){
this.handles.playOverlayWrapper.style.top=(_18/2)-(_3.get(this.handles.playOverlay,"height")/2)+"px";
}
_3.set(this.handles.videoWrapper,"height",_18+"px");
if(this.handles.html5vid.duration>=0&&this.handles.html5vid.duration!=Number.POSITIVE_INFINITY){
var _19=this.formatTime(this.handles.html5vid.duration);
this.handles.durationTime.innerHTML=_19;
}
this.handles.html5vid.volume=this.initVolume;
this.handles.focusOnVolume.setAttribute("aria-valuenow",this.initVolume);
},play:function(){
_3.set(this.handles.playButton,"display","none");
_3.set(this.handles.pauseButton,"display","block");
if(this.handles.html5vid.currentTime==this.handles.html5vid.duration){
this.handles.html5vid.currentTime=0;
}
if(this.handles.poster){
_7.destroy(this.handles.poster);
this.handles.poster=null;
}
this.handles.html5vid.play();
this.isPlaying=true;
},pause:function(){
_3.set(this.handles.playButton,"display","block");
_3.set(this.handles.pauseButton,"display","none");
this.handles.html5vid.pause();
this.isPlaying=false;
},mute:function(){
var _1a=this;
_3.set(_1a.handles.volumeSlideKnob,"width",0+"px");
_1a.lastVolumeValue=_1a.handles.html5vid.volume;
_1a.handles.html5vid.volume=0;
_1a.handles.html5vid.muted=true;
this.handles.focusOnVolume.setAttribute("aria-valuenow",_1a.handles.html5vid.volume);
_3.set(_1a.handles.volume,"display","none");
_3.set(_1a.handles.mute,"display","block");
this.isMuted=true;
},unmute:function(){
var _1b=this;
var _1c=this.lastVolumeValue*this.volumeWidth;
_3.set(_1b.handles.volumeSlideKnob,"width",_1c+"px");
_1b.handles.html5vid.volume=_1b.lastVolumeValue;
_1b.handles.html5vid.muted=false;
this.handles.focusOnVolume.setAttribute("aria-valuenow",_1b.handles.html5vid.volume);
_3.set(_1b.handles.mute,"display","none");
_3.set(_1b.handles.volume,"display","block");
this.isMuted=false;
},fullScreen:function(){
if(_6("ie")){
return;
}
if(this.handles.poster){
this.play();
}
_3.set(this.handles.fullScreen,"display","none");
_3.set(this.handles.collapse,"display","block");
if(this.handles.videoWrapper.requestFullScreen){
this.handles.videoWrapper.requestFullScreen();
}else{
if(this.handles.videoWrapper.webkitRequestFullScreen){
this.handles.videoWrapper.webkitRequestFullScreen(this.handles.videoWrapper.ALLOW_KEYBOARD_INPUT);
_3.set(this.handles.videoWrapper,{"position":"fixed","width":screen.width+"px","height":screen.height+"px"});
}else{
if(this.handles.videoWrapper.mozRequestFullScreen){
this.handles.videoWrapper.mozRequestFullScreen();
}
}
}
_3.set(this.handles.html5vid,{"width":screen.width+"px","height":screen.height+"px"});
_3.set(this.handles.controlBar,"width","100%");
this.formatTime(this.handles.html5vid.currentTime);
var _1d=Math.floor((this.handles.html5vid.currentTime/this.handles.html5vid.duration)*_3.get(this.handles.seekContainer,"width"));
_3.set(this.handles.seekBar,"width",_1d+"px");
var _1e=Math.floor((this.handles.html5vid.buffered.end(0)/this.handles.html5vid.duration)*_3.get(this.handles.seekContainer,"width"));
_3.set(this.handles.bufferBar,"width",_1e+"px");
if(this.isA11y){
var _1f=null;
if(!_2.byId("BarDiv")){
_1f=_7.create("div",{id:"BarDiv"},this.hadles.seekBar);
}else{
_1f=_2.byId("BarDiv");
}
_7.empty("BarDiv");
var _20=_3.get(this.handles.seekContainer,"width");
var _21=Math.floor(_20/4.16);
for(var i=1;i<=_21;i++){
var _22=4.16*i;
_7.create("div",{id:"bar"+i,className:"",style:{position:"absolute",marginLeft:_22+"px",display:"none"},innerHTML:"|"},_1f);
}
}
this.isFullScreen=true;
},collapse:function(){
if(_6("ie")){
return;
}
_3.set(this.handles.collapse,"display","none");
_3.set(this.handles.fullScreen,"display","block");
if(document.cancelFullScreen){
document.cancelFullScreen();
}else{
if(document.webkitCancelFullScreen){
document.webkitCancelFullScreen();
_3.set(this.handles.videoWrapper,{"position":"relative","width":this.originalVideoWidth+"px","height":this.originalVideoHeight+"px"});
}else{
if(document.mozCancelFullScreen){
document.mozCancelFullScreen();
}
}
}
_3.set(this.handles.html5vid,{"width":this.originalVideoWidth+"px","height":this.originalVideoHeight+"px"});
_3.set(this.handles.controlBar,"width","100%");
this.formatTime(this.handles.html5vid.currentTime);
var _23=Math.floor((this.handles.html5vid.currentTime/this.handles.html5vid.duration)*_3.get(this.handles.seekContainer,"width"));
_3.set(this.handles.seekBar,"width",_23+"px");
var _24=Math.floor((this.handles.html5vid.buffered.end(0)/this.handles.html5vid.duration)*_3.get(this.handles.seekContainer,"width"));
_3.set(this.handles.bufferBar,"width",_24+"px");
if(this.isA11y){
var _25=_3.get(this.handles.seekContainer,"width");
var _26=Math.floor(_25/4.16);
var _27=null;
if(!_2.byId("BarDiv")){
_27=_7.create("div",{id:"BarDiv"},this.hadles.seekBar);
}else{
_27=_2.byId("BarDiv");
}
_7.empty("BarDiv");
for(var i=1;i<=_26;i++){
var _28=4.16*i;
_7.create("div",{id:"bar"+i,className:"",style:{position:"absolute",marginLeft:_28+"px",display:"none"},innerHTML:"|"},_27);
}
}
this.isFullScreen=false;
},showControls:function(){
_3.set(this.handles.controlBar,"opacity","0.9");
var _29=this;
if(_29.controlsTimedOut==false){
if(_29.timeOutHandle!=null){
clearTimeout(_29.timeOutHandle);
}
_29.timeOutHandle=setTimeout(function(){
if(!_29.isFocused&&!_29.isOverControlBar){
_1._fade({node:_29.handles.controlBar,start:0.9,end:0,duration:250}).play();
_29.controlsTimedOut=true;
_29.timeOutHandle=null;
}else{
_29.showControls();
}
},3000);
}else{
_1._fade({node:_29.handles.controlBar,start:0,end:0.9,duration:250}).play();
if(_29.controlsTimedOut==null){
_29.timeOutHandle=setTimeout(function(){
_1._fade({node:_29.handles.controlBar,start:0.9,end:0,duration:250}).play();
_29.controlsTimedOut=true;
_29.timeOutHandle=null;
},3000);
}
_29.controlsTimedOut=false;
}
},connectVideoEventListeners:function(){
var _2a=this;
on(this.handles.html5vid,"loadedmetadata",function(){
_2a.recalculateVideoSize();
});
on(this.handles.poster,"click",function(){
_2a.play();
});
on(this.handles.controlBar,"mouseover",function(){
_2a.isOverControlBar=true;
});
on(this.handles.controlBar,"mouseout",function(){
_2a.isOverControlBar=false;
});
on(this.handles.html5vid,"click",function(){
if(!_2a.isPlaying){
_2a.play();
}else{
_2a.pause();
}
});
on(this.handles.videoWrapper,"keydown",function(e){
_2a.showControls();
if(e.charCode==32||e.keyCode==32){
if(_2a.playing){
_3.set(_2a.handles.playButton,"display","block");
_3.set(_2a.handles.pauseButton,"display","none");
_2a.handles.html5vid.pause();
_2a.playing=false;
}else{
_3.set(_2a.handles.playButton,"display","none");
_3.set(_2a.handles.pauseButton,"display","block");
if(_2a.handles.html5vid.currentTime==_2a.handles.html5vid.duration){
_2a.handles.html5vid.currentTime=0;
}
_2a.handles.html5vid.play();
_2a.playing=true;
}
e.preventDefault();
e.stopPropagation();
}else{
if(e.charCode==39||e.keyCode==39){
if(_2a.handles.html5vid.duration>=0&&_2a.handles.html5vid.duration!=Number.POSITIVE_INFINITY){
var _2b=_2a.handles.html5vid.currentTime+3;
if(_2a.handles.html5vid.duration>_2b){
_2a.handles.focusOnSeekContainer.setAttribute("aria-valuenow",parseInt(_2b));
if(Number.POSITIVE_INFINITY!=_2a.handles.html5vid.duration){
_2a.handles.focusOnSeekContainer.setAttribute("aria-valuetext","video slider "+(Math.round(_2b/_2a.handles.html5vid.duration*100)+"%"));
}else{
_2a.handles.focusOnSeekContainer.setAttribute("aria-valuetext","video slider "+_2a.ariaTimeFormat(_2b));
}
_2a.handles.html5vid.currentTime=_2b;
}else{
_2a.handles.html5vid.currentTime=_2a.handles.html5vid.duration;
}
}
e.preventDefault();
e.stopPropagation();
}else{
if(e.charCode==37||e.keyCode==37){
var _2b=_2a.handles.html5vid.currentTime-3;
if(_2b<0){
_2b=0;
}
_2a.handles.focusOnSeekContainer.setAttribute("aria-valuenow",parseInt(_2b));
if(Number.POSITIVE_INFINITY!=_2a.handles.html5vid.duration){
_2a.handles.focusOnSeekContainer.setAttribute("aria-valuetext","video slider "+(Math.round(_2b/_2a.handles.html5vid.duration*100)+"%"));
}else{
_2a.handles.focusOnSeekContainer.setAttribute("aria-valuetext","video slider "+_2a.ariaTimeFormat(_2b));
}
_2a.handles.html5vid.currentTime=_2b;
e.preventDefault();
e.stopPropagation();
}else{
if(e.charCode==38||e.keyCode==38){
var _2c=null;
if(document.activeElement==_2a.handles.volume){
_2c=_2a.handles.volume;
}else{
if(document.activeElement==_2a.handles.mute){
_2c=_2a.handles.mute;
}
}
var _2d=_2a.handles.html5vid.volume;
_2d+=0.05;
if(_2d>1){
_2d=1;
}
_2a.handles.focusOnVolume.setAttribute("aria-valuetext","volume slider "+(Math.round(_2d*100)+"%"));
_2a.handles.html5vid.volume=_2d;
_2a.handles.focusOnVolume.setAttribute("aria-valuenow",_2a.handles.html5vid.volume);
_2a.handles.html5vid.muted=false;
_1.animateProperty({node:_2a.handles.volumeSlideKnob,properties:{width:(_2a.handles.html5vid.volume*_2a.volumeWidth)},duration:100}).play();
if(_2a.isMuted){
_3.set(_2a.handles.mute,"display","none");
_3.set(_2a.handles.volume,"display","block");
_2a.isMuted=false;
}
if(_2c){
_2a.handles.volume.focus();
}
e.preventDefault();
e.stopPropagation();
}else{
if(e.charCode==40||e.keyCode==40){
var _2c=null;
if(document.activeElement==_2a.handles.volume){
_2c=_2a.handles.volume;
}else{
if(document.activeElement==_2a.handles.mute){
_2c=_2a.handles.mute;
}
}
var _2d=_2a.handles.html5vid.volume;
_2d-=0.05;
if(_2d<=0.075){
_2a.mute();
_2a.handles.focusOnVolume.setAttribute("aria-valuetext","volume slider 0%");
if(_2c){
_2a.handles.mute.focus();
}
}else{
_2a.handles.focusOnVolume.setAttribute("aria-valuetext","volume slider "+(Math.round(_2d*100)+"%"));
_2a.handles.html5vid.volume=_2d;
_2a.handles.html5vid.muted=false;
_2a.handles.focusOnVolume.setAttribute("aria-valuenow",_2a.handles.html5vid.volume);
_1.animateProperty({node:_2a.handles.volumeSlideKnob,properties:{width:(_2a.handles.html5vid.volume*_2a.volumeWidth)},duration:100,onEnd:function(){
_3.set(_2a.handles.mute,"display","none");
_3.set(_2a.handles.volume,"display","block");
_2a.isMuted=false;
}}).play();
if(_2c){
_2a.handles.volume.focus();
}
e.preventDefault();
e.stopPropagation();
}
}else{
if(e.charCode==102||e.keyCode==102){
_2a.fullScreen();
_2a.connectFullScreenListeners();
e.preventDefault();
e.stopPropagation();
}
}
}
}
}
}
});
on(this.handles.html5vid,"timeupdate",function(){
try{
var _2e=Math.floor((_2a.handles.html5vid.currentTime/_2a.handles.html5vid.duration)*_8.position(_2a.handles.seekContainer).w);
_1.animateProperty({node:_2a.handles.seekBar,properties:{width:_2e},duration:10}).play();
var _2f=Math.floor((_2a.handles.html5vid.buffered.end(0)/_2a.handles.html5vid.duration)*_8.position(_2a.handles.seekContainer).w);
_1.animateProperty({node:_2a.handles.bufferBar,properties:{width:_2f},duration:10}).play();
if(this.isA11y){
var _30=Math.round(_2e/4.16);
var _31=_3.get(_2a.handles.seekContainer,"width");
var _32=Math.round(_31/4.16);
for(var i=1;i<=_30;i++){
if(_2.byId("bar"+i)){
_2.byId("bar"+i).style.display="block";
}else{
var _33=4.16*i;
_7.create("div",{id:"bar"+i,className:"",style:{position:"absolute",marginLeft:_33+"px",display:"block"},innerHTML:"|"},_2.byId("BarDiv"));
}
}
for(var i=_30+1;i<_32;i++){
if(_2.byId("bar"+i)){
_2.byId("bar"+i).style.display="none";
}else{
var _33=4.16*i;
_7.create("div",{id:"bar"+i,className:"",style:{position:"absolute",marginLeft:_33+"px",display:"none"},innerHTML:"|"},_2.byId("BarDiv"));
}
}
}
}
catch(err){
console.log("Time update error: "+err);
}
if(_2a.handles.html5vid.currentTime>=0){
var _34=_2a.formatTime(_2a.handles.html5vid.currentTime);
_2a.handles.currentTime.innerHTML=_34;
}
if(_2a.handles.html5vid.duration>=0&&_2a.handles.html5vid.duration!=Number.POSITIVE_INFINITY){
var _34=_2a.formatTime(_2a.handles.html5vid.duration);
_2a.handles.durationTime.innerHTML=_34;
}
});
on(this.handles.videoWrapper,"mouseout",function(e){
var _35=e.pageX;
var _36=e.pageY;
var _37=_8.position(_2a.handles.videoWrapper,true);
if(_35<=_37.x||_35>=(_37.x+_37.w)||_36<=_37.y||_36>=(_37.y+_37.h)){
if(!_2a.isFocused){
_1._fade({node:_2a.handles.controlBar,start:0.9,end:0,duration:250}).play();
_2a.controlsTimedOut=null;
clearTimeout(_2a.timeOutHandle);
}
if(_2a.handles.playOverlay){
_2a.handles.playOverlay.style.display="block";
_2a.handles.playOverlay_hover.style.display="none";
}
}
});
on(this.handles.videoWrapper,"mousemove",function(e){
_2a.showControls();
if(_2a.handles.playOverlay){
_2a.handles.playOverlay.style.display="none";
_2a.handles.playOverlay_hover.style.display="block";
}
});
on(this.handles.html5vid,"ended",function(){
_3.set(_2a.handles.playButton,"display","block");
_3.set(_2a.handles.pauseButton,"display","none");
_2a.playing=false;
});
},connectControlEventListeners:function(){
var _38=this;
this.firstFocus=false;
if(this.prevId){
on(_2.byId(this.prevId),"keypress",function(e){
if(e.keyCode==9&&!e.shiftKey){
if(this.firstFocus){
if(_38.handles.playButton.style.display=="block"){
_38.handles.playButton.focus();
}else{
_38.handles.pauseButton.focus();
}
this.firstFocus=false;
}else{
this.firstFocus=true;
}
e.preventDefault();
}
});
}
if(this.nextId){
on(_2.byId(this.nextId),"keypress",function(e){
if(e.keyCode==9&&e.shiftKey){
if(!_38.isFullScreen){
_38.handles.fullScreen.focus();
}else{
_38.handles.collapse.focus();
}
e.preventDefault();
}
});
}
on(this.handles.playButton,"click",function(){
_38.play();
_38.handles.pauseButton.focus();
_5.set(_38.handles.pauseButton,"aria-pressed",true);
});
on(this.handles.playButton,"mousedown",function(e){
e.preventDefault();
});
on(this.handles.playButton,"keypress",function(e){
if(e.keyCode==13){
_38.play();
_38.handles.pauseButton.focus();
_5.set(_38.handles.pauseButton,"aria-pressed",true);
e.preventDefault();
}else{
if(e.keyCode==9){
if(!e.shiftKey){
_38.handles.focusOnSeekContainer.focus();
}else{
_2.byId(_38.prevId).focus();
}
e.preventDefault();
}
}
});
on(this.handles.playButton,"mouseover",function(){
_9.add(_38.handles.playButton,"otherHTML5Player24 otherHTML5Player24-play-hover-16");
});
on(this.handles.playButton,"mouseout",function(){
_9.remove(_38.handles.playButton,"otherHTML5Player24 otherHTML5Player24-play-hover-16");
_9.add(_38.handles.playButton,"otherHTML5Player24 otherHTML5Player24-play-16");
});
on(this.handles.playButton,"focus",function(){
_9.add(_38.handles.playButton,"otherHTML5Player24 otherHTML5Player24-play-hover-16");
_38.showControls();
_38.isFocused=true;
});
on(this.handles.playButton,"blur",function(){
_9.remove(_38.handles.playButton,"otherHTML5Player24 otherHTML5Player24-play-hover-16");
_9.add(_38.handles.playButton,"otherHTML5Player24 otherHTML5Player24-play-16");
_38.isFocused=false;
});
on(this.handles.pauseButton,"click",function(){
_38.pause();
});
on(this.handles.pauseButton,"mousedown",function(e){
e.preventDefault();
});
on(this.handles.pauseButton,"keypress",function(e){
if(e.keyCode==13){
_38.pause();
_38.handles.playButton.focus();
_5.set(_38.handles.pauseButton,"aria-pressed",true);
e.preventDefault();
}else{
if(e.keyCode==9){
if(!e.shiftKey){
_38.handles.focusOnSeekContainer.focus();
e.preventDefault();
}else{
if(_38.prevId){
_2.byId(_38.prevId).focus();
e.preventDefault();
}
}
}
}
});
on(this.handles.pauseButton,"mouseover",function(){
_9.add(_38.handles.pauseButton,"otherHTML5Player24 otherHTML5Player24-pause-hover-16");
});
on(this.handles.pauseButton,"mouseout",function(){
_9.remove(_38.handles.pauseButton,"otherHTML5Player24 otherHTML5Player24-pause-hover-16");
_9.add(_38.handles.pauseButton,"otherHTML5Player24 otherHTML5Player24-pause-16");
});
on(this.handles.pauseButton,"focus",function(){
_9.add(_38.handles.pauseButton,"otherHTML5Player24 otherHTML5Player24-pause-hover-16");
_38.showControls();
_38.isFocused=true;
});
on(this.handles.pauseButton,"blur",function(){
_9.remove(_38.handles.pauseButton,"otherHTML5Player24 otherHTML5Player24-pause-hover-16");
_9.add(_38.handles.pauseButton,"otherHTML5Player24 otherHTML5Player24-pause-16");
_38.isFocused=false;
});
on(this.handles.focusOnSeekContainer,"keypress",function(e){
if(e.keyCode==13){
_38.play();
_38.handles.pauseButton.focus();
e.preventDefault();
}else{
if(e.keyCode==9){
if(!e.shiftKey){
if(!_38.isMuted){
_38.handles.volume.focus();
}else{
_38.handles.mute.focus();
}
}else{
if(_38.handles.playButton.style.display=="block"){
_38.handles.playButton.focus();
}else{
_38.handles.pauseButton.focus();
}
}
e.preventDefault();
}
}
});
on(this.handles.seekContainer,"click",function(e){
try{
var _39=e.pageX;
var _3a=e.pageY;
var _3b=_8.position(_38.handles.seekContainer,true);
if(_39>_3b.x&&_39<(_3b.x+_3b.w)&&_3a>_3b.y&&_3a<(_3b.y+_3b.h)){
var _3c=(_39-_3b.x)/_3b.w;
var _3d=(_38.handles.html5vid.duration*_3c);
var _3e=Math.floor((_3d/_38.handles.html5vid.duration)*_3.get(_38.handles.seekContainer,"width"));
_3.set(_38.handles.seekBar,"width",_3e+"px");
_38.handles.html5vid.currentTime=_3d;
}
}
catch(err){
console.log("Error during seek: "+err);
}
});
on(this.handles.fullScreen,"click",function(){
_38.fullScreen();
_38.handles.collapse.focus();
_5.set(_38.handles.fullScreen,"aria-pressed",true);
_38.connectFullScreenListeners();
});
on(this.handles.fullScreen,"keypress",function(e){
if(e.keyCode==102||e.keyCode==13){
_38.fullScreen();
_38.handles.collapse.focus();
_5.set(_38.handles.fullScreen,"aria-pressed",true);
_38.connectFullScreenListeners();
e.preventDefault();
}else{
if(e.keyCode==9){
if(!e.shiftKey){
if(_38.nextId){
_2.byId(_38.nextId).focus();
e.preventDefault();
}
}else{
_38.handles.focusOnVolume.focus();
e.preventDefault();
}
}
}
});
on(this.handles.fullScreen,"mousedown",function(e){
e.preventDefault();
});
on(this.handles.fullScreen,"mouseover",function(){
_9.add(_38.handles.fullScreen,"otherHTML5Player24 otherHTML5Player24-fullscreen-hover-16");
});
on(this.handles.fullScreen,"mouseout",function(){
_9.remove(_38.handles.fullScreen,"otherHTML5Player24 otherHTML5Player24-fullscreen-hover-16");
_9.add(_38.handles.fullScreen,"otherHTML5Player24 otherHTML5Player24-fullscreen-16");
});
on(this.handles.fullScreen,"focus",function(){
_9.add(_38.handles.fullScreen,"otherHTML5Player24 otherHTML5Player24-fullscreen-hover-16");
_38.showControls();
_38.isFocused=true;
});
on(this.handles.fullScreen,"blur",function(){
_9.remove(_38.handles.fullScreen,"otherHTML5Player24 otherHTML5Player24-fullscreen-hover-16");
_9.add(_38.handles.fullScreen,"  otherHTML5Player24 otherHTML5Player24-fullscreen-16");
_38.isFocused=false;
});
on(this.handles.collapse,"click",function(){
_38.collapse();
_38.handles.fullScreen.focus();
_5.set(_38.handles.collapse,"aria-pressed",true);
_38.disconnectFullScreenListeners();
});
on(this.handles.collapse,"keypress",function(e){
if(e.keyCode==13){
_38.collapse();
_38.handles.fullScreen.focus();
_5.set(_38.handles.collapse,"aria-pressed",true);
_38.disconnectFullScreenListeners();
e.preventDefault();
}else{
if(e.keyCode==9){
if(!e.shiftKey){
if(_38.nextId){
_2.byId(_38.nextId).focus();
e.preventDefault();
}
}else{
_38.handles.focusOnVolume.focus();
e.preventDefault();
}
}
}
});
on(this.handles.collapse,"mouseover",function(){
_9.add(_38.handles.collapse,"otherHTML5Player24 otherHTML5Player24-collapse-hover-16");
});
on(this.handles.collapse,"mouseout",function(){
_9.remove(_38.handles.collapse,"otherHTML5Player24 otherHTML5Player24-collapse-hover-16");
_9.add(_38.handles.collapse,"otherHTML5Player24 otherHTML5Player24-collapse-16");
});
on(this.handles.collapse,"mousedown",function(e){
e.preventDefault();
});
on(this.handles.collapse,"focus",function(){
_9.add(_38.handles.collapse,"otherHTML5Player24 otherHTML5Player24-collapse-hover-16");
_38.showControls();
_38.isFocused=true;
});
on(this.handles.collapse,"blur",function(){
_9.remove(_38.handles.collapse,"otherHTML5Player24 otherHTML5Player24-collapse-hover-16");
_9.add(_38.handles.collapse,"  otherHTML5Player24 otherHTML5Player24-collapse-16");
_38.isFocused=false;
});
},connectVolumeEventListeners:function(){
var _3f=this;
on(this.handles.volume,"focus",function(){
_9.add(_3f.handles.volume,"   otherHTML5Player24 otherHTML5Player24-volume-hover-16");
_3f.isFocused=true;
_3f.showControls();
});
on(this.handles.mute,"focus",function(){
_9.add(_3f.handles.mute,"otherHTML5Player24 otherHTML5Player24-mute-hover-16");
_3f.isFocused=true;
_3f.showControls();
});
on(this.handles.volume,"blur",function(){
_9.remove(_3f.handles.volume,"   otherHTML5Player24 otherHTML5Player24-volume-hover-16");
_9.add(_3f.handles.volume,"otherHTML5Player24 otherHTML5Player24-volume-16");
_3f.isFocused=false;
});
on(this.handles.mute,"blur",function(){
_9.remove(_3f.handles.mute,"otherHTML5Player24 otherHTML5Player24-mute-hover-16");
_9.add(_3f.handles.mute,"otherHTML5Player24 otherHTML5Player24-mute-16");
_3f.isFocused=false;
});
on(this.handles.volume,"mouseover",function(e){
_9.add(_3f.handles.volume,"   otherHTML5Player24 otherHTML5Player24-volume-hover-16");
});
on(this.handles.mute,"mouseover",function(e){
_9.add(_3f.handles.mute,"otherHTML5Player24 otherHTML5Player24-mute-hover-16");
});
on(this.handles.volume,"mouseout",function(e){
_9.remove(_3f.handles.volume,"   otherHTML5Player24 otherHTML5Player24-volume-hover-16");
_9.add(_3f.handles.volume,"   otherHTML5Player24 otherHTML5Player24-volume-16");
});
on(this.handles.mute,"mouseout",function(e){
_9.remove(_3f.handles.mute,"otherHTML5Player24 otherHTML5Player24-mute-hover-16");
_9.add(_3f.handles.mute,"otherHTML5Player24 otherHTML5Player24-mute-16");
});
on(this.handles.volume,"click",function(e){
_3f.mute();
_3f.handles.mute.focus();
_5.set(_3f.handles.volume,"aria-pressed",true);
});
on(this.handles.volume,"mousedown",function(e){
e.preventDefault();
});
on(this.handles.volume,"keypress",function(e){
if(e.keyCode==13){
_3f.mute();
_3f.handles.mute.focus();
_5.set(_3f.handles.volume,"aria-pressed",true);
e.preventDefault();
}else{
if(e.keyCode==9){
if(!e.shiftKey){
if(_6("ie")){
_2.byId(_3f.nextId).focus();
}else{
_3f.handles.focusOnVolume.focus();
}
}else{
_3f.handles.focusOnSeekContainer.focus();
}
e.preventDefault();
}
}
});
on(this.handles.focusOnVolume,"keypress",function(e){
if(e.keyCode==13){
_3f.mute();
_3f.handles.mute.focus();
_5.set(_3f.handles.focusOnVolume,"aria-pressed",true);
e.preventDefault();
}else{
if(e.keyCode==9){
if(!e.shiftKey){
if(_6("ie")||!_3f.allowFullScreen){
_2.byId(_3f.nextId).focus();
}else{
if(!_3f.isFullScreen){
_3f.handles.fullScreen.focus();
}else{
_3f.handles.collapse.focus();
}
}
}else{
if(!_3f.isMuted){
_3f.handles.volume.focus();
}else{
_3f.handles.mute.focus();
}
}
e.preventDefault();
}
}
});
on(this.handles.mute,"click",function(e){
_3f.unmute();
_3f.handles.volume.focus();
_5.set(_3f.handles.mute,"aria-pressed",true);
});
on(this.handles.mute,"mousedown",function(e){
e.preventDefault();
});
on(this.handles.mute,"keypress",function(e){
if(e.keyCode==13){
_3f.unmute();
_3f.handles.volume.focus();
_5.set(_3f.handles.mute,"aria-pressed",true);
e.preventDefault();
}else{
if(e.keyCode==9){
if(!e.shiftKey){
if(_6("ie")){
_3f.nextId.focus();
}else{
_3f.handles.focusOnVolume.focus();
}
}else{
_3f.handles.focusOnSeekContainer.focus();
}
e.preventDefault();
}
}
});
on(_3f.handles.volSlide,"mouseover",function(e){
this.style.cursor="pointer";
});
on(_3f.handles.volSlide,"click",function(e){
var _40=e.pageX;
var _41=e.pageY;
var _42=_8.position(_3f.handles.volSlide,true);
if(_40>_42.x&&_40<(_42.x+_42.w)&&_41>_42.y&&_41<(_42.y+_42.h)){
var _43=(_40-_42.x)/_42.w;
if(_43<0.075){
_3f.mute();
}else{
_3f.isMuted=false;
if(_43>0.925){
_43=1;
}
_3f.handles.html5vid.muted=false;
if(this.isA11y){
var _44=Math.round(_43*10/2);
for(var i=0;i<_44;i++){
var _45=i+1;
_2.byId("volume"+_45).style.display="block";
}
for(var i=_44;i<5;i++){
var _45=i+1;
_2.byId("volume"+_45).style.display="none";
}
}
var _46=_43*_3f.volumeWidth;
_3f.handles.html5vid.volume=_43;
_3.set(_3f.handles.volumeSlideKnob,"width",_46+"px");
_3.set(_3f.handles.mute,"display","none");
_3.set(_3f.handles.volume,"display","block");
}
e.stopPropagation();
e.preventDefault();
_3f.handles.focusOnVolume.focus();
}
});
},connectFullScreenListeners:function(){
var _47=this;
this.fullscreenListeners.fullscreenchange=on(document,"fullscreenchange",function(){
if(_3.get(_47.handles.html5vid,"width")>_47.originalVideoWidth&&!document.fullScreen){
_47.collapse();
_47.disconnectFullScreenListeners();
}
});
this.fullscreenListeners.mozfullscreenchange=on(document,"mozfullscreenchange",function(){
if(_3.get(_47.handles.html5vid,"width")>_47.originalVideoWidth&&!document.mozFullScreen){
_47.collapse();
_47.disconnectFullScreenListeners();
}
});
this.fullscreenListeners.webkitfullscreenchange=on(document,"webkitfullscreenchange",function(){
if(_3.get(_47.handles.html5vid,"width")>_47.originalVideoWidth&&!document.webkitIsFullScreen){
_47.collapse();
_47.disconnectFullScreenListeners();
}
});
},disconnectFullScreenListeners:function(){
if(this.fullscreenListeners.fullscreenchange){
this.disconnect(this.fullscreenListeners.fullscreenchange);
this.fullscreenListeners.fullscreenchange=null;
}
if(this.fullscreenListeners.mozfullscreenchange){
this.disconnect(this.fullscreenListeners.mozfullscreenchange);
this.fullscreenListeners.mozfullscreenchange=null;
}
if(this.fullscreenListeners.webkitfullscreenchange){
this.disconnect(this.fullscreenListeners.webkitfullscreenchange);
this.fullscreenListeners.webkitfullscreenchange=null;
}
},connectPosterEventListeners:function(){
var _48=this;
var _49=_2.byId("HTML5PosterBackground");
on(_49,"click",function(){
_7.destroy(_49);
_48.play();
});
},playVideo:function(_4a,_4b,_4c,_4d,_4e,_4f,_50,_51){
var _52=_4d*0.75;
_4d<=300?this.isMini=true:this.isMini=false;
this.prevId=_4f;
this.nextId=_50;
if(_51!==undefined){
this.allowFullScreen=_51;
}
this.handles.videoWrapper=_7.create("div",{className:"HTML5VideoWrapper",id:"HTML5VideoWrapper_"+this.id,style:{width:_4d+"px",height:_52+"px",position:"relative"}},_4a);
this.handles.html5vid=_7.create("video",{className:"HTML5Video",id:"HTML5Video_"+this.id,tabIndex:"-1",width:_4d+"px",height:_52+"px"},this.handles.videoWrapper);
on(this.handles.html5vid,"error",_d.hitch(this,function(_53){
this.emit("error",_53);
}));
var _54=_7.create("source",{src:_4b,type:"video/mp4"},this.handles.html5vid);
on(_54,"error",_d.hitch(this,function(_55){
this.emit("error",_55);
}));
this.handles.poster=_7.create("div",{className:"HTML5VideoPosterWrapper",id:"HTML5VideoPosterWrapper_"+this.id,style:{width:"100%",height:"100%",position:"absolute"}},this.handles.videoWrapper);
if(_4c){
var _56=_7.create("img",{className:"HTML5VideoPosterImage",id:"HTML5VideoPosterImage_"+this.id,src:_4c,style:{height:"auto",width:"auto",maxHeight:"100%",maxWidth:"100%",display:"block",margin:"auto"}},this.handles.poster);
}
var _57="otherHTML5Player24 otherHTML5Player24-play-overlay-lg";
var _58="otherHTML5Player24 otherHTML5Player24-play-overlay-lg-hover";
var _59=64;
if(this.isMini){
_57="otherHTML5Player16 otherHTML5Player16-play-overlay-sm";
_58="otherHTML5Player16 otherHTML5Player16-play-overlay-sm-hover";
_59=36;
}
var _5a=(_4d/2)-(_59/2)+"px";
var _5b=(_52/2)-(_59/2)+"px";
this.handles.playOverlayWrapper=_7.create("div",{className:"HTML5VideoPosterPlayWrapper",id:"HTML5VideoPosterPlayWrapper_"+this.id,style:{position:"absolute",left:_5a,top:_5b,cursor:"pointer"}},this.handles.poster);
this.handles.playOverlay=_7.create("img",{className:"HTML5VideoPosterPlay "+_57,id:"HTML5VideoPosterPlay_"+this.id,style:{height:_59+"px",width:_59+"px",display:"block"}},this.handles.playOverlayWrapper);
this.handles.playOverlay_hover=_7.create("img",{className:"HTML5VideoPosterPlay_hover "+_58,id:"HTML5VideoPosterPlay_hover_"+this.id,style:{height:_59+"px",width:_59+"px",display:"none"}},this.handles.playOverlayWrapper);
this.handles.controlBar=_7.create("div",{className:"HTML5VideoControlWrapper",id:"HTML5VideoControlWrapper_"+this.id,style:{width:_4d+"px"}},this.handles.videoWrapper);
this.handles.leftColumn=_7.create("div",{className:"HTML5VideoControlsLeft HTML5VideoColumn",id:"HTML5VideoControlsLeft_"+this.id},this.handles.controlBar);
if(this.isA11y){
this.handles.playButton=_7.create("a",{title:this.nls.videoPlayer.playButton,href:"javascript:;",alt:"Play",role:"button",className:"HTML5VideoPlay HTML5VideoControls otherHTML5Player24 otherHTML5Player24-play-16",id:"HTML5VideoPlay_"+this.id,innerHTML:"<span class=\"html5HighContrastThreeLine\">"+this.nls.videoPlayer.playButton+"</span>"},this.handles.leftColumn);
}else{
this.handles.playButton=_7.create("a",{title:this.nls.videoPlayer.playButton,href:"javascript:;",alt:"Play",role:"button",className:"HTML5VideoPlay HTML5VideoControls otherHTML5Player24 otherHTML5Player24-play-16",id:"HTML5VideoPlay_"+this.id},this.handles.leftColumn);
}
_5.set(this.handles.playButton,"aria-pressed",true);
if(this.isA11y){
this.handles.pauseButton=_7.create("a",{title:this.nls.videoPlayer.pauseButton,href:"javascript:;",alt:"Pause",role:"button",className:"HTML5VideoPause HTML5VideoControls otherHTML5Player24 otherHTML5Player24-pause-16",id:"HTML5VideoPause_"+this.id,innerHTML:"<span class=\"html5HighContrastThreeLine\">"+this.nls.videoPlayer.pauseButton+"</span>"},this.handles.leftColumn);
}else{
this.handles.pauseButton=_7.create("a",{title:this.nls.videoPlayer.pauseButton,href:"javascript:;",alt:"Pause",role:"button",className:"HTML5VideoPause HTML5VideoControls otherHTML5Player24 otherHTML5Player24-pause-16",id:"HTML5VideoPause_"+this.id},this.handles.leftColumn);
}
this.handles.centerColumn=_7.create("div",{className:"HTML5VideoControlsCenter HTML5VideoColumn",id:"HTML5VideoControlsCenter_"+this.id},this.handles.controlBar);
this.handles.focusOnSeekContainer=_7.create("a",{className:"HTML5OnFocus",role:"slider",href:"javascript:;",style:"width:100%;height:100%;display:block"},this.handles.centerColumn);
this.handles.focusOnSeekContainer.setAttribute("aria-valuemin","0:00");
this.handles.seekContainer=_7.create("div",{title:this.nls.videoPlayer.scrubBar,className:"HTML5VideoSlider HTML5VideoControls",id:"HTML5VideoSlider_"+this.id},this.handles.focusOnSeekContainer);
this.handles.bufferBar=_7.create("div",{className:"HTML5VideoBuffer",id:"HTML5VideoBuffer_"+this.id},this.handles.seekContainer);
this.handles.seekBar=_7.create("div",{className:"HTML5VideoKnob",id:"HTML5VideoKnob_"+this.id},this.handles.seekContainer);
if(this.isA11y){
var _5c=_3.get(this.handles.seekContainer,"width");
var _5d=Math.floor(_5c/4.16);
var _5e=_7.create("div",{id:"BarDiv"},this.handles.seekBar);
_7.empty("BarDiv");
for(var i=1;i<=_5d;i++){
var _5f=4.16*i;
_7.create("div",{id:"bar"+i,className:"",style:{position:"absolute",marginLeft:_5f+"px",display:"none"},innerHTML:"|"},_5e);
}
}
this.handles.rightColumn=_7.create("div",{className:"HTML5VideoControlsRight HTML5VideoColumn",id:"HTML5VideoControlsRight_"+this.id},this.handles.controlBar);
this.handles.currentTime=_7.create("span",{title:this.nls.videoPlayer.currentTimeDisplay,className:"HTML5VideoCurrentTime HTML5VideoText",id:"HTML5VideoCurrentTime_"+this.id,innerHTML:"--:--"},this.handles.rightColumn);
this.handles.controlsLineBreak=_7.create("div",{className:"HTML5VideoControlsLineBreak",id:"HTML5VideoControlsLineBreak_"+this.id},this.handles.rightColumn);
this.handles.durationTime=_7.create("span",{title:this.nls.videoPlayer.timeDuration,className:"HTML5VideoDuration HTML5VideoText",id:"HTML5VideoDuration_"+this.id,innerHTML:"--:--"},this.handles.rightColumn);
if(this.isA11y){
this.handles.volume=_7.create("a",{title:this.nls.videoPlayer.volumeButton,href:"javascript:;",alt:"Mute",role:"button",className:"HTML5VideoVolume HTML5VideoControls otherHTML5Player24 otherHTML5Player24-volume-16",id:"HTML5VideoVolume_"+this.id,innerHTML:"<span class=\"html5HighContrastThreeLine\">"+this.nls.videoPlayer.volumeButton+"</span>"},this.handles.rightColumn);
_3.set(this.handles.volume,"display","block");
}else{
this.handles.volume=_7.create("a",{title:this.nls.videoPlayer.volumeButton,href:"javascript:;",alt:"Mute",role:"button",className:"HTML5VideoVolume HTML5VideoControls otherHTML5Player24 otherHTML5Player24-volume-16",id:"HTML5VideoVolume_"+this.id},this.handles.rightColumn);
}
if(this.isA11y){
this.handles.mute=_7.create("a",{title:this.nls.videoPlayer.muteButton,href:"javascript:;",alt:"Unmute",role:"button",className:"HTML5VideoMute HTML5VideoControls otherHTML5Player24 otherHTML5Player24-mute-16",id:"HTML5VideoMute_"+this.id,innerHTML:"<span class=\"html5HighContrastThreeLine\">"+this.nls.videoPlayer.muteButton+"</span>"},this.handles.rightColumn);
}else{
this.handles.mute=_7.create("a",{title:this.nls.videoPlayer.muteButton,href:"javascript:;",alt:"Unmute",role:"button",className:"HTML5VideoMute HTML5VideoControls otherHTML5Player24 otherHTML5Player24-mute-16",id:"HTML5VideoMute_"+this.id},this.handles.rightColumn);
}
this.handles.volumeBar=_7.create("div",{title:this.nls.videoPlayer.volumeBar,className:"HTML5VideoVolumeBar",id:"HTML5VideoVolumeBar_"+this.id},this.handles.rightColumn);
this.handles.focusOnVolume=_7.create("a",{className:"HTML5OnFocus",href:"javascript:;",role:"slider",style:"width:100%;height:100%;display:block"},this.handles.volumeBar);
this.handles.focusOnVolume.setAttribute("aria-valuemin","0");
this.handles.focusOnVolume.setAttribute("aria-valuemax","1");
this.handles.volSlide=_7.create("div",{className:"HTML5VideoVolSlide",id:"HTML5VideoVolSlide_"+this.id},this.handles.focusOnVolume);
this.handles.volumeSlideKnob=_7.create("div",{className:"HTML5VideoVolumeKnob",id:"HTML5VideoVolumeKnob_"+this.id},this.handles.volSlide);
if(this.isA11y){
var _60=_7.create("div",{id:"volume1",className:"",style:{position:"absolute",marginLeft:"5.2px"},innerHTML:"|"},this.handles.volSlide);
var _61=_7.create("div",{id:"volume2",className:"",style:{position:"absolute",marginLeft:"10.4px"},innerHTML:"|"},this.handles.volSlide);
var _62=_7.create("div",{id:"volume3",className:"",style:{position:"absolute",marginLeft:"15.6px"},innerHTML:"|"},this.handles.volSlide);
var _63=_7.create("div",{id:"volume4",className:"",style:{display:"none",position:"absolute",marginLeft:"20.8px"},innerHTML:"|"},this.handles.volSlide);
var _64=_7.create("div",{id:"volume5",className:"",style:{display:"none",position:"absolute",marginLeft:"26px"},innerHTML:"|"},this.handles.volSlide);
}else{
var _60=_7.create("div",{className:"HTML5VideoVolumeWindow"},this.handles.volSlide);
var _65=_7.create("div",{className:"HTML5VideoVolumeDivider",style:{marginLeft:"3px"}},this.handles.volSlide);
var _61=_7.create("div",{className:"HTML5VideoVolumeWindow",style:{marginLeft:"5px"}},this.handles.volSlide);
var _66=_7.create("div",{className:"HTML5VideoVolumeDivider",style:{marginLeft:"8px"}},this.handles.volSlide);
var _62=_7.create("div",{className:"HTML5VideoVolumeWindow",style:{marginLeft:"10x"}},this.handles.volSlide);
var _67=_7.create("div",{className:"HTML5VideoVolumeDivider",style:{marginLeft:"13px"}},this.handles.volSlide);
var _63=_7.create("div",{className:"HTML5VolumeWindow",style:{marginLeft:"15px"}},this.handles.volSlide);
var _68=_7.create("div",{className:"HTML5VideoVolumeDivider",style:{marginLeft:"18px"}},this.handles.volSlide);
var _64=_7.create("div",{className:"HTML5VideoVolumeWindow",style:{marginLeft:"20px"}},this.handles.volSlide);
var _69=_7.create("div",{className:"HTML5VideoVolumeDivider",style:{marginLeft:"23px"}},this.handles.volSlide);
var _6a=_7.create("div",{className:"HTML5VideoVolumeWindow",style:{marginLeft:"25px"}},this.handles.volSlide);
}
if(!_6("ie")&&this.allowFullScreen){
if(this.isA11y){
this.handles.fullScreen=_7.create("a",{title:this.nls.videoPlayer.fullScreenButton,href:"javascript:;",role:"button",alt:"Enter full screen mode",className:"HTML5VideoFullScreen HTML5VideoControls otherHTML5Player24 otherHTML5Player24-fullscreen-16",id:"HTML5VideoFullScreen_"+this.id,innerHTML:"<span class=\"html5HighContrast\">"+this.nls.videoPlayer.fullScreenButton+"</span>"},this.handles.rightColumn);
_3.set(this.handles.fullScreen,"display","block");
}else{
this.handles.fullScreen=_7.create("a",{title:this.nls.videoPlayer.fullScreenButton,href:"javascript:;",role:"button",alt:"Enter full screen mode",className:"HTML5VideoFullScreen HTML5VideoControls otherHTML5Player24 otherHTML5Player24-fullscreen-16",id:"HTML5VideoFullScreen_"+this.id},this.handles.rightColumn);
}
if(this.isA11y){
this.handles.collapse=_7.create("a",{title:this.nls.videoPlayer.collapseButton,href:"javascript:;",role:"button",alt:"Exit full screen mode",className:"HTML5VideoCollapse HTML5VideoControls otherHTML5Player24 otherHTML5Player24-collapse-16",id:"HTML5VideoCollapse_"+this.id,innerHTML:"<span class=\"html5HighContrast\">"+this.nls.videoPlayer.collapseButton+"</span>"},this.handles.rightColumn);
}else{
this.handles.collapse=_7.create("a",{title:this.nls.videoPlayer.collapseButton,href:"javascript:;",role:"button",alt:"Exit full screen mode",className:"HTML5VideoCollapse HTML5VideoControls otherHTML5Player24 otherHTML5Player24-collapse-16",id:"HTML5VideoCollapse_"+this.id},this.handles.rightColumn);
}
_3.set(this.handles.collapse,"display","none");
}
if(this.removeAccessibility){
this.handles.playButton.title="";
this.handles.playButton.innerHTML="";
this.handles.playButton.alt="";
this.handles.pauseButton.title="";
this.handles.pauseButton.innerHTML="";
this.handles.pauseButton.alt="";
this.handles.seekContainer.title="";
this.handles.currentTime.title="";
this.handles.durationTime.title="";
this.handles.volume.title="";
this.handles.volume.innerHTML="";
this.handles.volume.alt="";
this.handles.mute.title="";
this.handles.mute.alt="";
this.handles.innerHTML="";
this.handles.fullScreen.title="";
this.handles.fullScreen.innerHTML="";
this.handles.fullScreen.alt="";
this.handles.collapse.title="";
this.handles.collapse.alt="";
this.handles.collapse.innerHtml="";
this.handles.volumeBar.title="";
}else{
_5.set(this.handles.playButton,"aria-label","Play");
_5.set(this.handles.pauseButton,"aria-label","Pause");
_5.set(this.handles.focusOnSeekContainer,"aria-label","video slider");
_5.set(this.handles.volume,"aria-label","Mute");
_5.set(this.handles.mute,"aria-label","Unmute");
_5.set(this.handles.focusOnVolume,"aria-label","volume slider");
_5.set(this.handles.fullScreen,"aria-label","Enter full screen mode");
_5.set(this.handles.collapse,"aria-label","Exit full screen mode");
}
this.connectVideoEventListeners();
this.connectControlEventListeners();
this.connectVolumeEventListeners();
this.play();
this.mute();
}});
return _10;
});


;define("ic-share/fileviewer/video/util/MediaUri",["dojo","dojo/_base/lang","dojo/has"],function(_1,_2,_3){
return {parseUri:function(_4){
if(!_4){
return null;
}
_4=new _1._Url(_4);
var _5=this.getRequestParameters(_4);
_4.queryParameters=_5;
return _4;
},writeUri:function(_6){
if(!_6){
return null;
}
var _7="";
if(_6.scheme){
_7+=_6.scheme+":";
}
if(_6.authority){
_7+="//"+_6.authority;
}
if(_6.path){
_7+=_6.path;
}
if(_6.queryParameters){
_7+=this.writeParameters(_6.queryParameters);
}else{
if(_6.query){
_7+=((_6.query.charAt(0)!="?")?"?":"")+_6.query;
}
}
if(_6.fragment){
_7+="#"+_6.fragment;
}
return _7;
},makeAtomUrlIESafe:function(_8){
if(_3("ie")&&_8){
_8=this.parseUri(_8);
_8.queryParameters.format="xml";
_8=this.writeUri(_8);
}
return _8;
},rewriteUriProxyOnly:function(iw,_9){
if(iw&&!iw.overrideCommonProxy&&((iw.communitiesSvcRef||ic_comm_communitiesSvcRef)&&iw.useCommonProxy||iw.isDocSummary&&iw.isDocSummary())){
var _a=function(_b){
return _b=="https"?443:80;
};
var _c=window.location.protocol=="https:"&&lconn.core.config.services.deploymentConfig.secureEnabled?lconn.core.config.services.deploymentConfig.secureUrl:lconn.core.config.services.deploymentConfig.url;
var _d=_c+"/proxy/commonProxy";
var _e=this.parseUri(_d).path;
if(_e.charAt(_e.length-1)=="/"){
_e=_e.substring(0,_e.length-1);
}
var _f=window.location;
var _10=_f.hostname.toLowerCase()||localhost;
var _11=(_f.protocol||"http").replace(":","");
var _12=_f.port||_a(_11);
var uri=new _1._Url(_9);
var _13=uri.host;
if(_13){
_13=_13.toLowerCase();
var _14=uri.scheme||_11;
var _15=uri.port||_a(_14);
if(_14!=_11||_15!=_12||_13!=_10){
return (iw.useFullCommonProxyPath?_d:_e)+"/"+_14+"/"+encodeURIComponent(_13+":"+_15)+(uri.path||"")+(uri.query?("?"+uri.query):"");
}
}
return _9;
}else{
_9=iw.iContext.io.rewriteURI(_9);
}
return _9;
},rewriteUri:function(url,p,_16,iw){
if(url&&p){
url=this.parseUri(url);
_2.mixin(url.queryParameters,p);
url=this.writeUri(url);
}
if(_16&&url){
if(iw){
url=this.rewriteUriProxyOnly(iw,url);
}else{
console.log("Missing iw param in rewriteUri: "+url);
}
}
return url;
},splitQuery:function(_17){
var _18={};
if(!_17){
return _18;
}
if(_17.charAt(0)=="?"){
_17=_17.substring(1);
}
var _19=_17.split("&");
for(var i=0;i<_19.length;i++){
if(_19[i].length>0){
var _1a=_19[i].indexOf("=");
if(_1a==-1){
var key=decodeURIComponent(_19[i]);
var _1b=_18[key];
if(_2.isArray(_1b)){
_1b.push("");
}else{
if(_1b){
_18[key]=[_1b,""];
}else{
_18[key]="";
}
}
}else{
if(_1a>0){
var key=decodeURIComponent(_19[i].substring(0,_1a));
var _1c=decodeURIComponent(_19[i].substring(_1a+1));
var _1b=_18[key];
if(_2.isArray(_1b)){
_1b.push(_1c);
}else{
if(_1b){
_18[key]=[_1b,_1c];
}else{
_18[key]=_1c;
}
}
}
}
}
}
return _18;
},removeQuery:function(uri){
if(uri){
var ind=uri.indexOf("?");
if(ind>0){
uri=uri.substring(0,ind);
}
}
return uri;
},getRequestParameters:function(uri){
var _1d={};
if(!uri){
return _1d;
}
if(typeof uri=="string"){
uri=new _1._Url(uri);
}
return this.splitQuery(uri.query);
},writeParameters:function(map){
var out=[];
for(var key in map){
var _1e=map[key];
if(typeof _1e!="undefined"&&_1e!=null){
key=encodeURIComponent(key);
if(_2.isArray(_1e)){
for(var i=0;i<_1e.length;i++){
this.writeParam(key,_1e[i],out);
}
}else{
this.writeParam(key,_1e,out);
}
}
}
return out.join("");
},writeParam:function(key,_1f,out){
if(typeof _1f!="undefined"&&_1f!=null){
out.push(out.length==0?"?":"&");
out.push(key);
if(!(_1f==="")){
out.push("=");
out.push(encodeURIComponent(_1f));
}
}
},getHost:function(_20){
var uri=new _1._Url(_20);
uri.query=null;
uri.path=null;
return this.writeUri(uri);
},getPath:function(_21){
var uri=new _1._Url(_21);
uri.queryParameters=null;
uri.query=null;
return this.writeUri(uri);
}};
});


;define("ic-share/fileviewer/video/FlashVideoPlayer",["dojo","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dojo/dom","dojo/dom-construct","dojo/has","dojo/on","./util/MediaUri"],function(_1,_2,_3,_4,_5,_6,_7,_8,on,_9){
var _a=_3(null,{playVideo:function(_b,_c,_d,_e,_f,_10){
if(!_f){
_f="";
}
if(!_10){
_10="";
}
var src=require.toUrl("ic-share/fileviewer/video/sn_media_video_player/SnMediaVideoPlayer.swf");
var _11=1.5;
var _12=_d/_11;
var _13=_d;
var _14=["pt-br","zh-tw"];
var _15=/([^\-]*\-[^\-]*)\-/;
var _16=_15.exec(_1.locale.toLowerCase()[1]);
if(!_16){
_16=_1.locale;
}
var nls=_1.locale.split("-")[0];
if(_2.indexOf(_14,_16)!=-1){
if(_16=="pt-br"){
nls="pt_BR";
}else{
if(_16=="zh-tw"){
nls="zh_TW";
}
}
}
if(nls=="he"){
nls="iw";
}
var _17=dijit.getUniqueId("qkr_lw_VideoPlayer");
var _18=_9.rewriteUri(src,{videoSource:_c,nls:nls,height:_12,width:_13,ie:_8("ie"),prevId:_f,nextId:_10,elementId:_17});
var _19=(window.location.protocol||"http").replace(":","");
var _1a=(_19==="https");
var _1b=(_1a?"https":"http")+"://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0";
if(_8("ie")){
_b.innerHTML="<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" "+"codebase=\""+_1b+"\" "+"width=\""+_13+"\" height=\""+_12+"\" id=\""+_17+"\">"+"<param name=\"movie\" value=\""+_18+"\">"+"<param name=\"allowFullScreen\" value=\"true\">"+"<param name=\"tabIndex\" value=\"0\">"+"<param name=\"wmode\" value=\"transparent\">"+"</object>";
}else{
_b.innerHTML="<embed"+" width=\""+_13+"\" height=\""+_12+"\""+"tabindex=\"0\" allowfullscreen=\"true\" pluginspage=\"http://www.adobe.com/go/getflashplayer\" "+"allownetworking=\"all\" allowscriptaccess=\"sameDomain\" swliveconnect=\"true\" wmode=\"Transparent\""+"id=\""+_17+"\" name=\""+_17+"\" "+"src=\""+_18+"\" type=\"application/x-shockwave-flash\">";
}
setTimeout(function(){
if(!_8("ie")){
on(_6.byId(_17),"focus",function(){
var obj=_6.byId(_17);
if(obj){
obj.focusReceived();
}
});
}
},100);
}});
_a.alertVideoMessage=function(_1c,msg){
var _1d=_6.byId(_1c),div;
if(_1d){
div=_7.create("div",{className:"lotusAccess qkrVideoMsgAlert",role:"alert"},_1d.parentNode);
div.appendChild(_5.doc.createTextNode(msg));
}
};
_a.moveFocus=function(_1e){
var el=_6.byId(_1e);
if(el){
setTimeout(_4.hitch(this,function(el){
el.focus();
},el),0);
}
};
return _a;
});


;define("ic-share/fileviewer/util/url",["dojo/_base/url","dojo/io-query","dojo/_base/lang","../config/globals","jazz/inverted!../util/communities","dojo/when"],function(_1,_2,_3,_4,_5,_6){
return {rewrite:function(_7,_8){
var _9=new _1(_7);
_9.queryParameters=_3.mixin(_8,_2.queryToObject(_9.query||""));
return this.write(_9);
},write:function(_a){
var _b="";
if(_a.scheme){
_b+=_a.scheme+":";
}
if(_a.authority){
_b+="//"+_a.authority;
}
_b+=_a.path;
_b+=this.writeParameters(_a.queryParameters);
if(_a.fragment){
_b+="#"+_a.fragment;
}
return _b;
},writeParameters:function(_c){
var _d=_2.objectToQuery(_c||{});
return _d?"?"+_d:"";
},createUri:function(_e){
var _f=new _1(_e);
_f.queryParameters=_2.queryToObject(_f.query||"");
_f.fragmentParameters=_2.queryToObject(_f.fragment||"");
return _f;
},ensureQualified:function(url){
if(!url){
throw new Error("Null URL is not permitted");
}
return new _1(window.location.toString(),url).toString();
},getServiceUrl:function(_10){
if(!_10){
return;
}
var _11;
if(window.location.protocol.indexOf("https:")===0&&_10.secureEnabled&&_10.secureUrl){
_11=_10.secureUrl;
}else{
if(_10.url){
_11=_10.url;
}
}
return new _1(_11);
},areUrlsEqual:function(_12,_13){
if(_12===undefined||_13===undefined){
return false;
}
_12=this._removeTrailingHash(_12);
_13=this._removeTrailingHash(_13);
return _12===_13;
},isSamePage:function(_14,_15){
return !!_14&&!!_15&&this.removeHash(_14)===this.removeHash(_15);
},removeHost:function(url){
return url.replace(new RegExp(".*//[^/]+"),"");
},removeHash:function(url){
var _16=url.indexOf("#");
if(_16!==-1){
url=url.substring(0,_16);
}
return url;
},getParameters:function(url){
return this.createUri(url).queryParameters;
},getHashParameters:function(url){
var uri=this.createUri(url);
return _2.queryToObject(uri.fragment||"");
},_removeTrailingHash:function(url){
if(url.slice(-1)==="#"){
url=url.slice(0,-1);
}
return url;
},getFileParameters:function(){
var uri=this.createUri(window.location.href),_17;
if(this.isFilesUrl(uri)){
uri=this.fromFilesAnchorForm(uri);
_17=uri.queryParameters;
}else{
_17=_2.queryToObject(uri.fragment||"");
}
return _17||{};
},fromFilesAnchorForm:function(uri){
if(!this.isFilesUrl(uri)){
return uri;
}
if(_3.isString(uri)){
uri=this.createUri(uri);
}
return this.fromAnchorForm(uri,this.getServiceUrl(_4.coreServices.files).path+"/app");
},fromAnchorForm:function(uri,_18){
var _19=uri.path;
if(uri.fragment&&_19){
if(_19==_18){
var _1a=uri.fragment;
var _1b=_3.clone(uri);
var p=_1b.queryParameters;
_1b.queryParameters=null;
_1b.query=null;
_1b.fragment=null;
_1b.path=_19+_1a;
var url=this.write(_1b);
var _1c=this.createUri(url);
p=_3.mixin(p,_2.queryToObject(_1c.query||""));
_1c.queryParameters=p;
_1c.query=null;
uri=_1c;
}
}
return uri;
},toFilesAnchorForm:function(uri){
if(!this.isFilesUrl(uri)){
return uri;
}
if(_3.isString(uri)){
uri=this.createUri(uri);
}
return this.toAnchorForm(uri,this.getServiceUrl(_4.coreServices.files).path+"/app");
},toAnchorForm:function(uri,_1d,_1e){
uri=this.fromAnchorForm(uri,_1d);
var _1f=uri.path,key;
if(_1f){
if(_1f.indexOf(_1d)===0){
var p={};
var _20=_1f.substring(_1d.length);
var _21=_3.clone(uri);
if(_21.queryParameters){
var q=_21.queryParameters;
if(_1e){
for(key in _1e){
p[key]=q[key]||_1e[key];
delete q[key];
}
}
_20+=this.writeParameters(q);
}else{
for(key in _1e){
p[key]=_1e[key];
}
}
_21.path=_1d;
_21.fragment=(_20.length>0)?_20:"/";
_21.queryParameters=p;
_21.query=null;
uri=this.write(_21);
}
}
return uri;
},isFilesUrl:function(url){
var _22=this.getServiceUrl(_4.coreServices.files);
if(_3.isString(url)){
url=this.createUri(url);
}
return url.path.indexOf(_22.path)===0;
},isCommunityUrl:function(url){
if(!url){
return false;
}
var _23=this.getServiceUrl(_4.coreServices.communities);
if(_3.isString(url)){
url=this.createUri(url);
}
return url.path.indexOf(_23.path+"/service/html/")===0&&!!_2.queryToObject(url.query||"").communityUuid;
},isInsideFolder:function(url){
if(!url){
return false;
}
var _24=this.createUri(url);
if(_24.fragment){
return _24.fragment.indexOf("/folder/")===0;
}
return false;
},isValidFilesUrl:function(url){
if(_3.isString(url)){
url=this.createUri(url);
}
if(this.isCommunityUrl(url)){
var _25=url.queryParameters.communityUuid;
var _26=url.fragmentParameters.fullpageWidgetId;
return _5.isFilesWidget(_25,_26);
}else{
return _6(true);
}
}};
});


;define("ic-core/ajax/auth",["dojo","dojo/_base/array","dojo/_base/lang","dojo/has"],function(_1,_2,_3,_4){
_3.setObject("com.ibm.ajax.auth",{contentTypeRegex:/^text\/html/,ignoredDojoErrors:["cancel","timeout"],nonHtmlTypes:["xml","json","json-comment-optional"],checkFromCaller:true,checkByContentType:true,checkByStatusCode:true,checkAllStatusCodes:false,checkByXLConnAuth:false,authenticationChecks:[],interceptDojoXhr:function(_5){
if(this._intercepted){
return;
}
this._intercepted=true;
if(_5){
this.isUrlSecure=_5;
}
_1.xhr=_3.hitch(_1,this.xhrIntercept,this,_1.xhr);
if(_3.getObject("dojo.io.iframe")){
_1.io.iframe.send=_3.hitch(_1.io.iframe,this.ioIntercept,this,_1.io.iframe.send);
}
},prepareSecure:function(_6,_7,_8,_9){
if(_6["com.ibm.ajax.auth.prepareSecureCalled"]){
return _6;
}
_6["com.ibm.ajax.auth.prepareSecureCalled"]=true;
if(!_9){
var h=_6.headers=_6.headers||{};
var p=h.Pragma;
if(!_3.isArray(p)){
p=h.Pragma=p?[p]:[];
}
p.push("WWW-Authenticate=XHR");
}
_6._handle=_6.handle;
_6.handle=_3.partial(this.testAuthenticationHandler,this,_7,_8);
return _6;
},setAuthenticationHandler:function(_a){
this.authenticationHandler=_a;
},setDefaultAuthenticationTests:function(_b,_c,_d){
this.checkFromCaller=_b;
this.checkByContentType=_c;
this.checkByStatusCode=_d;
},addAuthenticationCheck:function(_e){
if(_e){
this.authenticationChecks.push(_e);
}
},setAuthenticationTest:function(_f){
this.isAuthenticationRequired=_3.partial(_f,this);
},isAuthenticationRequired:function(_10,_11){
if(this.isPossibleLoginRedirect(_10,_11)){
return true;
}
var i;
for(i=0;i<this.authenticationChecks.length;i++){
if(this.authenticationChecks[i](this,_10,_11)){
_11._authOutcome="Custom authentication check #"+(i+1)+" indicated login necessary";
return true;
}
}
return false;
},isPossibleLoginRedirect:function(_12,_13){
if(_13.xhr&&(!_12||_2.indexOf(this.ignoredDojoErrors,_12.dojoType)==-1)){
var _14;
try{
_14=_13.xhr.status;
}
catch(ignore){
}
var _15=_13.handleAs;
if(_13.args){
_15=_13.args.expectedContentType||_13.args.handleAs;
}
var _16=_2.indexOf(this.nonHtmlTypes,_15)!=-1;
if(this.checkByStatusCode&&(_16||this.checkAllStatusCodes)){
if(_14==302){
_13._authOutcome="Status code was 302";
return true;
}
if(_14==401){
_13._authOutcome="Status code was 401";
return true;
}
if(_4("ie")&&(_14==0||_14=="unknown")){
_13._authOutcome="Status code was 0 or \"unknown\"";
return true;
}
}
var _17="html";
if(_13.xhr.getResponseHeader){
_17=_13.xhr.getResponseHeader("Content-Type");
}else{
if(_13.HEADERS){
_17=_13.HEADERS["Content-Type"];
}
}
if(this.checkByContentType&&_16&&this.contentTypeRegex.exec(_17)&&_14>=200&&_14<300&&_14!=204){
_13._authOutcome="Content-Type was HTML and status code indicated success";
return true;
}
try{
if(this.checkByXLConnAuth&&_13&&_13.xhr){
var h=_13.xhr.getResponseHeader("X-LConn-Auth");
if(h=="true"){
return false;
}
if(h=="false"){
return true;
}
}
}
catch(ignore){
}
}
return false;
},testAuthenticationHandler:function(_18,_19,_1a,_1b,_1c){
var _1d=_1._toArray(arguments).slice(3);
var _1e=false;
if(_18.checkFromCaller&&typeof _19=="function"&&_19(_1b,_1c)){
_1c._authOutcome="isAuthRequired returned true";
_1e=true;
}
_1e=_1e||_18.isAuthenticationRequired(_1b,_1c);
if(_1e){
_18.authenticationHandler(_1b,_1c,_1a);
_1d[0]=new Error("xhr unauthenticated");
_1d[0].dojoType="unauthenticated";
}
if(_1c.args&&_1c.args._handle){
return _1c.args._handle.apply(this,_1d);
}
if(_1c._handle){
return _1c._handle.apply(this,_1d);
}
return _1b;
},authenticationHandler:function(){
console.log("auth::authenticationHandler DEBUG authentication was required");
},xhrIntercept:function(_1f,f,_20,_21){
var _22=_1._toArray(arguments).slice(2);
var p=_21.auth||{};
var _23=p.secured;
if(_23||(_23!=false&&_1f.isUrlSecure(_21.url))){
_22[1]=_1f.prepareSecure(_21,p.isAuthRequired,p.onLogin,p.sendXhrAuthHeader===false);
}
return f.apply(this,_22);
},ioIntercept:function(_24,f,_25){
var _26=_1._toArray(arguments).slice(2);
var p=_25.auth||{};
var _27=p.secured;
if(_27||(_27!=false&&_24.isUrlSecure(_25.url))){
_26[0]=_24.prepareSecure(_25,p.isAuthRequired,p.onLogin,p.sendXhrAuthHeader===false);
}
return f.apply(this,_26);
},isUrlSecure:function(url){
return false;
}});
return com.ibm.ajax.auth;
});


;define("ic-share/fileviewer/network/request",["dojo/request","dojo/_base/xhr","dojo/topic","../util/url","ic-core/ajax/auth","dojo/aspect","dojo/_base/array","dojo/_base/lang"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9=false,_a=false,_b=["/files/form/api/","/files/basic/api/"];
function _c(_d){
if(!_e(_d)){
return;
}
_5.prepareSecure(_d);
if(!_a){
_6.around(_5,"authenticationHandler",function(_f){
return function(_10,_11){
if(_8.getObject("args._fileviewerRequest",false,_11)){
_3.publish("ic-fileviewer/authenticationRequired");
}else{
_f.apply(this,arguments);
}
};
});
}
_a=true;
};
function _e(_12){
var uri=_4.createUri(_12.url);
var _13=_7.some(_b,function(_14){
return uri.path.indexOf(_14)===0;
});
return _13;
};
function xhr(url,_15){
_15._fileviewerRequest=true;
if(_9){
return _1(url,_15);
}else{
_15=_15||{};
if(_15.query){
url=_4.rewrite(url,_15.query);
delete _15.query;
}
_15.url=url;
if(_15.data){
_15.postData=_15.data;
delete _15.data;
}
_c(_15);
var _16=_15.method==="POST"||_15.method==="PUT";
return _2(_15.method||"GET",_15,_16);
}
};
return xhr;
});


;define("ic-share/fileviewer/util/dom",["dojo/_base/declare","dojo/request","dojo/Deferred","dojo/Stateful","dojo/_base/lang","dojo/_base/array","dojo/query","dojox/xml/parser","dojo/date/stamp","dojo/has","dojo/sniff"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
"use strict";
return {NS:{TD:{LONG:"urn:ibm.com/td",SHORT:"td"},SNX:{LONG:"http://www.ibm.com/xmlns/prod/sn",SHORT:"snx"},OPENSEARCH:{LONG:"http://a9.com/-/spec/opensearch/1.1/",SHORT:"opensearch"},ATOM:{LONG:"http://www.w3.org/2005/Atom",SHORT:"atom"},REPORT:{LONG:"http://www.ibm.com/xmlns/prod/sn/reports",SHORT:"reports"},STATUS:{LONG:"http://www.ibm.com/xmlns/prod/sn/flags",SHORT:"flags"}},getLinkAttrByRel:function(_c,_d,_e){
var _f=_6.filter(_c.getElementsByTagName("link"),function(_10){
return _10.getAttribute("rel")===_d;
});
return _f[0]?_f[0].getAttribute(_e):"";
},getChildText:function(xml,_11,_12){
return this.getChildTextNS(xml,_11,undefined,_12);
},getChildTextNS:function(xml,_13,_14,_15){
var _16=this.getFirstTag(xml,_13,_14,_15);
if(_16){
return _8.textContent(_16);
}
},getChildAttrNS:function(xml,_17,_18,_19,_1a){
var _1b=this.getFirstTag(xml,_17,_18,_1a);
if(_1b){
return _1b.getAttribute(_19);
}
},getChildDate:function(xml,_1c,_1d,_1e){
return _9.fromISOString(this.getChildTextNS(xml,_1c,_1d||this.NS.TD,_1e));
},getUser:function(xml,_1f,_20,_21){
var _22=this.getFirstTag(xml,_1f,_20,_21);
if(!_22){
return {};
}
return this._createUser(xml,_22);
},getAllUsers:function(xml,_23,_24,_25){
var _26=this.getAllTags(xml,_23,_24,_25);
if(!_26){
return {};
}
return _6.map(_26,function(_27){
return this._createUser(xml,_27);
},this);
},getFirstTag:function(xml,_28,_29,_2a){
return this.getAllTags(xml,_28,_29,_2a)[0];
},getAllTags:function(xml,_2b,_2c,_2d){
if(!_2d){
_2d=xml;
}
if(_2c){
return (_a("ie"))?_2d.getElementsByTagName(_2e(xml,_2c)+_2b):_2d.getElementsByTagNameNS(_2c.LONG,_2b);
}
return _2d.getElementsByTagName(_2b);
},_createUser:function(xml,_2f){
return {name:this.getChildText(xml,"name",_2f),id:this.getChildTextNS(xml,"userid",this.NS.SNX,_2f),email:this.getChildText(xml,"email",_2f),userState:this.getChildTextNS(xml,"userState",this.NS.SNX,_2f)};
},newXmlDocument:function(_30,_31,_32){
if(!_30){
_30="";
}
var _33="",doc,_34,_35,p,_36,i;
if(_31){
if(_31.LONG){
_33=_31.LONG;
}else{
_33=_31;
}
}
if(document.implementation&&document.implementation.createDocument&&!dojo.isIE){
return document.implementation.createDocument(_33,_30,null);
}else{
doc=new ActiveXObject("MSXML2.DOMDocument");
if(_30){
_34="";
_35=_30;
p=_30.indexOf(":");
if(p!=-1){
_34=_30.substring(0,p);
_35=_30.substring(p+1);
}
if(!_34&&_31&&_31.SHORT){
_34=_31.SHORT;
}else{
_34=null;
}
_36="<"+(_34?(_34+":"):"")+_35+(_33?(" xmlns"+(_34?(":"+_34):"")+"=\""+_33+"\""):"");
if(_32){
for(i=0;i<_32.length;i++){
_36+=" xmlns:"+_32[i].SHORT+"=\""+_32[i].LONG+"\"";
}
}
_36+="/>";
doc.loadXML(_36);
}
return doc;
}
},serializeXMLDocument:function(doc){
var _37;
if(doc.xml){
_37=doc.xml;
}else{
_37=new XMLSerializer().serializeToString(doc);
}
return _37;
},createElementNS:function(doc,_38,_39){
if(!_39){
return doc.createElement(_38);
}
var _3a=(dojo.isIE)?doc.createElement(_39.SHORT+":"+_38):doc.createElementNS(_39.LONG,_38);
return _3a;
},getChildTextNSScheme:function(xml,_3b,_3c,_3d,_3e){
if(!_3e){
_3e=xml;
}
var _3f=this.getAllTags(xml,_3b,_3c,_3e);
var url=_3c.LONG+"/"+_3d;
var _40="";
_6.forEach(_3f,function(_41){
if(_41.getAttribute("scheme")===url){
_40=_8.textContent(_41);
}
});
return _40;
},getChildAttributeNSScheme:function(xml,_42,_43,_44){
var _45=this.getAllTags(xml,_42);
var url=_43.LONG;
var _46="";
_6.forEach(_45,function(_47){
if(_47.getAttribute("scheme")===url){
_46=_47.getAttribute(_44);
}
});
return _46;
},getChildAttributeMatching:function(xml,_48,_49,_4a,_4b){
var _4c=this.getAllTags(xml,_48);
var _4d=null;
_6.some(_4c,function(_4e){
if(_4e.getAttribute(_49)===_4a){
_4d=_4e.getAttribute(_4b);
return true;
}
});
return _4d;
}};
function _2e(el,_4f){
for(var _50=el,_51=null;_50&&!_51&&_50.nodeType==1;_50=_50.parentNode){
_51=_50.getAttribute("xmlns");
}
var _52=(_51==_4f.LONG)?"":(_4f.SHORT+":");
return _52;
};
});


;define("ic-share/fileviewer/data/util/routes",["dojo/string","dojo/io-query","../../config/globals","../../util/url","../../util/dom","dojo/_base/config","dojo/_base/url","dojo/_base/lang"],function(_1,_2,_3,_4,_5,_6,_7,_8){
"use strict";
var _9=lconn.core.url.getServiceUrl(lconn.core.config.services.files).path;
var _a="/communities";
var _b=_9+"/";
var _c=_b+"basic/api/";
var _d=_b+"basic/anonymous/api/";
var _e=_b+"form/api/";
var _f=_b+"form/anonymous/api/";
var _10=window.location.href;
function _11(_12){
var _13=_3.isAuthenticated?"":"/anonymous";
return _9+"/basic"+_13+_12;
};
function _14(_15,_16){
var url=_1.substitute("/api/communitylibrary/${communityId}",{communityId:_16.get("communityId")});
return url+_15;
};
function _17(_18,_19){
var _1a=_19.get("author").id,url=_1a===_3.currentUser.id?"/api/myuserlibrary":"/api/userlibrary/${userId}";
url=_1.substitute(url,{userId:_1a});
return url+_18;
};
function _1b(_1c,_1d){
if(_1d.get("libraryType")==="communityFiles"){
_1c=_14(_1c,_1d);
}else{
_1c=_17(_1c,_1d);
}
return _11(_1c);
};
function _1e(){
var _1f=define._modules["ic-core/wp/utils"];
if(_1f){
var _20=_1f.getWidgetInstancesByDef("Files");
return ((_20&&_20.length)?_20[0].instanceId:"");
}
return "";
};
function _21(_22){
return _9+"/app"+_22;
};
function _23(url,_24){
if(_24){
if(_24.get("id")){
return _1.substitute(url,{fileId:_24.get("id"),collectionId:_24.get("id")});
}
}
return url;
};
if(window.notesiniParameters){
_9=window.notesiniParameters.bssUrl+_9;
}
return {getFileEntryUrl:function(_25){
var url=_11("/api/document/${fileId}/entry");
return _23(url,_25);
},getFileFeedUrl:function(_26){
var url=_11("/api/document/${fileId}/feed");
return _23(url,_26);
},getCollectionFeedUrl:function(_27){
var url=_11("/api/collection/${collectionId}/feed");
return _23(url,_27);
},getPermissionsFeedUrl:function(_28){
var url=_1b("/document/${fileId}/permissions/feed",_28);
return _23(url,_28);
},getFileCollectionsFeedUrl:function(_29){
var url=_1b("/document/${fileId}/collections/feed",_29);
return _23(url,_29);
},getShareLinksFeedUrl:function(_2a){
var url=_1b("/document/${fileId}/sharelinks/feed",_2a);
return _23(url,_2a);
},getSharesFeedUrl:function(){
return _11("/api/shares/feed");
},getMySharesFeedUrl:function(){
return _11("/api/myshares/feed");
},getRecommendationFeedUrl:function(_2b){
var url=_11("/api/document/${fileId}/recommendedby/feed");
return _23(url,_2b);
},getRecommendationUrl:function(_2c){
var url=_11("/api/document/${fileId}/recommendation/${userId}/entry");
return _1.substitute(url,{fileId:_2c.get("id"),userId:_3.currentUser.id});
},getDownloadInfoFeedUrl:function(_2d){
var url=_11("/api/document/${fileId}/downloadedby/feed");
return _23(url,_2d);
},getMyFileSyncUrl:function(){
var url=_11("/api/myfilesync/feed");
return url;
},getAclValidationUrl:function(_2e){
return this.getFileEntryUrl(_2e);
},getFavoritesFeedUrl:function(_2f){
return _11("/api/myfavorites/feed");
},getFavoritesServiceUrl:function(){
return _11("/api/myfavorites/documents/feed");
},getTagServiceUrl:function(){
return _11("/api/tags/feed");
},getTagUrl:function(_30,tag,_31){
var url;
if(_4.isCommunityUrl(window.location.href)){
var _32=window.location.pathname.match("(.*/service/html/)(.*)"),_33,_34,_35;
if(!_4.isCommunityUrl(_10)&&_32&&_32.length===3){
_34=_32[1];
_35=_32[2];
if(_35!=="communityview"){
_35="communityview";
}else{
_35="communityoverview";
}
_33=_34+_35;
}else{
_33=window.location.pathname;
}
url=_33+window.location.search+"#"+_2.objectToQuery({fullpageWidgetId:_30.get("widgetId"),tag:tag,pivot:"all"});
}else{
if(_4.isInsideFolder(_31)){
url=_4.rewrite(_31,{sort:"modified",tag:tag});
}else{
url=_1.substitute(_21("/person/${userId}"),{userId:_30.get("author").id});
url=_4.rewrite(url,{tag:tag});
}
}
return url;
},getRepositoryEntryUrl:function(_36){
var url=_11("/api/communitylibrary/${communityId}/entry?acls=true");
return _1.substitute(url,{communityId:_36.get("communityId")});
},getFileLockUrl:function(_37,_38){
var url=_11("/api/document/${fileId}/lock");
if(_38){
url+="?type="+_38;
}
return _23(url,_37);
},getFilesBasePath:function(){
return _3.services.getFilesUrl();
},getFilesFormPath:function(){
return _3.services.getFilesUrl()+"/form/api/";
},getUserInfoServiceUrl:function(){
return _4.rewrite(_11("/api/people/feed"),{self:true,format:"json"});
},getFilesAppRoutes:function(_39){
if(_39.get("libraryType")==="communityFiles"){
return this.getCommunityFilesRoutes(_39);
}else{
return this.getPersonalFilesRoutes(_6.locale,{});
}
},getCommunityFilesRoutes:function(_3a){
var _3b={basePath:this.getFilesBasePath(),disableAnonymous:false,_form:this.getFilesFormPath(),_cId:_3a.get("communityId"),getAuthenticatedUser:function(){
return _3.pickerAuth.getUser();
}};
return new _3.commRoutes(_3b);
},getPersonalFilesRoutes:function(){
var _3c=new _3.pickerRoutes(_6.locale,{});
_3c.getAuthenticatedUser=function(){
return _3.pickerAuth.getUser();
};
return _3c;
},getFilesNonceUrl:function(){
return _11("/api/nonce");
},getCommunityLink:function(_3d){
return _a+"/service/html/communityview?communityUuid="+_3d.communityUuid;
},getFolderLink:function(_3e){
var _3f="";
var d=new Date();
if(_3e.get("collectionType")==="personal"){
_3f=_21("/folder/"+_3e.get("id")+"?preventCache="+d.getTime());
}else{
if(_3e.get("collectionType")==="community"){
_3f=this.getCommunityLink(_3e)+"&preventCache="+d.getTime()+"#fullpageWidgetId="+_3e.externalInstanceId+"&folder="+_3e.get("id");
}
}
return _3f;
},getNameCheckUrl:function(_40,_41){
return _1b(_40,_41);
},getExtensionsUrl:function(){
var _42=_3.coreUrl.getServiceUrl(_3.coreServices.bss);
if(!_42){
return;
}
return _42+"/extensions/getExtensions/byService/files?";
},getCommentListServiceUrl:function(_43,opt){
return this._getListServiceUrl(_43,opt,"comment");
},getVersionListServiceUrl:function(_44,opt){
return this._getListServiceUrl(_44,opt,"version");
},_getListServiceUrl:function(_45,opt,_46){
return this._getListFilesUrl(_45,opt,_46);
},_getListFilesUrl:function(_47,opt,_48){
var _49=_47.author.id;
var _4a=_47.id;
var url=this._getUSB(_49,"document/{fileId}/feed","document/{fileId}/feed",opt);
url=url.replace("{fileId}",encodeURIComponent(_4a));
var p=this._getListOptions(opt);
if(opt){
if(opt.fetchAcl){
p.acls=true;
}
if(opt.fileType){
p.fileType=opt.fileType;
}
if(opt.deleteFrom){
p.deleteFrom=opt.deleteFrom;
}
if(opt.fetchAcl){
p.acls=true;
}
}
if(!p.category){
p.category=_48;
}
if(opt.contentFormat){
p.contentFormat=opt.contentFormat;
}
return url+_3.coreUrl.writeParameters(p);
},_getListCommunitiesUrl:function(_4b,opt,_4c){
var url=this._getSB("communitylibrary/{communityId}/document/{fileId}/feed",opt);
url=url.replace("{communityId}",encodeURIComponent(_4b.get("communityId")));
url=url.replace("{fileId}",encodeURIComponent(_4b.get("id")));
var p={};
if(opt){
if(opt.fetchAcl){
p.acls=true;
}
if(opt.pageSize){
p.pageSize=opt.pageSize;
}
if(opt.page){
p.page=opt.page;
}else{
if(opt.start){
p.sI=opt.start;
}
}
if(opt.sortKey){
p.sK=opt.sortKey;
p.sO=opt.sortDescending?"dsc":"asc";
}
if(opt.category){
p.category=opt.category;
}
if(opt.fileType){
p.fileType=opt.fileType;
}
if(typeof opt.format!="undefined"){
p.format=opt.format;
}
}
if(!p.category){
p.category=_4c;
}
if(dojo.isIE){
p.format=p.format||"xml";
}
if(opt.contentFormat){
p.contentFormat=opt.contentFormat;
}
return url+_3.coreUrl.writeParameters(p);
},_getSB:function(_4d,opt,_4e){
var _4f=opt&&opt.anonymous&&!_3.disableAnonymous;
var _50=opt&&opt.basicAuth;
var _51=opt&&opt.nonPersonal;
if(_51){
_4e=null;
}
if(_50){
if(!_4f&&this.isAuthenticatedUser()){
return _c+(_4e||_4d);
}
return _d+_4d;
}
if(!_4f&&this.isAuthenticatedUser()){
return this._form+(_4e||_4d);
}
return _f+_4d;
},isAuthenticatedUser:function(_52){
var u=_3.pickerAuth.getUser();
if(!_52){
return typeof u=="object"&&u!=null;
}
return u&&u.id==_52;
},_getUSB:function(_53,_54,_55,opt){
var _56=opt&&opt.anonymous&&!_3.disableAnonymous;
var _57=opt&&opt.basicAuth;
var _58=opt&&opt.nonPersonal;
if(_58){
_55=null;
}
var s;
if(_57){
if(!_56&&this.isAuthenticatedUser()){
if(_55&&_3.pickerAuth.getUser().id==_53){
s=_c+_55;
}else{
s=_c+_54.replace("{userId}",encodeURIComponent(_53));
}
}else{
s=_d+_54.replace("{userId}",encodeURIComponent(_53));
}
}else{
if(!_56&&this.isAuthenticatedUser()){
if(_55&&_3.pickerAuth.getUser().id==_53){
s=_e+_55;
}else{
s=_e+_54.replace("{userId}",encodeURIComponent(_53));
}
}else{
s=_f+_54.replace("{userId}",encodeURIComponent(_53));
}
}
return s;
},_getListOptions:function(opt){
var _59=((opt&&opt.apiParams)?opt.apiParams:this.apiParams)||{};
var _5a=(opt&&opt.apiSortKeys)?opt.apiSortKeys:null;
var p={};
if(opt){
if(opt.page&&_59.page){
p[_59.page]=opt.page;
}else{
if(opt.start&&_59.sI){
p[_59.sI]=opt.start;
}else{
if(opt.page&&opt.page>1&&opt.pageSize&&_59.sI){
p[_59.sI]=(opt.page-1)*opt.pageSize+_59.zeroItem;
}
}
}
if(opt.pageSize&&_59.pageSize){
p[_59.pageSize]=opt.pageSize;
}
if(typeof opt.format!="undefined"&&_59.format){
p[_59.format]=opt.format;
}
if(opt.sortKey&&_59.sK){
opt.sortKey=_5a?_5a[opt.sortKey]:opt.sortKey;
if(opt.sortKey){
if(_59.sO){
p[_59.sK]=opt.sortKey;
p[_59.sO]=opt.sortDescending?_59.dsc:_59.asc;
}else{
p[_59.sK]=opt.sortKey+" "+(opt.sortDescending?_59.dsc:_59.asc);
}
if(_59.sC){
p[_59.sC]=opt.sortCategory;
}
}
}
if(opt.includeCount===false){
p.includeCount=false;
}
if(opt.preventCache){
p.preventCache=new Date().valueOf();
}
if(opt.isExternal){
p.isExternal=opt.isExternal;
}
}
if(dojo.isIE&&_59.format){
p[_59.format]=p.format||"xml";
}
return p;
},getProvisionExternalUserUrl:function(){
var _5b=_3.coreUrl.getServiceUrl(_3.coreServices.bss);
if(!_5b){
return;
}
var _5c="/subscribers/inviteGuests/input";
return _5b+_5c;
},getProvisionExternalUserReturnUrl:function(_5d){
var _5e=this.getFilesFormPath();
var _5f="provision/share";
var _60="app/file/"+_5d.get("id");
var _61={rs:encodeURIComponent(_60)};
return _5e+_5f+"?"+_2.objectToQuery(_61);
},getProvisionExternalUserCancelUrl:function(_62){
var _63=this.getFilesBasePath()+"/app/invited/share";
var _64="app/file/"+_62.get("id");
var _65={rs:encodeURIComponent(_64)};
return _63+"?"+_2.objectToQuery(_65);
},getCommunityWidgetsFeedUrl:function(_66,_67){
return _4.rewrite(_a+"/service/atom/community/widgets",{communityUuid:_66,widgetDefId:_67});
},getClosedFileUrlHashed:function(_68){
if(_68){
if(_68.indexOf("#")===-1){
_68+="#";
}
return _68;
}
var url;
if(!window.ic_comm_communityUuid){
url=_4.getServiceUrl(_3.coreServices.files)+"/app#/"+(_3.isAuthenticated?"":"public");
}else{
url=_4.ensureQualified("#"+_2.objectToQuery({fullpageWidgetId:_1e()}));
}
return url;
},getRelativeUri:function(_69){
var _6a=new _7(window.location.href);
var url=_69||_6a.uri;
return _4.removeHost(url);
},doesPageSupportFileHash:function(opt){
if(!opt){
opt={};
}
if(this._pageSupportsFileHash!==undefined){
return this._pageSupportsFileHash;
}
var url=new _7(this._pageUrl||window.location.href),_6b=url.path,_6c=opt.services||_3.coreServices,_6d=_4.getServiceUrl(_6c.files),_6e=_4.getServiceUrl(_6c.communities);
this._pageSupportsFileHash=false;
if(_6b===(_6d.path+"/app")){
this._pageSupportsFileHash=true;
}else{
if(_6b.indexOf(_6e.path+"/service/html/")===0&&!!_2.queryToObject(url.query||"").communityUuid){
this._pageSupportsFileHash=true;
}
}
return this._pageSupportsFileHash;
}};
});


;define("ic-share/fileviewer/util/communities",["exports","dojo/_base/array","../config/globals","dojo/_base/lang","dojo/Deferred","../network/request","../data/util/routes","../util/dom","../util/url"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
var _a="Files";
_4.mixin(_1,{isFilesWidget:function(_b,_c){
return _6(_7.getCommunityWidgetsFeedUrl(_b,_a),{handleAs:"xml"}).then(_4.hitch(this,this._isFilesWidget,_c));
},_isFilesWidget:function(_d,_e){
var _f=_8.getAllTags(_e,"entry");
return _2.some(_f,function(_10){
return _d===_8.getChildTextNS(_10,"widgetInstanceId",_8.NS.SNX);
},this);
}});
});


;define("ic-share/fileviewer/preview/VideoPreview",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/VideoPreview.html","dojo/_base/array","dojo/_base/window","ic-share/fileviewer/video/HTML5VideoPlayer","ic-share/fileviewer/video/FlashVideoPlayer","dojo/i18n!../nls/FileViewerStrings","../util/url","./util","dojo/_base/lang","dojo/on","dojo/sniff"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,on,_d){
"use strict";
var _e=["mp4"],_f=["mp4","mov","flv"],_10=_1([_2,_3],{previewId:"video",templateString:_4,isHTML5SupportedType:function(){
var _11=this.ui.fileType;
return (_5.indexOf(_e,_11)>-1);
},isFlashSupportedType:function(){
var _12=this.ui.fileType;
return (_5.indexOf(_f,_12)>-1);
},isHTML5VideoSupported:function(){
if(_d("ie")){
return _d("ie")>=11&&!!_6.doc.createElement("video").canPlayType;
}else{
return !!_6.doc.createElement("video").canPlayType;
}
},_createFlashVideo:function(){
var _13=new _8();
_13.playVideo(this.videoContainer,_a.ensureQualified(this.file.args.links.download),854,700,null,null);
},_createHTML5Video:function(){
var _14,_15;
_14=new _7();
on(_14,"error",_c.hitch(this,"onError"));
_15=this;
setTimeout(function(){
_14.playVideo(_15.videoContainer,_15.file.args.links.download,null,854,700,null,null,(_d("ie"))?false:true);
},10);
},postMixInProperties:function(){
this.ui={src:this.file.args.links.download,name:this.file.args.name,videoContainer:this.videoContainer,fileType:this.file.args.type};
},postCreate:function(){
this.ui.prevFocus=null;
this.ui.nextFocus=null;
this.ui.allowFullScreen=false;
if(this.isHTML5VideoSupported()&&this.isHTML5SupportedType()){
this._createHTML5Video();
}else{
if(this.isFlashSupportedType()){
this._createFlashVideo();
}else{
this.onError();
}
}
},onError:function(){
if(this.errorHandler){
this.errorHandler();
}
},_cancelEvent:function(_16){
_16.stopPropagation();
}});
return {create:function(_17){
return new _10(_17);
},isSafeForPreview:function(_18){
var _19=_9.PREVIEW.VIDEO.UNSAFE_PREVIEW||"This file cannot be previewed because it has not been scanned for viruses.";
return _b.isPreviewSafe(_18,_19);
},isValid:function(_1a){
var _1b=_1a.args.type;
return (_5.indexOf(_e.concat(_f),_1b)>-1)&&this.isSafeForPreview(_1a);
}};
});


;define("dojo/text!ic-share/fileviewer/preview/templates/ViewerPreview.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-viewer-widget">\n   <div class="loading" data-dojo-attach-point="loading">\n      <span class="loadingMessage" data-dojo-attach-point="loadingMessageNode">${loadingMessage}</span>\n      <img class="lotusLoading loader"  title="${nls.LOADING}" src="${blankGif}"></img>\n   </div>\n   <div data-dojo-attach-point="iframeContainer"></div>\n</div>\n');

;define("dojox/encoding/digests/MD5",["./_base"],function(_1){
var _2=8;
function R(n,c){
return (n<<c)|(n>>>(32-c));
};
function C(q,a,b,x,s,t){
return _1.addWords(R(_1.addWords(_1.addWords(a,q),_1.addWords(x,t)),s),b);
};
function FF(a,b,c,d,x,s,t){
return C((b&c)|((~b)&d),a,b,x,s,t);
};
function GG(a,b,c,d,x,s,t){
return C((b&d)|(c&(~d)),a,b,x,s,t);
};
function HH(a,b,c,d,x,s,t){
return C(b^c^d,a,b,x,s,t);
};
function II(a,b,c,d,x,s,t){
return C(c^(b|(~d)),a,b,x,s,t);
};
function _3(x,_4){
x[_4>>5]|=128<<((_4)%32);
x[(((_4+64)>>>9)<<4)+14]=_4;
var a=1732584193;
var b=-271733879;
var c=-1732584194;
var d=271733878;
for(var i=0;i<x.length;i+=16){
var _5=a;
var _6=b;
var _7=c;
var _8=d;
a=FF(a,b,c,d,x[i+0],7,-680876936);
d=FF(d,a,b,c,x[i+1],12,-389564586);
c=FF(c,d,a,b,x[i+2],17,606105819);
b=FF(b,c,d,a,x[i+3],22,-1044525330);
a=FF(a,b,c,d,x[i+4],7,-176418897);
d=FF(d,a,b,c,x[i+5],12,1200080426);
c=FF(c,d,a,b,x[i+6],17,-1473231341);
b=FF(b,c,d,a,x[i+7],22,-45705983);
a=FF(a,b,c,d,x[i+8],7,1770035416);
d=FF(d,a,b,c,x[i+9],12,-1958414417);
c=FF(c,d,a,b,x[i+10],17,-42063);
b=FF(b,c,d,a,x[i+11],22,-1990404162);
a=FF(a,b,c,d,x[i+12],7,1804603682);
d=FF(d,a,b,c,x[i+13],12,-40341101);
c=FF(c,d,a,b,x[i+14],17,-1502002290);
b=FF(b,c,d,a,x[i+15],22,1236535329);
a=GG(a,b,c,d,x[i+1],5,-165796510);
d=GG(d,a,b,c,x[i+6],9,-1069501632);
c=GG(c,d,a,b,x[i+11],14,643717713);
b=GG(b,c,d,a,x[i+0],20,-373897302);
a=GG(a,b,c,d,x[i+5],5,-701558691);
d=GG(d,a,b,c,x[i+10],9,38016083);
c=GG(c,d,a,b,x[i+15],14,-660478335);
b=GG(b,c,d,a,x[i+4],20,-405537848);
a=GG(a,b,c,d,x[i+9],5,568446438);
d=GG(d,a,b,c,x[i+14],9,-1019803690);
c=GG(c,d,a,b,x[i+3],14,-187363961);
b=GG(b,c,d,a,x[i+8],20,1163531501);
a=GG(a,b,c,d,x[i+13],5,-1444681467);
d=GG(d,a,b,c,x[i+2],9,-51403784);
c=GG(c,d,a,b,x[i+7],14,1735328473);
b=GG(b,c,d,a,x[i+12],20,-1926607734);
a=HH(a,b,c,d,x[i+5],4,-378558);
d=HH(d,a,b,c,x[i+8],11,-2022574463);
c=HH(c,d,a,b,x[i+11],16,1839030562);
b=HH(b,c,d,a,x[i+14],23,-35309556);
a=HH(a,b,c,d,x[i+1],4,-1530992060);
d=HH(d,a,b,c,x[i+4],11,1272893353);
c=HH(c,d,a,b,x[i+7],16,-155497632);
b=HH(b,c,d,a,x[i+10],23,-1094730640);
a=HH(a,b,c,d,x[i+13],4,681279174);
d=HH(d,a,b,c,x[i+0],11,-358537222);
c=HH(c,d,a,b,x[i+3],16,-722521979);
b=HH(b,c,d,a,x[i+6],23,76029189);
a=HH(a,b,c,d,x[i+9],4,-640364487);
d=HH(d,a,b,c,x[i+12],11,-421815835);
c=HH(c,d,a,b,x[i+15],16,530742520);
b=HH(b,c,d,a,x[i+2],23,-995338651);
a=II(a,b,c,d,x[i+0],6,-198630844);
d=II(d,a,b,c,x[i+7],10,1126891415);
c=II(c,d,a,b,x[i+14],15,-1416354905);
b=II(b,c,d,a,x[i+5],21,-57434055);
a=II(a,b,c,d,x[i+12],6,1700485571);
d=II(d,a,b,c,x[i+3],10,-1894986606);
c=II(c,d,a,b,x[i+10],15,-1051523);
b=II(b,c,d,a,x[i+1],21,-2054922799);
a=II(a,b,c,d,x[i+8],6,1873313359);
d=II(d,a,b,c,x[i+15],10,-30611744);
c=II(c,d,a,b,x[i+6],15,-1560198380);
b=II(b,c,d,a,x[i+13],21,1309151649);
a=II(a,b,c,d,x[i+4],6,-145523070);
d=II(d,a,b,c,x[i+11],10,-1120210379);
c=II(c,d,a,b,x[i+2],15,718787259);
b=II(b,c,d,a,x[i+9],21,-343485551);
a=_1.addWords(a,_5);
b=_1.addWords(b,_6);
c=_1.addWords(c,_7);
d=_1.addWords(d,_8);
}
return [a,b,c,d];
};
function _9(_a,_b){
var wa=_1.stringToWord(_b);
if(wa.length>16){
wa=_3(wa,_b.length*_2);
}
var l=[],r=[];
for(var i=0;i<16;i++){
l[i]=wa[i]^909522486;
r[i]=wa[i]^1549556828;
}
var h=_3(l.concat(_1.stringToWord(_a)),512+_a.length*_2);
return _3(r.concat(h),640);
};
_1.MD5=function(_c,_d){
var _e=_d||_1.outputTypes.Base64;
var wa=_3(_1.stringToWord(_c),_c.length*_2);
switch(_e){
case _1.outputTypes.Raw:
return wa;
case _1.outputTypes.Hex:
return _1.wordToHex(wa);
case _1.outputTypes.String:
return _1.wordToString(wa);
default:
return _1.wordToBase64(wa);
}
};
_1.MD5._hmac=function(_f,key,_10){
var out=_10||_1.outputTypes.Base64;
var wa=_9(_f,key);
switch(out){
case _1.outputTypes.Raw:
return wa;
case _1.outputTypes.Hex:
return _1.wordToHex(wa);
case _1.outputTypes.String:
return _1.wordToString(wa);
default:
return _1.wordToBase64(wa);
}
};
return _1.MD5;
});


;define("ic-share/fileviewer/bean/DocsDraftInfo",["dojo/_base/declare","dojo/_base/array","dojo/Stateful","dojo/date/stamp"],function(_1,_2,_3,_4){
return _1([_3],{_docsResponseSetter:function(_5){
this.set({editors:this._getUsers(_5.editors),lastEditor:this._getUser(_5.lasteditor),hasChanges:_5.dirty,dateCreated:this._getDate(_5.created),dateModified:this._getDate(_5.modified),baseVersion:_5.base_version,latestVersion:_5.latest_version,latestVersionModifed:new Date(_5.latest_version_modified)});
},_getUsers:function(_6){
return _2.map(_6,function(_7){
return this._getUser(_7);
},this);
},_getUser:function(_8){
return {name:_8.displayName,email:_8.email,id:_8.id};
},_getDate:function(_9){
return _4.fromISOString(_9);
}});
});


;define("ic-share/fileviewer/data/docsApi",["dojo/_base/lang","../network/request","../config/globals","dojox/encoding/digests/MD5","dojox/encoding/digests/_base","../bean/DocsDraftInfo","dojo/Deferred"],function(_1,_2,_3,_4,_5,_6,_7){
"use strict";
return {getDraftInformation:function(_8){
var _9=_3.services.getDocsUrl()+"/api/docsvr/lcfiles/"+(_8.id||_8.get("id"))+"/draft";
return this._request(_9,{handleAs:"json",preventCache:true,failOk:true}).then(_1.hitch(this,function(_a){
return new _6({docsResponse:_a});
}));
},publish:function(_b){
var _c=new _7();
var _d=_3.services.getDocsUrl()+"/api/docsvr/lcfiles/"+_b.get("id")+"/draft";
this._request(_d,{method:"POST",handleAs:"json",filesUserId:_3.currentUser.id,data:"{}",headers:{"Content-Type":"application/json"}}).then(_1.hitch(this,function(_e){
this._handlePublishStatus(_b,_e.id,_c,_e);
}));
return _c;
},_handlePublishStatus:function(_f,_10,_11,_12){
if(_12 instanceof Error){
_11.reject(this._getPublishError(_12));
}
if(_12.status==="complete"){
_11.resolve(_12);
}else{
if(_12.status==="pending"){
setTimeout(_1.hitch(this,this._queryPublishStatus,_f,_10,_11),1000);
}else{
_11.reject(this._getPublishError(_12));
}
}
},_queryPublishStatus:function(_13,_14,_15){
var url=_3.services.getDocsUrl()+"/api/job/lcfiles/"+_13.get("id")+"/"+_14;
this._request(url,{handleAs:"json",preventCache:true}).then(_1.hitch(this,this._handlePublishStatus,_13,_14,_15));
},_getPublishError:function(_16,_17){
var _18=new Error();
_18.isDocsError=true;
var _19=_16.error_code||0;
var _1a;
switch(_19){
case 1001:
case 1002:
_1a="AccessDenied";
break;
case 1003:
_1a="ItemNotFound";
break;
case 1004:
_1a="CannotReachRepository";
break;
case 1005:
_1a="QuotaViolation";
break;
case 1200:
_1a="ConversionUnavailable";
break;
case 1201:
case 1500:
_1a="DocumentTooLarge";
break;
case 1202:
_1a="ConversionTimeout";
break;
case 1208:
_1a="ServerBusy";
break;
default:
_1a=0;
}
_18.code=_1a||"Unknown";
return _18;
},_request:function(url,_1b){
this._addDefaultHeaders(url,_1b);
return _2(url,_1b);
},_addDefaultHeaders:function(url,_1c){
var _1d=_1.getObject("headers",true,_1c);
var _1e="";
var _1f=_3.currentUser;
if(_1f){
_1e=_1f.id;
}
var ct=new Date().getTime().toString();
var _20=_1e+"@@"+ct.substring(4,ct.length-1)+"##";
var _21=_4(_20,_5.outputTypes.Hex);
_1d["X-Csrf-Token"]=_21;
_1d["X-Timestamp"]=ct;
_1d["X-DOCS-REPOID"]="lcfiles";
}};
});


;define("ic-share/fileviewer/util/feature",["dojo/has","dojo/sniff"],function(_1){
var _2=_1("fileviewer-panels-textnav"),_3=_1("fileviewer-panels-resize"),_4=_1("files_office365_editor"),_5=_1("fileviewer-office365-without-docseditor"),_6=_1("safari")<8,_7;
_7={isTextNavEnabled:function(){
if(_2&&!_6){
return true;
}
return false;
},isResizeEnabled:function(){
if(_3&&!_6){
return true;
}
return false;
},isOffice365Enabled:function(){
if(_4){
return true;
}
return false;
},isOffice365EnabledWithoutDocsEditor:function(){
if(_4&&_5){
return true;
}
return false;
}};
return _7;
});


;define("ic-share/fileviewer/util/fidoNewRelic",["dojo/_base/lang","dojox/uuid","ic-ui/layout/insights/tracker","ic-ui/layout/insights/NewRelic","dojo/has","dojo/sniff"],function(_1,_2,_3,_4,_5){
var _6=_5("fileviewer-newrelic")||_5("fileviewer-new-relic");
var _7=_2.generateRandomUuid();
var _8="ic.fido";
var _9="Action";
var _a,_b,_c;
var _d={track:function(_e,_f){
if(!_3||!_6||!_e){
return;
}
var _10={"defaultType":_9,"fidoSession":_7,"fileType":(_a.bean.get("type")||"").substring(0,4),"fileId":_a.bean.get("id"),"previewType":_b,"fileSize":_a.bean.get("size"),"panel":(_c||"")};
_1.mixin(_10,_f);
_3.track(_8+"."+_e,_10);
},setPanel:function(_11){
_c=_11;
},setFile:function(_12){
_a=_12;
},setPreview:function(_13){
_b=_13;
}};
return _d;
});


;define("ic-share/fileviewer/util/FileDraftTracker",["dojo/_base/lang","dojo/sniff","dojo/topic","dojo/_base/array","../data/docsApi","dojo/date","dojo/i18n!../nls/FileViewerStrings","dojo/dom-style","dojo/dom-class","dojo/html","../util/feature","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
var _d={},_e={},_f,_10,_11=[],_12=500,_13=2000,_14=3000,_15=150*1000;
function _16(){
return _f||_10;
};
function _17(_18){
return _d[_18.file.args.id];
};
function _19(_1a){
_e[_1a.fileID]=false;
var _1b=_1.partial(_1c,_1a);
_5.getDraftInformation({id:_1a.fileID}).then(_1b,_1b);
};
function _1c(_1d,_1e){
if(!(_1e instanceof Error)){
if(!_1e.get("hasChanges")){
_1f(_1d);
return;
}
if(_1e.get("latestVersionModified")>_d[_1d.fileID]){
_1f(_1d);
return;
}
}
_20(_1d);
};
function _20(_21){
if(_e[_21.fileID]){
return;
}
var _22=_12;
if(_23(_15,_d[_21.fileID])){
_d[_21.fileID]=false;
_3.publish("ic-fileviewer/autopublishFailed",_21);
return;
}else{
if(_23(_14,_d[_21.fileID])){
_22=_13;
}
}
_e[_21.fileID]=setTimeout(_1.partial(_19,_21),_22);
};
function _23(_24,d1,d2){
var _25;
d2=d2||new Date();
_25=_6.difference(d1,d2,"millisecond")>_24;
return _25;
};
function _1f(_26){
_d[_26.fileID]=false;
_3.publish("ic-fileviewer/autopublishComplete",_26);
};
if(_2("fileviewer-ir-autopublish")){
_3.subscribe("lconn/share/action/completed",function(_27){
if(!_1.getObject("autoPublish",false,_27)){
return;
}
var id=""+_27.fileID;
if(!_d[id]){
_d[id]=new Date();
_3.publish("ic-fileviewer/autopublishing",{fileID:id});
}
});
}
function _28(){
_4.forEach(_11,function(sub){
_f=false;
sub.remove();
_11=[];
});
};
function _29(_2a,_2b){
if(_2a.data){
var _2c=_2a.data;
if(typeof _2c==="string"){
try{
_2c=JSON.parse(_2c);
}
catch(e){
}
}else{
_2c=_1.clone(_2c);
}
if(_b.isOffice365Enabled()&&_2c==="MSOfficeRefresh"){
_2b.bean.load().then(function(){
_3.publish("ic-fileviewer/push/messages",{type:"success",message:_7.ACTION.OFFICE_EDITED.SUCCESS||"The file is being saved.",cancelable:true});
});
}
}
};
function _2d(_2e){
var _2f=_2e.file;
if(_b.isOffice365Enabled()){
window.addEventListener("message",function(){
_29(event,_2f);
});
}
_28();
_11.push(_3.subscribe("ic-fileviewer/autopublishing",function(_30){
_2f.bean.getDocsDraftInfo().then(function(){
var _31=_2f.bean.get("docsDraftInfo").editors;
if(_31&&_31.length>0){
return;
}
if(_30.fileID==_2f.bean.get("id")){
_f=true;
_20(_30);
_3.publish("ic-fileviewer/refreshPreview");
_3.publish("ic-fileviewer/push/clearMessages",{forceRemove:true});
}
});
}));
_11.push(_3.subscribe("ic-fileviewer/manualpublishing",_1.hitch(this,function(_32){
_f=true;
_10=true;
_d[_2f.bean.get("id")]=true;
_3.publish("ic-fileviewer/refreshPreview");
})));
_11.push(_3.subscribe("ic-fileviewer/autopublishComplete",function(_33){
if(_33.fileID==_2f.bean.get("id")){
_f=false;
_10=false;
_3.publish("ic-fileviewer/push/clearMessages",{forceRemove:true});
_2f.bean.load().then(function(){
_3.publish("ic-fileviewer/refreshPreview");
});
}
}));
_11.push(_3.subscribe("ic-fileviewer/autopublishFailed",function(_34){
if(_34.fileID==_2f.bean.get("id")){
_f=false;
_10=false;
_3.publish("ic-fileviewer/push/clearMessages",{forceRemove:true});
if(_7.PREVIEW.VIEWER.AUTOPUBLISH_TIMEOUT){
_3.publish("ic-fileviewer/push/messages",{type:"error",message:_7.PREVIEW.VIEWER.AUTOPUBLISH_TIMEOUT});
}
_2f.bean.load().then(function(){
_3.publish("ic-fileviewer/refreshPreview");
});
}
}));
_11.push(_3.subscribe("ic-fileviewer/closed",_28));
_2f.bean.watch("docsDraftInfo",function(){
if(_d[_2f.args.id]&&!_f){
_f=true;
_3.publish("ic-fileviewer/push/clearMessages",{forceRemove:true});
_1c({fileID:_2f.bean.get("id")},_2f.bean.get("docsDraftInfo"));
}
});
};
return {isSessionPublishing:_16,isPublishingInProgress:_17,init:_2d};
});


;define("ic-share/fileviewer/preview/ViewerPreview",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/ViewerPreview.html","dojo/string","dojo/_base/lang","dojo/_base/config","dojo/dom-style","dojo/dom-class","dojo/i18n!../nls/FileViewerStrings","dojo/sniff","dojo/promise/all","./util","../config/globals","../util/url","dojo","dojo/on","dojo/dom-construct","dojo/html","../util/FileDraftTracker"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,on,_11,_12,_13){
"use strict";
var _14=_1([_2,_3],{templateString:_4,previewId:"docs",postMixInProperties:function(){
this.nls=_a.PREVIEW.VIEWER;
this.blankGif=_7.blankGif||this._blankGif;
if(_13.isPublishingInProgress({file:this.file})&&_13.isSessionPublishing()){
this.loadingMessage=_a.PREVIEW.VIEWER.PUBLISHING||"Publishing...";
}else{
this.loadingMessage=_a.PREVIEW.VIEWER.LOADING;
}
},postCreate:function(){
if(this.file.type==="verse"){
var _15=this.file.args.preview;
if(!_15||!_15.then){
this._onError();
}else{
_15.then(_6.hitch(this,function(_16){
this._showViewer(_16);
}),_6.hitch(this,this._onError));
}
}else{
var _17=this.file;
_13.init({file:_17});
if(_13.isPublishingInProgress({file:this.file})){
_12.set(this.loadingMessageNode,_a.PREVIEW.VIEWER.PUBLISHING||"Publishing...");
_9.add(this.domNode,"ics-viewer-publishing");
_8.set(this.loading,"display","block");
return;
}
if(this.file.bean.get("isDocsFile")&&(this.file.bean.get("size")===0)){
this._onError(_a.PREVIEW.VIEWER.NO_PUBLISHED_VERSION);
return;
}
_c({hasViewerEntitlement:this.entitlements.getViewerDfd(),file:this.file.bean.get("fullEntry")}).then(_6.hitch(this,function(_18){
if(_18.hasViewerEntitlement&&!_18.file.isEncrypted){
this._showViewer(this.getViewerLink(this.file.args.id));
}else{
this._onError();
}
}));
}
},_showViewer:function(_19){
this.frame=_11.create("iframe",{className:"viewer-frame",allowtransparency:"true",frameBorder:"0",title:this.nls.IFRAME_TITLE,src:_19});
if(_b("ie")<=8&&this.frame.attachEvent){
this.frame.attachEvent("onload",_6.hitch(this,this._onFrameLoad),false);
}else{
on(this.frame,"load",_6.hitch(this,"_onFrameLoad"));
}
_11.place(this.frame,this.iframeContainer);
},getViewerLink:function(_1a){
var url,_1b,_1c,_1d,_1e;
var _1f={mode:"compact",focusWindow:false,lang:_10.locale};
_1d=this.file.bean.get("cmisDocumentId");
if(_e.isCCM(this.file)){
_1c=this.file.bean.get("draftStatus");
if(_1c){
_1b=_1d;
}else{
if(!_1d){
_1b=this.file.bean.get("cmisVersionId");
}else{
_1b=this.file.bean.get("cmisVersionSeriesId");
}
}
url=this.services.getViewerUrl()+"/app/ecm/${ccmId}@${repositoryName}/content?";
}else{
if(_b("docs-viewer-next")){
url=this.services.getViewerUrl()+"/verse/app/vsfiles/${id}/content?";
}else{
url=this.services.getViewerUrl()+"/app/lcfiles/${id}/content?";
}
}
var _20=_f.rewrite(url,_1f);
return _5.substitute(_20,{id:_1a,ccmId:_1b,repositoryName:this.file.bean.get("repositoryName")});
},_onError:function(_21){
setTimeout(_6.hitch(this,function(){
this.errorHandler(_21);
}));
},_onFrameLoad:function(){
_8.set(this.loading,"display","none");
}});
return {create:function(_22){
return new _14(_22);
},isValid:function(_23){
return !_23.args.isEncrypted&&_d.isFileViewable(_23);
}};
});


;define("dojo/text!ic-share/fileviewer/preview/templates/ImagePreview.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-zoom-widget" data-dojo-attach-point="imagePreview">\n	<div class="ics-viewer-image-preview">\n		<span class="align-helper"></span>\n		<img class="ics-zoom-img" src="${ui.src}" alt=""\n			data-dojo-attach-event="onclick:_cancelEvent, load:onLoad, error:onError"\n			data-dojo-attach-point="image" />\n	</div>\n	<div class="ics-zoom-buttons-helper">\n	<div class="ics-zoom-buttons" data-dojo-attach-event="onclick:_cancelEvent">\n      <a title="${nls.ZOOM_OUT}" href=javascript:; data-dojo-attach-event="onclick:zoomOut, onclick:_cancelEvent" aria-describedby="${id}_describe_zoomout" role="button">\n      <img class="ics-zoomOut-button" src="${blank}" alt="" tabindex="-1" /><span class="lotusAltText fileViewerIconText">${nls.ZOOM_OUT}</span>\n      </a>\n      <span class="lotusAccess" id="${id}_describe_zoomout">${nls.ZOOM_OUT_A11Y}</span>\n      <a title="${nls.RESET}" href=javascript:; data-dojo-attach-event="onclick:reset, onclick:_cancelEvent" aria-describedby="${id}_describe_reset" role="button">\n      <img class="ics-restore-button" src="${blank}" alt="" tabindex="-1" /><span class="lotusAltText fileViewerIconText">${nls.RESET}</span>\n      </a>\n      <span class="lotusAccess" id="${id}_describe_reset">${nls.RESET_ZOOM_A11Y}</span>\n      <a title="${nls.ZOOM_IN}" href=javascript:; data-dojo-attach-event="onclick:zoomIn, onclick:_cancelEvent" aria-describedby="${id}_describe_zoomin" role="button">\n      <img class="ics-zoomIn-button" src="${blank}" alt="" tabindex="-1" /><span class="lotusAltText fileViewerIconText">${nls.ZOOM_IN}</span>\n      </a>\n      <span class="lotusAccess" id="${id}_describe_zoomin">${nls.ZOOM_IN_A11Y}</span>\n	</div>\n	</div>\n</div>\n');

;define("ic-share/fileviewer/config/bannerHeight",[],function(){
"use strict";
return {height:50};
});


;define("ic-share/fileviewer/preview/ImagePreview",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/ImagePreview.html","./util","../config/bannerHeight","dojo/_base/array","dojo/dom-style","dojo/dom-class","dojo/_base/window","dojo/on","dojo/_base/lang","dojo/sniff","dojo/_base/config","dojo/i18n!../nls/FileViewerStrings","../util/url","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,on,_b,_c,_d,_e,_f,_10){
"use strict";
var _11=1,_12=-1,_13=["jpg","jpeg","png","gif"],_14=_1([],{constructor:function(_15){
this.image=_15;
this.zoomToFit=true;
},setNaturalParams:function(_16,_17){
this.naturalHeight=_16;
this.naturalWidth=_17;
},getHeight:function(){
return this.image.height;
},setHeight:function(_18){
_8.set(this.image,"height",_18+"px");
},getWidth:function(){
return this.image.width;
},setWidth:function(_19){
_8.set(this.image,"width",_19+"px");
},getNaturalHeight:function(){
return this.image.naturalHeight||this.naturalHeight;
},getNaturalWidth:function(){
return this.image.naturalWidth||this.naturalWidth;
},getCurrentScale:function(){
return (this.getHeight()/this.getNaturalHeight());
},getZoomToFit:function(){
return this.zoomToFit;
},setZoomToFit:function(){
_9.add(this.image,"ics-zoomToFit");
_8.set(this.image,"height","");
this.zoomToFit=true;
},removeZoomToFit:function(){
_9.remove(this.image,"ics-zoomToFit");
this.zoomToFit=false;
}}),_1a=_1([_2,_3],{_WidgetBase:_2,templateString:_4,firstZoom:true,initializing:true,previewId:"image",postMixInProperties:function(){
this.nls=_e.PREVIEW.IMAGE;
var _1b,_1c;
_1b=_5.isFileViewable(this.file.args.type);
_1c=_1b?this.file.args.links.thumbnail:this.file.args.links.download;
_1c=_1c.replace("renditionKind=mediumview","renditionKind=largeview");
_1c=_f.rewrite(_1c,{versionNum:this.file.bean.get("version")});
if(_1c.indexOf("/draft/")>0){
_1c=_f.rewrite(_1c,{draftTime:(new Date()).getTime()});
}
this.ui={src:_1c};
this.blank=_d.blankGif||dijit._WidgetBase.prototype._blankGif;
},postCreate:function(){
if(!this.imageController){
this.imageController=new _14(this.image);
}
this._increments=[0.1,0.25,0.5,0.75,1,1.25,1.5,1.75,2,4];
this.currentScale=0;
this.scale=_7.indexOf(this._increments,1);
if(_c("ie")<10){
_8.set(this.imagePreview,"height",((_a.doc.documentElement.clientHeight-_6.height)+"px"));
this.eventHandler=on(_a.global,"resize",_b.hitch(this,function(){
_8.set(this.imagePreview,"height",((_a.doc.documentElement.clientHeight-_6.height)+"px"));
}));
}
this.reset();
this.initializing=false;
},onLoad:function(){
if(!(this.imageController.getNaturalHeight()>0)){
this.imageController.removeZoomToFit();
this.imageController.setNaturalParams(this.image.height,this.image.width);
this.imageController.setZoomToFit();
}
this.updateCurrentScale();
},reset:function(_1d){
this.imageController.setZoomToFit();
this.updateCurrentScale();
this.firstZoom=true;
if(!this.initializing){
_10.track("image.reset");
}
},getZoomScale:function(){
return this._increments[this.scale];
},getCurrentScale:function(){
return this.currentScale;
},updateCurrentScale:function(){
this.currentScale=this.imageController.getCurrentScale();
},zoomIn:function(){
this._zoom(_11);
},zoomOut:function(){
this._zoom(_12);
},_zoom:function(_1e){
var _1f=0;
var _20=_1e;
if(this.imageController.getZoomToFit()){
this.enableZoom();
if(_1e===_11&&this.getCurrentScale()<this.getZoomScale()){
_1e=_1f;
}
}
this.scale+=_1e;
this.scale=_5.clamp(this.scale,0,(this._increments.length-1));
this.imageController.setHeight((this.getZoomScale()*this.imageController.getNaturalHeight()));
this.updateCurrentScale();
if(_20>=0){
_10.track("image.zoomIn",{"zoomFactor":this._increments[this.scale]});
}else{
_10.track("image.zoomOut",{"zoomFactor":this._increments[this.scale]});
}
},enableZoom:function(){
this.updateCurrentScale();
this.imageController.removeZoomToFit();
_7.some(this._increments,function(_21,_22){
if(this.currentScale<=_21){
this.scale=_22;
return true;
}
},this);
this.firstZoom=false;
},_cancelEvent:function(_23){
_23.stopPropagation();
},onError:function(){
if(this.errorHandler){
this.errorHandler();
}
},destroy:function destroy(){
if(this.eventHandler){
this.eventHandler.remove();
}
this.inherited("destroy",[]);
}});
return {create:function(_24){
return new _1a(_24);
},isSafeForPreview:function(_25){
var _26=_e.PREVIEW.IMAGE.UNSAFE_PREVIEW||"This file cannot be previewed because it has not been scanned for viruses.";
return _5.isPreviewSafe(_25,_26);
},isValid:function(_27){
return (_7.indexOf(_13,_27.args.type)>-1||_5.isFileViewable(_27))&&this.isSafeForPreview(_27);
}};
});


;define("dojo/text!ic-share/fileviewer/preview/text/TextFileViewer.html", '<div class="textfileviewer" data-sbw-bind="text:class!_toggleEmpty, loading:class!keyDashValue, error:class!keyDashValue">\n   <div class="textfileviewer-loading-indicator"><div>Loading...</div></div>\n   <div class="textfileviewer-message textfileviewer-empty-indicator">This file is empty</div>\n   <div class="textfileviewer-message textfileviewer-error-indicator">This file cannot be displayed</div>\n   <pre class="textfileviewer-content line-numbers" data-sbw-bind="type:class!_getLanguageClass"><code data-sbw-bind="text!_escape, type:class!_getLanguageClass"></code></pre>\n</div>');

;define("ic-share/fileviewer/preview/text/TextFileModel",["dojo/_base/declare","dojo/Stateful","dojo/_base/lang"],function(_1,_2,_3){
return _1([_2],{constructor:function(){
this.watch("text",_3.hitch(this,function(){
this._setValue("loading",false);
this._setValue("error",false);
}));
this.watch("loading",_3.hitch(this,function(){
if(this.get("loading")){
this._setValue("error",false);
}
}));
this.watch("error",_3.hitch(this,function(){
if(this.get("error")){
this._setValue("loading",false);
}
}));
},_setValue:function(_4,_5){
if(this.get(_4)!==_5){
this.set(_4,_5);
}
}});
});


;define("ic-share/fileviewer/preview/text/TextFileViewer",["dojo/_base/declare","../../sbw/StatefulBackedTemplatedWidget","dojo/text!./TextFileViewer.html","./TextFileModel","dojo/_base/lang","dojox/html/entities"],function(_1,_2,_3,_4,_5,_6){
var _7={js:"javascript",html:"markup",xml:"markup",xslt:"markup",xsd:"markup",sh:"bash",feature:"gherkin",m:"matlab",py:"python",rb:"ruby"};
function _8(_9){
return _7[_9]||_9;
};
var _a=_1([_2],{templateString:_3,postCreate:function(){
this.inherited(arguments);
this.model.watch("text",_5.hitch(this,function(){
setTimeout(function(){
Prism.highlightAll();
},1);
}));
},_escape:function(_b){
return _6.encode(_b);
},_getLanguageClass:function(_c){
return "language-"+_8(_c);
},_toggleEmpty:function(_d){
return _d?"textfileviewer-nonempty":"textfileviewer-empty";
}});
return {createEmptyViewer:function(){
var _e=new _4();
return new _a({model:_e});
}};
});


;define("ic-share/fileviewer/preview/TextFilePreview",["./text/TextFileViewer","dojo/request","dojo/_base/array","dojo/when","dojo/dom-construct","ic-core/config/services","ic-core/url","dojo/has"],function(_1,_2,_3,_4,_5,_6,_7,_8){
"use strict";
var _9=["txt","js","html","sh","feature","css","c","cpp","git","ini","java","less","m","perl","php","py","rb","sql","xml","xsd","xslt","yaml","log"];
function _a(){
var _b=_7.getServiceUrl(_6.webresources);
_5.create("link",{rel:"stylesheet",href:_b+"/web/ic-share/fileviewer/preview/text/prism.css"},document.getElementsByTagName("head")[0]);
_5.create("script",{src:_b+"/web/ic-share/fileviewer/preview/text/prism.js"},document.getElementsByTagName("head")[0]);
};
if(_8("fileviewer-preview-text")){
_a();
}
return {create:function(_c){
var _d=_1.createEmptyViewer();
_d.previewId="text";
_d.model.set("loading",true);
_4(_c.file.bean.get("fullEntry"),function(){
var _e=_c.file.bean.get("name");
_2(_c.file.bean.get("downloadUrl"),{handleAs:"text",withCredentials:true}).then(function(_f){
_d.model.set({type:_e.slice(_e.lastIndexOf(".")+1),text:_f});
},function(_10){
console.error("An error occurred loading the file",_e,_10);
_d.model.set({error:true});
});
});
return _d;
},isValid:function(_11){
return _8("fileviewer-preview-text")&&_3.indexOf(_9,_11.bean.get("type"))>-1;
}};
});


;define("dojo/text!ic-share/fileviewer/preview/templates/IconPreview.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-viewer-icon-preview">\n   <span class="align-helper"></span>\n   <div data-dojo-attach-event="onclick:_stopProp">\n	   <div>\n	      <img src="${blank}" class="${iconClass}" alt="" />\n	      <br />\n         <span aria-label="${noPreviewMessage}" tabindex="0">${noPreviewMessage}</span>\n	   </div>\n   </div>\n</div>\n');

;define("ic-share/fileviewer/preview/IconPreview",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/IconPreview.html","dojo/_base/config","dojo/i18n!../nls/FileViewerStrings","./util","../util/FileDraftTracker","../config/documentTypes","dojo/_base/array"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
var _b=_1([_2,_3],{templateString:_4,previewId:"icon",postMixInProperties:function(){
this.blank=_5.blankGif||dijit._WidgetBase.prototype._blankGif;
this.iconClass=_7.getIconClass(this.file.args,64);
this.noPreviewMessage=!!this.userMessage?this.userMessage:_6.PREVIEW.ICON.PREVIEW_NOT_AVAILABLE;
this.model=this.file.bean;
if(_a.indexOf(_9.edit,this.file.args.type)>-1){
_8.init({file:this.file});
}
},_stopProp:function(_c){
_c.stopPropagation();
}});
return {create:function(_d){
return new _b(_d);
},isValid:function(){
return true;
}};
});


;define("ic-share/fileviewer/preview/previews",["./VideoJSPreview","./VideoPreview","./ViewerPreview","./ImagePreview","./TextFilePreview","./IconPreview"],function(_1,_2,_3,_4,_5,_6){
"use strict";
return [_1,_2,_3,_4,_5,_6];
});


;define("dojo/text!ic-share/fileviewer/widget/templates/ToolbarDivider.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<li />\n');

;define("ic-share/fileviewer/widget/ToolbarDivider",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/ToolbarDivider.html","../config/globals"],function(_1,_2,_3,_4,_5){
var _6=_1([_2,_3],{templateString:_4,set:function(_7){
if(_7!=="parentNode"){
this.inherited(arguments);
}
}});
return {isSubItem:false,isSticky:true,realAction:false,create:function(_8){
return new _6(_8);
},isValid:function(_9){
if(_5.isPanels(_9)){
return true;
}else{
return false;
}
},getClassName:function(){
return "divider";
}};
});


;define("dojo/text!ic-share/fileviewer/action/templates/Action.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div>\n   <a href="${href}" title="${title}" class="actionLink" data-dojo-attach-point="link" data-dojo-attach-event="click:onLinkClicked" aria-describedby="${id}_describe" role="button">\n      <span data-dojo-attach-point="linkText" class="linkText">${name}</span>\n      <img src="${blank}" alt="" data-dojo-attach-point="img" />\n      <span data-dojo-attach-point="altText" class="lotusAltText fileViewerIconText">${title}</span>\n   </a>\n   <span class="lotusAccess" id="${id}_describe" data-dojo-attach-point="describedBy">${a11y}</span>\n</div>\n');

;define("ic-share/fileviewer/action/Action",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/Action.html","dojo/_base/config","dojo/dom-attr","dojo/html","dijit/focus","dojo/dom-class"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
return _1([_2,_3],{templateString:_4,_setNameAttr:{node:"linkText",type:"innerHTML"},_setA11yAttr:{node:"describedBy",type:"innerHTML"},constructor:function(){
this.blank=_5.blankGif||dijit._WidgetBase.prototype._blankGif;
this.title="";
this.name="";
this.a11y="";
this.href="javascript:;";
},onLinkClicked:function(){
return;
},focus:function(){
_8.focus(this.link);
},_setTitle:function(_a){
this.title=_a;
_6.set(this.link,"title",_a);
_7.set(this.altText,_a);
},_setTitleAttr:function(_b){
this._setTitle(_b);
},hide:function(){
if(this.parentNode){
_9.add(this.parentNode,"lotusHidden");
}
},show:function(){
if(this.parentNode){
_9.remove(this.parentNode,"lotusHidden");
}
},set:function(_c){
if(_c!=="parentNode"){
this.inherited(arguments);
}
}});
});


;define("dojo/text!ic-share/fileviewer/dialog/templates/ConfirmationDialog.html", '<!-- Copyright IBM Corp. 2015, 2016  All Rights Reserved.                    -->\n<div class="ics-dialog-action">\n	<div class="errorContainer" data-dojo-attach-point="errorContainer"></div>\n	<div class="prompt-container" data-dojo-attach-point="promptContainer">\n        <span data-dojo-attach-point="promptSpan"></span>\n    </div>\n	<div class="button-container" data-dojo-attach-point="buttonContainer">\n		<a class="confirm bad ics-viewer-ok-button" href="javascript:;"\n			data-dojo-attach-event="onclick:clickLink" data-dojo-attach-point="okButton" id="ok" role="button">${nls.OK}</a>\n		<a class="cancel neutral ics-viewer-cancel-button" href="javascript:;"\n			data-dojo-attach-event="onclick:clickLink" id="cancel" role="button">${nls.CANCEL}</a>\n	</div>\n</div>\n');

;define("ic-share/fileviewer/dialog/DialogAction",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin"],function(_1,_2,_3){
"use strict";
return _1([_2,_3],{templateString:"<div></div>",constructor:function(_4){
this.templateString=_4.template||this.templateString;
},showError:function(){
},clickLink:function(e){
}});
});


;define("dojo/text!ic-share/fileviewer/widget/templates/MessageBox.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-viewer-messagebox">\n  <table class="ics-viewer-messagebox-table">\n    <tr>\n      <td class="ics-viewer-messagebox-row" valign="top"><img src="${blank}" class="ics-viewer-messagebox-icon" data-dojo-attach-point="icon"></img></td>\n      <td class="ics-viewer-messagebox-row ics-viewer-messagebox-message" data-dojo-attach-point="messageNode"></td>\n      <td class="ics-viewer-messagebox-row ics-viewer-messagebox-message ics-viewer-messagebox-close" data-dojo-attach-point="closeBtn">\n      <a href="javascript:;" role="button" data-dojo-attach-event="click:_close" >x</a></td>\n    </tr>\n  </table>\n</div>\n');

;define("ic-share/fileviewer/widget/MessageBox",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/MessageBox.html","dojo/dom-class","dojo/dom-style","dojo/dom-construct","dojo/_base/config","dojo/_base/lang","ic-ui/MessageBox","dojo/i18n!../nls/FileViewerStrings","dojo/aspect","dijit/focus"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){
var _e=_1([_2,_3],{templateString:_4,postMixInProperties:function(){
this.blank=_8.blankGif||dijit._WidgetBase.prototype._blankGif;
},postCreate:function(){
_5.add(this.icon,this.type);
if(!this.cancelable){
_6.set(this.closeBtn,"display","none");
}
this._hide();
if(this.message){
this.setMessage(this.message);
}
},setMessage:function(_f){
this.removeMessage();
if(_f===""){
return;
}
if(_9.isString(_f)){
var _10=_f;
_f=_7.create("div");
_f.appendChild(document.createTextNode(_10));
}
this.messageNode.appendChild(_f);
this._show();
},removeMessage:function(){
this._hide();
_7.empty(this.messageNode);
},_hide:function(){
_5.add(this.domNode,"lotusHidden");
},_show:function(){
_5.remove(this.domNode,"lotusHidden");
},_close:function(){
this.destroy();
}});
return {create:function(_11){
var _12={"success":_a.TYPE.SUCCESS,"warning":_a.TYPE.WARNING,"info":_a.TYPE.INFO,"error":_a.TYPE.ERROR};
var _13=_12[_11.type];
var _14=_7.create("div");
var _15=new _a({canClose:_11.cancelable,_strings:{icon_alt:"",a11y_label:"",close_btn_title:_b.ACTION.CLOSE.TOOLTIP,close_btn_alt:_b.ACTION.CLOSE.TOOLTIP},type:_13,msg:_11.message,messageOptions:_11,isSticky:_11.isSticky,focusPostClose:_11.focusPostClose||this.firstFocusable},_14);
_15.msgBody.style.color="#222";
_15._hide=function(){
_5.add(this.domNode,"lotusHidden");
};
_15._show=function(){
_5.remove(this.domNode,"lotusHidden");
};
_15.removeMessage=function(){
this._hide();
_7.empty(this.msgBody);
};
_15.setMessage=function(_16){
this.removeMessage();
if(_16===""){
return;
}
if(_9.isString(_16)){
var _17=_16;
_16=_7.create("div");
_16.appendChild(document.createTextNode(_17));
}
this.msgBody.appendChild(_16);
this._show();
};
_c.after(_15,"startup",function(){
if(_11.focus){
_d.focus(_15.closeBtn);
}
});
return _15;
}};
});


;define("ic-core/util/connectionsUrlUtil",["dojo/io-query","dojo/string","dojo/_base/array","dojo/_base/url"],function(_1,_2,_3,_4){
"use strict";
var _5="/wikis/home(|\\?[^/#]*#!)/wiki/([^/?#]+)(/page/[^/?#]+)?",_6="/blogs/([^/?#]+)(|/entry/[^/?#]+)",_7="/forums/html/(topic|forum)\\?([^#]+)",_8="/service/html/";
return {isConnectionsFileUrl:function(_9){
return !!this.getFileId(_9);
},shouldOpenPreview:function(_a){
var _b=_c(_a);
if(_b){
var _d=["fullpageWidgetId","communityUuid","debug"];
var _e=["fullpageWidgetId","file"];
if(!_f(_b.parameters,_d)||!_f(_b.fragmentParameters,_e)){
return false;
}
return !!_b.fragmentParameters.file||false;
}
_b=_10(_a);
if(_b){
var _d=["debug"];
var _e=[];
if(!_f(_b.parameters,_d)||!_f(_b.fragmentParameters,_e)){
return false;
}
return !!(_b.type==="file"&&_b.id)||false;
}
return false;
},shouldOpenConnectionsPreview:function(url){
if(_11(url)){
return false;
}
var uri=new _4(url),_12;
if(uri.host!==window.location.host){
return false;
}
if(!this.isConnectionsFileUrl(url)){
return false;
}
_12=this.getFileId(url);
if(_12.indexOf("{")===0){
return false;
}
return true;
},isConnectionsFolderUrl:function(url){
return !!this.getFolderId(url);
},isCommunityWidgetUrl:function(url){
return !!_c(url);
},isFilesAppUrl:function(url){
return !!_10(url);
},getUrlType:function(url){
try{
var _13=decodeURIComponent(url);
}
catch(e){
console.error(e);
return "";
}
var _14="";
if(!!_13.match(new RegExp(_5))){
_14="wiki";
}else{
if(!!_13.match(new RegExp(_6))){
_14="blog";
}else{
if(!!_13.match(new RegExp("/communities"+_8+"community[^?]+\\?[^?#/]+"))){
_14="community";
}else{
if(!!_13.match(new RegExp("/activities"+_8+"mainpage(|[^#/]+)(|#[^?#/]+)"))){
_14="activity";
}else{
if(!!_13.match(new RegExp(_7))){
_14="forum";
}
}
}
}
}
return _14;
},getFileId:function(url){
var _15=_c(url);
if(_15){
return _15.fragmentParameters.file||null;
}
_15=_10(url);
if(_15){
return (_15.type==="file"&&_15.id)||null;
}
_15=_16(url);
if(_15){
return _15.id||null;
}
return null;
},getFolderId:function(url){
var _17=_c(url);
if(_17){
return _17.fragmentParameters.folder||null;
}
_17=_10(url);
if(_17){
return (_17.type==="folder"&&_17.id)||null;
}
return null;
},getDownloadFileUrl:function(url){
if(_11(url)){
return url;
}
var _18=this.getFileId(url);
if(_18){
var _19;
if(_1a(url)){
_19=url.substring(0,url.indexOf("/files/"));
}else{
_19=url.substring(0,url.indexOf("/communities/"));
}
return _2.substitute(_19+"/files/form/anonymous/api/document/${fileId}/media",{fileId:_18});
}else{
return "";
}
},getViewFileUrl:function(url){
},getViewFileJS:function(url){
}};
function _c(url){
try{
var _1b=decodeURIComponent(url);
}
catch(e){
console.error(e);
return null;
}
var _1c=_1b.match(new RegExp("/communities"+_8+"[^?]+\\?([^#]*)#(\\S+)"));
if(!_1c){
return null;
}
var _1d=_1.queryToObject(_1c[1]);
var _1e=_1.queryToObject(_1c[2]);
if(_1d.communityUuid&&(_1d.fullpageWidgetId||_1e.fullpageWidgetId)){
return {parameters:_1d,fragmentParameters:_1e};
}else{
return null;
}
};
function _10(url){
try{
var _1f=decodeURIComponent(url);
}
catch(e){
console.error(e);
return null;
}
var _20=_1f.match(new RegExp("/app(|#|\\?([^#/]*)#)/([^/]+)/([^?/#]*)(\\?([^?]*))?"));
if(!_20){
return null;
}
var _21,_22;
if(_20[1].indexOf("#")!==-1){
_21=_20[2];
_22=_20[6];
}else{
_21=_20[6];
_22=undefined;
}
var _23=_1.queryToObject(_21||"");
var _24=_1.queryToObject(_22||"");
var _25=_20[3];
var id=_20[4];
return {type:_25,id:id,parameters:_23,fragmentParameters:_24};
};
function _16(url){
try{
var _26=decodeURIComponent(url);
}
catch(e){
console.error(e);
return null;
}
var _27=_26.match(new RegExp("/form/(anonymous/)?api/(library/[^/]+/)?document/([^/]+)/media(/[^/#?]+/|/[^/#?]+|/|)(\\?|#|$)"));
if(!_27){
return null;
}
var id=_27[3];
return {id:id};
};
function _1a(url){
return !!_10(url);
};
function _11(url){
return !!_16(url);
};
function _f(_28,_29){
for(var _2a in _28){
if(_3.indexOf(_29,_2a)===-1){
return false;
}
}
return true;
};
});


;define("ic-share/fileviewer/util/history",["dojo/hash","dojo/string","dojo/_base/lang","../data/util/routes","dojo/i18n!../nls/FileViewerStrings","dojo/has","ic-core/util/connectionsUrlUtil","dojo/on","dojo/topic","./url","../config/globals"],function(_1,_2,_3,_4,_5,_6,_7,on,_8,_9,_a){
"use strict";
if(!window._historyUtilPopstateHandle){
window._historyUtilPopstateHandle=on(window,"popstate",function(e){
var _b=_3.getObject("state.fileId",false,e);
if(_b){
_c(_b);
}
});
}
if(!window._historyUtilHashchangeHandle&&_6("fileviewer-detailspage")){
window._historyUtilHashchangeHandle=_8.subscribe("/dojo/hashchange",_3.hitch(this,function(){
if(window.location.href!==window._historyUtilCurrentFileUrl&&_7.shouldOpenConnectionsPreview(window.location.href)){
_c(_7.getFileId(window.location.href));
}
}));
}
function _c(_d){
window["ic-share"].fileviewer.ConnectionsFileViewer.openFromId(_d);
};
function _e(_f,_10,_11){
var url,_12,_13=_4.doesPageSupportFileHash();
if(_14.historySupported&&_10.full){
url=_9.removeHost(_10.full);
if(url===_9.removeHost(window.location.href)){
return;
}
if(_11){
window.history.replaceState(_f,null,url);
}else{
window.history.pushState(_f,null,url);
}
}else{
if(_4.doesPageSupportFileHash()&&_10.hashed){
url=_10.hashed;
_12="#"+_9.createUri(url).fragment;
if(_12===window.location.hash){
return;
}
if(_11){
window.location.replace(_12);
}else{
window.location=_12;
}
}
}
};
var _15;
_16();
function _16(){
if(window.location.href!==_15&&!_7.isConnectionsFileUrl(window.location.href)){
_15=window.location.href;
}
};
setInterval(_16,250);
var _14={onOpen:function(_17,_18){
if(!this._shouldUpdateHistory(_17)){
return;
}
var _19=_18.isOpen,_1a,_1b=false;
if(_7.isConnectionsFileUrl(window.location.href)&&_7.getFileId(window.location.href)===_17.args.id){
_19=true;
_1b=true;
}
_16();
this._setFileUrl(_17,_19,_1b);
_1a=!_17.args.loadError?_2.substitute(_5.WINDOW_TITLE.FILE,{fileName:_17.args.name}):_5.WINDOW_TITLE.LOAD_ERROR;
this._setTitle(_1a);
},_setFileUrl:function(_1c,_1d,_1e){
this.backgroundPageUrl=_15;
if(!this.backgroundPageUrl){
this.backgroundPageUrl=_4.getClosedFileUrlHashed();
}
var _1f,_20;
_1f=this._getFileUrls(_1c,_1e);
_e({fileId:_1c.args.id},_1f,_1d);
_20=window.location.href;
this.currentFileUrl=_20;
window._historyUtilCurrentFileUrl=this.currentFileUrl;
},onClose:function(_21,_22){
if(!this._shouldUpdateHistory(_22)){
return;
}
if(!_21.isOpening&&this.currentFileUrl===window.location.href){
this._setClosedFileUrl();
}
this._unsetTitle(_21.isOpening);
this.currentFileUrl=undefined;
window._historyUtilCurrentFileUrl=this.currentFileUrl;
},_getFileUrls:function(_23,_24){
var _25,_26;
_26=_24?window.location.href:_23.args.links.linkTarget;
if(_26){
_25={full:_9.fromFilesAnchorForm(_26)+"",hashed:_9.toFilesAnchorForm(_26)+""};
}else{
_25=this._getDefaultFileUrls(_23);
}
return _25;
},_getDefaultFileUrls:function(_27){
return {full:_27.args.links.details,hashed:_9.toFilesAnchorForm(_27.args.links.details)+""};
},removeFileParameters:function(_28){
_e({fileId:_28.args.id},this._getDefaultFileUrls(_28),true);
this.currentFileUrl=window.location.href;
},_setClosedFileUrl:function(){
var _29=_4.getClosedFileUrlHashed(this.backgroundPageUrl);
var _2a={full:this.backgroundPageUrl||_29,hashed:_29};
_e({},_2a,false);
if(!this.backgroundPageUrl){
this.backgroundPageUrl=window.location.href;
}
},_setTitle:function(_2b){
this._currentTitle=_2b;
this._backgroundPageTitle=this._backgroundPageTitle||window.document.title;
this._titleCheckId=setInterval(_3.hitch(this,function(){
if(window.document.title!==this._currentTitle){
this._backgroundPageTitle=window.document.title;
window.document.title=this._currentTitle;
}
}),500);
this._titleChangeListener=_8.subscribe("ic-fileviewer/filenamechanged",_3.hitch(this,function(_2c){
window.document.title=this._currentTitle=_2c.newFileName;
}));
window.document.title=this._currentTitle;
},_unsetTitle:function(_2d){
clearInterval(this._titleCheckId);
this._titleChangeListener.remove();
if(!_2d){
window.document.title=this._backgroundPageTitle;
delete this._backgroundPageTitle;
}
},_shouldUpdateHistory:function(_2e){
return !_a.isIframePage&&_6("fileviewer-detailspage")&&(_4.doesPageSupportFileHash()||_14.historySupported)&&(_2e.args.libraryType!=="library");
}};
_14.historySupported=_6("fileviewer-history")&&!!window.history.pushState;
_14.doesPageSupportFileHash=_4.doesPageSupportFileHash;
return _14;
});


;define("ic-share/fileviewer/util/html",["dojo","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/dom-attr","dojo/has","dojo/query","dojo/string","dojo/topic","dojo/dom-construct","../config/globals","./url","./history"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){
var _e;
_e={setText:function(_f,_10){
_a.empty(_f);
_e.appendText(_f,_10);
},appendText:function(_11,_12){
_11.appendChild(document.createTextNode(_12));
},SUBSTITUTION:/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,substitute:function(d,el,_13,map,_14,_15,sub){
var re=sub||_e.SUBSTITUTION;
el=el||d.createDocumentFragment();
var _16=0;
while(r=re.exec(_13)){
el.appendChild(d.createTextNode(_13.substring(_16,r.index)));
_16=r.index+r[0].length;
var key=r[1];
var _17=r[2];
var _18=_3.getObject(key,false,map);
if(typeof _18=="function"){
_18=_18.apply(_15||map,[key,_17]);
}
if(_17){
_18=_3.getObject(_17,false,_15)(_18);
}
if(_14){
_18=_14(_18,key);
}
if(typeof _18!="undefined"&&_18!=null){
if(_18.nodeType>0){
el.appendChild(_18);
}else{
el.appendChild(d.createTextNode(_18.toString()));
}
}
}
el.appendChild(d.createTextNode(_13.substring(_16)));
return el;
},EMBEDDED_URL_PATTERN:/(^|[\s])(([a-zA-Z]+:\/\/|www\.|mailto:)[^\s]+)/i,URL_PUNCTUATION_BACKTRACK:/[\.,\!;\:\'\"]+$/,createTextNode:function createTextNode_$17(d,el,_19,_1a){
if(!_19){
return;
}
_19=_3.trim(_19);
if(_19.length>0){
var _1b=_19.split("\n");
_2.forEach(_1b,function(_1c,i,arr){
var _1d,_1e;
while(_1d=_e.EMBEDDED_URL_PATTERN.exec(_1c)){
var _1f=_1c.substring(0,_1d.index)+_1d[1];
var _20=_1d[2];
if(_1e=_e.URL_PUNCTUATION_BACKTRACK.exec(_20)){
_20=_20.substring(0,_1e.index);
}
_1c=_1c.substring(_1f.length+_20.length);
var _21=(_1d[3]&&_1d[3].toLowerCase()=="www.");
var _22=(_1d[3]&&_1d[3].toLowerCase()=="mailto:");
var _23=_21?"http://"+_20:_20;
if(_22){
_20=_20.substring(7);
}
if(_1f.length>0){
_e.appendText(el,_1c);
}
var a=_a.create("a");
a.href=_23;
_e.appendText(a,_20);
el.appendChild(a);
}
if(_1c.length>0){
_e.appendText(el,_1c);
}
if(i<arr.length-1){
el.appendChild(!_1a?d.createElement("br"):d.createTextNode(" "));
}
});
}
},breakString:function breakString_$8(s,d,el,_24){
if(!s){
return;
}
_24=_24||10;
var b=new RegExp("[^\\s]{"+(_24+1)+"}","g");
var r;
var _25=0,end;
if(_1.isIE||_1.isWebKit){
while(r=b.exec(s)){
end=--b.lastIndex;
var _26=s.charCodeAt(end-1);
if(_26>=55296&&_26<56192){
end++;
}
if(_26==3588){
end++;
}
for(var i=0;i<s.length-2;i++){
if(s.charCodeAt(i)==3619&&s.charCodeAt(i+1)==3639&&s.charCodeAt(i+2)==3656){
end=9;
break;
}else{
el.appendChild(d.createElement("wbr"));
}
}
el.appendChild(d.createTextNode(s.substring(_25,end)));
_25=end;
}
}else{
while(r=b.exec(s)){
end=--b.lastIndex;
var _26=s.charCodeAt(end-1);
if(_26>=55296&&_26<56192){
end++;
}
if(_26==3588){
end++;
}
for(var i=0;i<s.length-2;i++){
if(s.charCodeAt(i)==3619&&s.charCodeAt(i+1)==3639&&s.charCodeAt(i+2)==3656){
end=9;
break;
}else{
el.appendChild(d.createElement("wbr"));
}
}
el.appendChild(d.createTextNode(s.substring(_25,end)+"\u200b"));
_25=end;
}
}
el.appendChild(d.createTextNode(s.substring(end)));
return el;
},generateLinkToUser:function(_27,_28){
var _29=_a.create("span");
_a.create("span",{className:"x-lconn-userid",style:"display: none;",innerHTML:_27.id},_29);
if(!_3.isFunction(_b.createPersonLink)){
_29.appendChild(document.createTextNode(_27.name));
}else{
_29.appendChild(_b.createPersonLink(_27));
if(_3.isFunction(_b.attachBizCard)){
_b.attachBizCard(_29);
}
}
if(_28){
_28.appendChild(_29);
}
return _29;
},processLink:function(a){
var _2a=_d.backgroundPageUrl,_2b=a.href,_2c=true;
if(_2b.indexOf("javascript:")===0){
_2c=false;
}else{
if(_c.isCommunityUrl(_2a)&&_c.isCommunityUrl(_2b)&&_3.isFunction(this._getWidgetDefId)&&_c.getParameters(_2a).communityUuid===_c.getParameters(_2b).communityUuid){
var _2d=_c.getHashParameters(_2a).fullpageWidgetId;
var _2e=_c.getHashParameters(_2b).fullpageWidgetId;
if(!_2e||(this._getWidgetDefId(_2e)==="Files"&&(!_2d||_2d===_2e))){
_2c=false;
}
}else{
if(_c.isSamePage(_2a,_2b)){
_2c=false;
}
}
}
if(_2c){
a.setAttribute("target","_blank");
}
},_getWidgetDefId:_3.getObject("lconn.core.WidgetPlacement.getWidgetDefId")};
return _e;
});


;define("ic-share/fileviewer/dialog/ConfirmationDialog",["dojo/_base/declare","dojo/text!./templates/ConfirmationDialog.html","dijit/Dialog","dojo/_base/lang","dojo/dom-attr","dijit/registry","./DialogAction","dojo/Evented","../widget/MessageBox","dojo/i18n!../nls/FileViewerStrings","dojo/dom-construct","../util/html","dojo/dom-style","dojo/html","dojo/on"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,on){
return _1([_3,_8],{"class":"confirmationDialog",constructor:function(_f){
this.strings=_4.clone(_f.strings||_a.CONFIRMATION_DIALOG);
if(!this.strings.OK){
this.strings.OK=_a.CONFIRMATION_DIALOG.OK;
}
if(!this.strings.CANCEL){
this.strings.CANCEL=_a.CONFIRMATION_DIALOG.CANCEL;
}
var _10=new _7({template:_2,nls:this.strings});
this._set("title",this.strings.DIALOG_TITLE);
_10.clickLink=_4.hitch(this,function(e){
if(e.target.id==="ok"){
this._errorBox.removeMessage();
this.emit("clicked",{});
}else{
if(e.target.id==="cancel"){
this.onCancel();
}
}
});
_10.startup();
this.content=_10;
},postCreate:function(){
this.inherited(arguments);
var _11=_6.getUniqueId("fileviewer")+"_confirmationDialogContent";
_5.set(this.domNode,"aria-label",this._get("title"));
_5.set(this.domNode,"aria-describedBy",_11);
_5.set(this.content.promptContainer,"id",_11);
_e.set(this.content.promptSpan,this.strings.PROMPT);
var _12={type:"error"};
this._errorBox=_9.create(_12);
this._errorBox._hide();
this._errorBox.placeAt(this.content.errorContainer);
if(this.strings.PROMPT2){
_b.create("br",null,this.content.promptContainer);
_b.create("br",null,this.content.promptContainer);
var _13=_b.create("span",null,this.content.promptContainer);
_c.setText(_13,this.strings.PROMPT2);
}
if(this.showOkRight){
var _14=_b.create("a",{className:"confirm bad ics-viewer-ok-button",href:"javascript:;",id:"ok_right",role:"button"},this.content.buttonContainer);
_c.setText(_14,this.strings.OK);
_d.set(this.content.okButton,"display","none");
on(_14,"click",_4.hitch(this,function(){
this._errorBox.removeMessage();
this.emit("clicked",{});
}));
}
if(this.hideOk){
_d.set(this.content.okButton,"display","none");
}
},showError:function(_15){
this._errorBox.setMessage(_15);
},render:function(){
this.placeAt(document.body);
this.startup();
this.show();
},onCancel:function(){
this.emit("close");
this.inherited(arguments);
}});
});


;define("ic-share/fileviewer/util/DateFormat",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","dojo/_base/config"],function(_1,_2,_3,_4,_5,_6){
var _7=_2([],{MILLS_IN_DAY:86400000,_nls:_3.getObject("DateFormat.prototype._nls"),constructor:function(_8,_9){
this.dt=_8||new Date();
if(_9){
for(var _a in _9){
this[_a]=_9[_a];
}
}
this._transform=_3.hitch(this,this.substitute);
},nls:function(){
if(!this._nls){
throw "Resource bundle must be set to DateFormat.prototype._nls prior to use";
}
return this._nls;
},substitute:function(_b,_c){
var _b=this[_c];
if(typeof _b=="function"){
_b=_b.apply(this,[]);
}
if(typeof _b=="undefined"||_b==null){
_b="${"+_c+"}";
}
return _b;
},toTimestamp:function(){
return this.format(this.nls().DATE.FULL);
},format:function(s){
return _1.string.substitute(s,null,this._transform);
},formatByAge:function(_d){
_d=_d||this.nls().DATE.RELATIVE_TIME;
var _e=this.delta();
if(_e<7&&_e>=-1){
if(_e>=2){
return this.format(_d.DAY);
}else{
if(_e==1){
return this.format(_d.YESTERDAY);
}else{
if(_e==0){
return this.format(_d.TODAY);
}else{
if(_e==-1&&_d.TOMORROW){
return this.format(_d.TOMORROW);
}
}
}
}
}else{
if(new Date().getFullYear()==this.dt.getFullYear()){
return this.format(_d.MONTH);
}
}
return this.format(_d.YEAR);
},delta:function(){
if(typeof this._delta!="undefined"){
return this._delta;
}
this._delta=_7.delta(this.dt,this._currDate||new Date());
return this._delta;
},getDays:function(){
if(!this._days){
_7.prototype._days=_4.getNames("days","wide");
}
return this._days;
},getDaysAbbr:function(){
if(!this._daysAbbr){
_7.prototype._daysAbbr=_4.getNames("days","abbr");
}
return this._daysAbbr;
},getMonths:function(){
if(!this._months){
_7.prototype._months=_4.getNames("months","abbr");
}
return this._months;
},getMonthsWide:function(){
if(!this._monthsWide){
_7.prototype._monthsWide=_4.getNames("months","wide");
}
return this._monthsWide;
},getMonthsShort:function(){
if(!this._monthsShort){
_7.prototype._monthsShort=this.nls().DATE.MONTHS_ABBR;
}
return this._monthsShort;
},Z:function(){
if(!this._Z){
var _f="-";
var _10=this.dt.getTimezoneOffset();
if(_10<0){
_10=Math.abs(_10);
_f="+";
}
var _11=Math.floor(_10/60);
_10%=60;
if(_11<10){
_11="0"+_11;
}
if(_10<10){
_10="0"+_10;
}
_f+=_11+""+_10;
this._Z=_f;
}
return this._Z;
},ZZZZ_REGEX:/\(([^\)]+)\)/,ZZZZ:function(){
if(!this._ZZ){
if(_5("ie")){
var _12=this.dt.toString().split(" ");
this._ZZ=(_12.length>2)?_12[_12.length-2]:this.Z();
}else{
var r=this.ZZZZ_REGEX.exec(this.dt.toString());
this._ZZ=r?r[1]:this.Z();
}
}
return this._ZZ;
},YYYY:function(){
return this.dt.getFullYear();
},EEE:function(_13){
var day=this.dt.getDay();
if(_13>0){
day=(day+7-_13)%7;
}
return this.getDaysAbbr()[day];
},EEEE:function(_14){
var day=this.dt.getDay();
if(_14>0){
day=(day+7-_14)%7;
}
return this.getDays()[day];
},EEee:function(_15){
var _16=this.delta()+(_15?_15:0);
return (_16==0)?this.nls().DATE.TODAY_U:(_16==1)?this.nls().DATE.YESTERDAY_U:this.EEEE(_15);
},eeEE:function(_17){
var _18=this.delta()+(_17?_17:0);
return (_18==0)?this.nls().DATE.TODAY:(_18==1)?this.nls().DATE.YESTERDAY:this.EEEE(_17);
},MMMM:function(){
return this.getMonthsWide()[this.dt.getMonth()];
},MMM:function(){
return this.getMonths()[this.dt.getMonth()];
},MM:function(){
var i=this.dt.getMonth()+1;
return (i>9)?i:("0"+i);
},Mmm:function(){
return this.dt.getMonthsShort()[this.dt.getMonth()];
},d:function(){
return this.dt.getDate();
},dd:function(){
var i=this.dt.getDate();
return (i>9)?i:("0"+i);
},a:function(){
return this.dt.getHours()<12?this.nls().DATE.AM:this.nls().DATE.PM;
},HH:function(){
var i=this.dt.getHours();
return (i>9)?i:("0"+i);
},hh:function(){
var _19=this.dt.getHours();
if(_19>12){
_19-=12;
}else{
if(_19==0){
_19=12;
}
}
return (_19>9)?_19:("0"+_19);
},mm:function(){
var _1a=this.dt.getMinutes();
return (_1a<10)?"0"+_1a:_1a;
},ss:function(){
var _1b=this.dt.getSeconds();
return (_1b<10)?"0"+_1b:_1b;
},date:function(){
return _4.format(this.dt,{selector:"date",formatLength:"short",locale:_6.locale});
},date_long:function(){
return _4.format(this.dt,{selector:"date",formatLength:"long",locale:_6.locale});
},time:function(){
return _4.format(this.dt,{selector:"time",formatLength:"short",locale:_6.locale});
},time_long:function(){
return _4.format(this.dt,{selector:"time",formatLength:"long",locale:_6.locale});
}});
_7.delta=function(_1c,to){
var _1d=_1c.getTime();
var _1e=new Date(to.getTime());
_1e.setHours(0);
_1e.setMinutes(0);
_1e.setSeconds(0);
_1e.setMilliseconds(0);
var _1f=_1e.getTime()-_1d;
var _20=Math.ceil(_1f/(_7.prototype.MILLS_IN_DAY));
return _20;
};
return _7;
});


;define("ic-share/fileviewer/action/DownloadDocsFileMixin",["dojo/_base/declare","dojo/i18n!../nls/FileViewerStrings","dojo/string","dojo/date","dojo/io-query","../dialog/ConfirmationDialog","../util/DateFormat","dojo/promise/all","dojo/_base/lang","dojo/Deferred","../config/globals"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
return _1(null,{constructor:function(){
this.downloadDocsFileNls=_2.ACTION.DOWNLOAD_DOCS_FILE;
},customDownload:function(){
this._checkIfValid().then(_9.hitch(this,function(_c){
if(!_c){
this.doDownload();
return;
}
this._downloadDocsFile();
}));
},_checkIfValid:function(){
var _d;
if(!this.file.bean.get("isDocsFile")||!_b.isPanels(this.file)){
_d=new _a();
_d.resolve(false);
}else{
_d=_8({hasDocsEntitlement:this.entitlements.getDocsDfd(),fullEntry:this.file.bean.get("fullEntry")}).then(_9.hitch(this,function(_e){
return _e.hasDocsEntitlement;
}));
}
return _d;
},doDownload:function(){
window.location.href=this.file.args.links.download;
},_downloadDocsFile:function(){
if(this._draftInfoRequest){
return;
}
this._draftInfoRequest=true;
this.file.bean.getDocsDraftInfo().then(_9.hitch(this,function(_f){
this._draftInfoRequest=false;
if(!_f){
this.doDownload();
return;
}
var _10=this.file.bean.get("dateModified");
var _11=_f.get("dateModified");
if(_4.compare(_11,_10)<0){
_11=_10;
}
var _12=_f.get("baseVersion")===this.file.bean.get("version");
if(_12&&(this.file.bean.get("size")===0||(_f.hasChanges&&this.file.bean.get("permissions").canEdit()))){
this._showDownloadPrompt(_11,_10);
}else{
this.doDownload();
}
}));
},_showDownloadPrompt:function(_13,_14){
var _15=false,_16,_17,_18;
if(this.file.bean.get("size")===0){
if(this.file.bean.get("permissions").canEdit()){
_16=this.downloadDocsFileNls.EMPTY_FILE_EDITOR;
}else{
_16=this.downloadDocsFileNls.EMPTY_FILE_READER;
}
_15=true;
}else{
_16=_9.clone(this.downloadDocsFileNls.NEWER_DRAFT_EXISTS);
_17=new _7(_13);
_16.PROMPT=_17.formatByAge(_16.PROMPT);
_18=new _7(_14);
_16.PROMPT2=_18.formatByAge(_16.PROMPT2);
}
var _19=new _6({strings:_16,hideOk:_15});
_19.render();
_19.on("clicked",_9.hitch(this,function(){
_19.onCancel();
this.doDownload();
}));
}});
});


;define("ic-share/fileviewer/action/DownloadAction",["dojo/_base/declare","dojo/_base/lang","dojo/_base/event","./Action","dojo/i18n!../nls/FileViewerStrings","./DownloadDocsFileMixin","../util/fidoNewRelic","../preview/util","dojo/dom-attr"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
var _a=_1([_4,_6],{isDownloadAction:true,postMixInProperties:function(){
this.nls=_5.ACTION.DOWNLOAD;
this.title=this.nls.TOOLTIP;
this.a11y=this.nls.A11Y;
this.href=this.file.args.links.download;
},onLinkClicked:function(e){
if(!_8.isPreviewSafe(this.file)){
_9.set(this.link,"target","_blank");
}else{
_9.remove(this.link,"target");
}
if(_2.isFunction(this.customDownload)&&this.file.bean.get("isDocsFile")){
_3.stop(e);
this.customDownload();
}
_7.track("download");
}});
return {isSticky:true,create:function(_b){
return new _a(_b);
},isValid:function(){
return true;
},getClassName:function(){
return "ics-viewer-action-download";
}};
});


;define("ic-share/fileviewer/util/ibmDocs",["dojo/_base/array","../config/globals","dojo/_base/lang"],function(_1,_2,_3){
var _4=["00000000-0000-0000-0001-000000000000","00000000-00000-0000-0001-00000000000000"];
function _5(_6){
var _7=_3.getObject("lconn.share.config.actionConfig.isActionAllowed");
if(_3.isFunction(_7)){
return _7(_4[0],null,_6);
}
return false;
};
return {isDocsFile:function(_8){
var _9=_8.get("objectTypeId");
return _1.indexOf(_4,_9)!==-1;
},isDocsEnabled:function(){
return _2.entitlements.getDocsDfd();
},isRestoreEnabled:function(){
return _5("restoreVersion");
},isUploadNewVersionEnabled:function(){
return _5("uploadNewVersion");
}};
});


;define("ic-share/fileviewer/action/DownloadPDFAction",["dojo/_base/declare","dojo/_base/lang","dojo/topic","dojo/string","dojo/io-query","./Action","dojo/i18n!../nls/FileViewerStrings","../util/ibmDocs","./DownloadDocsFileMixin","dojo/date"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
var _b=_1([_6,_9],{groupId:0,isDownloadAction:true,postMixInProperties:function(){
this.nls=_7.ACTION.DOWNLOAD_AS_PDF;
this.name=this.nls.NAME;
this.title=this.nls.TOOLTIP;
this.a11y=this.nls.A11Y;
},onLinkClicked:function(){
var _c=this.file.bean;
if(this.showWarning(_c)&&_c.unpublishedChanges){
this._showDownloadPrompt(_c.unpublishedChanges.draftUpdateDate,_c.unpublishedChanges.fileUpdateDate);
}else{
this.doDownload();
}
},showWarning:function(_d){
if(_a.compare(_d.unpublishedChanges.draftUpdateDate,_d.unpublishedChanges.fileUpdateDate)<0){
_d.unpublishedChanges.draftUpdateDate=_d.unpublishedChanges.fileUpdateDate;
}
var _e=_d.unpublishedChanges.baseVersion===_d.get("version");
if(_e&&(_d.get("size")===0||(_d.unpublishedChanges.hasChanges&&_d.get("permissions").canEdit()))){
return true;
}
return false;
},doDownload:function(){
window.open(this.getDocsLink(this.file.bean.get("id")),"_blank");
},getDocsLink:function(_f){
var _10="/app/doc/lcfiles/${id}/view/content";
var url=this.services.getDocsUrl()+_4.substitute(_10,{id:_f});
var _11={asFormat:"pdf"};
var _12=_5.objectToQuery(_11);
return url+"?"+_12;
}});
return {isSticky:false,isSubItem:true,create:function(_13){
this.getWarningDialogInfo(_13.file.bean);
return new _b(_13);
},getWarningDialogInfo:function(_14){
_14.unpublishedChanges=null;
if(this._draftInfoRequest){
return;
}
this._draftInfoRequest=true;
_14.getDocsDraftInfo().then(_2.hitch(this,function(_15){
this._draftInfoRequest=false;
if(!_15){
return;
}
var _16=_14.get("dateModified");
var _17=_15.get("dateModified");
_14.unpublishedChanges={fileUpdateDate:_16,draftUpdateDate:_17,baseVersion:_15.get("baseVersion"),hasChanges:_15.hasChanges};
}));
},isValid:function(_18,_19){
return _18.bean.get("isDocsFile")&&_8.isDocsEnabled();
},getClassName:function(){
return "ics-viewer-action-download-pdf";
}};
});


;define("ic-share/fileviewer/uiState",["dojo/Stateful"],function(_1){
"use strict";
window.VIEWER_PANELS_DEFAULT_SIZE=410;
return new _1({panelSize:window.VIEWER_PANELS_DEFAULT_SIZE});
});


;define("ic-share/fileviewer/action/TogglePanelAction",["dojo/_base/declare","./Action","dojo/i18n!../nls/FileViewerStrings","dojo/_base/lang","../uiState","dojo/window","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7){
"use strict";
window.VIEWER_PANELS_RANGE=50;
var _8=_1([_2],{postMixInProperties:function(){
this.nls=_3.ACTION.TOGGLE_PANEL;
this.a11y="";
this.viewerActions.showDetailsPanel(this.isPanelVisible());
},postCreate:function(){
this._setTitleText();
this.sizeWatch=_5.watch("panelSize",_4.hitch(this,function(_9,_a,_b){
if(_b!=_a){
this._setTitleText();
}
}));
},isPanelVisible:function(){
var _c=_5.get("panelSize");
if(_c>window.VIEWER_PANELS_CLOSED_SIZE){
return true;
}else{
return false;
}
},onLinkClicked:function(){
var _d=_5.get("panelSize");
var _e=_d,_f;
var _10=_6.getBox().w-window.VIEWER_PANELS_DEFAULT_SIZE;
if(this._panelShouldClose(_d,_10)){
_5.set("panelSize",window.VIEWER_PANELS_CLOSED_SIZE);
_f=window.VIEWER_PANELS_CLOSED_SIZE;
}else{
if(this._panelShouldSnapFullscreen(_d,_10)){
_5.set("panelSize",_6.getBox().w);
_f=_6.getBox().w;
}else{
_5.set("panelSize",window.VIEWER_PANELS_DEFAULT_SIZE);
_f=window.VIEWER_PANELS_DEFAULT_SIZE;
}
}
_7.track("togglePanel",{"initPanelSize":_e,"newSize":_f});
},_panelShouldClose:function(_11,_12){
return ((_11>window.VIEWER_PANELS_CLOSED_SIZE&&_11<=window.VIEWER_PANELS_DEFAULT_SIZE))||((_11>window.VIEWER_PANELS_CLOSED_SIZE)&&(_12<window.VIEWER_PREVIEW_SNAP_CLOSED_SIZE));
},_panelShouldSnapFullscreen:function(_13,_14){
return (_13==window.VIEWER_PANELS_CLOSED_SIZE)&&(_14<window.VIEWER_PREVIEW_SNAP_CLOSED_SIZE);
},_setTitleText:function(){
var _15;
var _16=_5.get("panelSize");
var _17=_6.getBox().w-window.VIEWER_PANELS_DEFAULT_SIZE;
if(_16==window.VIEWER_PANELS_CLOSED_SIZE){
_15=this.nls.SHOW;
this.a11y=this.nls.SHOW_A11Y;
}else{
if(this._panelShouldClose(_16,_17)){
_15=this.nls.HIDE;
this.a11y=this.nls.HIDE_A11Y;
}else{
_15=this.nls.RESET||"Reset panel size";
this.a11y=this.nls.RESET_A11Y||"This button resets the side panel back to default size. The side panel is currently expanded.";
}
}
this._setTitle(_15);
this.describedBy.innerHTML=this.a11y;
},destroy:function(){
this.sizeWatch.remove();
}});
return {isSticky:true,isOverlayAction:true,create:function(_18){
return new _8(_18);
},isValid:function(){
return true;
},getClassName:function(){
return "ics-viewer-action-panel";
}};
});


;define("ic-share/fileviewer/action/CloseAction",["dojo/_base/declare","./Action","dojo/i18n!../nls/FileViewerStrings","dojo/topic","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5){
"use strict";
var _6=_1([_2],{postMixInProperties:function(){
this.nls=_3.ACTION.CLOSE;
this.title=this.nls.TOOLTIP;
this.a11y=this.nls.A11Y;
},onLinkClicked:function(){
_5.track("close");
_4.publish("ic-fileviewer/close");
}});
return {isSticky:true,isOverlayAction:true,create:function(_7){
return new _6(_7);
},isValid:function(){
return true;
},getClassName:function(){
return "ics-viewer-action-close";
}};
});


;define("ic-share/fileviewer/action/EditDocAction",["dojo/_base/declare","./Action","dojo/string","dojo/_base/array","dojo/i18n!../nls/FileViewerStrings","../config/documentTypes","dojo/_base/lang","dojo/dom-class","dojo/dom-style","../preview/util","dojo/request/xhr","dojo/promise/all","dojo/Deferred","../util/ibmDocs","dojo/topic","dojo/has","../util/feature","../config/globals","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,has,_10,_11,_12){
"use strict";
var _13=_1([_2],{postMixInProperties:function(){
this.nls=_5.ACTION.EDIT_DOC;
this.name=this.splitButtonName||this.nls.NAME;
this.title=this.nls.TOOLTIP;
this.a11y=this.nls.A11Y;
},postCreate:function(){
_9.set(this.img,"display","none");
},onLinkClicked:function(){
window.open(this.getDocsLink(this.file.args.id),"_blanks");
if(has("fileviewer-close-on-edit")){
_f.publish("ic-fileviewer/close");
}
_12.track("editDoc");
},getDocsLink:function(_14){
var url=this.services.getDocsUrl()+"/app/doc/lcfiles/${id}/edit/content";
return _3.substitute(url,{id:_14});
}});
return {isSplitButtonItem:true,create:function(_15){
return new _13(_15);
},isValid:function(_16,_17){
if(_11.isCCM(_16)){
return false;
}
return _c({hasDocsEntitlement:_e.isDocsEnabled(),fileBean:_16.bean.get("fullEntry")}).then(_7.hitch(this,function(_18){
if(_16.type==="verse"){
return false;
}
var _19=_16.bean.get("type");
if(_4.indexOf(_6.edit,_19)<0){
return false;
}
if(_16.bean.get("isEncrypted")){
return false;
}
if(_16.bean.get("size")===0&&(_19==="csv"||_19==="txt")){
return false;
}
if(_10.isOffice365EnabledWithoutDocsEditor()){
return false;
}
return _18.hasDocsEntitlement&&_16.bean.get("permissions").canEdit();
}));
},getClassName:function(){
return "ics-viewer-action-edit";
},getActionCategory:function(){
return "edit";
}};
});


;define("ic-share/fileviewer/bean/FileAdapter",["dojo/_base/lang"],function(_1){
"use strict";
return function(_2){
var _3={getVisibility:_1.hitch(_2,function(){
return _2.get("visibility");
}),getLibraryType:_1.hitch(_2,function(){
return _2.get("libraryType");
}),isPublic:_1.hitch(_2,function(){
return _2.get("visibility")==="public";
}),getPermissions:_1.hitch(_2,function(){
return _2.get("permissions")._permissions;
}),isExternal:_1.hitch(_2,function(){
return _2.get("isExternal");
}),isPrivate:_1.hitch(_2,function(){
return _2.get("visibility")==="private";
}),getAuthor:_1.hitch(_2,function(){
return _2.get("author");
}),getLibraryAuthor:_1.hitch(_2,function(){
return _2.get("libraryAuthor");
}),getId:_1.hitch(_2,function(){
return _2.get("id");
}),getName:_1.hitch(_2,function(){
return _2.get("name");
}),getTags:_1.hitch(_2,function(){
return _2.get("tags");
}),getConfiguration:_1.hitch(_2,function(){
return;
}),isPersonalFilesInCommunity:_1.hitch(_2,function(_4){
return (_4==="communityFiles")&&(_2.libraryType==="personalFiles");
})};
return _3;
};
});


;define("dojo/text!ic-share/fileviewer/dialog/templates/RoundtripEditDialog.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-dialog-action">\n	<div class="errorContainer" data-dojo-attach-point="errorContainer"></div>\n	<div class="prompt-container" data-dojo-attach-point="promptContainer">\n        <span>${nls.PROMPT}</span>\n    </div>\n    <div class="prompt-container promptLink">\n      <span data-dojo-attach-point="promptLink"></span>\n    </div>\n    <div class="prompt-container" data-dojo-attach-point="reminderContainer">\n        <div><span class="prompt-bold">${nls.IMPORTANT}</span> ${nls.REMINDER}</div>\n    </div>\n    <div class="prompt-container" data-dojo-attach-point="checkboxContainer">\n     	<label><input type="checkbox" data-dojo-attach-point="skipDialogOption"/> ${nls.SKIP_DIALOG}</label>\n    </div>\n	<div class="button-container">\n		<a class="confirm bad" href="javascript:;"\n			data-dojo-attach-event="onclick:clickLink" data-dojo-attach-point="okButton" id="ok" role="button">${nls.OK}</a>\n		<a class="cancel neutral" href="javascript:;"\n			data-dojo-attach-event="onclick:clickLink" id="cancel" role="button">${nls.CANCEL}</a>\n	</div>\n</div>');

;define("ic-share/fileviewer/dialog/RoundtripEditDialog",["dojo/_base/declare","dojo/text!./templates/RoundtripEditDialog.html","dijit/Dialog","dojo/_base/lang","dojo/dom-attr","dijit/registry","./DialogAction","dojo/Evented","dojo/when","dojo/Deferred","../widget/MessageBox","dojo/i18n!../nls/FileViewerStrings","dojo/dom-construct","dojo/html","dojo/dom-style","dojo/dom-class","dojo/cookie","dijit/focus","dojo/string","../config/globals"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14){
return _1([_3,_8],{"class":"roundtripEditDialog",constructor:function(_15){
var _16=new _7({template:_2,nls:_15.strings});
this.nls=_15.strings;
this._set("title",_15.strings.DIALOG_TITLE);
_16.clickLink=_4.hitch(this,function(e){
if(e.target.id==="ok"){
this._errorBox.removeMessage();
this._checkSkipDialogOption();
this.emit("clicked",{});
}else{
if(e.target.id==="cancel"){
this.onCancel();
}
}
});
_16.startup();
this.content=_16;
},postCreate:function(){
this.inherited(arguments);
var _17=_6.getUniqueId("fileviewer")+"_RoundtripEditDialogContent";
_5.set(this.domNode,"aria-label",this._get("title"));
_5.set(this.domNode,"aria-describedBy",_17);
_5.set(this.content.promptContainer,"id",_17);
var _18={type:"error"};
this._errorBox=_b.create(_18);
this._errorBox._hide();
this._errorBox.placeAt(this.content.errorContainer);
_9(_14.baseFilesConfig).then(_4.hitch(this,function(_19){
if(_4.getObject("lconn.files.config.features.fileSync.clientDownloadLinkEnabled")){
var url=_4.getObject("lconn.files.config.features.fileSync.clientDownloadLink");
var _1a=_13.substitute(this.nls.INSTALL,{"startLink":"<a target=\"_blank\" href=\""+url+"\"><span class=\"lotusAccess\">","endLink":"</span></a>"});
_e.set(this.content.promptLink,_1a);
_10.add(this.content.promptLink,"display");
}
}));
},_checkSkipDialogOption:function(){
if(this.content.skipDialogOption.checked){
_11("com.ibm.ic.share.fileviewer.skipRoundTripDialog","true");
}
},showError:function(_1b){
this._errorBox.setMessage(_1b);
},onCancel:function(){
this.emit("close");
this.inherited(arguments);
}});
});


;define("ic-share/fileviewer/action/RoundtripEditAction",["dojo/_base/declare","./Action","dojo/i18n!../nls/FileViewerStrings","dojo/string","dojo/_base/array","../config/documentTypes","dojo/_base/lang","../config/globals","../bean/FileAdapter","dojo/_base/config","../data/util/routes","dojo/topic","dojo/Deferred","dojo/aspect","dojo/dom-attr","dojo/promise/all","dojo/cookie","../dialog/RoundtripEditDialog","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,all,_10,_11,_12){
"use strict";
var _13=_1([_2],{groupId:0,_handlers:[],postMixInProperties:function(){
this.nls=_3.ACTION.ROUNDTRIP_EDIT;
this.title=this.nls.TOOLTIP;
this.name=this.splitButtonName||this.nls.NAME;
this.a11y=this.nls.A11Y;
},postCreate:function(){
_f.set(this.altText,"innerHTML","");
},onLinkClicked:function(){
if(!_10("com.ibm.ic.share.fileviewer.skipRoundTripDialog")){
this.createDialog();
}else{
this._redirectDesktop();
}
_12.track("roundTripEdit");
},createDialog:function(){
this.dialog=new _11({strings:this.nls});
this._handlers.push(this.dialog.on("clicked",_7.hitch(this,"_onClicked")));
this._handlers.push(this.dialog.on("close",_7.hitch(this,"_onClose")));
this.dialog.placeAt(document.body);
this.dialog.startup();
this.dialog.show();
},_onClicked:function(){
this.dialog.onCancel();
this._redirectDesktop();
},_onClose:function(){
_5.forEach(this._handlers,function(_14){
_14.remove();
});
this._handlers=[];
delete this.dialog;
},getDesktopLink:function(_15){
var _16=_b.getFilesAppRoutes(this.file.bean);
return _16.getRoundTripEditingUrl(this.file.bean.id);
},_redirectDesktop:function(){
window.location.href=this.getDesktopLink(this.file.args.id);
}});
return {isSplitButtonItem:true,create:function(_17){
return new _13(_17);
},isValid:function(_18,_19){
return all({fileBean:_18.bean.get("fullEntry"),policy:_8.policy,baseFilesConfig:_8.baseFilesConfig}).then(_7.hitch(this,function(_1a){
if(navigator.platform.indexOf("Win")!==0){
return false;
}
if(_1a.fileBean.isDocsFile){
return false;
}
var _1b=_7.getObject("features.roundTripEditing.extensions",false,_1a.baseFilesConfig);
var _1c=false;
if(_1b){
_1c=_5.some(_1b,function(_1d){
return ("."+_18.bean.get("type"))==_1d.toLowerCase();
});
}
if(!_1c){
return false;
}
if(!_1a.policy.roundTripEditingEnabled){
return false;
}
if(_1a.fileBean.get("isLocked")&&_1a.fileBean.get("lock").user.id!=_8.currentUser.id){
return false;
}
if(!_1a.fileBean.get("permissions").canEdit()){
return false;
}
return true;
}));
},getClassName:function(){
return "ics-viewer-action-roundtripedit";
},getActionCategory:function(){
return "edit";
}};
});


;define("dojo/text!ic-share/fileviewer/action/templates/ViewDocAction.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div><a href="${ui.target}" title="${ui.title}" data-dojo-attach-point="link" target="_blank">${ui.text}</a></div>\n');

;define("ic-share/fileviewer/action/ViewDocAction",["dojo/_base/declare","./Action","dojo/text!./templates/ViewDocAction.html","dojo/cookie","dojo/string","dojo/_base/array","dojo/i18n!../nls/FileViewerStrings","dojo/_base/lang","../config/documentTypes"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
"use strict";
function _a(_b){
var _c="/viewer/app/lcfiles/${id}/content";
if(_4("com.ibm.ic.share.fileviewer.cswg-data")){
_c="//connections.swg.usma.ibm.com"+_c;
}
return _5.substitute(_c,{id:_b});
};
var _d=_1([_2],{templateString:_3,postMixInProperties:function(){
this.nls=_7.ACTION.VIEW_DOC;
this.ui={text:this.nls.NAME,title:this.nls.TOOLTIP,target:_a(this.file.args.id)};
this.hide();
},postCreate:function(){
this.entitlements.getViewerDfd().then(_8.hitch(this,function(_e){
if(_e){
this.show();
}
}));
}});
return {create:function(_f){
return new _d(_f);
},isValid:function(_10,_11){
return _6.indexOf(_9.view,_10.args.type)>-1&&_11.properties&&_11.properties["ic-share.fileviewer.showViewButton"]==="true";
},getClassName:function(){
return "ics-viewer-action-view";
}};
});


;define("ic-share/fileviewer/action/ToggleAction",["dojo/_base/declare","./Action","dojo/dom-class","dojo/dom-attr"],function(_1,_2,_3,_4){
"use strict";
return _1([_2],{checked:false,_toggle:function(){
this.set("checked",!this.checked);
},_setCheckedAttr:function(_5){
this.checked=_5;
this._updateButton();
},_updateButton:function(){
var _6;
if(this.checked){
_3.add(this.domNode,"checked");
_6=this.toggleStrings.checked;
}else{
_3.remove(this.domNode,"checked");
_6=this.toggleStrings.unchecked;
}
this._setTitle(_6.title);
this.describedBy.innerHTML=_6.a11y;
this.set(_6);
},_makeToggleButton:function(){
_4.set(this.describedBy,"aria-live","polite");
_3.remove(this.describedBy,"lotusAccess");
_3.add(this.describedBy,"lotusOffScreen");
}});
});


;define("ic-share/fileviewer/action/LikeAction",["dojo/_base/declare","./ToggleAction","dojo/i18n!../nls/FileViewerStrings","dojo/string","dojo/dom-class","../config/globals","dojo/_base/lang","dojo/Deferred","dojo/aspect","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
var _b=_1([_2],{postMixInProperties:function(){
this.nls=_3.ACTION.LIKE;
this.title=this.a11y="";
this.hide();
},postCreate:function(){
this.file.bean.get("fullEntry").then(_7.hitch(this,this.render));
},render:function(){
this.show();
this.isLiked=!!this.file.bean.get("recommendationUrl");
this.updateButton();
this._makeToggleButton();
},onLinkClicked:function(){
if(this.isLiked){
this.file.bean.unlike().then(_7.hitch(this,this.setLikeStatus));
}else{
this.file.bean.like().then(_7.hitch(this,this.setLikeStatus));
}
_a.track("toggleLike",{"likeStatus":this.isLiked});
},setLikeStatus:function(){
this.isLiked=!this.isLiked;
var _c=parseInt(this.file.bean.get("recommendations"));
_c+=this.isLiked?1:-1;
this.file.bean.set("recommendations",_c,false);
this.updateButton();
},updateButton:function(){
if(this.isLiked){
_5.replace(this.domNode,"checked","unchecked");
this.title=_4.substitute(this.nls.UNLIKE,[this.file.bean.name]);
this.a11y=this.nls.UNLIKE_A11Y;
}else{
_5.replace(this.domNode,"unchecked","checked");
this.title=_4.substitute(this.nls.LIKE,[this.file.bean.name]);
this.a11y=this.nls.LIKE_A11Y;
}
this._setTitle(this.title);
this.describedBy.innerHTML=this.a11y;
}});
return {isSticky:true,create:function(_d){
return new _b(_d);
},isValid:function(_e,_f){
if(_6.isAuthenticated&&(_6.isPanels(_e))){
return true;
}else{
return false;
}
},getClassName:function(_10){
return "ics-viewer-action-like";
}};
});


;define("ic-share/fileviewer/util/network",[],function(){
return {parseError:function(_1){
var _2=_1.response.status,_3;
if(_2===401){
_3="Unauthenticated";
}else{
if(_2===403){
_3="AccessDenied";
}else{
if(_2===404){
_3="ItemNotFound";
}else{
if(_2===409){
_3="Conflict";
}
}
}
}
_1.code=_3||"Unknown";
return _1;
},getErrorMessage:function(_4,_5){
if(_4.isDocsError){
return this.getDocsErrorMessage(_4,_5);
}
var _6="";
switch(_4.code){
case "Unauthenticated":
_6=_5.UNAUTHENTICATED;
break;
case "AccessDenied":
_6=_5.ACCESS_DENIED;
break;
case "ItemNotFound":
_6=_5.NOT_FOUND;
break;
case "Conflict":
_6=_5.CONFLICT;
break;
}
if(!_6){
_6=_5.DEFAULT;
}
return _6;
},getDocsErrorMessage:function(_7,_8){
var _9="";
switch(_7.code){
case "AccessDenied":
_9=_8.ACCESS_DENIED;
break;
case "ItemNotFound":
_9=_8.NOT_FOUND;
break;
case "CannotReachRepository":
_9=_8.CANNOT_REACH_REPOSITORY;
break;
case "QuotaViolation":
_9=_8.QUOTA_VIOLATION;
break;
case "ConversionUnavailable":
_9=_8.CONVERSION_UNAVAILABLE;
break;
case "DocumentTooLarge":
_9=_8.TOO_LARGE;
break;
case "ConversionTimeout":
_9=_8.CONVERSION_TIMEOUT;
break;
case "ServerBusy":
_9=_8.SERVER_BUSY;
break;
}
if(!_9){
_9=_8.DEFAULT;
}
return _9;
}};
});


;define("ic-share/fileviewer/action/TrashFileAction",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/topic","dojo/string","./Action","../dialog/ConfirmationDialog","../util/network","dojo/Deferred","dojo/i18n!../nls/FileViewerStrings","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
"use strict";
var _c=_1([_6],{groupId:2,_inProgress:false,_handlers:[],constructor:function(_d){
_2.mixin(this,_d);
this.nls=_a.ACTION.TRASH;
this.title=this.name=this.nls.NAME;
this.a11y=this.nls.A11Y;
},onLinkClicked:function(){
this.createDialog();
},createDialog:function(){
this.dialog=new _7({strings:this.nls});
this._handlers.push(this.dialog.on("clicked",_2.hitch(this,"_deleteFile")));
this._handlers.push(this.dialog.on("close",_2.hitch(this,"_close")));
this.dialog.placeAt(document.body);
this.dialog.startup();
this.dialog.show();
},_deleteFile:function(){
if(!this._inProgress){
this._inProgress=true;
this.file.bean.remove().then(_2.hitch(this,"_onSuccess"),_2.hitch(this,function(_e){
this._onError(_e);
}));
}
},_onSuccess:function(){
this.dialog.onCancel();
this._inProgress=false;
var _f={fileDelete:true,messages:{message:_5.substitute(this.nls.SUCCESS_MSG,{file:this.file.bean.get("name")}),success:true}};
_4.publish("ic-fileviewer/dirty");
_4.publish("ic-fileviewer/action/completed",_f);
_b.track("trashFile");
},_onError:function(_10){
if(this.nls.errorStrings){
this.dialog.showError(_8.getErrorMessage(_10,this.nls.errorStrings));
}
this._inProgress=false;
},_close:function(){
_3.forEach(this._handlers,function(_11){
_11.remove();
});
this._handlers=[];
delete this.dialog;
this._inProgress=false;
}});
return {isSubItem:true,create:function(_12){
return new _c(_12);
},isValid:function(_13,_14){
var _15=new _9();
_13.bean.get("fullEntry").then(function(_16){
_15.resolve(!!_16.get("permissions").canDelete());
});
return _15.promise;
},getClassName:function(){
return "ics-viewer-action-trash";
}};
});


;define("ic-share/fileviewer/action/CopyFileAction",["dojo/_base/declare","./Action","dojo/i18n!../nls/FileViewerStrings","dojo/string","dojo/_base/lang","../config/globals","../bean/FileAdapter","dojo/_base/config","../data/util/routes","dojo/topic","dojo/Deferred","dojo/aspect","dojo/promise/all","dojo/when","../util/html","dojo/dom-construct","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11){
"use strict";
var _12=_1([_2],{groupId:1,postMixInProperties:function(){
this.nls=_3.ACTION.COPY_FILE;
this.title=this.nls.TOOLTIP;
this.name=this.nls.NAME;
this.a11y=this.nls.A11Y;
},onLinkClicked:function(){
this.beginCopy();
_11.track("copyFile");
},beginCopy:function(){
var app=this.getApp();
var _13=this.getCopier(app);
this.copyFile(_13);
},getApp:function(){
if(!this.app){
this.app={net:_6.network(),routes:_9.getFilesAppRoutes(this.file.bean),getLibraryTypeAheadStore:_5.hitch(this,"getLibraryTypeAheadStore"),getTagStore:_5.hitch(this,"getTagStore"),nls:_6.pickerNLS};
}
return this.app;
},getCopier:function(app){
if(!this._copier){
this._copier=new _6.copyFileAction(app||this.app,null);
_c.before(this._copier,"save",_5.hitch(this,function(e){
this.setupMessage();
return [e];
}));
_c.around(this._copier,"complete",_5.hitch(this,function(_14){
return _5.hitch(this,function(_15,_16){
if(_15 instanceof Error){
_5.hitch(this._copier,_14,_15,_16)();
}else{
this._onSuccess();
}
});
}));
}
return this._copier;
},copyFile:function(_17){
_17.execute(this.getShareBean(this.file.bean));
},getLibraryTypeAheadStore:function(){
if(!this.libraryStore){
this.libraryStore=_6.LibraryDataStore({net:this.app.net,getUrl:dojo.hitch(this.app.routes,"getLibrariesListServiceUrl"),queryParam:"name"});
}
return this.libraryStore;
},getTagStore:function(){
if(!this.tagStore){
this.tagStore=_6.TagDataStore({net:this.app.net,getUrl:dojo.hitch(this.app.routes,"getTagServiceUrl"),queryParam:"tag"});
_a.subscribe("lconn/files/tags/changed",this.tagStore,"clear");
}
return this.tagStore;
},getShareBean:function(_18){
if(!this.shareBean){
this.shareBean=_7(_18);
}
return this.shareBean;
},setupMessage:function(){
var _19=this._copier.getFilename();
if(this._copier.community!==null){
var _1a=this._copier.community.title,_1b=this._copier.community.communityUuid;
var _1c=_10.create("span");
this._successMsg=_f.substitute(document,_1c,this.nls.SUCCESS_MSG,{file:_19,community:function(){
var _1d=_10.create("a",{innerHTML:_1a,href:_9.getCommunityLink({communityUuid:_1b})});
_f.processLink(_1d);
return _1d;
}});
}
},_onSuccess:function(){
this._copier.close();
_a.publish("ic-fileviewer/push/messages",{type:"success",message:this._successMsg,cancelable:true});
}});
return {isSubItem:true,create:function(_1e){
return new _12(_1e);
},isValid:function(_1f,_20){
var _21=new _b();
_d({policy:_e(_6.policy),fullEntry:_1f.bean.get("fullEntry"),layer2:_6.layer2()}).then(_5.hitch(this,function(_22){
if(_6.restrictUserInComm&&_1f.bean.get("libraryType")==="communityFiles"){
_21.resolve(false);
return;
}
if(!_5.getObject("capabilities.canView.communities",false,_22.policy)){
_21.resolve(false);
}else{
_21.resolve(!!_1f.bean.get("permissions").canGrantAccess());
}
}),_5.hitch(this,function(){
_21.resolve(false);
}));
return _21;
},getClassName:function(){
return "ics-viewer-action-copy";
}};
});


;define("ic-share/fileviewer/action/ToggleSyncAction",["dojo/_base/declare","dojo/_base/lang","dojo/topic","./ToggleAction","dojo/i18n!../nls/FileViewerStrings","dojo/when","../config/globals","../data/util/routes","../util/network","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
var _b="ic-fileviewer/dirty";
var _c="ic-fileviewer/push/messages";
var _d="isSyncable";
var _e="syncing";
var _f=_1([_4],{groupId:1,postMixInProperties:function(){
this.nls=_5.ACTION.TOGGLE_SYNC||{};
this.toggleStrings={unchecked:{name:this.nls.SYNC.NAME,title:this.nls.SYNC.TOOLTIP,a11y:this.nls.SYNC.A11Y},checked:{name:this.nls.STOP_SYNC.NAME,title:this.nls.STOP_SYNC.TOOLTIP,a11y:this.nls.STOP_SYNC.A11Y}};
},postCreate:function(){
this.set("checked",this._isSyncing());
},onLinkClicked:function(){
this.file.bean.set(_e,this._isSyncing());
this.file.bean.update().then(_2.hitch(this,"_onSuccess"),_2.hitch(this,"_onError"));
_a.track("toggleSync");
},_onSuccess:function(){
var _10=this._isSyncing();
this.set("checked",_10);
_3.publish(_b,_d,_10);
this._publishMessage(true);
},_onError:function(_11){
this._publishMessage(false,_11);
},_publishMessage:function(_12,_13){
var _14,_15,_16;
if(_12){
_14=this._getPreviousActionSubNLS();
_15="success";
_16=_14.SUCCESS;
}else{
_14=this._getCurrentNextActionSubNLS();
_15="error";
_16=_9.getErrorMessage(_13,_14.ERROR);
}
_3.publish(_c,{type:_15,message:_16,cancelable:true});
},_isSyncing:function(){
return this.file.bean.get(_d);
},_getPreviousActionSubNLS:function(_17){
return this._getCurrentNextActionSubNLS(!((_17!==undefined)?_17:this._isSyncing()));
},_getCurrentNextActionSubNLS:function(_18){
return ((_18!==undefined)?_18:this._isSyncing())?this.nls.STOP_SYNC:this.nls.SYNC;
}});
return {isSubItem:true,create:function(_19){
return new _f(_19);
},isValid:function(_1a){
var _1b=true;
var _1c=false;
if(!_7.isAuthenticated){
return false;
}
return _6(_7.policy).then(_2.hitch(this,function(_1d){
var _1e=_7.policy.capabilities.canSync;
var _1f,_20;
if(_1b){
_1f=_1e.files;
}else{
if(_1c){
_1f=_1e.folders;
}else{
return false;
}
}
if(_1a.bean.get("libraryType")==="personalFiles"){
_20=_1f.personal;
}else{
if(_1a.bean.get("libraryType")==="communityFiles"){
_20=_1f.community;
}else{
return false;
}
}
return _20;
}));
},getClassName:function(){
return "ics-viewer-action-toggleSync";
}};
});


;define("ic-share/fileviewer/action/ToggleFollowAction",["dojo/_base/declare","dojo/_base/lang","./ToggleAction","dojo/i18n!../nls/FileViewerStrings","dojo/dom-class","dojo/when","../config/globals","dojo/topic","../util/network","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
var _b;
var _c=_1([_3],{groupId:1,postMixInProperties:function(){
this.nls=_4.ACTION.TOGGLE_FOLLOW||{};
this.errorStrings=_4.ACTION.TOGGLE_FOLLOW.ERROR;
this.toggleStrings={unchecked:{name:this.nls.FOLLOW_NAME,title:this.nls.FOLLOW_TOOLTIP,a11y:this.nls.FOLLOW_A11Y},checked:{name:this.nls.STOP_FOLLOWING_NAME,title:this.nls.STOP_FOLLOWING_TOOLTIP,a11y:this.nls.STOP_FOLLOWING_A11Y}};
this.topic=_8;
},postCreate:function(){
this.set("checked",this._isFollowing());
if(_b!==undefined){
this._updateFollowState(_b);
_b=undefined;
}
},onLinkClicked:function(){
this._updateFollowState(!this._isFollowing());
_a.track("toggleFollow",{"followingStatus":this._isFollowing()});
},_updateFollowState:function(_d){
this.file.bean.set("mediaNotifications",_d);
this.file.bean.set("commentNotifications",_d);
this.file.bean.update({updateFromResponse:false}).then(_2.hitch(this,function(){
var _e=this._isFollowing();
this.set("checked",_e);
this._successMessage(_e);
}),_2.hitch(this,this._onError,_d));
},_onError:function(_f,_10){
var _11=_f?this.errorStrings.FOLLOW:this.errorStrings.UNFOLLOW;
var _12=_9.getErrorMessage(_10,_11);
_8.publish("ic-fileviewer/push/messages",{type:"error",message:_12,cancelable:true});
},_successMessage:function(_13){
var _14=_13?this.nls.FOLLOW_SUCCESS:this.nls.STOP_FOLLOWING_SUCCESS;
_8.publish("ic-fileviewer/push/messages",{type:"success",message:_14,cancelable:true});
},_isFollowing:function(){
return this.file.bean.get("mediaNotifications")||this.file.bean.get("commentNotifications");
}});
return {isSubItem:true,create:function(_15){
return new _c(_15);
},isValid:function(_16){
return _6(_7.policy).then(_2.hitch(this,function(_17){
var _18=_2.getObject("currentUser._native.isGuest",false,_7);
return !_18&&_17&&!!_17.contentFollowing;
}));
},getClassName:function(){
return "ics-viewer-action-toggleFollow";
},setInitialFollowState:function(_19){
_b=_19;
}};
});


;define("ic-share/fileviewer/action/RefreshAction",["dojo/_base/declare","dojo/_base/lang","dojo/topic","./Action","dojo/i18n!../nls/FileViewerStrings","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6){
"use strict";
var _7=_1([_4],{groupId:2,constructor:function(_8){
_2.mixin(this,_8);
this.nls=_5.ACTION.REFRESH;
this.title=this.name=this.nls.NAME;
this.a11y=this.nls.A11Y;
},onLinkClicked:function(){
_3.publish("ic-fileviewer/refresh",{});
_6.track("refresh");
}});
return {isSubItem:true,create:function(_9){
return new _7(_9);
},isValid:function(){
return true;
},getClassName:function(){
return "ics-viewer-action-refresh";
}};
});


;define("ic-share/fileviewer/action/ToggleLockAction",["dojo/_base/declare","dojo/_base/lang","./ToggleAction","dojo/i18n!../nls/FileViewerStrings","dojo/dom-class","dojo/when","../config/globals","dojo/topic","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
"use strict";
var _a=_1([_3],{groupId:1,postMixInProperties:function(){
this.nls=_4.ACTION||{};
this.toggleStrings={unchecked:{name:this.nls.LOCK.NAME,title:this.nls.LOCK.TITLE,a11y:this.nls.LOCK.A11Y},checked:{name:this.nls.UNLOCK.NAME,title:this.nls.UNLOCK.TITLE,a11y:this.nls.UNLOCK.A11Y}};
},postCreate:function(){
this.set("checked",this._isLocked());
},onLinkClicked:function(){
var _b=!this._isLocked();
this.file.bean.set("isLocked",_b);
var _c=this._isLocked();
this.file.bean.update().then(_2.hitch(this,function(){
this.set("checked",_c);
if(_c){
_8.publish("ic-fileviewer/push/messages",{type:"success",message:this.nls.LOCK.SUCCESS,cancelable:true});
}else{
_8.publish("ic-fileviewer/push/messages",{type:"success",message:this.nls.UNLOCK.SUCCESS,cancelable:true});
}
_9.track("toggleLock",{"lockStatus":_c});
}),_2.hitch(this,function(_d){
_8.publish("ic-fileviewer/push/messages",{type:"error",message:this._isLocked()?(this.nls.UNLOCK.ERROR||"The file could not be unlocked because it has been deleted or is no longer shared with you."):(this.nls.LOCK.ERROR||"The file could not be locked because it has been deleted or is no longer shared with you."),cancelable:true});
}));
},_isLocked:function(){
return this.file.bean.get("isLocked");
}});
return {isSubItem:true,create:function(_e){
return new _a(_e);
},isValid:function(_f){
return _f.bean.get("fullEntry").then(function(){
return _f.bean.get("permissions").canLock()||_f.bean.get("permissions").canUnlock();
});
},getClassName:function(){
return "ics-viewer-action-toggleLock";
}};
});


;define("ic-share/fileviewer/action/ToggleFavoriteAction",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","./ToggleAction","dojo/i18n!../nls/FileViewerStrings","dojo/dom-class","dojo/when","../config/globals","dojo/Deferred","dojo/topic","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
"use strict";
var _c=_1([_4],{postMixInProperties:function(){
this.nls=_5.ACTION.TOGGLE_FAVORITE||{};
this.toggleStrings={unchecked:{title:this.nls.FAVORITE_TOOLTIP,a11y:this.nls.FAVORITE_A11Y},checked:{title:this.nls.STOP_FAVORITEING_TOOLTIP,a11y:this.nls.STOP_FAVORITEING_A11Y}};
this.hide();
},postCreate:function(){
this._isFavorited();
this._makeToggleButton();
},onLinkClicked:function(){
if(this.get("checked")){
this.removeFavorite();
}else{
this.makeFavorite();
}
_b.track("toggleFavorite",{"favoriteStatus":this.get("checked")});
},_isFavorited:function(){
this.file.bean.get("favoritesFeed").fetch().then(_2.hitch(this,function(_d){
var _e=_3.indexOf(_d,this.file.bean.get("id"));
this.set("checked",_e>-1?true:false);
this.show();
}));
},makeFavorite:function(){
this.file.bean.get("favoritesFeed").createItem(this.file.bean).then(_2.hitch(this,function(_f){
this._toggle();
_a.publish("lconn/files/files/myfavorites/add",[this.file.bean.get("id")]);
_a.publish("ic-fileviewer/dirty");
_a.publish("ic-fileviewer/push/messages",{type:"success",message:this.nls.FAVORITE_SUCCESS,cancelable:true});
}));
},removeFavorite:function(){
this.file.bean.get("favoritesFeed").deleteItem(this.file.bean).then(_2.hitch(this,function(_10){
this._toggle();
_a.publish("lconn/files/files/myfavorites/remove",[this.file.bean.get("id")]);
_a.publish("ic-fileviewer/dirty");
_a.publish("ic-fileviewer/push/messages",{type:"success",message:this.nls.STOP_FAVORITEING_SUCCESS,cancelable:true});
}));
}});
return {isSticky:true,isSubItem:false,create:function(_11){
return new _c(_11);
},isValid:function(_12){
if(_8.isAuthenticated&&_12.bean.get("libraryType")==="personalFiles"&&(_8.isPanels(_12))){
return true;
}else{
return false;
}
},getClassName:function(){
return "ics-viewer-action-favorite";
}};
});


;define("dojo/text!ic-share/fileviewer/dialog/templates/CreateFromTemplate.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-dialog-action">\n   <div class="errorContainer" data-dojo-attach-point="errorContainer"></div>\n   <div class="prompt-container" data-dojo-attach-point="promptContainer">${nls.PROMPT}</div>\n   <form>\n      <table>\n         <colgroup>\n            <col>\n            <col width="100%">\n         </colgroup>\n         <tbody>\n            <tr>\n               <td class="lotusNowrap">\n                  <label class="name-container" for="${fileNameInputId}"><span class="lotusFormRequired">*</span>${nls.NAME_FIELD}</label>\n               </td>\n               <td>\n                  <input class="name-input" type="text" name=fileName data-dojo-attach-point="fileName" id="${fileNameInputId}" aria-required="true">\n               </td>\n            </tr>\n            <tr>\n               <td></td>\n               <td>\n                  <div class="external-container" data-dojo-attach-point="externalContainer">\n                     <input type="checkbox" name="${nls.EXTERNAL_FIELD}" data-dojo-attach-point="isExternal" id="${externalCheckboxId}">\n                     <label for="${externalCheckboxId}">${nls.EXTERNAL_FIELD}</label>\n                  </div>\n               </td>\n            </tr>\n         </tbody>\n      </table>\n   <div class="button-container">\n      <a class="confirm bad" href="javascript:;"\n         data-dojo-attach-event="onclick:clickLink" id="ok" role="button">${nls.CREATE_BUTTON}</a> \n      <a class="cancel neutral" href="javascript:;"\n         data-dojo-attach-event="onclick:clickLink" id="cancel" role="button">${nls.CANCEL}</a>\n   </div>\n   </form>\n</div>\n');

;define("ic-share/fileviewer/dialog/CreateFromTemplateDialog",["dojo/_base/declare","dojo/text!./templates/CreateFromTemplate.html","dijit/Dialog","dojo/_base/lang","./DialogAction","dojo/Evented","dojo/dom-style","../widget/MessageBox","dojo/when","dojo/Deferred","../config/globals","../data/util/routes","../network/request","dojo/string","dojo/i18n!../nls/FileViewerStrings","dojo/dom-attr","dijit/registry","dojo/keys","dojo/on"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,on){
var _13={"ott":"text","ots":"sheet","otp":"pres","dot":"text","xlt":"sheet","pot":"pres","dotx":"text","xltx":"sheet","potx":"pres"},_14={"ott":".odt","ots":".ods","otp":".odp","dot":".doc","xlt":".xls","pot":".ppt","dotx":".docx","xltx":".xlsx","potx":".pptx"};
return _1([_3,_6],{"class":"templateCreateDialog",requestInProgress:false,constructor:function(_15){
_4.mixin(this,_15);
var _16=_4.clone(_f.ACTION.CREATE_FROM_TEMPLATE);
_16.PROMPT=_16.PROMPT[_13[this.file.get("type")].toUpperCase()];
var _17=new _5({template:_2,nls:_16,fileNameInputId:_11.getUniqueId("fileviewer")+"_create_file_name",externalCheckboxId:_11.getUniqueId("fileviewer")+"external_checkbox"});
this.nls=_f.ACTION.CREATE_FROM_TEMPLATE;
this.title=this.name=this.nls.NAME;
_17.clickLink=_4.hitch(this,function(e){
if(e.target.id==="ok"&&!this.requestInProgress){
this.createNewFile();
}else{
if(e.target.id==="cancel"){
this.onCancel();
}
}
});
on(_17.fileName,"keydown",_4.hitch(this,function(evt){
if(_12.ENTER==evt.keyCode&&!this.requestInProgress){
evt.stopPropagation();
evt.preventDefault();
this.createNewFile();
}
}));
on(_17.isExternal,"keydown",_4.hitch(this,function(evt){
if(_12.ENTER==evt.keyCode){
evt.stopPropagation();
evt.preventDefault();
}
}));
_17.startup();
this.content=_17;
},createNewFile:function(){
this.requestInProgress=true;
_9(this.validateInput(),_4.hitch(this,function(_18){
this.requestInProgress=false;
if(_18){
this.emit("clicked",{});
}
}));
},showError:function(_19){
this._errorBox.setMessage(_19);
},postCreate:function(){
this.inherited(arguments);
_7.set(this.content.externalContainer,"display","none");
this.content.fileName.value=this.nls.PRE_FILL_NAMES[this.file.get("type").toUpperCase()];
this.showExternalOption();
var _1a=_11.getUniqueId("fileviewer")+"_templateCreateDialog";
_10.set(this.domNode,"aria-label",this._get("title"));
_10.set(this.domNode,"aria-describedBy",_1a);
_10.set(this.content.promptContainer,"id",_1a);
var _1b={type:"error"};
this._errorBox=_8.create(_1b);
this._errorBox._hide();
this._errorBox.placeAt(this.content.errorContainer);
},validateInput:function(){
var _1c=new _a(),_1d=this.content.fileName.value,_1e=_b.validationUtil.FILENAME_LENGTH,_1f=_14[this.file.get("type")],_20=_b.textUtil.lengthUtf8(_1f);
if(_4.trim(_1d)==""){
this.showError(this.nls.ERRORS.NAME_REQUIRED);
return _1c.resolve(false);
}
if(!/^([^\\\/\:\*\?\"\<\>\|]+)$/.test(_1d)){
this.showError(this.nls.ERRORS.ILLEGAL_NAME);
return _1c.resolve(false);
}
if(!_b.validationUtil.validateTextLength(_1d,(_1e-_20))){
this.showError(this.nls.ERRORS.WARN_LONG_NAME);
return _1c.resolve(false);
}
this._checkExistingTitle().then(_4.hitch(this,function(_21){
if(_21){
_1c.resolve(true);
}else{
_1c.resolve(false);
}
}));
return _1c;
},_checkExistingTitle:function(){
var url=null,_22=new _a();
url=_c.getNameCheckUrl("/document/${document-label}/entry?identifier=label",this.file);
url=_e.substitute(url,{"person-id":_b.currentUser.id,"document-label":encodeURI(this.content.fileName.value+_14[this.file.get("type")]),"communityId":this.file.get("communityId")});
_d(url,{noStatus:true,auth:{},preventCache:true,method:"HEAD",sync:true,handle:_4.hitch(this,function(_23,_24){
this._handleResponse(_22,_23,_24);
})});
return _22;
},_handleResponse:function(_25,_26,_27){
if(_27.xhr.status==404){
_25.resolve(true);
}else{
if(_27.xhr.status==401){
this.showError(this.nls.ERRORS.SESSION_TIMEOUT);
_25.resolve(false);
}else{
if(_27.xhr.status==200){
this.showError(this.nls.ERRORS.DUPLICATE_NAME);
_25.resolve(false);
}else{
this.showError(this.nls.ERRORS.SERVER_ERROR);
_25.resolve(false);
}
}
}
},showExternalOption:function(){
if(this.file.get("location")==="communityFiles"){
return;
}
_9(_b.policy).then(_4.hitch(this,function(_28){
if(_28.capabilities.canCreate.files.external){
_7.set(this.content.externalContainer,"display","");
if(_28.isExternalDefault){
_10.set(this.content.isExternal,"checked","true");
}
if(_b.currentUser.isExternal){
_10.set(this.content.isExternal,"checked","true");
_10.set(this.content.isExternal,"disabled","true");
}
}
}));
},onCancel:function(){
this.emit("close");
this.inherited(arguments);
}});
});


;define("ic-share/fileviewer/action/CreateFromTemplateAction",["dojo/_base/declare","./Action","dojo/string","dojo/_base/array","dojo/i18n!../nls/FileViewerStrings","../config/documentTypes","dojo/_base/lang","dojo/dom-class","dojo/dom-style","../preview/util","dojo/request/xhr","dojo/promise/all","dojo/Deferred","dojo/on","../dialog/CreateFromTemplateDialog","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,on,_e,_f){
"use strict";
var _10={"ott":"text","ots":"sheet","otp":"pres","dot":"text","xlt":"sheet","pot":"pres","dotx":"text","xltx":"sheet","potx":"pres"},_11=_1([_2],{groupId:1,constructor:function(_12){
_7.mixin(this,_12);
this.nls=_5.ACTION.CREATE_FROM_TEMPLATE;
this.title=this.name=this.nls.ACTION_NAME;
this.a11y=this.nls.A11Y[_10[this.file.bean.get("type")].toUpperCase()];
},onLinkClicked:function(){
this.createDialog();
_f.track("createFromTemplate");
},createDialog:function(){
this.dialog=new _e({file:this.file.bean});
this.dialog.placeAt(document.body);
this.dialog.startup();
this.dialog.show();
on(this.dialog,"clicked",_7.hitch(this,"execute"));
},execute:function(){
var url=this.getCreateLink(this.file.args.id);
window.open(url,"_blank");
this.dialog.onCancel();
},getCreateLink:function(_13){
var url=this.services.getDocsUrl()+"/app/newdoc?type=${docType}&template_uri=${id}&doc_title=${fileName}";
if(this.file.bean.get("libraryType")==="personalFiles"){
url+="&isExternal=${isExternal}";
}else{
url+="&community=${commName}&isExternal=${isExternal}";
}
return _3.substitute(url,{docType:_10[this.file.bean.get("type")],id:_13,fileName:this.dialog.content.fileName.value,isExternal:this.dialog.content.isExternal.checked,commName:this.file.bean.get("libraryId")});
}});
return {isSplitButtonItem:true,create:function(_14){
return new _11(_14);
},isValid:function(_15,_16){
var _17=new _d();
if(_15.type==="verse"){
return _17.resolve(false);
}
_c({hasDocsEntitlement:_16.entitlements.getDocsDfd(),file:_15.bean.get("fullEntry")}).then(_7.hitch(this,function(_18){
if(_4.indexOf(_6.create,_18.file.type)<=-1||_18.file.isEncrypted){
return _17.resolve(false);
}
if(_18.hasDocsEntitlement){
_17.resolve(true);
}else{
_17.resolve(false);
}
}),_7.hitch(this,function(_19){
_17.resolve(false);
}));
return _17;
},getClassName:function(){
return "ics-viewer-action-templateCreate";
},getActionCategory:function(){
return "create";
}};
});


;define("ic-share/fileviewer/action/UploadNewVersionAction",["dojo/_base/declare","./Action","dojo/i18n!../nls/FileViewerStrings","dojo/string","dojo/_base/array","../config/documentTypes","dojo/_base/lang","../config/globals","../bean/FileAdapter","dojo/_base/config","../data/util/routes","dojo/topic","dojo/Deferred","dojo/aspect","dojo/dom-attr","dojo/has","../util/ibmDocs"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,has,_10){
"use strict";
var _11=_1([_2],{groupId:0,postMixInProperties:function(){
this.nls=_3.ACTION.UPLOAD_VERSION;
this.title=this.nls.TOOLTIP;
this.name=this.splitButtonName||this.nls.NAME;
this.a11y=this.nls.A11Y;
},postCreate:function(){
_f.set(this.altText,"innerHTML","");
},onLinkClicked:function(){
_c.publish("ic-fileviewer/selectpanel",["version","showNewVersionWidget"]);
}});
return {isSplitButtonItem:true,create:function(_12){
return new _11(_12);
},isValid:function(_13,_14){
if(_8.isCCM(_13)){
return false;
}
return _13.bean.get("fullEntry").then(_7.hitch(this,function(_15){
return _15.get("permissions").canEdit();
}));
},getClassName:function(){
return "ics-viewer-action-upload";
},getActionCategory:function(){
return "upload";
}};
});


;define("ic-share/fileviewer/action/LogInAction",["dojo/_base/declare","./Action","dojo/i18n!../nls/FileViewerStrings","../config/globals","dojo/dom-attr"],function(_1,_2,_3,_4,_5){
"use strict";
var _6=_1([_2],{postMixInProperties:function(){
this.nls=_3.ACTION;
if(!this.nls.LOG_IN){
this.title="Log in to upload and share files, comment, and create folders";
this.name="Log In";
}else{
this.title=this.nls.LOG_IN.TOOLTIP;
this.name=this.nls.LOG_IN.NAME;
}
this.hide();
},postCreate:function(){
_5.set(this.altText,"innerHTML","");
this.show();
},onLinkClicked:function(){
_4.login();
}});
return {isSubItem:false,create:function(_7){
return new _6(_7);
},isValid:function(_8,_9){
return !_4.isAuthenticated;
},getClassName:function(){
return "ics-viewer-action-login";
}};
});


;define("dojo/text!ic-share/fileviewer/dialog/templates/FlagActionDialog.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-dialog-action">\n  <div class="errorContainer" data-dojo-attach-point="errorContainer"></div>\n  <div class="prompt-container" data-dojo-attach-point="promptContainer">${nls.PROMPT}</div>\n  <div class="summaryContainer" data-dojo-attach-point="summaryContainer"></div>\n  <div class="button-container">\n    <a class="confirm bad" href="javascript:;"\n      data-dojo-attach-event="onclick:clickLink" id="ok" role="button">${nls.OK}</a> \n      <a class="cancel neutral" href="javascript:;"\n      data-dojo-attach-event="onclick:clickLink" id="cancel" role="button">${nls.CANCEL}</a>\n  </div>\n</div>\n');

;define("dojo/text!ic-share/fileviewer/widget/templates/EditBox.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-editBox" data-dojo-attach-point="editBoxContainer">\n  <div data-dojo-attach-point="textContainer">\n    <label data-dojo-attach-point="textBoxNodeLabel" class="lotusOffScreen"></label>\n    <input type="text" data-dojo-attach-point="singleLineInput"></input>\n    <textarea data-dojo-attach-point="multiLineInput"></textarea>\n  </div>\n  \n  <div class="commentActions descriptionBox lotusHidden" data-dojo-attach-point="descriptionControlsContainer">\n    <ul class="ics-viewer-inlineList">\n      <li class="ics-viewer-first">\n        <a href="javascript:;" data-dojo-attach-event="click:_save" role="button" class="save-button">${saveText}</a></li>\n      <li>\n        <a href="javascript:;" data-dojo-attach-point="closeButtonlink" data-dojo-attach-event="click:_cancel,blur:_delayedEventHandler" role="button" class="cancel-button">${closeButton.altText}</a>\n    </li></ul>\n  </div>\n  \n  <a class="ics-viewer-cancel lotusHidden" href="javascript:;" title="${closeButton.altText}" data-dojo-attach-point="closeButtonlink" data-dojo-attach-event="click:_cancel,blur:_delayedEventHandler" aria-describedby="${closeButton.id}_describe" role="button">\n    <span data-dojo-attach-point="closeButtonLinkText">${closeButton.linkText}</span>\n    <img src="${_blankGif}" alt="" data-dojo-attach-point="img" />\n    <span data-dojo-attach-point="closeButtonAltText" class="lotusAltText fileViewerIconText">${closeButton.altText}</span>\n  </a>\n  <span class="lotusAccess" id="${closeButton.id}_describe" data-dojo-attach-point="closeButtonDescribedBy">${closeButton.a11y}</span>\n  <div class="commentActions" data-dojo-attach-point="actionsContainer">\n    <ul class="ics-viewer-inlineList" data-dojo-attach-point="actions"><li class="ics-viewer-first"><a href="javascript:;" data-dojo-attach-event="click:_save" role="button">${saveText}</a></li><li><a href="javascript:;" data-dojo-attach-event="click:_cancel" role="button">${cancelText}</a></li></ul>\n    <img src="${_blankGif}" class="externalIcon" style="display: none;" data-dojo-attach-point="externalIcon" title=""></img>\n  </div>\n  <div data-dojo-attach-point="errorContainer"></div>\n  <div data-dojo-attach-point="warningContainer"></div>\n</div>\n');

;define("ic-share/fileviewer/widget/EditBox",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/EditBox.html","dojo/on","dojo/_base/lang","dojo/dom-style","dijit/focus","./MessageBox","dojo/keys","dojo/_base/array","dojo/dom-construct","dojo/dom-class","dojo/i18n!../nls/FileViewerStrings","dijit/registry","dojo/dom-attr","dojo/has","dojo/topic"],function(_1,_2,_3,_4,on,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,has,_10){
return _1([_2,_3],{templateString:_4,saveOnBlur:true,multiline:true,saveText:"",cancelText:"",invalidCharacters:undefined,useInlineMessages:true,postMixInProperties:function(){
this.nls=_d.EDIT_BOX;
this.saveText=this.nls.SAVE||"Save";
this.textLabelNls=(this.widgetType=="versions")?_d.UPLOAD_VERSION.CHANGE_SUMMARY:_d.ACTION.EDIT_DESCRIPTION.TOOLTIP;
var _11=_e.getUniqueId("fileviewer")+"_editBoxCloseButton";
this.closeButton={linkText:"",id:_11,altText:this.nls.CANCEL.TOOLTIP,a11y:this.nls.CANCEL.A11Y};
},postCreate:function(){
if(this.closeButtonEnabled){
_c.remove(this.closeButtonlink,"lotusHidden");
_6.set(this.closeButtonlink,"display","inline-block");
}
if(this.multiline){
this.textBox=this.multiLineInput;
_6.set(this.singleLineInput,"display","none");
}else{
this.textBox=this.singleLineInput;
_6.set(this.multiLineInput,"display","none");
}
this.textBox.id=_e.getUniqueId("fileviewer")+"_textBox_Unique";
_f.set(this.textBoxNodeLabel,"for",this.textBox.id);
_f.set(this.textBoxNodeLabel,"innerHTML",this.textLabelNls);
if(this.saveOnBlur){
_6.set(this.actions,"display","none");
}
on(this.textBox,"blur",_5.hitch(this,this._delayedEventHandler));
on(this.textBox,"input",_5.hitch(this,this._handleInput));
on(this.textBox,"keypress",_5.hitch(this,this._handleKeypress));
on(this.textBox,"keydown",_5.hitch(this,function(e){
switch(e.keyCode){
case _9.ESCAPE:
this._cancel();
e.stopPropagation();
e.preventDefault();
case _9.BACKSPACE:
default:
this._clearMessages();
}
}));
},focus:function(){
var _12=(has("ie")||has("trident"))?500:0;
setTimeout(_5.hitch(this,function(){
_7.focus(this.textBox);
this.setSelectionRange(0,0);
}),_12);
},_clearMessages:function(){
if(this.useInlineMessages){
this.removeInlineError();
}else{
_10.publish("ic-fileviewer/push/clearMessages");
}
},setErrorMessage:function(_13){
if(!this._errorBox){
var _14={type:"error"};
this._errorBox=_8.create(_14);
this._errorBox.placeAt(this.errorContainer);
}
this._errorBox.setMessage(_13);
},setMessage:function(_15){
if(this.useInlineMessages){
this.setInlineError(_15);
}else{
_10.publish("ic-fileviewer/push/messages",{type:"error",message:_15,cancelable:true,focus:false});
}
},setInlineError:function(_16){
this.removeInlineError();
_c.add(this.domNode,"error");
this._inlineError=_b.create("span",{innerHTML:_16,className:"inlineError"},this.textBox,"after");
},removeInlineError:function(_17){
_c.remove(this.domNode,"error");
_b.destroy(this._inlineError);
},_getValueAttr:function(){
return this.textBox.value;
},_setValueAttr:function(_18){
this.textBox.value=_18;
},getValue:function(){
return this.get("value");
},setValue:function(_19){
this.set("value",_19);
this.focus();
},_delayedEventHandler:function(e){
var _1a="_handle"+e.type.charAt(0).toUpperCase()+e.type.toLowerCase().slice(1);
var _1b=!(has("ie")||has("trident"))?500:0;
setTimeout(_5.hitch(this,this[_1a]),_1b);
},_handleBlur:function(){
var _1c=document.activeElement;
if(!this._isDestroying&&this.saveOnBlur&&!(this._isElementInsideOwnContainer(_1c))&&!this.descriptionBox){
this._save();
}
},_isElementInsideOwnContainer:function(_1d){
return this.editBoxContainer.contains(_1d);
},_handleKeypress:function(e){
this._clearMessages();
if(e.keyCode===_9.ENTER&&!this.multiline){
e.preventDefault();
e.stopPropagation();
this._save();
}else{
if(this.invalidCharacters){
var c=String.fromCharCode(e.charCode||e.keyCode);
if(c.match(this.invalidCharacters)){
e.stopPropagation();
e.preventDefault();
this.setMessage(this.nls.INVALID_CHARACTERS);
}
}
}
},_handleInput:function(){
if(this.invalidCharacters&&this.textBox.value.match(this.invalidCharacters)){
this.textBox.value=this.textBox.value.replace(this.invalidCharacters,"");
this.setMessage(this.nls.INVALID_CHARACTERS_REMOVED);
}
},setSelectionRange:function(_1e,end){
if(this.textBox.setSelectionRange){
this.textBox.setSelectionRange(_1e,end);
}else{
var _1f=this.textBox.createTextRange();
_1f.move("character",0);
_1f.moveStart("character",_1e);
_1f.moveEnd("character",end);
_1f.select();
}
},_save:function(){
this.emit("save",{commentBox:this});
},_cancel:function(){
this.emit("cancel",{commentBox:this});
},destroy:function(){
this._isDestroying=true;
this.inherited(arguments);
},onsave:function(){
},oncancel:function(){
}});
});


;define("ic-share/fileviewer/dialog/FlagActionDialog",["dojo/_base/declare","dojo/text!./templates/FlagActionDialog.html","dijit/Dialog","dojo/_base/lang","./DialogAction","dojo/Evented","dojo/i18n!../nls/FileViewerStrings","dojo/string","dojo/dom-attr","dijit/registry","../widget/EditBox"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
return _1([_3,_6],{"class":"flagActionDialog",constructor:function(_c){
var _d,_e;
_d=_c.strings||{};
_e=new _5({template:_2,nls:_d});
this.title=_d.TITLE;
_e.clickLink=_4.hitch(this,function(e){
if(e.target.id==="ok"){
this.emit("clicked",{summary:this.summaryBox.get("value")});
}
this.onCancel();
});
_e.startup();
this.content=_e;
this.summaryBox=new _b();
this.summaryBox.placeAt(this.content.summaryContainer);
},postCreate:function(){
this.inherited(arguments);
var _f=_a.getUniqueId("fileviewer")+"_flagActionDialogContent";
_9.set(this.domNode,"aria-label",this._get("title"));
_9.set(this.domNode,"aria-describedBy",_f);
_9.set(this.content.promptContainer,"id",_f);
},onCancel:function(){
this.emit("close");
this.inherited(arguments);
}});
});


;define("ic-share/fileviewer/util/ModerationUtil",["dojo/topic","../dialog/ConfirmationDialog","dojo/_base/lang","dojo/_base/json","dojo/i18n!../nls/FileViewerStrings"],function(_1,_2,_3,_4,_5){
return {launchModerationDialog:function(_6){
if(!_6){
var _6=_5.ACTION.MODERATION||{DIALOG_TITLE:"Success",PROMPT:"The changes have been submitted for review. This file will not be available until the changes are approved.",CANCEL:"OK"};
}
this.dialog=new _2({strings:_6,hideOk:true});
this.dialog.on("clicked",_3.hitch(this,"_closeFile"));
this.dialog.on("close",_3.hitch(this,"_closeFile"));
this.dialog.placeAt(document.body);
this.dialog.startup();
this.dialog.show();
},_closeFile:function(){
_1.publish("ic-fileviewer/dirty");
_1.publish("ic-fileviewer/action/completed");
},isFileModerated:function(_7){
return _7.get("status")=="pending";
},isResponseModerated:function(_8){
var _9=_8.body.innerHTML;
var _a=_4.fromJson(_9);
var _b=_a.categories;
var _c=(_b[1]&&_b[1].term);
return _c;
}};
});


;define("ic-share/fileviewer/action/FlagAction",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/topic","dojo/string","./Action","../dialog/FlagActionDialog","../util/network","dojo/Deferred","../config/globals","dojo/i18n!../nls/FileViewerStrings","../util/ModerationUtil","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){
"use strict";
var _e=_1([_6],{groupId:2,_inProgress:false,_handlers:[],constructor:function(_f){
_2.mixin(this,_f);
if(this.item&&this.item.moderatedBeanType==="comment"){
this.nls=_b.ACTION.FLAG.COMMENT;
}else{
this.item=this.file.bean;
this.nls=_b.ACTION.FLAG.FILE;
}
this.title=this.name=this.nls.NAME;
this.a11y=this.nls.A11Y;
},onLinkClicked:function(){
this.createDialog();
_d.track("flag");
},createDialog:function(){
this.dialog=new _7({strings:this.nls});
this._handlers.push(this.dialog.on("clicked",_2.hitch(this,"_flag")));
this._handlers.push(this.dialog.on("close",_2.hitch(this,"_close")));
this.dialog.placeAt(document.body);
this.dialog.startup();
this.dialog.show();
},_flag:function(_10){
if(!this._inProgress){
this._inProgress=true;
this.item.flag(_10.summary).then(_2.hitch(this,"_onSuccess"),_2.hitch(this,function(_11){
this._onError(_11);
}));
}
},_onSuccess:function(){
this._inProgress=false;
var _12={type:"success",message:this.nls.SUCCESS};
var _13=_b.ACTION.FLAG.FILE_DIALOG||{DIALOG_TITLE:"Success",PROMPT:"The file has been flagged and submitted for review",CANCEL:"OK"};
if(this.item.moderatedBeanType==="document"){
_c.launchModerationDialog(_13);
}else{
_4.publish("ic-fileviewer/refresh",_12);
_4.publish("ic-fileviewer/push/messages",{type:_12.type,message:_12.message,cancelable:true});
}
},_onError:function(_14){
this._inProgress=false;
var _15={type:"error",message:this.nls.ERROR};
_4.publish("ic-fileviewer/refresh",_15);
},_close:function(){
_3.forEach(this._handlers,function(_16){
_16.remove();
});
this._handlers=[];
delete this.dialog;
this._inProgress=false;
}});
return {isSubItem:true,create:function(_17){
return new _e(_17);
},isValid:function(_18,_19){
var _1a=new _9();
var _1b=_a.isAuthenticated;
if(_18.bean.get("libraryType")!=="communityFiles"||!_1b){
return false;
}
_18.bean.get("fullEntry").then(function(_1c){
_1a.resolve(_1c.get("reportUrl")&&_1c.get("reportUrl")!=="");
});
return _1a.promise;
},getClassName:function(){
return "ics-viewer-action-flag";
}};
});


;define("dojo/text!ic-share/fileviewer/action/_extensions.json", '/* Copyright IBM Corp. 2015  All Rights Reserved.                    */\n\n/**\n * This is for demo/prototyping purposes only.\n * \n * This file should contain a single JSON array where each element is an object containing:\n * \n *    "types"   - an array of file name extensions\n *    "target"  - the URL to invoke when the button is clicked\n *    "label"   - the text of the button in the file details overlay header\n *    \n * If an extension appears in multiple keys, only the first extension will apply.\n * \n * The following placeholders are supported in target URLs:\n * \n *    file_id - The UUID of the file\n *    user_id - The profiles ID of the current user (empty if the user is anonymous)\n *    org_id  - The ID of the user\'s organization (empty if the user is anonymous or on-prem)\n * \n * For example:\n * \n * [\n *    {\n *       "types":  [ "doc", "docx" ],\n *       "target": "https://example.com/document?file=${file_id}&user=${user_id}&org=${org_id}",\n *       "label":  "Edit in Office 365"\n *    },\n *    {\n *       "types":  [ "xls", "xlsx" ],\n *       "target": "https://example.com/spreadsheet?file=${file_id}&user=${user_id}&org=${org_id}",\n *       "label":  "Edit in Office 365"\n *    }\n * ]\n * \n * Possible resulting URLs might be:\n * \n * Cloud:\n *    https://example.com/document?file=3fb46...8e7d2&user=20000703&org=20000699\n *    \n * On-prem, authenticated:\n *    https://example.com/document?file=3fb46...8e7d2&user=a8cff...7c698&org=\n * \n * On-prem, anonymous:\n *    https://example.com/document?file=3fb46...8e7d2&user=&org=\n * \n * The URL will be opened in a new tab (or window, depending on the user\'s browser preferences).\n * \n */\n [\n    {\n       "fileType": "Word",\n       "types":  [ "docm", "docx", "odt" ],\n       "target": "${wopi}/word?file_id=${file_id}"\n    },\n    {\n       "fileType": "Excel",\n       "types":  [ "xlsb", "xlsm", "xlsx", "ods" ],\n       "target": "${wopi}/excel?file_id=${file_id}"\n    },\n    {\n       "fileType": "PowerPoint",\n       "types":  [ "ppsx", "pptx", "odp" ],\n       "target": "${wopi}/ppt?file_id=${file_id}"\n    }\n ]');

;define("ic-share/fileviewer/action/PrimaryExtensionAction",["dojo/_base/declare","./Action","dojo/string","dojo/text!./_extensions.json","dojo/i18n!../nls/FileViewerStrings","dojo/_base/json","dojo/_base/array","../util/feature","dojo/_base/lang","dojo/promise/all","ic-core/config/services","../config/globals","dojo/topic","dojo/dom-class","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){
"use strict";
var _10=[],_11;
if(_8.isOffice365Enabled()){
try{
_10=_6.fromJson(_4);
}
catch(e){
console.warn("Failed to load extensions from JSON",e);
}
}
function _12(){
if(!_b["files-wopi"]){
return "";
}
return _b["files-wopi"].secureUrl;
};
function _13(_14){
var _15=_c.currentUser;
if(!_15){
return "";
}
if(_15._native){
_15=_15._native;
}
return encodeURIComponent(_15[_14]||"");
};
_11=_1([_2],{postMixInProperties:function(){
this.nls=_5.ACTION;
var _16=_17(this.file.bean.get("type"));
switch(_16.fileType){
case "Word":
if(!this.nls.EDIT_OFFICE_WORD){
this.name=this.splitButtonName||"Edit in Microsoft Word Online";
this.title="Use Microsoft Word Online to edit this file";
this.a11y="This button opens the file for editing in Microsoft Word Online inside of a new window.";
}else{
this.name=this.splitButtonName||this.nls.EDIT_OFFICE_WORD.NAME;
this.title=this.nls.EDIT_OFFICE_WORD.TOOLTIP;
this.a11y=this.nls.EDIT_OFFICE_WORD.A11Y;
}
break;
case "Excel":
if(!this.nls.EDIT_OFFICE_EXCEL){
this.name=this.splitButtonName||"Edit in Microsoft Excel Online";
this.title="Use Microsoft Excel Online to edit this file";
this.a11y="This button opens the file for editing in Microsoft Excel Online inside of a new window.";
}else{
this.name=this.splitButtonName||this.nls.EDIT_OFFICE_EXCEL.NAME;
this.title=this.nls.EDIT_OFFICE_EXCEL.TOOLTIP;
this.a11y=this.nls.EDIT_OFFICE_EXCEL.A11Y;
}
break;
case "PowerPoint":
if(!this.nls.EDIT_OFFICE_POWERPOINT){
this.name=this.splitButtonName||"Edit in Microsoft PowerPoint Online";
this.title="Use Microsoft PowerPoint Online to edit this file";
this.a11y="This button opens the file for editing in Microsoft PowerPoint Online inside of a new window.";
}else{
this.name=this.splitButtonName||this.nls.EDIT_OFFICE_POWERPOINT.NAME;
this.title=this.nls.EDIT_OFFICE_POWERPOINT.TOOLTIP;
this.a11y=this.nls.EDIT_OFFICE_POWERPOINT.A11Y;
}
break;
default:
if(!this.nls.EDIT_OFFICE){
this.name=this.splitButtonName||"Edit in Microsoft Office Online";
this.title="Use Microsoft Office Online to edit this file";
this.a11y="This button opens the file for editing in Microsoft Office Online inside of a new window.";
}else{
this.name=this.splitButtonName||this.nls.EDIT_OFFICE.NAME;
this.title=this.nls.EDIT_OFFICE.TOOLTIP;
this.a11y=this.nls.EDIT_OFFICE.A11Y;
}
}
if(_e.contains(this.parentNode,"ics-viewer-action-edit")&&!_8.isOffice365EnabledWithoutDocsEditor()){
this.a11y=this.nls.EDIT_OFFICE.TITLE;
}
},onLinkClicked:function(){
if(_e.contains(this.parentNode,"ics-viewer-action-edit")&&!_8.isOffice365EnabledWithoutDocsEditor()){
_d.publish("ic-fileviewer/toggleActionDropdown");
}else{
window.open(this.getLink(this.file.args),"fidoEditExtension");
_f.track("editOffice365");
}
},getLink:function(_18){
var _19=_17(_18.type);
var url=_19.target;
var _1a={wopi:_12(),file_id:_18.id};
return _3.substitute(url,_1a);
}});
function _17(_1b){
var _1c=_7.filter(_10,function(_1d){
return _7.indexOf(_1d.types,_1b)!==-1;
});
return _1c&&_1c[0];
};
return {isSplitButtonItem:true,isValid:function(_1e,_1f){
if(_c.isCCM(_1e)){
return false;
}
return _a({fileBean:_1e.bean.get("fullEntry")}).then(_9.hitch(this,function(_20){
if(_1e.type==="verse"){
return false;
}
if(_1e.bean.get("isEncrypted")){
return false;
}
if(_12()===""){
return false;
}
return !!_17(_1e.bean.get("type"))&&_1e.bean.get("permissions").canEdit();
}));
},create:function(_21){
return new _11(_21);
},getClassName:function(){
return "ics-viewer-action-edit";
},getActionCategory:function(){
return "edit";
}};
});


;define("ic-share/fileviewer/action/EventAction",["dojo/_base/declare","./Action","dojo/topic"],function(_1,_2,_3){
"use strict";
return _1([_2],{onLinkClicked:function(){
_3.publish(this.eventName);
}});
});


;define("ic-share/fileviewer/editTracker",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Stateful","dojo/topic","dijit/registry"],function(_1,_2,_3,_4,_5,_6){
"use strict";
var _7=_1([_4],{init:function(){
this._subscriptions=[];
this.numUnsavedChanges=0;
this._widgets={};
this._subscriptions.push(_5.subscribe("ic-fileviewer/editStart",_3.hitch(this,function(_8,_9){
if(_8&&_9){
this._widgets[_8.get("id")]=_9;
}else{
this.numUnsavedChanges++;
}
})));
this._subscriptions.push(_5.subscribe("ic-fileviewer/editStop",_3.hitch(this,function(_a){
if(_a){
delete this._widgets[_a.get("id")];
}else{
this.numUnsavedChanges--;
if(this.numUnsavedChanges<0){
this.numUnsavedChanges=0;
}
}
})));
this._subscriptions.push(_5.subscribe("ic-fileviewer/refresh",_3.hitch(this,function(){
this.numUnsavedChanges=0;
this._widgets={};
})));
},hasUnsavedChanges:function(){
return this.numUnsavedChanges>0||this._widgetsHaveUnsavedChanges();
},_widgetsHaveUnsavedChanges:function(){
for(var _b in this._widgets){
var _c=_6.byId(_b);
var _d=this._widgets[_b];
if(_c&&_c.domNode&&_d()){
return true;
}
}
return false;
},reset:function(){
_2.forEach(this._subscriptions,function(_e){
_e.remove();
});
}});
return new _7();
});


;define("ic-share/fileviewer/action/TearOffAction",["dojo/_base/declare","./EventAction","dojo/i18n!../nls/FileViewerStrings","../config/globals","dojo/has","dojo/topic","dojo/_base/lang","../editTracker","../dialog/ConfirmationDialog","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
var _b=_1([_2],{eventName:"ic-fileviewer/action/tearoff",postMixInProperties:function(){
this.nls=_3.ACTION.TEAR_OFF;
if(!this.nls){
this.nls={TOOLTIP:"Open in new window",A11Y:"Open in new window"};
}
this.title=this.nls.TOOLTIP;
this.a11y=this.nls.A11Y;
},onLinkClicked:function(){
var _c=_7.hitch(this,this.getInherited(arguments));
if(_8.hasUnsavedChanges()){
this._showDialog(_c);
}else{
_c();
}
_a.track("tearOff");
},_showDialog:function(_d){
var _e=new _9({strings:{DIALOG_TITLE:this.nls.DIALOG_TITLE,PROMPT:this.nls.UNSAVED_CHANGES_WARNING,OK:this.nls.OPEN_ANYWAY,CANCEL:this.nls.CANCEL_ALT}});
_e.on("clicked",_7.hitch(this,function(){
_e.onCancel();
_d();
}));
_e.render();
}});
return {isSticky:true,isOverlayAction:true,create:function(_f){
return new _b(_f);
},isValid:function(){
return !_4.tornOff&&_5("fileviewer-tearoff");
},getClassName:function(){
return "ics-viewer-action-tearoff";
}};
});


;define("ic-share/fileviewer/action/actions",["../widget/ToolbarDivider","./DownloadAction","./DownloadPDFAction","./TogglePanelAction","./CloseAction","./EditDocAction","./RoundtripEditAction","./ViewDocAction","./LikeAction","./TrashFileAction","./CopyFileAction","./ToggleSyncAction","./ToggleFollowAction","./RefreshAction","./ToggleLockAction","./ToggleFavoriteAction","./CreateFromTemplateAction","./UploadNewVersionAction","./LogInAction","./FlagAction","./PrimaryExtensionAction","./TearOffAction"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16){
"use strict";
return [_15,_13,_8,_6,_12,_7,_10,_9,_2,_3,_c,_d,_f,_b,_11,_e,_a,_14,_1,_4,_16,_5];
});


;define("dojox/encoding/base64",["dojo/_base/lang"],function(_1){
var _2=_1.getObject("dojox.encoding.base64",true);
var p="=";
var _3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
_2.encode=function(ba){
var s=[],l=ba.length;
var rm=l%3;
var x=l-rm;
for(var i=0;i<x;){
var t=ba[i++]<<16|ba[i++]<<8|ba[i++];
s.push(_3.charAt((t>>>18)&63));
s.push(_3.charAt((t>>>12)&63));
s.push(_3.charAt((t>>>6)&63));
s.push(_3.charAt(t&63));
}
switch(rm){
case 2:
var t=ba[i++]<<16|ba[i++]<<8;
s.push(_3.charAt((t>>>18)&63));
s.push(_3.charAt((t>>>12)&63));
s.push(_3.charAt((t>>>6)&63));
s.push(p);
break;
case 1:
var t=ba[i++]<<16;
s.push(_3.charAt((t>>>18)&63));
s.push(_3.charAt((t>>>12)&63));
s.push(p);
s.push(p);
break;
}
return s.join("");
};
_2.decode=function(_4){
var s=_4.split(""),_5=[];
var l=s.length;
while(s[--l]==p){
}
for(var i=0;i<l;){
var t=_3.indexOf(s[i++])<<18;
if(i<=l){
t|=_3.indexOf(s[i++])<<12;
}
if(i<=l){
t|=_3.indexOf(s[i++])<<6;
}
if(i<=l){
t|=_3.indexOf(s[i++]);
}
_5.push((t>>>16)&255);
_5.push((t>>>8)&255);
_5.push(t&255);
}
while(_5[_5.length-1]==0){
_5.pop();
}
return _5;
};
return _2;
});


;define("ic-share/fileviewer/util/SAMLFrameLogin",["dojo/_base/declare","dojo/cookie"],function(_1,_2){
return _1([],{isLoggedIn:false,src:"/docs/app/doc",samlFrame:null,login:function(_3){
window.setTimeout(dojo.hitch(this,this.initSamlFrame),1000*_3);
window.setInterval(dojo.hitch(this,this.kickSamlCheck),1000*60*25);
},initSamlFrame:function(){
console.log("Docs SAML Login executing...");
var _4=document.createElement("IFRAME");
_4.name=_4.id="preemptiveSamlFrame";
_4.style.top="-9999px";
_4.style.width=_4.style.height="1px";
_4.style.display="none";
_4.src=this.src;
_4.onload=dojo.hitch(this,this._onload);
document.body.appendChild(_4);
this.samlFrame=_4;
},haveDocsLTPA:function(){
var _5=_2("LTPADocsFlag");
if(_5){
return true;
}
return false;
},kickSamlCheck:function(){
this.samlFrame.src=this.src;
if(this.haveDocsLTPA()){
this.removeImmediateSAMLFrame();
}
},removeImmediateSAMLFrame:function(){
var _6=dojo.byId("ImmediateSamlFrame");
if(_6){
document.body.removeChild(_6);
}
},_onload:function(){
}});
});


;define("ic-share/fileviewer/preview/EntitlementChecker",["dojo/_base/declare","dojo/Deferred","dojo/_base/lang","dojo/request/xhr","dojo/cookie","dojo/_base/array","dojox/encoding/base64","../util/SAMLFrameLogin","../config/globals","ic-core/config/properties"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
var _b={};
function _c(_d){
var _e,_f;
_e=_d.split("-")[1];
if(_e){
_f=_7.decode(_e);
return _6.map(_f,function(b){
return String.fromCharCode(b);
}).join("");
}
return "";
};
return _1([],{constructor:function(_10){
this.cookie=_5;
_3.mixin(this,_10);
},getViewerDfd:function(){
if(_b.viewer){
return _b.viewer;
}
if(!_b.SAMLFrameLoginCreated){
var _11=new _8();
_11.login(0);
_b.SAMLFrameLoginCreated=true;
}
var dfd=new _2();
if(!_3.isFunction(this.isAuthenticated)){
dfd.resolve(true);
}else{
if(!this.isAuthenticated()){
dfd.resolve(false);
}else{
if(this.cookie("entitlements")){
dfd.resolve(true);
}else{
if(!_9.coreServices.viewer&&_a["com.ibm.docs.types.files.view"]!=="true"&&!window.viewer){
dfd.resolve(false);
}else{
var _12={};
if(this.isCCM){
_12["X-VIEWER-REPOID"]="ecm";
}
_4.get("/viewer/api/entitlement",{handleAs:"json",timeout:30000,preventCache:true,headers:_12}).then(function(_13){
dfd.resolve(_13.entitled==="true");
},function(){
dfd.resolve(false);
});
}
}
}
}
_b.viewer=dfd;
return dfd;
},getDocsDfd:function(_14){
if(_b.docs){
return _b.docs;
}
var dfd=new _2(),_15=(_14&&_14.cookie)||_5("entitlements"),_16;
if(_15){
_16=_c(_15);
if(_16.indexOf("bh_docs")!==-1){
dfd.resolve(true);
}else{
dfd.resolve(false);
}
}else{
if(!_3.isFunction(this.isAuthenticated)){
dfd.resolve(false);
}else{
if(!this.isAuthenticated()){
dfd.resolve(false);
}else{
if(!_9.coreServices.docs&&_a["com.ibm.docs.types.files.edit"]!=="true"&&!window.concord){
dfd.resolve(false);
}else{
_4.get("/docs/api/entitlement",{handleAs:"json",timeout:30000,preventCache:true}).then(function(_17){
dfd.resolve(_17.entitlement_allowed);
},function(){
dfd.resolve(false);
});
}
}
}
}
_b.docs=dfd;
return dfd;
},resetDfds:function(){
_b={};
}});
});


;define("ic-share/fileviewer/config/Services",["dojo/_base/declare","dojo/_base/lang","./globals"],function(_1,_2,_3){
"use strict";
function _4(){
var _5=window.notesiniParameters.bssUrl;
if(_5.charAt(_5.length-1)==="/"){
_5=_5.substring(0,_5.length-1);
}
return _5;
};
return _1([],{constructor:function(_6){
_2.mixin(this,_6);
},getDocsUrl:function(){
var _7;
if(_3.isVerse){
_7=(this._connectionsDomain||_4())+"/docs";
}else{
_7="/docs";
}
return _7;
},getViewerUrl:function(){
var _8;
if(_3.isVerse){
_8=(this._connectionsDomain||_4())+"/viewer";
}else{
_8="/viewer";
}
return _8;
},getFilesUrl:function(){
var _9;
if(_3.isVerse){
_9=(this._connectionsDomain||_4())+"/files";
}else{
_9=_3.coreUrl.getServiceUrl(_3.coreServices.files);
_9=_9.uri;
}
return _9;
},getContactsUrl:function(){
var _a=_3.coreUrl.getServiceUrl(_3.coreServices.bss);
var _b="/contacts";
return (_a?_a+"/.."+_b:_b);
}});
});


;define("dojo/text!ic-share/fileviewer/panels/templates/PanelNavText.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div data-dojo-attach-point="panelNavDiv">\n  <div data-dojo-attach-point="tabsTableDiv" class="tableDiv">\n    <ul class="ics-viewer-tabs" role="tablist" data-dojo-attach-point="tabList"></ul>\n  </div>\n  <div data-dojo-attach-point="moreButton" class="moreButton"></div>\n</div>');

;define("dojo/text!ic-share/fileviewer/panels/templates/PanelNav.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<ul class="ics-viewer-tabs" role="tablist" data-dojo-attach-point="tabList">\n</ul>');

;define("dojo/text!ic-share/fileviewer/panels/templates/NavItem.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<li class="${itemId}" role="tab" data-dojo-attach-event="onclick:select" aria-selected="false" role="tab" title="${itemShortDesc}" tabindex="-1">\n      <span class="lotusAltText fileViewerIconText viewerPanel">${itemShortDesc}</span>\n      <img src="${blank}" alt="">\n   <hr>\n</li>\n');

;define("dojo/text!ic-share/fileviewer/panels/templates/NavItemText.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<li class="${itemId}" data-dojo-attach-event="onclick:select" title="${itemShortDesc}" role="tab">\n  <a data-dojo-attach-point="anchor">${itemShortDesc}</a>\n</li>\n');

;define("dojo/text!ic-share/fileviewer/panels/templates/AboutPanel.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div>\n  <div data-dojo-attach-point="versionContainer"></div>\n  <div data-dojo-attach-point="docsDraftUpdatedDateContainer"></div>\n  <div data-dojo-attach-point="updatedDateContainer"></div>\n  <div data-dojo-attach-point="createdDateContainer"></div>\n  <div data-dojo-attach-point="descriptionContainer"></div>\n  <div data-dojo-attach-point="likesContainer" class="ics-viewer-user-count-widget"></div>\n  <div data-dojo-attach-point="downloadsContainer" class="ics-viewer-user-count-widget"></div>\n  <div data-dojo-attach-point="tagsContainer"></div>\n  <div data-dojo-attach-point="filesizeContainer"></div>\n  <div data-dojo-attach-point="securityContainer"></div>\n  <div data-dojo-attach-point="linksContainer"></div>\n  <div data-dojo-attach-point="thumbnailContainer"></div>\n</div>\n');

;define("dojo/text!ic-share/fileviewer/panels/templates/Stream.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-viewer-stream loading">\n  <div class="panelContent streamContent bidiAware" data-dojo-attach-point="content"></div>\n  <div class="loadContainer">\n    <div class="loadingMessage">${nls.LOADING}</div>\n    <a class="loadMoreLink" href="javascript:;" data-dojo-attach-point="loadMoreLink" data-dojo-attach-event="click:_loadNextPage" role="button">${nls.LOAD_MORE}</a>\n  </div>\n</div>\n');

;define("ic-share/fileviewer/panels/Stream",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/Stream.html","dojo/_base/array","dojo/dom-class","dojo/dom-construct","dojo/_base/lang","dojo/i18n!../nls/FileViewerStrings","dojo/promise/all"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
return _1([_2,_3],{templateString:_4,postMixInProperties:function(){
this.nls=_9.STREAM;
this.factory=this.factory||{};
this._feed=this.file.get(this.dataKey);
},postCreate:function(){
this.widgets=[];
if(this.filteredItems){
_6.remove(this.domNode,"loading");
this.render(this.filteredItems);
return;
}
if(this.factory._items){
_6.remove(this.domNode,"loading");
this.render(this.factory._items);
return;
}
var _b=[this._feed.refresh()];
if(this.requireFullFileEntry){
_b.push(this.file.get("fullEntry"));
}
_a(_b).then(_8.hitch(this,function(_c){
this._handleLoadItems(_c[0]);
}));
},refresh:function(_d){
if(this.refreshCallback){
this.refreshCallback(_d);
return;
}
_7.empty(this.content);
_6.add(this.domNode,"loading");
this._feed.refresh().then(_8.hitch(this,function(_e){
this._handleLoadItems(_e);
}));
},_loadNextPage:function(){
_6.add(this.domNode,"loading");
this._feed.next().then(_8.hitch(this,this._handleLoadItems));
},_handleLoadItems:function(_f){
this.clearItems();
this._setFactoryTitle(this._feed.getTotal());
_6.remove(this.domNode,"loading");
this.render(_f);
if(this._feed.hasNext()){
_6.add(this.domNode,"hasNext");
}else{
_6.remove(this.domNode,"hasNext");
}
this.emit("loaded");
},render:function(_10){
if(_10.length){
var _11=this._getLastEntryNode();
if(_11){
_6.remove(this._getLastEntryNode(),"ics-viewer-last");
}
_5.forEach(_10,this.addItem,this);
_6.add(this._getLastEntryNode(),"ics-viewer-last");
this.widgets[this.widgets.length-1].set("isLast",true);
}
},addItem:function(_12){
var _13={entry:_12,file:this.file,actions:this.factory.actions,refresh:_8.hitch(this,this.refresh),onEdit:_8.hitch(this,this.edit),deleteErrorStrings:this.deleteErrorStrings,isActionValid:this.isActionValid};
_8.mixin(_13,this.entryArgs);
var _14=new this.entryConstructor(_13);
this.widgets.push(_14);
_14.placeAt(this.content);
_14.startup();
},_getLastEntryNode:function(){
return this.content.childNodes[this.content.childNodes.length-1];
},removeItem:function(_15){
var _16;
_5.some(this.widgets,function(_17,_18){
if(_17.entry.get("id")===_15.get("id")){
_16=_18;
_17.destroy();
return true;
}
});
this.widgets.splice(_16,1);
this.filteredItems.splice(_16,1);
},_setFactoryTitle:function(){
},edit:function(){
return;
},onloaded:function(){
},clearItems:function(){
this.widgets=[];
this.filteredItems=[];
},size:function(){
return this.widgets.length;
}});
});


;define("dojo/text!ic-share/fileviewer/widget/templates/TagWidget.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-viewer-tagwidget">\n  <div class="typeAheadContainer" data-dojo-attach-point="typeAheadContainer"></div>\n  <div data-dojo-attach-point="errorContainer"></div>\n  <ul data-dojo-attach-point="tagList"></ul>\n</div>\n');

;define("dojo/text!ic-share/fileviewer/widget/templates/Tag.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-viewer-tag">\n  <a href="${url}" data-dojo-attach-point="tagLink" data-dojo-attach-event="click:_linkClicked" data-allowClick="true">${displayValue}</a><a href="javascript:;" class="removeTagLink" data-dojo-attach-event="click:_remove" role="button" title="${entryNls.REMOVE}" data-allowClick="true">\n  	<img data-allowClick="true" src="${_blank}" alt="${entryNls.REMOVE}"></img>\n  	<span data-allowClick="true" class="lotusAltText fileViewerIconText">X</span>\n  </a>\n</div>\n');

;define("dojo/text!ic-share/fileviewer/widget/templates/TagTypeAhead.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-tagtypeahead-container">\n  <div data-dojo-attach-point="inputContainer">\n    <table role="presentation">\n      <tr>\n        <td class="typeAheadTd">\n           <label class="lotusOffScreen" data-dojo-attach-point="typeAheadInputLabel"></label>\n           <input type="text" data-dojo-attach-point="typeAheadInput"></input>\n        </td>\n        <td><a href="javascript:;" class="save-tag-button" data-dojo-attach-event="click:_save" role="button" title="${tagNls.ADD_TOOLTIP}">\n        <img class="addTagImg" src="${_blank}" alt=""></img>\n        <span class="lotusAltText fileViewerIconText">${tagNls.ADD_TOOLTIP}</span>\n        </a></td>\n      </tr>\n    </table>\n  </div>\n</div>\n');

;define("ic-share/fileviewer/widget/TagTypeAhead",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","../config/globals","dojo/text!./templates/TagTypeAhead.html","dojo/_base/config","dijit/focus","dojo/on","dojo/_base/lang","dojo/keys","dojo/i18n!../nls/FileViewerStrings","dojo/has","dojo/dom-attr"],function(_1,_2,_3,_4,_5,_6,_7,on,_8,_9,_a,_b,_c){
return _1([_2,_3],{templateString:_5,postMixInProperties:function(){
this._blank=_6.blankGif;
this.tagNls=_a.TAG_WIDGET;
this.entryNls=_a.ENTRY;
},postCreate:function(){
this.inherited(arguments);
this.tagStore=this.file.get("tagFeed");
var _d=this.id+"_selectTag";
_c.set(this.typeAheadInputLabel,"for",_d);
_c.set(this.typeAheadInputLabel,"innerHTML",_a.PANEL.ABOUT.ADD_TAGS);
this.typeAhead=new _4.TagTypeAhead({id:_d,name:"_shareTaggerTypeAhead",size:"30",pageSize:10,multipleValues:true,token:" ",_strings:this._strings,hideEmptyResults:true,autoSelectChars:[],libraryId:this.libraryId,userLibrary:this.userLibrary,store:this.tagStore,popupClassName:"ics-viewer-tag-popup"},this.typeAheadInput);
this.textBox=this.typeAhead.textbox;
on(this.textBox,"keydown",_8.hitch(this,function(e){
if(e.keyCode===_9.ENTER){
this._save();
_c.remove(this.textBox,"aria-owns");
e.stopPropagation();
e.preventDefault();
}else{
if(e.keyCode===_9.ESCAPE){
this._cancel();
e.stopPropagation();
e.preventDefault();
}
}
}));
},getValue:function(){
return this.textBox.value.replace(/["']/g,"").split(/\s+/g);
},setValue:function(_e){
this.textBox.value=_e.join(" ");
},reset:function(){
this.textBox.value="";
},isEmpty:function(){
return _8.trim(this.textBox.value).length===0;
},focus:function(){
var _f=(_b("ie")||_b("trident"))?500:0;
setTimeout(_8.hitch(this,function(){
_7.focus(this.textBox);
}),_f);
},blur:function(){
this.textBox.blur();
},_save:function(){
this.emit("save",{inputBox:this});
},_cancel:function(){
this.reset();
this.emit("cancel",{inputBox:this});
},onsave:function(){
},oncancel:function(){
}});
});


;define("ic-share/fileviewer/util/text",["dojo/has","dojo/_base/lang","dojo/sniff"],function(_1,_2){
var _3=/(mailto:|((https?|s?ftp):\/\/))[^\s]*/gi,_4=/\r?\n/g,_5=/ {2}/g;
return {htmlify:function(_6){
_6=_6||"";
var _7,u,l;
while((_7=_4.exec(_6))){
u=_7[0];
l="<br>";
_4.lastIndex+=l.length-u.length;
_6=_6.replace(u,l);
}
if(_1("ie")===8||window.mockIE8){
while(_6.indexOf("\\n")>-1){
_6=_6.replace("\\n","<BR>");
}
}
while((_7=_3.exec(_6))){
u=_7[0];
l="<a href=\""+u+"\">"+u+"</a>";
_3.lastIndex+=l.length-u.length;
_6=_6.replace(u,l);
}
_6=_6.replace(_5," &nbsp;");
return _6;
},trim:function(_8,_9){
_8=_2.trim(_8);
if(_9!==undefined){
var i=this.getCharIndexForUtf8Index(_8,_9);
if(i!=-1){
_8=_8.substring(0,i);
}
}
return _8;
},getCharIndexForUtf8Index:function(s,_a){
if(!s||typeof s!="string"){
return -1;
}
var _b=0;
var _c=s.length;
for(var i=0;i<_c;i++){
var c=s.charAt(i);
try{
var _d=encodeURIComponent(c);
if(_d.length>2){
_b+=_d.length/3;
}else{
_b++;
}
if(_b>_a){
return i;
}
}
catch(e){
_b+=2;
if(_b>_a){
if((i%2)===0){
return ((_b%2)===0)?i:i-1;
}else{
return ((_b%2)===0)?i-1:i;
}
}
}
}
return -1;
},breakString:function(_e){
var _f,_10,_11,_12;
if(!_e){
return;
}
_10=Math.ceil(_e.length/2);
_f=_e.indexOf(" ");
if(_f<=0||_f===_e.length-1){
return _e;
}
if(_f>=_10){
return _e.replace(" ","<br/>");
}
_11=_e.slice(0,_10);
_12=_e.slice(_10);
if((_10-_11.lastIndexOf(" "))<(_12.indexOf(" "))||_12.indexOf(" ")<0){
return _11.replace(/ ([^ ]*)$/,"<br/>$1")+_12;
}
return _11+_12.replace(" ","<br/>");
}};
});


;define("ic-share/fileviewer/util/validation",["dojo/dom-construct","dojo/dom-class","dojo/i18n!../nls/FileViewerStrings","dojo/on","dojo/_base/lang","dojo/_base/array","./text"],function(_1,_2,_3,on,_4,_5,_6){
var _7=_3.VALIDATION,_8="ics-viewer-validation";
return {TAG_LENGTH:100,FILENAME_LENGTH:252,COLLECTIONNAME_LENGTH:256,DESCRIPTION_LENGTH:2048,SHARE_MESSAGE_LENGTH:2048,COMMENT_LENGTH:50*1024,INVALID_FILENAME_CHARS:/[\\\/\:\*\?\<\>\|\"]/g,validateComment:function(_9){
var _a={maxLength:this.COMMENT_LENGTH,nls:_7.COMMENT,node:_9.textAreaContainer,widget:_9,value:_9.getRawValue()};
return this.validateLength(_a);
},validateDescription:function(_b,_c){
_c=_4.mixin({maxLength:this.DESCRIPTION_LENGTH,nls:_7.DESCRIPTION,node:_b.textContainer,widget:_b,value:_b.get("value")},_c);
return this.validateLength(_c);
},validateShareMessage:function(_d){
var _e={maxLength:this.SHARE_MESSAGE_LENGTH,nls:_7.SHARE_MESSAGE,node:_d.textContainer,widget:_d,value:_d.get("value")};
return this.validateLength(_e);
},validateTags:function(_f){
var _10=this.TAG_LENGTH;
var _11=function(){
var _12=_f.getValue();
_12=_5.map(_12,function(tag){
return lconn.core.util.text.trim(tag,_10);
});
_f.setValue(_12);
};
var _13={maxLength:_10,nls:_f.getValue().length===1?_7.TAG:_7.TAGS,node:_f.inputContainer,widget:_f,shorten:_11};
return _5.every(_f.getValue(),function(tag){
_13.value=tag;
return this.validateLength(_13);
},this);
},validateLength:function(_14){
this.removeValidationMessage(_14.node);
if(_14.value.length<=_14.maxLength){
return true;
}
var div,_15,_16=_14.node;
div=_1.create("div",{className:_8,role:"alert"});
div.appendChild(document.createTextNode(_14.nls.WARN_TOO_LONG));
_1.create("span",{innerHTML:"&nbsp;&nbsp;"},div);
var _17=_3.VALIDATION.A11Y_TEXT||"Automatically shorten this text";
_15=_1.create("a",{href:"javascript:;",role:"button",title:_17},div);
_15.appendChild(document.createTextNode(_14.nls.TRIM));
on(_15,"click",_4.hitch(this,function(){
if(_4.isFunction(_14.shorten)){
_14.shorten();
}else{
var _18=_14.value;
_18=_6.trim(_18,_14.maxLength);
_14.widget.setValue(_18);
}
_1.destroy(div);
}));
_1.place(div,_16,"before");
_14.widget.validationNode=div;
_15.focus();
return false;
},removeValidationMessage:function(_19){
var _1a=_19.previousSibling;
if(_1a&&_2.contains(_1a,_8)){
_1.destroy(_1a);
}
}};
});


;define("ic-share/fileviewer/widget/TagWidget",["dojo/_base/declare","dojo/_base/array","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/TagWidget.html","dojo/text!./templates/Tag.html","dojo/dom-construct","dojo/_base/lang","./TagTypeAhead","dojo/dom-class","dojo/_base/config","../data/util/routes","../util/validation","./MessageBox","../util/network","dojo/i18n!../nls/FileViewerStrings","dojo/window","dojo/when","dojox/html/entities","dojo/on","dojo/dom","dojo/dom-attr","dojo/dom-style","../util/html","dojo/has","../util/fidoNewRelic","../util/history"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,win,_11,_12,on,dom,_13,_14,_15,has,_16,_17){
var Tag=_1([_3,_4],{templateString:_6,postMixInProperties:function(){
this._blank=_b.blankGif;
var _18=_17.backgroundPageUrl;
this.url=_c.getTagUrl(this.file,this.value,_18);
this.entryNls=_10.ENTRY;
this.displayValue=this.value;
},postCreate:function(){
_15.processLink(this.tagLink);
},_remove:function(){
this.emit("remove",{tag:this});
},_linkClicked:function(){
this.emit("linkclicked",{tag:this});
},onremove:function(){
},onlinkclicked:function(){
}});
return _1([_3,_4],{templateString:_5,_TagTypeAhead:_9,postMixInProperties:function(){
this.nls=_10.TAG_WIDGET;
},postCreate:function(){
var _19={type:"error"};
this._errorBox=_e.create(_19);
this._errorBox._hide();
this._errorBox.placeAt(this.errorContainer);
_11(this.file.get("fullEntry"),_8.hitch(this,this._renderTags));
},_renderTags:function(){
_7.empty(this.tagList);
_2.forEach(this.file.get("tags"),function(_1a){
var tag=new Tag({value:_1a,file:this.file}),_1b=_7.create("li",{},this.tagList);
tag.on("remove",_8.hitch(this,this._removeTag,_1b));
tag.on("linkclicked",_8.hitch(this,function(){
this.stopEditing();
}));
tag.placeAt(_1b);
tag.startup();
},this);
this._onTagsUpdated();
},_onTagsUpdated:function(){
if(this.file.get("tags").length===0){
_a.add(this.entryWidget.domNode,"emptyContent");
_14.set(this.tagList,"display","none");
}else{
_a.remove(this.entryWidget.domNode,"emptyContent");
_14.set(this.tagList,"display","block");
}
},toggleEditing:function(){
if(this._isEditing){
this.stopEditing();
}else{
this.startEditing();
}
},startEditing:function(){
this._isEditing=true;
_a.add(this.domNode,"editing");
_a.add(this.entryWidget.domNode,"editing");
var _1c=this.inputBox=new this._TagTypeAhead({file:this.file});
_1c.placeAt(this.typeAheadContainer);
_1c.startup();
_1c.on("save",_8.hitch(this,this._addTags));
_1c.on("cancel",_8.hitch(this,this.stopEditing));
_1c.focus();
setTimeout(_8.hitch(this,function(){
this._setupBlurHandler();
}),0);
},_setupBlurHandler:function(){
this.focusHandler=on(document,has("ie")<=9?"mousedown":"click",_8.hitch(this,function(evt){
var el=evt.target;
if(dom.isDescendant(el,this.inputBox.domNode)||(this.inputBox.typeAhead.dropDown&&dom.isDescendant(el,this.inputBox.typeAhead.dropDown.domNode))){
return;
}
if(_13.has(el,"data-allowClick")){
return;
}
this.stopEditing();
}));
},stopEditing:function(){
if(!this._isEditing){
return;
}
this._isEditing=false;
_a.remove(this.domNode,"editing");
_a.remove(this.entryWidget.domNode,"editing");
this.inputBox.destroy();
this._errorBox.removeMessage();
this.focusHandler.remove();
},_addTags:function(e){
this._errorBox.removeMessage();
if(!_d.validateTags(e.inputBox)){
return;
}
var _1d=e.inputBox.getValue();
this.file.addTags(_1d).then(_8.hitch(this,this._onAddTagsComplete),_8.hitch(this,this._displayError,this.nls.ERROR.SAVE));
},_onAddTagsComplete:function(){
this._renderTags();
this.inputBox.reset();
this.inputBox.focus();
},_removeTag:function(_1e,e){
this._errorBox.removeMessage();
this.file.removeTag(e.tag.value).then(_8.hitch(this,function(){
e.tag.destroy();
_7.destroy(_1e);
this._onTagsUpdated();
}),_8.hitch(this,this._displayError,this.nls.ERROR.DELETE));
_16.track("removeTag");
},_displayError:function(_1f,_20){
win.scrollIntoView(this.errorContainer);
this._errorBox.setMessage(_f.getErrorMessage(_20,_1f));
}});
});


;define("dojo/text!ic-share/fileviewer/widget/templates/ExpandableText.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    --> \n<div class="ics-viewer-expandable-text bidiAware" aria-live="rude">\n  <div class="textContainer bidiAware" data-dojo-attach-point="textContainer">\n  	<span class="bidiAware" data-dojo-attach-point="textNode"></span>\n  </div>\n  <a class="readMore" href="javascript:;" data-dojo-attach-point="readMoreLink" data-dojo-attach-event="click:expand" role="button">${nls.READ_MORE}</a>\n  <a class="readLess" href="javascript:;" data-dojo-attach-point="readLessLink" data-dojo-attach-event="click:collapse" role="button">${nls.READ_LESS}</a>\n</div>\n');

;define("ic-share/fileviewer/widget/ExpandableText",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/ExpandableText.html","dojo/dom-style","dojo/dom-class","dojo/dom-geometry","dojo/i18n!../nls/FileViewerStrings","dojo/dom-construct","../util/html","dojo/query","dojo/_base/lang"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
return _1([_2,_3],{templateString:_4,htmlText:false,visibleLines:-1,showCollapseLink:true,postMixInProperties:function(){
this.nls=_8.EXPANDABLE_TEXT;
this.expandable=this.visibleLines>=0;
},postCreate:function(){
this.readMoreLink.style.display="none";
},startup:function(){
this.inherited(arguments);
if(this.text!==undefined){
this._renderText();
}
},_setTextAttr:function(_d){
this.text=_d;
if(this._started){
this._renderText();
}
},_renderText:function(){
_9.empty(this.textNode);
var _e=this.text;
if(_c.getObject("lconn.core.globalization.api.isBidiEnabled")){
if(lconn.core.globalization.api.isBidiEnabled()){
_e=lconn.core.globalization.bidiUtil.enforceTextDirectionMultiLine(this.text,"AT_USER");
}
}
var _f;
if(this.htmlText){
_f=_9.toDom(_e);
}else{
_f=document.createDocumentFragment();
_a.createTextNode(document,_f,_e);
}
this.textNode.appendChild(_f);
_b("a",this.textNode).forEach(_a.processLink);
if(this.expandable){
this._addExpandLink();
}
},_addExpandLink:function(){
if(_7.position(this.textContainer).h==0){
this.readMoreLink.style.display="none";
this.readLessLink.style.display="none";
return;
}
this.expand();
_6.remove(this.domNode,"collapsable");
this.readMoreLink.style.display="";
var _10=_5.getComputedStyle(this.textContainer);
this._lineHeight=Number(_10.lineHeight.replace("px",""));
this._collapsedHeight=this._lineHeight*this.visibleLines;
this._fullHeight=_7.position(this.textContainer).h;
if(this._lineHeight&&((this._collapsedHeight+this._lineHeight)<this._fullHeight)){
this.collapse();
if(this.showCollapseLink){
_6.add(this.domNode,"collapsable");
}
}
},collapse:function(){
_5.set(this.textContainer,"maxHeight",(this._lineHeight*this.visibleLines)+"px");
_6.remove(this.domNode,"expanded");
this.textNode.innerHTML=this.text;
},expand:function(){
_5.set(this.textContainer,"maxHeight","none");
_6.add(this.domNode,"expanded");
this.emit("expand",{});
this.textNode.innerHTML=this.text;
}});
});


;define("dojo/text!ic-share/fileviewer/panels/templates/EntryWidget.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-panel-entry bidiAware" data-dojo-attach-event="mouseover:mouseOver, mouseout:mouseOut">\n  <div class="confirmation"><span>&nbsp;</span>\n  	<div>\n  	<a class="confirm bad" href="javascript:;" title="ok">${entryNls.OK}</a>\n  	<a class="cancel neutral" href="javascript:;" title="cancel">${entryNls.CANCEL}</a>\n  	</div>\n  </div>\n\n  <div class="icon" data-dojo-attach-point="iconNodeContainer">\n     <a href="${iconLink}" class="${iconLinkClasses}" title="${iconLinkTitle}" data-dojo-attach-point="iconLinkNode" role="button" tabindex="-1" aria-label="${dropDownButton}">\n        <img src="${iconSource}" class="${iconClasses}" data-dojo-attach-point="iconNode" alt="${dropDownButton}"/>\n     </a>\n  </div>\n\n  <span class="header1" data-dojo-attach-point="h1Node">${h1}</span>\n  <a class="header1Action action" href="javascript:;" data-dojo-attach-point="header1Action" data-dojo-attach-event="click:_headerActionClick" role="button" ${editNls.ROLE}" alt="">\n  	<img class="header1ActionIcon" src="${_blankGif}" alt=""></img>\n  	<span class="lotusAltText fileViewerIconText">${editNls.ROLE}</span>\n  </a>\n  <a class="remove action" href="javascript:;" data-dojo-attach-point="removeAction" data-dojo-attach-event="onclick:remove" role="button" title="${entryNls.REMOVE}"><img class="removeIcon" src="${_blankGif}" alt=""></img>\n  	<span class="lotusAltText fileViewerIconText">${entryNls.REMOVE}</span>\n  </a>\n  <span class="header2" data-dojo-attach-point="h2Node">${h2}</span>\n  <span class="header3">${h3}</span>\n\n  <div class="content bidiAware" data-dojo-attach-point="contentContainer,contentNode"></div>\n  <div class="footer">${footer}</div>\n  <div class="actions" data-dojo-attach-point="actionContainer">\n      <span class="action download">\n	  	<a href="${downloadLink}" title="${downloadTooltip}" data-dojo-attach-point="link" data-dojo-attach-event="onclick:download" role="button"><img class="downloadIcon" src="${_blankGif}" alt="">\n	  		<span class="lotusAltText fileViewerIconText">${downloadNls.TOOLTIP}</span>\n	  	</a>\n	  </span>\n	  <span class="action restore">\n	  	<a href="javascript:;" title="${restoreTooltip}" data-dojo-attach-event="onclick:restore" role="button"><img class="restoreIcon" src="${_blankGif}" alt=""></img>\n	  		<span class="lotusAltText fileViewerIconText">${entryNls.RESTORE}</span>\n	  	</a>\n	  </span>\n	  <span class="action edit">\n	  	<a href="javascript:;" title="${editTooltip}" data-dojo-attach-event="onclick:edit" role="button"><img class="editIcon" src="${_blankGif}" alt=""></img>\n	  		<span class="lotusAltText fileViewerIconText">${editNls.ROLE}</span>\n	  	</a>\n	  </span>\n	  <span class="action delete">\n	  	<a href="javascript:;" title="${removeTooltip}" data-dojo-attach-event="onclick:remove" role="button" class="deleteAnchor"><img class="removeIcon" src="${_blankGif}" alt=""></img>\n	  		<span class="lotusAltText fileViewerIconText">${entryNls.REMOVE}</span>\n	  	</a>\n	  </span>\n        <span class="action flag">\n      <a href="javascript:;" title="${flagTooltip}" data-dojo-attach-event="onclick:flag" role="button"><img class="removeIcon" src="${_blankGif}" alt=""></img>\n        <span class="lotusAltText fileViewerIconText">${entryNls.FLAG}</span>\n      </a>\n    </span>\n  </div>\n</div>\n');

;define("ic-share/fileviewer/panels/EntryWidget",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/EntryWidget.html","dojo/dom-class","dojo/_base/array","dojo/_base/lang","../util/network","../util/DateFormat","dojo/i18n!../nls/FileViewerStrings","dojo/string","dojo/dom-construct","../config/globals","dojox/html/entities","../widget/ExpandableText","dojo/dom-style","dojo/when","../util/html","dojo/dom-geometry","dojo/query","../uiState"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15){
return _1([_2,_3],{templateString:_4,_setIconSourceAttr:{node:"iconNode",type:"attribute",attribute:"src"},_setH1Attr:{node:"h1Node",type:"innerHTML"},_setIconAltTextAttr:{node:"iconNode",type:"attribute",attribute:"alt"},_setIconLinkAttr:{node:"iconLinkNode",type:"attribute",attribute:"href"},_setIconLinkTitleAttr:{node:"iconLinkNode",type:"attribute",attribute:"title"},_setIconLinkClassesAttr:{node:"iconLinkNode",type:"attribute",attribute:"class"},_setHeader1TooltipAttr:{node:"h1Node",type:"attribute",attribute:"title"},_setHeader2TooltipAttr:{node:"h2Node",type:"attribute",attribute:"title"},_setHeader3TooltipAttr:{node:"h3Node",type:"attribute",attribute:"title"},constructor:function(){
this.entryNls=_a.ENTRY;
if(!this.entryNls.FLAG){
this.entryNls.FLAG="Flag As Inappropriate";
}
this.editNls=_a.SHARE.ACTION.EDIT;
this.editDescNls=_a.ACTION.EDIT_DESCRIPTION;
this.downloadNls=_a.ACTION.DOWNLOAD;
this.iconSource=this._blankGif;
this.iconAltText="";
this.iconLink="javascript:;";
this.iconLinkClasses="";
this.iconLinkTitle="";
this.dropDownButton=_a.ACTION.DROPDOWN_BUTTON||"Dropdown button",this.iconClasses="";
this.downloadLink="";
this.restoreTooltip="";
this.editTooltip="";
this.removeTooltip="";
this.downloadTooltip="";
this.flagTooltip="";
this.h1="";
this.h2="";
this.h3="";
this.content="";
this.footer="";
},postMixInProperties:function(){
this.h1=_e.encode(this.h1);
this.h2=_e.encode(this.h2);
this.h3=_e.encode(this.h3);
this.content=_e.encode(this.content);
this.footer=_e.encode(this.footer);
},buildRendering:function(){
this.inherited(arguments);
_5.add(this.domNode,"emptyContent");
},postCreate:function(){
_5.add(this.domNode,this.baseClasses);
_6.forEach(this.actions,_7.hitch(this,function(_16){
if(!_7.isFunction(this.isActionValid)||this.isActionValid(_16,this)){
_5.add(this.actionContainer,_16);
}
}));
_10.set(this.header1Action,"display","none");
if(this.headerAction){
var _17={file:this.file,widget:this};
_11(this.headerAction.isValid(this.file,_17),_7.hitch(this,function(_18){
var _19=_7.hitch(this,function(){
new this.headerAction.create(_17).onLinkClicked();
});
setTimeout(_7.hitch(this,function(){
this.emit("headeractionplaced",{isValid:_18,execute:_19});
}),0);
if(!_18){
return;
}
_10.set(this.header1Action,"display","");
this.on("headeraction",_19);
}));
}
},startup:function(){
this.inherited(arguments);
if(this._contentText){
this._contentText.startup();
}
},setUserName:function(_1a,_1b){
var _1c=_c.create("span",null,_1b);
_c.create("span",{className:"x-lconn-userid",style:"display: none;",innerHTML:_1a.id},_1c);
if(!_7.isFunction(_d.createPersonLink)){
_1c.appendChild(_c.toDom(_1a.name));
}else{
var _1d=_d.createPersonLink(_1a);
if(_1d){
this.set("iconLinkClasses",_1d.className);
this.set("iconLink",_1d.href);
this.iconLinkNode.setAttribute("target","_blank");
}
var _1e=_b.substitute(this.entryNls.USER_PICTURE,[_1a.name]);
this.set("iconAltText",_1e);
this.set("iconLinkTitle",_1e);
_1c.appendChild(_1d);
if(_7.isFunction(_d.attachBizCard)){
_d.attachBizCard(_1c);
var _1f=_7.hitch(this,function(){
var _20=_14(".menu_drop_icon",_1b)[0];
_14("a.lotusPerson",_1b).forEach(_7.hitch(this,function(_21){
var _22=this.usernameMaxWidth||_13.position(_1b).w;
if(_20){
_22-=14;
}
if(_22>0){
_21.style.maxWidth=_22+"px";
}
}));
});
setTimeout(_1f,0);
_15.watch("panelSize",_1f);
}
}
},getPictureUrl:function(){
var _23="/contacts/profiles/photo/";
var _24="/profiles/photo2.do?r=true&small=true&userid=";
var _25=lconn.core.config.services.scprofiles?_23:_24;
if(window.notesiniParameters){
_25=window.notesiniParameters.bssUrl+_25;
}
return _25;
},setUserImage:function(_26){
if(!_7.isFunction(_d.createPersonPhotoLink)){
var _27=this.getPictureUrl(_d.currentUser);
this.set("iconSource",_27+_26.id);
this.iconLinkNode.setAttribute("target","_blank");
}else{
var _28=_d.createPersonPhotoLink(_26);
if(_28){
this.set("iconSource",_28.firstChild.src);
}
_10.set(this.iconLinkNode,"display","none");
this.iconNodeContainer.appendChild(_28);
}
},createDialog:function(_29){
this.dialog=new this.DialogFactory(_7.mixin(this.dialogArgs,_29));
this.dialog.placeAt(document.body);
this.dialog.startup();
this.dialog.show();
},formatDate:function(_2a,_2b){
var _2c=new _9(_2a);
return _2c.formatByAge(_2b||_a.DATE.SHORT);
},mouseOver:function(){
_5.add(this.domNode,"hover");
},mouseOut:function(){
_5.remove(this.domNode,"hover");
},createItem:function(){
this.entry.create();
},edit:function(){
if(this.dialog){
return;
}
if(this.onEdit){
this.onEdit(this);
return;
}
this.createDialog({action:"edit"});
this.setupAction({action:this.entry.update});
},remove:function(){
if(this.dialog){
return;
}
this.createDialog({action:"remove"});
this.setupAction({action:this.entry.remove,errorStrings:this.deleteErrorStrings});
},update:function(){
if(this.dialog){
return;
}
this.createDialog({action:"update"});
_5.add(this.dialog.domNode,"restore");
this.setupAction({action:this.entry.update});
},download:function(){
return;
},restore:function(){
if(this.dialog){
return;
}
this.createDialog({action:"restore"});
_5.add(this.dialog.domNode,"restore");
this.setupAction({action:this.entry.restore});
},flag:function(){
return;
},reload:function(){
return;
},setupAction:function(_2d){
this._currEvt=_7.hitch(this,_2d.action);
this.dialog.on("clicked",_7.hitch(this,function(arg){
this.fireEvent(arg,this.dialog,_2d.errorStrings);
}));
this.dialog.on("close",_7.hitch(this,function(){
this.dialog=undefined;
this._currEvt="";
}));
},fireEvent:function(arg,_2e,_2f){
this._currEvt(arg).then(_7.hitch(this,function(){
_2e.onCancel();
if(this.reloadItem){
this.refresh(this);
}
this.onEventSuccess(arg,_2e);
}),_7.hitch(this,function(_30){
if(_2f){
_2e.showError(_8.getErrorMessage(_30,_2f));
}
this.onEventFailure(_30);
}));
},onEventSuccess:function(arg,_31){
},onEventFailure:function(_32){
},_setH2Attr:function(_33){
if(_7.isString(_33)){
_12.setText(this.h2Node,_33);
}else{
_c.place(_33,this.h2Node,"only");
}
},_setContentAttr:function(_34){
if(_7.isString(_34)){
this._setContentText(_34);
}else{
this._setContentWidget(_34);
}
},_setContentText:function(_35){
if(!this._contentText){
this._contentText=new _f({visibleLines:this.visibleContentLines,htmlText:this.htmlContentText});
this._contentText.placeAt(this.contentContainer);
if(this._started){
this._contentText.startup();
}
}
if(this.contentWidget){
this.contentWidget.destroy();
}
this._contentText.domNode.style.display="";
this._contentText.set("text",_35);
if(_35===""){
_5.add(this.domNode,"emptyContent");
}else{
_5.remove(this.domNode,"emptyContent");
}
},_setContentWidget:function(_36){
if(this._contentText){
this._contentText.domNode.style.display="none";
}
if(this.contentWidget){
this.contentWidget.destroy();
}
this.contentWidget=_36;
this.contentWidget.placeAt(this.contentContainer);
this.contentWidget.startup();
},_headerActionClick:function(){
this.emit("headeraction",{});
},onheaderactionplaced:function(){
},onheaderaction:function(){
return;
}});
});


;define("ic-share/fileviewer/panels/DropdownStream",["dojo/_base/declare","dojo/_base/lang","./EntryWidget","./Stream","dojo/dom-construct","dojo/on","dojo/dom-class","dojo/dom-style","dojo/fx","../util/html","dojo/sniff"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9,_a){
return _1([_3],{postMixInProperties:function(){
this.baseClass="dropdownStream "+this.entry.baseClasses;
this.h1=this.entry.h1||"";
this.h2=this.entry.h2||"";
this._isOpen=false;
this.firstLoad=true;
},postCreate:function(){
this._setupLinks();
if(this.entry.isRecommendations){
this.file.watch("recommendations",_2.hitch(this,function(_b,_c,_d){
_9.setText(this.linkNode,this.file.get("recommendations"));
_9.setText(this.linkSpan,this.file.get("recommendations"));
this._disableRecommendationsCheck();
this.reset();
}));
}
},_setupLinks:function(){
var _e=this._addLink(this.h1,this.h1Node);
on(_e,"click",_2.hitch(this,this._clickHandler));
if(this.h2){
_e=this._addLink(this.h2,this.h2Node);
on(_e,"click",_2.hitch(this,this._clickHandler));
}
on(this.iconNodeContainer,"click",_2.hitch(this,this._clickHandler));
_7.set(this.iconNodeContainer,"cursor","pointer");
if(this.entry.isRecommendations){
this._disableRecommendationsCheck();
}
if(this.entry.isDownloads){
this._disableDownloadsCheck();
}
},_disableRecommendationsCheck:function(){
if((""+this.file.get("recommendations"))==="0"){
_6.add(this.domNode,"hideLinks");
}else{
_6.remove(this.domNode,"hideLinks");
}
},_disableDownloadsCheck:function(){
if((""+this.file.get("downloads"))==="0"){
_6.add(this.domNode,"hideLinks");
}else{
_6.remove(this.domNode,"hideLinks");
}
},_addLink:function(_f,_10){
var _11=this.linkNode=_5.create("a",{"class":"dropdownLink",innerHTML:_f,href:"javascript:;",role:"button"},_10,"only");
var _12=this.linkSpan=_5.create("span",{"class":"dropdownLinkSpan",innerHTML:_f},_10);
return _11;
},_clickHandler:function(){
if(!this._stream){
this._createStream();
}else{
this._toggleStreamPanel();
}
},_createStream:function(){
this._stream=new _4({file:this.file,dataKey:this.dataKey,entryConstructor:this.entryConstructor,entryArgs:this.entry.entryArgs});
this._stream.placeAt(this.contentContainer);
this._stream.on("loaded",_2.hitch(this,function(){
if(this.firstLoad==true){
_7.set(this._stream.domNode,"display","none");
_8.wipeIn({node:this._stream.domNode}).play();
this.firstLoad=false;
_6.toggle(this.iconNode,"open");
}
}));
},_toggleStreamPanel:function(){
if(_a("ie")===8){
if(_7.get(this._stream.domNode,"display")=="none"){
_7.set(this._stream.domNode,"display","");
}else{
_7.set(this._stream.domNode,"display","none");
}
}else{
if(_7.get(this._stream.domNode,"display")=="none"){
_8.wipeIn({node:this._stream.domNode}).play();
}else{
_8.wipeOut({node:this._stream.domNode}).play();
}
}
_6.toggle(this.iconNode,"open");
},reset:function(){
if(this._stream){
_7.set(this._stream.domNode,"display","none");
this._stream=undefined;
}
_6.remove(this.iconNode,"open");
}});
});


;define("ic-share/fileviewer/panels/NameWidget",["dojo/_base/declare","./EntryWidget","dojo/i18n!../nls/FileViewerStrings","../util/DateFormat","dojo/dom-style","dojo/_base/lang","../config/globals"],function(_1,_2,_3,_4,_5,_6,_7){
return _1([_2],{postMixInProperties:function(){
var _8=this.getPictureUrl();
this.baseClasses="name";
this.reloadItem=true;
this.type=this.entry.get("type");
this.iconSource=(_8+this.entry.get("id"))||"";
this.h1="";
this.h2="";
this.h3="";
this.content="";
this.footer="";
this.versionsNls=_3.PANEL.COMMENTS;
this.usernameMaxWidth=215;
},postCreate:function(){
this.inherited(arguments);
this.setUserName(this.entry,this.h1Node);
if(this.showDownloadInfo){
this.setDownloadVersion(this.entry,this.h2Node);
}
if(_6.isFunction(_7.createPersonPhotoLink)){
var _9=_7.createPersonPhotoLink(this.entry);
if(_9){
this.set("iconSource",_9.firstChild.src);
}
_5.set(this.iconLinkNode,"display","none");
this.iconNodeContainer.appendChild(_9);
}
},setDownloadVersion:function(_a,_b){
var _c=_a.versionNumber;
var _d=dojo.date.stamp.fromISOString(_a.time);
var _e=new _4(_d);
var _f=_e.formatByAge(_3.DATE.VERY_SHORT);
var _10=_e.formatByAge(_3.DATE.LONG);
_b.innerHTML=dojo.string.substitute(this.versionsNls.VERSION,[_c])+" - "+_f;
_b.title=_10;
}});
});


;define("ic-share/fileviewer/action/EditDescriptionAction",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class","./Action","../widget/EditBox","../util/validation","../util/network","dojo/i18n!../nls/FileViewerStrings","dojo/topic","../util/ModerationUtil","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
"use strict";
var _c=_1([_4],{postMixInProperties:function(){
this.nls=_8.ACTION.EDIT_DESCRIPTION;
},onLinkClicked:function(){
var _d=this._editBox=new _5();
_d.descriptionBox=true;
_3.remove(_d.descriptionControlsContainer,"lotusHidden");
_d.set("value",this.file.get("summary"));
this.widget.set("content",_d);
_d.focus();
_d.on("save",_2.hitch(this,this._onSave));
_d.on("cancel",_2.hitch(this,this._onCancel));
_3.add(this.widget.domNode,"editing");
},_onSave:function(){
this._editBox.setErrorMessage("");
if(!_6.validateDescription(this._editBox)){
return;
}
this.file.set("summary",this._editBox.get("value"));
this.file.update().then(_2.hitch(this,this._onSuccess),_2.hitch(this,this._onError));
_b.track("editDescription");
},_onCancel:function(){
this.widget.set("content",this.file.get("summary"));
_3.remove(this.widget.domNode,"editing");
},_onSuccess:function(){
this.widget.set("content",this.file.get("summary"));
_3.remove(this.widget.domNode,"editing");
if(this.file.get("status")=="pending"){
_a.launchModerationDialog();
}
},_onError:function(_e){
this._editBox.setErrorMessage(_7.getErrorMessage(_e,this.nls.ERROR));
},_closeFile:function(){
_9.publish("ic-fileviewer/dirty");
_9.publish("ic-fileviewer/action/completed");
}});
return {create:function(_f){
return new _c(_f);
},isValid:function(_10){
return _10.get("fullEntry").then(function(){
return _10.get("permissions").canEdit();
});
},getClassName:function(){
return "";
}};
});


;define("ic-share/fileviewer/action/EditTagsAction",["dojo/_base/declare","./Action","../util/fidoNewRelic"],function(_1,_2,_3){
"use strict";
var _4=_1([_2],{onLinkClicked:function(){
this.widget.contentWidget.toggleEditing();
_3.track("editTags");
}});
return {create:function(_5){
return new _4(_5);
},isValid:function(_6){
return _6.get("fullEntry").then(function(){
return _6.get("permissions").canTag();
});
},getClassName:function(){
return "";
}};
});


;define("dojo/text!ic-share/fileviewer/widget/templates/FileNameVersion.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<span>\n   <span class="versionNumber" data-sbw-bind="version"></span>\n   <span class="filename" data-sbw-bind="name"></span>\n</span>');

;define("ic-share/fileviewer/widget/FileNameVersion",["dojo/_base/declare","dojo/text!./templates/FileNameVersion.html","../sbw/StatefulBackedTemplatedWidget"],function(_1,_2,_3){
"use strict";
return _1([_3],{templateString:_2,postMixInProperties:function(){
this.model=this.file;
}});
});


;define("ic-share/fileviewer/widget/UploadWidget",["dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dojo/dom-class","dojo/_base/json","dojo/request","dojo/request/iframe","dojo/Evented","dijit/_TemplatedMixin","dijit/_WidgetBase","../data/util/routes","dojo/topic","../util/ModerationUtil","dojo/has","../config/globals","dojo/string","dojo/keys","dojo/when","./MessageBox","dojo/dom-construct"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14){
"use strict";
var _15=null;
var _16=_2.getObject("lconn.share.util.configUtil");
return _1([_a,_9,_8],{MOCK_PATH_REGEX:/(\\|\/)/g,GET_NONCE_OPTIONS:{method:"GET",handleAs:"text"},POST_FORM_OPTIONS:{method:"POST",form:{},handleAs:"html"},_onSelected:function(_17){
this._disableButton(this.upload);
var _18=_3.get(this.formFile,"value"),_19=_18.split(this.MOCK_PATH_REGEX).pop();
this.validateFilename(_19,_2.hitch(this,"_enableButton",this.upload));
this.validateFileSize();
},_onSubmit:function(_1a){
this.emit("submit",_1a);
this.validateInput(_2.hitch(this,"_submit"));
},_submit:function(){
this._disableButton(this.upload);
this._disableButton(this.cancel);
var _1b=_b.getFilesNonceUrl();
_6(_1b,this.GET_NONCE_OPTIONS).then(_2.hitch(this,"_validateNonce"),_2.hitch(this,"_onError"));
},_validateNonce:function(_1c){
if(!_1c||typeof _1c!=="string"){
var _1d=new Error("Nonce value received was unexpected: "+_1c);
this._onError(_1d);
}else{
this._onNonce(_1c);
}
},_onNonce:function(_1e){
_3.set(this.nonce,"value",_1e);
var _1f=this.getUploadUrl({nonce:_1e});
var _20=this.POST_FORM_OPTIONS;
_20.form=this.form;
if(_e("fileviewer-multiphase-upload")){
_12(_f.policy).then(_2.hitch(this,"_uploadFile",_1e,_1f,_20));
}else{
_7(_1f,_20).then(_2.hitch(this,"_validateUploaded"),_2.hitch(this,"_onError"));
}
},_uploadFile:function(_21,_22,_23,_24){
var _25={policy:_24};
var _26=_16.getSimpleUploadMaxFileSize(_25);
var _27=new lconn.core.upload.provider.HtmlFileProvider();
var _28=this.form.elements.file.files[0];
var _29=new lconn.core.upload.data.File(_28,_28.name);
_29.setSize(_28.size);
this.progressHandle=dojo.connect(_29,"setBytesComplete",this,function(_2a){
this.emit("_progressUpdate",_2a);
});
var _2b={noStatus:true,url:_22,form:_23.form,handleAs:_23.handleAs,contentTypeHack:true,_xhrHandleAs:"json-embedded",simpleUploadMaxFileSize:_26,nonce:_21,headers:{},failOk:true};
_f.isUploading=true;
_15=_27.uploadFile(null,_29,_2b);
_15.then(_2.hitch(this,"_validateUploaded"),_2.hitch(this,"_onError"));
_c.subscribe("ic-fileviewer/stopUpload",_2.hitch(this,function(_2c){
this.cancelUpload();
}));
},_validateUploaded:function(_2d){
if(this.progressHandle){
dojo.disconnect(this.progressHandle);
}
var _2d=_2d.doc||_2d;
if(!_2d||typeof _2d!=="object"){
var _2e=new Error("Upload response received was unexpected: "+_2d);
this._onError(_2e);
return;
}
try{
var _2f=_5.fromJson(_2d.body.innerHTML);
if(_2f.errorCode){
var _2e=new Error("Upload response received was unexpected: "+responceObj.errorCode+" "+_2f.errorMessage);
this._onError(_2e);
return;
}
var _30=_2d.getElementsByTagName("meta")[0];
if(_30){
var _31=_30.getAttribute("content");
var _2e=new Error("Upload response received error code: "+_31);
this._onError(_2e);
return;
}
}
catch(_2e){
var _2e=new Error("Exception thrown parsing upload response: "+_2e.message);
this._onError(_2e);
return;
}
this._onUploaded(_2d);
},_onUploaded:function(_32){
this.form.reset();
this._checkModerationStatus(_32);
this.emit("uploaded",{message:this.nls.SUCCESS,source:_32});
_f.isUploading=false;
_c.publish("ic-fileviewer/editStop",this);
},_checkModerationStatus:function(_33){
var _34=_d.isResponseModerated(_33);
if(_34){
_d.launchModerationDialog();
}
},_onError:function(_35,_36){
if(this.progressHandle){
dojo.disconnect(this.progressHandle);
}
if(_35.dojoType=="cancel"){
return;
}
_f.isUploading=false;
var _36=_36||this.nls.ERROR;
this.emit("error",{message:_36,source:_35});
this._enableButton(this.cancel);
},_onReset:function(){
this._disableButton(this.upload);
},_onCancel:function(_37){
this.form.reset();
this.emit("cancel",_37);
_c.publish("ic-fileviewer/editStop",this);
if(this._warningBox){
this._warningBox.removeMessage();
}
},show:function(){
_4.remove(this.domNode,"lotusHidden");
_c.publish("ic-fileviewer/editStart",this,_2.hitch(this,this.hasChanges));
},hasChanges:function(){
return !!this.formFile.value;
},hide:function(){
_4.add(this.domNode,"lotusHidden");
},cancelUpload:function(_38){
if(_15){
_f.isUploading=false;
_15.cancel();
if(_38&&(_38.type=="click"||_38.keyCode==_11.ENTER)){
this._resetPanelUI("cancelUpload");
}
}
},_enableButton:function(_39){
_3.remove(_39,"disabled");
_3.set(_39,"tabindex","");
_3.set(_39,"aria-disabled","false");
},_disableButton:function(_3a){
_3.set(_3a,"disabled","disabled");
_3.set(_3a,"tabindex","-1");
_3.set(_3a,"aria-disabled","true");
},validateInput:function(_3b){
_3b();
},validateFileSize:function(){
var _3c=this.formFile.files[0];
var _3d=null;
_12(_f.policy).then(_2.hitch(this,function(_3e){
var _3f={policy:_3e};
_3d=_16.getMaxFileSize(_3f);
}));
if(this._warningBox){
this._warningBox.removeMessage();
}
if(_3d&&(_3c.size>_3d)){
var _40=this.nls.TOO_LARGE||"${file} is larger than the ${size} file size allowed.";
var _41=_f.formatFileSize(parseInt(_3d));
var _42=_10.substitute(_40,{file:_3c.name,size:_41});
this._showSizeWarning(_42);
this._disableButton(this.upload);
}
},_showSizeWarning:function(_43){
var _44={type:"warning"};
this._warningBox=_13.create(_44);
this._warningBox._hide();
this._warningBox.placeAt(this.form);
var _45=document.createDocumentFragment();
_45.appendChild(document.createTextNode(_43));
this._warningBox.setMessage(_45);
},onuploaded:function(){
return;
}});
});


;define("dojo/text!ic-share/fileviewer/widget/templates/ThumbnailWidget.html", '<!-- Copyright IBM Corp. 2015, 2016  All Rights Reserved.              -->\n<div class="ics-thumbnailwidget-container">\n   <form method="post" enctype="multipart/form-data" data-dojo-attach-point="form" data-dojo-attach-event="reset:_onReset">\n      <label data-dojo-attach-point="uploadNodeLabel" class="lotusOffScreen"></label>\n      <input type="file" name="file" data-dojo-attach-point="formFile" data-dojo-attach-event="onchange:_onSelected" aria-required="true"><br>\n      <input type="hidden" name="nonce" data-dojo-attach-point="nonce">\n      <input type="hidden" name="renditionKind" data-dojo-attach-point="renditionKind">\n   </form>\n   <ul class="ics-viewer-inlineList">\n      <li class="ics-viewer-first">\n         <a href="javascript:;" data-dojo-attach-point="upload" data-dojo-attach-event="onclick:_onSubmit" role="button" tabindex="-1" aria-disabled="true">${nls.UPLOAD}</a>\n      </li>\n      <li>\n         <a href="javascript:;" data-dojo-attach-point="cancel" data-dojo-attach-event="onclick:_onCancel" role="button">${nls.CANCEL}</a>\n      </li>\n   </ul>\n</div>');

;define("ic-share/fileviewer/widget/util/ThumbnailWidgetUtil",["dojo/_base/lang","dojo/_base/array"],function(_1,_2){
"use strict";
var _3={CONNECTIONS_VALID_VIDEO_EXTS_OBJECT_PATH:"lconn.share.previewConfig.validVideoExts",CONNECTIONS_VALID_PHOTO_EXTS_OBJECT_PATH:"lconn.share.previewConfig.validPhotoExts",DEFAULT_SUPPORTED_VIDEO_EXTS:"mp4,mov,flv",DEFAULT_SUPPORTED_PHOTO_EXTS:"jpg,jpeg,gif,png",EXTS_SEPARATOR:",",EXT_DELIMITER:".",UPLOAD_URL_TEMPLATE:"{fileFeed}?nonce={nonce}",DEFAULT_RENDITION_KIND:"renditionTemplate"};
var _4={validVideoExts:function(){
var _5=_1.getObject(_3.CONNECTIONS_VALID_VIDEO_EXTS_OBJECT_PATH);
if(_5===undefined){
_5=_3.DEFAULT_SUPPORTED_VIDEO_EXTS;
}
return _5;
},validPhotoExts:function(){
var _6=_1.getObject(_3.CONNECTIONS_VALID_PHOTO_EXTS_OBJECT_PATH);
if(_6===undefined){
_6=_3.DEFAULT_SUPPORTED_PHOTO_EXTS;
}
return _6;
}};
var _7={constants:_3,get:_4,isValid:function(_8){
var _9=_4.validVideoExts().toUpperCase();
var _a=_9.split(_3.EXTS_SEPARATOR);
var _b=_8.get("type").toUpperCase();
return (_2.indexOf(_a,_b)>-1);
},isValidThumbnailExt:function(_c){
if(!_c){
return false;
}else{
var _d=_c.split(_3.EXT_DELIMITER).pop().toUpperCase();
var _e=_4.validPhotoExts().toUpperCase();
var _f=_e.split(_3.EXTS_SEPARATOR);
return (_2.indexOf(_f,_d)>-1);
}
}};
return _7;
});


;define("ic-share/fileviewer/widget/ThumbnailWidget",["dojo/_base/declare","./UploadWidget","dojo/_base/lang","dojo/text!./templates/ThumbnailWidget.html","dojo/dom-attr","dojo/string","dojo/i18n!../nls/FileViewerStrings","../data/util/routes","./util/ThumbnailWidgetUtil","dijit/registry","dojo/sniff"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
"use strict";
var _c=_1([_2],{templateString:_4,postMixInProperties:function(){
this.nls=_7.THUMBNAIL;
var _d=_9.get.validPhotoExts();
var _e=_9.constants.EXTS_SEPARATOR;
var _f=_d.split(_e).join(_e+" ");
this.formattedExtsError=_6.substitute(this.nls.EXT_ERROR,[_f]);
},postCreate:function(){
this._disableButton(this.upload);
_5.set(this.renditionKind,"value",_9.constants.DEFAULT_RENDITION_KIND);
this.formFile.id=_a.getUniqueId("fileviewer")+"_changeThumbnailInputBox";
_5.set(this.uploadNodeLabel,"for",this.formFile.id);
_5.set(this.uploadNodeLabel,"innerHTML",this.nls.CHANGE_LINK);
if(_b("ff")||_b("chrome")||_b("ie")||_b("trident")){
_5.set(this.formFile,"accept",".gif, .jpg, .jpeg, .png");
}else{
if(_b("safari")){
_5.set(this.formFile,"accept","image/*");
}
}
},validateFilename:function(_10,_11){
if(_9.isValidThumbnailExt(_10)){
_11();
}else{
this._extensionError(new Error("The selected filename does not have a supported extension: "+_10));
}
},getUploadUrl:function(_12){
return _3.replace(_9.constants.UPLOAD_URL_TEMPLATE,{fileFeed:_8.getFileFeedUrl(this.file),nonce:encodeURIComponent(_12.nonce)});
},_extensionError:function(_13){
this.emit("error",{message:this.formattedExtsError,source:_13});
}});
_c.isValid=_9.isValid;
return _c;
});


;define("dojo/text!ic-share/fileviewer/widget/templates/FileState.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<span class="fileState" data-sbw-bind="isLocked:child!_getStateNode, isDocsFile:child!_getStateNode"></span>\n');

;define("ic-share/fileviewer/widget/FileState",["dojo/_base/declare","dojo/text!./templates/FileState.html","../sbw/StatefulBackedTemplatedWidget","dojo/i18n!../nls/FileViewerStrings","../config/globals","../util/DateFormat","dojo/dom-construct","../util/html","dojo/_base/lang","../util/ibmDocs"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
return _1([_3],{templateString:_2,postMixInProperties:function(){
this.nls=_4.FILE_STATE;
this.model=this.file;
},_getStateNode:function(){
var _b=_7.create("span");
_b.appendChild(this._getLockMessageNode());
if(!_a.isUploadNewVersionEnabled()){
_8.appendText(_b," "+this._getDocsFileMessage());
}
return _b;
},_getLockMessageNode:function(){
var _c,_d,_e,_f;
_f=_7.create("span");
if(!this.file.get("isLocked")){
return _f;
}
_c=this.file.get("lock");
_e=_c.user.id===_5.currentUser.id?this.nls.LOCKED_BY_YOU:this.nls.LOCKED_BY_OTHER;
_d=new _6(_c.date);
_8.substitute(document,_f,_d.formatByAge(_e),{user:function(){
return _8.generateLinkToUser(_c.user);
}});
return _f;
},_getDocsFileMessage:function(){
return this.file.get("isDocsFile")&&this.file.get("permissions").canEdit()?this.nls.DOCS_FILE:"";
}});
});


;define("ic-share/fileviewer/panels/AboutPanel",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/AboutPanel.html","dojo/when","dojo/_base/array","dojo/date","dojo/Deferred","dojo/dom-class","dojo/dom-construct","dojo/_base/lang","dojo/on","../preview/util","../util/DateFormat","dojo/i18n!../nls/FileViewerStrings","./Stream","../widget/TagWidget","dojo/string","dojo/dom-style","../widget/ExpandableText","./DropdownStream","./NameWidget","../action/EditDescriptionAction","../action/EditTagsAction","../widget/FileNameVersion","dojo/promise/all","../widget/ThumbnailWidget","dojo/topic","../widget/FileState","../config/globals","dojo/dom-attr"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,on,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,all,_19,_1a,_1b,_1c,_1d){
return _1([_2,_3],{templateString:_4,_tagWidget:_10,postMixInProperties:function(){
this.nls=_e.PANEL.ABOUT;
this.nls.DOWNLOADS_COUNT="${downloads}";
if(!this.nls.DOWNLOADS_COUNT_FULL){
this.nls.DOWNLOADS_COUNT_FULL="${downloads} - ${anonymousDownloads} anonymously";
}
this._watches=[];
},postCreate:function(){
all(this._getPromises()).then(_b.hitch(this,this.render));
},_getPromises:function(){
var _1e={fullEntry:this.file.get("fullEntry")};
if(this.file.get("isDocsFile")){
_1e.docsDraftInfo=this.file.getDocsDraftInfo();
}
return _1e;
},startup:function(){
this.inherited(arguments);
if(this._descriptionWidget){
this._descriptionWidget.startup();
}
},destroy:function(){
_6.forEach(this._watches,function(_1f){
_1f.unwatch();
},this);
this.inherited(arguments);
},render:function(_20){
this.set("fileName",this.fileName);
_9.remove(this.domNode,"loading");
var _21,_22,_23;
_21={baseClasses:"metadata metadata2"};
_22=new this.entryConstructor({entry:_21,actions:this.factory.actions});
var _24=new _1b({file:this.file});
_24.placeAt(_22.contentNode);
_22.placeAt(this.versionContainer);
this._watches.push(this.file.attachWatch("version",_b.hitch(this,function(_25){
_25.set("h1",_11.substitute(this.nls.CURRENT_VERSION_HEADER,{versionNumber:this.file.get("version")}));
},_22)));
this._renderDates(_20);
this._watches.push(this.file.watch("dateModified",_b.hitch(this,function(_26,_27,_28){
if(_7.compare(_27,_28)!==0){
all(this._getPromises()).then(_b.hitch(this,this._renderDates));
}
})));
_21={baseClasses:"metadata description",h1:this.nls.DESCRIPTION_HEADER,content:this.file.get("summary")};
_22=this._descriptionWidget=new this.entryConstructor({entry:_21,actions:this.factory.actions,headerAction:_16,file:this.file,visibleContentLines:3});
_1d.set(_22.header1Action,"alt",_e.ACTION.EDIT_DESCRIPTION.TOOLTIP);
_1d.set(_22.header1Action,"title",_e.ACTION.EDIT_DESCRIPTION.TOOLTIP);
this._addHeaderActionLink(_22,this.nls.ADD_DESCRIPTION,this.nls.NO_DESCRIPTION);
_22.placeAt(this.descriptionContainer);
_21={baseClasses:"metadata metadata2",h1:this.nls.LIKES_HEADER,h2:this.file.get("recommendations")+"",isRecommendations:true};
_22=new _14({entry:_21,file:this.file,dataKey:"recommendationFeed",entryConstructor:_15});
_22.placeAt(this.likesContainer);
var _29=this.file.get("currentUserDownloadInfo");
var _2a="",_2b;
if(this.nls.DOWNLOADS_HEADER_MORE&&this.file.hasDownloadInfo()&&_1c.isAuthenticated){
if(this.file.hasDownloaded()&&this.file.hasDownloadedLatest()||this.file.get("modifier").id===_1c.currentUser.id){
_2a=_11.substitute(this.nls.DOWNLOADS_HEADER_MORE,{0:this.nls.DOWNLOADS_LATEST_VERSION});
}else{
if(this.file.hasDownloaded()){
_2b=_11.substitute(this.nls.DOWNLOADS_LAST_VERSION,{0:_29.versionNumber});
_2a=_11.substitute(this.nls.DOWNLOADS_HEADER_MORE,{0:_2b});
}
}
}
if(!_2a){
_2a=this.nls.DOWNLOADS_HEADER;
}
_21={baseClasses:"metadata metadata2",h1:_2a,h2:(this.file.downloadsAnonymous==0)?_11.substitute(this.nls.DOWNLOADS_COUNT,{downloads:this.file.downloads}):_11.substitute(this.nls.DOWNLOADS_COUNT_FULL,{downloads:this.file.downloads,anonymousDownloads:this.file.downloadsAnonymous}),isDownloads:true,entryArgs:{showDownloadInfo:true}};
_22=new _14({entry:_21,file:this.file,dataKey:"downloadInfoFeed",entryConstructor:_15});
_22.placeAt(this.downloadsContainer);
_21={baseClasses:"metadata tags",h1:this.nls.TAGS_HEADER};
var _2c=new this.entryConstructor({entry:_21,actions:this.factory.actions,headerAction:_17,file:this.file});
_2c.placeAt(this.tagsContainer);
_2c.startup();
_1d.set(_2c.header1Action,"alt",_e.TAG_WIDGET.EDIT_TAGS);
_1d.set(_2c.header1Action,"title",_e.TAG_WIDGET.EDIT_TAGS);
_2c.set("content",new this._tagWidget({file:this.file,entryWidget:_2c}));
this._addHeaderActionLink(_2c,this.nls.ADD_TAGS,this.nls.NO_TAGS);
this._renderFileSize();
this._watches.push(this.file.watch("size",_b.hitch(this,"_renderFileSize",true)));
this._watches.push(this.file.watch("totalSize",_b.hitch(this,"_renderFileSize",true)));
this._watches.push(this.file.watch("versionCount",_b.hitch(this,"_renderFileSize",true)));
if(this.file.get("isEncrypted")){
_21={baseClasses:"metadata security",h1:this.nls.SECURITY,h2:this.nls.FILE_ENCRYPTED};
_22=new this.entryConstructor({entry:_21,actions:this.factory.actions});
_22.placeAt(this.securityContainer);
}
_21={baseClasses:"metadata metadata2",h1:this.nls.LINKS_HEADER,h2:this.nls.GET_LINKS,links:this.file.links,file:this.file};
_22=new this.entryConstructor({entry:_21,actions:this.factory.actions});
_22.placeAt(this.linksContainer);
if(_19.isValid(this.file)&&this.file.get("permissions").canEdit()){
this._renderChangeThumbnailLink();
}
},_renderFileSize:function(_2d){
if(_2d){
_a.empty(this.filesizeContainer);
this.filesizeWidget.destroy();
this.filesizeWidget=undefined;
}
var _2e,_2f;
if(this.file.versionCount>1){
_2f={baseClasses:"metadata",h1:this.nls.FILE_SIZE_HEADER,h2:_11.substitute(this.nls.CURRENT_VERSION_FILE_SIZE,{fileSize:_1c.formatFileSize(parseInt(this.file.size))}),h3:_11.substitute(this.nls.ALL_VERSIONS_FILE_SIZE,{fileSize:_1c.formatFileSize(parseInt(this.file.totalSize))})};
}else{
_2f={baseClasses:"metadata metadata2",h1:this.nls.FILE_SIZE_HEADER,h2:_c.formatFileSize(parseInt(this.file.totalSize))};
}
_2e=this.filesizeWidget=new this.entryConstructor({entry:_2f,actions:this.factory.actions});
_2e.placeAt(this.filesizeContainer);
},_renderChangeThumbnailLink:function(){
this.thumbnailDiv=_a.create("div");
this.thumbnailWidget=new _19({file:this.file});
this.changeThumbnailLink=_a.create("a",{href:"javascript:;",role:"button",innerHTML:_e.THUMBNAIL.CHANGE_LINK});
_a.place(this.changeThumbnailLink,this.thumbnailDiv);
this.thumbnailWidget.placeAt(this.thumbnailDiv);
this.thumbnailWidget.hide();
on(this.changeThumbnailLink,"click",_b.hitch(this,"_showThumbnailWidget"));
this.thumbnailWidget.on("cancel",_b.hitch(this,"_hideThumbnailWidget"));
this.thumbnailWidget.on("uploaded",_b.hitch(this,"_thumbnailUploaded"));
this.thumbnailWidget.on("error",_b.hitch(this,"_thumbnailError"));
var _30={baseClasses:"metadata metadata2",h1:_e.THUMBNAIL.TITLE};
var _31=new this.entryConstructor({entry:_30,actions:this.factory.actions});
_a.place(this.thumbnailDiv,_31.h2Node);
_31.placeAt(this.thumbnailContainer);
},_showThumbnailWidget:function(){
_9.add(this.changeThumbnailLink,"lotusHidden");
this.thumbnailWidget.show();
},_hideThumbnailWidget:function(){
_9.remove(this.changeThumbnailLink,"lotusHidden");
this.thumbnailWidget.hide();
},_thumbnailUploaded:function(evt){
_1a.publish("ic-fileviewer/dirty",{});
this._hideThumbnailWidget();
_1a.publish("ic-fileviewer/push/messages",{type:"success",message:evt.message,cancelable:true});
},_thumbnailError:function(err){
_1a.publish("ic-fileviewer/push/messages",{type:"error",message:err.message,cancelable:true});
},_renderDates:function(_32){
this._renderDocsDraftUpdatedDate(_32);
var _33,_34,_35,_36;
_36=this.file.get("dateModified").getTime()!==this.file.get("dateCreated").getTime();
_a.empty(this.updatedDateContainer);
if(_36){
_33=new _d(this.file.get("dateModified"));
_34={baseClasses:"metadata metadataIcon",h1:this.file.get("isDocsFile")?this.nls.DOCS_UPDATED_HEADER:this.nls.UPDATED_HEADER,h3:_33.formatByAge(_e.DATE.SHORT),iconSource:this.file.author.id};
_35=new this.entryConstructor({entry:_34,actions:this.factory.actions,usernameMaxWidth:237});
_35.setUserName(this.file.get("modifier"),_35.h2Node);
_35.setUserImage(this.file.get("modifier"));
_35.placeAt(this.updatedDateContainer);
}
_a.empty(this.createdDateContainer);
if(!this.file.get("isDocsFile")||!_36){
_33=new _d(this.file.get("dateCreated"));
_34={baseClasses:"metadata metadataIcon",h1:this.nls.CREATED_HEADER,h3:_33.formatByAge(_e.DATE.SHORT)};
_35=new this.entryConstructor({entry:_34,actions:this.factory.actions,usernameMaxWidth:237});
_35.setUserName(this.file.get("author"),_35.h2Node);
_35.setUserImage(this.file.get("author"));
_35.placeAt(this.createdDateContainer);
}
},_renderDocsDraftUpdatedDate:function(_37){
if(!_37.docsDraftInfo||!this.file.get("isDocsFile")||!this.file.get("permissions").canEdit()){
return;
}
var _38,_39,_3a,_3b,_3c,_3d,_3e;
_38=_37.docsDraftInfo;
_39=_38.get("dateModified");
_3a=_38.get("dateCreated");
isChanged=_7.compare(_39,_3a)!==0;
_a.empty(this.docsDraftUpdatedDateContainer);
if(_7.compare(_38.get("dateModified"),this.file.get("dateModified"))<=0){
return;
}
_3c=new _d(_38.get("dateModified"));
_3d={baseClasses:"metadata metadataIcon",h1:isChanged?this.nls.DOCS_DRAFT_UPDATED_HEADER:this.nls.DOCS_DRAFT_CREATED_HEADER,h3:_3c.formatByAge(_e.DATE.SHORT),iconSource:this.file.author.id};
_3e=new this.entryConstructor({entry:_3d,actions:this.factory.actions,usernameMaxWidth:237});
_3e.setUserName(_38.get("lastEditor"),_3e.h2Node);
_3e.setUserImage(_38.get("lastEditor"));
_3e.placeAt(this.docsDraftUpdatedDateContainer);
},_addHeaderActionLink:function(_3f,_40,_41){
_3f.on("headeractionplaced",_b.hitch(this,function(_42,e){
if(e.isValid){
var a=_a.create("a",{href:"javascript:;",role:"button",innerHTML:_40});
on(a,"click",e.execute);
_42.set("h2",a);
}else{
_42.set("h2",_41);
}
},_3f));
}});
});


;define("dojo/text!ic-share/fileviewer/dialog/templates/LinkDialog.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-dialog-action">\n	<table class="linkContainer" role="presentation" data-dojo-attach-point="linkContainer">\n		<tr>\n			<td>\n			  <label class="linkLabel" for="${fileLinkInputId}">${nls.LINK_FILE}</label>\n			</td>\n			<td>\n			  <input onFocus="this.select();" type="text" class="linkValue" value="${fileLink}" id="${fileLinkInputId}" readonly>\n			</td>\n		</tr>\n		<tr>\n			<td>\n			  <label class="linkLabel preview" for="${previewLinkInputId}">${nls.LINK_PREVIEW}</label>\n			</td>\n			<td>\n			  <input onFocus="this.select();" type="text"  class="linkValue preview" value="${filePreview}" id="${previewLinkInputId}" readonly>\n		   </td>\n		</tr>\n		<tr>\n			<td>\n			  <label class="linkLabel" for="${downloadLinkInputId}">${nls.LINK_DOWNLOAD}</label>\n			</td>\n			<td>\n			  <input onFocus="this.select();" type="text" class="linkValue" value="${fileDownload}" id="${downloadLinkInputId}" readonly>\n			</td>\n		</tr>\n	</table>\n	<a class="confirm bad" href="javascript:;" data-dojo-attach-event="onclick:clickLink" id="ok" role="button">${nls.OK}</a>\n</div>\n');

;define("ic-share/fileviewer/dialog/LinkDialog",["dojo/_base/declare","dojo/text!./templates/LinkDialog.html","dijit/Dialog","dojo/_base/lang","./DialogAction","dojo/Evented","../widget/MessageBox","dojo/dom-class","dojo/i18n!../nls/FileViewerStrings","dijit/registry","dojo/dom-construct"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
return _1([_3,_6],{"class":"linkDialog",postMixInProperties:function(_c){
this.inherited(arguments);
var _d=new _5({template:_2,nls:_9.ACTION.GET_LINKS,fileLink:this.file.get("alternateUrl"),filePreview:(""+this.file.get("thumbnailUrl")).replace("renditionKind=mediumview","renditionKind=largeview").replace("/basic/","/form/"),fileDownload:(""+this.file.get("downloadUrl")).replace("/basic/","/form/"),fileLinkInputId:_a.getUniqueId("fileviewer")+"_link_dialog_file",previewLinkInputId:_a.getUniqueId("fileviewer")+"_link_dialog_preview",downloadLinkInputId:_a.getUniqueId("fileviewer")+"_link_dialog_download"});
this.title=_9.ACTION.GET_LINKS.DIALOG_TITLE;
_d.clickLink=_4.hitch(this,function(e){
if(e.target.id==="ok"){
this.onCancel();
}
});
_d.startup();
this.content=_d;
},showError:function(_e){
this._errorBox.setMessage(_e);
},postCreate:function(){
this.inherited(arguments);
if(!this.file.get("thumbnailUrl")){
_8.add(this.domNode,"hidePreview");
}
},onCancel:function(){
this.emit("close");
this.inherited(arguments);
_b.destroy(this.containerNode.parentNode);
}});
});


;define("ic-share/fileviewer/panels/AboutWidget",["dojo/_base/declare","dojo/_base/lang","./EntryWidget","dojo/dom-construct","dojo/on","../dialog/LinkDialog"],function(_1,_2,_3,_4,on,_5){
return _1([_3],{postMixInProperties:function(){
this.baseClasses="about "+this.entry.baseClasses;
this.DialogFactory=_5;
this.h1=this.entry.h1||"";
if(!this.entry.links){
this.h2=this.entry.h2||"";
}else{
this.h2="";
}
this.h3=this.entry.h3||"";
this.content=this.entry.content||"";
this.footer=this.entry.footer||"";
},postCreate:function(){
this.inherited(arguments);
if(this.entry.links){
this._setDialogLink(this.entry.h2,this.h2Node);
}
},_setDialogLink:function(_6,_7){
var _8=_4.create("a",{innerHTML:_6,href:"javascript:;",role:"button"},_7);
on(_8,"click",_2.hitch(this,this._dialogHandler));
},createDialog:function(_9){
this.dialog=new this.DialogFactory(_9);
this.dialog.placeAt(document.body);
this.dialog.startup();
this.dialog.show();
},_dialogHandler:function(){
this.createDialog({file:this.entry.file});
}});
});


;define("dojo/text!ic-share/fileviewer/panels/templates/Panel.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-panel-entry-container" role="tabpanel">\n  <div class="panelTitle">\n    <div class="panelTitleText" data-dojo-attach-point="titleNode"></div>\n  </div>  \n  <div class="panelContent" data-dojo-attach-point="content">\n    <span data-dojo-attach-point="fileError" class="lotusHidden">${LOAD_ERROR}</span>\n  </div>\n  <div class="${feedDivClasses}" data-dojo-attach-point="feedDivNode">\n      <a data-dojo-attach-point="feedLinkNode" target="_blank" href="${feedLink}" title="${feedLinkTitle}">\n        <img class="panelFeedIcon" src="${blank}" alt=""/>\n        <span data-dojo-attach-point="feedLinkSpan">${feedText}</span>\n      </a>\n  </div>\n</div>');

;define("ic-share/fileviewer/panels/Panel",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/Panel.html","dojo/_base/lang","dojo/i18n!../nls/FileViewerStrings","dojo/dom-class"],function(_1,_2,_3,_4,_5,_6,_7){
return _1([_2,_3],{templateString:_4,_setTitleAttr:{node:"titleNode",type:"innerHTML"},_setFeedLinkAttr:{node:"feedLinkNode",type:"attribute",attribute:"href"},_setFeedTextAttr:{node:"feedLinkSpan",type:"innerHTML"},_setFeedLinkTitleAttr:{node:"feedLinkNode",type:"attribute",attribute:"title"},_setFeedDivClassesAttr:{node:"feedDivNode",type:"attribute",attribute:"class"},constructor:function(){
this.nls=_6.PANEL;
this.LOAD_ERROR=this.nls.LOAD_ERROR||"There was an error accessing the metadata of this file.";
this.feedLink="";
this.feedLinkTitle="";
this.feedText="";
this.blank=this._blankGif;
this.feedDivClasses="panelContent panelFeed lotusHidden";
},postMixInProperties:function(){
this.title=this.factory.get("title");
this.handle=this.factory.watch("title",_5.hitch(this,function(){
this.set("title",this.factory.get("title"));
}));
},render:function(){
if(this._isRendered){
return;
}
this._isRendered=true;
if(this.factory.file.get("loadError")){
_7.remove(this.fileError,"lotusHidden");
}else{
this.factory.renderContent(this);
}
},destroy:function(){
this.handle.remove();
this.inherited(arguments);
}});
});


;define("ic-share/fileviewer/panels/AboutPanelFactory",["dojo/_base/declare","./AboutPanel","dojo/Stateful","./AboutWidget","dojo/_base/lang","dojo/when","dojo/i18n!../nls/FileViewerStrings","./Panel"],function(_1,_2,_3,_4,_5,_6,_7,_8){
"use strict";
return _1([_3],{id:"about",urlParameterId:"about",constructor:function(){
this.title=_7.PANEL.ABOUT.TITLE;
},_panelGetter:function(){
return new _8({factory:this});
},renderContent:function(_9){
var _a=new _2({file:this.file,entryConstructor:_4,factory:this});
_a.placeAt(_9.content);
}});
});


;define("dojo/text!ic-share/fileviewer/dialog/templates/CommentDialog.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-dialog-action">\n	<div class="errorContainer" data-dojo-attach-point="errorContainer"></div>\n   <div class="prompt-container" data-dojo-attach-point="promptContainer">${nls.PROMPT}</div>\n	<div class="button-container">\n		<a class="confirm bad" href="javascript:;"\n			data-dojo-attach-event="onclick:clickLink" id="ok" role="button">${nls.OK}</a> \n			<a class="cancel neutral" href="javascript:;"\n			data-dojo-attach-event="onclick:clickLink" id="cancel" role="button">${nls.CANCEL}</a>\n	</div>\n</div>\n');

;define("ic-share/fileviewer/dialog/CommentDialog",["dojo/_base/declare","dojo/text!./templates/CommentDialog.html","dijit/Dialog","dojo/_base/lang","./DialogAction","dojo/Evented","../widget/MessageBox","dojo/i18n!../nls/FileViewerStrings","dojo/dom-attr","dijit/registry","dojo/dom-construct"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
return _1([_3,_6],{"class":"commentDialog",constructor:function(_c){
var _d=new _5({template:_2,nls:_8.ACTION.DELETE_COMMENT});
this.title=_8.ACTION.DELETE_COMMENT.DIALOG_TITLE;
_d.clickLink=_4.hitch(this,function(e){
if(e.target.id==="ok"){
this.emit("clicked",{});
_b.destroy(this.containerNode.parentNode);
}else{
if(e.target.id==="cancel"){
this.onCancel();
}
}
});
_d.startup();
this.content=_d;
},showError:function(_e){
this._errorBox.setMessage(_e);
},postCreate:function(){
this.inherited(arguments);
var _f=_a.getUniqueId("fileviewer")+"_commentDeleteDialog";
_9.set(this.domNode,"aria-label",this._get("title"));
_9.set(this.domNode,"aria-describedBy",_f);
_9.set(this.content.promptContainer,"id",_f);
var _10={type:"error"};
this._errorBox=_7.create(_10);
this._errorBox._hide();
this._errorBox.placeAt(this.content.errorContainer);
},onCancel:function(){
this.emit("close");
this.inherited(arguments);
_b.destroy(this.containerNode.parentNode);
}});
});


;define("ic-share/fileviewer/panels/CommentWidget",["dojo/_base/declare","./EntryWidget","../dialog/CommentDialog","dojox/html/entities","dojo/_base/lang","../config/globals","dojo/i18n!../nls/FileViewerStrings","dojo/string","dojo/dom-class","../util/html","dojo/dom-construct","../action/FlagAction","../uiState","dojo/topic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){
return _1([_2],{visibleContentLines:16,htmlContentText:true,postMixInProperties:function(){
this.nls=_7.COMMENT_WIDGET;
this.baseClasses="comment";
this.reloadItem=true;
this.DialogFactory=_3;
this.h1="";
this.h2="";
this.h3="";
this.content="";
this.footer=_8.substitute(_7.PANEL.COMMENTS.VERSION,[this.entry.get("version")]);
this.editTooltip=_7.ACTION.EDIT_COMMENT.TOOLTIP;
this.removeTooltip=_7.ACTION.DELETE_COMMENT.TOOLTIP;
if(_7.ACTION.FLAG){
this.flagTooltip=_7.ACTION.FLAG.COMMENT.NAME;
}else{
this.flagTooltip="Flag as Inappropriate";
}
this.usernameMaxWidth=226;
},postCreate:function(){
this.inherited(arguments);
this.setUserName(this.entry.get("author"),this.h1Node);
this.setUserImage(this.entry.get("author"));
this._displayCommentDate();
this.entry.watch("dateModified",_5.hitch(this,function(){
this._displayCommentDate();
}));
this.entry.watch("content",_5.hitch(this,function(_f,_10,_11){
this.set("content",_11);
}));
this.commentSizeWatch=_d.watch("panelSize",_5.hitch(this,function(_12,_13,_14){
if(_14!=_13){
this._contentText._addExpandLink();
}
}));
this.selectPanelHandle=_e.subscribe("ic-fileviewer/selectpanel",_5.hitch(this,function(_15){
if(_15&&_15[0]=="comments"){
this._contentText._addExpandLink();
}
}));
},startup:function(){
this.inherited(arguments);
this.set("content",this.entry.get("content"));
},_displayCommentDate:function(){
var _16=this.entry.get("dateCreated"),_17=this.entry.get("dateModified");
_a.setText(this.h2Node,this.formatDate(_16));
if(_16.getTime()!==_17.getTime()){
var _18=_b.create("span",{},this.h2Node);
_a.setText(_18," "+this.nls.EDITED);
_18.title=this.formatDate(_17,this.nls.EDITED_DATE);
}
},_setContentText:function(_19){
_9.remove(this.domNode,"editing");
var _1a=this.getInherited(arguments);
_19=lconn.core.util.text.htmlify(_19);
_1a.apply(this,[_19]);
if(_5.isFunction(_6.attachBizCard)){
_6.attachBizCard(this.contentContainer);
}
},_setContentWidget:function(_1b){
_9.add(this.domNode,"editing");
this.inherited(arguments);
},flag:function(){
var _1c=_c.create({item:this.entry});
_1c.createDialog();
},destroy:function(){
this.commentSizeWatch.remove();
this.selectPanelHandle.remove();
}});
});


;define("dojo/text!ic-share/fileviewer/widget/templates/CommentBox.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-commentbox-container">\n  <div data-dojo-attach-point="textAreaContainer">\n    <textarea data-dojo-attach-point="textarea"></textarea>\n    <div data-dojo-attach-point="textdiv"></div>\n  </div>\n  <div class="commentActions" data-dojo-attach-point="commentActionsContainer">\n  \n    <ul class="ics-viewer-inlineList">\n      <li class="ics-viewer-first">\n        <a href="javascript:;" data-dojo-attach-event="click:_save" role="button" class="save-button">${_saveText}</a></li>\n      <li>\n        <a href="javascript:;" data-dojo-attach-point="cancelButton" data-dojo-attach-event="click:_cancel" role="button" class="cancel-button">${nls.CANCEL}</a>\n      </li></ul>\n      \n    <img src="${_blankGif}" class="externalIcon" style="display: none;" data-dojo-attach-point="externalIcon" title="${nls.EXTERNAL_WARNING}" alt="${nls.EXTERNAL_WARNING}"></img>\n  </div>\n  <div data-dojo-attach-point="errorContainer"></div>\n  <div data-dojo-attach-point="warningContainer"></div>\n</div>\n');

;define("ic-share/fileviewer/util/FileAccessChecker",["dojo/_base/declare","dojo/_base/lang","../network/request","dojo/when","../data/util/routes"],function(_1,_2,_3,_4,_5){
return _1([],{constructor:function(_6){
this.file=_6;
},checkAccess:function(_7){
return _4(this._checkAccess(_7));
},_checkAccess:function(_8){
return _4(this.file.get("entry")).then(_2.hitch(this,function(_9){
if(_9.get("visibility")==="public"){
return true;
}
return _3(_5.getAclValidationUrl(_9),{method:"HEAD",noStatus:true,headers:{"X-LCONN-USER":_8.id}}).then(_2.hitch(this,function(_a){
return true;
}),_2.hitch(this,function(_b){
return false;
}));
}));
}});
});


;define("ic-share/fileviewer/util/mentions",["dojo/_base/array"],function(_1){
var _2="<[sS][pP][aA][nN] class=\"?vcard\"?><[aA] class=\"?fn url\"? href=\".*?\">([^<>]+)"+"</[aA]><[sS][pP][aA][nN] (?:(?:class=\"?x-lconn-userid\"? style=\"?[dD][iI][sS][pP][lL][aA][yY]: none;?\"?)"+"|(?:style=\"?[dD][iI][sS][pP][lL][aA][yY]: none;?\"? class=\"?x-lconn-userid\"?))>([^<>]+)</[sS][pP][aA][nN]>"+"</[sS][pP][aA][nN]>",_3="<span class=\"vcard\"><span class=\"fn\">",_4="</span><span class=\"x-lconn-userid\">",_5="</span></span>";
return {formatMentionsForEdit:function(_6){
var _7;
var _8=_6;
var _9=0;
var _a=new RegExp(_2,"g");
while((_7=_a.exec(_6))!==null){
var _b=_7.index;
if(_b>=_9){
var o=_6.substring(_7.index,_7.index+_7[0].length);
var n=_3+_7[1]+_4+_7[2]+_5;
_8=_8.replace(o,n);
_9=_b+_7[0].length;
}
}
return _8;
},getUniqueMentions:function(_c){
var _d=[];
var _e={};
_1.forEach(_c,function(_f){
if(!(_f.value in _e)){
_e[_f.value]=true;
_d.push(_f);
}
},this);
return _d;
}};
});


;define("ic-share/fileviewer/widget/CommentBox",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/CommentBox.html","dojo/on","dojo/_base/lang","dojo/dom-style","dojo/dom-class","dojo/dom-geometry","dojox/html/entities","dijit/focus","../config/globals","../util/FileAccessChecker","../util/mentions","dojo/i18n!../nls/FileViewerStrings","dojo/dom-construct","dojo/_base/array","./MessageBox","dojo/keys","dojo/has","dojo/query","dojo/topic","dojo/sniff"],function(_1,_2,_3,_4,on,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,has,_13,_14){
return _1([_2,_3],{templateString:_4,showShadowText:false,cancelOnBlur:false,postMixInProperties:function(){
this.nls=_e.COMMENT_BOX;
this._saveText=this.isNew?this.nls.POST:this.nls.SAVE;
this._shadowText=this.showShadowText?this.nls.SHADOW_TEXT:" ";
this._accessChecker=new _c(this.file);
this._mentionsDataFormatter=new _b.MentionsDataFormatter();
this._invalidMentions=[];
},postCreate:function(){
var _15={maxLength:100000000,mentionsEnable:true,shadowText:this._shadowText,title:this.nls.TITLE,disableURLPreview:true,onFocusCallback:_5.hitch(this,this.activate),onBlurCallback:_5.hitch(this,this._handleBlur),width:"100%",customCSS:"ics-viewer-width-auto"};
if(has("ckeditor-lite-mentions")){
_15.keyDownCallback=_5.hitch(this,this._handleKey);
this.textBox=new _b.TextBoxWidget(_15,this.textdiv);
_7.add(this.textAreaContainer,"ckeditor");
}else{
this.textBox=new _b.TextBoxWidget(_15,this.textarea);
this.textAreaNode=this.textBox.textAreaNode;
}
this.textBox.addMentionsCallback("onCreateMention",dojo.hitch(this,this._onCreateMention));
this.textBox.addMentionsCallback("onRemoveMention",dojo.hitch(this,this._onRemoveMention));
if(!has("ckeditor-lite-mentions")){
var _16=_f.create("label",{"for":this.textAreaNode.id,"innerHTML":this._shadowText,"class":"lotusOffScreen"});
_f.place(_16,this.textAreaNode,"before");
this.textBox._mentionsHelper.disableURLPreview=true;
if(this.textBox._mentionsHelper._registeredTypes){
for(var i=0;i<this.textBox._mentionsHelper._registeredTypes.length;i++){
if(this.textBox._mentionsHelper._registeredTypes[i].declaredClass=="lconn.core.widget.mentions.PersonMentionsType"){
this.textBox._mentionsHelper._activeType=this.textBox._mentionsHelper._registeredTypes[i];
}
}
}
on(this.textAreaNode,"keydown",_5.hitch(this,function(evt){
evt.getKey=function(){
return evt.keyCode;
};
this._handleKey(evt);
}));
}
var _17={type:"warning"};
this._warningBox=_11.create(_17);
this._warningBox._hide();
this._warningBox.placeAt(this.warningContainer);
if(this.file.get("isExternal")){
_6.set(this.externalIcon,"display","");
}
this.file.watch("isExternal",_5.hitch(this,function(_18,_19,_1a){
if(_19!==_1a&&_1a===false){
_6.set(this.externalIcon,"display","none");
}
}));
},_handleBlur:function(){
var _1b=this.textBox.getText();
if(this.cancelOnBlur&&(_1b===""||_1b===this._shadowText)){
this._disableActionTabbing();
this._cancel();
}
},_handleKey:function(evt){
var _1c=evt.getKey();
if(_1c===_12.TAB){
this._handleBlur();
}else{
if(_1c===_12.ESCAPE){
_a.focus(this.cancelButton);
this._cancel();
evt.stopPropagation();
evt.preventDefault();
}
}
},_disableActionTabbing:function(){
_10.forEach(this._getActions(),function(_1d){
_1d.tabIndex="-1";
},this);
},_enableActionTabbing:function(){
_10.forEach(this._getActions(),function(_1e){
_1e.tabIndex="";
},this);
},_getActions:function(){
return _13("a",this.commentActionsContainer);
},focus:function(){
if(has("ckeditor-lite-mentions")){
setTimeout(_5.hitch(this,function(){
this.textBox.setFocus();
}),0);
}else{
_a.focus(this.textAreaNode);
}
},getValue:function(){
var _1f=this.textBox.getTrackedMentions();
for(var i=0;i<_1f.textData.length;i++){
var _20=_1f.textData[i].type;
if(_20==="text"||_20==="html"){
_1f.textData[i].value=_9.encode(_1f.textData[i].value);
}
}
var _21=this._mentionsDataFormatter.formatData(_1f);
return _9.encode(_21);
},getRawValue:function(){
var _22=this.textBox.getTrackedMentions();
var _23=this._mentionsDataFormatter.formatData(_22);
return _9.encode(_23);
},setValue:function(_24){
_24=_9.decode(_24);
_24=_d.formatMentionsForEdit(_24);
this.activate();
this.focus();
this._isSettingContent=true;
setTimeout(_5.hitch(this,function(){
this.textBox.setText(_24);
this._isSettingContent=false;
}),0);
},activate:function(){
if(_7.contains(this.domNode,"active")){
return;
}
_7.add(this.domNode,"active");
this._enableActionTabbing();
_14.publish("ic-fileviewer/editStart");
},reset:function(){
if(!_7.contains(this.domNode,"active")){
return;
}
_7.remove(this.domNode,"active");
this._invalidMentions=[];
this._updateWarning();
this.textBox.resetBox();
if(this.validationNode){
_f.destroy(this.validationNode);
}
_14.publish("ic-fileviewer/editStop");
},_onCreateMention:function(_25){
if(this._isSettingContent){
return;
}
this._accessChecker.checkAccess({id:_25.getUserId()}).then(_5.hitch(this,this._handleAccessCheckResult,_25));
},_handleAccessCheckResult:function(_26,_27){
if(!_27){
_26.removeSymbol();
this._invalidMentions.push(_26);
this._updateWarning();
}
},_updateWarning:function(){
this._warningBox.removeMessage();
if(this._invalidMentions.length===0){
return;
}
var _28=document.createDocumentFragment();
_28.appendChild(document.createTextNode(this.nls.CANNOT_ACCESS_CONTENT));
_f.create("br",{},_28);
var ul=_f.create("ul",{},_28);
_10.forEach(_d.getUniqueMentions(this._invalidMentions),function(_29){
var li=_f.create("li",{},ul);
li.appendChild(document.createTextNode(_29.value));
},this);
this._warningBox.setMessage(_28);
},_onRemoveMention:function(_2a){
var _2b=_10.indexOf(this._invalidMentions,_2a);
if(_2b!==-1){
this._invalidMentions.splice(_2b,1);
this._updateWarning();
}
},_save:function(){
this.emit("save",{commentBox:this});
},_cancel:function(){
this.reset();
this.emit("cancel",{commentBox:this});
},onsave:function(){
},oncancel:function(){
}});
});


;define("dojo/text!ic-share/fileviewer/panels/templates/CommentsPanel.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div>\n	<div class="newCommentBox" data-dojo-attach-point="addCommentContainer"></div>\n	<div data-dojo-attach-point="noCommentsContainer" class="noCommentsContainer hideNoCommentsContainer"><span>${nls.EMPTY}</span></div>\n	<div data-dojo-attach-point="streamContainer"></div>\n</div>\n');

;define("ic-share/fileviewer/panels/CommentsPanel",["dojo/_base/declare","./Stream","./CommentWidget","dojo/_base/lang","dojo/_base/array","dojo/dom-construct","dojo/dom-class","../widget/CommentBox","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/CommentsPanel.html","../util/validation","../config/globals","../widget/MessageBox","../util/network","dojo/i18n!../nls/FileViewerStrings","dojo/topic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11){
"use strict";
return _1([_9,_a],{templateString:_b,constructor:function(){
this.CommentBox=_8;
this.CommentWidget=_3;
},postMixInProperties:function(){
this.nls=_4.clone(_10.COMMENTS);
if(!this.nls.EMPTY){
this.nls.EMPTY="There are no comments.";
}
if(!this.nls.MODERATED){
this.nls.MODERATED="The comment has been submitted for review and will be available when approved.";
}
},postCreate:function(){
this._addCommentBox();
this._addCommentStream();
var _12=dojo.getObject("lconn.core.globalization.bidiUtil");
if(_12){
lconn.core.globalization.bidiUtil.enforceTextDirectionOnPage(this.domNode);
}
},_addCommentBox:function(){
if(!_d.isAuthenticated){
return;
}
var _13=this.commentBox=new this.CommentBox({file:this.file,showShadowText:true,cancelOnBlur:true,isNew:true});
_13.on("save",_4.hitch(this,this._createComment));
_13.placeAt(this.addCommentContainer);
_13.startup();
},_addCommentStream:function(){
var _14=this.commentStream=new _2({file:this.file,dataKey:"commentFeed",entryConstructor:_3,factory:this.factory,edit:_4.hitch(this,this._onEdit),deleteErrorStrings:this.nls.ERROR.DELETE,isActionValid:this._isActionValid});
_14.placeAt(this.streamContainer);
this.commentStream.on("loaded",_4.hitch(this,function(){
this._toggleNoCommentsContainer();
}));
},_toggleNoCommentsContainer:function(){
if(this.commentStream.size()==0){
_7.remove(this.noCommentsContainer,"hideNoCommentsContainer");
}else{
_7.add(this.noCommentsContainer,"hideNoCommentsContainer");
}
},_onEdit:function(_15){
var _16=new this.CommentBox({file:this.file});
var _17=_15.entry;
_15.set("content",_16);
_16.startup();
_16.setValue(_17.get("content"));
_16.on("save",_4.hitch(this,this._updateComment,_15));
_16.on("cancel",_4.hitch(this,function(e){
_15.set("content",_17.get("content"));
}));
},_createComment:function(e){
if(!_c.validateComment(e.commentBox)){
return;
}
var _18=this.file.get("commentFeed");
var _19=_18.newItem({content:e.commentBox.getValue()});
_19.create().then(_4.hitch(this,this._checkContentApproval,_19),_4.hitch(this,this._displayError,this.nls.ERROR.SAVE,e.commentBox));
},_updateComment:function(_1a,e){
if(!_c.validateComment(e.commentBox)){
return;
}
var _1b=_1a.entry;
_1b.set("content",e.commentBox.getValue());
_1b.update().then(_4.hitch(this,this._checkContentApproval,_1b),_4.hitch(this,this._displayError,this.nls.ERROR.SAVE,e.commentBox));
},_checkContentApproval:function(_1c){
if(_1c.get("status")==="pending"){
_11.publish("ic-fileviewer/push/messages",{type:"success",message:this.nls.MODERATED,cancelable:true});
}
this.commentStream.refresh();
this.commentBox.reset();
},_displayError:function(_1d,_1e,_1f){
var _20={type:"error"};
var _21=_e.create(_20);
_21.placeAt(_1e.errorContainer);
_21.setMessage(_f.getErrorMessage(_1f,_1d));
_1e.on("save, cancel",_4.hitch(this,function(){
_21.removeMessage();
}));
},_isActionValid:function(_22,_23){
var _24=_23.entry.get("permissions"),_25=_23.entry.get("reportUrl"),_26=_25&&(_25!=="");
if(_22==="edit"){
return _24.Edit;
}else{
if(_22==="delete"){
return _24.Delete;
}else{
if(_22==="flag"){
return _d.isAuthenticated&&_26;
}
}
}
return false;
}});
});


;define("ic-share/fileviewer/panels/CommentsPanelFactory",["dojo/_base/declare","dojo/Stateful","dojo/dom-class","./Panel","./CommentsPanel","../data/util/routes","../bean/FileAdapter","../config/globals","dojo/i18n!../nls/FileViewerStrings","dojo/_base/lang","dojo/string"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
return _1([_2],{id:"comments",urlParameterId:"comments",actions:["edit","delete","flag"],constructor:function(){
this.nls=_9.PANEL.COMMENTS;
this.title=this.nls.TITLE;
this.titleWithCount=this.nls.TITLE_WITH_COUNT;
},postscript:function(){
this.inherited(arguments);
this.get("file").get("fullEntry").then(_a.hitch(this,"_updateTitle"));
this.get("file").watch("commentCount",_a.hitch(this,"_updateTitle"));
},_panelGetter:function(){
return new _4({factory:this});
},renderContent:function(_c){
this.commentsPanel=new _5(_a.mixin({file:this.file,factory:this},this.testOverrides));
this.commentsPanel.placeAt(_c.content);
var _d=_7(this.file);
var _e=_6.getCommentListServiceUrl(this.file,{isPersonalFilesInCommunity:_d.isPersonalFilesInCommunity(this.file.get("location")),basicAuth:true,anonymous:_d.isPublic(),nonPersonal:true});
_c.set("feedLink",_e);
_c.set("feedLinkTitle",this.nls.FEED_TITLE);
_c.set("feedText",this.nls.FEED_LINK);
_c.set("feedDivClasses","panelContent panelFeed");
},_updateTitle:function(){
var _f=this.get("file").get("commentCount")||0;
var _10=this.nls.TITLE_WITH_COUNT;
if(_f==0){
_10=this.nls.TITLE;
}
this.set("title",_b.substitute(_10,[_f]));
}});
});


;define("dojo/text!ic-share/fileviewer/dialog/templates/SharingDialog.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-dialog-action">\n	<div class="prompt-container" data-dojo-attach-point="promptContainer">${nls.PROMPT}</div>\n   <div class="button-container">\n		<a class="confirm bad" href="javascript:;"\n			data-dojo-attach-event="onclick:clickLink" id="ok" role="button">${nls.OK}</a> \n			<a class="cancel neutral" href="javascript:;"\n			data-dojo-attach-event="onclick:clickLink" id="cancel" role="button">${nls.CANCEL}</a>\n	</div>\n</div>\n');

;define("ic-share/fileviewer/dialog/SharingDialog",["dojo/_base/declare","dojo/text!./templates/SharingDialog.html","dijit/Dialog","dojo/_base/lang","./DialogAction","dojo/Evented","dojo/i18n!../nls/FileViewerStrings","dojo/string","dojox/html/entities","dojo/dom-attr","dijit/registry","dojo/when","../config/globals","dojo/dom-construct"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){
return _1([_3,_6],{"class":"sharingDialog",constructor:function(_f){
var nls,_10;
nls=_4.clone(_7.ACTION.STOP_SHARING);
if(!_4.getObject("capabilities.canView.communities",false,_d.policy)){
nls=nls.EFSS||nls;
}
nls.PROMPT=_f.promptKey?nls[_f.promptKey]:"";
if(nls.PROMPT){
nls.PROMPT=_8.substitute(nls.PROMPT,{user:_9.encode(_f.name),communityName:_9.encode(_f.name),folderName:_9.encode(_f.name)});
}else{
nls.PROMPT="";
}
_10=new _5({template:_2,nls:nls});
this.title=nls.DIALOG_TITLE;
_10.clickLink=_4.hitch(this,function(e){
if(e.target.id==="ok"){
this.emit("clicked",{});
_e.destroy(this.containerNode.parentNode);
}
this.onCancel();
});
_10.startup();
this.content=_10;
},postCreate:function(){
this.inherited(arguments);
var _11=_b.getUniqueId("fileviewer")+"_sharingDialogContent";
_a.set(this.domNode,"aria-label",this._get("title"));
_a.set(this.domNode,"aria-describedBy",_11);
_a.set(this.content.promptContainer,"id",_11);
},onCancel:function(){
this.emit("close");
this.inherited(arguments);
_e.destroy(this.containerNode.parentNode);
}});
});


;define("dojo/text!ic-share/fileviewer/widget/templates/TypeAheadBox.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-typeaheadbox-container">\n  <div data-dojo-attach-point="textAreaContainer">\n    <table style="width: 100%;">\n      <th>\n        <label for="${id}_memberTypeSelector" data-dojo-attach-point="typeaheadSelectorLabel" class="lotusOffScreen">${nls.MEMBER_TYPE}</label>\n        <select id="${id}_memberTypeSelector" data-dojo-attach-point="typeaheadSelector">\n          <option value="user">${nls.USER}</option>\n          <option value="community">${nls.COMMUNITY}</option>\n          <option value="everyone">${shareNLS.PUBLIC.SHORT}</option>\n          </select>\n      </th>\n      <tr>\n        <td><div data-dojo-attach-point="typeAheadInput">\n            <textarea data-dojo-attach-point="textarea"></textarea>\n          </div>\n          <div class="actionContainer" data-dojo-attach-point="actionContainer">\n            <a href="javascript:;" data-dojo-attach-event="click:_addByEmail"\n              data-dojo-attach-point="manualAdd" role="button"\n              title="${nls.SHARE_ALT}">\n              <span>${nls.SHARE}</span>\n            </a>\n          </div></td>\n      </tr>\n    </table>\n  </div>\n  <div data-dojo-attach-point="errorContainer"></div>\n  <div data-dojo-attach-point="warningContainer"></div>\n</div>\n');

;define("dojo/text!ic-share/fileviewer/widget/templates/TypeAheadBoxMulti.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-typeaheadbox-container ics-typeaheadboxmulti-container">\n  <div data-dojo-attach-point="textAreaContainer">\n    <table style="width: 100%;" role="presentation">\n      <colgroup>\n        <col width="100%">\n        <col>\n      </colgroup>\n      <tbody>\n        <tr>\n          <td colspan="2"><label for="${id}_memberTypeSelector"\n            data-dojo-attach-point="typeaheadSelectorLabel"\n            class="lotusOffScreen">${nls.MEMBER_TYPE}</label> <select\n            id="${id}_memberTypeSelector"\n            data-dojo-attach-point="typeaheadSelector"\n            style="width: 100%;">\n              <option value="user">${nls.USER}</option>\n              <option value="community">${nls.COMMUNITY}</option>\n              <option value="everyone">${shareNLS.PUBLIC.SHORT}</option>\n          </select></td>\n        </tr>\n        <tr data-dojo-attach-point="memberSelector">\n          <td>\n            <div data-dojo-attach-point="typeAheadInput">\n              <textarea data-dojo-attach-point="textarea"></textarea>\n            </div>\n            </td>\n          <td><label for="${id}_roleSelector"\n            data-dojo-attach-point="roleSelectorLabel"\n            class="lotusOffScreen">${nls.ROLE_LABEL}</label> <select\n            id="${id}_roleSelector"\n            data-dojo-attach-point="roleSelector">\n              <option value="editor">${nls.ROLE_EDIT}</option>\n              <option value="reader">${nls.ROLE_VIEW}</option>\n          </select>\n          </td>\n          <td>\n            <div class="externalAddContainer" data-dojo-attach-point="externalAddContainer">\n              <a href="javascript:;"\n                data-dojo-attach-event="click:_multiSelect"\n                data-dojo-attach-point="manualAdd" role="button">\n                <img src="${blank}" alt="${nls.SHARE_ALT}" title="${nls.SHARE_ALT}"/>\n                <span class="lotusAltText fileViewerIconText">${nls.SHARE}</span>\n              </a>\n            </div>\n          </td>\n        </tr>\n        <tr data-dojo-attach-point="messageContainer">\n          <td colspan="2"><div class="actionContainer"\n              data-dojo-attach-point="optionalMsgLinkContainer"\n              data-dojo-attach-event="click:_showMessageField">\n              <a href="javascript:;" role="button"\n                title="${nls.ADD_OPTIONAL_MESSAGE}"> <span>${nls.ADD_OPTIONAL_MESSAGE}</span>\n              </a>\n            </div></td>\n        </tr>\n      </tbody>\n    </table>\n    <div data-dojo-attach-point="entryContainer">\n      <div data-dojo-attach-point="editorContainer"\n        style="display: none;">\n        <div style="color: black;">${shareNLS.ROLES.EDIT}</div>\n      </div>\n      <div data-dojo-attach-point="readerContainer"\n        style="display: none;">\n        <div style="color: black;">${shareNLS.ROLES.VIEW}</div>\n      </div>\n    </div>\n    <div class="actionContainer actionButton"\n      data-dojo-attach-point="actionContainer">\n      <a href="javascript:;" class="manualAdd"\n        data-dojo-attach-event="click:_multiShare"\n        data-dojo-attach-point="manualAdd" role="button"\n        title="${nls.SHARE_ALT}"> <span>${nls.SHARE}</span>\n      </a>\n    </div>\n    <div class="actionContainer actionButton"\n      data-dojo-attach-point="cancelContainer">\n      <a href="javascript:;" class="manualCancel"\n        data-dojo-attach-event="click:_cancel"\n        data-dojo-attach-point="manualCancel" role="button"\n        title="${nls.CANCEL}"> <span>${nls.CANCEL}</span> \n      </a>\n    </div>\n    \n  </div>\n  <div data-dojo-attach-point="errorContainer"></div>\n  <div data-dojo-attach-point="warningContainer"></div>\n</div>\n');

;define("ic-share/fileviewer/widget/bhcPeopleTypeAhead",["dojo/_base/lang","../config/globals","dojo/aspect","../util/url","dojo/dom-class","dojo/query","dojo/i18n!../nls/FileViewerStrings","dijit/focus"],function(_1,_2,_3,_4,_5,_6,_7,_8){
"use strict";
return {create:function(_9,_a){
var _b={id:_9.id+"people",minChars:2,searchDelay:400,multipleValues:false,url:_4.rewrite(_2.services.getContactsUrl()+"/typeahead/people",{users:true,internal:false,communities:false,contacts:true,intent:_a.file.isExternal?"external":"internal"})};
_1.mixin(_b,_a);
var _c=new bhc.PeopleTypeAhead(_b,_9);
_3.before(_c,"onSelect",function(_d){
var _e={userid:_d.i.i.replace("u_",""),name:_d.i.f,email:_d.i.e};
return [_e];
});
_3.before(_c,"_onBlur",_1.hitch(this,function(){
this.updateHintText(_c.focusNode,null,false,false);
}));
_3.before(_c,"_onFocus",_1.hitch(this,function(){
this.updateHintText(_c.focusNode,null,true,true);
}));
this._initHintText(_c);
this._fixStyling(_c.domNode);
return _c;
},_initHintText:function(_f){
this.updateHintText(_f.focusNode,_7.TYPEAHEAD_BOX.PERSON_SHADOW,false,false);
},updateHintText:function(_10,_11,_12,_13){
if(_11){
_10.title=this.hintText=_11;
}
if(this.hintText){
if(!_12&&(_10.value===""||!_10.hasInput)){
_10.hasInput=false;
_10.style.color="#666";
_10.value=this.hintText||"";
}else{
if(!_10.hasInput){
_10.hasInput=true;
_10.style.color="#000";
_10.value="";
if(_13){
_8.focus(_10);
}
}
}
}
},_fixStyling:function(_14){
_5.add(_14,"bhcPeopleTypeAhead");
var _15=_6(".typeaheadInput",_14)[0];
if(_15){
_5.remove(_15,"typeaheadInput");
}
}};
});


;define("ic-share/fileviewer/widget/peopleTypeAhead",["dojo/_base/lang","../config/globals","../data/util/routes"],function(_1,_2,_3){
"use strict";
return {create:function(_4,_5){
var _6={id:_4.id+"people",minChars:2,searchDelay:400,multipleValues:false,store:this._getDefaultDataStore(_5.file),role:"combobox"};
_1.mixin(_6,_5);
var _7=new _2.PeopleTypeAhead(_6,_4);
return _7;
},_getDefaultDataStore:function(_8){
var _9={sK:"relevanceByName",count:15,internalOnly:!_8.isExternal};
var _a=_3.getFilesAppRoutes(_8);
var _b=_a.getActiveTypeAheadUserServiceUrl();
var _c=_a.getActiveTypeAheadUserServiceUrl();
return new _2.HybridPeopleDataStoreOpenSocial({url:_b,queryParam:"searchString",extendedTypeAheadUrl:_c,extendedQueryParam:"searchString",openSocialParameters:_9});
}};
});


;define("ic-share/fileviewer/widget/communityTypeAhead",["dojo/_base/lang","../config/globals","dojo/aspect","dojo/_base/array","dojo/i18n!../nls/FileViewerStrings","../data/util/routes"],function(_1,_2,_3,_4,_5,_6){
"use strict";
return {create:function(_7,_8){
var _9={id:_7.id+"people",minChars:2,searchDelay:400,multipleValues:false,disableSearchDirectory:!!_1.getObject("lconn.files.config.isCloudMode"),store:this._getDefaultDataStore(_8.file)};
_1.mixin(_9,_8);
var _a=new _2.PeopleTypeAhead(_9,_7);
if(_a.store&&_1.isFunction(_a.store.clear)){
_a.store.clear();
}
_3.before(_a,"_openResultList",function(_b,_c){
if(_b.entry){
_b=_b.entry;
_4.forEach(_b,function(_d){
_d.name=_d.title;
});
}
return [_b,_c];
});
_a.textbox.value=_5.TYPEAHEAD_BOX.COMMUNITY_SHADOW;
_a.hintText=_5.TYPEAHEAD_BOX.COMMUNITY_SHADOW;
_a.searchDirectory=_5.TYPEAHEAD_BOX.COMMUNITY_FULL_SEARCH;
return _a;
},_getDefaultDataStore:function(_e){
var _f={filterBy:"displayName",count:15,internalOnly:_e.isExternal};
var _10=_6.getFilesAppRoutes(_e);
var opt={};
var _11=_10.getCommunitiesListServiceUrl(opt);
var _12=_10.getCommunitiesListServiceUrl(opt);
if(!_e.get("isExternal")){
_11+="?internalOnly=true";
_12+="?internalOnly=true";
}
return new _2.TypeAheadDataStore({url:_11,queryParam:"filterValue",extendedTypeAheadUrl:_12,extendedQueryParam:"filterValue",openSocialParameters:_f});
}};
});


;define("ic-share/fileviewer/widget/typeAheadFactory",["dojo/_base/lang","./bhcPeopleTypeAhead","./peopleTypeAhead","./communityTypeAhead"],function(_1,_2,_3,_4){
"use strict";
return {createPeopleTypeAhead:function(_5,_6){
if(_1.exists("bhc.PeopleTypeAhead")){
return _2.create(_5,_6);
}else{
return _3.create(_5,_6);
}
},createCommunityTypeAhead:function(_7,_8){
return _4.create(_7,_8);
}};
});


;define("ic-share/fileviewer/panels/SharingWidget",["dojo/_base/declare","./EntryWidget","../dialog/SharingDialog","dojo/i18n!../nls/FileViewerStrings","dojo/string","../config/globals","dojo/_base/array","../data/util/routes","dojo/dom-construct","dojo/dom-style","dojo/_base/lang","dojo/dom-attr","dojox/html/entities","../util/html"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){
return _1([_2],{postMixInProperties:function(){
var _f,_10;
var _11=this.getPictureUrl();
this.baseClasses="share";
this.reloadItem=true;
this.DialogFactory=_3;
this.org=this.file.get("orgName");
this.publicLong=(this.org===undefined)?_4.SHARE.PUBLIC.LONG.GENERIC:_5.substitute(_4.SHARE.PUBLIC.LONG.ORG,{org:this.org});
this.publicShort=_4.SHARE.PUBLIC.SHORT;
if(this.entry.get("permission")==="Owner"||this.getDeletePermission()){
this.baseClasses+=" unremovable";
}
this.type=this.entry.get("type");
this.libraryType="";
if(this.file){
this.libraryType=this.file.get("libraryType");
}
if(this.type==="folder"){
_10=this.entry.get("visibility");
if(_7.indexOf(["private","shared","public"],_10)>-1){
this.baseClasses+=" "+_10;
}
}else{
if(this.type==="community"&&this.libraryType==="communityFiles"){
if(this.entry.get("visibility")){
this.baseClasses+=" community";
}
}else{
if(this.type!=="community"){
this.iconSource=(_11+this.entry.get("id"))||"";
}
}
}
if(this.type==="everyone"){
this.h1=this.tooltip=this.publicLong;
}else{
this.h1=this.tooltip=this.entry.get("name")||this.entry.get("title")||this.entry.get("type")||"";
}
this.h2=this.entry.get("permission");
this.h3="";
this.content=this.entry.get("content")||"";
this.footer=("Version "+this.entry.get("version"))||"";
switch(this.entry.get("type")){
case "everyone":
_f="REMOVE_EVERYONE";
this.baseClasses+=" everyone";
break;
case "user":
_f="REMOVE_USER";
this.baseClasses+=" user";
break;
case "community":
if(this.libraryType==="communityFiles"&&this.entry.get("permission")!=="Owner"){
_f="REMOVE_FOLDER";
this.baseClasses+=" folder";
}else{
_f="REMOVE_COMMUNITY";
this.baseClasses+=" community";
}
break;
case "folder":
_f="REMOVE_FOLDER";
this.baseClasses+=" folder";
break;
default:
if(this.entry.get("type")){
this.baseClasses+=" "+this.entry.get("type");
}
}
this.dialogArgs={type:this.entry.get("type"),promptKey:_f,name:this.entry.get("name")||this.entry.get("title")};
this.inherited(arguments);
},postCreate:function(){
this.inherited(arguments);
_c.set(this.h1Node,"title",this.tooltip);
if(this.type==="user"||this.type==="Owner"){
_9.empty(this.h1Node);
this.setUserName(this.entry,this.h1Node);
if(!_b.isFunction(_6.createPersonPhotoLink)){
this.iconLinkNode.setAttribute("target","_blank");
}else{
var _12=_6.createPersonPhotoLink(this.entry);
if(_12){
this.set("iconSource",_12.firstChild.src);
}
_a.set(this.iconLinkNode,"display","none");
this.iconNodeContainer.appendChild(_12);
}
}else{
if((this.type==="folder")||((this.type==="community")&&(this.libraryType==="communityFiles")&&this.entry.get("permission")!=="Owner")){
_9.empty(this.h1Node);
this.setFolderName(this.entry,this.h1Node);
}else{
if(this.type==="community"){
_9.empty(this.h1Node);
this.setCommunityName(this.entry,this.h1Node);
}else{
if(this.type==="everyone"){
this.set("iconLinkTitle",this.publicShort);
}else{
if((this.libraryType==="personalFiles")&&(_6.currentUser.id!==this.file.author.id)){
_a.set(this.removeAction,"display","none");
}
}
}
}
}
},getDeletePermission:function(){
var _13=this.entry.get("td:addedBy"),_14=_13?_13["snx:userid"]:null;
if(this.isTemporary){
return false;
}
if(this.entry.isCollection()){
return this.canDeleteFolder(_14);
}
if(this.entry.get("role")==="manager"||(_6.currentUser.id===_14&&this.entry.get("role")==="contributor")){
return false;
}
if(this.file.myShares&&this.file.myShares.length>0){
if(_7.some(this.file.myShares,_b.hitch(this,function(_15){
return this.entry.id==_15.id;
}))){
this.entry.isPersonalShare=true;
return false;
}
}
if(this.file.get("permissions")._permissions){
return !this.file.get("permissions").canDelete();
}
if(!this.file.get("canOthersShare")&&(_6.currentUser.id!==this.file.get("author").id)){
return true;
}
return true;
},canDeleteFolder:function(_16){
var _17=this.entry.get("role");
if(_17==="manager"||(_16===_6.currentUser.id&&_17==="contributor")){
return false;
}
return true;
},setCommunityName:function(_18,_19){
var _1a=_9.create("span",null,_19);
var _1b=this.createCommunityLink(_18);
_1a.appendChild(_1b);
this.set("iconLinkClasses",_1b.className);
this.set("iconLink",_1b.href);
this.set("iconLinkTitle",_1b.title);
_e.processLink(this.iconLinkNode);
},setFolderName:function(_1c,_1d){
var _1e=_9.create("span",null,_1d);
var _1f=this.createFolderLink(_1c);
if(!_1f){
_1e.appendChild(_9.toDom(_1c.title));
this.set("iconLinkTitle",_1c.title);
}else{
_1e.appendChild(_1f);
this.set("iconLinkClasses",_1f.className);
this.set("iconLink",_1f.href);
this.set("iconLinkTitle",_1f.title);
this.set("iconAltText",_1f.title);
_e.processLink(this.iconLinkNode);
}
},createCommunityLink:function(_20){
var _21=_20.get("title");
var _22=_5.substitute(_4.PANEL.SHARING.SHARED_WITH_COMMUNITY,[_21]);
var _23=_8.getCommunityLink(_20);
var ret=_9.create("a",{className:"lotusPerson",title:_22,href:_23,innerHTML:_d.encode(_21)});
_e.processLink(ret);
return ret;
},createFolderLink:function(_24){
var _25=_24.get("title");
var _26=_8.getFolderLink(_24);
var ret=_9.create("a",{className:"",title:_25,href:_26,innerHTML:_d.encode(_25)});
_e.processLink(ret);
return ret;
}});
});


;define("ic-share/fileviewer/widget/TypeAheadBox",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/TypeAheadBox.html","dojo/text!./templates/TypeAheadBoxMulti.html","dojo/_base/lang","dojo/dom-style","dojo/dom-class","dojo/dom-construct","dojo/dom-attr","../config/globals","dojo/aspect","dojo/_base/array","dojo/on","dojox/validate/web","dojo/dom","dojo/_base/config","dojo/topic","dojo/i18n!../nls/FileViewerStrings","./typeAheadFactory","dojo/string","dojo/dom-attr","dojo/when","../panels/SharingWidget"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,on,_e,_f,_10,_11,_12,_13,_14,_a,_15,_16){
return _1([_2,_3],{templateString:_4,showShadowText:true,cancelOnBlur:false,searchCommunity:false,constructor:function(_17){
if(_17.isMulti){
this.templateString=_5;
}
this.pendingUsers=[];
this.pendingCommunities=[];
this.pendingEmails=[];
},postMixInProperties:function(){
this.nls=_12.TYPEAHEAD_BOX;
this.shareNLS=_12.SHARE;
this._saveText=this.nls.SAVE;
this.blank=_10.blankGif||dijit._WidgetBase.prototype._blankGif;
if(!this.nls.ROLE_LABEL){
this.nls.ROLE_LABEL="Role";
}
if(!this.nls.ROLE_EDIT){
this.nls.ROLE_EDIT="Editor";
}
if(!this.nls.ROLE_VIEW){
this.nls.ROLE_VIEW="Reader";
}
if(!this.nls.ADD_OPTIONAL_MESSAGE){
this.nls.ADD_OPTIONAL_MESSAGE="Add Optional Message";
}
if(!this.nls.MEMBER_TYPE){
this.nls.MEMBER_TYPE="Member Type";
}
},postCreate:function(){
_7.set(this.textarea,"display","none");
_8.add(this.domNode,"active");
this.setupEveryoneOption();
this.setupSelectorOptions();
this._setupUserTypeahead();
this._disableButton(this.manualAdd);
if(this.isMulti&&this.roleSelector&&this.defaultRole){
_d.forEach(this.roleSelector.options,_6.hitch(this,function(_18){
if(_18.value===this.defaultRole){
_a.set(_18,"selected",true);
}
}));
}
if(this.isMulti&&this.roleSelector&&(this.file.get("author").id!==_b.currentUser.id)){
_d.forEach(this.roleSelector.options,_6.hitch(this,function(_19){
if(_19&&_19.value==="editor"){
_9.destroy(_19);
}
}));
}
if(this.externalAddContainer&&!this.file.get("isExternal")){
_7.set(this.externalAddContainer,"display","none");
}
_a.set(this.typeaheadSelectorLabel,"for",this.typeaheadSelector.id);
_a.set(this.inputNodeLabel,"for",this._typeahead.id);
on(this.typeaheadSelector,"change",_6.hitch(this,"changeTypeahead"));
this.focusHandler=on(document,"mousedown",_6.hitch(this,function(evt){
var el=evt.target;
if(!this.isMulti&&!_f.isDescendant(el,this.sectionNode)&&(!this._typeahead.dropDown||!_f.isDescendant(el,this._typeahead.dropDown.domNode))){
this._cancel();
}
}));
if(_6.isFunction(this._typeahead.updateHintText)){
this._typeahead.updateHintText(this._typeahead.hintText);
}
},clear:function(){
this._typeahead.setDisplayedValue("");
if(!this.isMulti){
this._disableButton(this.manualAdd);
}
},_isOrganizationPublic:function(){
return _15(_b.policy).then(_6.hitch(this,function(_1a){
return _1a&&!!_1a.organizationPublic;
}));
},_isEveryoneOptionVisible:function(){
return this._isOrganizationPublic().then(_6.hitch(this,function(_1b){
if(_1b){
if(this.filePermission==="Edit"||this.file.get("visibility")==="public"||!this.file.get("permissions").canGrantAccess()){
return false;
}else{
return true;
}
}else{
return false;
}
}),function(){
return false;
});
},setupEveryoneOption:function(){
this._isEveryoneOptionVisible().then(_6.hitch(this,function(_1c){
if(!_1c){
_d.forEach(this.typeaheadSelector.options,_6.hitch(this,function(_1d){
if(_1d.value==="everyone"){
_9.destroy(_1d);
}
}));
}
}));
},setupSelectorOptions:function(){
_15(_b.policy).then(_6.hitch(this,function(_1e){
if(!_6.getObject("capabilities.canView.communities",false,_1e)){
_d.forEach(this.typeaheadSelector.options,_6.hitch(this,function(_1f){
if(_1f.value==="community"){
_9.destroy(_1f);
}
}));
}
}));
},changeTypeahead:function(){
if(this.typeaheadSelector.value==="everyone"){
this.shareWithEveryone();
}else{
if(this.typeaheadSelector.value==="user"){
this._setupUserTypeahead();
}else{
if(this.typeaheadSelector.value==="community"){
this._setupCommunityTypeahead();
}
}
}
_a.set(this.inputNodeLabel,"for",this._typeahead.id);
this.toggleShareOptions();
this.focusTypeahead();
if(_6.isFunction(this._typeahead.updateHintText)){
this._typeahead.updateHintText(this._typeahead.hintText);
}
},shareWithEveryone:function(){
if(!this.isMulti){
this.emit("save",{everyone:true});
this._typeahead.setDisplayedValue("");
this._disableButton(this.manualAdd);
}else{
if(this.isMulti){
this._enableButton(this.manualAdd);
}
}
},toggleShareOptions:function(){
var _20=this.typeaheadSelector.value==="everyone"?"none":"";
if(this.isMulti){
_7.set(this.memberSelector,"display",_20);
_7.set(this.messageContainer,"display",_20);
_7.set(this.entryContainer,"display",_20);
}
},initPlaceholderField:function(){
var _21=_9.create("input",{type:"text",id:this.domNode.id+"_"+(new Date().getTime())});
_9.place(_21,this.typeAheadInput,"only");
var _22=this.inputNodeLabel=_9.create("label",{"for":_21.id,"innerHTML":this.nls.USER,"class":"lotusOffScreen"});
_9.place(_22,this.typeAheadInput,"first");
return _21;
},_setupUserTypeahead:function(){
if(this.externalAddContainer&&!this.file.get("isExternal")){
_7.set(this.externalAddContainer,"display","none");
}else{
if(this.externalAddContainer&&this.file.get("isExternal")){
_7.set(this.externalAddContainer,"display","");
}
}
this._createTypeAhead(_13.createPeopleTypeAhead,_12.TYPEAHEAD_BOX.PERSON_ARIA);
},_setupCommunityTypeahead:function(){
if(this.externalAddContainer){
_7.set(this.externalAddContainer,"display","none");
}
this._createTypeAhead(_13.createCommunityTypeAhead,_12.TYPEAHEAD_BOX.COMMUNITY_ARIA);
},_createTypeAhead:function(_23,_24){
if(this._typeahead){
this._typeahead.destroy();
}
if(this.isMulti){
this.selectFunction=this._multiSelect;
}else{
this.selectFunction=this._save;
}
var _25=this.initPlaceholderField();
this._typeahead=_23(_25,{onSelect:_6.hitch(this,this.selectFunction),file:this.file});
if(_24){
var _26=_25.id+"people",_27=this._typeahead.domNode;
if(_a.get(_27,"id")!==_26){
_27=_d.filter(this._typeahead.domNode.getElementsByTagName("input"),function(_28){
return _a.get(_28,"id")===_26;
})[0];
}
if(_27){
var _29=_27.id+"_fido_description";
var _2a=_9.create("span",{id:_29,style:{display:"none"},innerHTML:_24});
_9.place(_2a,_27,"after");
_a.set(_27,"aria-describedby",_29);
}
}
on(this._typeahead,"keyup",_6.hitch(this,"_shareButton"));
on(this._typeahead,"mouseup",_6.hitch(this,"_shareButton"));
on(this._typeahead,"cut",_6.hitch(this,"_shareButtonCutPaste"));
on(this._typeahead,"paste",_6.hitch(this,"_shareButtonCutPaste"));
this.focusTypeahead();
},_multiSelect:function(_2b){
var _2c=this.roleSelector.value+"Container",_2d=_6.trim(this._typeahead.getValue());
if((_2b&&_2b.userid===_b.currentUser.id)||(_2d===_b.currentUser.email)){
this.shareSelfError();
}else{
if(_2b&&_2b.userid===this.file.get("author").id){
this.shareOwnerError(_2b.name);
}else{
if(this._shouldAddByEmail(_2b,_2d)){
this.addEmail(_2d,_2b);
}else{
if(_2b&&_2b.name){
this.addUserOrCommunity(_2b);
}else{
return;
}
}
}
}
this.clear();
},_shouldAddByEmail:function(_2e,_2f){
if((!_2e||!_2e.name)&&_e.isEmailAddress(_2f)){
return true;
}
if(this._isGuestContact(_2e)){
return true;
}
return false;
},_isGuestContact:function(_30){
if(_30&&_30.userid&&_30.userid.lastIndexOf("c_",0)===0){
return true;
}
return false;
},addUserOrCommunity:function(_31){
var _32=this.roleSelector.value+"Container",_33=this.roleSelector.value==="editor"?"Edit":"View",_34={container:_32,id:_31.userid,name:_31.name,title:_31.title||_31.name,communityUuid:_31.id,communityType:_31.communityType,permission:_33,type:this.typeaheadSelector.value},_35=this.createEntry(_34),_36=this.getExistingEntry(_35);
if(_36){
_36.remove();
}
if(_31&&_31.communityType){
this.pendingCommunities.push(_35);
}else{
if(_31){
this.pendingUsers.push(_35);
}
}
_35.placeAt(this[_32]);
if(this.isMulti){
this._enableButton(this.manualAdd);
}
_7.set(this[_32],"display","");
},addEmail:function(_37,_38){
var _39=this.roleSelector.value+"Container";
var _3a=this.roleSelector.value==="editor"?"Edit":"View";
createArgs={container:_39,id:(this._isGuestContact(_38))?_38.userid:_37,email:(this._isGuestContact(_38))?_38.email:_37,name:(this._isGuestContact(_38))?_38.name:_37,title:_37,permission:_3a,type:this.typeaheadSelector.value};
var _3b=this.createEntry(createArgs),_3c=this.getExistingEntry(_3b);
if(_3c){
_3c.remove();
}
this.pendingEmails.push(_3b);
_3b.placeAt(this[_39]);
if(this.isMulti){
this._enableButton(this.manualAdd);
}
_7.set(this[_39],"display","");
},shareOwnerError:function(_3d){
_11.publish("ic-fileviewer/push/messages",{type:"warning",message:_14.substitute(this.shareNLS.SHARE_FAIL.EXISTING_USER,{user:_3d}),cancelable:true});
},shareSelfError:function(){
_11.publish("ic-fileviewer/push/messages",{type:"warning",message:this.shareNLS.SHARE_FAIL.SELF,cancelable:true});
},createEntry:function(_3e){
var _3f=this.file.get("sharingFeed").newItem(_3e),_40=new _16({entry:_3f,file:this.file,isTemporary:true});
_40.remove=_6.hitch(this,this._destroyEntry,_40);
return _40;
},getExistingEntry:function(_41){
var _42=false;
if(_41.entry.get("type")==="user"){
_d.some(this.pendingUsers.concat(this.pendingEmails),function(_43){
if(_41.entry.get("id")===_43.entry.get("id")){
_42=_43;
return true;
}
});
}
if(_41.entry.get("type")==="community"){
_d.some(this.pendingCommunities,function(_44){
if(_41.entry.get("communityUuid")===_44.entry.get("communityUuid")){
_42=_44;
return true;
}
});
}
return _42;
},_destroyEntry:function(_45){
_9.destroy(_45.domNode);
this.removeItem(_45);
},removeItem:function(_46){
var _47,_48,_49,_4a=_46.entry.get("container");
if(_46.get("type")==="user"&&!_46.entry.get("email")){
_48="pendingUsers";
}else{
if(_46.get("type")==="community"){
_48="pendingCommunities";
}else{
_48="pendingEmails";
}
}
_d.some(this[_48],function(_4b,_4c){
if(_4b.get("id")===_46.get("id")){
_47=_4c;
_4b.destroy();
return true;
}
});
this[_48].splice(_47,1);
var _4d=this["pendingUsers"].length+this["pendingCommunities"].length+this["pendingEmails"].length;
if(this.isMulti&&_4d===0){
this._disableButton(this.manualAdd);
}
_49=_d.filter(this.pendingUsers.concat(this.pendingCommunities.concat(this.pendingEmails)),function(_4e){
return _4e.entry.get("permission")===_46.entry.get("permission");
});
if(_49.length===0){
_7.set(this[_4a],"display","none");
}
},_multiShare:function(){
var _4f=this.pendingUsers.concat(this.pendingCommunities.concat(this.pendingEmails));
if(this.typeaheadSelector.value==="everyone"){
this.emit("save",{everyone:true});
}else{
if(_4f.length>0){
this.emit("save",{users:this.pendingUsers,communities:this.pendingCommunities,emails:this.pendingEmails});
}
}
},hasChanges:function(){
return this.pendingUsers.length||this.pendingCommunities.length||this.pendingEmails.length;
},_showMessageField:function(){
if(this.messageBox){
_7.set(this.messageBox.domNode,"display","");
_7.set(this.optionalMsgLinkContainer,"display","none");
}
},_shareButton:function(arg){
if(!this.isMulti){
var _50=_6.trim(this._typeahead.getValue());
if((_50)&&(_50!=="")&&(_e.isEmailAddress(_50))){
this._enableButton(this.manualAdd);
}else{
this._disableButton(this.manualAdd);
}
}
},_shareButtonCutPaste:function(arg){
if(!this.isMulti){
this._enableButton(this.manualAdd);
}
},_addByEmail:function(){
var _51=_6.trim(this._typeahead.getValue()),_52={email:_51};
if(!_51||_51===""||!_e.isEmailAddress(_51)){
this._disableButton(this.manualAdd);
return;
}
if(_e.isEmailAddress(_51)){
this.emit("save",{typeaheadItem:_52});
}else{
_11.publish("ic-fileviewer/push/messages",{type:"error",message:_14.substitute(this.shareNLS.SHARE_FAIL.ERROR,{user:_51}),cancelable:true});
}
},_save:function(_53){
if(_53){
this.emit("save",{typeaheadItem:_53});
}
},_cancel:function(){
this.emit("cancel",{typeahead:this});
this.focusHandler.remove();
},focusTypeahead:function(){
this._typeahead.focus();
setTimeout(_6.hitch(this,function(){
this._typeahead.focus();
}));
},onsave:function(){
return;
},oncancel:function(){
return;
},destroy:function(){
this.focusHandler.remove();
if(this._typeahead){
this._typeahead.destroy();
}
this.inherited(arguments);
},_enableButton:function(_54){
_a.remove(_54,"disabled");
_a.set(_54,"tabindex","");
_a.set(_54,"aria-disabled","false");
},_disableButton:function(_55){
_a.set(_55,"disabled","disabled");
_a.set(_55,"tabindex","-1");
_a.set(_55,"aria-disabled","true");
}});
});


;define("dojo/text!ic-share/fileviewer/dialog/templates/ProvisionExternalUser.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-dialog-action">\n   <div class="prompt-container">\n      <span>${nls.PROMPT.NO_ACCOUNT}</span>\n   </div>\n   <div data-dojo-attach-point="userEmailsContainer"></div>\n   <div class="prompt-container">\n      <span>${nls.PROMPT.INVITE}</span>\n   </div>\n   <form class="lotusHidden" method="post" enctype="application/x-www-form-urlencoded" data-dojo-attach-point="form">\n      <input type="hidden" name="appCsrfToken" data-dojo-attach-point="appCsrfToken">\n      <input type="hidden" name="returnUrl" data-dojo-attach-point="returnUrl">\n      <input type="hidden" name="cancelUrl" data-dojo-attach-point="cancelUrl">\n      <input type="hidden" name="guestEmails" data-dojo-attach-point="guestEmails">\n      <input type="hidden" name="serviceData" data-dojo-attach-point="serviceData">\n   </form>\n   <div class="button-container">\n      <a class="confirm bad" href="javascript:;" data-dojo-attach-point="upload"\n       data-dojo-attach-event="onclick:clickLink" id="ok" role="button">${nls.SUBMIT}</a>\n      <a class="cancel neutral" href="javascript:;"\n       data-dojo-attach-event="onclick:clickLink" id="cancel" role="button">${nls.CANCEL}</a>\n   </div>\n</div>');

;define("ic-share/fileviewer/dialog/UploadDialog",["dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dojo/dom-class","dojo/_base/json","dojo/request","dojo/Evented","dijit/Dialog","../data/util/routes"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
"use strict";
return _1([_8,_7],{MOCK_PATH_REGEX:/(\\|\/)/g,GET_NONCE_OPTIONS:{method:"GET",handleAs:"text"},_onSubmit:function(_a){
this.emit("submit",_a);
this._submit();
},_submit:function(){
this._disableUpload();
var _b=_9.getFilesNonceUrl();
_6(_b,this.GET_NONCE_OPTIONS).then(_2.hitch(this,"_validateNonce"),_2.hitch(this,"_onError"));
},_validateNonce:function(_c){
if(!_c||typeof _c!=="string"){
var _d=new Error("Nonce value received was unexpected: "+_c);
this._onError(_d);
}else{
this._onNonce(_c);
}
},_onNonce:function(_e){
var _f=this.getUploadUrl({nonce:_e});
if(!_f){
var _10=new Error("Generated upload url was invalid: "+_f);
this._onError(_10);
}else{
_3.set(this.content.form,"action",_f);
_3.set(this.content.form,"method","POST");
this.content.form.submit();
}
},_onError:function(_11){
this.emit("error",{message:this.nls.ERROR,source:_11});
},_onCancel:function(_12){
this.content.form.reset();
this.emit("cancel",_12);
},_enableUpload:function(){
_3.remove(this.content.upload,"disabled");
_3.set(this.content.upload,"tabindex","");
_3.set(this.content.upload,"aria-disabled","false");
},_disableUpload:function(){
_3.set(this.content.upload,"disabled","disabled");
_3.set(this.content.upload,"tabindex","-1");
_3.set(this.content.upload,"aria-disabled","true");
}});
});


;define("ic-share/fileviewer/dialog/ProvisionExternalUser",["dojo/_base/declare","dojo/dom-class","dojo/text!./templates/ProvisionExternalUser.html","./DialogAction","./UploadDialog","../data/util/routes","dojo/_base/lang","dojo/dom-attr","dojo/i18n!../nls/FileViewerStrings","dojo/dom-construct","dojo/_base/json","dojo/_base/array","../config/globals","dojo/when"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){
var _f=_1([_5],{"class":"provisionExternalUserDialog",USER_EMAIL_SEPARATOR:", ",constructor:function(_10){
this.nls=_9.SHARE.PROVISION_EXTERNAL_USER_DIALOG.ABSTRACT;
this.users=[];
this.collIds=[];
this.message="";
this.file=_10.file;
if(_10.users){
if(_10.users.length===1){
this.nls=_9.SHARE.PROVISION_EXTERNAL_USER_DIALOG.SINGULAR;
this.users=_10.users;
}else{
if(_10.users.length>1){
this.nls=_9.SHARE.PROVISION_EXTERNAL_USER_DIALOG.PLURAL;
this.users=_10.users;
}
}
}
if(_10.collIds){
this.collIds=_10.collIds;
}
if(_10.message){
this.message=_10.message;
}
this.content=new _4({template:_3,nls:this.nls});
this.content.clickLink=_7.hitch(this,function(e){
if(e.target.id==="ok"){
this.emit("clicked",{});
this._onSubmit();
}
this.onCancel();
});
this.content.startup();
this._set("title",this.nls.NAME);
},postCreate:function(){
this.inherited(arguments);
if(this.users.length>0){
this._renderUserEmails();
}else{
this._hideUserEmailsContainer();
}
},_renderUserEmails:function(){
this._showUserEmailsContainer();
_a.empty(this.content.userEmailsContainer);
var _11=_a.create("div",{innerHTML:this._parseUserEmailList().join(this.USER_EMAIL_SEPARATOR)});
_2.add(_11,"lotusMessage lotusMeta lotusWarning");
_a.place(_11,this.content.userEmailsContainer);
},_hideUserEmailsContainer:function(){
_2.add(this.content.userEmailsContainer,"lotusHidden");
},_showUserEmailsContainer:function(){
_2.remove(this.content.userEmailsContainer,"lotusHidden");
},_parseUserEmailList:function(){
var _12=[];
_c.forEach(this.users,_7.hitch(this,function(_13){
_12.push(_13.email);
}));
return _12;
},getUploadUrl:function(_14){
this._populateFormData(_14.nonce);
return _6.getProvisionExternalUserUrl();
},_populateFormData:function(_15){
_8.set(this.content.appCsrfToken,"value",_15);
_8.set(this.content.returnUrl,"value",_6.getProvisionExternalUserReturnUrl(this.file));
_8.set(this.content.cancelUrl,"value",_6.getProvisionExternalUserCancelUrl(this.file));
_8.set(this.content.guestEmails,"value",this._parseUserEmailList().join(this.USER_EMAIL_SEPARATOR));
_8.set(this.content.serviceData,"value",this._getServiceData());
},_getServiceData:function(){
var _16={message:this.message,collIds:this.collIds,fileIds:[this.file.get("id")],roles:{}};
_c.forEach(this.users,function(_17){
_16.roles[_17.email]=_17.role.toUpperCase();
});
return _b.toJson(_16);
},onCancel:function(){
this.emit("close");
this.inherited(arguments);
},setUsers:function(_18,_19){
this.users=_18;
if(_19){
if(this.users.length>0){
this._renderUserEmails();
}else{
this._hideUserEmailsContainer();
}
}
}});
_f.isValid=function(_1a){
var _1b=true;
return _e(_d.policy).then(_7.hitch(this,function(_1c){
var _1d=_1c.isExternalEnabled&&!_d.currentUser.isExternal&&_1a.get("isExternal")&&_1a.get("permissions").canGrantAccess()&&(_1a.get("libraryType")==="personalFiles")&&(_7.getObject("lconn.files.config.features.canInviteUsers")===true)&&_1b;
if(_1d){
var _1e=_7.getObject("lconn.share.util.configUtil");
if(_1e&&_1e.canViewEveryPeople){
_1d=_1e.canViewEveryPeople(_d.currentUser);
}
}
return _1d;
}));
};
return _f;
});


;define("ic-share/fileviewer/action/ShareAction",["dojo/_base/declare","./Action","dojo/dom-attr","dojo/string","dojo/_base/lang","dojo/topic","dojo/when","dojo/Evented","dojo/dom-style","dojo/dom-class","../dialog/SharingDialog","../widget/TypeAheadBox","dojo/i18n!../nls/FileViewerStrings","../config/globals","../data/util/routes","../network/request","dojo/io-query","dojo/on","../widget/EditBox","../util/validation","../dialog/ProvisionExternalUser","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,on,_12,_13,_14,_15){
"use strict";
var _16=_1([_2,_8],{"class":"ics-viewer-action ics-viewer-action-share",_TypeAheadBox:_c,provisionExternalUserEnabled:true,constructor:function(_17){
_5.mixin(this,_17);
this.isFolderPicker=_17.isFolderPicker;
this.preserveMessage="";
},postMixInProperties:function(){
this.messageNls=_d.SHARE;
this.nls=_d.SHARE.ACTION[this.permission.toUpperCase()]||_d.SHARE.ACTION.EDIT;
if(this.moveFolder&&this.nls.MOVE){
this.title=this.nls.MOVE;
}else{
if(this.file.get("libraryType")==="communityFiles"&&this.nls.COMMUNITY_ADD){
this.title=this.nls.COMMUNITY_ADD;
}else{
this.title=this.nls.ADD;
}
}
this.name="";
this.a11y="";
},onLinkClicked:function(){
if(!this.isFolderPicker){
this.setupAdd();
_15.track("share.open",{mode:"quick"});
}else{
this.addFolder();
_15.track("share.open",{mode:"folder"});
}
},addFolder:function(){
this.emit("_addFolder");
},setupAdd:function(){
var _18=(this.permission||"").toLowerCase()==="edit"?"editor":"reader";
_6.publish("ic-fileviewer/selectpanel",["share","multiShare",_18]);
},setupMessageBox:function(){
this.messageBox=new _12();
this.messageBox.placeAt(this.typeaheadBox.actionContainer,"before");
_a.add(this.messageBox.textBox,"transition");
this.messageBox.set("hintText",this.messageNls.MESSAGE_BOX.HINT_TEXT);
this.messageBox.set("value",this.messageBox.get("hintText"));
_a.add(this.messageBox.textBox,"hintText");
on(this.messageBox.textBox,"focus",_5.hitch(this,function(){
_a.remove(this.messageBox.textBox,"hintText");
if(this.messageBox.get("value")===this.messageBox.get("hintText")){
this.messageBox.set("value","");
}
}));
on(this.messageBox.textBox,"blur",_5.hitch(this,function(){
if(this.messageBox.get("value")===""){
this.preserveMessage="";
_a.add(this.messageBox.textBox,"hintText");
this.messageBox.set("value",this.messageBox.hintText);
}else{
this.preserveMessage=this.messageBox.get("value");
}
}));
},_add:function(e){
var _19=!!e.everyone;
if(!_19&&!_13.validateShareMessage(this.messageBox)){
return;
}
if(this.messageBox.get("value")!==""&&this.messageBox.get("value")!==this.messageBox.get("hintText")){
e.typeaheadItem.summary=this.messageBox.get("value");
}
if(_19){
this._addEveryone(e);
}else{
if(e.typeaheadItem.communityType){
this._addCommunity(e.typeaheadItem);
}else{
if(!e.typeaheadItem.id&&e.typeaheadItem.email){
this._addByEmail(e.typeaheadItem);
}else{
if(!e.typeaheadItem.email){
this._addUser(e.typeaheadItem);
}
}
}
}
this.typeaheadBox.clear();
this.typeaheadBox.focusTypeahead();
_15.track("share.add");
},_addEveryone:function(e){
var _1a=this.file.get(this.dataKey).newItem({permission:"View",type:"everyone"});
this.emit("_add",_1a);
},_addByEmail:function(e){
var _1b,_1c=[e.email],_1d=_f.getFilesAppRoutes(this.file);
_10(_1d.getBulkEmailResolutionUrl(),{auth:{secured:false},method:"POST",headers:{"X-Method-Override":"GET"},postData:_11.objectToQuery({"email":_1c}),handleAs:"json",noStatus:true}).then(_5.hitch(this,function(_1e,_1f){
if(_5.isArray(_1e.items)&&_1e.items.length>0){
var _20=_1e.items[0];
if(_20.id&&_20.email===e.email){
_1b=this.file.get(this.dataKey).newItem({id:_20.id,name:_20.name,permission:this.permission,type:!!_20.communityType?"community":"user"});
if(e.summary){
_1b.set("summary",e.summary);
}
this.emit("_add",_1b);
}else{
_7(_14.isValid(this.file)).then(_5.hitch(this,function(_21){
if(_21){
_1b={email:e.email};
if(this.permission.toUpperCase()==="EDIT"){
_1b.role="EDITOR";
}else{
if(this.permission.toUpperCase()==="VIEW"){
_1b.role="READER";
}
}
var _22=[_1b];
this._renderProvisionExternalUserDialog(_22,this.file);
}else{
this._errorHandler(e.email);
}
}));
}
}
}),_5.hitch(this,function(err){
this._errorHandler(e.email);
}));
},_renderProvisionExternalUserDialog:function(_23,_24){
var _25=new _14({users:_23,file:_24});
_25.on("error",_5.hitch(this,"_provisionExternalUserError"));
_25.placeAt(document.body);
_25.startup();
_25.show();
},_provisionExternalUserError:function(err){
_6.publish("ic-fileviewer/push/messages",{type:"error",message:err.message,cancelable:true});
},_errorHandler:function(_26){
if(_26){
_6.publish("ic-fileviewer/push/messages",{type:"error",message:_4.substitute(_d.SHARE.SHARE_FAIL.ERROR,{user:_26}),cancelable:true});
}
},_addUser:function(e){
var _27=this.file.get(this.dataKey).newItem({id:e.userid,name:e.name,permission:this.permission,type:"user"});
if(e.summary){
_27.set("summary",e.summary);
}
this.emit("_add",_27);
},_addCommunity:function(e){
var _28=this.file.get(this.dataKey).newItem({communityUuid:e.id,communityType:e.communityType,name:e.name,permission:this.permission,type:"community"});
if(e.summary){
_28.set("summary",e.summary);
}
this.emit("_add",_28);
},resetTypeahead:function(){
this.typeaheadBox.destroy();
this.typeaheadBox=undefined;
this.messageBox.destroy();
this.messageBox=undefined;
_9.set(this.link,"display","");
}});
return {create:function(_29){
return new _16(_29);
},isValid:function(_2a,_2b){
if(_2b==="Edit"&&_2a.get("permissions").canGrantAccessEdit()){
return true;
}
if(_2b==="View"&&_2a.get("permissions").canGrantAccessView()){
return true;
}
return false;
},getClassName:function(){
return "ics-viewer-action-share";
}};
});


;define("dojo/text!ic-share/fileviewer/section/templates/ShareSection.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-viewer-shareSection">\n	<div class="streamContainer owner" data-dojo-attach-point="OwnerContainer">\n	</div>\n	<div class="streamContainer editor" data-dojo-attach-point="EditContainer">\n	</div>\n	<div class="streamContainer reader" data-dojo-attach-point="ViewContainer">\n	</div>\n</div>\n');

;define("dojo/text!ic-share/fileviewer/section/templates/SharingGroup.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div>\n	<div class="${id}_title shareGroupTitle"data-dojo-attach-point="titleNode"></div>\n	<div class="panelContent" data-dojo-attach-point="content"></div>\n</div>\n');

;define("ic-share/fileviewer/section/ShareSection",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/ShareSection.html","dojo/text!./templates/SharingGroup.html","dojo/dom-construct","dojo/_base/lang","dojo/Deferred","dojo/_base/array","../action/ShareAction","../panels/Stream","dojo/i18n!../nls/FileViewerStrings","dojo/string","dojo/topic","dojo/dom-attr","dojo/aspect","../config/globals","dojo/promise/all"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,all){
"use strict";
var _12=["Owner","Edit","View"],_13={Owner:[],Edit:[],View:[]},_14={Owner:null,Edit:null,View:null},_15={Owner:2,Edit:1,View:0},_16=_1([_2,_3],{templateString:_5,constructor:function(_17){
this.streamArgs=_17;
this.nls=_c.SHARE;
this.id=_17.permission+"_"+(new Date().getTime());
_7.mixin(this,_17);
},postCreate:function(){
this.userStream=_14[this.streamArgs.permission]=new _b(this.streamArgs);
this.userStream.refreshCallback=this.refreshCallback;
this.refreshTitle();
if(this.streamArgs.permission!=="Owner"&&_a.isValid(this.file,this.streamArgs.permission)){
this.shareAction=_a.create(this.streamArgs);
this.shareAction.placeAt(this.content);
this.shareAction.on("_add",_7.hitch(this,this.addUser));
}
this.userStream.placeAt(this.content);
},addUser:function(_18){
var _19=this.getExistingEntry(_18),_1a=true;
if(!_19){
_18.create().then(_7.hitch(this,function(){
this.factory.addItem(_18);
if(_18.type==="community"||_18.type==="everyone"){
this.refreshCallback(_18,_1a);
}else{
_13[this.streamArgs.permission].push(_18);
this.userStream.addItem(_18);
this.refreshTitle();
}
_e.publish("ic-fileviewer/push/messages",{type:"success",message:_d.substitute(this.nls.SHARE_SUCCESS.SUCCESS,{user:_18.name}),cancelable:true});
}),_7.hitch(this,this._handleError,_18));
}else{
if(_15[_18.permission]>_15[_19.permission]){
_18.update().then(_7.hitch(this,function(){
_e.publish("ic-fileviewer/push/messages",{type:"info",message:_d.substitute(this.nls.SHARE_INFO.PROMOTED,{user:_18.name}),cancelable:true});
this.refreshCallback(_18,_1a);
}),_7.hitch(this,this._handleError,_18));
}else{
var _1b=_11.currentUser.id===_18.id?this.nls.SHARE_FAIL.SELF:_d.substitute(this.nls.SHARE_FAIL.EXISTING_USER,{user:_18.name});
_e.publish("ic-fileviewer/push/messages",{type:"warning",message:_1b,cancelable:true});
}
}
},getExistingEntry:function(_1c){
var _1d=false;
_9.some(_12,function(_1e){
_9.some(_14[_1e].filteredItems,function(_1f){
if(_1c.get("type")==="everyone"){
return (_1f.get("type")===_1c.get("type"));
}
if(_1c.get("type")==="user"){
if((_1f.get("id")===_1c.get("id"))){
_1d=_1f;
}
return (_1f.get("id")===_1c.get("id"));
}
if(_1c.get("type")==="community"){
if((_1f.get("communityUuid")===_1c.get("communityUuid"))){
_1d=_1f;
}
return (_1f.get("communityUuid")===_1c.get("communityUuid"));
}
},this);
},this);
return _1d;
},refreshTitle:function(){
var _20=this.nls.ROLES[this.userStream.permission.toUpperCase()];
if(_20!==this.nls.ROLES.OWNER){
_20=_d.substitute(this.nls.USERROLE,{userRole:_20,sharedUserCount:this.userStream.widgets.length});
}
_f.set(this.titleNode,"innerHTML",_20);
},removeEntryFromStream:function(_21,_22){
_22.removeItem(_21);
},_handleError:function(_23){
_e.publish("ic-fileviewer/push/messages",{type:"error",message:_d.substitute(this.nls.SHARE_FAIL.ERROR,{user:_23.name}),cancelable:true});
}}),_24=_1([_2,_3],{templateString:_4,constructor:function(_25){
this.groupArgs={file:_25.file,dataKey:"sharingFeed",entryConstructor:_25.entryConstructor,factory:_25.factory,refreshCallback:_7.hitch(this,this._onStreamRefresh)};
_7.mixin(this,_25);
this.titleWithCount=this.factory.get("titleWithCount");
},postCreate:function(){
if(this.factory._items){
this.renderUsers();
return;
}
if(this.file.get("libraryType")!=="personalFiles"){
this.renderCommunityAsOwner();
}else{
this.getSharedUsers();
}
},getSharedUsers:function(){
var _26={shareUsersPageSize:500};
this.clearItems();
var _27=new _8(),_28={type:"Owner",id:this.file.author.id,permission:"Owner",name:this.file.author.name};
this.factory._items=_27;
this.factory._feed=this.file.get(this.dataKey);
_13.Owner.push(this.factory._feed.newItem(_28));
all({shareLinksFeed:this.file.get("shareLinksFeed").fetch(_26),sharesFeed:this.factory._feed.fetch(_26)}).then(_7.hitch(this,function(_29){
_9.forEach(_29.shareLinksFeed,_7.hitch(this,function(_2a){
if(_2a.id===_11.currentUser.id){
this.file.set("myShares",_2a.targets);
}
}));
this._handleLoad(_29.sharesFeed);
_27.resolve(_29.sharesFeed);
}),function(_2b){
_27.reject(_2b);
});
return _27;
},filterResponse:function(_2c){
_9.forEach(_2c,_7.hitch(this,function(_2d){
_13[_2d.permission].push(_2d);
}));
},renderCommunityAsOwner:function(){
this.clearItems();
var _2e={type:"community",id:this.file.get("libraryId"),permission:"Owner",title:this.file.get("libraryTitle"),name:this.file.get("libraryTitle"),communityUuid:this.file.get("communityId")};
this.factory._feed=this.file.get(this.dataKey);
_13.Owner.push(this.factory._feed.newItem(_2e));
this.renderRole("Owner");
},renderUsers:function(){
_9.forEach(_12,_7.hitch(this,this.renderRole));
},renderRole:function(_2f){
this.groupArgs.filteredItems=_13[_2f];
this.groupArgs.permission=_2f;
var _30=new _16(this.groupArgs);
_10.after(this,"_refreshStreams",_7.hitch(_30,"refreshTitle"));
_30.placeAt(this[_2f+"Container"]);
},refresh:function(_31){
this.clearItems(_31);
this.refreshUsers(_31);
},_onStreamRefresh:function(_32,_33){
if(_32&&_32.type==="everyone"){
this.refreshPanel();
}else{
this.refresh(_33);
}
},refreshUsers:function(_34){
var _35={shareUsersPageSize:500};
var _36=new _8(),_37={type:"Owner",id:this.file.author.id,permission:"Owner",name:this.file.author.name};
this.factory._items=_36;
_13.Owner.push(this.factory._feed.newItem(_37));
all({shareLinksFeed:this.file.get("shareLinksFeed").refresh(_35),sharesFeed:this.factory._feed.refresh(_35)}).then(_7.hitch(this,function(_38){
_9.forEach(_38.shareLinksFeed,_7.hitch(this,function(_39){
if(_39.id===_11.currentUser.id){
this.file.set("myShares",_39.targets);
}
}));
this._handleLoad(_38.sharesFeed,_34);
_36.resolve(_38.sharesFeed);
}),function(_3a){
_36.reject(_3a);
});
return _36;
},_handleLoad:function(_3b,_3c){
if(_3c){
this._refreshStreams(_3b);
}else{
this._filterAndRender(_3b);
}
this.sharedWithUsers=_9.some(_3b,function(_3d){
return _3d.get("type")==="user";
});
},_filterAndRender:function(_3e){
this.factory.set("_items",_3e);
this.filterResponse(_3e);
this.renderUsers();
},_refreshStreams:function(_3f){
this.factory._items=_3f;
this.filterResponse(_3f);
_9.forEach(_12,_7.hitch(this,function(_40){
var _41=_14[_40];
_41.filteredItems=_13[_40];
_41.render(_13[_40]);
}));
},clearItems:function(_42){
this.resetFilteredItems();
if(_42){
_9.forEach(_12,_7.hitch(this,function(_43){
var _44=_14[_43];
_6.empty(_44.content);
_44.clearItems();
}));
}else{
_9.forEach(_12,_7.hitch(this,function(_45){
_6.empty(this[_45+"Container"]);
}));
}
},resetFilteredItems:function(){
_13={Owner:[],Edit:[],View:[],Folder:[]};
},updateTitle:function(_46){
this.factory.set("title",_d.substitute(this.titleWithCount,[_46||this.factory.getTotalEntries()]));
}});
return _24;
});


;define("dojo/text!ic-share/fileviewer/panels/templates/SharingPanel.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-sharing-panel">\n  <div class="sharingMsg communityShareMsg" data-dojo-attach-point="communityShareMsg">${nls.COMMUNITY_FILE} <br/></div>\n  <div data-dojo-attach-point="publicNoticeContainer"></div>\n  <div class="multiAddContainer" data-dojo-attach-point="multiAddContainer"></div>\n  <div data-dojo-attach-point="permissionsSharingContainer"></div>\n  <div data-dojo-attach-point="folderSharingContainer" class="viewer-folder-stream"></div>\n  <div class="shareLinks" data-dojo-attach-point="shareLinksContainer"></div>\n</div>\n');

;define("ic-share/fileviewer/panels/ShareLinkWidget",["dojo/_base/declare","./EntryWidget","dojo/_base/array","dojo/dom-construct","dojo/i18n!../nls/FileViewerStrings","../config/globals","../util/html"],function(_1,_2,_3,_4,_5,_6,_7){
return _1([_2],{postMixInProperties:function(){
this.nls=_5.SHARE_LINK;
this.baseClass="shareLink";
this.baseClasses="";
this.usernameMaxWidth=230;
},postCreate:function(){
if(this.entry.get("id")===_6.currentUser.id){
_7.appendText(this.h1Node,this.nls.MY_SHARES);
}else{
this.setUserName(this.entry,this.h1Node);
}
var _8=_4.create("ul",{});
_3.forEach(this.entry.get("targets"),function(_9){
var _a=_4.create("li",{className:"targetUser"},_8);
this.setUserName(_9,_a);
},this);
this.contentContainer.appendChild(_8);
}});
});


;define("dojo/text!ic-share/fileviewer/widget/templates/ShareFolder.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div>\n	<div class="${id}_title shareFolderTitle" data-dojo-attach-point="titleNode">${title}</div>\n    <div data-dojo-attach-point="noneShareContent">${nls.NO_SHARE}<br>\n    </div>\n    <div data-dojo-attach-point="oneShareContent">${nls.ONE_SHARE}<br>\n    </div>\n    <div data-dojo-attach-point="multipleShareContent">\n    </div>\n	<div class="panelContent" data-dojo-attach-point="shareActionContainer"></div>\n    <div class="panelContent" data-dojo-attach-point="content"></div>\n</div>\n');

;define("ic-share/fileviewer/widget/ShareFolder",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/ShareFolder.html","../panels/Stream","../action/ShareAction","../config/globals","dojo/i18n!../nls/FileViewerStrings","dojo/_base/lang","dojo/_base/config","dojo/string","dojo/Deferred","dojo/_base/array","dojo/dom-construct","dojo/Stateful","dojo/aspect","../data/util/routes","../network/request","../bean/FileAdapter","dojo/dom-style","dojo/dom-attr","dojo/has"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,has){
return _1([_2,_3,_f],{templateString:_4,constructor:function(_16){
this.nls=_8.PANEL.SHARING;
if(!this.nls.NO_SHARE){
this.nls.NO_SHARE="This file has not been added to any folders yet.";
this.nls.ONE_SHARE="This file is in 1 folder or community you do not have access to.";
this.nls.MULTIPLE_SHARE="This file is in ${fileNumber} folders or communities you do not have access to.";
}
this.titleWithCount=this.nls.SHARED_WITH_FOLDERS;
this.title=_b.substitute(this.titleWithCount,{count:0});
this.multipleShareSpan=undefined;
_9.mixin(this,_16);
this.factoryTitle=this.factory.get("titleWithCount");
this.moveFolder=false;
this.handler=this.factory.watch("_folders",_9.hitch(this,function(_17,_18,_19){
this.moveFolder=(_19.length>0&&this.file.get("libraryType")==="communityFiles");
this._addShareAction();
}));
},postMixInProperties:function(){
this.blank=_a.blankGif||dijit._WidgetBase.prototype._blankGif;
if(!this.nls.NO_SHARE){
this.nls.NO_SHARE="This file has not been added to any folders yet.";
}
if(!this.nls.ONE_SHARE){
this.nls.ONE_SHARE="This file is in 1 folder or community you do not have access to.";
}
if(!this.nls.MULTIPLE_SHARE){
this.nls.MULTIPLE_SHARE="This file is in ${fileNumber} folders or communities you do not have access to.";
}
},postCreate:function(){
if(this.factory._folders){
this.renderFolders();
return;
}
_14.set(this.domNode,"display","none");
this.getSharedFolders();
},_addShareAction:function(){
if(this.shareAction){
this.shareAction.destroy();
_e.empty(this.shareActionContainer);
}
this.file.get("permissions").canAddToFolder().then(_9.hitch(this,function(_1a){
if(!_1a){
return;
}
this.shareAction=_6.create({permission:"Folder",isFolderPicker:true,moveFolder:this.moveFolder,file:this.file});
this.shareAction.on("_addFolder",_9.hitch(this,this.openPicker));
this.shareAction.placeAt(this.shareActionContainer);
}));
},getSharedFolders:function(){
var _1b=new _c();
this.factory._folders=_1b;
this.file.get(this.dataKey).fetch().then(_9.hitch(this,function(_1c){
this.factory.set("_folders",_1c);
this.updateTitle();
this.renderFolders();
this.displaySharedMessage();
_1b.resolve(_1c);
}),function(_1d){
_1b.reject(_1d);
});
return _1b;
},renderFolders:function(){
this.folderStream=new _5({file:this.file,dataKey:this.dataKey,entryConstructor:this.entryConstructor,factory:this.factory,filteredItems:this.factory._folders,refreshCallback:_9.hitch(this,"refresh")});
this.folderStream.placeAt(this.content);
_14.set(this.domNode,"display","");
},displaySharedMessage:function(){
if(!!this.multipleShareSpan){
_e.destory(this.multipleShareSpan);
}
var _1e=this.file.get(this.dataKey).getNonVisibleCount();
if((_1e===0)&&(this.folderStream.get("filteredItems").length==0)){
_14.set(this.oneShareContent,"display","none");
_14.set(this.multipleShareContent,"display","none");
_14.set(this.noneShareContent,"display","");
}else{
if(_1e===1){
_14.set(this.noneShareContent,"display","none");
_14.set(this.oneShareContent,"display","");
_14.set(this.multipleShareContent,"display","none");
}else{
if(_1e>1){
var _1f=_b.substitute(this.nls.MULTIPLE_SHARE,{fileNumber:_1e});
var _20=this.multipleShareSpan=_e.create("span",{innerHTML:_1f});
_e.place(_20,this.multipleShareContent);
_14.set(this.noneShareContent,"display","none");
_14.set(this.oneShareContent,"display","none");
_14.set(this.multipleShareContent,"display","");
}else{
_14.set(this.oneShareContent,"display","none");
_14.set(this.multipleShareContent,"display","none");
_14.set(this.noneShareContent,"display","none");
}
}
}
},updateTitle:function(_21){
this.titleNode.innerHTML=_b.substitute(this.titleWithCount,{count:this.factory._folders.length});
},refresh:function(){
this.clearItems();
this._addShareAction();
var _22=new _c();
this.factory._folders=_22;
this.file.get(this.dataKey).refresh().then(_9.hitch(this,function(_23){
this.factory.set("_folders",_23);
this.updateTitle();
this.renderFolders();
this.displaySharedMessage();
_22.resolve(_23);
}),function(_24){
_22.reject(_24);
});
return _22;
},clearItems:function(){
delete this.factory._folders;
delete this.folderpicker;
_e.empty(this.shareActionContainer);
_e.empty(this.content);
},openPicker:function(){
if(!this.folderpicker){
this.app={nls:_7.pickerNLS,communityFolderEnabled:true,isAuthenticated:_7.pickerAuth.isAuthenticated,authenticatedUser:this.getAuthenticatedUser(),getAuthenticatedUser:this.getAuthenticatedUser,getAuthenticatedUserId:function(){
return _7.pickerAuth.getUser().id;
},routes:_11.getFilesAppRoutes(this.file),net:_7.network(),getUserPermissions:_9.hitch(this,"getUserPermission"),favorites:true,isNestedFolderEnabled:has("files-nested-folder")};
if(this.moveFolder){
this.folderpicker=_7.moveToCollection(this.app,null,this.getPickerOpts());
}else{
this.folderpicker=_7.addToCollection(this.app,null,this.getPickerOpts());
}
}
this.folderpicker.execute(this.getShareBean(this.file));
},getCommRoutesArgs:function(){
var _25={basePath:_11.getFilesBasePath(),disableAnonymous:_7.disableAnonymous,_form:_11.getFilesFormPath(),_cId:this.file.get("communityId"),getAuthenticatedUser:function(){
return _7.pickerAuth.getUser();
}};
return _25;
},getPickerOpts:function(){
var _26;
if(this.file.get("libraryType")==="communityFiles"){
_26={sourceSet:["thisCommunity"],singleSelection:true,community:{id:this.file.get("communityId"),name:window.ic_comm_communityName||this.file.get("libraryTitle")||""}};
}else{
_26={sourceSet:["personalFolders"],singleSelection:has("files-nested-folder"),community:{id:this.file.get("communityId")}};
}
_26.onSuccess=_9.hitch(this,function(_27,_28,_29,_2a){
var _2b="";
if(_29){
_2b="shared";
}else{
if(_2a){
_2b="public";
}
}
if(_2b){
this.file.set("visibility",_2b);
this.file.unmarkDirty();
}
if(_29||_2a){
this.refreshPanel();
}else{
this.refresh();
}
});
return _26;
},getShareBean:function(_2c){
if(!this.shareBean){
this.shareBean=_13(_2c);
}
return this.shareBean;
},getUserPermission:function(){
return {canShareWithPublic:function(){
return _7.policy["organizationPublic"];
}};
},getAuthenticatedUser:function(){
var _2d=_7.pickerAuth.getUser();
_2d.policy=_7.policy;
return _2d;
},destroy:function(){
this.handler.remove();
this.inherited(arguments);
}});
});


;define("dojo/text!ic-share/fileviewer/widget/templates/ShareOptions.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-share-options">\n   <div class="shareOptionsTitle">${title}</div>\n   <div class="panelContent propagation" data-dojo-attach-point="propContent">\n      <input type="checkbox" name="stopPropagation" checked="${defaultCheck}" data-dojo-attach-point="stopPropagation"><span>&nbsp;&nbsp;</span><span>${nls.PROPAGATION}</span><br>\n      <label data-dojo-attach-point="stopPropagationLabel" class="lotusOffScreen"></label>\n   </div>\n\n   <div data-dojo-attach-point="everyoneShareContent">\n      <span data-dojo-attach-point="everyoneShare">${nls.EVERYONE}</span><br>\n   </div>\n   \n   <div data-dojo-attach-point="ownerShareContent">\n      <span data-dojo-attach-point="ownerShare">${nls.OWNER_ONLY}</span><br>\n   </div>\n\n   <div class="panelContent stopShare" data-dojo-attach-point="stopShareContent">\n      <a href="javascript:;" data-dojo-attach-point="stopShare" data-dojo-attach-event="click:_showStopSharePrompt" role="button">${nls.STOP_SHARE}</a>\n   </div>\n\n   <div class="panelContent stopShare" data-dojo-attach-point="makeInternalContent">\n      <a href="javascript:;" data-dojo-attach-point="makeInternal" data-dojo-attach-event="click:_setupInternal" role="button">${nls.MAKE_INTERNAL}</a>\n   </div>\n</div>\n');

;define("ic-share/fileviewer/widget/ShareOptions",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/ShareOptions.html","dojo/i18n!../nls/FileViewerStrings","dojo/on","dojo/_base/lang","dojo/dom-style","dojo/when","dojo/topic","dojo/string","../config/globals","../dialog/ConfirmationDialog","../util/network","dijit/registry","dojo/dom-attr"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){
return _1([_2,_3],{templateString:_4,_totalRequests:0,postMixInProperties:function(){
this.nls=_5.SHARE_OPTIONS;
this.title=this.nls.TITLE;
this.canOthersShare=this.file.get("canOthersShare")||false;
this.defaultCheck=""+this.canOthersShare;
if(!this.nls.OWNER_ONLY){
this.nls.OWNER_ONLY="Only the owner can share this file.";
}
},postCreate:function(){
this.setOptionVisibility();
this.stopPropagation.checked=this.canOthersShare;
on(this.stopPropagation,"change",_6.hitch(this,"_togglePropagation"));
this.file.watch("visibility",_6.hitch(this,function(){
this.refresh();
}));
this.stopPropagation.id=_e.getUniqueId("fileviewer")+"_stopPropagationBox";
_f.set(this.stopPropagationLabel,"for",this.stopPropagation.id);
_f.set(this.stopPropagationLabel,"innerHTML",this.nls.PROPAGATION);
},_togglePropagation:function(){
if(!this.requestInProgress){
this.requestInProgress=true;
this.canOthersShare=!this.canOthersShare;
this.file.set("canOthersShare",this.canOthersShare);
this.file.update().then(_6.hitch(this,function(){
this.requestInProgress=false;
this.canOthersShare=this.file.get("canOthersShare");
this.stopPropagation.checked=this.canOthersShare;
this.refreshCallback();
}),_6.hitch(this,function(err){
this.requestInProgress=false;
}));
}
},_showStopSharePrompt:function(){
_8(_b.policy).then(_6.hitch(this,function(_10){
var _11;
if(!!_6.getObject("capabilities.canView.communities",false,_10)){
_11=this.file.get("visibility")==="public"?this.nls.MAKE_PRIVATE_DIALOG.QUESTION_PUBLIC:this.nls.MAKE_PRIVATE_DIALOG.QUESTION;
}else{
_11=this.file.get("visibility")==="public"?this.nls.MAKE_PRIVATE_DIALOG.QUESTION_PUBLIC_E:this.nls.MAKE_PRIVATE_DIALOG.QUESTION_E;
}
var _12=_6.clone(this.nls.MAKE_PRIVATE_DIALOG);
_12.PROMPT2=_11;
var _13=new _c({strings:_12});
_13.on("clicked",_6.hitch(this,this._stopShare,_13));
_13.render();
}));
},_stopShare:function(_14){
if(!this.requestInProgress){
this.requestInProgress=true;
this.file.stopSharing().then(_6.hitch(this,function(){
if(_14){
_14.onCancel();
}
this.requestInProgress=false;
this.refreshCallback();
_9.publish("ic-fileviewer/push/messages",{message:this.nls.MAKE_PRIVATE_SUCCESS,type:"success"});
}),_6.hitch(this,function(err){
this.requestInProgress=false;
if(_14){
_14.showError(_d.getErrorMessage(err,this.nls.MAKE_PRIVATE_ERROR));
}
}));
}
},_setupInternal:function(){
var _15=this.nls.MAKE_INTERNAL_DIALOG;
if(!_6.getObject("capabilities.canView.communities",false,_b.policy)){
_15=_15.EFSS||_15;
}
_15.PROMPT=_a.substitute(_15.PROMPT,{br:"<br>"});
var _16=new _c({strings:_15});
_16.render();
_16.on("clicked",_6.hitch(this,function(){
_16.onCancel();
this._makeInternal();
}));
},_makeInternal:function(){
this.file.set("isExternal",false);
this.file.update().then(_6.hitch(this,function(){
_9.publish("ic-fileviewer/push/messages",{type:"success",message:this.nls.MAKE_INTERNAL_SUCCESS,cancelable:true});
this.refreshCallback();
}));
},setOptionVisibility:function(){
var _17=false;
if(this.file.get("visibility")==="public"&&!_6.getObject("lconn.files.config.isCloudMode")){
_7.set(this.propContent,"display","none");
_7.set(this.ownerShareContent,"display","none");
_7.set(this.everyoneShareContent,"display","");
_17=true;
}else{
if(this.file.get("permissions").canGrantAccess()){
_7.set(this.propContent,"display","");
_7.set(this.ownerShareContent,"display","none");
_7.set(this.everyoneShareContent,"display","none");
_17=true;
}else{
if(!this.file.get("canOthersShare")){
_7.set(this.propContent,"display","none");
_7.set(this.ownerShareContent,"display","");
_7.set(this.everyoneShareContent,"display","none");
_17=true;
}else{
_7.set(this.domNode,"display","none");
_7.set(this.ownerShareContent,"display","none");
_7.set(this.everyoneShareContent,"display","none");
}
}
}
if(this.file.get("visibility")==="private"||!this.file.get("permissions").canGrantAccess()){
_7.set(this.stopShareContent,"display","none");
}else{
_7.set(this.stopShareContent,"display","");
_17=true;
}
_8(_b.policy).then(_6.hitch(this,function(_18){
if(_18.isExternalEnabled&&this.file.get("isExternal")&&this.file.get("permissions").canChangeSharingIntent()){
_7.set(this.makeInternalContent,"display","");
_17=true;
}else{
_7.set(this.makeInternalContent,"display","none");
}
if(!_17){
_7.set(this.domNode,"display","none");
}
}));
},refresh:function(){
this.setOptionVisibility();
}});
});


;define("ic-share/fileviewer/action/MultiShareAction",["dojo/_base/declare","./Action","dojo/dom-attr","dojo/string","dojo/_base/lang","dojo/topic","dojo/when","dojo/Evented","dojo/dom-style","dojo/dom-class","../dialog/SharingDialog","../widget/TypeAheadBox","dojo/i18n!../nls/FileViewerStrings","../config/globals","../data/util/routes","../network/request","dojo/io-query","dojo/on","../widget/EditBox","../util/validation","dojo/_base/array","dojo/Deferred","../dialog/ProvisionExternalUser","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,on,_12,_13,_14,_15,_16,_17){
"use strict";
var _18=_1([_2,_8],{"class":"ics-viewer-action ics-viewer-action-share ics-viewer-action-multiShare",_TypeAheadBox:_c,constructor:function(_19){
_5.mixin(this,_19);
this.isFolderPicker=_19.isFolderPicker;
this.preserveMessage="";
},postMixInProperties:function(){
this.messageNls=_d.SHARE;
this.nls=_d.SHARE.ACTION.MULTI;
if(_5.getObject("capabilities.canView.communities",false,_e.policy)){
this.name=this.title=this.nls.ADD||"Add People or Communities";
}else{
this.name=this.title=this.nls.ADD_PEOPLE||"Add People";
}
},postCreate:function(){
_3.set(this.altText,"innerHTML","");
},onLinkClicked:function(){
this.setupAdd();
_17.track("multiShare.open");
},setupAdd:function(_1a){
if(!this.typeaheadBox){
this.typeaheadBox=new this._TypeAheadBox({file:this.file,isMulti:true,showShadowText:true,filePermission:this.permission,sectionNode:this.domNode.parentNode,defaultRole:_1a});
if(this.panelDomNode){
_a.add(this.panelDomNode,"multiAdd-active");
}
if(!this.messageBox){
this.setupMessageBox();
}
this.typeaheadBox.messageBox=this.messageBox;
_9.set(this.messageBox.domNode,"display","none");
this.typeaheadBox.on("save",_5.hitch(this,this._add));
this.typeaheadBox.on("cancel",_5.hitch(this,this.resetTypeahead));
this.typeaheadBox.placeAt(this.domNode);
this.typeaheadBox.startup();
_9.set(this.link,"display","none");
}
_6.publish("ic-fileviewer/editStart",this,_5.hitch(this,function(){
return !_a.contains(this.messageBox.textBox,"hintText")||this.typeaheadBox.hasChanges();
}));
},setupMessageBox:function(){
this.messageBox=new _12();
this.messageBox.placeAt(this.typeaheadBox.optionalMsgLinkContainer,"after");
_a.add(this.messageBox.textBox,"transition");
this.messageBox.set("hintText",this.messageNls.MESSAGE_BOX.HINT_TEXT);
this.messageBox.set("value",this.messageBox.get("hintText"));
_a.add(this.messageBox.textBox,"hintText");
on(this.messageBox.textBox,"focus",_5.hitch(this,function(){
_a.remove(this.messageBox.textBox,"hintText");
if(this.messageBox.get("value")===this.messageBox.get("hintText")){
this.messageBox.set("value","");
}
}));
on(this.messageBox.textBox,"blur",_5.hitch(this,function(){
if(this.messageBox.get("value")===""){
this.preserveMessage="";
_a.add(this.messageBox.textBox,"hintText");
this.messageBox.set("value",this.messageBox.hintText);
}else{
this.preserveMessage=this.messageBox.get("value");
}
}));
},_add:function(e){
var _1b=!!e.everyone;
if(_1b){
this._addEveryone(e);
}else{
this._multiShare(e);
}
_17.track("multiShare.add");
},_addEveryone:function(e){
var _1c=this.file.get(this.dataKey).newItem({permission:"View",type:"everyone"});
_1c.create().then(_5.hitch(this,this.handleShare,_1c,undefined),_5.hitch(this,this.handleShare,_1c,undefined));
},_errorHandler:function(_1d){
if(_1d){
_6.publish("ic-fileviewer/push/messages",{type:"error",message:_4.substitute(_d.SHARE.SHARE_FAIL.ERROR,{user:_1d}),cancelable:true});
}
},_multiShare:function(_1e){
var _1f="",_20,_21,_22,_23;
if(this.messageBox.get("value")!==""&&this.messageBox.get("value")!==this.messageBox.get("hintText")){
_1f=this.messageBox.get("value");
}
_20=_1e.users;
_21=_1e.communities;
_22=_1e.emails;
_7(this.resolveEmails(_22),_5.hitch(this,function(_24){
_23=_20.concat(_21.concat(_24.resolved));
this.file.get(this.dataKey).createItem(_23,{summary:_1f}).then(_5.hitch(this,this.handleShare,_1e,_24),_5.hitch(this,this.handleShareError,_1e,_24));
}));
},resolveEmails:function(_25){
var _26=new _15(),_27=[],_28={},_29=[],_2a=[],_2b=_f.getFilesAppRoutes(this.file);
if(_25.length===0){
return _26.resolve({resolved:_29,unresolved:_2a});
}
_14.forEach(_25,function(_2c){
if(_2c.entry.get("email")){
_27.push(_2c.entry.get("email"));
_28[_2c.entry.get("email")]=_2c;
}
},this);
_10(_2b.getBulkEmailResolutionUrl(),{auth:{secured:false},method:"POST",headers:{"X-Method-Override":"GET"},postData:_11.objectToQuery({"email":_27}),handleAs:"json",noStatus:true}).then(_5.hitch(this,function(_2d,_2e){
if(_5.isArray(_2d.items)&&_2d.items.length>0){
_14.forEach(_2d.items,function(_2f,i){
if(_2f.id&&_28.hasOwnProperty(_27[i])){
_28[_27[i]].entry.set("id",_2f.id);
_29.push(_28[_27[i]]);
}else{
_2a.push(_28[_27[i]]);
}
},this);
_26.resolve({resolved:_29,unresolved:_2a});
}else{
_26.resolve({resolved:[],unresolved:_25});
}
}),_5.hitch(this,function(err){
_26.resolve({resolved:[],unresolved:_25});
}));
return _26;
},handleShareError:function(_30,_31,_32){
this.handleShare(_30,_31,_32);
},handleShare:function(_33,_34,_35){
this.resetTypeahead();
this.refreshPanel();
if(_34&&_34.unresolved&&_34.unresolved.length>0){
this.handleUnresolvedEmails(_34.unresolved);
}
if(_35 instanceof Error&&_35.code!=="Conflict"){
_6.publish("ic-fileviewer/push/messages",{type:"error",message:_d.ERROR,cancelable:true});
}else{
this._displaySuccessMessage(_33);
}
},handleUnresolvedEmails:function(_36){
var _37="";
_14.forEach(_36,function(_38){
_37+=_38.entry.get("name");
_37+=" ";
},this);
_7(_16.isValid(this.file)).then(_5.hitch(this,function(_39){
if(_39){
var _3a=[],_3b;
_14.forEach(_36,function(_3c){
_3b={email:_3c.entry.email};
if(_3c.entry.permission.toUpperCase()==="EDIT"){
_3b.role="EDITOR";
}else{
if(_3c.entry.permission.toUpperCase()==="VIEW"){
_3b.role="READER";
}
}
_3a.push(_3b);
},this);
this._renderProvisionExternalUserDialog(_3a,this.file);
}else{
this._errorHandler(_37);
}
}));
},_displaySuccessMessage:function(_3d){
},_renderProvisionExternalUserDialog:function(_3e,_3f){
var _40=new _16({users:_3e,file:_3f});
_40.on("error",_5.hitch(this,"_provisionExternalUserError"));
_40.placeAt(document.body);
_40.startup();
_40.show();
},_provisionExternalUserError:function(err){
_6.publish("ic-fileviewer/push/messages",{type:"error",message:err.message,cancelable:true});
},resetTypeahead:function(){
this.typeaheadBox.destroy();
this.typeaheadBox=undefined;
this.messageBox.destroy();
this.messageBox=undefined;
_9.set(this.link,"display","");
if(this.panelDomNode){
_a.remove(this.panelDomNode,"multiAdd-active");
}
_6.publish("ic-fileviewer/editStop",this);
}});
return {create:function(_41){
return new _18(_41);
},isValid:function(_42,_43){
if(_42.get("libraryType")==="communityFiles"){
return false;
}
return _42.get("permissions").canGrantAccessView()||_42.get("permissions").canGrantAccessEdit();
},getClassName:function(){
return "ics-viewer-action-share ics-viewer-action-multiShare";
}};
});


;define("ic-share/fileviewer/panels/SharingPanel",["dojo/_base/declare","dojo/_base/lang","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/SharingPanel.html","dojo/i18n!../nls/FileViewerStrings","./ShareLinkWidget","../section/ShareSection","./SharingWidget","./DropdownStream","../widget/ShareFolder","../widget/ShareOptions","../action/MultiShareAction","../config/globals","dojo/dom-style","./EntryWidget","dojo/string","dojo/_base/array","dojo/dom-construct","dojo/dom-class","dojo/topic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15){
"use strict";
var _16,_17;
return _1([_3,_4],{templateString:_5,postMixInProperties:function(){
this.nls=_6.PANEL.SHARING;
},postCreate:function(){
var _18=this;
_e.layer2().then(function(){
_18.file.get("fullEntry").then(function(){
_18.render();
});
});
},render:function(){
var _19,_1a;
if(this.file.get("libraryType")!=="personalFiles"){
_14.add(this.domNode,"community-file");
}
if(this.file.get("visibility")==="public"){
}
this.file.watch("visibility",_2.hitch(this,function(_1b,_1c,_1d){
_13.empty(this.publicNoticeContainer);
if(_1d==="public"){
}
}));
if(_d.isValid(this.file,{})){
var _1e=this.multiShare=_d.create({panelDomNode:this.domNode,file:this.file,dataKey:"sharingFeed",permission:"View",isMulti:true,refreshPanel:_2.hitch(this,this._refresh)});
_1e.placeAt(this.multiAddContainer);
}else{
_f.set(this.multiAddContainer,"display","none");
}
_19=this.shareSection=new _8({file:this.file,dataKey:"sharingFeed",entryConstructor:_9,factory:this.factory,refreshPanel:_2.hitch(this,this._refresh)});
_19.placeAt(this.permissionsSharingContainer);
_19.startup();
_1a=this._shareFolder=new _b({file:this.file,dataKey:"collectionSharingFeed",entryConstructor:_9,factory:this.factory,refreshPanel:_2.hitch(this,this._refresh)});
_1a.placeAt(this.folderSharingContainer);
if(this.file.get("libraryType")==="personalFiles"){
this._addShareLinksWidget();
}
if(this.file.get("libraryType")!=="communityFiles"){
this._shareOptions=new _c({file:this.file,factory:this.factory,refreshCallback:_2.hitch(this,this._refresh)});
this._shareOptions.placeAt(this.domNode);
this._shareOptions.startup();
}
if(_17){
_17.remove();
}
_17=_15.subscribe("ic-fileviewer/panel/share",_2.hitch(this,function(_1f){
if(_1f[0]==="multiShare"&&this.multiShare){
this.multiShare.setupAdd(_1f[1]);
}
}));
},_addPublicNotice:function(){
if(!_6.SHARE.PUBLIC){
return;
}
var _20=_6.SHARE.PUBLIC.LONG.GENERIC,_21;
if(this.file.get("orgName")){
_20=_11.substitute(_6.SHARE.PUBLIC.LONG.ORG,{org:this.file.get("orgName")});
}
_21=new _10({h1:_6.SHARE.PUBLIC.SHORT,h2:_20,baseClasses:"metadata metadata2"});
_21.set("header2Tooltip",_20);
_21.placeAt(this.publicNoticeContainer);
},_addShareLinksWidget:function(){
this._shareLinksWidget=new _a({entry:{h1:this.nls.SEE_WHO_HAS_SHARED},file:this.file,dataKey:"shareLinksFeed",entryConstructor:_7});
this._shareLinksWidget.placeAt(this.shareLinksContainer);
this._shareLinksWidget.startup();
if(this.shareSection.sharedWithUsers){
_f.set(this._shareLinksWidget.domNode,"display","");
}else{
_f.set(this._shareLinksWidget.domNode,"display","none");
}
if(_16){
_16.unwatch();
}
_16=this.factory.watch("_items",_2.hitch(this,function(_22,_23,_24){
if(_23!==_24){
this._setShareLinkVisibility(_24);
this._shareLinksWidget.reset();
}
}));
},_setShareLinkVisibility:function(_25){
var _26=_12.some(_25,function(_27){
return _27.get("type")==="user";
});
if(_26){
_f.set(this._shareLinksWidget.domNode,"display","");
}else{
_f.set(this._shareLinksWidget.domNode,"display","none");
}
},_refresh:function(){
if(this.shareSection){
this.shareSection.refresh();
}
if(this._shareFolder){
this._shareFolder.refresh();
}
if(this._shareOptions){
this._shareOptions.refresh();
}
}});
});


;define("ic-share/fileviewer/panels/SharingPanelFactory",["dojo/_base/declare","./Stream","./Panel","../action/ShareAction","dojo/Stateful","./SharingWidget","dojo/_base/lang","dojo/_base/array","dojo/dom-class","../section/ShareSection","dojo/i18n!../nls/FileViewerStrings","dojo/string","./SharingPanel","dojo/topic","dojo/when","../config/globals"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){
"use strict";
return _1([_5],{id:"share",urlParameterId:"share",actions:["restore","delete"],constructor:function(){
this.nls=_b.PANEL.SHARING;
this.title=this.nls.TITLE;
this.titleWithCount=this.nls.TITLE_WITH_COUNT;
_e.subscribe("ic-fileviewer/refresh",_7.hitch(this,function(){
delete this._items;
delete this._folders;
delete this._feed;
}));
},_panelGetter:function(){
return new _3({factory:this});
},renderContent:function(_11){
_f(_10.policy).then(_7.hitch(this,function(){
var _12=new _d({file:this.file,factory:this});
_12.placeAt(_11.content);
}));
},updateTitle:function(){
this.set("title",_c.substitute(this.titleWithCount,[this.getTotalEntries()]));
},getTotalEntries:function(_13){
var _14=0;
if(_7.isArray(this._items)){
_14+=this._items.length;
}
if(_7.isArray(this._folders)){
_14+=this._folders.length;
}
return _14;
},countItemsType:function(_15){
var _16=0;
if(_7.isArray(this._items)){
_8.forEach(this._items,function(_17){
if(_17.type===_15){
_16++;
}
});
}
return _16;
},countFoldersVisibility:function(_18){
var _19=0;
if(_7.isArray(this._folders)){
_8.forEach(this._folders,function(_1a){
if(_1a.visibility===_18){
_19++;
}
});
}
return _19;
},getTotalSharedEntries:function(){
return this.countItemsType("user")+this.countItemsType("community")+this.countFoldersVisibility("shared");
},getTotalPublicEntries:function(){
return this.countItemsType("everyone")+this.countFoldersVisibility("public");
},addItem:function(_1b){
if(_1b.type==="everyone"){
return;
}
var _1c=this.file.get("myShares")||[];
_1c.push(_1b);
this.file.set("myShares",_1c);
this._items.push(_1b);
var _1d=_7.clone(this.get("_items")||[]);
_1d.push(_1b);
this.set("_items",_1d);
},updateFileVisibility:function(){
var _1e="private";
if(this.getTotalPublicEntries()>0||this.file.get("visibility")==="public"){
_1e="public";
}else{
if(this.getTotalSharedEntries()>0){
_1e="shared";
}
}
if(this.file.get("visibility")!=_1e){
this.file.set("visibility",_1e);
this.file.unmarkDirty();
}
},__itemsSetter:function(_1f){
this._items=_1f;
this.updateFileVisibility();
},__foldersSetter:function(_20){
this._folders=_20;
this.updateFileVisibility();
}});
});


;define("dojo/text!ic-share/fileviewer/dialog/templates/VersionDialog.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="ics-dialog-action">\n	<div class="panelTitle" data-dojo-attach-point="titleNode"></div>\n   <div class="prompt-container" data-dojo-attach-point="promptContainer">${nls.PROMPT}</div>\n	<div class="panelContent deleteOption prompt-container" data-dojo-attach-point="content">\n		<input type="checkbox" name="deleteFrom" value="true" data-dojo-attach-point="deleteFromOption">${nls.DELETE_PRIOR}<br>\n	</div>\n	<div class="button-container">\n		<a class="confirm bad" href="javascript:;"\n			data-dojo-attach-event="onclick:clickLink" id="ok" role="button">${nls.OK}</a> \n			<a class="cancel neutral" href="javascript:;"\n			data-dojo-attach-event="onclick:clickLink" id="cancel" role="button">${nls.CANCEL}</a>\n	</div>\n</div>\n');

;define("ic-share/fileviewer/dialog/VersionDialog",["dojo/_base/declare","dojo/text!./templates/VersionDialog.html","dijit/Dialog","dojo/_base/lang","./DialogAction","dojo/Evented","dojo/i18n!../nls/FileViewerStrings","dojo/string","dojo/dom-attr","dijit/registry","dojo/dom-construct"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
return _1([_3,_6],{"class":"versionDialog",constructor:function(_c){
var _d,_e;
_d=_4.clone(_c.action==="remove"?_7.ACTION.DELETE_VERSION:_7.ACTION.RESTORE_VERSION);
_d.PROMPT=_8.substitute(_d.PROMPT,{version:_c.version});
_d.DELETE_PRIOR=_7.ACTION.DELETE_VERSION.DELETE_PRIOR;
_e=new _5({template:_2,nls:_d});
this.title=_7.ACTION.STOP_SHARING.DIALOG_TITLE;
_e.clickLink=_4.hitch(this,function(e){
var _f=this.content.deleteFromOption.checked;
if(e.target.id==="ok"){
this.emit("clicked",{deleteFrom:_f});
_b.destroy(this.containerNode.parentNode);
}
this.onCancel();
});
_e.startup();
this.content=_e;
if(_c.isLast){
this["class"]+=" ics-version-last";
}
},postCreate:function(){
this.inherited(arguments);
var _10=_a.getUniqueId("fileviewer")+"_versionDialogContent";
_9.set(this.domNode,"aria-label",this._get("title"));
_9.set(this.domNode,"aria-describedBy",_10);
_9.set(this.content.promptContainer,"id",_10);
},onCancel:function(){
this.emit("close");
this.inherited(arguments);
_b.destroy(this.containerNode.parentNode);
}});
});


;define("ic-share/fileviewer/panels/VersionWidget",["dojo/_base/declare","./EntryWidget","../preview/util","../dialog/VersionDialog","../config/globals","dojo/i18n!../nls/FileViewerStrings","dojo/dom-attr","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8){
return _1([_2],{postMixInProperties:function(){
this.baseClasses="version";
this.reloadItem=true;
this.DialogFactory=_4;
this.dialogArgs={version:this.entry.get("version"),isLast:false};
this.downloadLink=this.entry.get("downloadUrl")||"";
this.h1="<span class='versionNumber'>"+this.entry.get("version")+"</span>"+" ";
this.h2=this.formatDate(this.entry.get("dateModified"));
this.h3=_5.formatFileSize(parseInt(this.entry.get("size")));
this.content="";
this.footer=this.entry.get("summary");
this.restoreTooltip=_6.ACTION.RESTORE_VERSION.TOOLTIP;
this.removeTooltip=_6.ACTION.DELETE_VERSION.TOOLTIP;
this.downloadTooltip=_6.ACTION.DOWNLOAD_VERSION.TOOLTIP;
this.usernameMaxWidth=225;
},download:function(){
if(!_3.isPreviewSafe(this.file)){
_7.set(this.link,"target","_blank");
}else{
_7.remove(this.link,"target");
}
_8.track("download");
},postCreate:function(){
this.inherited(arguments);
this.setUserName(this.entry.get("author"),this.h1Node);
},onEventSuccess:function(_9,_a){
this.inherited(arguments);
this.file.update();
},_setIsLastAttr:function(_b){
this.dialogArgs.isLast=_b;
}});
});


;define("dojo/text!ic-share/fileviewer/widget/templates/NewVersionWidget.html", '<!-- Copyright IBM Corp. 2016  All Rights Reserved.                    -->\n<div class="ics-newversionwidget-container">\n   <form method="post" enctype="multipart/form-data" data-dojo-attach-point="form" data-dojo-attach-event="reset:_onReset">\n   <label data-dojo-attach-point="uploadNodeLabel" class="lotusOffScreen"></label>\n      <input type="file" name="file" data-dojo-attach-point="formFile" data-dojo-attach-event="onchange:_onSelected" aria-required="true"><br>\n      <textarea class="lotusHidden" name="changeSummary" data-dojo-attach-point="formChangeSummary"></textarea>\n      <input type="hidden" name="nonce" data-dojo-attach-point="nonce">\n      <input type="hidden" name="label" data-dojo-attach-point="label">\n      <input type="hidden" name="title" data-dojo-attach-point="title">\n   <div data-dojo-attach-point="changeSummary"></div>\n   <ul class="ics-viewer-inlineList">\n      <li class="ics-viewer-first">\n         <a href="javascript:;" class="ics-viewer-upload-submit" data-dojo-attach-point="upload" data-dojo-attach-event="onclick:_onSubmit" role="button" tabindex="-1" aria-disabled="true">${nls.UPLOAD}</a>\n      </li>\n      <li>\n         <a href="javascript:;" data-dojo-attach-point="cancel" data-dojo-attach-event="onclick:_onCancel" role="button">${nls.CANCEL}</a>\n      </li>\n   </ul>\n   </form>\n   <div data-dojo-attach-point="uploadingVersionDiv" class="lotusHidden" style="height: 120px; position: relative;">\n      <div data-dojo-attach-point="versionEntry" class="ics-viewer-version-uploading"></div>\n      <div class="ics-viewer-upload-cancel" tabindex="0" title="${nls.CANCEL_UPLOAD}" role="button" data-dojo-attach-event="onkeydown:cancelUpload, onclick:cancelUpload">\n         <span class="lotusAltText">${nls.CANCEL_UPLOAD}</span>\n      </div>\n   </div>\n\n</div>');

;define("ic-share/fileviewer/widget/UploadingVersionWidget",["dojo/_base/declare","../panels/EntryWidget","../preview/util","../dialog/VersionDialog","../config/globals","dojo/i18n!../nls/FileViewerStrings","dojo/_base/lang"],function(_1,_2,_3,_4,_5,_6,_7){
return _1([_2],{postMixInProperties:function(){
this.baseClasses="version";
this.reloadItem=true;
this.DialogFactory=_4;
this.dialogArgs={version:this._getVersionNumber(this.currentFile),isLast:false};
this.h1="<span class='versionNumber'>"+this._getVersionNumber(this.currentFile)+"</span>"+" ";
this.h2=this.formatDate(new Date());
this.h3=_5.formatFileSize(parseInt(this.uploadFile.size));
this.content="";
this.footer="";
this.usernameMaxWidth=225;
},postCreate:function(){
this.inherited(arguments);
var _8=this._getCurrentUser(_5.currentUser);
this.setUserName(_8,this.h1Node);
},_getVersionNumber:function(_9){
return parseInt(_9.get("version"))+1;
},_getCurrentUser:function(_a){
var _b=_7.clone(_a);
_b.name=_a.displayName;
return _b;
}});
});


;define("dojo/text!dijit/templates/ProgressBar.html", '<div class="dijitProgressBar dijitProgressBarEmpty" role="progressbar"\n	><div  data-dojo-attach-point="internalProgress" class="dijitProgressBarFull"\n		><div class="dijitProgressBarTile" role="presentation"></div\n		><span style="visibility:hidden">&#160;</span\n	></div\n	><div data-dojo-attach-point="labelNode" class="dijitProgressBarLabel" id="${id}_label"></div\n	><span data-dojo-attach-point="indeterminateHighContrastImage"\n		   class="dijitInline dijitProgressBarIndeterminateHighContrastImage"></span\n></div>\n');

;define("dijit/ProgressBar",["require","dojo/_base/declare","dojo/dom-class","dojo/_base/lang","dojo/number","./_Widget","./_TemplatedMixin","dojo/text!./templates/ProgressBar.html"],function(_1,_2,_3,_4,_5,_6,_7,_8){
return _2("dijit.ProgressBar",[_6,_7],{progress:"0",value:"",maximum:100,places:0,indeterminate:false,label:"",name:"",templateString:_8,_indeterminateHighContrastImagePath:_1.toUrl("dijit/themes/a11y/indeterminate_progress.gif?etag=Z6uJWzG"),postMixInProperties:function(){
this.inherited(arguments);
if(!(this.params&&"value" in this.params)){
this.value=this.indeterminate?Infinity:this.progress;
}
},buildRendering:function(){
this.inherited(arguments);
this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());
this.update();
},_setDirAttr:function(_9){
var _a=_9.toLowerCase()=="rtl";
_3.toggle(this.domNode,"dijitProgressBarRtl",_a);
_3.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&_a);
this.inherited(arguments);
},update:function(_b){
_4.mixin(this,_b||{});
var _c=this.internalProgress,ap=this.domNode;
var _d=1;
if(this.indeterminate){
ap.removeAttribute("aria-valuenow");
}else{
if(String(this.progress).indexOf("%")!=-1){
_d=Math.min(parseFloat(this.progress)/100,1);
this.progress=_d*this.maximum;
}else{
this.progress=Math.min(this.progress,this.maximum);
_d=this.maximum?this.progress/this.maximum:0;
}
ap.setAttribute("aria-valuenow",this.progress);
}
ap.setAttribute("aria-labelledby",this.labelNode.id);
ap.setAttribute("aria-valuemin",0);
ap.setAttribute("aria-valuemax",this.maximum);
this.labelNode.innerHTML=this.report(_d);
_3.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);
_3.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());
_c.style.width=(_d*100)+"%";
this.onChange();
},_setValueAttr:function(v){
this._set("value",v);
if(v==Infinity){
this.update({indeterminate:true});
}else{
this.update({indeterminate:false,progress:v});
}
},_setLabelAttr:function(_e){
this._set("label",_e);
this.update();
},_setIndeterminateAttr:function(_f){
this._set("indeterminate",_f);
this.update();
},report:function(_10){
return this.label?this.label:(this.indeterminate?"&#160;":_5.format(_10,{type:"percent",places:this.places,locale:this.lang}));
},onChange:function(){
}});
});


;define("ic-share/fileviewer/widget/NewVersionWidget",["dojo/_base/declare","./UploadWidget","dojo/_base/lang","dojo/text!./templates/NewVersionWidget.html","dojo/dom-attr","dojo/dom-class","dojo/on","dojo/i18n!../nls/FileViewerStrings","./EditBox","../util/validation","dijit/registry","dijit/focus","./UploadingVersionWidget","dojo/dom-construct","dijit/ProgressBar","dojo/has","dojo/query","dojo/string","../config/globals"],function(_1,_2,_3,_4,_5,_6,on,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12){
var _13=_1([_2],{templateString:_4,postMixInProperties:function(){
this.nls=_7.UPLOAD_VERSION;
if(!this.nls.CANCEL_UPLOAD){
this.nls.CANCEL_UPLOAD="Cancel upload";
}
if(!this.nls.PROGRESS_BAR_TITLE){
this.nls.PROGRESS_BAR_TITLE="Uploading new version (${uploaded} of ${total} complete)";
}
},postCreate:function(){
this._disableButton(this.upload);
if(!this.preserveMessage){
this.preserveMessage="";
}
this.formFile.id=_a.getUniqueId("fileviewer")+"_versionTextBox";
_5.set(this.uploadNodeLabel,"for",this.formFile.id);
_5.set(this.uploadNodeLabel,"innerHTML",this.nls.LINK);
},setupMessageBox:function(){
if(this.expandableEditBox){
return;
}
var _14={widgetType:"versions"};
this.expandableEditBox=new _8(_14);
this.expandableEditBox.placeAt(this.changeSummary);
_6.add(this.expandableEditBox.textBox,"transition");
this.expandableEditBox.set("hintText",this.nls.CHANGE_SUMMARY);
if(this.preserveMessage===""){
this.expandableEditBox.set("value",this.expandableEditBox.get("hintText"));
_6.add(this.expandableEditBox.textBox,"hintText");
}else{
this.expandableEditBox.set("value",this.preserveMessage);
}
on(this.expandableEditBox.textBox,"focus",_3.hitch(this,function(){
_6.remove(this.expandableEditBox.textBox,"hintText");
if(this.expandableEditBox.get("value")===this.expandableEditBox.get("hintText")){
this.expandableEditBox.set("value","");
}
}));
on(this.expandableEditBox.textBox,"blur",_3.hitch(this,function(){
if(this.expandableEditBox.get("value")===""){
this.preserveMessage="";
_6.add(this.expandableEditBox.textBox,"hintText");
this.expandableEditBox.set("value",this.expandableEditBox.hintText);
}else{
this.preserveMessage=this.expandableEditBox.get("value");
}
}));
},validateFilename:function(_15,_16){
var _17=_13._breakFilename(this.file.get("name")),_18=_13._breakFilename(_15),_19;
if(_17.ext.toLowerCase()!==_18.ext.toLowerCase()){
_5.set(this.upload,"innerHTML",this.nls.UPLOAD_AND_CHANGE_EXTENSION);
_19=_17.base+"."+_18.ext;
}else{
_5.set(this.upload,"innerHTML",this.nls.UPLOAD);
_19=_17.base+"."+_17.ext;
}
_5.set(this.label,"value",_19);
_5.set(this.title,"value",_19);
_16();
},validateInput:function(_1a){
if(_9.validateDescription(this.expandableEditBox,{maxLength:1023})){
_1a();
}
},getUploadUrl:function(_1b){
var url="{entry}?sendNotification=true&createVersion=true&opId=replace%2C{fileId}%2C{newTimestamp}"+"&format=html&nonce={nonce}&X-Method-Override=PUT&If-Match={fileId}%3Amodified%3D{oldTimestamp}";
return _3.replace(url,{entry:this.file.get("entryUrl"),fileId:this.file.get("id"),oldTimestamp:this.file.get("dateModified").getTime(),newTimestamp:(new Date()).getTime(),nonce:_1b.nonce});
},_onSubmit:function(){
_5.set(this.formChangeSummary,"value",this.preserveMessage);
this.inherited(arguments);
if(_f("fileviewer-multiphase-upload")){
this.newVersionLink=_10(".ics-viewer-upload-new-version")[0];
this.newVersionSize=this.form.elements.file.files[0].size;
this._removeUploadForm();
this._createProgressBar();
}
},_createProgressBar:function(){
var _1c={currentFile:this.file,summary:this.preserveMessage,uploadFile:this.form.elements.file.files[0]};
this.uploadingVersionWidget=new _c(_1c);
_d.place(this.uploadingVersionWidget.domNode,this.versionEntry,"first");
_6.remove(this.uploadingVersionDiv,"lotusHidden");
var _1d=_d.create("div");
this.progressBar=new _e({},this.progressDiv);
this.progressBarHandle=this.on("_progressUpdate",_3.hitch(this,this._updateProgressBar,this.progressBar));
this.on("error",_3.hitch(this,this._resetPanelUI));
this.progressBar.placeAt(this.uploadingVersionWidget.domNode);
this._setProgressBarTitle(this.progressBar,0);
},_disconnectListeners:function(){
this.progressBar.destroy();
this.uploadingVersionWidget.destroy();
this.progressBarHandle.remove();
},_resetPanelUI:function(_1e){
this._disconnectListeners();
if(_1e){
_6.add(this.uploadingVersionDiv,"lotusHidden");
this._onCancel();
this._enableButton(this.cancel);
}else{
_6.add(this.newVersionLink,"lotusHidden");
_6.remove(this.form,"lotusHidden");
this._enableButton(this.upload);
}
},_removeUploadForm:function(){
_6.add(this.form,"lotusHidden");
_6.remove(this.newVersionLink,"lotusHidden");
this._disableButton(this.newVersionLink);
},_updateProgressBar:function(_1f,_20){
var _21=this._getPercentCompleted(this.newVersionSize,_20);
_1f.set({value:_21});
this._setProgressBarTitle(_1f,_20);
},_setProgressBarTitle:function(_22,_23){
var _24=_12.formatFileSize(parseInt(_23));
var _25=_12.formatFileSize(parseInt(this.newVersionSize));
var _26=_11.substitute(this.nls.PROGRESS_BAR_TITLE,{uploaded:_24,total:_25});
_22.set({title:_26});
},_getPercentCompleted:function(_27,_28){
return Math.floor(100*(_28/_27));
},_onUploaded:function(){
if(this.expandableEditBox){
this.expandableEditBox.destroy();
this.expandableEditBox=undefined;
}
this.preserveMessage="";
this.inherited(arguments);
},_onCancel:function(){
_5.set(this.upload,"innerHTML",this.nls.UPLOAD);
if(this.expandableEditBox){
this.expandableEditBox.destroy();
this.expandableEditBox=undefined;
}
this.preserveMessage="";
this.inherited(arguments);
if(this.newVersionLink){
this._enableButton(this.newVersionLink);
}
},hasChanges:function(){
return this.inherited(arguments)||!_6.contains(this.expandableEditBox.textBox,"hintText");
},show:function(){
this.inherited(arguments);
this.focus();
},focus:function(){
setTimeout(_3.hitch(this,function(){
_b.focus(this.formFile);
}),20);
}});
_13.isValid=function(_29){
return _29.get("permissions").canEdit();
};
_13._breakFilename=function(_2a){
var _2b=_2a.lastIndexOf(".");
if(_2b===-1){
_2b=_2a.length;
}
return {base:_2a.slice(0,_2b),ext:_2a.slice(_2b+1)};
};
return _13;
});


;define("ic-share/fileviewer/panels/VersionPanelFactory",["dojo/_base/declare","./Stream","./Panel","dojo/Stateful","./VersionWidget","dojo/_base/lang","dojo/dom-class","../data/util/routes","../bean/FileAdapter","../config/globals","dojo/i18n!../nls/FileViewerStrings","../util/ibmDocs","../widget/NewVersionWidget","../sbw/StatefulBackedTemplatedWidget","dojo/topic","dojo/dom-construct","dojo/on","dojo/_base/array","dojo/date","../util/fidoNewRelic","dojo/dom-attr"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,on,_11,_12,_13,_14){
var _15;
var _16=_1([_e],{templateString:"<div data-sbw-bind=\"permissions:style=display!_getDisplayStyle\"></div>",postMixInProperties:function(){
this.model=this.file;
},postCreate:function(){
this.inherited(arguments);
this._renderUploadNewVersionLink();
if(_15){
_15.remove();
}
_15=_f.subscribe("ic-fileviewer/panel/version",_6.hitch(this,function(){
_11.every(arguments,_6.hitch(this,function(_17){
var _18="";
if(_17[0]==="showNewVersionWidget"){
_18="showNewVersionWidget";
this._showNewVersionWidget();
}
if(_17.length>1&&_18!=""){
_f.publish("ic-fileviewer/panel/version/"+_18,_17.slice(1));
}
}));
}));
},_renderUploadNewVersionLink:function(){
this.newVersionContainer=_10.create("div",{style:"margin-bottom: 20px;"});
this.newVersionWidget=new _d({file:this.file});
this.newVersionLink=_10.create("a",{href:"javascript:;",role:"button",innerHTML:_b.UPLOAD_VERSION.LINK,className:"ics-viewer-upload-new-version"});
_10.place(this.newVersionLink,this.newVersionContainer);
this.newVersionWidget.placeAt(this.newVersionContainer);
this.newVersionWidget.hide();
on(this.newVersionLink,"click",_6.hitch(this,"_showNewVersionWidget"));
this.newVersionWidget.on("cancel",_6.hitch(this,"_hideNewVersionWidget"));
this.newVersionWidget.on("uploaded",_6.hitch(this,"_newVersionUploaded"));
this.newVersionWidget.on("error",_6.hitch(this,"_newVersionError"));
_10.place(this.newVersionContainer,this.domNode);
},_showNewVersionWidget:function(){
if(_14.has(this.newVersionLink,"disabled")){
return;
}
_7.add(this.newVersionLink,"lotusHidden");
_7.remove(this.newVersionWidget.form,"lotusHidden");
this.newVersionWidget.show();
this.newVersionWidget.setupMessageBox();
_13.track("uploadNewVersion");
},_hideNewVersionWidget:function(){
_7.remove(this.newVersionLink,"lotusHidden");
this.newVersionWidget.hide();
},_newVersionUploaded:function(evt){
this._hideNewVersionWidget();
this.emit("uploaded",evt);
},_newVersionError:function(err){
this.emit("error",err);
},_getDisplayStyle:function(_19){
return _19.canEdit()?"inherit":"none";
},onuploaded:function(){
return;
}});
return _1([_4],{id:"version",urlParameterId:"versions",actions:["restore","delete","download"],constructor:function(){
this.nls=_b.PANEL.VERSIONS;
this.title=this.nls.TITLE;
this.titleWithCount=this.nls.TITLE_WITH_COUNT;
this.hideTitleCount=true;
},_panelGetter:function(){
return new _3({factory:this});
},renderContent:function(_1a){
var _1b=new _2({file:this.file,dataKey:"versionFeed",entryConstructor:_5,factory:this,isActionValid:_6.hitch(this,"_isActionValid",this.file),requireFullFileEntry:true});
var _1c=new _16({file:this.file});
_1c.startup();
_1c.placeAt(_1a.content);
_1c.on("uploaded",_6.hitch(this,function(evt){
_f.publish("ic-fileviewer/dirty");
_f.publish("ic-fileviewer/refresh");
_f.publish("ic-fileviewer/push/messages",{type:"success",message:evt.message,cancelable:true});
}));
_1c.on("error",function(err){
_f.publish("ic-fileviewer/push/messages",{type:"error",message:err.message,cancelable:true});
});
_1b.placeAt(_1a.content);
var _1d=_9(this.file);
var _1e=_8.getVersionListServiceUrl(this.file,{isPersonalFilesInCommunity:_1d.isPersonalFilesInCommunity(this.file.get("location")),basicAuth:true,anonymous:_1d.isPublic(),nonPersonal:true});
_1a.set("feedLink",_1e);
_1a.set("feedLinkTitle",this.nls.FEED_TITLE);
_1a.set("feedText",this.nls.FEED_LINK);
_1a.set("feedDivClasses","panelContent panelFeed");
},_isActionValid:function(_1f,_20,_21){
if(_20==="download"){
return true;
}
if(_1f.get("version")===_21.entry.get("version")){
return false;
}
var _22=_21.entry.get("permissions"),_23=_c.isDocsFile(_1f);
if(_20==="restore"){
return (!_23||(_23&&_c.isRestoreEnabled()))&&this.file.get("permissions").canEdit();
}else{
if(_20==="delete"){
return _22.Delete;
}
}
return false;
}});
});


;define("ic-share/fileviewer/panels/factories",["dojo/has","./AboutPanelFactory","./CommentsPanelFactory","./SharingPanelFactory","./VersionPanelFactory","../util/feature"],function(_1,_2,_3,_4,_5,_6){
"use strict";
if(_6.isTextNavEnabled()){
return [_3,_4,_5,_2];
}
return [_2,_3,_4,_5];
});


;define("dojox/collections/_base",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],function(_1,_2,_3){
var _4=_2.getObject("dojox.collections",true);
_4.DictionaryEntry=function(k,v){
this.key=k;
this.value=v;
this.valueOf=function(){
return this.value;
};
this.toString=function(){
return String(this.value);
};
};
_4.Iterator=function(a){
var _5=0;
this.element=a[_5]||null;
this.atEnd=function(){
return (_5>=a.length);
};
this.get=function(){
if(this.atEnd()){
return null;
}
this.element=a[_5++];
return this.element;
};
this.map=function(fn,_6){
return _3.map(a,fn,_6);
};
this.reset=function(){
_5=0;
this.element=a[_5];
};
};
_4.DictionaryIterator=function(_7){
var a=[];
var _8={};
for(var p in _7){
if(!_8[p]){
a.push(_7[p]);
}
}
var _9=0;
this.element=a[_9]||null;
this.atEnd=function(){
return (_9>=a.length);
};
this.get=function(){
if(this.atEnd()){
return null;
}
this.element=a[_9++];
return this.element;
};
this.map=function(fn,_a){
return _3.map(a,fn,_a);
};
this.reset=function(){
_9=0;
this.element=a[_9];
};
};
return _4;
});


;define("dojox/collections/Dictionary",["dojo/_base/kernel","dojo/_base/array","./_base"],function(_1,_2,_3){
_3.Dictionary=function(_4){
var _5={};
this.count=0;
var _6={};
this.add=function(k,v){
var b=(k in _5);
_5[k]=new _3.DictionaryEntry(k,v);
if(!b){
this.count++;
}
};
this.clear=function(){
_5={};
this.count=0;
};
this.clone=function(){
return new _3.Dictionary(this);
};
this.contains=this.containsKey=function(k){
if(_6[k]){
return false;
}
return (_5[k]!=null);
};
this.containsValue=function(v){
var e=this.getIterator();
while(e.get()){
if(e.element.value==v){
return true;
}
}
return false;
};
this.entry=function(k){
return _5[k];
};
this.forEach=function(fn,_7){
var a=[];
for(var p in _5){
if(!_6[p]){
a.push(_5[p]);
}
}
_1.forEach(a,fn,_7);
};
this.getKeyList=function(){
return (this.getIterator()).map(function(_8){
return _8.key;
});
};
this.getValueList=function(){
return (this.getIterator()).map(function(_9){
return _9.value;
});
};
this.item=function(k){
if(k in _5){
return _5[k].valueOf();
}
return undefined;
};
this.getIterator=function(){
return new _3.DictionaryIterator(_5);
};
this.remove=function(k){
if(k in _5&&!_6[k]){
delete _5[k];
this.count--;
return true;
}
return false;
};
if(_4){
var e=_4.getIterator();
while(e.get()){
this.add(e.element.key,e.element.value);
}
}
};
return _3.Dictionary;
});


;define("ic-share/fileviewer/widget/DropDownMenuButton",["dojo/_base/declare","dijit/Toolbar","dijit/form/DropDownButton","dijit/MenuItem","dijit/DropDownMenu","dojo/_base/array","dojo/_base/lang","dojo/i18n!../nls/FileViewerStrings","dojo/dom-attr","dojo/query"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
var _b=_1([_2],{_subMenu:null,_popupMenu:null,_items:[],_menuItems:[],_currentItemGroupId:0,_currentItemGroupItemCount:0,constructor:function(_c){
_c=_c||{};
var _d=_c.subMenu||{};
_d.className="lconnContentTitleDropdownBody ics-viewer-dropdown-menu "+(_d.className||"");
this.nls=_c.nls||{};
this.showLabel=_c.showLabel;
this._subMenu=new _5(_d);
this._items=_c.items||[];
this._menuItems=[];
},postCreate:function(){
this.addMenuItems(this._items);
this.domNode.setAttribute("aria-labelledby",this.id);
this.title=this.nls.TITLE;
this._setupPopupMenu();
this.inherited(arguments);
this._removeToolbarRole();
},_removeToolbarRole:function(){
_9.remove(this.containerNode,"role");
var _e=_a(".dijitOffScreen",this.domNode);
_e.removeAttr("role");
},_setupPopupMenu:function(){
if(this._popupMenu){
this._popupMenu.destroy();
}
this._popupMenu=new _3({label:this.title,showLabel:this.showLabel,iconClass:this.getIconClassName(),dropDown:this._subMenu,_aroundNode:this._submenuAroundNode});
_7.getObject("_subMenu.domNode.style",true,this).marginTop=this.subMenuMarginTop||"8px";
this.setDropDownButtonTitle();
this.addChild(this._popupMenu);
},togglePopupMenu:function(){
if(this._popupMenu){
this._popupMenu.toggleDropDown();
}
},setDropDownButtonTitle:function(){
},addMenuItem:function(_f,_10,_11){
var _12=new _4(_7.mixin(_11,{label:_f.name||_f.title||_f.itemShortDesc,title:_f.title||"",action:_f}));
var _13=_f.groupId;
if(_10){
_12.onClick=_10;
}
if(_7.isFunction(_f.watch)){
_f.watch("name",function(_14,_15,_16){
_12.set("label",_16);
_12.set("title",_f.title);
});
}
this._addMenuItemToSubMenu(_12);
this._currentItemGroupItemCount++;
},_addMenuItemToSubMenu:function(_17){
this._subMenu.addChild(_17);
this._menuItems.push(_17);
},_removeMenuItemsFromSubMenu:function(){
for(var i=0;i<this._menuItems.length;i++){
this._subMenu.removeChild(this._menuItems[i]);
}
this._menuItems.splice(0,this._menuItems.length);
},addMenuItems:function(_18){
_6.forEach(_18,function(_19){
this.addMenuItem(_19);
},this);
},getClassName:function(_1a){
return "dropdown-menu";
},getIconClassName:function(_1b){
return this.getClassName()+"-icon";
},setSubmenuAroundNode:function(_1c){
this._popupMenu._aroundNode=_1c;
this._submenuAroundNode=_1c;
}});
return _b;
});


;define("ic-share/fileviewer/panels/PanelNav",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/PanelNavText.html","dojo/text!./templates/PanelNav.html","dojo/text!./templates/NavItem.html","dojo/text!./templates/NavItemText.html","dojo/_base/array","dojo/_base/config","dojo/on","dojo/dom-construct","dojo/dom-class","dojo/_base/lang","dojo/query","./factories","../config/globals","dojo/topic","dojo/has","dojox/collections/Dictionary","dojo/dom-attr","dojo/keys","../uiState","../widget/DropDownMenuButton","dojo/i18n!../nls/FileViewerStrings","dojo/dom-style","../util/text","dojo/html","../util/fidoNewRelic","../util/feature","dojo/sniff"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,on,_a,_b,_c,_d,_e,_f,_10,has,_11,_12,_13,_14,_15,_16,_17,_18,_19,_1a,_1b){
var _1c,_1d=18;
if(has("safari")<8){
_b.remove(document.documentElement,"fileviewer-panels-resize fileviewer-panels-textnav");
}
var _1e=_1([_2,_3],{refreshPanel:false,templateString:_1b.isTextNavEnabled()?_7:_6,postMixInProperties:function(){
this.blank=_9.blankGif||dijit._WidgetBase.prototype._blankGif;
this.itemId=this.factory.get("id");
this.urlParameterId=this.factory.get("urlParameterId");
this.id=this.factory.get("id");
this.itemShortDesc=this.factory.get("title")||"";
},postCreate:function(){
this.refreshHandle=_10.subscribe("ic-fileviewer/refresh",_c.hitch(this,function(){
this.refreshPanel=true;
}));
this._setTitle();
this._titleChangeHandle=this.factory.watch("title",_c.hitch(this,"_setTitle"));
},select:function(){
_1a.track("panelSelect",{"newPanel":this.itemId});
this.selectPanel(this);
},getPanel:function(_1f){
if(this._panel&&(this.refreshPanel||_1f)){
this.refreshPanel=false;
_a.destroy(this._panel.domNode);
this._panel.destroy();
delete this._panel;
}
if(!this._panel){
this._panel=this.factory.get("panel");
this._panel.placeAt(this.panelContainer);
this._panel.startup();
}
return this._panel;
},destroy:function(){
this.refreshHandle.remove();
this._titleChangeHandle.remove();
this.inherited(arguments);
},_setTitle:function(){
var _20=this.factory.get("title");
var _21=false;
if(_20.length>_1d){
var _22=_18.breakString(_20);
if(_22!==_20){
_20=_22;
_21=true;
}
}
if(this.anchor){
_19.set(this.anchor,_20);
if(_21){
_b.add(this.anchor,"wrapped");
}else{
_b.remove(this.anchor,"wrapped");
}
this.emit("titlechanged");
}
}});
return _1([_2,_3],{templateString:_1b.isTextNavEnabled()?_4:_5,postCreate:function(){
var _23;
this._factories={};
this._selected=null;
this.refreshPanel=false;
this.navItems=new _11();
if(_1c){
_1c.remove();
}
_1c=_10.subscribe("ic-fileviewer/selectpanel",_c.hitch(this,function(){
if(_14.get("panelSize")===window.VIEWER_PANELS_CLOSED_SIZE){
_14.set("panelSize",window.VIEWER_PANELS_MINIMUM_SIZE||385);
}
_8.forEach(arguments,_c.hitch(this,function(_24){
var _25=_24[0];
this.selectPanel(this.navItems.entry(_25).value);
if(_24.length>1){
_10.publish("ic-fileviewer/panel/"+_25,_24.slice(1));
}
}));
}));
_a.empty(this.container);
this.panelsArray=[];
var _26=0,_27;
_8.forEach(_e,function(_28){
var _29=new _28({file:this.file});
this._factories[_29.get("id")]=_29;
var _2a=new _1e({factory:_29,selectPanel:_c.hitch(this,this.selectPanel),panelContainer:this.container});
_2a.placeAt(this.tabList);
_2a.startup();
_2a.on("titlechanged",_c.hitch(this,"_insertMoreButton"));
_2a.panelIndex=_26;
this.panelsArray.push(_2a);
_26++;
var _2b=_2a.getPanel().domNode;
_2b.setAttribute("aria-labelledby",_2a.itemId);
_b.add(_2b,"lotusHidden");
this.navItems.add(_2a.itemId,_2a);
if(this.panelUrlParameterId&&_2a.urlParameterId===this.panelUrlParameterId){
_27=_2a.itemId;
}
},this);
this.refreshHandle=_10.subscribe("ic-fileviewer/refresh",_c.hitch(this,function(){
_23=this._selected;
this.refreshPanel=true;
this._selected=null;
this.selectPanel(_23);
}));
this.selectPanel(this.navItems.item(_27||_f.selectedId||"comments"));
this._listenForKeys(this.panelsArray);
if(_1b.isTextNavEnabled()){
this.panelWatch=_14.watch("panelSize",_c.hitch(this,function(){
setTimeout(_c.hitch(this,this._insertMoreButton),1);
}));
}
},startup:function(){
this.inherited(arguments);
var nls=_16.MORE_ACTIONS.PANELS;
if(!_16.MORE_ACTIONS.PANELS){
nls={TITLE:"More",A11Y:"Opens a drop-down menu with a list of hidden panels"};
}else{
nls.TITLE=_18.breakString(nls.TITLE);
}
this.dropDownMenuButton=new _15({nls:nls,showLabel:true,subMenuMarginTop:"16px"});
this._listenKeysOnMoreButton();
setTimeout(_c.hitch(this,this._insertMoreButton),1);
setTimeout(_c.hitch(this,this._insertMoreButton),1000);
},_insertMoreButton:function(){
var _2c,_2d=true;
if(this._getNumVisibleEntries(_2d)<this.panelsArray.length&&_14.get("panelSize")>window.VIEWER_PANELS_CLOSED_SIZE){
this.dropDownMenuButton.placeAt(this.moreButton);
_b.remove(this.moreButton,"moreButtonHide");
this._resizeTabsWidth();
_2c=this._getNumVisibleEntries();
this._populateDropDownMenu(_2c);
if(dojo.isIE){
_b.add(this.moreButton,"moreButtonDisplayIE");
}else{
_b.add(this.moreButton,"moreButtonDisplay");
}
}else{
_b.add(this.moreButton,"moreButtonHide");
}
this._selectMoreButton();
},_populateDropDownMenu:function(_2e){
var _2f=this.panelsArray.length;
this.dropDownMenuButton._removeMenuItemsFromSubMenu();
var _30=_2f-_2e;
for(var i=_2e;i<_2f;i++){
this.dropDownMenuButton.addMenuItem(this.panelsArray[i],_c.hitch(this.panelsArray[i],this.panelsArray[i].select));
}
},_resizeTabsWidth:function(){
var _31=this.moreButton.offsetWidth+_17.get(this.moreButton,"margin-left")+_17.get(this.moreButton,"margin-right");
var _32=this.panelNavDiv.offsetWidth-_31;
this.tabsTableDiv.style.width=_32+"px";
},_getNumVisibleEntries:function(_33){
if(this.panelsArray.length===0){
return 0;
}
if(_33){
this.tabsTableDiv.style.width=this.panelNavDiv.offsetWidth+"px";
}
var _34=this.panelsArray[0].domNode.offsetTop;
var _35=1;
for(var j=1;j<this.panelsArray.length;j++){
if(_34!==this.panelsArray[j].domNode.offsetTop){
return _35;
}
_35++;
}
return _35;
},_selectMoreButton:function(){
if(!this.moreButton){
return;
}
if(this._getNumVisibleEntries()<=this._selected.panelIndex){
_b.add(this.moreButton,"select");
this._selected.domNode.tabIndex=-1;
}else{
_b.remove(this.moreButton,"select");
this._adjustTabindex();
}
},_adjustTabindex:function(){
var _36=this._getNumVisibleEntries();
if(this._selected.panelIndex<_36||_36==this.panelsArray.length){
this._selected.domNode.tabIndex=0;
}
},_listenForKeys:function(_37){
on(this.domNode,"keydown",_c.hitch(this,function(evt){
switch(evt.keyCode){
case _13.RIGHT_ARROW:
case _13.LEFT_ARROW:
case _13.DOWN_ARROW:
case _13.UP_ARROW:
evt.stopPropagation();
evt.preventDefault();
this._switchTab(evt);
break;
}
}));
},_listenKeysOnMoreButton:function(){
var _38=_d(".dijitDownArrowButton",this.dropDownMenuButton.domNode)[0];
on(_38,"keydown",_c.hitch(this,function(evt){
if(evt.keyCode==_13.TAB&&evt.shiftKey){
if(this._getNumVisibleEntries()<=this._selected.panelIndex){
evt.stopPropagation();
evt.preventDefault();
this._switchTab(evt,_38);
}
}
}));
},_switchTab:function(evt,_39){
var _3a,_3b,_3c;
var _3d=this._getNumVisibleEntries()-1;
if(evt.keyCode==_13.TAB&&evt.shiftKey){
_3a=0;
}else{
var _3e=_8.filter(this.panelsArray,function(_3f){
return _3f.itemId==evt.target.id;
});
_3b=_3e[0].panelIndex;
if(evt.keyCode==_13.RIGHT_ARROW||evt.keyCode==_13.DOWN_ARROW){
_3a=(_3b==this.panelsArray.length-1)?0:_3b+1;
}
if(evt.keyCode==_13.LEFT_ARROW||evt.keyCode==_13.UP_ARROW){
_3a=(_3b==0)?this.panelsArray.length-1:_3b-1;
}
if(_3a>_3d){
if(_3b==0){
_3a=_3d;
}else{
_3a=0;
}
}
}
this.selectPanel(this.panelsArray[_3a]);
if(_3b==undefined){
_3c=_39;
}else{
_3c=this._getPanelLink(_3b,this.panelsArray);
}
_3c.blur();
var _40=this._getPanelLink(_3a,this.panelsArray);
_40.focus();
this._hidePanels(_3a,this.panelsArray);
},_getPanelLink:function(_41,_42){
return _42[_41].domNode;
},_hidePanels:function(_43,_44){
_8.forEach(_44,function(_45,i){
if(i!=_43){
var _46=this._getPanelLink(i,_44);
_46.tabIndex=-1;
_46.setAttribute("aria-selected","false");
}
},this);
},selectPanel:function(_47){
var id=_47.itemId,_48,_49;
if(!this._factories[id]||_47===this._selected){
return;
}else{
if(this._selected!==null){
_b.remove(this._selected.domNode,"selected");
}
}
_b.add(_47.domNode,"selected");
if(this._selected){
_b.add(this._selected.getPanel().domNode,"lotusHidden");
}
this._selected=_47;
_49=this._selected.getPanel(this.refreshPanel);
_b.remove(_49.domNode,"lotusHidden");
_49.render();
_f.selectedId=this._selected.itemId;
var _4a=_47.domNode;
_4a.setAttribute("aria-selected","true");
_4a.tabIndex=0;
var _4b=this._selected.getPanel().domNode;
_4b.setAttribute("aria-labelledby",this._selected.itemId);
this.refreshPanel=false;
var _4c=_8.filter(this.panelsArray,function(_4d){
return _4d.itemId==id;
});
var _4e=_4c[0].panelIndex;
this._hidePanels(_4e,this.panelsArray);
this._selectMoreButton();
_1a.setPanel(id);
if(id=="comments"){
_10.publish("ic-fileviewer/selectpanel",["comments"]);
}
},destroy:function(){
this.refreshHandle.remove();
this.inherited(arguments);
if(_1b.isTextNavEnabled()){
this.panelWatch.remove();
}
}});
});


;define("ic-share/fileviewer/bean/Bean",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Stateful","dojo/Deferred"],function(_1,_2,_3,_4,_5){
return _1([_4],{constructor:function(){
this._dirtyPromise=new _5();
this.resetChangedProperties();
},set:function(_6,_7,_8){
if(_7===undefined&&typeof _6!=="object"){
return;
}
if(_8===undefined){
_8=true;
}
if(_8&&typeof _6!=="object"){
this._oldValues[_6]=this.get(_6);
}
this.inherited(arguments);
},deleteProperty:function(_9){
delete this[_9];
delete this._oldValues[_9];
},hasPropertyChanged:function(_a){
return this._oldValues.hasOwnProperty(_a);
},resetChangedProperties:function(){
this._oldValues={};
},unmarkDirty:function(){
this._dirtyPromise.resolve();
this._dirtyPromise=new _5();
this.resetChangedProperties();
},cancelChanges:function(){
this.set(this._oldValues);
this.resetChangedProperties();
this._dirtyPromise=new _5();
},attachWatch:function(_b,_c){
_c(_b,undefined,this.get(_b));
return this.watch(_b,_c);
}});
});


;define("ic-share/fileviewer/bean/AtomBean",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","./Bean","../util/dom"],function(_1,_2,_3,_4,_5){
"use strict";
return _1([_4],{_xmlSetter:function(_6){
this.xml=_6;
var _7=_5.getFirstTag(_6,"notifications",_5.NS.TD);
var _8=_5.getChildTextNS(_6,"media",_5.NS.TD,_7);
var _9=_5.getChildTextNS(_6,"comment",_5.NS.TD,_7);
this.set({id:_5.getChildTextNS(_6,"uuid",_5.NS.TD),name:_5.getChildTextNS(_6,"label",_5.NS.TD),size:parseInt(_5.getLinkAttrByRel(_6,"enclosure","length")),totalSize:_5.getChildTextNS(_6,"totalMediaSize",_5.NS.TD),content:_5.getChildText(_6,"content"),summary:_5.getChildText(_6,"summary"),version:_5.getChildTextNS(_6,"versionLabel",_5.NS.TD),versionCount:_5.getChildTextNSScheme(_6,"rank",_5.NS.SNX,"versions"),commentCount:_5.getChildTextNSScheme(_6,"rank",_5.NS.SNX,"comment"),visibility:_5.getChildTextNS(_6,"visibility",_5.NS.TD),orgName:_5.getChildTextNS(_6,"orgName",_5.NS.SNX),author:_5.getUser(_6,"author"),modifier:_5.getUser(_6,"modifier",_5.NS.TD),dateCreated:_5.getChildDate(_6,"created"),dateModified:_5.getChildDate(_6,"modified"),canOthersShare:_5.getChildTextNS(_6,"propagation",_5.NS.TD)==="true",isEncrypted:_5.getChildTextNS(_6,"encrypt",_5.NS.SNX)==="true",isLocked:_5.getChildAttrNS(_6,"lock",_5.NS.TD,"type")!=="NONE",lock:this._getLock(_6),objectTypeId:_5.getChildTextNS(_6,"objectTypeId",_5.NS.TD),permissions:this._getPermissions(_6),tags:this._getTags(_6),entryUrl:_5.getLinkAttrByRel(_6,"self","href"),alternateUrl:_5.getLinkAttrByRel(_6,"alternate","href"),downloadUrl:_5.getLinkAttrByRel(_6,"enclosure","href"),thumbnailUrl:_5.getLinkAttrByRel(_6,"thumbnail","href"),recommendationUrl:_5.getLinkAttrByRel(_6,"recommendation","href"),isExternal:_5.getChildTextNS(_6,"isExternal",_5.NS.SNX)==="true",libraryType:_5.getChildTextNS(_6,"libraryType",_5.NS.TD),libraryId:_5.getChildTextNS(_6,"libraryId",_5.NS.TD),libraryAuthor:_5.getUser(_6,"libraryAuthor",_5.NS.TD),libraryTitle:_5.getChildTextNS(_6,"libraryTitle",_5.NS.TD),recommendations:parseInt(_5.getChildTextNSScheme(_6,"rank",_5.NS.SNX,"recommendations")),downloads:_5.getChildTextNSScheme(_6,"rank",_5.NS.SNX,"hit"),downloadsAnonymous:_5.getChildTextNSScheme(_6,"rank",_5.NS.SNX,"anonymous_hit"),mediaNotifications:_8?_8==="on":undefined,commentNotifications:_9?_9==="on":undefined,isSyncable:_5.getChildTextNS(_6,"isSyncable",_5.NS.TD)==="true",currentUserDownloadInfo:this._getCurrentUserDownloadInfo(_6),mimeType:_5.getLinkAttrByRel(_6,"enclosure","type")||this.get("mimeType"),reportUrl:_5.getLinkAttrByRel(_6,_5.NS.REPORT.LONG,"href"),status:_5.getChildAttributeNSScheme(_6,"category",_5.NS.STATUS,"term"),malwareScanState:_5.getChildTextNS(_6,"malwareScanState",_5.NS.TD)});
},_getPermissions:function(_a){
var _b={},_c;
_c=_5.getChildTextNS(_a,"permissions",_5.NS.TD);
if(_c){
_3.forEach(_c.split(", "),function(_d){
if(_d){
_b[_d]=true;
}
});
}
return _b;
},_getTags:function(_e){
var _f=[];
var _10=_5.getAllTags(_e,"category");
_3.forEach(_10,function(_11){
if(_11.getAttribute("scheme")==null){
_f.push(_11.getAttribute("term"));
}
});
if(_f.length===0){
return this.get("tags")||[];
}
return _f;
},_getLock:function(xml){
var _12=_5.getFirstTag(xml,"lock",_5.NS.TD);
return {user:_5.getUser(xml,"owner",_5.NS.TD,_12),date:_5.getChildDate(xml,"lockTime",_5.NS.TD,_12)};
},_getCurrentUserDownloadInfo:function(xml){
var _13={};
var _14=_5.getFirstTag(xml,"downloadInfo",_5.NS.TD);
_13.downloadedDate=_5.getChildDate(xml,"downloadedDate",_5.NS.TD,_14);
_13.versionUuid=_5.getChildTextNS(xml,"versionUuid",_5.NS.TD,_14);
_13.versionNumber=_5.getChildTextNS(xml,"versionNumber",_5.NS.TD,_14);
_13.hasDownloaded=!!_13.versionUuid;
return _13;
}});
});


;define("ic-share/fileviewer/bean/ModeratedBean",["dojo/_base/declare","../util/dom","../network/request","dojo/string","dojox/html/entities","dojo/_base/lang"],function(_1,_2,_3,_4,_5,_6){
return _1([],{flag:function(_7){
return this._request(this.get("reportUrl"),{method:"POST",handleAs:"xml",data:this._getPostBody(_7),headers:{"Content-Type":"application/atom+xml;charset=UTF-8"}}).then(_6.hitch(this,function(_8){
return _8;
}),_6.hitch(this,this._handleError));
},_getPostBody:function(_9){
var _a="<entry xmlns=\"http://www.w3.org/2005/Atom\">";
_a+="<in-ref-to xmlns=\"http://www.ibm.com/xmlns/prod/sn\" rel=\"http://www.ibm.com/xmlns/prod/sn/report-item\" "+"ref-item-type=\"${type}\" ref=\"${id}\"></in-ref-to>";
if(_9&&_9!=""){
_a+="<content>${summary}</content>";
}
_a+="</entry>";
return _4.substitute(_a,{type:this.moderatedBeanType,id:this.get("id"),summary:_5.encode(_9)});
},_request:function(_b,_c){
return _3(_b,_c);
},_handleError:function(_d){
return _d;
}});
});


;define("ic-share/fileviewer/bean/Comment",["dojo/_base/declare","../util/dom","./AtomBean","./ModeratedBean"],function(_1,_2,_3,_4){
return _1([_3,_4],{constructor:function(){
this.moderatedBeanType="comment";
},_contentSetter:function(_5){
this.content=_5;
return this._dirtyPromise;
}});
});


;define("ic-share/fileviewer/data/util/DomBuilder",["dojo/_base/declare","dojox/html/entities","../../util/dom"],function(_1,_2,_3){
"use strict";
function _4(_5,_6,_7,_8,_9){
var _a=_3.createElementNS(_5,_7,_8);
if(_9!==undefined&&_9!==null){
_9=""+_9;
}
if(_9){
_a.appendChild(_5.createTextNode(_9));
}
_6.appendChild(_a);
return _a;
};
return _1([],{getPostBody:function(_b){
var _c,_d;
_c=_3.newXmlDocument("entry",_3.NS.ATOM,[_3.NS.TD,_3.NS.SNX]);
_d=_c.documentElement;
if(_b.get("category")){
var _e=_4(_c,_d,"category",_3.NS.ATOM);
_e.setAttribute("term",_b.get("category"));
_e.setAttribute("label",_b.get("category"));
_e.setAttribute("scheme","tag:ibm.com,2006:td/type");
}
if(_b.hasPropertyChanged("canOthersShare")){
_4(_c,_d,"propagation",_3.NS.TD,_b.get("canOthersShare"));
}
if(_b.hasPropertyChanged("changeSummary")){
_4(_c,_d,"changeSummary",_3.NS.TD,_b.get("changeSummary"));
}
if(_b.hasPropertyChanged("versionUuid")){
_4(_c,_d,"versionUuid",_3.NS.TD,_b.get("versionUuid"));
}
if(_b.hasPropertyChanged("visibility")){
_4(_c,_d,"visibility",_3.NS.TD,_b.get("visibility"));
}
if(_b.hasPropertyChanged("isExternal")){
_4(_c,_d,"isExternal",_3.NS.SNX,_b.get("isExternal"));
}
if(_b.hasPropertyChanged("content")&&_b.get("mimeType")){
var _f=_4(_c,_d,"content",_3.NS.ATOM,_2.decode(_b.get("content")));
_f.setAttribute("type",_b.get("mimeType"));
}
if(_b.hasPropertyChanged("name")){
_4(_c,_d,"label",_3.NS.TD,_b.get("name"));
}
if(_b.hasPropertyChanged("summary")){
var _10=_4(_c,_d,"summary",_3.NS.ATOM,_b.get("summary"));
_10.setAttribute("type","text");
}
if(_b.hasPropertyChanged("mediaNotifications")||_b.hasPropertyChanged("commentNotifications")){
var _11=_4(_c,_d,"notifications",_3.NS.TD);
if(_b.hasPropertyChanged("mediaNotifications")){
_4(_c,_11,"media",_3.NS.TD,_b.get("mediaNotifications")?"on":"off");
}
if(_b.hasPropertyChanged("commentNotifications")){
_4(_c,_11,"comment",_3.NS.TD,_b.get("commentNotifications")?"on":"off");
}
}
return _3.serializeXMLDocument(_c);
}});
});


;define("ic-share/fileviewer/data/sources/fileLockSource",["dojo/request","../util/routes","dojo/Deferred"],function(_1,_2,_3){
"use strict";
function _4(_5,_6,_7){
var _8="/files/basic/api/nonce";
return _1(_8,{withCredentials:true}).then(function(_9){
var _a={"X-UPDATE-NONCE":_9};
if(!_6){
_a["X-METHOD-OVERRIDE"]="DELETE";
}
return _1(_2.getFileLockUrl(_5,_6),{method:"POST",withCredentials:true,headers:_a});
},_7);
};
return {save:function(_b,_c){
if(_b.hasPropertyChanged("isLocked")){
return _4(_b,_b.get("isLocked")?"HARD":"",_c);
}
}};
});


;define("ic-share/fileviewer/data/sources/MyFileSyncSource",["dojo/request","../util/routes"],function(_1,_2){
"use strict";
var _3="isSyncable";
var _4="syncing";
var _5="<?xml version=\"1.0\" encoding=\"UTF-8\"?><entry xmlns=\"http://www.w3.org/2005/Atom\"><category term=\"myfilesync\" label=\"myfilesync\" scheme=\"tag:ibm.com,2006:td/type\"/></entry>";
function _6(_7,_8,_9){
var _a=_2.getFilesNonceUrl();
return _1(_a,{withCredentials:true}).then(function(_b){
var _c="";
var _d="";
var _e={"X-UPDATE-NONCE":_b};
var _f={};
if(_8){
_c=_2.getFileFeedUrl(_7);
_d+=_5;
_e["Content-Type"]="application/atom+xml;charset=\"UTF-8\"";
}else{
_c=_2.getMyFileSyncUrl();
_f.itemId=_7.get("id");
_e["X-METHOD-OVERRIDE"]="DELETE";
}
return _1(_c,{method:"POST",withCredentials:true,headers:_e,query:_f,data:_d});
},_9);
};
return {save:function(_10,_11){
if(_10.hasPropertyChanged(_4)){
return _6(_10,!_10.get(_3),_11);
}
}};
});


;define("ic-share/fileviewer/data/FeedDataStore",["dojo/_base/declare","../network/request","dojo/Deferred","dojo/DeferredList","dojo/_base/lang","dojo/_base/array","dojo/query","dojo/string","../util/dom","./util/DomBuilder","./sources/fileLockSource","./sources/MyFileSyncSource","../util/network","dojo/i18n!../nls/FileViewerStrings","../config/globals","dojo/topic","../dialog/ConfirmationDialog"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11){
"use strict";
var _12=false;
return _1([],{_pageSize:10,_page:1,_hasNext:true,_feedHandleAs:"xml",_domBuilder:new _a(),_total:0,_response:undefined,EntryClass:undefined,constructor:function(_13){
_5.mixin(this,_13);
this._loadedItems={};
},_getPostBody:function(_14){
return this._domBuilder.getPostBody(_14);
},_getPutBody:function(_15){
return this._getPostBody(_15);
},fetch:function(_16){
return this._loadPage(_16);
},refresh:function(_17){
this._page=1;
this._hasNext=true;
this._loadedItems={};
return this.fetch(_17);
},next:function(){
if(!this._hasNext){
return new _3().reject();
}
this._page+=1;
return this._loadPage();
},_loadPage:function(_18){
_18=_18||{};
return this._request(this.url,{handleAs:this._feedHandleAs,withCredentials:true,query:this._getFeedQuery(_18),preventCache:true,_args:_18}).then(_5.hitch(this,this._handleFeedResponse),_5.hitch(this,this._handleError));
},_handleFeedResponse:function(_19){
this.setResponse(_19);
this._hasNext=this._getHasNext(_19);
this._total=this._getTotal(_19)||0;
var _1a=this._getItems(_19);
_1a=this._removeDuplicates(_1a);
_6.forEach(_1a,function(_1b){
_1b.unmarkDirty();
},this);
return _1a;
},_getItems:function(_1c){
var _1d=_6.map(this._getEntries(_1c),function(_1e){
var _1f;
if(this._feedHandleAs==="xml"){
_1f={xml:_1e};
}else{
_1f=_1e;
}
return this.newItem(_1f);
},this);
return _1d;
},_removeDuplicates:function(_20){
var _21,i;
for(i=_20.length-1;i>=0;i--){
_21=_20[i].get("id");
if(this._loadedItems[_21]){
_20.splice(i,1);
}else{
this._loadedItems[_21]=true;
}
}
return _20;
},setResponse:function(_22){
this._response=_22;
},getResponse:function(){
return this._response;
},_getHasNext:function(_23){
return !!_9.getLinkAttrByRel(_23,"next","href");
},hasNext:function(){
return this._hasNext;
},_getTotal:function(_24){
if(this._feedHandleAs==="xml"){
return _9.getChildTextNS(_24,"totalResults",_9.NS.OPENSEARCH);
}else{
return _24.totalSize;
}
},getTotal:function(){
return this._total;
},_getEntries:function(_25){
return _7("entry",_25);
},_getFeedQuery:function(){
return {};
},newItem:function(_26){
return this._newItem(_26);
},_newItem:function(_27){
_27=_5.mixin(_27,this._getNewItemProperties());
var _28=new this.EntryClass(_27);
_28.create=_5.hitch(this,this.createItem,_28);
_28.update=_5.hitch(this,this.updateItem,_28);
_28.remove=_5.hitch(this,this.deleteItem,_28);
_28.load=_5.hitch(this,this.loadItem,_28);
return _28;
},_getNewItemProperties:function(){
return {};
},createItem:function(_29,_2a){
_2a=_2a||{};
return this._request(this._getCreateUrl(_29,_2a),{method:"POST",handleAs:"xml",data:this._getPostBody(_29,_2a),headers:{"Content-Type":"application/atom+xml;charset=UTF-8"},query:this._getCreateQuery(_29,_2a),_args:_2a}).then(_5.hitch(this,function(_2b){
this._updateItemFromResponse(_29,_2b);
}),_5.hitch(this,this._handleError));
},_getCreateUrl:function(_2c,_2d){
return this.url;
},_getCreateQuery:function(_2e,_2f){
return {};
},deleteItem:function(_30,_31){
_31=_31||{};
return this._request(this._getDeleteUrl(_30,_31),{method:"POST",headers:{"Content-Type":"x-www-form-urlencoded;charset=UTF-8","X-Method-Override":"DELETE"},_args:_31}).then(null,_5.hitch(this,this._handleError));
},_getDeleteUrl:function(_32,_33){
return _32.get("entryUrl");
},updateItem:function(_34,_35){
_35=_35||{};
var _36,_37=[],_38,i;
_36=_5.hitch(this,"_onError",_34);
_37.push(_b.save(_34,_36));
_37.push(_c.save(_34,_36));
for(i=0;i<_37.length;i++){
if(!_37[i]){
_37[i]=new _3();
_37[i].resolve();
}
}
_38=new _4(_37);
return _38.then(_5.hitch(this,"_sendGenericSave",_34,_35,_36),_36);
},_sendGenericSave:function(_39,_3a,_3b){
return this._request(this._getUpdateUrl(_39,_3a),{method:"POST",handleAs:"xml",data:this._getPutBody(_39),headers:{"Content-Type":"application/atom+xml;charset=UTF-8","X-Method-Override":"PUT"},query:this._getUpdateQuery(_39,_3a),_args:_3a}).then(_5.hitch(this,function(_3c){
if(_3a.updateFromResponse!==false){
this._updateItemFromResponse(_39,_3c);
}
return _3c;
}),_3b);
},_onError:function(_3d,_3e){
_3d.cancelChanges();
return this._handleError(_3e);
},_getUpdateUrl:function(_3f,_40){
return _3f.get("entryUrl");
},_getUpdateQuery:function(_41,_42){
return {};
},loadItem:function(_43,_44){
_44=_44||{};
return this._requestItem(_43,_44).then(_5.hitch(this,function(_45){
this._updateItemFromResponse(_43,_45);
}),_5.hitch(this,this._handleError));
},_requestItem:function(_46,_47){
return this._request(this._getLoadUrl(_46,_47),{handleAs:"xml",_args:_47});
},_getLoadUrl:function(_48,_49){
return _48.get("entryUrl");
},_updateItemFromResponse:function(_4a,_4b){
if(!_5.isArray(_4a)){
_4a.set("xml",_4b);
_4a.unmarkDirty();
}
},_request:function(url,_4c){
return _2(url,_4c);
},_handleError:function(_4d){
if(_4d.status==401&&!_12){
this.timeOutDialog();
}
if(_4d.status==404&&!_12){
this.fileNotFoundDialog();
}
var _4e=new _3();
_4e.reject(_d.parseError(_4d));
return _4e;
},fileNotFoundDialog:function(){
var _4f=_e.NOTFOUND_FILE_DIALOG||{DIALOG_TITLE:"Error",PROMPT:"The file you have requested has been deleted or moved.",CANCEL:"OK"};
this.dialog=new _11({strings:_4f,hideOk:true});
this.dialog.on("clicked",_5.hitch(this,"_closeFile"));
this.dialog.on("close",_5.hitch(this,"_closeFile"));
this.dialog.placeAt(document.body);
this.dialog.startup();
this.dialog.show();
_12=true;
},_closeFile:function(){
_10.publish("ic-fileviewer/dirty");
_10.publish("ic-fileviewer/close");
_12=false;
},timeOutDialog:function(){
var _50=_5.getObject("lconn.core.DialogUtil");
if(_50){
var _51=_e.LOST_AUTHENTICATION_DIALOG;
var _52=_8.substitute(_51.PROMPT,{lineBreaks:"<br/><br/>"});
_50.prompt(_51.DIALOG_TITLE,_52,_51.OK,_51.CANCEL,function(_53){
if(_53){
_f.login();
}
_12=false;
});
_12=true;
}
}});
});


;define("ic-share/fileviewer/data/CommentFeedDataStore",["dojo/_base/declare","dojo/string","../bean/Comment","./FeedDataStore"],function(_1,_2,_3,_4){
return _1([_4],{EntryClass:_3,_getFeedQuery:function(){
return {sK:"published",sO:"desc",contentFormat:"html",category:"comment",page:this._page,pageSize:this._pageSize,acls:true};
},_getNewItemProperties:function(){
return {category:"comment",mimeType:"html"};
},_handleFeedResponse:function(){
var _5=this.inherited(arguments);
if(this.file){
this.file.set("commentCount",this.getTotal());
}
return _5;
}});
});


;define("ic-share/fileviewer/bean/Version",["dojo/_base/declare","../util/dom","./AtomBean"],function(_1,_2,_3){
"use strict";
return _1([_3],{});
});


;define("ic-share/fileviewer/data/VersionFeedDataStore",["dojo/_base/declare","dojo/_base/lang","dojo/string","../bean/Version","../util/url","./FeedDataStore","dojo/i18n!../nls/FileViewerStrings","../util/ModerationUtil"],function(_1,_2,_3,_4,_5,_6,_7,_8){
return _1([_6],{EntryClass:_4,_getFeedQuery:function(){
return {category:"version",acls:true,page:this._page,pageSize:this._pageSize};
},_getDeleteUrl:function(_9,_a){
if(_a.deleteFrom){
return _5.rewrite(this.url,{category:"version",deleteFrom:_9.get("version")});
}else{
return _9.get("entryUrl");
}
},_getUpdateUrl:function(){
return this.file.get("entryUrl");
},_newItem:function(){
var _b=this.inherited(arguments);
_b.restore=_2.hitch(this,this.restoreVersion,_b);
return _b;
},restoreVersion:function(_c,_d){
this.file.set({changeSummary:_3.substitute(_7.ACTION.RESTORE_VERSION.CHANGE_SUMMARY,{version:_c.get("version")}),versionUuid:_c.get("id")});
var _e=this.file.update();
_e.then(_2.hitch(this,function(){
this._checkModerationStatus(this.file);
this.file.deleteProperty("changeSummary");
this.file.deleteProperty("versionUuid");
}));
return _e;
},_checkModerationStatus:function(_f){
if(_8.isFileModerated(_f)){
_8.launchModerationDialog();
}
}});
});


;define("ic-share/fileviewer/data/FileEntryDataStore",["dojo/_base/declare","dojo/_base/lang","dojo/string","./FeedDataStore","../util/url","dojo/when"],function(_1,_2,_3,_4,_5,_6){
var _7=1000;
var _8=_1([_4],{postscript:function(){
this.inherited(arguments);
this.file.create=_2.hitch(this,this.createItem,this.file);
this.file.update=_2.hitch(this,this.updateItem,this.file);
this.file.remove=_2.hitch(this,this.deleteItem,this.file);
this.file.load=_2.hitch(this,this.loadItem,this.file);
},_requestItem:function(_9){
var _a=_8._cachedEntry,_b=_a.loadTime||0,_c=(new Date()).getTime();
if(_c-_b<_7&&_9.get("id")===_a.fileId){
return _6(_a.content);
}else{
return this.inherited(arguments);
}
},_getUpdateUrl:function(_d){
return this._getLoadUrl(_d);
},_getLoadUrl:function(_e){
var _f=this.inherited(arguments);
return _5.rewrite(_f,{acls:true,includeNotification:true,includePolicy:true,includeRecommendation:true,includeTags:true,includeLibraryInfo:true,includeDownloadInfo:true,inline:true,rank:true});
}});
_8._cachedEntry={};
return _8;
});


;define("ic-share/fileviewer/bean/DocumentUser",["dojo/_base/declare","./Bean"],function(_1,_2){
return _1([_2],{postscript:function(){
this.inherited(arguments);
var _3=this.get("collectionType");
if(_3){
if((_3==="community")||(_3==="all")){
this.set("type","community");
}else{
this.set("type","folder");
}
}
if(this.isCollection()){
var _4=this.get("sharePermission");
if(_4){
this.set("permission",_4);
}
}
},isCollection:function(){
var _5=this.get("type");
return _5==="community"||_5==="folder";
}});
});


;define("ic-share/fileviewer/data/SharingFeedDataStore",["dojo/_base/declare","dojo/string","dojo/_base/array","dojo/_base/lang","../bean/DocumentUser","../util/url","./FeedDataStore","./util/routes","dojo/topic","dojox/html/entities"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
return _1([_7],{_pageSize:100,_feedHandleAs:"json",EntryClass:_5,_getPostBody:function(_b,_c){
if(_4.isArray(_b)){
return this._getBulkPostBody(_b,_c);
}
var _d=_b.get("type");
var _e=_b.get("summary");
var _f;
if(_d==="user"){
_f="<feed xmlns=\"http://www.w3.org/2005/Atom\"><entry><category term=\"share\" label=\"share\" "+"scheme=\"tag:ibm.com,2006:td/type\"/><sharedWhat xmlns=\"urn:ibm.com/td\">${fileId}</sharedWhat><sharedWith "+"xmlns=\"urn:ibm.com/td\"><sharePermission>${permission}</sharePermission><user><userid "+"xmlns=\"http://www.ibm.com/xmlns/prod/sn\">${id}</userid></user></sharedWith><sharePermission "+"xmlns=\"urn:ibm.com/td\">View</sharePermission>";
_f=_2.substitute(_f,_4.mixin({fileId:this.file.get("id")},_b));
}else{
if(_d==="community"){
_f="<feed xmlns=\"http://www.w3.org/2005/Atom\"><entry><category term=\"community\" "+"label=\"community\" scheme=\"tag:ibm.com,2006:td/type\"/>"+"<sharePermission xmlns=\"urn:ibm.com/td\">${permission}</sharePermission><itemId xmlns=\"urn:ibm.com/td\">"+"${communityUuid}</itemId>";
_f=_2.substitute(_f,_4.mixin({communityUuid:_b.get("id")},_b));
}else{
if(_d==="everyone"){
_f="<feed xmlns=\"http://www.w3.org/2005/Atom\"/>";
}else{
if(_d==="folder"){
_f="<feed xmlns=\"http://www.w3.org/2005/Atom\"><entry><category term=\"collection\" "+"label=\"collection\" scheme=\"tag:ibm.com,2006:td/type\"/>"+"<sharePermission xmlns=\"urn:ibm.com/td\">${permission}</sharePermission><itemId xmlns=\"urn:ibm.com/td\">"+"${collectionId}</itemId>";
_f=_2.substitute(_f,_4.mixin({collectionId:_b.get("id")},_b));
}
}
}
}
if(_e){
_f+="<summary type=\"text\">${summary}</summary></entry></feed>";
return _2.substitute(_f,{summary:_e});
}else{
return _f+="</entry></feed>";
}
},_getBulkPostBody:function(_10,_11){
var _12=_3.filter(_10,function(u){
return u.entry.permission=="View"&&u.entry.type=="user";
}),_13=_3.filter(_10,function(u){
return u.entry.permission=="Edit"&&u.entry.type=="user";
}),_14=_3.filter(_10,function(u){
return u.entry.type=="community";
}),_15="<feed xmlns=\"http://www.w3.org/2005/Atom\">";
if(_12.length>0||_13.length>0){
_15+="<entry><category term=\"share\" label=\"share\" "+"scheme=\"tag:ibm.com,2006:td/type\"/><sharedWhat xmlns=\"urn:ibm.com/td\">"+this.file.get("id")+"</sharedWhat>";
if(_12.length>0){
_15+="<sharedWith xmlns=\"urn:ibm.com/td\"><sharePermission>View</sharePermission>";
_3.forEach(_12,function(_16){
_15+="<user><userid xmlns=\"http://www.ibm.com/xmlns/prod/sn\">"+_16.entry.get("id")+"</userid></user>";
},this);
_15+="</sharedWith>";
}
if(_13.length>0){
_15+="<sharedWith xmlns=\"urn:ibm.com/td\"><sharePermission>Edit</sharePermission>";
_3.forEach(_13,function(_17){
_15+="<user><userid xmlns=\"http://www.ibm.com/xmlns/prod/sn\">"+_17.entry.get("id")+"</userid></user>";
},this);
_15+="</sharedWith>";
}
_15+="<sharePermission xmlns=\"urn:ibm.com/td\">View</sharePermission>";
if(_11.summary&&_11.summary!==""){
_15+="<summary type=\"text\">"+_a.encode(_11.summary)+"</summary>";
}
_15+="</entry>";
}
_3.forEach(_14,function(_18){
_15+="<entry><category term=\"community\" "+"label=\"community\" scheme=\"tag:ibm.com,2006:td/type\"/>"+"<sharePermission xmlns=\"urn:ibm.com/td\">"+_18.entry.get("permission")+"</sharePermission><itemId xmlns=\"urn:ibm.com/td\">"+_18.entry.get("communityUuid")+"</itemId>";
if(_11&&_11!==""){
_15+="<summary type=\"text\">"+_11+"</summary>";
}
_15+="</entry>";
},this);
return _15+="</feed>";
},_getPutBody:function(_19){
if(_19.get("type")==="everyone"){
var _1a="<entry xmlns=\"http://www.w3.org/2005/Atom\"><category term=\"document\" label=\"document\" "+"scheme=\"tag:ibm.com,2006:td/type\"/><id>urn:lsid:ibm.com:td:${fileId}</id><visibility "+"xmlns=\"urn:ibm.com/td\">private</visibility></entry>";
return _2.substitute(_1a,_4.mixin({fileId:this.file.get("id")},_19));
}
return "";
},getNonVisibleCount:function(){
return this.getResponse().allNonVisibleCollectionCount;
},_getFeedQuery:function(_1b){
var _1c={sK:"published",sO:"desc",contentFormat:"html",category:"version",format:"json",page:this._page,pageSize:(_1b&&_1b.shareUsersPageSize)||this._pageSize,includeSubCollections:true};
_1c.type=this.file.get("libraryType")==="communityFiles"?"community":"personal";
return _1c;
},_getItems:function(){
var _1d=this.inherited(arguments);
if(this.showEveryone&&this.file.get("visibility")==="public"){
var _1e=this.newItem({type:"everyone",permission:"View"});
_1d.unshift(_1e);
}
return _1d;
},_getCreateQuery:function(_1f,_20){
var _21={},_22=false;
if(_4.isArray(_1f)){
_22=_3.some(_1f,function(u){
return u.entry.type==="community"?(u.entry.communityType!=="private"):false;
});
}else{
_22=_1f.get("type")==="community"?_1f.get("communityType")!=="private":false;
}
if(_22&&this.file.get("visibility")&&this.file.get("visibility")!=="public"){
_21.visibility="public";
_20.makePublic=true;
}
return _21;
},createItem:function(_23,_24){
if(_23.type==="everyone"){
this.file.set("visibility","public");
return this.file.update();
}else{
return this.inherited(arguments);
}
},updateItem:function(_25,_26){
if(_25.get("permission")==="Edit"){
return this.createItem(_25,_26);
}else{
return this.inherited(arguments);
}
},deleteItem:function(_27,_28){
var _29=_27.get("type");
if(_29==="everyone"){
this.file.set("visibility","shared");
return this.file.update();
}else{
var dfd=this.inherited(arguments);
dfd.then(_4.hitch(this,function(){
if(_29==="community"){
var _2a=_27.get("communityUuid");
if(!!_2a&&_2a===window.ic_comm_communityUuid){
_9.publish("ic-fileviewer/dirty");
}
}else{
if(_29==="folder"){
_9.publish("ic-fileviewer/dirty");
}
}
}));
return dfd;
}
},_request:function(url,_2b){
var _2c=this.inherited(arguments);
if(_2b._args.makePublic){
_2c.then(_4.hitch(this,function(){
this.file.set("visibility","public");
this.file.unmarkDirty();
}));
}else{
if(_2b._args.stopSharing){
_2c.then(_4.hitch(this,function(){
this.file.set("visibility","private");
this.file.unmarkDirty();
}));
}
}
return _2c;
},_getEntries:function(_2d){
return _2d.items;
},_getHasNext:function(_2e){
return !!(_2e.hasMore||_2e.hasMoreResults);
},_getCreateUrl:function(_2f,_30){
if(_4.isArray(_2f)){
return _8.getFileFeedUrl(this.file);
}
return _8.getFileFeedUrl(this.file);
},_getDeleteUrl:function(_31,_32){
var url,_33={};
if(_32.stopSharing){
_33.visibility="private";
url=this.url;
}else{
if(_31.isCollection()){
_33.itemId=this.file.get("id");
url=_8.getCollectionFeedUrl(_31);
}else{
if(_31.get("isPersonalShare")){
_33.sharedWhat=this.file.get("id");
_33.sharedWith=_31.get("id");
url=_8.getMySharesFeedUrl();
}else{
_33.sharedWhat=this.file.get("id");
_33.sharedWith=_31.get("id");
url=_8.getSharesFeedUrl();
}
}
}
return _6.rewrite(url,_33);
},_getUpdateUrl:function(_34,_35){
if(_34.get("type")==="everyone"){
return this.file.get("entryUrl");
}
return _8.getSharesFeedUrl();
},_getUpdateQuery:function(_36,_37){
if(_36.get("type")==="everyone"){
return {};
}else{
return {sharedWhat:this.file.get("id"),sharedWith:_36.get("id")};
}
}});
});


;define("ic-share/fileviewer/data/ShareLinksFeedDataStore",["dojo/_base/declare","dojo/_base/array","../bean/DocumentUser","./FeedDataStore","../config/globals"],function(_1,_2,_3,_4,_5){
"use strict";
return _1([_4],{_feedHandleAs:"json",_pageSize:100,EntryClass:_3,_getFeedQuery:function(_6){
return {format:"json",includeDownload:true,pageSize:(_6&&_6.shareUsersPageSize)||this._pageSize};
},_getHasNext:function(_7){
return false;
},_getItems:function(_8){
var _9={},_a=[];
_2.forEach(_8.items,function(_b){
var _c,_d,_e;
if(_9.hasOwnProperty(_b.creator.id)){
_c=_9[_b.creator.id];
}else{
_9[_b.creator.id]=_c=this.newItem(_b.creator);
_c.set("targets",[]);
_a.push(_c);
}
_e=_c.get("targets");
_d=this.newItem(_b.target);
_e.push(_d);
},this);
this._sortItems(_a);
return _a;
},_sortItems:function(_f){
var _10=function(a,b){
if(a.id===_5.currentUser.id){
return -1;
}else{
if(b.id===_5.currentUser.id){
return 1;
}else{
if(a.name<b.name){
return -1;
}else{
if(a.name>b.name){
return 1;
}
}
}
}
return 0;
};
_f.sort(_10);
_2.forEach(_f,function(_11){
_11.targets.sort(_10);
},this);
}});
});


;define("ic-share/fileviewer/bean/ShareHistoryItem",["dojo/_base/declare","../util/dom","./AtomBean"],function(_1,_2,_3){
return _1([_3],{_xmlSetter:function(_4){
this.inherited(arguments);
this.set({sharedWith:_2.getAllUsers(_4,"user",_2.NS.TD,_2.getFirstTag(_4,"sharedWith",_2.NS.TD)),sharePermission:_2.getChildTextNS(_4,"sharePermission",_2.NS.TD)});
}});
});


;define("ic-share/fileviewer/data/ShareHistoryFeedDataStore",["dojo/_base/declare","dojo/_base/array","../bean/ShareHistoryItem","./FeedDataStore"],function(_1,_2,_3,_4){
"use strict";
return _1([_4],{_pageSize:100,EntryClass:_3,_getFeedQuery:function(){
return {sharedWhat:this.file.get("id"),page:this._page,pageSize:this._pageSize};
}});
});


;define("ic-share/fileviewer/bean/Recommendation",["dojo/_base/declare","./AtomBean"],function(_1,_2){
"use strict";
return _1([_2],{});
});


;define("ic-share/fileviewer/data/RecommendationFeedDataStore",["dojo/_base/declare","dojo/_base/lang","dojo/string","dojo/when","../bean/Recommendation","./FeedDataStore","./util/routes"],function(_1,_2,_3,_4,_5,_6,_7){
"use strict";
return _1([_6],{_pageSize:100,_feedHandleAs:"json",EntryClass:_5,_getFeedQuery:function(){
var _8={format:"json",page:this._page,pageSize:this._pageSize};
return _8;
},_getHasNext:function(_9){
return _9.page*_9.pageSize<_9.totalSize;
},_getEntries:function(_a){
return _a.items;
},_getCreateUrl:function(_b,_c){
return _7.getFileFeedUrl(this.file);
},_getNewItemProperties:function(_d){
return {category:"recommendation"};
}});
});


;define("ic-share/fileviewer/bean/DownloadInfo",["dojo/_base/declare","./AtomBean"],function(_1,_2){
"use strict";
return _1([_2],{});
});


;define("ic-share/fileviewer/data/DownloadInfoFeedDataStore",["dojo/_base/declare","../bean/DownloadInfo","./FeedDataStore","./util/routes"],function(_1,_2,_3,_4){
"use strict";
return _1([_3],{_pageSize:100,_feedHandleAs:"json",EntryClass:_2,_getFeedQuery:function(_5){
var _6={format:"json",page:this._page,pageSize:this._pageSize};
return _6;
},_getHasNext:function(_7){
return _7.page*_7.pageSize<_7.totalSize;
},_getEntries:function(_8){
return _8.items;
}});
});


;define("ic-share/fileviewer/bean/Favorite",["dojo/_base/declare","./AtomBean"],function(_1,_2){
"use strict";
return _1([_2],{});
});


;define("ic-share/fileviewer/data/FavoritesFeedDataStore",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/string","dojo/when","../util/url","../bean/Favorite","./FeedDataStore","./util/routes","dojo/query"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
return _1([_8],{_pageSize:500,_feedHandleAs:"json",EntryClass:_7,_getPostBody:function(_b){
var _c=_b.get("type");
var _d;
_d="<entry xmlns=\"http://www.w3.org/2005/Atom\"><category term=\"document\" label=\"document\" scheme=\"tag:ibm.com,2006:td/type\"></category><itemId xmlns=\"urn:ibm.com/td\">${fileId}</itemId></entry>";
return _4.substitute(_d,_2.mixin({fileId:this.file.get("id")},_b));
},_getFeedQuery:function(){
var _e={pageSize:"500",format:"json:combined"};
return _e;
},_getDeleteUrl:function(_f){
var _10={itemId:_f.get("id")};
return _6.rewrite(this.serviceUrl,_10);
},_getHasNext:function(_11){
return false;
},_getNewItemProperties:function(_12){
return {category:"favorite"};
},_getCreateQuery:function(_13,_14){
return null;
},_getCreateUrl:function(_15,_16){
return this.serviceUrl;
},_handleFeedResponse:function(_17){
var r=[];
_3.forEach(_17.collections.items,function(_18){
r.push(_18.id);
});
return r.concat(_17.documents.items);
},_updateItemFromResponse:function(_19,_1a){
_19.unmarkDirty();
}});
});


;define("ic-share/fileviewer/bean/Tag",["dojo/_base/declare","./Bean"],function(_1,_2){
return _1([_2],{});
});


;define("ic-share/fileviewer/data/TagDataStore",["dojo/_base/declare","dojo/_base/lang","../bean/Tag","./FeedDataStore","./util/routes","../util/url","dojo/_base/array"],function(_1,_2,_3,_4,_5,_6,_7){
return _1([_4],{_feedHandleAs:"json",EntryClass:_3,_loadPage:function(_8){
var _9=this.inherited(arguments);
if(_8.onComplete){
_9.then(function(_a){
_8.onComplete(_a,_8);
});
}
return _8;
},_getFeedQuery:function(_b){
var _c={format:"json",scope:"document",pageSize:_b.count,sK:"cloud",sO:"dsc",filter:_b.query,page:_b.page};
if(_b.start!==0){
_c.sI=_b.start;
}
return _c;
},_handleFeedResponse:function(_d){
return _d.items;
},createItem:function(_e,_f){
var _10=this.updateItem(_e,_f);
_10.then(_2.hitch(this,function(_11){
this.file.set("xml",_11);
this.file.unmarkDirty();
}));
return _10;
},_getUpdateUrl:function(_12,_13){
return _6.rewrite(this.file.get("entryUrl"),{tag:_12.value,acls:true,includeNotification:true,includePolicy:true,includeRecommendation:true,includeTags:true,includeLibraryInfo:true,includeDownloadInfo:true,inline:true,rank:true});
},deleteItem:function(_14,_15){
var _16=this.inherited(arguments);
var _17=this.file.get("tags");
var _18=_7.indexOf(_17,_14.get("value"));
if(_18>-1){
_17.splice(_18,1);
}
return _16;
},_getDeleteUrl:function(_19,_1a){
return _6.rewrite(_5.getFileFeedUrl(this.file),{category:"tag",tag:_19.value});
},_getNewItemProperties:function(){
return {category:"document"};
}});
});


;define("ic-share/fileviewer/util/FilePermissions",["dojo/_base/declare","dojo/_base/lang","dojo/when"],function(_1,_2,_3){
return _1([],{constructor:function(_4){
_2.mixin(this,_4);
this._permissions={};
},setPermissionsObject:function(_5){
this._permissions=_5;
},canTag:function(){
return this.canEdit();
},canEdit:function(){
return this._permissions.Edit;
},canAddToFolder:function(){
var _6;
if(this.file.get("libraryType")==="communityFiles"){
_6=this.file.get("repository").then(_2.hitch(this,function(_7){
return !!_7.get("permissions").AddChild;
}));
}else{
_6=!!this._permissions.GrantAccessView;
}
return _3(_6);
},canGrantAccess:function(){
return this._permissions.GrantAccess;
},canGrantAccessEdit:function(){
return this._permissions.GrantAccessEdit;
},canGrantAccessView:function(){
return this._permissions.GrantAccessView;
},canDelete:function(){
return this._permissions.Delete;
},canChangeSharingIntent:function(){
return this._permissions.ChangeSharingIntent;
},canLock:function(){
return this._permissions.Lock;
},canUnlock:function(){
return this._permissions.Unlock;
}});
});


;define("ic-share/fileviewer/bean/Repository",["dojo/_base/declare","./AtomBean"],function(_1,_2){
return _1([_2],{});
});


;define("ic-share/fileviewer/data/RepositoryDataStore",["dojo/_base/declare","dojo/_base/lang","../bean/Repository","./FeedDataStore","./util/routes","dojo/when"],function(_1,_2,_3,_4,_5,_6){
var _7={};
return _1([_4],{EntryClass:_3,getFileRepository:function(){
var _8=this.file.get("libraryId"),_9;
if(!_7[_8]){
_9=this.newItem({id:_8});
_7[_8]=_9.load().then(_2.hitch(this,function(){
return _9;
}));
}
return _7[_8];
},_getLoadUrl:function(){
return _5.getRepositoryEntryUrl(this.file);
},_getNewItemProperties:function(){
return {};
}});
});


;define("ic-share/fileviewer/bean/File",["dojo/_base/declare","dojo/Stateful","dojo/_base/lang","dojo/Deferred","dojo/when","dojo/io-query","../data/CommentFeedDataStore","../data/VersionFeedDataStore","../data/FileEntryDataStore","../data/SharingFeedDataStore","../data/ShareLinksFeedDataStore","../data/ShareHistoryFeedDataStore","../data/RecommendationFeedDataStore","../data/DownloadInfoFeedDataStore","../data/FavoritesFeedDataStore","../data/TagDataStore","../data/util/routes","./AtomBean","../util/FilePermissions","../data/RepositoryDataStore","../data/docsApi","../util/ibmDocs","dojo/topic","./ModeratedBean","dojo/_base/url","../util/url","../config/globals"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,_1a,_1b){
return _1([_12,_18],{constructor:function(){
this.permissions=new _13({file:this});
this.refreshEntry=false;
this.moderatedBeanType="document";
_17.subscribe("ic-fileviewer/refresh",_3.hitch(this,function(){
this.refreshEntry=true;
delete this._fullEntry;
delete this.sharingFeed;
delete this.collectionSharingFeed;
}));
},postscript:function(){
this.inherited(arguments);
this.set("entryUrl",_11.getFileEntryUrl(this));
this.hasEntry=!!this.get("title");
this.get("fileEntryFeed");
this._initilized=true;
},_permissionsSetter:function(_1c){
this.permissions.setPermissionsObject(_1c);
},_objectTypeIdSetter:function(_1d){
this.objectTypeId=_1d;
this.set("isDocsFile",_16.isDocsFile(this));
},_communityIdGetter:function(){
if(_3.isString(this.communityId)){
return this.communityId;
}
if(this.get("libraryType")==="communityFiles"){
var _1e,_1f;
_1e=this.get("alternateUrl")||this.get("links").alternate;
_1f=_1e.substring(_1e.indexOf("?")+1,_1e.indexOf("#"));
this.communityId=_6.queryToObject(_1f).communityUuid;
}else{
this.communityId="";
}
return this.communityId;
},_locationGetter:function(){
if(this._location!==undefined){
return this._location;
}
var _20=this.get("links"),_21=_20.linkTarget||_20.details;
this._location=_1a.isFilesUrl(_21)?"personalFiles":"communityFiles";
return this._location;
},_widgetIdGetter:function(){
if(this._widgetId!==undefined){
return this._widgetId;
}
var _22=this.get("links"),_23;
if(this.get("location")!=="communityFiles"){
this._widgetId="";
}else{
_23=new _19(_22.linkTarget||_22.details).fragment;
this._widgetId=_6.queryToObject(_23).fullpageWidgetId;
}
return this._widgetId;
},_entryGetter:function(){
if(this.hasEntry&&!this.refreshEntry){
return this;
}
this.refreshEntry=false;
return this.get("fullEntry");
},_fullEntryGetter:function(){
if(this._fullEntry){
return this._fullEntry;
}
if(_1b.isCCM(this)){
this.hasEntry=true;
this._fullEntry=new _4();
this._fullEntry.resolve(this);
return this._fullEntry;
}
this._fullEntry=this.get("fileEntryFeed").loadItem(this).then(_3.hitch(this,function(){
this.hasEntry=true;
return this;
}));
return this._fullEntry;
},_commentFeedGetter:function(){
if(this.commentFeed){
return this.commentFeed;
}
this.commentFeed=new _7({url:_11.getFileFeedUrl(this),file:this});
return this.commentFeed;
},_versionFeedGetter:function(){
if(this.versionFeed){
return this.versionFeed;
}
this.versionFeed=new _8({url:_11.getFileFeedUrl(this),file:this});
return this.versionFeed;
},_fileEntryFeedGetter:function(){
if(this.fileEntryFeed){
return this.fileEntryFeed;
}
this.fileEntryFeed=new _9({url:this.get("entryUrl"),file:this});
return this.fileEntryFeed;
},_sharingFeedGetter:function(){
if(this.sharingFeed){
return this.sharingFeed;
}
this.sharingFeed=new _a({url:_11.getPermissionsFeedUrl(this),file:this,showEveryone:true});
return this.sharingFeed;
},_collectionSharingFeedGetter:function(){
if(this.collectionSharingFeed){
return this.collectionSharingFeed;
}
this.collectionSharingFeed=new _a({url:_11.getFileCollectionsFeedUrl(this),file:this});
return this.collectionSharingFeed;
},_shareLinksFeedGetter:function(){
if(this.shareLinksFeed){
return this.shareLinksFeed;
}
this.shareLinksFeed=new _b({url:_11.getShareLinksFeedUrl(this),file:this});
return this.shareLinksFeed;
},_shareHistoryFeedGetter:function(){
if(this.shareHistoryFeed){
return this.shareHistoryFeed;
}
this.shareHistoryFeed=new _c({url:_11.getMySharesFeedUrl(),file:this});
return this.shareHistoryFeed;
},_recommendationFeedGetter:function(){
if(this.recommendationFeed){
return this.recommendationFeed;
}
this.recommendationFeed=new _d({url:_11.getRecommendationFeedUrl(this),file:this});
return this.recommendationFeed;
},_downloadInfoFeedGetter:function(){
if(this.downloadInfoFeed){
return this.downloadInfoFeed;
}
this.downloadInfoFeed=new _e({url:_11.getDownloadInfoFeedUrl(this),file:this});
return this.downloadInfoFeed;
},_tagFeedGetter:function(){
if(this.tagFeed){
return this.tagFeed;
}
this.tagFeed=new _10({url:_11.getTagServiceUrl(),file:this});
return this.tagFeed;
},_favoritesFeedGetter:function(){
if(this.favoritesFeed){
return this.favoritesFeed;
}
this.favoritesFeed=new _f({url:_11.getFavoritesFeedUrl(),serviceUrl:_11.getFavoritesServiceUrl(),file:this});
return this.favoritesFeed;
},getDocsDraftInfo:function(){
return _16.isDocsEnabled().then(_3.hitch(this,function(_24){
if(_24){
return _15.getDraftInformation(this).then(_3.hitch(this,function(_25){
this.set("docsDraftInfo",_25);
return _25;
}),function(_26){
return null;
});
}else{
return null;
}
}));
},_repositoryFeedGetter:function(){
if(this.repositoryFeed){
return this.repositoryFeed;
}
this.repositoryFeed=new _14({file:this});
return this.repositoryFeed;
},_repositoryGetter:function(){
return this.get("repositoryFeed").getFileRepository();
},like:function(){
var _27=this.get("recommendationFeed");
return _27.newItem().create();
},unlike:function(){
var _28=this.get("recommendationFeed").newItem();
_28.set("entryUrl",_11.getRecommendationUrl(this));
return _28.remove();
},stopSharing:function(){
var _29=this.get("sharingFeed");
return _29.newItem().remove({stopSharing:true});
},addTags:function(_2a){
var _2b=this.get("tagFeed").newItem();
_2b.set("value",_2a);
return _2b.create();
},removeTag:function(_2c){
var _2d=this.get("tagFeed").newItem();
_2d.set("value",_2c);
return _2d.remove();
},_visibilitySetter:function(_2e){
this.visibility=_2e;
return this._dirtyPromise;
},_nameSetter:function(_2f){
this.name=_2f;
var _30=_2f.split(".").pop();
this.set("type",_30.toLowerCase());
return this._dirtyPromise;
},_typeSetter:function(_31){
this.type=_31.toLowerCase();
return this._dirtyPromise;
},_isLockedSetter:function(_32){
this.isLocked=_32;
return this._dirtyPromise;
},hasDownloadInfo:function(){
return typeof this.get("currentUserDownloadInfo").hasDownloaded!="undefined";
},hasDownloaded:function(){
return this.get("currentUserDownloadInfo").hasDownloaded;
},hasDownloadedLatest:function(){
var _33=this.get("currentUserDownloadInfo");
return _33.hasDownloaded&&_33.versionNumber===this.get("version");
}});
});


;define("ic-share/fileviewer/widget/SplitDropDownMenuButton",["dojo/_base/declare","./DropDownMenuButton"],function(_1,_2){
var _3=_1([_2],{setDropDownButtonTitle:function(){
this._popupMenu._buttonNode.title=this.nls.TITLE;
}});
return _3;
});


;define("ic-share/fileviewer/action/EditFilenameAction",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class","./Action","../widget/EditBox","../util/validation","../util/network","dojo/i18n!../nls/FileViewerStrings","dojo/on","dojo/topic","../util/html","../config/globals","../util/ModerationUtil","../util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,on,_9,_a,_b,_c,_d){
"use strict";
var _e=_1([_4],{postMixInProperties:function(){
this.nls=_8.ACTION.EDIT_FILENAME;
},onLinkClicked:function(){
var _f=this.file.get("name");
this.filenameNode.style.display="none";
var _10=this._editBox=new _5({multiline:false,invalidCharacters:_6.INVALID_FILENAME_CHARS,closeButtonEnabled:true,useInlineMessages:false});
_10.placeAt(this.filenameNode,"after");
_10.set("value",this.file.get("name"));
_10.focus();
var _11=_f.lastIndexOf(".");
if(_11>-1){
_10.setSelectionRange(0,_11);
}
_10.on("save",_2.hitch(this,this._onSave));
_10.on("cancel",_2.hitch(this,this._displayFilenameNode));
_d.track("editFilename.open");
},_onSave:function(){
_9.publish("ic-fileviewer/push/clearMessages");
var _12=this._editBox.get("value");
if(_12===this.file.get("name")){
this._displayFilenameNode();
return;
}
if(_12.length>_6.FILENAME_LENGTH){
_9.publish("ic-fileviewer/push/messages",{type:"error",message:_8.VALIDATION.FILENAME.WARN_TOO_LONG,cancelable:true,focus:false});
return;
}
this._initialType=this.file.get("type");
this.file.set("name",_12);
this.file.update().then(_2.hitch(this,this._onSuccess),_2.hitch(this,this._onError));
_d.track("editFilename.save");
},_onSuccess:function(){
this._displayFilenameNode();
if(this._initialType!==this.file.get("type")){
_9.publish("ic-fileviewer/changedExtension",{});
}
if(this.file.get("status")=="pending"){
_c.launchModerationDialog();
}
},_displayFilenameNode:function(){
this._editBox.destroy();
_a.setText(this.filenameNode,this.file.get("name"));
this.filenameNode.style.display="";
},_onError:function(_13){
var _14=_7.getErrorMessage(_13,this.nls.ERROR);
_9.publish("ic-fileviewer/push/messages",{type:"error",message:_14,cancelable:true,focus:false});
},_closeFile:function(){
_9.publish("ic-fileviewer/dirty");
_9.publish("ic-fileviewer/action/completed");
}});
return {create:function(_15){
return new _e(_15);
},isValid:function(_16){
if(_b.isPanels(_16)){
return _16.get("fullEntry").then(function(){
return _16.get("permissions").canEdit();
});
}else{
return false;
}
},getClassName:function(){
return "ics-viewer-title-name-rename";
}};
});


;define("ic-share/fileviewer/widget/docsStatusMessage",["dojo/topic","../util/ibmDocs","../util/html","dojo/i18n!../nls/FileViewerStrings","dojo/dom-construct","dojo/_base/array","../config/globals","dojo/_base/lang","dojo/promise/all","dojo/Deferred","dojo/on","../data/docsApi","../util/network"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,on,_b,_c){
"use strict";
return {nls:_4.DOCS_STATUS_MESSAGE||{},_checkIfValid:function(){
var _d=new _a();
if(!this.file.get("isDocsFile")){
_d.resolve(false);
}else{
_d=this.file.get("fullEntry").then(_8.hitch(this,function(){
return this.file.get("permissions").canEdit();
}));
}
return _d;
},render:function(_e){
this.file=_e;
this._checkIfValid().then(_8.hitch(this,function(_f){
if(!_f){
return;
}
this._render();
}));
},_render:function(){
_2.isDocsEnabled().then(_8.hitch(this,function(_10){
if(!_10){
this._renderNoEntitlementMessage();
}else{
this._renderDraftInfoMessage();
}
}));
},_renderNoEntitlementMessage:function(){
_1.publish("ic-fileviewer/push/messages",{type:"info",message:this.nls.NO_ENTITLEMENT});
},_renderDraftInfoMessage:function(){
this.file.getDocsDraftInfo().then(_8.hitch(this,function(_11){
if(!_11){
return;
}
if(_11.get("editors").length!==0){
this._renderEditorMessage(_11.get("editors"));
}else{
if(_11.get("hasChanges")){
this._renderPublishMessage();
this._addDraftUpdateInfo(_11);
}
}
}));
},_addDraftUpdateInfo:function(_12){
this.file.unpublishedChanges.draftUpdateDate=_12.get("dateModified");
this.file.unpublishedChanges.baseVersion=_12.get("baseVersion");
this.file.unpublishedChanges.hasChanges=_12.hasChanges;
},_renderEditorMessage:function(_13){
var _14=_5.create("div");
_3.substitute(window.document,_14,this.nls.CURRENT_EDITORS,{users:function(){
var _15=document.createDocumentFragment();
_6.forEach(_13,function(_16,i){
var _17=document.createDocumentFragment();
_3.generateLinkToUser(_16,_17);
_15.appendChild(_17);
if(i!==_13.length-1){
_15.appendChild(document.createTextNode(",\xa0"));
}
},self);
return _15;
}});
_1.publish("ic-fileviewer/push/messages",{type:"info",message:_14});
},_renderPublishMessage:function(){
var _18=_5.create("div"),_19;
_18.appendChild(document.createTextNode(this.nls.UNPUBLISHED_CHANGES+" "));
_19=_5.create("a",{href:"javascript:;",innerHTML:this.nls.PUBLISH_A_VERSION},_18);
on(_19,"click",_8.hitch(this,this._publish));
_1.publish("ic-fileviewer/push/clearMessages",{forceRemove:true});
this._publishMessage={type:"warning",message:_18,isSticky:true};
_1.publish("ic-fileviewer/push/messages",this._publishMessage);
},_publish:function(){
_1.publish("ic-fileviewer/push/removeMessage",this._publishMessage);
_1.publish("ic-fileviewer/manualpublishing");
_b.publish(this.file).then(_8.hitch(this,this._onPublishSuccess),_8.hitch(this,this._onPublishError));
},_onPublishSuccess:function(){
this.file.load().then(_8.hitch(this,function(){
_1.publish("ic-fileviewer/dirty");
_1.publish("ic-fileviewer/refresh");
}));
},_onPublishError:function(_1a){
var _1b=_c.getErrorMessage(_1a,this.nls.PUBLISH_ERROR);
_1.publish("ic-fileviewer/push/messages",{type:"error",message:_1b});
}};
});


;define("dojo/text!ic-share/fileviewer/templates/Dragbar.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n\n<div class="ics-viewer-dragbar" tabindex="-1" data-sbw-bind="panelSize:style={panelLocation}!_position" data-dojo-attach-event="mousedown:_onMouseDown">\n   <div class="icon" tabindex="0" title="${nls.RESIZE_BAR}" aria-label="${nls.USAGE}" role="button"></div>\n</div>');

;define("ic-share/fileviewer/Dragbar",["dojo/_base/declare","./sbw/StatefulBackedTemplatedWidget","dojo/text!./templates/Dragbar.html","dojo/on","dojo/_base/lang","dojo/window","dojo/query","dojo/dom-class","dojo/keys","dojo/i18n!./nls/FileViewerStrings"],function(_1,_2,_3,on,_4,_5,_6,_7,_8,_9){
window.VIEWER_PANELS_DRAGBAR_SIZE=15;
window.VIEWER_PANELS_CLOSED_SIZE=window.VIEWER_PANELS_DRAGBAR_SIZE;
window.VIEWER_PANELS_MINIMUM_SIZE=340;
window.VIEWER_PANELS_SNAP_CLOSED_SIZE=240;
window.VIEWER_PREVIEW_CLOSED_SIZE=0;
window.VIEWER_PREVIEW_MINIMUM_SIZE=500;
window.VIEWER_PREVIEW_SNAP_CLOSED_SIZE=400;
return _1([_2],{templateString:_3,postMixInProperties:function(){
this.nls=_9.ACTION.RESIZE;
if(!this.nls){
this.nls={RESIZE_BAR:"Resize the panel",USAGE:"Press left bracket or right bracket keys to resize the panel."};
}
},postCreate:function(){
on(window,"resize",_4.hitch(this,function(){
var _a,_b,_c;
_c=_5.getBox().w;
_a={clientX:this.panelLocation==="left"?this.model.get("panelSize"):_c-this.model.get("panelSize"),windowWidth:_c,previewClosedSize:window.VIEWER_PREVIEW_CLOSED_SIZE,previewMinimumSize:window.VIEWER_PREVIEW_MINIMUM_SIZE,previewSnapClosedSize:window.VIEWER_PREVIEW_SNAP_CLOSED_SIZE,panelsClosedSize:window.VIEWER_PANELS_CLOSED_SIZE,panelsMinimumSize:window.VIEWER_PANELS_MINIMUM_SIZE,panelsSnapClosedSize:window.VIEWER_PANELS_SNAP_CLOSED_SIZE};
_b=this._computeSizeWithMouse(_a);
this.model.set("panelSize",_b);
}));
this.inherited(arguments);
},_position:function(_d){
var _e=(_d+-window.VIEWER_PANELS_DRAGBAR_SIZE)+"px";
return _e;
},_onMouseDown:function(_f){
_f.preventDefault();
_f.stopPropagation();
if(this.moveHandler){
this.moveHandler.remove();
}
this.moveHandler=on(document,"mousemove",_4.hitch(this,"_resize"));
this.upHandler=on(document,"mouseup",_4.hitch(this,"_removeListener"));
this._setInterceptorsActive(true);
},_listenForKeyboard:function(_10){
this.rightBracket=221;
this.leftBracket=219;
on(this.domNode,"keydown",_4.hitch(this,function(evt){
switch(evt.keyCode){
case _8.RIGHT_ARROW:
case _8.LEFT_ARROW:
case this.rightBracket:
case this.leftBracket:
this._resize(evt,evt.keyCode,_10);
break;
}
}));
},_resize:function(evt,_11,_12){
evt.preventDefault();
evt.stopPropagation();
var _13,_14;
_14=this.panelLocation==="right";
var _15={clientX:evt.clientX,windowWidth:_5.getBox().w,previewClosedSize:window.VIEWER_PREVIEW_CLOSED_SIZE,previewMinimumSize:window.VIEWER_PREVIEW_MINIMUM_SIZE,previewSnapClosedSize:window.VIEWER_PREVIEW_SNAP_CLOSED_SIZE,panelsClosedSize:window.VIEWER_PANELS_CLOSED_SIZE,panelsMinimumSize:window.VIEWER_PANELS_MINIMUM_SIZE,panelsSnapClosedSize:window.VIEWER_PANELS_SNAP_CLOSED_SIZE};
if(_11){
_13=this._computeSizeWithKey(_15,_11,_12,_14);
}else{
_13=this._computeSizeWithMouse(_15);
}
this.model.set("panelSize",_13);
},_computeSizeWithKey:function(_16,_17,_18,_19){
var _1a,_1b,_1c,_1d;
_1b=_16.windowWidth-_16.previewMinimumSize;
_1c=this._getInterval(_17,_19);
_1a=_18.offsetWidth+_1c;
_1d=_16.windowWidth-_1a;
if(_1a<_16.panelsMinimumSize){
_1a=this._newSizeWhenBelowMinimum(_16,_19,_17);
}else{
if(_1a>_1b){
_1a=this._newSizeWhenAboveMaximum(_1b,_16,_19,_17);
}
}
return _1a;
},_newSizeWhenBelowMinimum:function(_1e,_1f,_20){
return this._decreasePanelSize(_1f,_20)?_1e.panelsClosedSize:_1e.panelsMinimumSize;
},_newSizeWhenAboveMaximum:function(_21,_22,_23,_24){
return this._decreasePanelSize(_23,_24)?_21:_22.windowWidth;
},_decreasePanelSize:function(_25,_26){
return _25?this._rightkeyPressed(_26):this._leftkeyPressed(_26);
},_rightkeyPressed:function(_27){
return _27==_8.RIGHT_ARROW||_27==this.rightBracket;
},_leftkeyPressed:function(_28){
return _28==_8.LEFT_ARROW||_28==this.leftBracket;
},_computeSizeWithMouse:function(_29){
var _2a;
if(this.panelLocation==="left"){
_29.clientX=_29.windowWidth-_29.clientX;
}
if(_29.clientX<_29.previewSnapClosedSize){
_29.clientX=_29.previewClosedSize;
}else{
if(_29.clientX<_29.previewMinimumSize){
_29.clientX=_29.previewMinimumSize;
}
}
_2a=_29.windowWidth-_29.clientX;
if(_2a<_29.panelsSnapClosedSize){
_2a=_29.panelsClosedSize;
}else{
if(_2a<_29.panelsMinimumSize){
_2a=_29.panelsMinimumSize;
}
}
return _2a;
},_getInterval:function(_2b,_2c){
var _2d;
if(_2c){
_2d=(_2b==_8.RIGHT_ARROW||_2b==this.rightBracket)?-10:10;
}else{
_2d=(_2b==_8.LEFT_ARROW||_2b==this.leftBracket)?-10:10;
}
return _2d;
},_removeListener:function(evt){
evt.preventDefault();
evt.stopPropagation();
this.upHandler.remove();
this._setInterceptorsActive(false);
if(this.moveHandler){
this.moveHandler.remove();
this.moveHandler=undefined;
}
},_setInterceptorsActive:function(_2e){
_6(".ics-viewer-event-interceptor").forEach(function(el){
_7[_2e?"add":"remove"](el,"ics-viewer-event-interceptor-active");
});
}});
});


;define("dojo/text!ic-share/fileviewer/widget/templates/FileTypeIcon.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div data-sbw-bind="isLocked:class!_getLockClass" class="ics-viewer-file-type-icon">\n   <img src="${_blankGif}" data-dojo-attach-point="fileTypeIcon" class="ics-viewer-icon" data-sbw-bind="type:class!_getFileTypeClass" role="presentation" alt="" />\n   <img src="${_blankGif}" data-dojo-attach-point="lockedByYouIcon" class="ics-viewer-locked-by-you-icon" data-sbw-bind="isLocked:title!_getLockString, isLocked:alt!_getLockString"/>\n   <img src="${_blankGif}" data-dojo-attach-point="lockedByOtherIcon" class="ics-viewer-locked-by-other-icon" data-sbw-bind="isLocked:title!_getLockString, isLocked:alt!_getLockString"/>\n</div>');

;define("ic-share/fileviewer/widget/FileTypeIcon",["dojo/_base/declare","../sbw/StatefulBackedTemplatedWidget","dojo/text!./templates/FileTypeIcon.html","../preview/util","dojo/i18n!../nls/FileViewerStrings","../config/globals","../util/DateFormat","dojo/string","dojo/query","dijit/focus"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
return _1([_2],{templateString:_3,constructor:function(){
this.nls=_5.FILE_STATE;
},postMixInProperties:function(){
this.model=this.file;
window.fileTypeIcon=this;
this.file.get("fullEntry").then();
},focus:function(){
_9("img",this.domNode).forEach(function(_b){
_a.focus(_b);
});
},_getFileTypeClass:function(){
return _4.getIconClass(this.fileArgs||{},16);
},_getLockString:function(){
if(!this.file.get("isLocked")||!this.file.get("lock")){
return "";
}
var _c,_d,_e;
_c=this.file.get("lock");
_d=_c.user.id===_6.currentUser.id?this.nls.LOCKED_BY_YOU:this.nls.LOCKED_BY_OTHER;
_e=(new _7(_c.date)).formatByAge(_d);
return _8.substitute(_e,{user:_c.user.name});
},_getLockClass:function(){
if(!this.file.get("isLocked")||!this.file.get("lock")){
return "ics-viewer-unlocked";
}
var _f=this.file.get("lock");
if(_f&&_f.user.id===_6.currentUser.id){
return "ics-viewer-locked-by-you";
}
return "ics-viewer-locked-by-other";
}});
});


;define("ic-share/fileviewer/ExtensionsRequest",["dojo/Deferred","dojo/cookie","dojo/_base/kernel","dojo/_base/lang","dojo/io-query","./data/util/routes","./network/request"],function(_1,_2,_3,_4,_5,_6,_7){
"use strict";
function _8(_9){
var _a={"csrfToken":_2("token"),"max-age":_4.getObject("lconn.share.config.services.maxAge"),"etag":_4.getObject("lconn.files.config.version"),"lang":_3.locale},_b=_5.objectToQuery(_a),_c=_6.getExtensionsUrl();
if(!_c){
_9.resolve(false);
return;
}
_c+=_b;
_7(_c,{auth:{secured:false},noStatus:true,method:"GET",handleAs:"json",handle:_4.hitch(this,function(_d,_e){
_f(_9,_d,_e);
})});
};
function _f(_10,_11,_12){
if(_11 instanceof Error){
return _10.resolve(false);
}
return _10.resolve(_11);
};
return {getExtensions:function(){
var _13=new _1();
_8(_13);
return _13;
}};
});


;define("ic-share/fileviewer/action/ExtensionAction",["dojo/_base/declare","dojox/html/entities","../config/globals","dojo/_base/array"],function(_1,_2,_3,_4){
"use strict";
var _5=_1([],{isExtensionAction:true,constructor:function(_6){
this.name=_2.encode(_6.menu_text);
this.tooltip=_6.tooltip||_6.menu_text;
this.title=this.tooltip;
this.url=_6.url;
this.mimeType=_3.textUtil.trim(_2.encode(_6.mime_type));
this.newWindow=!!_6.new_window;
if(this.newWindow){
this.windowName=_2.encode(_6.window_name)||"";
this.windowName=this.windowName.replace(/ /g,"_");
this.windowName=this.windowName.replace(/-/g,"_");
this.windowFeatures=_6.window_features;
}
},getName:function(){
return this.name;
},getTooltip:function(){
return this.tooltip;
},execute:function(_7){
var _8,_9,_a;
_9=_b(_3.currentUser,"id");
_a=_b(_3.currentUser,"orgId");
_8=this.url.replace("${file_id}",encodeURIComponent(_7.get("id")));
_8=_8.replace("${user_id}",_9);
_8=_8.replace("${subscriber_id}",_9);
_8=_8.replace("${org_id}",_a);
_8=_8.replace("${customer_id}",_a);
if(this.newWindow){
this._openWindow(_8,this.windowName,this.windowFeatures);
}else{
this._redirect(_8);
}
return true;
},_openWindow:function(_c,_d,_e){
window.open(_c,_d,_e);
},_redirect:function(_f){
window.location.href=_f;
}});
function _10(url){
if(!url){
return false;
}
if(/^(javascript:|data:)/.test(url)){
return false;
}
return true;
};
function _b(_11,_12){
if(!_11){
return "";
}
if(_11._native){
_11=_11._native;
}
return encodeURIComponent(_11[_12]||"");
};
function _13(_14,_15){
if(!_14){
return;
}
if(_14["extends"]!=="file_menu"){
return;
}
if(_14.type!=="action"){
return;
}
if(_14.mime_type&&_14.mime_type!==_15.get("mimeType")){
return;
}
if(!_10(_14.url)){
return;
}
return new _5(_14);
};
function _16(_17,_18){
var _19=[];
_4.forEach(_17,function(_1a){
var _1b=_13(_1a,_18);
if(_1b){
_19.push(_1b);
}
});
return _19;
};
return {createActions:_16,_create:_13,_isSanitary:_10,_class:_5,_getUserField:_b};
});


;define("dojo/text!ic-share/fileviewer/templates/welcomeBox.html", '<div>\n   <div class="title"><span class="title-text" data-dojo-attach-point="titleContainer">${nls.title}</span></div>\n   <div class="subtitle"><span class="subtitle-text" data-dojo-attach-point="subtitleContainer">${nls.subtitle}</span></div>\n   <ul class="lines" data-dojo-attach-point="lineContainer"></ul>\n</div>');

;define("ic-share/fileviewer/welcomeMessage",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/welcomeBox.html","dojo/aspect","dojo/i18n!./nls/FileViewerStrings","dojo/dom-construct","dojo/has","ic-ui/MessageBox","dojo/dom-class","./config/globals","dojo/dom-attr","dijit/registry"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){
"use strict";
var _e,_f="ic.fileviewer.hideWelcome";
function _10(_11){
return _6.WELCOME.LINES["LINE_"+_11];
};
_e=_1([_2,_3],{templateString:_4,postMixInProperties:function(){
this.nls={title:_6.WELCOME.TITLE,subtitle:_6.WELCOME.SUBTITLE};
},postCreate:function(){
var _12=_d.getUniqueId("fileviewer")+"_titleContent";
var _13=_d.getUniqueId("fileviewer")+"_welcomeContent";
_c.set(this.titleContainer,"id",_12);
_c.set(this.subtitleContainer,"id",_13);
var _14=1,_15;
_15=_10(_14);
while(_15){
_7.create("li",{innerHTML:_15},this.lineContainer);
_14+=1;
_15=_10(_14);
}
}});
function _16(_17){
if(_b.isCCM(_17)){
return false;
}
return window.localStorage&&!window.localStorage.getItem(_f)&&_8("fileviewer-welcome");
};
function _18(){
var _19=new _e();
return _19.domNode;
};
function _1a(){
_a.remove(document.body,"ics-viewer-welcome-showing");
if(!window.localStorage){
return;
}
window.localStorage.setItem(_f,"true");
};
function _1b(_1c){
var _1d=new _9({canClose:true,_strings:{icon_alt:"",a11y_label:"",close_btn_title:_6.ACTION.CLOSE.TOOLTIP,close_btn_alt:_6.ACTION.CLOSE.TOOLTIP},type:"welcome",msg:_18()},_1c);
_c.set(_1d.domNode,"role","alertdialog");
var _1e=_1d.msgBody.querySelector(".subtitle-text").id;
var _1f=_1d.msgBody.querySelector(".title-text").id;
_c.set(_1d.domNode,"aria-labelledby",_1f);
_c.set(_1d.domNode,"aria-describedby",_1e);
_5.after(_1d,"onClose",_1a);
_a.add(document.body,"ics-viewer-welcome-showing");
};
function _20(_21,_22){
if(!_16(_22)){
return;
}
_1b(_21);
};
return {execute:_20};
});


;define("ic-share/fileviewer/FileViewerImpl",["dojo/_base/declare","./sbw/StatefulBackedTemplatedWidget","dijit/registry","dojo/text!./templates/FileViewerImpl.html","./preview/previews","./action/actions","dojo/_base/array","dojo/_base/config","dojo/dom-class","dojo/dom-construct","dojo/html","dojo/_base/lang","dojo/i18n!./nls/FileViewerStrings","dojo/string","dojo/on","dojo/keys","dijit/focus","dijit/a11y","dojo/dom-attr","dojo/query","dojo/_base/window","./preview/util","./preview/EntitlementChecker","./util/html","./util/DateFormat","./config/Services","dojo/has","./panels/PanelNav","./bean/File","dojo/cookie","./config/globals","./config/Services","dojo/topic","./widget/DropDownMenuButton","./widget/SplitDropDownMenuButton","./action/EditFilenameAction","dojo/when","./data/util/routes","./network/request","dojo/promise/all","./widget/MessageBox","dojo/aspect","dojo/date","./widget/docsStatusMessage","./uiState","./Dragbar","./widget/FileTypeIcon","./ExtensionsRequest","./action/ExtensionAction","./util/network","./util/url","./util/history","./action/ToggleFollowAction","./welcomeMessage","./editTracker","./util/feature","dojo/dom","./util/fidoNewRelic"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,on,_f,_10,_11,_12,_13,win,_14,_15,_16,_17,_18,has,_19,_1a,_1b,_1c,_1d,_1e,_1f,_20,_21,_22,_23,_24,all,_25,_26,_27,_28,_29,_2a,_2b,_2c,_2d,_2e,_2f,_30,_31,_32,_33,_34,dom,_35){
var _36="ics-viewer-narrow";
var _37=1200;
return _1([_2],{templateString:_4,_subscriptions:[],_messages:[],postMixInProperties:function(){
this._promises=[];
this._watches=[];
this.formatFileSize=this.formatSize||_14.formatFileSize;
this.nls=_d;
this.NLS_SPLIT_ACTION_FALLBACK={MENU:{TITLE:"More options",A11Y:"This button opens a menu for more options."},BUTTON:{EDIT:{TITLE:"Edit"},UPLOAD:{TITLE:"Upload"},CREATE:{TITLE:"Create"}}};
this.nls.SPLIT_ACTION=this.nls.SPLIT_ACTION||this.NLS_SPLIT_ACTION_FALLBACK;
_33.init();
this.blank=_8.blankGif||this._blankGif;
this.ariaLabelId=_3.getUniqueId("fileviewer")+"_title";
this.fileSize=this.formatFileSize(this.file.args.size)||0;
this.entitlements=new _15({isAuthenticated:this.isAuthenticated,isCCM:_14.isCCM(this.file)});
this.services=new _18({isAuthenticated:this.isAuthenticated});
this.fileTypeExternal=this.nls.SHARED_EXTERNALLY;
this.myFileSync=this.nls.FILE_SYNCED;
this.textDirection=_9.contains(_13("html")[0],"dijitRtl")?"rtl":"ltr";
this.rtl="rtl"===this.textDirection;
this.ltr=!this.rtl;
this._setUser();
this._setGlobals();
this.panelLocation=this.rtl?"left":"right";
this.model=_29;
this._setupDebug();
},_setupDebug:function(){
if(dojoConfig.isDebug){
window.fileviewer=this;
}
},_setGlobals:function(){
_1c.login=this.login;
_1c.TextBoxWidget=this.TextBoxWidget;
_1c.MentionsDataFormatter=this.MentionsDataFormatter;
_1c.PeopleTypeAhead=this.PeopleTypeAhead;
_1c.HybridPeopleDataStoreOpenSocial=this.HybridPeopleDataStoreOpenSocial;
_1c.TagTypeAhead=this.TagTypeAhead;
_1c.currentUser=this.currentUser||{};
_1c.attachBizCard=this.attachBizCard;
_1c.TypeAheadDataStore=this.TypeAheadDataStore;
_1c.isVerse=!_c.isFunction(this.isAuthenticated);
_1c.blankGif=this.blank;
_1c.pickerAuth=this.pickerAuth;
_1c.pickerRoutes=this.pickerRoutes;
_1c.commRoutes=this.commRoutes;
_1c.coreUrl=this.coreUrl;
_1c.network=this.network;
_1c.addToCollection=this.addToCollection;
_1c.moveToCollection=this.moveToCollection;
_1c.services=new _1d();
_1c.formatFileSize=this.formatFileSize;
_1c.policy=this.policy;
_1c.validationUtil=this.validationUtil;
_1c.textUtil=this.textUtil;
_1c.entitlements=this.entitlements;
_1c.layer2=this.layer2;
_1c.configUtil=this.configUtil;
_1c.baseFilesConfig=this.baseFilesConfig;
_1c.disableAnonymous=false;
_1c.isPanels=this.isPanels;
_1c.isCCM=_14.isCCM;
_1c.tornOff=this.tornOff;
_1c.createPersonPhotoLink=this.createPersonPhotoLink;
if(this.createPersonLink){
_1c.createPersonLink=_c.hitch(this,function(_38){
var a=this.createPersonLink(_38);
if(a){
a.setAttribute("target","_blank");
}else{
this.createPersonLink=false;
_1c.createPersonLink=undefined;
return;
}
return a;
});
}
if(_c.isFunction(_1c.layer2)){
_1c.layer2().then(function(_39){
_c.mixin(_1c,_39);
_1c.restrictUserInComm=!!dojo.getObject("lconn.files.config.communityFiles.restrictUserInComm");
});
}
},_setUser:function(){
if(!_c.getObject("currentUser.id",false,this)){
var ids=_1b("ids");
if(ids){
_c.setObject("currentUser.id",ids.split(":")[0],this);
}
}
},postCreate:function(){
this.inherited(arguments);
_9.add(this.viewerContent,"ics-viewer-type-"+this.file.type);
this.file.bean=new _1a(this.file.args);
this.file.args.updateFromBean=_c.hitch(this,this._writeFileBeanToFile);
_9.add(this.viewerContent,this.textDirection);
this._setupSubscriptions();
if(this.file.bean.get("loadError")){
_9.add(this.viewerContent,"loadError");
_1e.publish("ic-fileviewer/push/messages",{type:"warning",cancelable:false,message:_2e.getErrorMessage(this.file.bean.get("loadError"),this.nls.LOAD_ERROR)});
}
if(!this.formatDateByAge&&_17){
this.formatDateByAge=function(_3a,_3b){
var _3c=new _17(_3a);
return _3c.formatByAge(_3b);
};
}
if(!this.htmlSubstitute&&_16){
this.htmlSubstitute=_16.substitute;
}
this.fileTypeIcon=new _2b({file:this.file.bean,fileArgs:this.file.args});
this.fileTypeIcon.placeAt(this.fileTypeIconNode);
this._watches.push(_29.watch("panelSize",_c.hitch(this,function(_3d,_3e,_3f){
this._showDetailsPanel(_3f!==VIEWER_PANELS_CLOSED_SIZE);
})));
this._watches.push(this.file.bean.watch("name",_c.hitch(this,function(_40,_41,_42){
if(_42&&_41!==_42){
_1e.publish("ic-fileviewer/filenamechanged",{newFileName:_42});
this._setTitleText();
}
})));
_35.setFile(this.file);
this._checkUrlParameters();
this._setPreviewWidget();
this._addActions();
this._configNav();
this._renderLastUpdated();
this._fixTabOrder();
this._listenForKeys();
this._setupPropertyWatch();
this._updateExternalIcon();
this._updateLinkTarget(this.titleLinked);
this._updateLinkTarget(this.fileDetails);
this._updateLinkTarget(this.fileDetailsCCM);
if(this.file.args.showDetailsExternalAction){
_12.set(this.fileDetails,"style","display: none;");
}else{
_12.set(this.fileDetailsCCM,"style","display: none;");
}
if(this.isPanels(this.file)){
_a.empty(this.panelNavContainer);
_9.add(this.panelNavContainer,"active-panels");
this.file.bean.unmarkDirty();
this.panelNav=new _19({file:this.file.bean,container:this.panelContainer,panelUrlParameterId:this._initialPanelId});
this.panelNav.placeAt(this.panelNavContainer);
var _43=this.file.bean;
_28.render(_43);
this._subscriptions.push(_1e.subscribe("lconn/share/action/completed",function(_44){
if(_44.hasOwnProperty("autoPublish")&&!_44.autoPublish){
_28.render(_43);
}
}));
}
this._setupTitle();
if(_34.isResizeEnabled()&&dojo.isIE!=8){
this.dragbar=new _2a({model:_29,panelLocation:this.panelLocation});
this.dragbar.placeAt(this.viewerContent);
}
if(this.file.bean.get("loadError")){
this._originalPanelSize=_29.get("panelSize");
_29.set("panelSize",window.VIEWER_PANELS_CLOSED_SIZE);
}
if(!has("fileviewer-panels-textnav")){
on(window,"resize",_c.hitch(this,"_updateHeaderActionIconHorizontalMargins",this.viewerContent));
}
_32.execute(this.welcomeContainer,this.file);
this._sendMetricsEvents();
_35.setPreview(this.preview.previewId);
_35.track("open",{"defaultType":"Event","openAction":(this.source?this.source:"")});
window.addEventListener("message",_c.hitch(this,function(_45){
if(_45.data){
var _46=_45.data;
if(typeof _46==="string"){
try{
_46=JSON.parse(_46);
}
catch(e){
}
}else{
_46=_c.clone(_46);
}
if(_46.event==="ic-fileviewer/previewFailed"){
if(_46.errorMessage){
this._onError();
_1e.publish("ic-fileviewer/push/messages",{type:"warning",cancelable:false,message:_46.errorMessage,errorCode:_46.errorCode});
}
}
}
}));
},_sendMetricsEvents:function(){
if(this.tracker&&!this.file.bean.get("loadError")&&this.openedFromFileViewerEverywhere){
if(_14.isCCM(this.file)){
var _47=this.file.bean.get("ccmBean");
if(_47){
var _48=_47.published;
var _49=this.file.bean.get("links");
var _4a;
if(_49){
_4a=_49.entry;
}
var _4b;
if(_4a){
var _4c=_1c.coreUrl.parse(_4a).path;
_4b=_4c.substring(_4c.indexOf("/library/")+9,_4c.indexOf("/document/"));
if(_4b){
_4b=decodeURIComponent(_4b);
}
}
var _4d={source:"ECM",userId:this.currentUser.id,community:window.communityUuid||"",extra:{contentTitle:_47.title,contentContainerId:_4b?_4b:"",contentCreatorId:_47.author.id,contentCreateTs:_48?dojo.date.stamp.toISOString(_48):"",contentLink:_47.urlAlternate}};
this.tracker.read(_47.id,"FILESUMMARY",_4d);
}
}else{
var _4d={source:"FILES",userId:this.currentUser.id,community:this.file.bean.get("communityId")||"",extra:{contentContainerId:this.file.bean.get("libraryId"),contentCreateTs:this.file.bean.get("created"),contentCreatorId:this.file.bean.get("author").id,contentLink:_23.getRelativeUri(this.file.bean.get("links").details),contentTitle:this.file.bean.get("name")}};
this.tracker.read(this.file.bean.get("id"),"FILESUMMARY",_4d);
}
}
},startup:function(){
this.inherited(arguments);
if(_34.isTextNavEnabled()&&!_14.isCCM(this.file)){
this.panelNav.startup();
}
if(_34.isResizeEnabled()&&dojo.isIE!=8){
this.dragbar._listenForKeyboard(this.panelNavContainer);
}
},_updateHeaderActionIconHorizontalMargins:function(_4e){
var _4f=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;
if(_4f<=_37){
_9.add(_4e,_36);
}else{
_9.remove(_4e,_36);
}
},_setupSubscriptions:function(){
this._subscriptions.push(_1e.subscribe("ic-fileviewer/push/messages",_c.hitch(this,function(_50){
if(_50 instanceof Object){
this._createMessage(_50);
}
_35.track("message",{"defaultType":"Event","messageType":(_50.type?_50.type:""),"errorCode":(_50.errorCode?_50.errorCode:"")});
})));
this._subscriptions.push(_1e.subscribe("ic-fileviewer/push/clearMessages",_c.hitch(this,function(_51){
this._removeAllMessages(_51);
})));
this._subscriptions.push(_1e.subscribe("ic-fileviewer/refresh",_c.hitch(this,function(){
this._refresh();
})));
this._subscriptions.push(_1e.subscribe("ic-fileviewer/changedExtension",_c.hitch(this,function(){
this._refresh();
})));
this._subscriptions.push(_1e.subscribe("lconn/share/action/completed",_c.hitch(this,function(_52){
if(_52&&_52.autoPublish&&_d.DOCS_STATUS_MESSAGE.AUTOPUBLISH&&(_52.fileID==this.file.bean.get("id")||!_52.fileID)){
if(!has("fileviewer-ir-autopublish")){
_1e.publish("ic-fileviewer/push/messages",{type:"info",cancelable:true,message:this._createAutopublishMessage()});
}
}else{
if(_52&&_52.fileChange&&!_52.isFromFileViewer){
_1e.publish("ic-fileviewer/refresh");
}
}
})));
this._subscriptions.push(this.file.bean.watch("dateModified",function(_53,_54,_55){
if(_54&&_27.compare(_55,_54)>0){
_1e.publish("ic-fileviewer/refreshPreview");
}
}));
this._subscriptions.push(_1e.subscribe("ic-fileviewer/refreshPreview",_c.hitch(this,"_setPreviewWidget")));
this._subscriptions.push(_1e.subscribe("ic-fileviewer/push/removeMessage",_c.hitch(this,function(_56){
this._removeMessage(_56);
})));
this._subscriptions.push(_1e.subscribe("ic-fileviewer/content/toggleClass",_c.hitch(this,function(_57){
_9.toggle(this.previewContainer,_57.className);
})));
this._subscriptions.push(_1e.subscribe("ic-fileviewer/resetFocus",_c.hitch(this,function(_58){
_10.focus(this.firstFocusable);
})));
},_createAutopublishMessage:function(){
var _59,_5a;
_59=_d.DOCS_STATUS_MESSAGE.AUTOPUBLISH.IN_PROGRESS;
_59=_59.replace("${startLink}","<a href=\"javascript:;\">").replace("${endLink}","</a>");
_5a=_a.create("span",{innerHTML:_59});
_13("a",_5a).forEach(function(el){
on(el,"click",function(){
_1e.publish("ic-fileviewer/refresh");
});
});
return _5a;
},_removeSubscriptions:function(){
_7.forEach(this._subscriptions,function(_5b){
_5b.remove();
});
},_refresh:function(){
this._removeAllMessages({forceRemove:true});
this._refreshActions();
this._setTitleText();
this._setPreviewWidget();
_28.render(this.file.bean);
},_refreshActions:function(){
this._addActions(true);
},_checkUrlParameters:function(){
var _5c=_2f.getFileParameters(),_5d=false;
_31.setInitialFollowState(undefined);
if(_5c.subscribe||_5c.unsubscribe){
if(!_1c.isAuthenticated){
_1c.login();
}
var _5e;
if(_5c.subscribe){
_5e=true;
}else{
if(_5c.unsubscribe){
_5e=false;
}
}
_31.setInitialFollowState(_5e);
_5d=true;
}else{
if(_5c.section){
this._initialPanelId=_5c.section;
_5d=true;
}
}
if(_5d){
_30.removeFileParameters(this.file);
}
},_setPreviewWidget:function(){
this._writeFileBeanToFile();
if(this.preview){
this.preview.destroy();
}
_7.some(_5,function(_5f){
if(_5f.isValid(this.file)){
this.preview=_5f.create({file:this.file,entitlements:this.entitlements,errorHandler:_c.hitch(this,this._onError),services:this.services,previewOptions:this.previewOptions});
this.preview.placeAt(this.previewContainer);
return true;
}
},this);
},_addActions:function(_60){
var li,_61,_62,_63=0,_64={file:this.file,entitlements:this.entitlements,services:this.services,properties:this.properties,currentUser:this.currentUser||{},viewerActions:{close:_c.hitch(this,"_close"),showDetailsPanel:_c.hitch(this,"_showDetailsPanel")}},_65=[],_66=[],_67=[],_68=[];
_a.empty(this.actionContainer);
if(_60){
_60=false;
delete this._moreActionsDropDownMenuButton;
delete this._splitDropDownMenuButton;
}
_7.forEach(_6,function(_69){
if(this.file.bean.get("loadError")&&!_69.isOverlayAction){
return;
}
if(_69.isSplitButtonItem){
_67.push(_69);
_68.push(_22(_69.isValid(this.file,_64)));
}else{
if((_69.isSubItem||_63>=2)&&!_69.isSticky){
if(this.isPanels(this.file)){
if(!this._moreActionsDropDownMenuButton){
this._moreActionsDropDownMenuButton=new _1f({nls:this.nls.MORE_ACTIONS,subMenu:{className:"ics-viewer-more-actions"},subMenuMarginTop:"17px"});
li=_a.create("li",{className:"ics-viewer-action "+this._moreActionsDropDownMenuButton.getClassName()+" ics-viewer-more-actions"},this.actionContainer);
this._moreActionsDropDownMenuButton.placeAt(li);
}
_65.push(_69);
_66.push(_22(_69.isValid(this.file,_64)));
}
}else{
if(_69.isValid(this.file,_64)){
_64.parentNode=li=_a.create("li",{className:"ics-viewer-action "+_69.getClassName()},this.actionContainer);
_61=this._createActionWidget(_69,_64);
_61.placeAt(li);
this.lastAction=_61;
if(_69.realAction===undefined||_69.realAction){
_63++;
}
}
}
}
},this);
all(_68).then(_c.hitch(this,function(_6a){
var _6b=[];
_7.forEach(_6a,function(_6c,_6d){
if(_6c){
_6b.push(_6d);
}
});
if(_6b.length>1){
if(has("file-viewer-panels")||has("fileviewer-panels")){
if(!this._splitDropDownMenuButton){
if(_34.isOffice365Enabled()&&!_34.isOffice365EnabledWithoutDocsEditor()){
this._splitDropDownMenuButton=new _20({nls:this.nls.ACTION.EDIT_OFFICE,subMenu:{className:"ics-viewer-action-splitmenu"}});
}else{
this._splitDropDownMenuButton=new _20({nls:this.nls.SPLIT_ACTION.MENU,subMenu:{className:"ics-viewer-action-splitmenu"}});
}
li=_a.create("li",{className:"ics-viewer-action "+this._splitDropDownMenuButton.getClassName()+" ics-viewer-action-splitmenu"},this.actionContainer,"first");
this._splitDropDownMenuButton.placeAt(li);
if(_34.isOffice365Enabled()&&!_34.isOffice365EnabledWithoutDocsEditor()){
this._subscriptions.push(_1e.subscribe("ic-fileviewer/toggleActionDropdown",_c.hitch(this,function(){
this._splitDropDownMenuButton.togglePopupMenu();
if(this._splitDropDownMenuButton._menuItems[0]){
this._splitDropDownMenuButton._menuItems[0].focus();
}
})));
}
}
_7.forEach(_6a,function(_6e,i){
_62=_67[i];
if(_6e){
_61=this._createActionWidget(_62,_64);
this._splitDropDownMenuButton.addMenuItem(_61,_c.hitch(_61,_61.onLinkClicked));
}
i++;
},this);
}
}
if(_6b.length>=1){
var _6f=this._getPrimaryButton(this.file.bean,_67,_6b)||_67[_6b[0]];
var _70=_6f.getActionCategory().toUpperCase();
var _71=this.nls.SPLIT_ACTION.BUTTON[_70]||this.NLS_SPLIT_ACTION_FALLBACK.BUTTON[_70];
_64.splitButtonName=_71.TITLE;
_64.parentNode=li=_a.create("li",{className:("ics-viewer-action "+_6f.getClassName()+((_6b.length>1)?" ics-viewer-splitbutton":""))},this.actionContainer,"first");
if(this._splitDropDownMenuButton){
this._splitDropDownMenuButton.setSubmenuAroundNode(li);
}
_61=this._createActionWidget(_6f,_64);
_61.placeAt(li);
}
}));
all(_66).then(_c.hitch(this,function(_72){
_7.forEach(_72,function(_73,i){
_62=_65[i];
if(_73){
_61=this._createActionWidget(_62,_64);
this._moreActionsDropDownMenuButton.addMenuItem(_61,_c.hitch(_61,_61.onLinkClicked),{className:_62.getClassName()});
}
i++;
},this);
this._addExtensionActions();
}));
},_getPrimaryButton:function(_74,_75,_76){
if(_75[_76[0]].getClassName()==="ics-viewer-action-edit"&&!_74.isDocsFile){
var _77=_7.filter(_76,function(idx){
return _75[idx].getClassName()==="ics-viewer-action-upload";
});
if(_77.length>0){
return _75[_77[0]];
}
}
return null;
},_addExtensionActions:function(){
_22(_2c.getExtensions(),_c.hitch(this,function(_78){
var _79=_2d.createActions(_78,this.file.bean);
_7.forEach(_79,function(_7a){
this._moreActionsDropDownMenuButton.addMenuItem(_7a,_c.hitch(_7a,_7a.execute,this.file.bean));
},this);
}));
},_createActionWidget:function(_7b,_7c){
var _7d=_7b.create(_7c);
return _7d;
},_configNav:function(){
var _7e=["previous","next"];
_7.forEach(_7e,function(_7f){
var dom=_7f;
if(this.rtl){
dom=_7e[1-_7.indexOf(_7e,_7f)];
}
if(this.file.paging[_7f]){
_b.set(this[dom+"Name"],this.file.paging[_7f].args.name);
_9.add(this[dom+"Icon"],_14.getIconClass(this.file.paging[_7f].args,16));
_12.set(this[dom+"Arrow"],"tabindex",0);
if(this.source===_7f){
setTimeout(_c.hitch(focus,"focus",this[dom+"Arrow"],1));
}
}else{
_9.add(this[dom],"ics-viewer-nav-disabled");
}
},this);
},_renderLastUpdated:function(){
var _80=this.file.args.created,_81=this.file.args.updated,_82=this.nls.DATE.CREATED||this.nls.DATE.LAST_UPDATED,_83;
if(_80.getTime()<_81.getTime()){
_80=_81;
_82=this.nls.DATE.LAST_UPDATED;
}
_83=this.formatDateByAge(_80,_82);
var _84;
if(_c.isFunction(_1c.createPersonLink)){
_84=_1c.createPersonLink;
}else{
_84=this._createUserLink;
}
this.htmlSubstitute(win.doc,this.lastUpdated,_83,{user:_c.hitch(this,_84,this.file.args.modifier)});
},_createUserLink:function(_85){
var _86=_a.create("span");
_a.create("span",{className:"x-lconn-userid",style:"display: none;",innerHTML:_85.id},_86);
if(!_c.isFunction(this.createPersonLink)){
_86.appendChild(_a.toDom(_85.name));
}else{
_86.appendChild(this.createPersonLink(_85));
if(_c.isFunction(this.attachBizCard)){
this.attachBizCard(_86);
}
}
return _86;
},_fixTabOrder:function(){
on(this.firstFocusable,"keydown",_c.hitch(this,"_onKeyPressFirstFocusable"));
_13("body > *").forEach(function(el){
if(!this._isBizcard(el)){
on(el,"focusin",_c.hitch(this,function(evt){
evt.preventDefault();
_10.focus(this.firstFocusable);
}));
}
},this);
},_onKeyPressFirstFocusable:function(evt){
if(evt.keyCode===_f.TAB&&evt.shiftKey){
evt.preventDefault();
_10.focus(_11.getLastInTabbingOrder(this.domNode));
}
},_listenForKeys:function(){
this.keyListener=on(win.body(),"keydown",_c.hitch(this,function(evt){
if(evt.keyCode===_f.ESCAPE&&!this._isBizcard()){
this._close(evt);
}
var tag=evt.target.tagName.toLowerCase();
if(tag==="select"||tag==="input"||tag==="textarea"||_9.contains(evt.target,"lotusMentionsDiv")){
return;
}
if(evt.fidoIgnoreEvent){
return;
}
switch(evt.keyCode){
case _f.LEFT_ARROW:
this._previous(evt);
break;
case _f.RIGHT_ARROW:
this._next(evt);
break;
case _f.UP_ARROW:
case _f.DOWN_ARROW:
case _f.PAGE_UP:
case _f.PAGE_DOWN:
evt.stopPropagation();
evt.preventDefault();
break;
}
}));
},_previous:function(evt){
evt.stopPropagation();
_35.track("previous");
this._page(this.ltr?"previous":"next");
},_next:function(evt){
evt.stopPropagation();
_35.track("next");
this._page(this.ltr?"next":"previous");
},_page:function(_87){
if(this.file.paging[_87]){
this.keyListener.remove();
this._writeFileBeanToFile();
this.open(this.file.paging[_87].id,_87);
}
},_writeFileBeanToFile:function(){
this.file.args.name=this.file.bean.get("name");
this.file.args.type=this.file.bean.get("type");
this.file.args.objectTypeId=this.file.bean.get("objectTypeId");
},_close:function(evt){
if(evt){
evt.stopPropagation();
evt.preventDefault();
}
this.keyListener.remove();
_7.forEach(this._subscriptions,function(_88){
_88.remove();
});
_35.track("close");
_1e.publish("ic-fileviewer/close");
},_showDetailsPanel:function(_89){
var _8a=_89?"add":"remove";
_9[_8a](this.viewerContent,"ics-viewer-details-expanded");
},_onError:function(_8b){
var _8c=this.preview;
this.preview.destroy();
this.preview=_5[_5.length-1].create({file:this.file,userMessage:_8b});
if(this.previewContainer){
this.preview.placeAt(this.previewContainer);
}
_35.track("previewError",{"defaultType":"Event","newPreview":this.preview.previewId});
_35.setPreview(this.preview.previewId);
},_updateLinkTarget:function(el){
if(_1c.isVerse){
_12.set(el,"target","_blank");
}
},_setupPropertyWatch:function(){
var _8d=["visibility","recommendations","version","name","isExternal","isLocked"];
_7.forEach(_8d,_c.hitch(this,function(_8e){
this.file.bean.watch(_8e,_c.hitch(this,function(_8f,_90,_91){
if(_91!==undefined&&_90!==undefined&&_91!==_90){
_1e.publish("ic-fileviewer/dirty",_8f,_91);
this._updateExternalIcon();
}
}));
}));
this.file.bean.watch("isSyncable",_c.hitch(this,function(_92,_93,_94){
var _95=this.file.bean.get("isSyncable");
this._updateMyFileSyncIcon(_95);
}));
},_updateExternalIcon:function(){
_9.remove(this.externalIconDiv,"lotusHidden");
if(!this.file.bean.get("isExternal")){
_9.add(this.externalIconDiv,"lotusHidden");
}
},_updateMyFileSyncIcon:function(_96){
_9.remove(this.myFileSyncIconDiv,"lotusHidden");
if(!_96){
_9.add(this.myFileSyncIconDiv,"lotusHidden");
}
},_setupTitle:function(){
this._setTitleText();
if(!this.file.bean.get("loadError")){
_22(_21.isValid(this.file.bean),_c.hitch(this,function(_97){
if(!_97){
this._setTitlePreviewClass();
this._setTitlePreviewMessage();
return;
}
this._setTitleTooltip();
var _98=this.titleLinked;
on(_98,"click",_c.hitch(this,function(){
var _99=new _21.create({file:this.file.bean,filenameNode:this.titleLinked});
_99.onLinkClicked();
}));
}));
}
},_setTitleText:function(){
_12.set(this.titleLinked,"innerHTML",this.file.bean.get("name"));
},_setTitleTooltip:function(){
_12.set(this.titleLinked,"title",this.nls.FILENAME_TOOLTIP);
},_setTitlePreviewClass:function(){
_9.add(this.titleLinked,"preview");
},_setTitlePreviewMessage:function(){
var _9a=_a.create("div",{className:"lotusOffScreen",innerHTML:this.nls.FILE_VIEWER_TITLE});
this.titleLinked.appendChild(_9a);
},_createMessage:function(_9b){
this._removeAllMessages();
if(_9b.cancelable===undefined){
_9b.cancelable=true;
}
if(_9b.focus===undefined){
_9b.focus=true;
}
if(_9b.focusPostClose===undefined){
_9b.focusPostClose=document.activeElement;
}
var _9c=_25.create(_9b);
this._messages.push(_9c);
_9c.placeAt(this.messageContainer);
_9c.startup();
this._subscriptions.push(_26.before(_9c,"_close",_c.hitch(this,function(){
this._messages.splice(_9c.pos,1);
})));
},_removeMessage:function(_9d){
_7.forEach(this._messages,function(_9e){
if(_9e.messageOptions===_9d){
_9e.destroy();
}
},this);
},_removeAllMessages:function(_9f){
var _a0=(_9f&&_9f.forceRemove!==undefined)?_9f.forceRemove:false;
_7.forEach(this._messages,function(_a1){
if(!_a1.isSticky||_a0){
_a1.destroy();
}
},this);
},destroy:function(){
this._removeSubscriptions();
this._removeWatches();
_33.reset();
if(this.file.bean.get("loadError")){
_29.set("panelSize",this._originalPanelSize);
}
this.inherited(arguments);
},_removeWatches:function(){
_7.forEach(this._watches,function(_a2){
_a2.remove();
});
},_getBannerMarginRight:function(_a3){
if(!_a3||_34.isTextNavEnabled()){
return 0;
}
return _a3+"px";
},isPanels:function(_a4){
var ret=false;
if(_a4){
if(!_14.isCCM(_a4)){
if(has("file-viewer-panels")||has("fileviewer-panels")){
ret=true;
}
}
}
return ret;
},onLinkClicked:function(evt){
if(this.file.args.showDetailsExternalAction){
this.file.args.showDetailsExternalAction(this,this.file.args.ccmBean,evt);
evt.stopPropagation();
evt.preventDefault();
}
},_isBizcard:function(el){
var _a5=dom.byId("semtagmenu");
if(!el){
el=_10.curNode;
}
if(dom.isDescendant(el,_a5)){
return true;
}
return false;
}});
});


;define("ic-share/fileviewer/data/FilesAPI",["dojo/_base/declare","dojox/xml/parser","dojo/_base/array","dojo/dom-attr","dojo/date/stamp","dojo/Deferred","../network/request","dojo/_base/lang","../util/network","./FileEntryDataStore"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
"use strict";
var NS,_b;
NS={TD:{LONG:"urn:ibm.com/td",SHORT:"td"},SNX:{LONG:"http://www.ibm.com/xmlns/prod/sn",SHORT:"snx"}};
_b=_1([],{constructor:function(_c){
this.xml=_c;
},getName:function(){
return this._getChildTextNS("label",NS.TD);
},getExtension:function(){
return this._getExtension(this.getName());
},getSize:function(){
return parseInt(this._getLinkAttrByRel("enclosure","length"),10);
},getTotalSize:function(){
return this._getChildTextNS("totalMediaSize",NS.TD);
},getId:function(){
return this._getChildTextNS("uuid",NS.TD);
},getDateCreated:function(){
return this._getChildDate("created");
},getDateModified:function(){
return this._getChildDate("modified");
},getAuthor:function(){
return this._getUser("author");
},getModifier:function(){
return this._getUser("modifier",NS.TD);
},isEncrypted:function(){
return this._getChildTextNS("encrypt",NS.TD)==="true";
},getVisibility:function(){
return this._getChildTextNS("visibility",NS.TD);
},getTypeId:function(){
return this._getChildTextNS("objectTypeId",NS.TD);
},getDownloadUrl:function(){
return this._getLinkAttrByRel("enclosure","href");
},getWebUrl:function(){
return this._getLinkAttrByRel("alternate","href");
},getThumbnailUrl:function(){
return this._getLinkAttrByRel("thumbnail","href");
},getAlternateUrl:function(){
return this._getLinkAttrByRel("alternate","href");
},getRecommendationUrl:function(){
return this._getLinkAttrByRel("recommendation","href");
},getUrlEntry:function(){
return this._getLinkAttrByRel("self","href");
},getVersionCount:function(){
return this._getChildTextNSScheme("rank",NS.SNX,"versions");
},getVersion:function(){
return this._getChildTextNS("versionLabel",NS.TD);
},getRatingCount:function(){
return this._getChildTextNSScheme("rank",NS.SNX,"recommendations");
},getCommentCount:function(){
return this._getChildTextNSScheme("rank",NS.SNX,"comment");
},getTimesDownloaded:function(){
return this._getChildTextNSScheme("rank",NS.SNX,"hit");
},getTimesDownloadedAnonymously:function(){
return this._getChildTextNSScheme("rank",NS.SNX,"anonymous_hit");
},getDescription:function(){
return this._getChildText("summary");
},getMimeType:function(){
return this._getLinkAttrByRel("enclosure","type");
},getMalwareScanState:function(){
return this._getChildTextNS("malwareScanState",NS.TD);
},getTags:function(){
var _d=[];
var _e=this.xml.getElementsByTagName("category");
_3.forEach(_e,function(_f){
if(_f.getAttribute("scheme")==null){
_d.push(_f.getAttribute("term"));
}
});
return _d;
},getLibraryType:function(){
return this._getChildTextNS("libraryType",NS.TD);
},getLibraryId:function(){
return this._getChildTextNS("libraryId",NS.TD);
},getPropagation:function(){
return this._getChildTextNS("propagation",NS.TD)==="true";
},getPermissions:function(){
var _10={},_11;
_11=this._getChildTextNS("permissions",NS.TD);
if(_11){
_3.forEach(_11.split(", "),function(_12){
if(_12){
_10[_12]=true;
}
});
}
return _10;
},isExternal:function(){
return this._getChildTextNS("isExternal",NS.SNX)==="true";
},_getExtension:function(_13){
var _14=_13.lastIndexOf(".");
if(_14<0){
return "";
}
return _13.slice(_14+1);
},_getLinkAttrByRel:function(rel,_15){
var _16=_3.filter(this.xml.getElementsByTagName("link"),function(_17){
return _17.getAttribute("rel")===rel;
});
return _16[0]?_16[0].getAttribute(_15):"";
},_getChildText:function(_18,_19){
return this._getChildTextNS(_18,undefined,_19);
},_getChildTextNS:function(_1a,_1b,_1c){
var _1d=this._getFirstTag(_1a,_1b,_1c);
if(_1d){
return _2.textContent(_1d);
}
},_getChildTextNSScheme:function(_1e,_1f,_20,_21){
if(!_21){
_21=this.xml;
}
var _22="";
var _23=this._getAllTags(_1e,_1f,_21);
var url=_1f.LONG+"/"+_20;
_3.forEach(_23,function(_24){
if(_24.attributes.scheme&&_24.attributes.scheme.value===url){
_22=_2.textContent(_24);
}
});
return _22;
},_getChildDate:function(_25){
return _5.fromISOString(this._getChildTextNS(_25,NS.TD));
},_getUser:function(_26,_27){
var _28=this._getFirstTag(_26,_27);
if(!_28){
return {};
}
return {name:this._getChildText("name",_28),id:this._getChildTextNS("userid",NS.SNX,_28),email:this._getChildText("email",_28),userState:this._getChildTextNS("userState",NS.SNX,_28)};
},_getFirstTag:function(_29,_2a,_2b){
return this._getAllTags(_29,_2a,_2b)[0];
},_getAllTags:function(_2c,_2d,_2e){
if(!_2e){
_2e=this.xml;
}
if(_2d){
return (_8.isFunction(_2e.getElementsByTagNameNS))?_2e.getElementsByTagNameNS(_2d.LONG,_2c):_2e.getElementsByTagName(_2f(_2e,_2d)+_2c);
}
return _2e.getElementsByTagName(_2c);
}});
function _2f(el,_30){
for(var _31=el,_32=null;_31&&!_32&&_31.nodeType==1;_31=_31.parentNode){
_32=_31.getAttribute("xmlns");
}
var _33=(_32==_30.LONG)?"":(_30.SHORT+":");
return _33;
};
function _34(xml){
if(typeof xml==="string"){
xml=_2.parse(xml);
}
return new _b(xml);
};
function _35(url){
var _36=new _6();
_7(url,{handleAs:"xml",withCredentials:true,query:{acls:true,includeNotification:true,includePolicy:true,includeRecommendation:true,includeTags:true,includeLibraryInfo:true,includeDownloadInfo:true,inline:true,rank:true}}).then(function(xml){
var _37=_34(xml);
_a._cachedEntry={loadTime:(new Date()).getTime(),fileId:_37.getId(),content:xml};
_36.resolve(_37);
},function(_38){
_36.reject(_9.parseError(_38));
});
return _36;
};
return {fromEntryXML:_34,fromEntryURL:_35,_getTestInstance:function(){
return new _b();
}};
});


;define("ic-share/fileviewer/FileViewer",["dojo/_base/declare","dojo/_base/window","./FileViewerImpl","dojo/_base/lang","dojo/dom-class","dijit/focus","./data/FilesAPI","dojo/Evented","dojo/topic","dojo/_base/array","dojo/hash","dojo/i18n!./nls/FileViewerStrings","./util/network","./util/history","ic-core/util/connectionsUrlUtil","dojo/has","./config/globals","./util/url","dojo/on","dojo/aspect","dojo/promise/all","./network/request","./preview/util","./data/util/routes","dojo/Deferred","ic-ui/DialogUtil","dojo/when","dojo/string","./dialog/ConfirmationDialog","dojo/dom-style"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,has,_10,_11,on,_12,all,_13,_14,_15,_16,_17,_18,_19,_1a,_1b){
"use strict";
var _1c,_1d,_1e,_1f={isOpening:false,isOpen:false,justClosed:false};
_4.setObject("ic-share.fileviewer.FileViewer.shouldIgnoreUrlChange",function(){
if(!has("fileviewer-detailspage")){
return false;
}
var _20=window.location.href;
return (_1f.isOpen&&_11.areUrlsEqual(_20,_e.currentFileUrl))||((_1f.isOpen||_1f.justClosed)&&_11.areUrlsEqual(_20,_e.backgroundPageUrl))||_f.shouldOpenConnectionsPreview(_20);
});
_4.setObject("ic-share.fileviewer.FileViewer.isOpen",function(){
return _1f.isOpen;
});
_1c={create:function(_21){
return new _1d(_21);
},createConnectionsFileFromId:function(id,_22){
var _23=_4.getObject("notesiniParameters.bssUrl")||"",_24=_22?"":"/anonymous";
return _1c.createConnectionsFileFromUrl(_23+"/files/basic"+_24+"/api/document/"+id+"/entry",id);
},createConnectionsFileFromUrl:function(url,id){
return {type:"connections",paging:{},args:url,fileId:id};
},createConnectionsFile:function(_25){
return {type:"connections",paging:{},args:{name:_25.getName(),type:_25.getExtension(),id:_25.getId(),size:_25.getSize(),totalSize:_25.getTotalSize(),created:_25.getPublished(),updated:_25.getUpdated(),modifier:_25.getModifier(),author:_25.getAuthor(),isEncrypted:_25.isEncrypted(),objectTypeId:_25.getObjectTypeId(),permissions:_25.getPermissions(),libraryType:_25.getLibraryType(),libraryId:_25.getLibraryId(),libraryAuthor:_25.getLibraryAuthor(),visibility:_25.getVisibility(),canOthersShare:_25.isViralShareAllowed(),recommendationUrl:_25.getUrlRecommendation(),isExternal:_25.isExternal(),links:{download:_25.getUrlDownload(),details:_25._urlDetails||_25.getUrlVia(),thumbnail:_25.getUrlThumbnail(),entry:_25.getUrlEntry(),alternate:_25.getUrlAlternate()},versionCount:_25.getVersionCount(),version:_25.getCurrentVersionLabel(),recommendations:parseInt(_25.getRatingCount()),comments:_25.getCommentCount(),downloads:_25.getTimesDownloaded(),downloadsAnonymous:_25.getTimesDownloadedAnonymously(),summary:_25.getDescription(),tags:_25.getTags(),mimeType:_25.getMimeType(),showDetailsExternalAction:_25.showDetailsExternalAction,ccmBean:_25.ccmBean,repositoryName:_25.getRepositoryName(),cmisVersionSeriesId:_25.getCMISVersionSeriesId(),draftStatus:_25.getDraftStatus(),cmisDocumentId:_25.getCMISDocumentId(),cmisVersionId:_25.getCMISVersionId(),malwareScanState:_25.getMalwareScanState()}};
},createVerseAttachment:function(_26){
return {type:"verse",paging:{},args:{name:_26.name,type:_26.extension,id:"",size:_26.size,created:new Date(),updated:new Date(),modifier:"",isEncrypted:false,objectTypeId:"",links:{download:_26.url,details:"",thumbnail:""},preview:_26.preview}};
}};
_1d=_1([_8],{constructor:function(_27){
this._files=[];
this._args=_27||{};
this._subscriptions=[];
this._eventHandles=[];
this._messages=[];
_10.isAuthenticated=!_4.isFunction(this._args.isAuthenticated)||this._args.isAuthenticated();
_10.isIframePage=this._args.isIframePage;
_10.coreServices=this._args.coreServices;
},addFile:function(_28){
var _29;
if(typeof _28==="string"){
_28=_1c.createConnectionsFileFromId(_28,this._args.isAuthenticated());
}else{
if(!_28.args){
_28=_1c.createConnectionsFile(_28);
}
}
this._files.push(_28);
_29=this._files.length-1;
_28.id=_29;
if(_29>0){
this._files[_29].paging.previous=this._files[_29-1];
this._files[_29-1].paging.next=this._files[_29];
this._files[0].paging.next=this._files[1];
this._files[1].paging.previous=this._files[0];
}
return _29;
},open:function(id,_2a){
if(!id||id<0){
id=0;
}
_1f.isOpening=true;
this.close();
this.closed=false;
if(_1e){
_1e.close();
}
this._subscriptions.push(_9.subscribe("/dojo/hashchange",_4.hitch(this,this._handleUrlChange)));
this._subscriptions.push(_9.subscribe("ic-fileviewer/dirty",_4.hitch(this,function(){
this.isDirty=true;
})));
this._subscriptions.push(_9.subscribe("ic-fileviewer/action/completed",_4.hitch(this,function(_2b){
this.close(_2b);
})));
this._subscriptions.push(_9.subscribe("ic-fileviewer/close",_4.hitch(this,function(_2c){
this.close(_2c);
})));
this._subscriptions.push(_9.subscribe("ic-fileviewer/push/message",_4.hitch(this,function(_2d){
this._messages.push(_2d);
})));
if(typeof this._files[id].args!=="string"){
this._loadAuthInfo();
this._open(id,_2a);
}else{
var _2e=this._files[id];
var _2f=_7.fromEntryURL(_2e.args).promise;
var _30=this._loadAuthInfo().promise;
var _31=this._args.openedFromFileViewerEverywhere?_11.isValidFilesUrl(this._args.linkTarget):_18(true);
var _32={file:_2f,isFilesFile:_31};
if(this._args.loadCurrentUser){
_32.authInfo=_30;
}
_31.then(_4.hitch(this,function(_33){
if(!_33){
window.location=this._args.linkTarget;
}
})).otherwise(_4.hitch(this,function(_34){
_34=_d.parseError(_34);
if(_34.code!=="Unauthenticated"){
var _35=_c.ERROR_VALIDATING_FILES_FILE;
var _36=_19.substitute(_35.PROMPT,{lineBreaks:"<br/><br/>"});
_17.prompt(_35.DIALOG_TITLE,_36,_35.OK,_35.CANCEL,_4.hitch(this,function(_37){
if(_37){
window.location.href=this._args.linkTarget;
}
}));
}
this._handleOpenByIdError(_34);
}));
var _38=all(_32);
_31.then(_4.hitch(this,function(_39){
if(!_39){
return;
}
_38.always(_4.hitch(this,function(_3a){
if(_1e){
return;
}
var _3b,_3c,_3d;
if(_38.isResolved()){
_3c=_3a.file;
_3b={name:_3c.getName(),type:_3c.getExtension(),id:_3c.getId(),size:_3c.getSize(),totalSize:_3c.getTotalSize(),created:_3c.getDateCreated(),updated:_3c.getDateModified(),modifier:_3c.getModifier(),author:_3c.getAuthor(),isEncrypted:_3c.isEncrypted(),objectTypeId:_3c.getTypeId(),permissions:_3c.getPermissions(),libraryType:_3c.getLibraryType(),libraryId:_3c.getLibraryId(),visibility:_3c.getVisibility(),canOthersShare:_3c.getPropagation(),recommendationUrl:_3c.getRecommendationUrl(),isExternal:_3c.isExternal(),links:{download:_3c.getDownloadUrl(),details:_3c.getWebUrl(),thumbnail:_3c.getThumbnailUrl(),entry:_3c.getUrlEntry(),alternate:_3c.getAlternateUrl()},versionCount:_3c.getVersionCount(),version:_3c.getVersion(),recommendations:parseInt(_3c.getRatingCount()),comments:_3c.getCommentCount(),downloads:_3c.getTimesDownloaded(),downloadsAnonymous:_3c.getTimesDownloadedAnonymously(),summary:_3c.getDescription(),tags:_3c.getTags(),mimeType:_3c.getMimeType(),malwareScanState:_3c.getMalwareScanState()};
if(_3c.showDetailsExternalAction){
_3b.showDetailsExternalAction=_3c.showDetailsExternalAction;
}
}else{
_3d=_3a;
this._handleOpenByIdError(_3d);
if(this._args.showErrorInOverlay===false||(this._args.isAuthenticated()&&_3d.code==="Unauthenticated"&&!this._args.isIframePage)){
return;
}
_3b=this._getLoadErrorFileArgs(_2e.fileId);
_3b.loadError=_3d;
}
_3b.links.linkTarget=this._args.linkTarget;
_2e.args=_3b;
this.closed=false;
try{
this._open(id,_2a);
if(!this._args.openedFromFileViewerEverywhere){
this._sendMetricsEvent(_2e);
}
}
catch(_3d){
this._publishDefaultError(_3d);
}
}));
}));
}
},_sendMetricsEvent:function(_3e){
var _3f=com.ibm.lconn.layout.track;
var _40={source:"FILES",userId:this._args.currentUser.id,community:_3e.bean.get("communityId")||"",extra:{contentContainerId:_3e.bean.get("libraryId"),contentCreateTs:_3e.bean.get("created"),contentCreatorId:_3e.bean.get("author").id,contentLink:_15.getRelativeUri(_3e.bean.get("links").details),contentTitle:_3e.bean.get("name")}};
_3f.read(_3e.bean.get("id"),"FILESUMMARY",_40);
},_getLoadErrorFileArgs:function(id){
return {name:"",type:"",id:id,size:0,totalSize:0,created:new Date(),updated:new Date(),modifier:{},author:{},isEncrypted:false,objectTypeId:"",permissions:{},libraryType:"",visibility:"",canOthersShare:false,recommendationUrl:"",isExternal:false,links:{download:"",details:"",thumbnail:"",entry:"",alternate:""},versionCount:0,version:0,recommendations:0,comments:0,downloads:0,downloadsAnonymous:0,summary:"",tags:[],mimeType:""};
},_publishDefaultError:function(_41){
_41=_41||new Error();
this.openError=true;
_41.userMessage=_c.OPEN_BY_ID_ERROR.DEFAULT;
this.emit("error",_41);
},_loadAuthInfo:function(){
if(!this._authInfoPromise&&_10.isAuthenticated&&this._args.policy&&this._args.policy.organizationPublic===undefined&&!_14.isCCM(this._files[0])){
this._authInfoPromise=_13(_15.getUserInfoServiceUrl(),{auth:{secured:false},handleAs:"json",noStatus:true}).then(_4.hitch(this,function(_42){
return _42.totalSize?_42.items[0]:{};
}));
this._args.policy=this._authInfoPromise.then(_4.hitch(this,function(_43){
this._args.policy=_10.policy=_43.policy;
return _10.policy;
}));
this._authInfoPromise.then(_4.hitch(this,function(_44){
if(this._args.loadCurrentUser){
this._args.currentUser=_10.currentUser={displayName:_44.name,id:_44.id,email:_44.email,isExternal:_44.isExternal};
}
}),_4.hitch(this,function(){
if(this._args.loadCurrentUser){
this._publishDefaultError();
}
}));
}else{
this._authInfoPromise=new _16();
this._authInfoPromise.resolve();
}
return this._authInfoPromise;
},_handleOpenByIdError:function(_45){
_1f.isOpening=false;
var _46,_47=_c.OPEN_BY_ID_ERROR;
if(_45.code==="AccessDenied"&&!this._args.isAuthenticated()){
_46=_47.ACCESS_DENIED_ANON;
}
_45.userMessage=_46||_d.getErrorMessage(_45,_47);
this.emit("error",_45);
},_open:function(id,_48){
if(this.closed){
return;
}
this.focused=_6.curNode;
_e.onOpen(this._files[id],_1f);
if(_e.historySupported){
this._eventHandles.push(on(window,"popstate",_4.hitch(this,this._handleUrlChange)));
this._eventHandles.push(_12.after(window.history,"pushState",_4.hitch(this,this._handleUrlChange)));
}
this.impl=new _3(_4.mixin({file:this._files[id],text:this._args.text,source:_48,open:_4.hitch(this,"open"),close:_4.hitch(this,"close")},this._args));
if(this.focused){
try{
this.focused.blur();
}
catch(err){
}
}
_1e=this;
_5.add(_2.body(),"ics-viewer-open");
this.impl.placeAt(_2.body());
var _49=this.impl.actionContainer;
var _4a=_49.querySelector("li.ics-viewer-action-close a");
_4a.focus();
this.impl.startup();
_1f.isOpening=false;
_1f.isOpen=true;
this.emit("success");
},close:function(_4b){
var _4c;
if(_10.isUploading){
this.closeWarningDialog();
return;
}
this.closed=true;
_5.remove(_2.body(),"ics-viewer-open");
if(this.impl){
if(_10.tornOff){
_9.publish("ic-fileviewer/windowClose");
}
this.impl.destroy();
}
if(_1e===this){
_1e=null;
if(!_1f.isOpening){
_1f.isOpen=false;
}
_e.onClose(_1f,this.impl.file);
_1f.justClosed=true;
setTimeout(_4.hitch(this,function(){
_1f.justClosed=false;
}),550);
_9.publish("ic-fileviewer/closed");
}
if(this.focused){
setTimeout(_4.hitch(this,function(){
_6.focus(this.focused);
setTimeout(_4.hitch(_6,"focus",this.focused),1);
this.focused=undefined;
}),1);
}
if(this.isDirty){
this.isDirty=false;
if(_4b){
_4b.messages=_4b.messages?this._messages.concat(_4b.messages):this._messages;
}
_4c=_4b||{fileChange:true,messages:this._messages};
_4c.isFromFileViewer=true;
_9.publish("lconn/share/action/completed",_4c,null);
_9.publish("ic/fileviewer/file/changed",_4c);
}else{
if(_4b&&_4b.postMsgs){
_4c={fileChange:false,messages:this._messages};
_9.publish("lconn/share/action/completed",_4c,null);
_9.publish("ic/fileviewer/file/changed",_4c);
}
}
_a.forEach(this._subscriptions,function(_4d){
_4d.remove();
},this);
_a.forEach(this._eventHandles,function(_4e){
_4e.remove();
},this);
},closeWarningDialog:function(){
var _4f=_c.ACTION.CLOSE.WARNING_DIALOG||{DIALOG_TITLE:"Wait for Upload",PROMPT:"Your file is still uploading. If you close before it completes, the upload will be canceled.",CANCEL:"Wait for Upload",OK:"Close Anyway"};
_4f.DIALOG_TITLE=_4f.CANCEL;
this.dialog=new _1a({strings:_4f,showOkRight:true});
this.dialog.on("clicked",_4.hitch(this,function(){
_9.publish("ic-fileviewer/stopUpload");
this.dialog.destroy();
_10.isUploading=false;
this.close();
}));
this.dialog.placeAt(document.body);
this.dialog.startup();
this.dialog.show();
},_handleUrlChange:function(){
if(!has("fileviewer-detailspage")){
this.close();
return;
}
if(window.location.href===_e.currentFileUrl){
return;
}
if(_f.isConnectionsFileUrl(window.location.href)){
_1f.isOpening=true;
}else{
this.close();
}
}});
return _1c;
});


;if(!dojo._hasResource["com.ibm.lconn.layout.track"]){
dojo._hasResource["com.ibm.lconn.layout.track"]=true;
(function com_ibm_lconn_layout_track(){
var _1=dojo.provide("com.ibm.lconn.layout.track");














var _2="quickResultsEnabled";
var _3=0;
var _4=lconn.core.config.services.metrics;
var _5=lconn.core.config.services.search;
var _6=lconn.core.config.services.eventTracker;
var _7=lconn.core.config.properties[_2]==="true";
var _8=_5&&_7;
var _9=lconn.core.config.features("event-tracker-service")&&_6;
if(_4||_8||_9){
_1._addTracker=function(_a,_b,_c){
if(!_a){
return;
}
var _d;
var _e=lconn.core.config.features("event-tracker-service")&&lconn.core.config.features("event-tracker-metrics-via-event-tracker-only");
var _f=lconn.core.config.features("metrics-event-capture-service");
if(!_e&&_4&&_f){
_d=_1.postToTracker(_a,_b,_c,lconn.core.url.getServiceUrl(_4),"/service/eventTracker");
}
if(_9){
_d=_1.postToTracker(_a,_b,_c,lconn.core.url.getServiceUrl(_6),"/eventTracker");
}else{
if(!lconn.core.config.features("event-tracker-service")&&_8&&lconn.core.auth.isAuthenticated()){
_d=_1.postToTracker(_a,_b,_c,lconn.core.url.getServiceUrl(_5),"/eventTracker");
}
}
return _d;
};
}else{
_1._addTracker=function(){
return;
};
}
_1.postToTracker=function(_10,_11,_12,_13,_14){
var dfd;
var _15=dojo.mixin(_13.getQuery(),_10);
if(typeof _11=="object"){
dojo.mixin(_15,_11);
}else{
if(typeof _11=="string"){
_15.data=_11;
}
}
var _16=dojo.config.proxy;
_13.path+=_14;
var _17=_13.toString();
if(_16){
var _18=new lconn.core.url.ProxyUrlHelper(_16);
_17=_18.getProxifiedURL(_17);
}
var _19=function(_1a){
return;
};
var _1b=function(_1c){
return;
};
dfd=dojo.xhrPost({url:_17,sync:_12||false,timeout:10000,load:_19,error:_1b,headers:{"X-Update-Nonce":"true"}});
return dfd;
};
_1.read=function(id,_1d,opt){
opt=opt||{};
if(dojo.config.isDebug){
console.log("Send read event with itemType = "+_1d+", contentId = "+id);
console.log("Options="+dojo.toJson(opt,true));
}
return _1._addTracker({context:opt.context,contentId:id,itemType:_1d,source:opt.source||null,community:opt.communityId||opt.community||null,i:_3++||null},opt.extra,opt.sync);
};
}());
}

dojo.provide("lconn.core.upload.nls.upload")._built=true;
dojo.provide("lconn.core.upload.nls.upload.en_us");
lconn.core.upload.nls.upload.en_us={"STATUS_REMOTE_DUPLICATE_RENAME_CONTEXT_COLLECTION_1":"File named ${0} already exists in this folder. ","ACTIONS_REVERT":"Revert","ACTIONS_UNDO":"Undo","ACTIONS_TRUNCATE":"Shorten name","STATUS_REMOTE_DUPLICATE_RENAME_AND_REPLACE_ACTION":"Continue to upload as a new version or rename the file. ${0}","UI_REMOVE":"Remove ${0}","STATUS_REMOTE_DUPLICATE_RENAME_CONTEXT_COLLECTION":"Files named ${0} already exist in this folder. ","STATUS_REMOTE_DUPLICATE_RENAME_CONTEXT_GLOBAL":"Files named ${0} already exist in My Files. ","MB":"${0} MB","A11Y_WARNING":"Warning:","BUTTON_TEXT":"Browse...","STATUS_REMOTE_DUPLICATE_RENAME":"A file with this name already exists. Continue to upload as a new version or rename the file. ${0}","LEVEL_WARNING":"Warning","ACTIONS_REMOVE":"Remove file","LEVEL_INFO":"Information","STATUS_LOCAL_DUPLICATE":"The file is already selected.","ERROR_TOO_BIG_FOR_BROWSER":"The file ${0} is too large to be uploaded using your current browser. Try using a different browser.","ACTIONS_REPLACE":"Replace","A11Y_INFO":"Info:","BUTTON_TEXT_WEBKIT_1":"Choose a File","ALERT":"Alert ","A11Y_ERROR":"Error:","B":"${0} B","STATUS_REMOTE_DUPLICATE_RENAME_CONTEXT_GLOBAL_1":"File named ${0} already exists in My Files. ","BUTTON_TEXT_WEBKIT":"Choose Files","STATUS_REPLACE":"This file will replace an existing file","STATUS_INVALID_CHARS":"This file name contains following invalid characters: \\ / : * ? \\ \x3c \x3e |","ACTIONS_REPLACE_INVALID":"Remove invalid characters","LEVEL_ERROR":"Error","ERROR_BAD_EXT_BLACKLIST":"${0} is invalid because the file extension ${1} is in the list of prohibited file extensions","STATUS_NAME_TOO_LONG":"This file name exceeds the maximum length of ${0} bytes","STATUS_TO_PREVIEW":"A thumbnail cannot be created for this video. Go to the file details page to add an image to display in previews.","STATE_UPLOADING":"${0} is currently being uploaded","A11Y_CLOSE_BUTTON_WITH_LINK":"Press tab to move to ${0} button","UI_EDIT":"Rename ${0} (${1}) by pressing Enter","KB":"${0} KB","GB":"${0} GB","ERROR_IO":"${0} could not be selected by your browser.","STATUS_REMOTE_DUPLICATE":"A file with this name already exists","ACTIONS_RENAME":"Rename","ERROR_TOO_BIG_FOR_BROWSER_OR_ENABLE_FLASH":"The file ${0} is too large to be uploaded using your current browser and settings. Try enabling Flash or try using a different browser.","ALERT_MESSAGE":"There is warning or error for the selected files. Please use tab to navigate to each selected file and check.","STATUS_REMOTE_DUPLICATE_RENAME_COMMUNITY":"A file with this name already exists in this community. Continue to upload as a new version or rename the file. ${0}","SIZE_UNKNOWN":"Unknown","STATE_UPLOADED":"${0} was successfully uploaded","STATUS_REMOTE_DUPLICATE_RENAME_ACTION":"Specify a different name. ${0}","ERROR_BAD_EXT_WHITELIST":"${0} is invalid because the file extension ${1} is not in the list of allowed file extensions","UI_EDIT_TOOLTIP":"Press Enter to save the file name, or Esc to cancel","STATUS_RENAMED":"The original file name was ${0}","ACTIONS_RENAME_LONG":"Rename","ERROR_TOO_BIG":"${0} has a size of ${1}, which is bigger than the allowed maximum of ${2}"};

;if(!dojo._hasResource["lconn.core.upload.data.File"]){
dojo._hasResource["lconn.core.upload.data.File"]=true;
dojo.provide("lconn.core.upload.data.File");










dojo.requireLocalization("lconn.core.upload","upload");
dojo.declare("lconn.core.upload.data.File",null,{UploadStates:{"READY":0,"QUEUED":1,"IN_PROGRESS":2,"UPLOADED":3},StatusKeys:{"IS_DUPLICATE":"IsDuplicate","INVALID_NAME_CHARS":"NameInvalidChars","INVALID_NAME_LENGTH":"NameInvalidLength","INVALID_FILE_SIZE":"InvalidSize","RENAMED":"FileRenamed","IS_VIDEO":"IsVideo"},StatusLevels:{"INFO":0,"WARNING":1,"ERROR":2},Actions:{RENAME:{setFocus:false,execute:function(_1){
if(_1.getOwningList().isRenameAllowed()){
_1.getOwningList().startRename(_1);
}
}},REPLACE_INVALID:{execute:function(_2){
if(_2.getOwningList().isRenameAllowed()){
var _3=_2.getOwningList().getInvalidCharacters();
if(_3){
var _4=_2.getName();
_4=_4.replace(_3,"_");
_2.setName(_4);
}
}
}},TRUNCATE:{execute:function(_5){
if(_5.getOwningList().isRenameAllowed()){
var _6=_5.getExtension();
var _7=lconn.core.util.text.trimExtension(_5.getName());
_7=_5.shortenFilename(_7,_6,_5.getOwningList().getMaxFilenameLength());
var _8=_7.name;
if(_6&&dojo.string.trim(_6).length>0){
_8+="."+_6;
}
_5.setName(_8);
}
}},REVERT:{execute:function(_9){
if(_9.getOwningList().isRenameAllowed()){
_9.setName(_9.getOriginalFileName());
}
}},REPLACE:{execute:function(_a){
if(_a.getOwningList().isReplaceAllowed()){
_a.setReplacing(true);
}
}},UNDO_REPLACE:{execute:function(_b){
if(_b.getOwningList().isReplaceAllowed()){
_b.setReplacing(false);
}
}},REMOVE:{setFocus:false,execute:function(_c){
_c.getOwningList().removeFileById(_c.getId());
}}},constructor:function(_d,_e,_f){
this._fileObject=_d;
this._id=this._fileObject.id||this._generateId();
if(_f){
this._fileList=_f;
}
this._state=this.UploadStates.READY;
this._statuses=[];
this._statusIndex={};
this._originalName=_e;
var _10=this.getExtension();
this._originalName=lconn.core.util.text.trimExtension(_e)+(_10?"."+_10:"");
this._canEditFullName=!_10||(_10.length+1>=_e.length);
this._isRemoteDuplicate=undefined;
this._isLocalDuplicate=false;
this._isEnabled=true;
this._isReplacing=false;
this._hasInvalidChars=false;
this._hasInvalidNameLength=false;
this._hasInvalidFileSize=false;
this._bytesComplete=-1;
this.invalidCount=0;
this.nls=dojo.i18n.getLocalization("lconn.core.upload","upload");
this._initActions();
},onSetBytesComplete:function(_11,_12,_13){
},_initActions:function(){
this.Actions.RENAME.name=this.nls.ACTIONS_RENAME;
this.Actions.REPLACE_INVALID.name=this.nls.ACTIONS_REPLACE_INVALID;
this.Actions.TRUNCATE.name=this.nls.ACTIONS_TRUNCATE;
this.Actions.REVERT.name=this.nls.ACTIONS_REVERT;
this.Actions.UNDO_REPLACE.name=this.nls.ACTIONS_UNDO;
this.Actions.REPLACE.name=this.nls.ACTIONS_REPLACE;
this.Actions.REMOVE.name=this.nls.ACTIONS_REMOVE;
},getObject:function(){
return this._fileObject;
},getOwningList:function(){
return this._fileList;
},getId:function(){
return this._id;
},isSizeAvailable:function(){
return !isNaN(this._size)&&this._size>=0;
},setSize:function(_14){
var _15=this._size;
this._size=_14;
if(this._fileList&&(_15!=this._size)){
this._fileList.onPropertyChange(this,"size",_15,this._size);
var _16=this.validateSize();
if(_16){
var _17={id:this.StatusKeys.INVALID_FILE_SIZE,level:this.StatusLevels.ERROR,message:_16.message,preventUpload:true,actions:[this.Actions.REMOVE]};
this.setStatus(_17);
}
}
},getSize:function(){
if(!this.isSizeAvailable()){
return -1;
}
return this._size;
},getBytesComplete:function(){
return this._bytesComplete;
},setBytesComplete:function(bc){
var _18=this._bytesComplete;
this._bytesComplete=bc;
if(this._fileList&&(_18!=this._bytesComplete)){
this._fileList.onPropertyChange(this,"bytesComplete",_18,this._bytesComplete);
}
this.onSetBytesComplete(this,_18,this._bytesComplete);
},isRemoteDuplicate:function(){
return this._isRemoteDuplicate;
},clearRemoteDuplicate:function(){
this.setRemoteDuplicate(undefined);
},setRemoteDuplicate:function(_19){
var _1a=this._isRemoteDuplicate;
this._isRemoteDuplicate=_19;
if(this._isRemoteDuplicate&&typeof this._isRemoteDuplicate=="object"&&this._isRemoteDuplicate.nestedFolder){
var _1b=this._isRemoteDuplicate.isMultiRemoteDuplicate;
if(this._fileList){
this.isMultiRemoteDuplicate=_1b;
}
}else{
if(this._fileList){
this.isMultiRemoteDuplicate=false;
}
}
if(this._fileList&&_1a!=this._isRemoteDuplicate){
if(_1a!=this._isRemoteDuplicate){
this._fileList.onPropertyChange(this,"isRemoteDuplicate",_1a,this._isRemoteDuplicate);
}
this._updateDuplicateStatus();
}
},isLocalDuplicate:function(){
return this._isLocalDuplicate;
},setLocalDuplicate:function(_1c){
var _1d=!!this._isLocalDuplicate;
this._isLocalDuplicate=!!_1c;
if(this._fileList&&(_1d!=this._isLocalDuplicate)){
this._fileList.onPropertyChange(this,"isLocalDuplicate",_1d,this._isLocalDuplicate);
this._updateDuplicateStatus();
}
},hasInvalidChars:function(){
return !!this._hasInvalidChars;
},setHasInvalidChars:function(_1e){
var _1f=!!this._hasInvalidChars;
this._hasInvalidChars=!!_1e;
if(this._fileList&&(_1f!=this._hasInvalidChars)){
this._fileList.onPropertyChange(this,"hasInvalidChars",_1f,this._hasInvalidChars);
if(this._hasInvalidChars){
var _20={id:this.StatusKeys.INVALID_NAME_CHARS,level:this.StatusLevels.ERROR,message:this.nls.STATUS_INVALID_CHARS,preventUpload:true,actions:this._fileList.isRenameAllowed()?[this.Actions.RENAME,this.Actions.REPLACE_INVALID]:[]};
this.setStatus(_20);
}else{
this.clearStatus(this.StatusKeys.INVALID_NAME_CHARS);
}
}
},isFilenameTooLong:function(){
return !!this._hasInvalidNameLength;
},setFilenameTooLong:function(_21){
var _22=!!this._hasInvalidNameLength;
this._hasInvalidNameLength=!!_21;
if(this._fileList&&(_22!=this._hasInvalidNameLength)){
this._fileList.onPropertyChange(this,"isFilenameTooLong",_22,this._hasInvalidNameLength);
if(this._hasInvalidNameLength){
var _23={id:this.StatusKeys.INVALID_NAME_LENGTH,level:this.StatusLevels.ERROR,message:dojo.string.substitute(this.nls.STATUS_NAME_TOO_LONG,[this._fileList.getMaxFilenameLength()]),preventUpload:true,actions:this._fileList.isRenameAllowed()?[this.Actions.RENAME,this.Actions.TRUNCATE]:[]};
this.setStatus(_23);
}else{
this.clearStatus(this.StatusKeys.INVALID_NAME_LENGTH);
}
}
},setExtensionVideo:function(_24){
if(this._fileList){
this._fileList.onPropertyChange(this,"isExtensionVideo");
var _25={id:this.StatusKeys.IS_VIDEO,level:this.StatusLevels.WARNING,message:this.nls.STATUS_TO_PREVIEW,preventUpload:false};
this.setStatus(_25);
}
},canEditFullName:function(){
return this._canEditFullName;
},getOriginalFileName:function(){
return this._originalName;
},getName:function(){
return this._editedName||this.getOriginalFileName();
},setName:function(_26){
var _27=this.getName();
this._editedName=_26;
delete this._extension;
if(this._fileList&&(_27!=_26)){
this._fileList.onPropertyChange(this,"name",_27,_26);
if(_26!=this.getOriginalFileName()){
var _28={id:this.StatusKeys.RENAMED,level:this.StatusLevels.INFO,message:dojo.string.substitute(this.nls.STATUS_RENAMED,[lconn.core.util.html.formatFilename(this._shortenDisplayName(this.getOriginalFileName()))]),actions:[this.Actions.REVERT]};
this.setStatus(_28);
}else{
this.clearStatus(this.StatusKeys.RENAMED);
}
this._fileList.validateDuplicates(_27);
this.clearRemoteDuplicate();
this.validateName();
}
},isEnabled:function(){
return (this._isEnabled!==false);
},setEnabled:function(_29){
var _2a=this._isEnabled;
this._isEnabled=!!_29;
if(this._fileList){
this._fileList.onPropertyChange(this,"enabled",_2a,this._isEnabled);
}
},getExtension:function(){
if(typeof this._extension=="undefined"){
var _2b=this.getName();
this._extension=lconn.core.util.text.getExtension(_2b);
}
return this._extension.toLowerCase();
},isReplacing:function(){
return !!this._isReplacing;
},setReplacing:function(_2c){
var _2d=this._isReplacing;
this._isReplacing=_2c;
if(this._fileList&&(_2d!=this._isReplacing)){
this._fileList.onPropertyChange(this,"replacing",_2d,this._isReplacing);
this._updateDuplicateStatus();
this._fileList.onListChanged(this._fileList);
}
},setStatus:function(_2e){
var _2f=this._statuses.length;
var idx=this._statusIndex[_2e.id];
if(idx||idx===0){
_2f=idx;
}
var _30=this.invalidCount;
var _31=(_2f==this._statuses.length);
if(!_31){
var _32=this._statuses[_2f];
}
this._statuses[_2f]=_2e;
this._statusIndex[_2e.id]=_2f;
var _33=0;
if(_31){
_33=_2e.preventUpload?1:0;
}else{
if(_32.preventUpload){
_33=_2e.preventUpload?0:-1;
}else{
_33=_2e.preventUpload?1:0;
}
}
this._changeInvalidCount(_33);
if(this._fileList){
this._fileList.onSetStatus(this,_2e);
}
},clearStatus:function(id){
var _34=this._statusIndex[id];
if((typeof _34!="undefined")&&(_34>=0&&_34<this._statuses.length)){
var _35=this._statuses.splice(_34,1);
_35=_35[0];
delete this._statusIndex[id];
for(var i=_34;i<this._statuses.length;++i){
var s=this._statuses[i];
var id=s.id;
this._statusIndex[id]=i;
}
this._changeInvalidCount(_35.preventUpload?-1:0);
if(this._fileList){
this._fileList.onClearStatus(this,_35);
}
}
},_changeInvalidCount:function(_36){
if(_36!=0){
var _37=this.invalidCount;
this.invalidCount+=_36;
this.invalidCount=Math.max(0,this.invalidCount);
if(this._fileList&&!!_37!=!!this.invalidCount){
this._fileList.onPropertyChange(this,"valid",_37==0,this.invalidCount==0);
this._fileList.onListChanged(this._fileList);
}
}
},getStatuses:function(){
return this._statuses;
},getUploadState:function(){
return this._state||this.UploadStates.READY;
},setUploadState:function(_38){
var _39=this._state;
this._state=_38;
if(this._fileList&&(_39!=this._state)){
this._fileList.onPropertyChange(this,"uploadState",_39,this._state);
}
},canUpload:function(){
var _3a=this.isEnabled()&&((this._state==this.UploadStates.READY)||(this._state==this.UploadStates.QUEUED));
if(_3a){
_3a=this.isValid();
}
var _3b=this._fileList?!!this._fileList.disableSameNameCheck:false;
if(_3a&&!_3b){
_3a=typeof this._isRemoteDuplicate!="undefined";
}
return _3a;
},isValid:function(){
var _3c=dojo.every(this._statuses,function(_3d){
return !_3d.preventUpload;
});
return _3c;
},_generateId:function(){
return dijit.getUniqueId("lconnUpload");
},validateSize:function(){
var _3e=null;
if(!this._fileList){
return null;
}
var max=this._fileList.getMaxFileSize();
var _3f=this.getSize();
if(_3f>=0&&max>0){
if(_3f>max){
var _40=lconn.share.util.text.formatSize(this.nls,_3f);
var _41=lconn.share.util.text.formatSize(this.nls,max);
if(dojo.getObject("lconn.share.config.services.multiPhaseFileUpload")&&this._fileList&&typeof (Worker)=="undefined"){
_3e={message:dojo.string.substitute(this.nls.ERROR_TOO_BIG_FOR_BROWSER,[this.getName()])};
}else{
_3e={message:dojo.string.substitute(this.nls.ERROR_TOO_BIG,[this.getName(),_40,_41])};
}
}
}
return _3e;
},validateExtension:function(){
var _42=null;
var _43=this._fileList.getAllowedExtensions();
if(_43){
var ext=this.getExtension().toLowerCase();
if(_43.allowed){
if(dojo.indexOf(_43.allowed,ext)==-1){
_42={message:dojo.string.substitute(this.nls.ERROR_BAD_EXT_WHITELIST,[this.getName(),this.getExtension()])};
}
}else{
if(_43.prohibited){
if(dojo.indexOf(_43.prohibited,ext)!=-1){
_42={message:dojo.string.substitute(this.nls.ERROR_BAD_EXT_BLACKLIST,[this.getName(),this.getExtension()])};
}
}
}
}
return _42;
},validateName:function(){
var _44=this.getName();
var ext=this.getExtension().toLowerCase();
var _45=this._fileList?!!this._fileList.disableSameNameCheck:false;
var _46=!_45;
var _47=(this._fileList.previewEnabled)?this._fileList.previewEnabled:false;
var _48=this.getOwningList().getInvalidCharacters();
if(dojo.isFunction(_48.test)&&_48.test(_44)){
this.setHasInvalidChars(true);
_46=false;
}else{
this.setHasInvalidChars(false);
}
var _49=this.getOwningList().getMaxFilenameLength();
var len=lconn.core.util.text.getByteLength(_44);
if(_49>0&&len>_49){
this.setFilenameTooLong(true);
_46=false;
fileExtensionCheck=false;
}else{
this.setFilenameTooLong(false);
}
if(_47){
var _4a=this._fileList.previewConfig;
if(_4a!=null&&typeof _4a!="undefined"){
var _4b=_4a.validVideoExts.split(",");
for(var i=0;i<_4b.length;i++){
if(ext==_4b[i]){
this.setExtensionVideo(true);
}
}
}
}
if(_46){
this._fileList.validateDuplicates(_44);
}else{
this._updateDuplicateStatus();
}
},validateRemoteDuplicate:function(){
if(this.isLocalDuplicate()||this._isRemoteDuplicate!=undefined){
return;
}
if(dojo.isFunction(this.getOwningList().remoteFileExists)){
if(this._pendingRemoteCheck){
this._pendingRemoteCheck.cancel();
}
var _4c=this.getName();
var _4d=this._pendingRemoteCheck=this.getOwningList().remoteFileExists(_4c);
var _4e=this.getOwningList()._pendingRemoteChecks;
_4e.push(_4d);
_4d.addBoth(dojo.hitch(this,function(){
var idx=dojo.indexOf(_4e,_4d);
if(idx!=-1){
_4e.splice(idx,1);
}
this._pendingRemoteCheck=null;
}));
_4d.addCallback(dojo.hitch(this,function(_4f){
this.setRemoteDuplicate(_4f);
}));
if((dojo.version.major==1&&dojo.version.minor<6)||dojo.version.major<1){
_4d.addErrback(dojo.hitch(this,function(_50){
this.setRemoteDuplicate(false);
}));
}
}
},_shortenDisplayName:function(_51){
if(!dojo.isString(_51)||_51.length<=38){
return _51;
}
return _51.substring(0,20)+"..."+_51.substring(_51.length-15);
},_updateDuplicateStatus:function(){
if(this.isFilenameTooLong()||this.hasInvalidChars()){
this.clearStatus(this.StatusKeys.IS_DUPLICATE);
}else{
if(this.isLocalDuplicate()){
this._setLocalDuplicateStatus();
}else{
if(this.isRemoteDuplicate()){
this._setRemoteDuplicateStatus();
}else{
this.clearStatus(this.StatusKeys.IS_DUPLICATE);
this._fileList.updateButtonStatus(this._fileList);
}
}
}
},_setLocalDuplicateStatus:function(){
var _52={id:this.StatusKeys.IS_DUPLICATE,level:this._fileList.areDuplicatesAllowed()?this.StatusLevels.WARNING:this.StatusLevels.ERROR,message:this.nls.STATUS_LOCAL_DUPLICATE,preventUpload:!this._fileList.areDuplicatesAllowed(),actions:this._fileList.isRenameAllowed()?[this.Actions.RENAME]:[]};
this.setStatus(_52);
},_setReplacingStatus:function(){
var _53={id:this.StatusKeys.IS_DUPLICATE,level:this.StatusLevels.INFO,message:this.nls.STATUS_REPLACE,preventUpload:false,actions:[this.Actions.UNDO_REPLACE]};
this.setStatus(_53);
},_setRemoteDuplicateStatus:function(){
var msg=null;
if(this._isRemoteDuplicate&&typeof this._isRemoteDuplicate=="object"&&this._isRemoteDuplicate.nestedFolder){
var _54="";
if(this._isRemoteDuplicate.context&&this._isRemoteDuplicate.context=="collection"){
_54=this._isRemoteDuplicate.isMultiRemoteDuplicate?this.nls.STATUS_REMOTE_DUPLICATE_RENAME_CONTEXT_COLLECTION:this.nls.STATUS_REMOTE_DUPLICATE_RENAME_CONTEXT_COLLECTION_1;
}else{
_54=this._isRemoteDuplicate.isMultiRemoteDuplicate?this.nls.STATUS_REMOTE_DUPLICATE_RENAME_CONTEXT_GLOBAL:this.nls.STATUS_REMOTE_DUPLICATE_RENAME_CONTEXT_GLOBAL_1;
}
var _55=this._isRemoteDuplicate.isMultiRemoteDuplicate?this.nls.STATUS_REMOTE_DUPLICATE_RENAME_ACTION:this.nls.STATUS_REMOTE_DUPLICATE_RENAME_AND_REPLACE_ACTION;
var _56=this._isRemoteDuplicate.fileName;
var _57={message:dojo.string.substitute(_54,[_56])};
msg=_57.message+_55;
}else{
msg=this._isRemoteDuplicate.community?this.nls.STATUS_REMOTE_DUPLICATE_RENAME_COMMUNITY:this.nls.STATUS_REMOTE_DUPLICATE_RENAME;
}
var _58={id:this.StatusKeys.IS_DUPLICATE,level:this.StatusLevels.WARNING,message:msg,preventUpload:false,disableActionInline:true,actions:[]};
if(this._fileList.isRenameAllowed()){
this.Actions.RENAME.name=this.nls.ACTIONS_RENAME_LONG;
_58.actions.push(this.Actions.RENAME);
}
this.setStatus(_58);
if(this._fileList.isReplaceAllowed()){
this.Actions.REPLACE.execute(this);
}
},shortenFilename:function(_59,ext,_5a){
_59=_59||"";
ext=ext||"";
var _5b=lconn.core.util.text.getByteLength(_59);
var _5c=lconn.core.util.text.getByteLength(ext);
if(_5a<1||!_5a){
_5a=252;
}
var dot="";
var _5d=0;
if(_5c>0){
dot=".";
_5d=1;
}
var _5e=_5a-_5c-_5d;
if(_5e<=0){
_59="";
var _5f=_5a-_5d;
ext=lconn.core.util.text.trimToByteLength(ext,_5f);
}else{
_59=lconn.core.util.text.trimToByteLength(_59,_5e);
}
return {filename:_59+dot+ext,name:_59,ext:ext};
}});
}


;if(!dojo._hasResource["lconn.core.upload.util.UploadUtil"]){
dojo._hasResource["lconn.core.upload.util.UploadUtil"]=true;
dojo.provide("lconn.core.upload.util.UploadUtil");








dojo.declare("lconn.core.upload.util.UploadUtil",null,{constructor:function(){
},getXmlHttpRequest:function(){
if(typeof XMLHttpRequest!=="undefined"&&!(typeof ActiveXObject!=="undefined"&&!document.addEventListener&&window.location.protocol==="file:")){
return new XMLHttpRequest();
}else{
if(typeof ActiveXObject!=="undefined"){
try{
return new ActiveXObject("Msxml2.XMLHTTP");
}
catch(e){
try{
return new ActiveXObject("Microsoft.XMLHTTP");
}
catch(e){
}
}
}
}
},uploadFile:function(_1,_2,_3){
return this.uploadFileInMultiPhases(_1,_2,_3);
},uploadFileInMultiPhases:function(_4,_5,_6){
var _7=null;
var _8=new dojo.Deferred();
var _9=dojo.isFunction(_5.getObject)?_5.getObject():_5;
var _a=_9.size;
var _b=_9.type;
_6.url=com.ibm.oneui.util.proxy(_6.url);
var _c=false;
if(_6.handleAs=="html"){
_6.handleAs="text";
_c=true;
}
_6.handle1=_6.handle;
delete _6.handle;
var _d=this.getHeaders(_6);
_d["X-IBM-UPLOAD-METHOD"]="phases";
_d["X-IBM-UPLOAD-SIZE"]=_a;
_6.headers=_d;
_6.sync="true";
var _e=this.generateFormData(_6);
_6.rawBody=_e;
delete _6.content;
delete _6.form;
delete _6.simpleUploadMaxFileSize;
if(_4=="PUT"){
_7=dojo.xhrPut(_6);
}else{
_7=dojo.xhrPost(_6);
}
delete _6.rawBody;
var _f=_7.ioArgs.xhr.getResponseHeader("X-IBM-UPLOAD-TOKEN");
var _10=_7.ioArgs.xhr.status;
var _11=null;
if(_c){
var doc=this._getDocumentFromText(_7.ioArgs.xhr.response);
_11=lconn.share.util.atom.getJsonResponseFromHtml(doc);
if(_11&&_11.status){
_10=_11.status;
}
}
if(_10!=200){
var err=null;
if(dojo.isFunction(_6.error)){
err=_6.error;
delete _6.error;
}
_7.addErrback(function(_12){
return err.call(_6,_12,ioArgs);
});
if(_11){
_7.error=_11.contents;
}
return _7;
}else{
_7=null;
_d["X-IBM-UPLOAD-TOKEN"]=_f;
_d["Content-Type"]=_b;
delete _d["X-IBM-UPLOAD-SIZE"];
_6.headers=_d;
_6.sync=false;
_6.consumerDfd=_8;
_5.bytesOfUploadedParts=0;
this.storeFileData(_4,_5,_6);
return _8;
}
return _7;
},generateFormData:function(_13){
var _14=dojo.mixin({},_13.content||{});
if(_13.form){
dojo.mixin(_14,dojo.formToObject(_13.form));
}
var _15=new FormData();
for(var k in _14){
if(_14.hasOwnProperty(k)&&_14[k]!=null){
var vs=_14[k];
if(!dojo.isArray(vs)){
vs=[vs];
}
dojo.forEach(vs,function(v){
if(v===true){
v="true";
}else{
if(v===false){
v="false";
}
}
_15.append(k,v);
});
}
}
return _15;
},getHeaders:function(_16){
var _17=dojo.mixin({},_16.headers||{});
for(var k in _17){
if(_17.hasOwnProperty(k)&&_17[k]&&!dojo.isFunction(_17[k])){
_17[k]=lconn.core.util.text.encodeHeaderUtf8(_17[k]);
}
}
if(_16.nonce){
_17["X-Update-Nonce"]=_16.nonce;
}
if(_16.methodOverride){
_17["X-Method-Override"]=_16.methodOverride;
}
if(_16.ifMatch){
_17["If-Match"]=_16.ifMatch;
}
return _17;
},cancelResumableUpload:function(_18,_19,_1a){
var _1b={args:_1a,url:_1a.url};
_1b.handleAs=_1a.handleAs||"text";
_19.uploadDfd=null;
var _1c=dojo.isFunction(_19.getObject)?_19.getObject():_19;
var dfd=new dojo.Deferred();
var _1d=this.getXmlHttpRequest();
_1d.open(_18,com.ibm.oneui.util.proxy(_1a.url),true);
var _1e=_1a.headers;
for(var k in _1e){
_1d.setRequestHeader(k,_1e[k]);
}
_1d.setRequestHeader("Content-Range","bytes */0");
_1d.setRequestHeader("X-Requested-With","XMLHttpRequest");
_1b.xhr=_1d;
try{
_1d.send(_1c.slice(0,1));
dfd.ioArgs=_1b;
}
catch(e){
dfd.reject(e);
}
return dfd;
},storeFileData:function(_1f,_20,_21,_22,end){
var _23={args:_21,url:_21.url};
_23.handleAs=_21.handleAs||"text";
_21.handle=_21.handle1;
delete _21.handle1;
var dfd=new dojo.Deferred();
var _24=dojo.isFunction(_20.getObject)?_20.getObject():_20;
var _25=_24.size;
var _26=_24.type;
var _27=null,_28=null,err=null;
var _29=524288000;
_20.uploadDfd=dfd;
if(dojo.isFunction(_21.handle)){
_27=_21.handle;
delete _21.handle;
}
if(dojo.isFunction(_21.load)){
_28=_21.load;
delete _21.load;
}
if(dojo.isFunction(_21.error)){
err=_21.error;
delete _21.error;
}
if(_21.addBoth){
dfd.addBoth(_21.addBoth);
}
if(_21.callback){
dfd.addCallback(_21.callback);
}
if(_21.errback){
dfd.addErrback(_21.errback);
}
_22=!_22?0:_22;
end=!end?_22+_29:end;
var _2a=this.getXmlHttpRequest();
_2a.upload.addEventListener("progress",function(_2b){
if(_2b&&_2b.lengthComputable){
if(_25>=_2b.loaded){
if(dojo.isFunction(_20.setBytesComplete)){
var _2c=_20.getBytesComplete();
if(_2c<end){
console.debug("Bytes of uploaded parts for "+_20.getName()+": "+_20.bytesOfUploadedParts);
_2c=_20.bytesOfUploadedParts+_2b.loaded;
_20.setBytesComplete(_2c>end?end:_2c);
}
}
}
}
},false);
dfd.cancel=_21.consumerDfd.cancel=dojo.hitch(this,function(){
var _2d=typeof _2a.abort;
if(_2d==="function"||_2d==="object"||_2d==="unknown"){
_2a.abort();
}
if(_22>0||end<_25){
this.cancelResumableUpload(_1f,_20,_21);
}
});
_2a.open(_1f,com.ibm.oneui.util.proxy(_21.url),true);
_2a.setRequestHeader("X-Requested-With","XMLHttpRequest");
var _2e=_21.headers;
for(var k in _2e){
_2a.setRequestHeader(k,_2e[k]);
}
if(_25>=_29){
var _2f=end>=_25?_25-1:end-1;
_2a.setRequestHeader("Content-Range","bytes "+_22+"-"+_2f+"/"+_25);
}
_23.xhr=_2a;
_2a.onreadystatechange=dojo.hitch(this,function(){
if(_2a.readyState==4){
if(_2a.status==200||_2a.status==201){
if(end>=_25){
var doc=this._getDocumentFromText(_2a.response);
var _30=lconn.share.util.atom.getJsonResponseFromHtml(doc);
_30.doc=doc;
dfd.resolve(_30);
_21.consumerDfd.resolve(_30);
}else{
var _31=new Object();
dfd.resolve({"partialUploaded":true,"status":200,"contents":_31});
_21.consumerDfd.progress({"partialUploaded":true,"status":200,"contents":_31});
_21.handle1=_27;
_21.load=_28;
_21.error=err;
if(_20.uploadDfd){
_20.bytesOfUploadedParts=_20.getBytesComplete();
_20.uploadDfd=this.storeFileData(_1f,_20,_21,end,end+_29);
}
}
}else{
if(_2a.status==0){
if(dojo.isFunction(_20.setUploadState)){
_20.setUploadState(_20.UploadStates.READY);
_20.setEnabled(true);
}
}else{
dfd.reject(_2a.response);
_21.consumerDfd.reject(_2a.response);
}
}
}
},this);
try{
dfd.ioArgs=_23;
if(_28){
dfd.addCallback(function(_32){
return _28.call(_21,_32,_23);
});
}
if(err){
dfd.addErrback(function(_33){
return err.call(_21,_33,_23);
});
}
if(_27){
dfd.addBoth(function(_34){
if(_34.partialUploaded){
return;
}
return _27.call(_21,_34,_23);
});
}
_2a.send(_24.slice(_22,end));
}
catch(e){
dfd.reject(e);
}
return dfd;
},uploadFileInSinglePhase:function(_35,_36,_37){
_37.handleAs=_37.handleAs||"text";
this.args=_37;
var _38={args:_37,url:_37.url};
var dfd=new dojo.Deferred();
var _39=dojo.isFunction(_36.getObject)?_36.getObject():_36;
var _3a=_39.size;
var _3b=null,_3c=null,err=null;
if(dojo.isFunction(_37.handle)){
_3b=_37.handle;
delete _37.handle;
}
if(dojo.isFunction(_37.load)){
_3c=_37.load;
delete _37.load;
}
if(dojo.isFunction(_37.error)){
err=_37.error;
delete _37.error;
}
var _3d=this.getXmlHttpRequest();
_3d.upload.addEventListener("progress",function(_3e){
if(_3e&&_3e.lengthComputable){
if(_3a>=_3e.loaded){
if(dojo.isFunction(_36.setBytesComplete)){
_36.setBytesComplete(_3e.loaded);
}
}
}
},false);
_3d.open(_35,com.ibm.oneui.util.proxy(_37.url),true);
_3d.setRequestHeader("X-Requested-With","XMLHttpRequest");
var _3f=this.getHeaders(_37);
for(var k in _3f){
_3d.setRequestHeader(k,_3f[k]);
}
var _40=this.generateFormData(_37);
_40.append("file",_39);
_3d.onreadystatechange=dojo.hitch(this,function(){
if(_3d.readyState==4){
if(_3d.status==200||_3d.status==201){
if(this.args.handleAs=="html"||this.args.handleAs=="text"){
var doc=this._getDocumentFromText(_3d.response);
var _41=lconn.share.util.atom.getJsonResponseFromHtml(doc);
_41.doc=doc;
var _42=lconn.share.util.atom.getJsonError(_41);
if(_42){
dfd.resolve(_42);
}else{
dfd.resolve(_41);
}
}else{
dfd.resolve(_3d.response);
}
}else{
dfd.reject(_3d.response);
}
}
},this);
dfd.cancel=dojo.hitch(this,function(){
var _43=typeof _3d.abort;
if(_43==="function"||_43==="object"||_43==="unknown"){
_3d.abort();
}
});
try{
dfd.ioArgs=_38;
if(_3c){
dfd.addCallback(function(_44){
return _3c.call(_37,_44,_38);
});
}
if(err){
dfd.addErrback(function(_45){
return err.call(_37,_45,_38);
});
}
if(_3b){
dfd.addBoth(function(_46){
return _3b.call(_37,_46,_38);
});
}
_3d.send(_40);
}
catch(e){
dfd.reject(e);
}
return dfd;
},_getDocumentFromText:function(_47){
if(_47 instanceof Error){
return _47;
}
this._deleteIFrame("html5Frame");
var dii=dojo.io.iframe;
var _48=dii.create("html5Frame");
var _49=dii.doc(_48);
_49.close();
_49.open();
_49.write(_47);
_49.close();
return _49;
},_deleteIFrame:function(_4a){
try{
if(window[_4a]){
delete window[_4a];
}else{
if(window.frames[_4a]){
delete window.frames[_4a];
}
}
}
catch(e){
}
}});
}


;if(!dojo._hasResource["lconn.core.upload.provider.HtmlFileProvider"]){
dojo._hasResource["lconn.core.upload.provider.HtmlFileProvider"]=true;
dojo.provide("lconn.core.upload.provider.HtmlFileProvider");












dojo.requireLocalization("lconn.core.upload","upload");
(function(){
var _1=dojo.io.iframe,_2=!dojo.isFF;
var _3=dojo.i18n.getLocalization("lconn.core.upload","upload");
dojo.declare("lconn.core.upload.provider.HtmlFileProvider",null,{allowHTML5:(function(){
var _4=dojo.doc.createElement("input");
_4.type="file";
return ("files" in _4)&&window.FormData;
})(),_deleteIFrame:function(_5){
try{
if(window[_5]){
delete window[_5];
}else{
if(window.frames[_5]){
delete window.frames[_5];
}
}
}
catch(e){
}
},_getInputID:function(_6){
return _6.id+"_contents";
},_updateLabel:function(_7,_8){
if(_8&&_7&&_7.controller){
dojo.attr(_8,"for",this._getInputID(_7.controller));
}
},_buildFileInput:function(_9,_a,_b,_c){
var _d=this.browseInput=dojo.isIE<9?dojo.doc.createElement("<input type=\"file\">"):dojo.doc.createElement("input");
_d.type="file";
_d.id=this._getInputID(_9.controller);
_d.name=_9.controller.inputName||"file";
_d.style.display="block";
if(this.allowHTML5&&_9.isAllowMultipleFiles()){
_d.multiple="multiple";
}
_d.className=_c?"lotusOffScreen":"lotusText lotusLTR lotusAlignLeft qkrFile";
dijit.setWaiState(_d,"required",true);
if(dojo.isIE<8){
_b.push(dojo.connect(_d,"ondrop",dojo.stopEvent));
_b.push(dojo.connect(_d,"oncut",dojo.stopEvent));
_b.push(dojo.connect(_d,"onpaste",dojo.stopEvent));
_b.push(dojo.connect(_d,"onkeypress",function(_e){
if(_e.ctrlKey||_e.metaKey||_e.altKey){
return;
}
if(_e.keyChar||_e.keyCode==dojo.keys.DELETE||_e.keyCode==dojo.keys.BACKSPACE){
dojo.stopEvent(_e);
}
}));
}
_b.push(dojo.connect(_d,"onchange",dojo.hitch(this,function(){
this._beforeInputChanged();
this._handleInputChange(_d,_9);
})));
this._updateLabel(_9,_a);
if(this.allowHTML5&&dojo.isSafari&&dojo.isSafari<5.2){
var _f=dojo.create("div");
_d.style.opacity="0";
_d.style.filter="alpha(opacity=0)";
_d.style.position="absolute";
_d.style.left="0";
_d.style.top="-9999px";
_d.setAttribute("tabindex","-1");
_f.appendChild(_d);
var _10=dojo.create("span",{className:"lotusBtn"});
var _11=this.browseInput=dojo.create("a",{href:"javascript:;",className:"lotusFormButton",role:"button"});
var _12;
if(this.allowHTML5){
_12=_9.isAllowMultipleFiles()?_3.BUTTON_TEXT_WEBKIT:_3.BUTTON_TEXT_WEBKIT_1;
}else{
_12=_3.BUTTON_TEXT;
}
_11.title=_12;
_11.appendChild(dojo.doc.createTextNode(_12));
_b.push(dojo.connect(_11,"onclick",_d,"click"));
_10.appendChild(_11);
_f.appendChild(_10);
return _f;
}
return _d;
},_handleFakeButtonClick:function(_13,_14,_15){
var _16=this._buildFileInput(_13,_14,_15,true);
dojo.body().appendChild(_16);
_16.click();
},buildInput:function(_17,_18){
var _19=[];
if(!this.allowHTML5||(dojo.isSafari&&dojo.isSafari<5.2)){
var _1a=this.input=this._buildFileInput(_17,_18,_19,false);
}else{
if(_2){
var _1a=this.input=this.browseInput=dojo.doc.createElement("button");
_1a.appendChild(dojo.doc.createTextNode(_3.BUTTON_TEXT));
}else{
var _1a=this.input=this.browseInput=dojo.create("input");
_1a.type="button";
_1a.value=_3.BUTTON_TEXT;
}
_1a.className="lotusBtn";
_1a.id="lconn_btn_browse_files";
if(_17.isRequiredField()){
dijit.setWaiState(_1a,"required",true);
}
_19.push(dojo.connect(_1a,"onclick",dojo.hitch(this,function(_1b){
dojo.stopEvent(_1b);
this._handleFakeButtonClick(_17,_18,_19);
})));
if(this.fileInputForTest){
var _1c=this.fileInputForTest=this._buildFileInput(_17,_18,_19,true);
dojo.body().appendChild(_1c);
}
}
return {domNode:_1a,destroy:dojo.partial(function(_1d){
dojo.forEach(_19,dojo.disconnect);
if(_1d.fileInputForTest){
dojo.body().removeChild(_1d.fileInputForTest);
_1d.fileInputForTest=null;
}
},this)};
},getFocusNode:function(){
return this.browseInput;
},uploadFile:function(_1e,_1f,_20){
var _21=null;
if(_20.osConfig){
var _22={getAuthenticatedUser:function(){
return {nonce:_20.nonce};
}};
dojo.mixin(_22,_20.osConfig);
_21=new lconn.files.util.os.NetworkOS(_22);
}
if(this.allowHTML5){
return this._uploadFileHTML5(_1e,_1f,_20,_21);
}else{
return this._uploadFileIFrame(_1e,_1f,_20,_21);
}
},_uploadFileIFrame:function(_23,_24,_25,_26){
var dfd=null;
if(!_25.form){
var _27=dojo.create("form",{"className":"lotusOffScreen","method":"post"});
dojo.body().appendChild(_27);
_25.form=_27;
}
var _28=_24.getObject();
dojo.addClass(_28,"lotusOffScreen");
_25.form.appendChild(_28);
dojo.attr(_25.form,"enctype","multipart/form-data");
dojo.attr(_25.form,"encoding","multipart/form-data");
if(!_25.method){
_25.method=dojo.attr(_25.form,"method")||"POST";
}
var _29=_25.content;
if(_29){
for(var key in _29){
if(_29[key]==undefined){
_29[key]="";
}
}
}
var _2a=this;
dfd=dojo.io.iframe.send(_25);
dfd.addBoth(function(_2b){
if(_28&&_28.parentNode){
_28.parentNode.removeChild(_28);
}
if(_2b&&_2b instanceof Error&&_2b.dojoType=="cancel"){
_2a._cancelIFrame();
}
});
this._queueProgressCheck(_23,_24);
return dfd;
},_uploadFileHTML5:function(_2c,_2d,_2e,_2f){
var _30=!!dojo.getObject("lconn.share.config.services.multiPhaseFileUpload");
if(_30&&_2e.simpleUploadMaxFileSize&&_2d.getSize()>_2e.simpleUploadMaxFileSize){
var _31=new lconn.core.upload.util.UploadUtil();
return _31.uploadFile("POST",_2d,_2e);
}
var dfd=null;
if(_2d.getSize()==0){
return this._sendZeroByteUpload(_2c,_2d,_2e);
}
var _32=false;
if(_2e.handleAs=="html"){
_2e.handleAs="text";
_32=true;
}
_2e.headers["X-Update-Nonce"]=_2e.nonce;
var _33=dojo.mixin({},_2e.content||{});
if(_2e.form){
dojo.mixin(_33,dojo.formToObject(_2e.form));
}
var _34=new FormData();
_34.append(dojo.getObject("controller.inputName",false,_2c)||"file",_2d.getObject());
for(var k in _33){
if(_33.hasOwnProperty(k)&&_33[k]!=null){
var vs=_33[k];
if(!dojo.isArray(vs)){
vs=[vs];
}
dojo.forEach(vs,function(v){
if(v===true){
v="true";
}else{
if(v===false){
v="false";
}
}
_34.append(k,v);
});
}
}
var url=_2e.url;
if(!url&&_2e.form){
url=dojo.attr(_2e.form,"action");
}
if(!url){
throw new Error("null url");
}
_2e.rawBody=_34;
var _35=null;
var _36=null;
var err=null;
if(dojo.isFunction(_2e.handle)){
_35=_2e.handle;
delete _2e.handle;
}
if(dojo.isFunction(_2e.load)){
_36=_2e.load;
delete _2e.load;
}
if(dojo.isFunction(_2e.error)){
err=_2e.error;
delete _2e.error;
}
if(_2f){
dfd=_2f.postMultipart(_2e);
}else{
_2e.url=com.ibm.oneui.util.proxy(url);
var f=dojo._xhrObj;
dojo._xhrObj=function(){
var ret=f.apply(this,arguments);
dojo._xhrObj=f;
if(ret.upload){
ret.upload.addEventListener("progress",function(_37){
if(_37&&_37.lengthComputable){
if(_2d.getSize()>_37.loaded){
_2d.setBytesComplete(_37.loaded);
}
}
},false);
}
return ret;
};
dfd=dojo.xhrPost(_2e);
}
var _38=dfd.ioArgs||_2e;
if(_32){
dfd.addBoth(dojo.hitch(this,function(_39){
if(_39 instanceof Error){
return _39;
}
this._deleteIFrame("html5Frame");
var _3a=_1.create("html5Frame");
var _3b=_1.doc(_3a);
_3b.close();
_3b.open();
_3b.write(_39);
_3b.close();
return _3b;
}));
}
if(_36){
dfd.addCallback(function(_3c){
return _36.call(_2e,_3c,_38);
});
}
if(err){
dfd.addErrback(function(_3d){
return err.call(_2e,_3d,_38);
});
}
if(_35){
dfd.addBoth(function(_3e){
return _35.call(_2e,_3e,_38);
});
}
return dfd;
},_cancelIFrame:function(){
_1=dojo.io.iframe;
if(_1._frame){
try{
var doc=_1.doc(_1._frame);
if(doc){
var uri=(dojo.config["dojoBlankHtmlUrl"]||dojo.moduleUrl("dojo","resources/blank.html"));
doc.location.replace(uri);
}
}
catch(e){
if(dojo.config.isDebug){
console.debug("dojo.io.iframe.cancel: ",e);
}
try{
var _3f=_1._frame;
if(_3f.parentNode){
_3f.parentNode.removeChild(_3f);
}
delete _1._frame;
delete window[_1._iframeName];
}
catch(e2){
if(dojo.config.isDebug){
console.debug("dojo.io.iframe.cancel2: ",e2);
}
}
}
}
},_sendZeroByteUpload:function(_40,_41,_42){
var _43=dojo.mixin({},_42.content||{});
if(_42.form){
dojo.mixin(_43,dojo.formToObject(_42.form));
}
var _44="--------"+(new Date()).getTime();
_42.url=com.ibm.oneui.util.proxy(_42.url);
_42.postData=this._buildMultipart(dojo.getObject("controller.inputName",false,_40),_41,_43,_44);
var _45=dojo.mixin({},_42.headers||{});
for(var k in _45){
if(_45.hasOwnProperty(k)&&_45[k]&&!dojo.isFunction(_45[k])){
_45[k]=lconn.core.util.text.encodeHeaderUtf8(_45[k]);
}
}
_45["Content-type"]="multipart/form-data;boundary="+_44;
_42.headers=_45;
var _46=false;
if(_42.handleAs=="html"){
_42.handleAs="text";
_46=true;
}
var _47=null;
var _48=null;
var err=null;
if(dojo.isFunction(_42.handle)){
_47=_42.handle;
delete _42.handle;
}
if(dojo.isFunction(_42.load)){
_48=_42.load;
delete _42.load;
}
if(dojo.isFunction(_42.error)){
err=_42.error;
delete _42.error;
}
dfd=dojo.xhrPost(_42);
var _49=dfd.ioArgs||_42;
if(_46){
dfd.addBoth(dojo.hitch(this,function(_4a){
this._deleteIFrame("zbFrame");
var _4b=_1.create("zbFrame");
var _4c=_1.doc(_4b);
_4c.close();
_4c.open();
_4c.write(_4a);
_4c.close();
return _4c;
}));
}
if(_48){
dfd.addCallback(function(_4d){
return _48.call(_42,_4d,_49);
});
}
if(err){
dfd.addErrback(function(_4e){
return err.call(_42,_4e,_49);
});
}
if(_47){
dfd.addBoth(function(_4f){
return _47.call(_42,_4f,_49);
});
}
return dfd;
},_queueProgressCheck:function(_50,_51){
if(_50.checkProgress){
_50.checkProgressInterval=_50.checkProgressInterval||10000;
var _52=this;
_50.checkProgressTimer=setTimeout(function(){
if(_50.currentFile&&_51==_50.currentFile){
var _53=_50.currentProgressCheck=_50.checkProgress(_50.currentFile);
_53.addBoth(_52,"_queueProgressCheck",_50,_51);
}
},_50.checkProgressInterval);
}
},_beforeInputChanged:function(){
},_handleInputChange:function(_54,_55){
dojo.removeAttr(_54,"id");
if(this.allowHTML5){
if(_54.files){
this.addHTML5Files(_54.files,_55.controller.fileList);
_54.parentNode.removeChild(_54);
}else{
return;
}
}else{
var _56=lconn.core.util.text.getFilename(_54.value);
var _57=new lconn.core.upload.data.File(_54,_56);
_55.controller.fileList.addFiles([_57]);
}
_55._buildInput();
_55._focusFirstFileOfCurrentSelection();
},addHTML5Files:function(_58,_59){
if(!_58||!_58.length||!this.allowHTML5){
return;
}
var _5a=[];
dojo.forEach(_58,function(_5b){
var _5c=lconn.core.util.text.getFilename(_5b.name);
var _5d=new lconn.core.upload.data.File(_5b,_5c);
try{
_5d.setSize(_5b.size);
_5a.push(_5d);
}
catch(e){
var _5e=[{message:dojo.string.substitute(_3.ERROR_IO,[_5c])}];
_59.onAddFilesError(_5e);
}
},this);
_59.addFiles(_5a);
},_buildMultipart:function(_5f,_60,_61,_62){
var _63="--"+_62;
var _64=[_63];
var _65=_5f||"file";
_64.push("Content-Disposition: form-data; name=\""+_65+"\"; filename=\""+_60.getOriginalFileName()+"\"");
_64.push("Content-Type: application/octet-stream");
_64.push("");
_64.push("");
for(var key in _61){
if(dojo.isString(key)){
var _66=_61[key];
if(!dojo.isArray(_66)){
_66=[_66];
}
dojo.forEach(_66,function(_67){
_64.push(_63);
_64.push("Content-Disposition: form-data; name=\""+key+"\"");
_64.push("");
_64.push(_67);
},this);
}
}
_64.push(_63+"--");
return _64.join("\r\n");
}});
})();
}


;define("ic-share/fileviewer/nls/FileViewerStrings",{root:({FILE_VIEWER_TITLE:"File preview",FILENAME_TOOLTIP:"Edit file name",ICON_TOOLTIP:"Download file",ERROR:"An error has occurred.",SHARED_EXTERNALLY:"Shared externally",FILE_SYNCED:"Added to sync",MORE_ACTIONS:{TITLE:"More Actions",A11Y:"Opens a drop-down menu with a list of more actions to perform on the file.",PANELS:{TITLE:"More",A11Y:"Opens a drop-down menu with a list of hidden panels"}},WELCOME:{TITLE:"We've Combined File View and Details",SUBTITLE:"Now you can view a file and its comments side-by-side.",LINES:{LINE_1:"All the information and things you could do on the old page are found here.",LINE_2:"Comments, sharing, versions, and basic information are available to the side of the file."}},NAVIGATION:{NEXT_A11Y:"This button navigates to the next file.",PREVIOUS_A11Y:"This button navigates to the previous file."},SPLIT_ACTION:{MENU:{TITLE:"More editing options",A11Y:"This button opens a menu for more editing options."},BUTTON:{EDIT:{TITLE:"Edit"},UPLOAD:{TITLE:"Upload"},CREATE:{TITLE:"Create"}}},ACTION:{RESIZE:{RESIZE_BAR:"Resize the panel",USAGE:"Press left bracket or right bracket keys to resize the panel."},CLOSE:{TOOLTIP:"Close",A11Y:"This button closes the file viewer.",WARNING_DIALOG:{DIALOG_TITLE:"Your file is still uploading.",PROMPT:"Your file is still uploading. If you close before it completes, the upload will be canceled.",OK:"Close Anyway",CANCEL:"Wait for Upload"}},ADD_TO_FILES:{TOOLTIP:"Add to Files",A11Y:"This button adds the attachment to Files.",VIEW_NOW:"View Now"},TEAR_OFF:{TOOLTIP:"Open in new window",A11Y:"Open in new window",ERROR_TEARING_OFF:"There was an error opening the new window.",DIALOG_TITLE:"Confirm",UNSAVED_CHANGES_WARNING:"You have unsaved changes which will be lost. Do you want to open in a new window anyway?",OK:"Yes",CANCEL:"No",OPEN:"Open",OPEN_ANYWAY:"Open Anyway",CANCEL_ALT:"Cancel"},CREATE_FROM_TEMPLATE:{NAME:"New from File",ACTION_NAME:"Create File",A11Y:{TEXT:"Create a document (DOC, DOCX or ODT file) from a template file. You can edit these documents online in Docs.",PRES:"Create a presentation (PPT, PPTX or ODP file) from a template file. You can edit these presentations online in Docs.",SHEET:"Create a spreadsheet (XLS, XLSX or ODS file) from a template file. You can edit these spreadsheets online in Docs."},PROMPT:{TEXT:"Create a document (DOC, DOCX or ODT file) from a template file. You can edit these documents online in Docs.",PRES:"Create a presentation (PPT, PPTX or ODP file) from a template file. You can edit these presentations online in Docs.",SHEET:"Create a spreadsheet (XLS, XLSX or ODS file) from a template file. You can edit these spreadsheets online in Docs."},NAME_FIELD:"Name:",EXTERNAL_FIELD:"Files can be shared with people external to my organization",EXTERNAL_DESC:"External access allows files to be shared with external users (people outside of your organization or company), folders shared with external users, and communities with external people as members. You must set external access when uploading a file; it cannot be turned on later.",CREATE_BUTTON:"Create",CANCEL:"Cancel",PRE_FILL_NAMES:{OTT:"Untitled Document",OTS:"Untitled Spreadsheet",OTP:"Untitled Presentation",DOT:"Untitled Document",XLT:"Untitled Spreadsheet",POT:"Untitled Presentation",DOTX:"Untitled Document",XLTX:"Untitled Spreadsheet",POTX:"Untitled Presentation"},ERRORS:{NAME_REQUIRED:"Document name is required.",ILLEGAL_NAME:"This is an illegal document title, please specify another one.",WARN_LONG_NAME:"The document name is too long.",TRIM_NAME:"Shorten the document name?",SESSION_TIMEOUT:"Your session has expired, please log in and try again.",DUPLICATE_NAME:"A duplicate file name was found. Enter a new name.",SERVER_ERROR:"The Connections server is not available. Contact the server administrator and try again later."}},DOWNLOAD:{TOOLTIP:"Download file",A11Y:"This button downloads the file."},DOWNLOAD_AS_PDF:{NAME:"Download as PDF",TOOLTIP:"Download this file as a PDF file",A11Y:"This button downloads the file as a PDF.",SUCCESS:"You have successfully downloaded the file as a PDF.",ERROR:{DEFAULT:"You were not able to download the file as a PDF.  Please try again later.",UNAUTHENTICATED:"Your session has timed out. You must log in again before you can download the file as a PDF.",NOT_FOUND:"The file could not be downloaded as a PDF because the file has been deleted or is no longer shared with you.",ACCESS_DENIED:"The file could not be downloaded as a PDF because the file has been deleted or is no longer shared with you."},DOCS_ERRORS:{NO_PUBLISHED_OR_EMPTY:"There is no published version of this file to download.  Versions can be published from the Docs editor."}},DOWNLOAD_DOCS_FILE:{EMPTY_FILE_EDITOR:{DIALOG_TITLE:"Cannot Download the File",CANCEL:"Close",PROMPT:"There is no published version of this file to download.",PROMPT2:"Versions can be published from the Docs editor."},EMPTY_FILE_READER:{DIALOG_TITLE:"Cannot Download the File",CANCEL:"Close",PROMPT:"There is no published version of this file to download.",PROMPT2:"Ask the file owner to publish a version of this file."},NEWER_DRAFT_EXISTS:{DIALOG_TITLE:"Download a Version",OK:"Download Version",PROMPT:{TODAY:"A newer draft, last edited today at ${time}, has been detected.",YESTERDAY:"A newer draft, last edited yesterday at ${time}, has been detected.",DAY:"A newer draft, last edited on ${date}, has been detected.",MONTH:"A newer draft, last edited on ${date}, has been detected.",YEAR:"A newer draft, last edited on ${date_long}, has been detected."},PROMPT2:{TODAY:"Are you sure you want to continue to download the version that was published today at ${time}?",YESTERDAY:"Are you sure you want to continue to download the version that was published yesterday at ${time}?",DAY:"Are you sure you want to continue to download the version that was published on ${date}?",MONTH:"Are you sure you want to continue to download the version that was published on ${date}?",YEAR:"Are you sure you want to continue to download the version that was published on ${date_long}?"}}},TOGGLE_PANEL:{SHOW:"Show details panel",HIDE:"Hide details panel",RESET:"Reset panel size",SHOW_A11Y:"This button toggles the side panel open and closed. The side panel is currently closed.",HIDE_A11Y:"This button toggles the side panel open and closed. The side panel is currently open.",RESET_A11Y:"This button resets the side panel back to default size. The side panel is currently expanded."},VIEW_DOC:{NAME:"Open in Docs Viewer",TOOLTIP:"Open in the Docs Viewer",A11Y:"This button opens the file for viewing inside of a new browser window."},EDIT_DOC:{NAME:"Edit in Docs",TOOLTIP:"Use IBM Docs to edit this file",A11Y:"This button opens the file for editing in Docs inside of a new window."},EDIT_OFFICE:{TITLE:"Editing options.",NAME:"Edit in Microsoft Office Online",TOOLTIP:"Use Microsoft Office Online to edit this file",A11Y:"This button opens the file for editing in Microsoft Office Online inside of a new window."},EDIT_OFFICE_WORD:{NAME:"Edit in Microsoft Word Online",TOOLTIP:"Use Microsoft Word Online to edit this file",A11Y:"This button opens the file for editing in Microsoft Word Online inside of a new window."},EDIT_OFFICE_EXCEL:{NAME:"Edit in Microsoft Excel Online",TOOLTIP:"Use Microsoft Excel Online to edit this file",A11Y:"This button opens the file for editing in Microsoft Excel Online inside of a new window."},EDIT_OFFICE_POWERPOINT:{NAME:"Edit in Microsoft PowerPoint Online",TOOLTIP:"Use Microsoft PowerPoint Online to edit this file",A11Y:"This button opens the file for editing in Microsoft PowerPoint Online inside of a new window."},OFFICE_EDITED:{SUCCESS:"The file is being saved."},ROUNDTRIP_EDIT:{NAME:"Edit on Desktop",DIALOG_TITLE:"Edit on Desktop",TOOLTIP:"Edit this document",A11Y:"This button opens the file for editing locally.",PROMPT:"This feature allows you to edit using software installed on your computer.",INSTALL:"Before proceeding, ${startLink}install desktop file connectors${endLink}.",IMPORTANT:"Important:",REMINDER:"When you are done editing, publish a draft using the desktop file connectors.",SKIP_DIALOG:"Don't show this message again.",OK:"OK",CANCEL:"Cancel"},DELETE_VERSION:{DIALOG_TITLE:"Confirm",DELETE_VERSION:"Delete version ${version}",DELETE_VERSION_AND_PRIOR:"Delete version ${version} and all earlier versions",PROMPT:"You are about to delete version ${version}. Do you want to proceed?",DELETE_PRIOR:"Also delete all earlier versions",ERROR:"An error occurred deleting the version. Try again later.",TOOLTIP:"Delete this version",OK:"OK",CANCEL:"Cancel"},GET_LINKS:{DIALOG_TITLE:"Get Links",LINK_FILE:"Link to file:",LINK_PREVIEW:"Link to preview file:",LINK_DOWNLOAD:"Link to download file:",TOOLTIP:"Link to file",OK:"Close"},DOWNLOAD_VERSION:{TOOLTIP:"Download this version"},RESTORE_VERSION:{DIALOG_TITLE:"Confirm",PROMPT:"You are about to replace the current version of this file with version ${version}. Do you want to proceed?",ERROR:"An error occurred restoring the version. Try again later.",TOOLTIP:"Restore this version",CHANGE_SUMMARY:"Restored from version ${version}",OK:"OK",CANCEL:"Cancel"},STOP_SHARING:{DIALOG_TITLE:"Confirm",REMOVE_EVERYONE:"Are you sure you want to remove your organization's access to this file? If access is removed, then the file is removed from folders and communities allowing organization-level access, and only the owner and people with whom it has been shared can view and work with it.",REMOVE_USER:"Are you sure you want to stop sharing with ${user}? If you stop sharing, ${user} will only be able to access this file through folders or if it is shared with everyone in your organization.",REMOVE_COMMUNITY:"Are you sure you want to remove this file from the community ${communityName}?",REMOVE_FOLDER:"Are you sure you want to remove this file from the folder ${folderName}?",REMOVE_EVERYONE_TOOLTIP:"Remove your organization's access",REMOVE_USER_TOOLTIP:"Remove all shares with ${user}",REMOVE_COMMUNITY_TOOLTIP:"Remove from the community ${communityName}",REMOVE_FOLDER_TOOLTIP:"Remove from the folder ${folderName}",OK:"OK",CANCEL:"Cancel",EFSS:{DIALOG_TITLE:"Confirm",REMOVE_EVERYONE:"Are you sure you want to remove your organization's access to this file? If access is removed, then the file is removed from folders allowing organization-level access, and only the owner and people with whom it has been shared can view and work with it.",REMOVE_USER:"Are you sure you want to stop sharing with ${user}? If you stop sharing, ${user} will only be able to access this file through folders or if it is shared with everyone in your organization.",REMOVE_COMMUNITY:"Are you sure you want to remove this file from the community ${communityName}?",REMOVE_FOLDER:"Are you sure you want to remove this file from the folder ${folderName}?",REMOVE_EVERYONE_TOOLTIP:"Remove your organization's access",REMOVE_USER_TOOLTIP:"Remove all shares with ${user}",REMOVE_COMMUNITY_TOOLTIP:"Remove from the community ${communityName}",REMOVE_FOLDER_TOOLTIP:"Remove from the folder ${folderName}",OK:"OK",CANCEL:"Cancel"}},EDIT_COMMENT:{TOOLTIP:"Edit this comment"},DELETE_COMMENT:{DIALOG_TITLE:"Confirm",PROMPT:"Are you sure you want to delete this comment?",ERROR:"An error occurred deleting the comment. Try again later.",TOOLTIP:"Delete this comment",OK:"OK",CANCEL:"Cancel"},LIKE:{LIKE:"Like the file",UNLIKE:"Unlike the file",LIKE_A11Y:"This button likes the file.",UNLIKE_A11Y:"This button unlikes the file.",LIKED_SUCCESS:"You liked this file",UNLIKE_SUCCESS:"You unliked this file"},EDIT_DESCRIPTION:{TOOLTIP:"Edit description",ERROR:{DEFAULT:"The description could not be saved. Try again later.",UNAUTHENTICATED:"Your session has timed out. You must log in again before you can update the description.",NOT_FOUND:"The description could not be saved because the file has been deleted or is no longer shared with you.",ACCESS_DENIED:"The description could not be saved because the file has been deleted or is no longer shared with you."}},EDIT_FILENAME:{ERROR:{DEFAULT:"Error saving filename",CONFLICT:"Filename already exists"}},TOGGLE_FOLLOW:{ERROR:{FOLLOW:{DEFAULT:"There was an error following this file. Try again later.",UNAUTHENTICATED:"Your session has timed out. You must log in again before you can follow this file.",NOT_FOUND:"You cannot follow this file because the file has been deleted or is no longer shared with you.",ACCESS_DENIED:"You cannot follow this file because the file has been deleted or is no longer shared with you."},UNFOLLOW:{DEFAULT:"There was an error unfollowing this file. Try again later.",UNAUTHENTICATED:"Your session has timed out. You must log in again before you can stop following this file.",NOT_FOUND:"You cannot stop following this file because the file has been deleted or is no longer shared with you.",ACCESS_DENIED:"You cannot stop following this file because the file has been deleted or is no longer shared with you."}},FOLLOW_NAME:"Follow",FOLLOW_TOOLTIP:"Follow this file",FOLLOW_A11Y:"This button follows the file.",FOLLOW_SUCCESS:"You are now following this file.",STOP_FOLLOWING_NAME:"Stop Following",STOP_FOLLOWING_TOOLTIP:"Stop following this file",STOP_FOLLOWING_A11Y:"This button stops following the file.",STOP_FOLLOWING_SUCCESS:"You have stopped following this file."},TOGGLE_SYNC:{SYNC:{NAME:"Add to Sync",TOOLTIP:"Add this file to sync",A11Y:"This button adds the file to sync.",SUCCESS:"You have added this file to sync.",ERROR:{DEFAULT:"There was an error adding this file to sync. Try again later.",UNAUTHENTICATED:"Your session has timed out. You must log in again before you can add this file to sync.",NOT_FOUND:"You cannot add this file to sync because the file has been deleted or is no longer shared with you.",ACCESS_DENIED:"You cannot add this file to sync because the file has been deleted or is no longer shared with you."}},STOP_SYNC:{NAME:"Remove from Sync",TOOLTIP:"Remove this file from sync",A11Y:"This button removes the file from sync.",SUCCESS:"You have removed this file from sync.",ERROR:{DEFAULT:"There was an error removing this file from sync. Try again later.",UNAUTHENTICATED:"Your session has timed out. You must log in again before you can remove this file from sync.",NOT_FOUND:"You cannot remove this file from sync because the file has been deleted or is no longer shared with you.",ACCESS_DENIED:"You cannot remove this file from sync because the file has been deleted or is no longer shared with you."}}},TOGGLE_FAVORITE:{FAVORITE_NAME:"Pin",FAVORITE_TOOLTIP:"Pin this file",FAVORITE_A11Y:"This button pins the file.",FAVORITE_SUCCESS:"You pinned this file.",STOP_FAVORITEING_NAME:"Unpin",STOP_FAVORITEING_TOOLTIP:"Unpin this file",STOP_FAVORITEING_A11Y:"This button unpins the file.",STOP_FAVORITEING_SUCCESS:"You have unpinned this file."},TRASH:{NAME:"Move to Trash",DIALOG_TITLE:"Confirm",PROMPT:"Are you sure you want to move this file to the trash? Moving this file to the trash makes it unavailable to anyone with whom it is presently shared.",ERROR:"An error occurred deleting the file. Try again later.",TOOLTIP:"Delete this file",OK:"OK",CANCEL:"Cancel",A11Y:"This button moves the file to the trash.",SUCCESS_MSG:"${file} has been moved to the trash."},REFRESH:{NAME:"Refresh",ERROR:"An error occurred refreshing the File Viewer. Try again later.",TOOLTIP:"Refresh the File Viewer",INFO_MSG:"Refresh to get the latest content. ${link}",A11Y:"This button moves the file to the trash.",SUCCESS_MSG:"The Content has successfully been refreshed."},COPY_FILE:{NAME:"Give Copy to Community",DIALOG_TITLE:"Confirm",ERROR:"An error occurred copying the file. Try again later.",TOOLTIP:"Give a copy of this file to a community",OK:"OK",CANCEL:"Cancel",A11Y:"This button opens a dialog which lets you give a copy of this file to a community.",SUCCESS_MSG:"${file} has been copied to ${community}."},UPLOAD_VERSION:{NAME:"Upload New Version",NAME_SHORT:"Upload",CHANGE_SUMMARY:"Optional change summary...",TOOLTIP:"Upload a new version of this file",A11Y:"This button opens a dialog which lets you upload a new version of this file."},LOG_IN:{NAME:"Log In",TOOLTIP:"Log in to upload and share files, comment, and create folders"},LOCK:{NAME:"Lock File",TITLE:"Lock this File",A11Y:"Lock this File",SUCCESS:"The file is now locked.",ERROR:"The file could not be locked because it has been deleted or is no longer shared with you."},UNLOCK:{NAME:"Unlock File",TITLE:"Unlock this File",A11Y:"Unlock this File",SUCCESS:"The file is now unlocked.",ERROR:"The file could not be unlocked because it has been deleted or is no longer shared with you."},EDIT_ON_DESKTOP:{NAME:"Edit on desktop",TITLE:"Edit on desktop",A11Y:"Edit on desktop"},FLAG:{FILE:{NAME:"Flag as Inappropriate",TITLE:"Flag File",A11Y:"Flag this file as inappropriate",PROMPT:"Provide a reason for flagging this file (optional):",OK:"Flag",CANCEL:"Cancel",SUCCESS:"The file has been flagged and submitted for review.",ERROR:"Error flagging this file, please try again later."},FILE_DIALOG:{DIALOG_TITLE:"Success",PROMPT:"The file has been flagged and submitted for review.",CANCEL:"OK"},COMMENT:{NAME:"Flag as Inappropriate",TITLE:"Flag Comment",A11Y:"Flag this comment as inappropriate",PROMPT:"Provide a reason for flagging this comment (optional):",OK:"Flag",CANCEL:"Cancel",SUCCESS:"The comment has been flagged and submitted for review.",ERROR:"Error flagging this comment, please try again later."}},MODERATION:{DIALOG_TITLE:"Success",PROMPT:"The changes have been submitted for review. This file will not be available until the changes are approved.",CANCEL:"OK"},DROPDOWN_BUTTON:"Dropdown button"},SECTION:{ABOUT:{NAME:"About This File",VIEW_FILE_DETAILS:"View File Details",A11Y:"Activating this link will close the file viewer and direct you to the file details page for this file."}},PREVIEW:{ICON:{PREVIEW_NOT_AVAILABLE:"No preview available for this file."},IMAGE:{ZOOM_IN:"Zoom in",ZOOM_OUT:"Zoom out",RESET:"Reset",ZOOM_IN_A11Y:"This button zooms in on the image.",ZOOM_OUT_A11Y:"This button zooms out on the image.",RESET_ZOOM_A11Y:"This button resets the zoom level.",UNSAFE_PREVIEW:"This file cannot be previewed because it has not been scanned for viruses."},VIEWER:{LOADING:"Loading...",PUBLISHING:"Publishing...",NO_PUBLISHED_VERSION:"A published version of this file is not available for viewing.",IFRAME_TITLE:"Preview of this file",AUTOPUBLISH_TIMEOUT:"The server is taking too long to respond.  The latest changes may not have been published."},VIDEO:{UNSAFE_PREVIEW:"This file cannot be previewed because it has not been scanned for viruses."}},DATE:{LAST_UPDATED:{TODAY:"Last updated by ${user} today at ${time}",YESTERDAY:"Last updated by ${user} yesterday at ${time}",DAY:"Last updated by ${user} on ${EEee} at ${time}",MONTH:"Last updated by ${user} on ${date_long}",YEAR:"Last updated by ${user} on ${date_long}"},CREATED:{TODAY:"Created by ${user} today at ${time}",YESTERDAY:"Created by ${user} yesterday at ${time}",DAY:"Created by ${user} on ${EEee} at ${time}",MONTH:"Created by ${user} on ${date_long}",YEAR:"Created by ${user} on ${date_long}"},LONG:{TODAY:"${EEEE}, ${date_long}, ${time_long}",YESTERDAY:"${EEEE}, ${date_long}, ${time_long}",DAY:"${EEEE}, ${date_long}, ${time_long}",MONTH:"${date_long}, ${time_long}",YEAR:"${date_long}, ${time_long}"},SHORT:{TODAY:"${time} - Today",YESTERDAY:"${time} - Yesterday",DAY:"${time} - ${EEee}",MONTH:"${time} - ${date_long}",YEAR:"${time} - ${date_long}"},VERY_SHORT:{TODAY:"Today",YESTERDAY:"Yesterday",DAY:"${EEee}",MONTH:"${date_long}",YEAR:"${date_long}"}},FILE_SIZE:{B:"${0} B",KB:"${0} KB",MB:"${0} MB",GB:"${0} GB",TB:"${0} TB"},COMMENT_BOX:{TITLE:"Comment text area",SHADOW_TEXT:"Add a comment...",CANNOT_ACCESS_CONTENT:"The following people that you mentioned cannot view the comment because they do not have access to the content:",ERROR:"An error occurred validating the user you are attempting to mention.",POST:"Post",SAVE:"Save",CANCEL:"Cancel",EXTERNAL_WARNING:"Comments might be seen by people external to your organization."},EDIT_BOX:{SAVE:"Save",CANCEL:{TOOLTIP:"Cancel",A11Y:"This button cancels the action of editing the file name."},INVALID_CHARACTERS:"Invalid character",INVALID_CHARACTERS_REMOVED:"Invalid characters removed"},COMMENT_WIDGET:{EDITED:"(Edited)",EDITED_DATE:{TODAY:"Edited today at ${time}",YESTERDAY:"Edit yesterday at ${time}",DAY:"Edited on ${EEee} at ${time}",MONTH:"Edited on ${date_long}",YEAR:"Edited on ${date_long}"}},TYPEAHEAD_BOX:{SAVE:"Save",CANCEL:"Cancel",USER:"Person",COMMUNITY:"Community",SHARE:"Share",SHARE_ALT:"Share with this person",MEMBER_TYPE:"Member Type",PERSON_SHADOW:"Type to find person",COMMUNITY_SHADOW:"Type to find community",PERSON_ARIA:"Type to find person.  Press shift tab to change between people, communities, and everyone in the organization.",COMMUNITY_ARIA:"Type to find community.  Press shift tab to change between people, communities, and everyone in the organization.",PERSON_FULL_SEARCH:"Person not listed? Use full search...",COMMUNITY_FULL_SEARCH:"Community not listed? Use full search...",ADD_OPTIONAL_MESSAGE:"Add Optional Message",ROLE_LABEL:"Role",ROLE_EDIT:"Editor",ROLE_VIEW:"Reader"},FILE_STATE:{DOCS_FILE:"This is a Docs file. All edits must be made online.",LOCKED_BY_YOU:{TODAY:"Locked by you at ${time}.",YESTERDAY:"Locked by you yesterday at ${time}.",DAY:"Locked by you on ${date}.",MONTH:"Locked by you on ${date}.",YEAR:"Locked by you on ${date_long}."},LOCKED_BY_OTHER:{TODAY:"Locked at ${time} by ${user}.",YESTERDAY:"Locked yesterday at ${time} by ${user}.",DAY:"Locked on ${date} by ${user}.",MONTH:"Locked on ${date} by ${user}.",YEAR:"Locked on ${date_long} by ${user}."}},VALIDATION:{A11Y_TEXT:"Automatically shorten this text",COMMENT:{WARN_TOO_LONG:"The comment is too long.",TRIM:"Shorten comment?"},DESCRIPTION:{WARN_TOO_LONG:"The description is too long.",TRIM:"Shorten description?"},SHARE_MESSAGE:{WARN_TOO_LONG:"The message is too long.",TRIM:"Shorten message?"},TAG:{WARN_TOO_LONG:"The tag is too long.",TRIM:"Shorten tag?"},TAGS:{WARN_TOO_LONG:"One or more tags are too long.",TRIM:"Shorten tags?"},FILENAME:{WARN_TOO_LONG:"Filename too long"}},DOCS_STATUS_MESSAGE:{NO_ENTITLEMENT:"This file can be edited online by people who have IBM Docs.",NO_ENTITLEMENT_LINK:"This file can be edited online by people who have ${startLink}IBM Docs${endLink}.",CURRENT_EDITORS:"This file is currently being edited on the web by ${users}.",UNPUBLISHED_CHANGES:"There are edits to this draft that have not been published as a version.",PUBLISH_A_VERSION:"Publish a version",PUBLISH_SUCCESS:"You have successfully published a version of this file",PUBLISH_ERROR:{ACCESS_DENIED:"The version could not be published because access was denied.",NOT_FOUND:"The version could not be published because the document was not found.",CANNOT_REACH_REPOSITORY:"The version could not be published because the Docs server is unable to connect to the file repository.",QUOTA_VIOLATION:"The version could not be published because of space restrictions. Remove other files to free enough space to publish this version.",CONVERSION_UNAVAILABLE:"The version could not be published because the Docs conversion service is not available. Try again later.",TOO_LARGE:"The version could not be published because the document is too large.",CONVERSION_TIMEOUT:"The version could not be published because the Docs conversion service is taking too long to convert the document. Try again later.",SERVER_BUSY:"The version could not be published because the Docs server is busy. Try again later.",DEFAULT:"The version could not be published because the Docs service is not available. Try again later."},AUTOPUBLISH:{IN_PROGRESS:"Your edits are being published. ${startLink}Refresh to see your changes.${endLink}",GENERIC:"You might need to refresh the page to see the latest changes.  ${startLink}Refresh${endLink}"}},COMMENTS:{EMPTY:"There are no comments.",MODERATED:"The comment has been submitted for review and will be available when approved.",ERROR:{SAVE:{DEFAULT:"Your comment could not be saved. Try again later.",UNAUTHENTICATED:"Your session has timed out. You must log in again before you can save your comment.",NOT_FOUND:"Your comment could not be saved because the file has been deleted or is no longer shared with you.",ACCESS_DENIED:"Your comment could not be saved because the file has been deleted or is no longer shared with you."},DELETE:{DEFAULT:"Your comment could not be deleted. Try again later.",UNAUTHENTICATED:"Your session has timed out. You must log in again before you can delete your comment.",NOT_FOUND:"Your comment could not be deleted because the file has been deleted or is no longer shared with you.",ACCESS_DENIED:"Your comment could not be deleted because the file has been deleted or is no longer shared with you."}}},TAG_WIDGET:{ADD_TOOLTIP:"Save",EDIT_TAGS:"Edit tags",ERROR:{SAVE:{DEFAULT:"The tag could not be created. Try again later."},DELETE:{DEFAULT:"The tag could not be deleted. Try again later."}}},EXPANDABLE_TEXT:{READ_MORE:"Read More...",READ_LESS:"Read Less..."},SHARE:{EVERYONE:"Everyone in my organization",ADD_TOOLTIP:"Save",ROLES:{OWNER:"Owner",EDIT:"Editors",VIEW:"Readers",FOLDER:"Shared with Folders"},USERROLE:"${userRole} - ${sharedUserCount}",ACTION:{OWNER:{ROLE:"Owner"},EDIT:{ROLE:"Edit",ADD:"Add Editor"},VIEW:{ROLE:"Reader",ADD:"Add Reader"},FOLDER:{ADD:"Add Folders",COMMUNITY_ADD:"Add To Folder",MOVE:"Move to Folder"},MULTI:{ADD:"Add People or Communities",ADD_PEOPLE:"Add People"}},PUBLIC:{SHORT:"Everyone in my organization",LONG:{GENERIC:"Everyone in your organization",ORG:"Everyone in ${org}"}},SHARE_FAIL:{EXISTING_USER:"This file is already shared with ${user}.",ERROR:"Unable to share with ${user} at this time.",SELF:"You cannot share with yourself."},SHARE_INFO:{PROMOTED:"${user} has been promoted to a higher sharing role."},SHARE_SUCCESS:{SUCCESS:"Successfully shared with ${user}"},MULTI_SHARE_SUCCESS:{SUCCESS:"The file was shared successfully."},MESSAGE_BOX:{HINT_TEXT:"Optional message..."},PROVISION_EXTERNAL_USER_DIALOG:{SINGULAR:{NAME:"Provision External User",ACTION:"Provision external user...",TOOLTIP:"Provision external user",DIALOG_TITLE:"Content Was Not Shared",PROMPT:{NO_ACCOUNT:"The following user does not have an account and no content was shared with them.",INVITE:"Invite this user as a guest to share the content with them."},SUBMIT:"Proceed with invitation",CANCEL:"Cancel",ERROR:"An error occured provisioning the account. Try again later.",SUCCESS:"Successfully provisioned user account."},PLURAL:{NAME:"Provision External Users",ACTION:"Provision external users...",TOOLTIP:"Provision external users",DIALOG_TITLE:"Content Was Not Shared",PROMPT:{NO_ACCOUNT:"The following users do not have an account and no content was shared with them.",INVITE:"Invite these users as guests to share the content with them."},SUBMIT:"Proceed with invitations",CANCEL:"Cancel",ERROR:"An error occured provisioning accounts. Try again later.",SUCCESS:"Successfully provisioned user accounts."},ABSTRACT:{NAME:"Provision External Users",ACTION:"Provision external users...",TOOLTIP:"Provision external users",DIALOG_TITLE:"Content Was Not Shared",PROMPT:{NO_ACCOUNT:"Some users do not have accounts and no content was shared with them.",INVITE:"Invite these users as guests to share the content with them."},SUBMIT:"Proceed with invitations",CANCEL:"Cancel",ERROR:"An error occured provisioning accounts. Try again later.",SUCCESS:"Successfully provisioned user accounts."}}},SHARE_OPTIONS:{TITLE:"Sharing Options",PROPAGATION:"Allow others to share this file",EVERYONE:"Everyone can share this file.",OWNER_ONLY:"Only the owner can share this file.",STOP_SHARE:"Stop Sharing",MAKE_INTERNAL:"Stop Sharing Externally",MAKE_INTERNAL_SUCCESS:"This file can no longer be shared with people outside of your organization.",MAKE_INTERNAL_DIALOG:{DIALOG_TITLE:"Make Internal?",PROMPT:"Making this file internal will mean it can no longer be shared with people outside of your organization. ${br}${br}"+"Any shares with external people, communities or folders will be removed.${br}${br}Making a file internal is permanent and cannot be undone.",EFSS:{DIALOG_TITLE:"Make Internal?",PROMPT:"Making this file internal will mean it can no longer be shared with people outside of your organization. ${br}${br}"+"Any shares with external people or folders will be removed.${br}${br}Making a file internal is permanent and cannot be undone."}},MAKE_PRIVATE_DIALOG:{DIALOG_TITLE:"Stop Sharing File",PROMPT:"Are you sure you want to stop sharing this file?",QUESTION_PUBLIC:"This file will no longer be visible to everyone in your organization, or shared with people, folders, or communities. This operation cannot be undone.",QUESTION_PUBLIC_E:"This file will no longer be visible to everyone in your organization, or shared with people or folders. This operation cannot be undone.",QUESTION:"The file will no longer be shared with people or communities, and will be removed from all folders except your private folders. This action cannot be undone.",QUESTION_E:"This file will no longer be shared with people, and will be removed from all folders except your private folders. This action cannot be undone."},MAKE_PRIVATE_SUCCESS:"This file is now private.",MAKE_PRIVATE_ERROR:{DEFAULT:"Unable to stop sharing the file. Try again later."}},SHARE_LINK:{MY_SHARES:"My Shares"},STREAM:{LOADING:"Loading...",LOAD_MORE:"Load more..."},ENTRY:{REMOVE:"Remove",RESTORE:"Restore",EDIT:"Edit",DELETE:"Delete",OK:"OK",CANCEL:"Cancel",USER_PICTURE:"${0}'s Picture",FLAG:"Flag As Inappropriate"},PANEL:{LOAD_ERROR:"There was an error accessing the metadata of this file.",ABOUT:{TITLE:"About",EXPAND_BUTTON:"Expand this button to see more information",CURRENT_VERSION_HEADER:"Current Version ${versionNumber}",FILE_SIZE_HEADER:"File Size",CURRENT_VERSION_FILE_SIZE:"${fileSize} - Current Version",ALL_VERSIONS_FILE_SIZE:"${fileSize} - All Versions",DOCS_DRAFT_UPDATED_HEADER:"Draft Edited",DOCS_DRAFT_CREATED_HEADER:"Draft Created",DOCS_UPDATED_HEADER:"Published",DOCS_CREATED_HEADER:"Created",UPDATED_HEADER:"Updated",CREATED_HEADER:"Created",LIKES_HEADER:"Likes",LIKES_EXPAND_ICON:"Expand this icon to see who has liked the file",DOWNLOADS_HEADER:"Views",DOWNLOADS_HEADER_MORE:"Views (${0})",DOWNLOADS_EXPAND_ICON:"Expand this icon to see who has viewed the file",DOWNLOADS_COUNT:"${downloads}",DOWNLOADS_COUNT_FULL:"${downloads} - ${anonymousDownloads} anonymously",DOWNLOADS_LATEST_VERSION:"You have the latest version of this file",DOWNLOADS_LAST_VERSION:"You last viewed version ${0} of this file",TAGS_HEADER:"Tags",DESCRIPTION_HEADER:"Description",DESCRIPTION_READ_MORE:"Read More...",LINKS_HEADER:"Links",SECURITY:"Security",FILE_ENCRYPTED:"File content is encrypted. Encrypted file content is not searchable. File content cannot be viewed and cannot be edited with IBM Docs.",GET_LINKS:"Get Links...",ADD_DESCRIPTION:"Add a description",NO_DESCRIPTION:"No description",ADD_TAGS:"Add tags",NO_TAGS:"No tags"},COMMENTS:{TITLE:"Comments",TITLE_WITH_COUNT:"Comments (${0})",VERSION:"Version ${0}",FEED_LINK:"Feed for these comments",FEED_TITLE:"Follow changes to these comments through your feed reader"},SHARING:{TITLE:"Sharing",TITLE_WITH_COUNT:"Shared (${0})",SHARED_WITH_FOLDERS:"Shared with Folders - ${count}",SEE_WHO_HAS_SHARED:"See who has shared",COMMUNITY_FILE:"Files owned by a community cannot be shared to people or other communities.",SHARED_WITH_COMMUNITY:"Shared with members of the community '${0}'",LOGIN:"Log in",NO_SHARE:"This file has not been added to any folders yet.",ONE_SHARE:"This file is in 1 folder or community you do not have access to.",MULTIPLE_SHARE:"This file is in ${fileNumber} folders or communities you do not have access to."},VERSIONS:{TITLE:"Versions",TITLE_WITH_COUNT:"Versions (${0})",FEED_LINK:"Feed for these versions",FEED_TITLE:"Follow changes to this file through your feed reader"}},CONFIRMATION_DIALOG:{NAME:"Action Confirmation",DIALOG_TITLE:"Confirm",PROMPT:"Are you sure you want to perform this action?",ERROR:"An error occurred performing the action. Try again later.",TOOLTIP:"Perform action",OK:"OK",CANCEL:"Cancel",A11Y:"This button performs the current action."},THUMBNAIL:{TITLE:"Thumbnail",CHANGE_LINK:"Change Thumbnail...",ERROR:"The thumbnail could not be saved. Try again later.",EXT_ERROR:"Select a file with one of the following supported extensions: ${0}",SUCCESS:"The thumbnail was changed",UPLOAD:"Save",CANCEL:"Cancel"},UPLOAD_VERSION:{LINK:"Upload New Version...",CHANGE_SUMMARY:"Optional change summary...",ERROR:"The new version could not be saved. Try again later.",SUCCESS:"The new version was saved",UPLOAD:"Upload",UPLOAD_AND_CHANGE_EXTENSION:"Upload and Change Extension",CANCEL:"Cancel",TOO_LARGE:"${file} is larger than the ${size} file size allowed.",PROGRESS_BAR_TITLE:"Uploading new version (${uploaded} of ${total} complete)",CANCEL_UPLOAD:"Cancel upload"},OPEN_BY_ID_ERROR:{DEFAULT:"An error occurred accessing the file. Try again later.",UNAUTHENTICATED:"Your session has timed out. You must log in again before you can view the file.",NOT_FOUND:"The file you have requested has been deleted or moved. If someone sent you this link, check that it is correct.",ACCESS_DENIED:"You do not have permission to view this file. The file is not shared with you.",ACCESS_DENIED_ANON:"You do not have permission to view this file. If this is your file or it has been shared with you, you must log in first."},NOTFOUND_FILE_DIALOG:{DIALOG_TITLE:"Error",PROMPT:"The file you have requested has been deleted or moved.",CANCEL:"OK"},LOST_AUTHENTICATION_DIALOG:{DIALOG_TITLE:"Confirm",PROMPT:"Your IBM Connections session has timed out.${lineBreaks}Click OK to log back in or Cancel to close this dialog.",OK:"OK",CANCEL:"Cancel"},ERROR_VALIDATING_FILES_FILE:{DIALOG_TITLE:"Cannot Access Link",PROMPT:"Something went wrong accessing the link.${lineBreaks}Click OK to be redirected to the page.",OK:"OK",CANCEL:"Cancel"},LOAD_ERROR:{DEFAULT:"Oops. There was an error accessing the link.",ACCESS_DENIED:"Contact the file owner to request permission to view this file."},WINDOW_TITLE:{FILE:"${fileName} - File",LOAD_ERROR:"Error accessing file"}}),"pt-br":true,"ca":true,"cs":true,"da":true,"nl":true,"fi":true,"fr":true,"de":true,"el":true,"hu":true,"pt":true,"it":true,"ja":true,"ko":true,"no":true,"pl":true,"ru":true,"zh":true,"sl":true,"es":true,"sv":true,"th":true,"zh-tw":true,"tr":true});


;if(!dojo._hasResource["ic-share/fileviewer/ConnectionsFileViewer"]){
dojo._hasResource["ic-share/fileviewer/ConnectionsFileViewer"]=true;
dojo.provide("ic-share.fileviewer.ConnectionsFileViewer");






































dojo.requireLocalization("ic-share.fileviewer","FileViewerStrings");
















(function(_1){
"use strict";
var _2=define._modules["ic-share/fileviewer/FileViewer"],_3=dojo.getLocalization("ic-share.fileviewer","FileViewerStrings"),_4,_5,_6;
_1.openFromId=function(_7,_8){
var _9,id;
_9=_1.create(_8);
id=_9.addFile(_7);
var _a=new dojo.Deferred();
_9.on("success",function(){
_a.resolve(_9);
});
_9.on("error",function(_b){
if(_a.isFulfilled()){
return;
}
if(!_8||!_8.preventLoginRedirect){
if(_9._args.isAuthenticated()){
if(_b.code==="Unauthenticated"){
_c();
}
}else{
if(_b.code==="Unauthenticated"||_b.code==="AccessDenied"){
lconn.core.auth.login();
}
}
}
_a.reject(_b);
});
_9.open(id);
return _a;
};
function _c(){
var _d=_3.LOST_AUTHENTICATION_DIALOG;
var _e=dojo.string.substitute(_d.PROMPT,{lineBreaks:"<br/><br/>"});
lconn.core.DialogUtil.prompt(_d.DIALOG_TITLE,_e,_d.OK,_d.CANCEL,function(_f){
if(_f){
lconn.core.auth.login();
}
});
};
_1.openFromUrl=function(url,_10){
var id=define._modules["ic-core/util/connectionsUrlUtil"].getFileId(url);
_1.openFromId(id,_10);
};
_1.create=function(_11){
var _12={},_13=dojo.getObject("com.ibm.lconn.layout.people"),_14=dojo.getObject("SemTagSvc");
if(!_11){
_11={};
}
if(_11.createPersonLink){
_12.createPersonLink=_11.createPersonLink;
}else{
if(_13){
_12.createPersonLink=function(_15){
return _13.createLink(_15);
};
}
}
if(_11.createPersonPhotoLink){
_12.createPersonPhotoLink=_11.createPersonPhotoLink;
}
if(_11.previewOptions){
_12.previewOptions=_11.previewOptions;
}
if(_14){
_12.attachBizCard=function(_16){
dojo.addClass(_16,"vcard");
dojo.addClass(_16,"bidiAware");
_14.onTagChanged(_16,true);
};
}
_12.formatDateByAge=function(_17,_18){
var _19=new lconn.share.util.DateFormat(_17);
return _19.formatByAge(_18);
};
var _1a=dojo.i18n.getLocalization("ic-share.fileviewer","FileViewerStrings").FILE_SIZE;
if(!_1a.B){
_1a.B="${0} B";
_1a.KB="${0} KB";
_1a.MB="${0} MB";
_1a.GB="${0} GB";
_1a.TB="${0} TB";
}
dojo.mixin(_12,{login:lconn.core.auth.login,htmlSubstitute:lconn.core.util.html.substitute,isAuthenticated:lconn.core.auth.isAuthenticated,formatSize:dojo.partial(lconn.share.util.text.formatSize,_1a),properties:lconn.core.config.properties,currentUser:_11.currentUser||lconn.core.auth.getUser()||{},TextBoxWidget:lconn.core.lcTextArea.widgets.BasicTextBox,MentionsDataFormatter:lconn.core.widget.mentions.MentionsDataFormatter,PeopleTypeAhead:lconn.core.PeopleTypeAhead,HybridPeopleDataStoreOpenSocial:lconn.core.HybridPeopleDataStoreOpenSocial,TypeAheadDataStore:lconn.core.TypeAheadDataStore,TagTypeAhead:lconn.share.widget.TagTypeAhead,pickerAuth:lconn.core.auth,coreServices:lconn.core.config.services,coreUrl:lconn.core.url,network:lconn.share.util.Network,textUtil:lconn.share.util.text,validationUtil:lconn.share.util.validation,configUtil:lconn.share.util.configUtil,tracker:com.ibm.lconn.layout.track,loadCurrentUser:_11.loadCurrentUser,tornOff:!!_11.tornOff,isIframePage:!!_11.isIframePage,baseFilesConfig:_22(),layer2:function(){
if(_5){
return _5;
}
_5=new dojo.Deferred();
net.jazz.ajax.xdloader.batch_load_async(["lconn.files.FilesRoutes","lconn.files.comm.Routes","lconn.files.action.impl.AddToCollection","lconn.files.action.impl.MoveToCollection","lconn.files.action.impl.CopyFile","lconn.files.util.LibraryDataStore","lconn.files.util.TagDataStore","lconn.files.util.HtmlMessage"],function(){
_5.resolve({pickerRoutes:dojo.getObject("lconn.files.FilesRoutes"),commRoutes:dojo.getObject("lconn.files.comm.Routes"),addToCollection:dojo.getObject("lconn.files.action.impl.AddToCollection"),moveToCollection:dojo.getObject("lconn.files.action.impl.MoveToCollection"),copyFileAction:dojo.getObject("lconn.files.action.impl.CopyFile"),LibraryDataStore:dojo.getObject("lconn.files.util.LibraryDataStore"),TagDataStore:dojo.getObject("lconn.files.util.TagDataStore"),pickerNLS:dojo.i18n.getLocalization("lconn.files","ui")});
});
return _5;
}});
_12.policy=_11.policy||{};
_12.showErrorInOverlay=_11.showErrorInOverlay;
_12.linkTarget=_11.linkTarget;
_12.openedFromFileViewerEverywhere=_11.openedFromFileViewerEverywhere;
if(_11.showDetailsExternalAction){
_12.showDetailsExternalAction=_11.showDetailsExternalAction;
}
return _2.create(_12);
};
_1._openForFiles=function(_1b){
var _1c=_1.create(_1b),_1d;
dojo.forEach(_1b.allFiles||[_1b.initialFile],function(_1e){
if(!_1e.isFolder()){
try{
_1e._urlDetails=lconn.core.url.ensureQualified(_1b.getUrlForPersonalFileInCommunity(_1e));
}
catch(e){
}
if(_1b.showDetailsExternalAction){
_1e.showDetailsExternalAction=_1b.showDetailsExternalAction;
}
var id=_1c.addFile(_2.createConnectionsFile(_1e));
if(_1b.initialFile.getId()===_1e.getId()){
_1d=id;
}
}
});
_1c.open(_1d);
var _1f=dojo.getObject("lconn.core.globalization.bidiUtil");
if(_1f){
lconn.core.globalization.bidiUtil.enforceTextDirectionOnPage(_1c.impl.domNode);
}
};
function _20(){
if(!_4){
var _21=/etag=([^&]+)/.exec(dojo.getObject("net.jazz.ajax.config.params"));
_4=(_21&&_21[1])||"17";
}
return _4;
};
function _22(){
if(_6){
return _6;
}
if(window._lconn_files_config){
_6=dojo.when(window._lconn_files_config);
}else{
_6=dojo.xhrGet({url:"/files/static/"+_20()+"!en-us/iwidgets/CommunityReferentialWidget/core.js",handleAs:"javascript"}).then(function(){
return window._lconn_files_config;
});
}
return _6;
};
if(!window._fidoStylesLoaded){
setTimeout(function(){
var _23=lconn.core.url.getServiceUrl(lconn.core.config.services.webresources);
dojo.create("link",{rel:"stylesheet",href:_23+"/web/_style?include=ic-share.fileviewer.style.connections.css&etag="+_20()},document.getElementsByTagName("head")[0]);
},1);
}
dojo.getObject("lconn.share.fileviewer",true);
lconn.share.fileviewer.ConnectionsFileViewer=_1;
}(window["ic-share"].fileviewer.ConnectionsFileViewer));
}


;define("ic-share/fileviewer/util/history",["dojo/hash","dojo/string","dojo/_base/lang","../data/util/routes","dojo/i18n!../nls/FileViewerStrings","dojo/has","ic-core/util/connectionsUrlUtil","dojo/on","dojo/topic","./url","../config/globals"],function(_1,_2,_3,_4,_5,_6,_7,on,_8,_9,_a){
"use strict";
if(!window._historyUtilPopstateHandle){
window._historyUtilPopstateHandle=on(window,"popstate",function(e){
var _b=_3.getObject("state.fileId",false,e);
if(_b){
_c(_b);
}
});
}
if(!window._historyUtilHashchangeHandle&&_6("fileviewer-detailspage")){
window._historyUtilHashchangeHandle=_8.subscribe("/dojo/hashchange",_3.hitch(this,function(){
if(window.location.href!==window._historyUtilCurrentFileUrl&&_7.shouldOpenConnectionsPreview(window.location.href)){
_c(_7.getFileId(window.location.href));
}
}));
}
function _c(_d){
window["ic-share"].fileviewer.ConnectionsFileViewer.openFromId(_d);
};
function _e(_f,_10,_11){
var url,_12,_13=_4.doesPageSupportFileHash();
if(_14.historySupported&&_10.full){
url=_9.removeHost(_10.full);
if(url===_9.removeHost(window.location.href)){
return;
}
if(_11){
window.history.replaceState(_f,null,url);
}else{
window.history.pushState(_f,null,url);
}
}else{
if(_4.doesPageSupportFileHash()&&_10.hashed){
url=_10.hashed;
_12="#"+_9.createUri(url).fragment;
if(_12===window.location.hash){
return;
}
if(_11){
window.location.replace(_12);
}else{
window.location=_12;
}
}
}
};
var _15;
_16();
function _16(){
if(window.location.href!==_15&&!_7.isConnectionsFileUrl(window.location.href)){
_15=window.location.href;
}
};
setInterval(_16,250);
var _14={onOpen:function(_17,_18){
if(!this._shouldUpdateHistory(_17)){
return;
}
var _19=_18.isOpen,_1a,_1b=false;
if(_7.isConnectionsFileUrl(window.location.href)&&_7.getFileId(window.location.href)===_17.args.id){
_19=true;
_1b=true;
}
_16();
this._setFileUrl(_17,_19,_1b);
_1a=!_17.args.loadError?_2.substitute(_5.WINDOW_TITLE.FILE,{fileName:_17.args.name}):_5.WINDOW_TITLE.LOAD_ERROR;
this._setTitle(_1a);
},_setFileUrl:function(_1c,_1d,_1e){
this.backgroundPageUrl=_15;
if(!this.backgroundPageUrl){
this.backgroundPageUrl=_4.getClosedFileUrlHashed();
}
var _1f,_20;
_1f=this._getFileUrls(_1c,_1e);
_e({fileId:_1c.args.id},_1f,_1d);
_20=window.location.href;
this.currentFileUrl=_20;
window._historyUtilCurrentFileUrl=this.currentFileUrl;
},onClose:function(_21,_22){
if(!this._shouldUpdateHistory(_22)){
return;
}
if(!_21.isOpening&&this.currentFileUrl===window.location.href){
this._setClosedFileUrl();
}
this._unsetTitle(_21.isOpening);
this.currentFileUrl=undefined;
window._historyUtilCurrentFileUrl=this.currentFileUrl;
},_getFileUrls:function(_23,_24){
var _25,_26;
_26=_24?window.location.href:_23.args.links.linkTarget;
if(_26){
_25={full:_9.fromFilesAnchorForm(_26)+"",hashed:_9.toFilesAnchorForm(_26)+""};
}else{
_25=this._getDefaultFileUrls(_23);
}
return _25;
},_getDefaultFileUrls:function(_27){
return {full:_27.args.links.details,hashed:_9.toFilesAnchorForm(_27.args.links.details)+""};
},removeFileParameters:function(_28){
_e({fileId:_28.args.id},this._getDefaultFileUrls(_28),true);
this.currentFileUrl=window.location.href;
},_setClosedFileUrl:function(){
var _29=_4.getClosedFileUrlHashed(this.backgroundPageUrl);
var _2a={full:this.backgroundPageUrl||_29,hashed:_29};
_e({},_2a,false);
if(!this.backgroundPageUrl){
this.backgroundPageUrl=window.location.href;
}
},_setTitle:function(_2b){
this._currentTitle=_2b;
this._backgroundPageTitle=this._backgroundPageTitle||window.document.title;
this._titleCheckId=setInterval(_3.hitch(this,function(){
if(window.document.title!==this._currentTitle){
this._backgroundPageTitle=window.document.title;
window.document.title=this._currentTitle;
}
}),500);
this._titleChangeListener=_8.subscribe("ic-fileviewer/filenamechanged",_3.hitch(this,function(_2c){
window.document.title=this._currentTitle=_2c.newFileName;
}));
window.document.title=this._currentTitle;
},_unsetTitle:function(_2d){
clearInterval(this._titleCheckId);
this._titleChangeListener.remove();
if(!_2d){
window.document.title=this._backgroundPageTitle;
delete this._backgroundPageTitle;
}
},_shouldUpdateHistory:function(_2e){
return !_a.isIframePage&&_6("fileviewer-detailspage")&&(_4.doesPageSupportFileHash()||_14.historySupported)&&(_2e.args.libraryType!=="library");
}};
_14.historySupported=_6("fileviewer-history")&&!!window.history.pushState;
_14.doesPageSupportFileHash=_4.doesPageSupportFileHash;
return _14;
});


;define("dojo/aspect",[],function(){
"use strict";
var _1,_2=0;
function _3(_4,_5,_6,_7){
var _8=_4[_5];
var _9=_5=="around";
var _a;
if(_9){
var _b=_6(function(){
return _8.advice(this,arguments);
});
_a={remove:function(){
if(_b){
_b=_4=_6=null;
}
},advice:function(_c,_d){
return _b?_b.apply(_c,_d):_8.advice(_c,_d);
}};
}else{
_a={remove:function(){
if(_a.advice){
var _e=_a.previous;
var _f=_a.next;
if(!_f&&!_e){
delete _4[_5];
}else{
if(_e){
_e.next=_f;
}else{
_4[_5]=_f;
}
if(_f){
_f.previous=_e;
}
}
_4=_6=_a.advice=null;
}
},id:_2++,advice:_6,receiveArguments:_7};
}
if(_8&&!_9){
if(_5=="after"){
while(_8.next&&(_8=_8.next)){
}
_8.next=_a;
_a.previous=_8;
}else{
if(_5=="before"){
_4[_5]=_a;
_a.next=_8;
_8.previous=_a;
}
}
}else{
_4[_5]=_a;
}
return _a;
};
function _10(_11){
return function(_12,_13,_14,_15){
var _16=_12[_13],_17;
if(!_16||_16.target!=_12){
_12[_13]=_17=function(){
var _18=_2;
var _19=arguments;
var _1a=_17.before;
while(_1a){
_19=_1a.advice.apply(this,_19)||_19;
_1a=_1a.next;
}
if(_17.around){
var _1b=_17.around.advice(this,_19);
}
var _1c=_17.after;
while(_1c&&_1c.id<_18){
if(_1c.receiveArguments){
var _1d=_1c.advice.apply(this,_19);
_1b=_1d===_1?_1b:_1d;
}else{
_1b=_1c.advice.call(this,_1b,_19);
}
_1c=_1c.next;
}
return _1b;
};
if(_16){
_17.around={advice:function(_1e,_1f){
return _16.apply(_1e,_1f);
}};
}
_17.target=_12;
}
var _20=_3((_17||_16),_11,_14,_15);
_14=null;
return _20;
};
};
var _21=_10("after");
var _22=_10("before");
var _23=_10("around");
return {before:_22,around:_23,after:_21};
});


;define("ic-core/wp/configs",["dojo/_base/window","../config/features","../config/properties","../utilities"],function(_1,_2,_3,_4){
var _5=_1.global;
var _6=((_5.ibmConfig)?_5.ibmConfig.serviceName:null),_7=("communities"===_6),_8=("profiles"===_6);
var _9=true;
var _a=_4.getURLParam("useServerInjection",true);
if("false"===_a){
_9=false;
}else{
if("true"===_a){
_9=true;
}else{
if(_8||_7){
_9=!("false"===_3["lconn.core.WidgetPlacement."+_6+".useServerInjection"]);
}
}
}
var _b=false;
var _c=_4.getURLParam("limitedDND",true);
if("false"===_c){
_b=false;
}else{
if("true"===_c){
_b=true;
}
}
var _d=true;
var _e=_4.getURLParam("freeLayout",true);
if("false"===_e){
_d=false;
}else{
if("true"===_e){
_d=true;
}
}
var _f={useServerInjection:_9,limitedDND:_b,freeLayout:_d,serviceName:_6,isCommunitiesPage:_7,isProfilesPage:_8};
var _10=function(_11){
if(!_11){
return null;
}
if(_f[_11]){
return _f[_11];
}
return _5.WidgetPlacementConfig[_11];
};
var _12=function(_13,_14){
if(!_13||_f[_13]){
return;
}
_5.WidgetPlacementConfig[_13]=_14;
return _14;
};
var _15=function(){
var _16=arguments.length;
if(_16===1){
return _10(arguments[0]);
}else{
if(_16===2){
return _12(arguments[0],arguments[1]);
}
}
return null;
};
return _15;
});


;define("ic-core/wp/_impl/layoutInfoStoreJsonImpl",["dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/_base/xhr","dojo/Deferred","../configs","../../errorhandling","ic-gadget/util/trace"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9=_3.global;
var _a=function(_b,_c,_d){
_d=_d||_6("widgetConfigDocument");
_b=_b||_6("pageId")||_6("defaultPageId");
_c=_c||"default";
var _e=_1.filter(_d.layouts,function(_f){
return (_f.resourceSubType===_c);
});
if(!_e.length){
return null;
}
var _10=_1.filter(_e[0].pages,function(_11){
return (_11.pageId===_b);
});
if(!_10.length){
return null;
}
return _10[0];
};
var _12=function(_13,doc){
if(!_13){
return null;
}
if(_2.isArray(_13)){
_13=_13[0];
}
doc=doc||_6("widgetConfigDocument");
var _14=_1.filter(doc.definitions,function(def){
return (def&&def.payload&&def.payload.defId===_13);
});
return ((_14&&_14.length)?_14[0].payload:null);
};
var _15=function(_16,doc,_17){
if(!_16){
return null;
}
if(_2.isArray(_16)){
_16=_16[0];
}
var _18=_a(_17,null,doc);
if(!_18){
return null;
}
var _19=_1.filter(_18.widgetInstances,function(_1a){
return (_1a.instanceId===_16);
});
if(!_19.length){
_19=_1.filter(_18.widgetInstances,function(_1b){
return (_1b.defIdRef===_16);
});
}
return ((_19&&_19.length)?_19[0]:null);
};
var _1c=function(def,doc,_1d){
if(!def){
return null;
}
if(_2.isArray(def)){
def=def[0];
}
def=def.defId||def;
var _1e=_a(_1d,null,doc);
if(!_1e){
return null;
}
var _1f=_1.filter(_1e.widgetInstances,function(_20){
return (_20.defIdRef===def);
});
return _1f;
};
var _21=function(_22,doc,_23){
if(!_22){
return null;
}
if(_2.isArray(_22)){
_22=_22[0];
}
_22=(_2.isString(_22)?_15(_22,doc,_23):_22);
var _24=(_22?_22["defIdRef"]:null);
return _12(_24,doc);
};
var _25=function(_26,doc,_27){
var _28=_a(_26,_27,doc);
return (_28?_28.widgetInstances:null);
};
var _29=function(doc){
doc=doc||_6("widgetConfigDocument");
var _2a={};
var _2b=_1.map(doc.definitions,function(def){
if(!def||!def.payload){
return null;
}
var _2c=def.payload;
if(_2c.defId){
if(_2a[_2c.defId]){
return null;
}else{
_2a[_2c.defId]=true;
return _2c;
}
}else{
return _2c;
}
});
_2b=_1.filter(_2b,function(def){
return !!def;
});
return _2b;
};
var _2d=function(_2e,doc,_2f,_30){
if(!_2e){
return false;
}
if(_30){
var _31=_2e.instanceId||_2e;
if(!_31){
return false;
}
var _32=_15(_31,doc,_2f);
if(!_32){
return false;
}
_32.enabled="true";
}else{
if(!_2e.defIdRef||!_2e.uiLocation||!_2e.instanceId){
return false;
}
var _33=_a(_2f,null,doc);
if(!_33){
return false;
}
_33.widgetInstances.push(_2e);
}
return true;
};
var _34=function(_35,doc,_36,_37){
if(!_35){
return false;
}
if(_37){
var _38=_15(_35,doc,_36);
if(!_38){
return false;
}
_38.enabled="false";
}else{
var _39=_a(_36,null,doc);
if(!_39){
return false;
}
_39.widgetInstances=_1.filter(_39.widgetInstances,function(_3a){
return (_3a&&_3a.instanceId!==_35);
});
}
return true;
};
var _3b=function(_3c,_3d){
var _3e=new _5(),url;
if(!_6("widgetConfigDocument")||true===_3c||true===_9.staleXMLConfig){
url=_6("layoutInfoUrl")+"&format=json";
if(!_9.staleXMLConfig){
url+="&lastMod="+_6("lastMod");
}
if(_6("needsMigration")==true){
url+="&needsMigration=true";
}
_8.debug("Using URL:"+url);
_4.get({url:url,handleAs:"json",sync:true,load:function(_3f){
_6("widgetConfigDocument",_3f);
_3e.resolve();
},error:_3d||_7.DefaultXHRErrorHandler});
_9.staleXMLConfig=false;
}else{
_3e.resolve();
}
return _3e;
};
var _40=function(){
_6("widgetConfigDocument",null);
};
var _41={getWidgetDef:_12,getAllWidgetDefs:_29,getWidgetInstance:_15,getWidgetInstancesByDef:_1c,getWidgetDefByInstance:_21,getPageWidgetInstances:_25,addWidgetInstance:_2d,removeWidgetInstance:_34,withLayoutInfo:_3b,resetLayoutInfo:_40};
return _41;
});


;define("ic-core/wp/_impl/layoutInfoStoreXmlImpl",["dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/_base/xhr","dojo/Deferred","dojo/has","../configs","../../config/features","../../errorhandling","../../util/widgetPlacementConfig","../../xpath","ic-gadget/util/trace"],function(_1,_2,_3,_4,_5,_6,_7,_6,_8,_9,_a,_b){
var _c=_3.global;
var _d="/tns:widgets/tns:layout/tns:page[@pageId=\"%PAGE_ID%\"]/tns:widgetInstance[@instanceId=\"%INST_ID%\"]",_e="/tns:widgets/tns:layout/tns:page[@pageId=\"%PAGE_ID%\"]/tns:widgetInstance[@defIdRef=\"%DEF_ID%\"]",_f="/tns:widgets/tns:definitions/tns:widgetDef[@defId=\"%DEF_ID%\"]",_10="/tns:widgets/tns:layout%LAYOUT_OPTIONS%/tns:page[@pageId=\"%PAGE_ID%\"]/tns:widgetInstance",_11="/tns:widgets/tns:layout/tns:page[@pageId=\"%PAGE_ID%\"]",_12="/tns:widgets/tns:definitions/tns:widgetDef";
var _13=function(_14){
if(!_14){
return null;
}
var _15={};
_1.forEach(_14.attributes,function(_16){
_15[_16.name]=_16.value;
});
var _17=_14.getElementsByTagName("configData"),_18=_14.getElementsByTagName("itemSet");
var _19=[];
if(_17.length){
var _1a=_17[0].getElementsByTagName("attr");
_1.forEach(_1a,function(_1b){
_19.push({"key":_1b.getAttribute("key"),"value":_1b.getAttribute("value")});
});
}
_15.configData=_19;
_19=[];
if(_18.length){
var _1c=_18[0].getElementsByTagName("item");
_1.forEach(_1c,function(_1d){
_19.push({"name":_1d.getAttribute("name"),"value":_1d.getAttribute("value")});
});
}
_15.itemSet=_19;
return _15;
};
var _1e=(function(){
try{
if(!_6("ie")&&!_6("ff")){
return !!_c.navigator.userAgent.match(/Trident\/7\.0/);
}
}
catch(e){
}
return false;
})();
var _1f=function(_20,_21){
if(!_20){
return null;
}
if(_2.isArray(_20)){
_20=_20[0];
}
var _22=null;
if(_6("ie-native-mode")||_1e){
_22=_9.getDefinitionById(_20);
}else{
var doc=((_21)?_21:_7("widgetConfigXMLDocument")),exp=_f.replace("%DEF_ID%",_20);
_22=_a.selectSingleNode(exp,doc);
}
return _13(_22);
};
var _23=function(_24,_25,_26,_27){
if(!_24){
return null;
}
if(_2.isArray(_24)){
_24=_24[0];
}
_26=_26||_7("pageId")||_7("defaultPageId");
var _28=null;
if(_6("ie-native-mode")||_1e){
_28=_9.getInstanceByInstId(_24,_26);
if(!_28){
var _29=_24;
_28=_9.getInstancesByDefId(_29,_26)[0];
}
}else{
var doc=_25||_7("widgetConfigXMLDocument"),exp=_d.replace("%PAGE_ID%",_26).replace("%INST_ID%",_24);
_28=_a.selectSingleNode(exp,doc);
if(!_28){
var _29=_24;
exp=_e.replace("%PAGE_ID%",_26).replace("%DEF_ID%",_29);
_28=_a.selectSingleNode(exp,doc);
}
}
if(_27===false){
return _28;
}else{
return _13(_28);
}
};
var _2a=function(def,_2b,_2c){
if(!def){
return null;
}
if(_2.isArray(def)){
def=def[0];
}
_2c=_2c||_7("pageId")||_7("defaultPageId");
def=def.defId||def;
var _2d=null;
if(_6("ie-native-mode")||_1e){
_2d=_9.getInstancesByDefId(def,_2c);
}else{
var doc=_2b||_7("widgetConfigXMLDocument"),exp=_e.replace("%PAGE_ID%",_2c).replace("%DEF_ID%",def);
_2d=_a.selectNodes(exp,doc);
}
return _1.map(_2d,_13);
};
var _2e=function(_2f,doc,_30){
if(!_2f){
return null;
}
if(_2.isArray(_2f)){
_2f=_2f[0];
}
_30=_30||_7("pageId")||_7("defaultPageId");
doc=doc||_7("widgetConfigXMLDocument");
_2f=(_2.isString(_2f)?_23(_2f,doc,_30):_2f);
var _31=(_2f?_2f["defIdRef"]:null);
return _1f(_31,doc);
};
var _32=function(_33,_34,_35){
_33=_33||_7("pageId")||_7("defaultPageId");
var _36=null;
if(_6("ie-native-mode")||_1e){
_36=_9.getInstances(_33);
}else{
var doc=_34||_7("widgetConfigXMLDocument"),exp=_10.replace("%PAGE_ID%",_33);
if(_35){
exp=exp.replace("%LAYOUT_OPTIONS%","[@resourceSubType=\"%TYPE%\"]").replace("%TYPE%",_35);
}else{
exp=exp.replace("%LAYOUT_OPTIONS%","");
}
_36=_a.selectNodes(exp,doc);
}
return _1.map(_36,_13);
};
var _37=function(_38){
var _39=null;
if(_6("ie-native-mode")||_1e){
_39=_9.getDefinitions();
}else{
var doc=_38||_7("widgetConfigXMLDocument");
_39=_a.selectNodes(_12,doc);
}
var _3a={};
var _3b=_1.map(_39,_13);
_3b=_1.filter(_3b,function(def){
if(!def||!def.defId||_3a[def.defId]){
return false;
}else{
_3a[def.defId]=true;
return true;
}
});
return _3b;
};
var _3c=function(_3d,doc,_3e,_3f){
if(!_3d){
return false;
}
doc=doc||_7("widgetConfigXMLDocument");
_3e=_3e||_7("pageId")||_7("defaultPageId");
var _40=null;
if(_3f){
var _41=_3d.instanceId||_3d;
if(!_41){
return false;
}
_40=_23(_41,doc,_3e,false);
if(!_40){
return false;
}
}else{
if(!_3d.defIdRef||!_3d.uiLocation||!_3d.instanceId){
return false;
}
var _42=null;
if(_6("ie-native-mode")||_1e){
_42=_9.getPageById(_3e);
}else{
var exp=_11.replace("%PAGE_ID%",_3e);
_42=_a.selectSingleNode(exp,doc);
}
if(!_42){
return false;
}
var _43=doc.documentElement.namespaceURI;
if(typeof doc.createElementNS==="function"){
_40=doc.createElementNS(_43,"widgetInstance");
}else{
_40=doc.createNode(1,"widgetInstance",_43);
}
_40.setAttribute("defIdRef",_3d.defIdRef);
if(_3d.instanceId){
_40.setAttribute("instanceId",_3d.instanceId);
}
_40.setAttribute("uiLocation",_3d.uiLocation);
_42.appendChild(_40);
}
_40.setAttribute("enabled","true");
return true;
};
var _44=function(_45,doc,_46,_47){
if(!_45){
return false;
}
_46=_46||_7("pageId")||_7("defaultPageId");
var _48=_23(_45,doc,_46,false);
if(!_48){
return false;
}
if(_47){
_48.setAttribute("enabled","false");
}else{
_48.parentNode.removeChild(_48);
}
return true;
};
var _49=function(_4a,_4b){
var _4c=new _5(),url;
if(!_7("widgetConfigXMLDocument")||true===_4a||true===_c.staleXMLConfig){
url=_7("layoutInfoUrl");
if(!_c.staleXMLConfig){
url+="&lastMod="+_7("lastMod");
}
if(_7("needsMigration")==true){
url+="&needsMigration=true";
}
_b.debug("Using URL:"+url);
_4.get({url:url,handleAs:"xml",sync:true,load:function(_4d){
_7("widgetConfigXMLDocument",_4d);
_4c.resolve();
},error:_4b||_8.DefaultXHRErrorHandler});
_c.staleXMLConfig=false;
}else{
_4c.resolve();
}
return _4c;
};
var _4e=function(){
_7("widgetConfigXMLDocument",null);
};
var _4f={getWidgetDef:_1f,getAllWidgetDefs:_37,getWidgetInstance:_23,getWidgetInstancesByDef:_2a,getWidgetDefByInstance:_2e,getPageWidgetInstances:_32,addWidgetInstance:_3c,removeWidgetInstance:_44,withLayoutInfo:_49,resetLayoutInfo:_4e};
return _4f;
});


;define("ic-core/wp/utils",["dojo/_base/array","dojo/_base/kernel","dojo/_base/lang","dojo/_base/window","dojo/_base/xhr","dojo/Deferred","dojo/dom","dojo/dom-construct","dojo/dom-style","dojo/has","dojo/i18n!../config/nls/widgetbundles","dojo/i18n!../nls/strings","dojo/i18n!../nls/widgets","dojo/string","dijit/Dialog","./configs","./_impl/layoutInfoStoreJsonImpl","./_impl/layoutInfoStoreXmlImpl","../config/features","../errorhandling","../HTMLUtil","../util/widgetPlacementConfig","../xpath","ic-gadget/container/iContainer2","ic-gadget/util/trace","ic-ui/MessageBox"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_a,_13,_14,_15,_16,_17,_18,_19){
var win=_4.global;
var _1a=_d;
var _1b=null;
var _1c=_c;
var _1d=false;
var _1e=null;
var _1f=function(){
if(!_1d){
_17.init();
}
var _20=_17.getIRuntime();
_20.then(function(){
_1d=true;
});
if(!_20||"function"!==typeof _20.then){
_20=new _6();
_20.reject("_withIRuntime: failed to get iRuntime.");
}
return _20;
};
var _21=function(_22){
if(/{[^}]+:[^}]+}/.test(_22)){
return _22;
}
var _23=_10("params"),_24=_22.replace(/{/g,"${");
return _e.substitute(_24,_23,function(v,k){
return (v?v:"{"+k+"}");
});
};
var _25=function(){
var _26=null;
if(_10("isProfilesEnv")){
if(win.profilesData.displayedUser&&!win.profilesData.displayedUser.profileType){
win.profilesData.displayedUser.profileType="default";
}
_26=win.profilesData.displayedUser;
}
return _26;
};
var _27=function(_28,_29){
_1b=_1b||_2.i18n.getLocalization("lconn.core.config","widgetbundles");
var _2a=_28.bundleRefId||"lc_default";
var _2b=_28[_29];
var _2c=_1b||{};
var _2d=_2c[_2b];
if(typeof _2d!=="string"&&_2c[_2a]){
_2d=_2c[_2a][_2b];
}
if(typeof _2d!=="string"){
_2d=_2b;
}
return _2d;
};
var _2e=function(_2f,_30){
_1b=_1b||_2.i18n.getLocalization("lconn.core.config","widgetbundles");
var _31=_2f.bundleRefId||"lc_default";
var _32=_1b[_31];
if(!_32){
_18.log("unable to find resource bundle for \""+_31+"\"");
_32={};
}
var _33=_32[_30];
return ((_33===undefined)?_30:_33);
};
var _34=function(_35,_36){
_1b=_1b||_2.i18n.getLocalization("lconn.core.config","widgetbundles");
var _37=_35.bundleRefId||"lc_default";
var _38=_35[_36];
var _39=_1b||{};
var _3a=_39[_38];
if(!_3a&&_39[_37]){
_3a=_39[_37][_38];
}
if(!_3a){
_3a=_38;
}
return _3a;
};
var _3b=function(_3c,_3d){
var _3e=null;
if(_3c){
_3e=_34(_3c,"defId");
if(_3e&&_3.isObject(_3e)){
_3e=_3e[_3d]||_3e["default"];
}
}
return _3e;
};
var _3f=function(_40,_41,_42,_43){
if("undefined"===typeof _42){
_42=false;
}
return _14.escapeInlineText(_44(_40,_41,_43),_42);
};
var _44=function(_45,_46,_47){
var _48=null;
if(_46){
var _49=_46.defaultTitle;
if(!_49){
_48=_46.title;
}
}
if(_48==null){
_45=_45||_4a.getWidgetDefByInstance(_46);
_48=_3b(_45,_47);
}
return _48;
};
var _4b=function(_4c){
var _4d=[],_4e=[],_4f=[];
for(var i=0;i<_4c.length;i++){
var _50=_4c[i];
var _51=_50.uiLocation;
if(_51==="col2"){
_4d.push(_50);
}else{
if(_51==="col3"&&_50.defIdRef!=="Members"){
_4e.push(_50);
}else{
_4f.push(_50);
}
}
}
_4f=_4f.concat(_4d,_4e);
return _4f;
};
var _52=function(_53,_54){
var _55=_7.byId(_53+"Section");
if(_55){
var _56=query("#"+_54,_55);
if(_56&&_56.length){
try{
if(_56[0].focus){
_56[0].focus();
}
}
catch(e){
_18.error(e.message);
}
}
}
};
var _57=function(_58,_59){
if(!_59){
return false;
}
var _5a=_59.themes;
return (!_5a||!_58||_5a.indexOf(_58)!==-1);
};
var _5b=function(_5c,_5d,_5e){
if(!_5d){
return false;
}
if("undefined"===typeof _5e){
_5e=true;
}
var _5f=_5d.modes||"view";
return ((!_5c&&!_5e)||(_5c&&_5f.indexOf(_5c)!==-1));
};
var _60=function(_61){
if(_10("isCommunitiesPage")&&win.ic_comm_communityName&&_61){
var _62="${0} - ${1}";
var _63=[_61,win.ic_comm_communityName];
win.document.title=_e.substitute(_62,_63);
}
};
var _64=function(_65){
var _66=null;
if(_10("userLoggedIn")){
if(win.widgetUserInfo!=null){
var _67=win.widgetUserInfo[_65];
if(_67==undefined||_67=="undefined"||_67==null){
_66=null;
}else{
_66=_67;
}
}else{
if(_10("userInfoXML")!=null){
_66=_10("userInfoXML").documentElement.getAttribute(_65);
}else{
var _68=function(res){
_10("userInfoXML",res);
var _69=res.documentElement.getAttribute(_65);
if(_69&&_69!=="undefined"){
_66=_69;
}
};
var url=_10("userInfoUrl");
request(url,{method:"GET",handleAs:"xml",sync:true}).then(_68,_13.DefaultXHRErrorHandler);
}
}
}
return _66;
};
var _6a=function(){
var _6b=_10("pageId");
return _6b&&(_6b.indexOf("Updates")!==-1);
};
var _6c=function(){
var _6d="<div class=\"lotusDialogBorder\" role=\"alert\" aria-live=\"assertive\">"+"<form class=\"lotusDialog lotusForm\">"+"<h1>"+"<img src=\""+_10("applicationContext")+"/nav/common/styles/images/loading.gif\" title=\""+_1a["widget_AddingWidget"]+"\">"+_1a["widget_AddingWidget"]+"</h1>"+"</form>"+"</div>";
_6e(_6d);
};
var _6f=function(){
var _70="<div class=\"lotusDialogBorder\" role=\"alert\" aria-live=\"assertive\">"+"<form class=\"lotusDialog lotusForm\">"+"<h1>"+"<img src=\""+_10("applicationContext")+"/nav/common/styles/images/loading.gif\" title=\""+_1a["widget_AddingWidget"]+"\">"+_1a["widget_RemovingWidget"]+"</h1>"+"</form>"+"</div>";
_6e(_70);
};
var _71=function(_72){
var _73=true;
var _74=_4a.getWidgetDef(_72);
if(_74){
var _75=_74.showFullWidgetDeleteConfirmation;
if(_75==="false"){
_73=false;
}
}
return _73;
};
var _76=function(){
if(!_1e){
var _77=_7.byId("dialog1Container");
if(!_77){
_77=_8.create("div",{id:"dialog1Container"},_7.byId("lotusContent"));
}
_1e=new _f({id:"dialog1",style:"width: 500px"},_77);
}
return _1e;
};
var _6e=function(_78){
var _79=_76();
if(_79){
_79.setContent(_78);
try{
_9.set(_79.titleBar,"display","none");
}
catch(error){
_18.error(error);
}
_79.show();
var _7a=_7.byId("dialog1.button");
if(_7a){
_7a.focus();
}
}
};
var _7b=function(){
var _7c=_76();
if(_7c){
_7c.hide();
}
};
var _7d=function(_7e){
var _7f="";
if(_3.isObject(_7e)){
_7f=_2.objectToQuery(_7e);
}else{
if(_3.isString(_7e)){
_7f=_3.trim(_7e);
}
}
win.location.hash=_7f;
};
var _80=function(_81,_82,_83,_84,_85,_86,_87){
if(_3.isString(_85)){
_85=_7.byId(_85);
}
if(_85){
var _88=("error"===_81);
_83=_83||(_88?_1a["error.title.generic"]:null);
if(!_83){
return;
}
if(true!==_87){
_85.innerHTML="";
}
var _89=(_88?"ERROR":"WARNING");
var _8a=_8.create("div",null,_85,"first");
var _8b=new _19({_strings:{icon_alt:_1c["rs_messagebox_"+_81+"_a11y_label"],a11y_label:_1c["rs_messagebox_"+_81+"_a11y_label"]},type:_19.TYPE[_89],msg:_83,msgMore:_84},_8a);
if(false!==_86&&_84){
_8b.showMoreNode.click();
}
}else{
_18.warn("Unable to show message in the container",_85);
}
};
var _8c=function(_8d,_8e,_8f,_90,_91){
_80(_8d,"global",_8e,_8f,"headline",_90,_91);
};
var _92=function(_93,_94,_95,_96,_97,_98){
_80(_94,"widget"+_93,_95,_96,_93,_97,_98);
};
var _4a={withIRuntime:_1f,getI18nString:_21,getDisplayedUserInfo:_25,getResourcedStringForItem:_27,getResourcedStringById:_2e,getDefaultWidgetName:_3b,getEscapedWidgetName:_3f,getWidgetName:_44,isThemeSupported:_57,isModeSupported:_5b,getUserProfileOverrideProperty:_64,isUpdatesPage:_6a,sortWidgetInstances:_4b,setFocus:_52,changeHash:_7d,setTitle:_60,showAddWidgetDialog:_6c,showRemoveWidgetDialog:_6f,showFullWidgetDeleteConfirmation:_71,getDialog:_76,displayDialog:_6e,hideDialog:_7b};
if(_a("json-widget-metadata")){
_3.mixin(_4a,_11);
}else{
_3.mixin(_4a,_12);
}
_3.mixin(_4a,(function initCustomFuncs(){
var _99={filter:{canAddWidget:[],canRemoveWidget:[],isWidgetRemovalAccepted:[]},callback:{addWidget:[],removeWidget:[]},handler:{handleSearchRequest:[]}};
var _9a=function(_9b,_9c,_9d){
if(!_9c||!_3.isFunction(_9d)){
_18.debug("unable to register "+_9b+" \""+_9c+"\"");
return;
}
if(!_3.isArray(_99[_9b][_9c])){
_18.debug("registering a "+_9b+" \""+_9c+"\" which is never defined before");
}
_99[_9b][_9c].push(_9d);
};
var _9e=function(_9f,_a0){
if(!_a0||!_3.isArray(_99[_9f][_a0])){
_18.debug("no "+_9f+" with name \""+_a0+"\" is found");
return null;
}
return _99[_9f][_a0];
};
var _a1=function(_a2,_a3){
if(!_a3||!_3.isArray(_99[_a2][_a3])){
_18.debug("no "+_a2+" is about to be cleared with name \""+_a3+"\"");
return;
}
_99[_a2][_a3]=[];
};
var _a4={registerFilter:_3.partial(_9a,"filter"),registerCallback:_3.partial(_9a,"callback"),registerHandler:_3.partial(_9a,"handler"),getFilters:_3.partial(_9e,"filter"),getCallbacks:_3.partial(_9e,"callback"),getHandlers:_3.partial(_9e,"handler"),clearFilters:_3.partial(_a1,"filter"),clearCallbacks:_3.partial(_a1,"callback"),clearHandlers:_3.partial(_a1,"handler")};
return _a4;
})());
_3.setObject("lconn.core.wp.utils",_4a);
return _4a;
});


;if(!dojo._hasResource["ic-ui.util.fileViewerListener"]){
dojo._hasResource["ic-ui.util.fileViewerListener"]=true;
dojo.provide("ic-ui.util.fileViewerListener");
















(function(_1,_2,_3,_4,_5,_6,_7){
"use strict";
var _8="javascript:";
if(_1("fileviewer-everywhere")&&(_4.historySupported||_4.doesPageSupportFileHash({services:_6}))){
dojo.ready(function(){
_5.before(document,"onclick",_9);
});
}
function _9(_a){
var _b=_c(_a);
if(_2.shouldOpenConnectionsPreview(_b)){
if(!_4.historySupported&&!_d(_b,window.location.href)){
return false;
}
var _e=_2.getFileId(_b);
_3.openFromId(_e,{linkTarget:_b,openedFromFileViewerEverywhere:true});
if(_a){
_a.preventDefault();
_a.stopPropagation();
}else{
window.event.returnValue=false;
}
}
};
function _c(_f){
try{
if(_10(_f||window.event)){
return;
}
var t=_f?_f.target:dojo.getObject("event.srcElement");
if(t&&(!_f||_f.button===0)){
var nn=t.nodeName.toLowerCase();
if("input"===nn||"select"===nn||"option"===nn){
return;
}
if("a"!==nn){
do{
t=t.parentNode;
if(!t||t._nolink){
t=_f.target.parentNode;
while(t&&!t._nolink){
t._nolink=true;
t=t.parentNode;
}
return;
}
}while(t.nodeName.toLowerCase()!=="a");
}
if(t.href&&!t.href.match(_8)&&(_11(t,_f||window.event)||_12(t))){
return t.href;
}
}
}
catch(err){
console.log("Error caught while determining if file viewer should open",err);
}
return;
};
function _10(evt){
return evt.ctrlKey||evt.metaKey;
};
function _11(_13,evt){
return (!_13.getAttribute("target")||_13.getAttribute("target")==="_self");
};
function _12(_14){
var _15=dojo.getObject("previousSibling.previousSibling",false,_14);
return !!_15&&_15.tagName.toLowerCase()==="a"&&_15.getAttribute("_ic_source")==="files"&&!!_15.getAttribute("_ic_files_uuid");
};
function _d(_16,_17){
var _18,_19;
if(_2.isFilesAppUrl(_16)){
return _2.isFilesAppUrl(_17);
}
if(_2.isCommunityWidgetUrl(_16)){
var _1a=_7.parse(_16).queryParameters.communityUuid;
var _1b=_7.parse(_17).queryParameters.communityUuid;
return _1a===_1b;
}
return true;
};
}(lconn.core.config.features,define._modules["ic-core/util/connectionsUrlUtil"],window["ic-share"].fileviewer.ConnectionsFileViewer,define._modules["ic-share/fileviewer/util/history"],define._modules["dojo/aspect"],lconn.core.config.services,lconn.core.url));
}


;if(!dojo._hasResource["lconn.core.widget.mentions.TagMentionsNode"]){
dojo._hasResource["lconn.core.widget.mentions.TagMentionsNode"]=true;
dojo.provide("lconn.core.widget.mentions.TagMentionsNode");






(function(){
var _1="TagMentions";
dojo.declare("lconn.core.widget.mentions.TagMentionsNode",[lconn.core.widget.mentions.MentionsNode],{_hasSymbol:true,symbol:"#",type:_1,constructor:function(_2){
this.className="TagMentionsNode";
},toJsonString:function(){
return {type:this.type,value:this.value};
}});
lconn.core.widget.mentions.TagMentionsNode.TYPE=_1;
})();
}


;if(!dojo._hasResource["lconn.core.widget.mentions.TagMentionsType"]){
dojo._hasResource["lconn.core.widget.mentions.TagMentionsType"]=true;
dojo.provide("lconn.core.widget.mentions.TagMentionsType");










dojo.declare("lconn.core.widget.mentions.TagMentionsType",lconn.core.widget.mentions.MentionsType,{_type:"TagMentionsType",_activatorChar:"#",templateClass:"lconn.core.widget.mentions.TagMentionsNode",_typeahead:null,initDefaultDataStore:function(){
if(lconn.core.config.services.activities){
this._typeaheadFeed=lconn.core.url.getServiceUrl(lconn.core.config.services.activities)+"/service/json/tags";
this.typeaheadDataStore=new lconn.core.TypeAheadDataStore({url:this._typeaheadFeed,queryParam:"tag"});
}
},initTypeahead:function(){
this._typeahead=new lconn.core.CommonTags.CommonTagsTypeAhead(this._typeaheadArgs);
}});
}


;if(!dojo._hasResource["lconn.core.widget.mentions.utilities"]){
dojo._hasResource["lconn.core.widget.mentions.utilities"]=true;
dojo.provide("lconn.core.widget.mentions.utilities");


lconn.core.widget.mentions.utilities.isSmartCloud=function(_1){
dojo.deprecated("Use declarative bindings to differentiate code in SmartCloud","5.0");
return _1&&_1.environment==="SmartCloud";
};
lconn.core.widget.mentions.utilities.isProfilesEnabled=function(){
dojo.deprecated("Use lconn.core.config.services.profiles to check if Profiles is enabled","5.0");
return lconn.core.config.services.profiles;
};
lconn.core.widget.mentions.utilities.cleanupHTML=function(_2){
if(_2.indexOf("vcard")>-1){
_2=_2.replace(/(\s|")contenteditable="false"/gi,"$1");
_2=_2.replace(/class=\"fn url hasHover\"/gi,"class=\"fn url\"");
_2=_2.replace(/(\s|")icbizcard_ref="\d+"/gi,"$1");
_2=_2.replace(/(\s|")icbizcard_idx="\d+"/gi,"$1");
_2=_2.replace(/(\s|")aria-label="[^"\r\n]*"/gi,"$1");
_2=_2.replace(/(\s|")_bizcardprocessed_="true"/gi,"$1");
}
return _2;
};
}


;if(!dojo._hasResource["lotuslive.widgets.mentions.utilities"]){
dojo._hasResource["lotuslive.widgets.mentions.utilities"]=true;
(function(){
dojo.provide("lotuslive.widgets.mentions.utilities");
dojo.mixin(lconn.core.widget.mentions.utilities,{cleanupHTML:function(_1){
if(_1.indexOf("vcard")>-1){
_1=_1.replace(/(\s|")contenteditable="false"/gi,"$1");
_1=_1.replace(/class=\"fn url hasHover\"/gi,"class=\"fn url\"");
_1=_1.replace(/(\s|")icbizcard_ref="\d+"/gi,"$1");
_1=_1.replace(/(\s|")icbizcard_idx="\d+"/gi,"$1");
_1=_1.replace(/(\s|")aria-label="[^"\r\n]*"/gi,"$1");
_1=_1.replace(/<a[^>]*class="[^"]*menu_drop_icon[^"]*"[^>]*>([^<]|<[^\/]|<\/[^a]|<\/a[^>])*<\/a>/g,"");
}
return _1;
}});
})();
}


;if(!dojo._hasResource["lconn.core.widget.mentions.mentions"]){
dojo._hasResource["lconn.core.widget.mentions.mentions"]=true;
dojo.provide("lconn.core.widget.mentions.mentions");
























}


;if(!dojo._hasResource["lotuslive.widgets.mentions"]){
dojo._hasResource["lotuslive.widgets.mentions"]=true;
dojo.provide("lotuslive.widgets.mentions");














(function(){
function _1(){
var _2,_3=dojo.getObject("gllConnectionsData.srvUrls.contacts");
if(_3){
_2=_3;
}else{
var _4=lconn.core.url.getServiceUrl(lconn.core.config.services.scprofiles).toString();
_2=_4.substring(0,_4.lastIndexOf("/profiles"));
}
var _5=_2+"/typeahead/people?contacts=false&users=true"+"&groups=false&strict=true&intent=external";
return _5;
};
dojo.extend(lconn.core.widget.mentions.PersonMentionsType,{initDefaultDataStore:function(){
},initTypeahead:function(){
var _6=this._typeahead;
var _7=_6.parentNode;
var _8=dojo.create("form",{},dojo.body());
_8.appendChild(_6);
var _9={dojoType:"bhc.PeopleTypeAhead",url:_1(),inline:true};
this._typeahead=dojo.parser.instantiate([_6],_9)[0];
}});
var w={handleTypeaheadKeyInput:function(){
var pw=this.getActiveType_Popup();
var _a=pw.getHighlightedOption();
if(_a){
if(_a==pw.nextButton){
pw.onPage(1);
}else{
if(_a==pw.previousButton){
pw.onPage(-1);
}else{
var _b=this.getActiveType_Field();
_b.onSelectOption();
var _c=_b.getItem();
if(_c){
this.completeMention(_c);
}
}
}
}
}};
dojo.extend(lconn.core.widget.mentions.MentionsTypeaheadUtils,w);
dojo.extend(lconn.core.widget.mentions.MentionsHelper,w);
})();
}


;if(!dojo._hasResource["lconn.core.bundle_common"]){
dojo._hasResource["lconn.core.bundle_common"]=true;
dojo.provide("lconn.core.bundle_common");














































































































































































}


;define("dojo/i18n!ic-search/searchPanel/nls/SearchPaneManager", {"QUICK_RESULTS_ANNOUNCEMENT":"${number} History results found","PEOPLE_FINDER_ANNOUNCEMENT_SINGULAR":"1 Person result found","SEARCH_SCOPE_ANNOUNCEMENT":"Press enter to Search in ${scope}","GLOBAL_SCOPE_PLACEHOLDER":"Search All Content","PEOPLE_FINDER_ANNOUNCEMENT":"${number} People results found","LOCAL_SCOPE_BUTTON":"Search in ${scope}","QUICK_RESULTS_ANNOUNCEMENT_SINGULAR":"1 History result found","LOCAL_SCOPE_PLACEHOLDER":"Search ${scope}","GLOBAL_SCOPE_BUTTON":"Search in All Content","SEARCH_ALT_TEXT":"Search","ALL_CONTENT":"All Content","SEARCH_LABEL":"Search and History","SEARCH_BUTTON_LABEL":"Click to open Search and History panel"});
if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["ic-search"]=true;

;define("dojo/text!ic-search/searchPanel/templates/SearchPaneManager.html", '<div role="search" class="icSearchPaneButton" aria-label="${SEARCH_LABEL}">\n	<a class="icSearchIcon" href="javascript:;" role="button" title="${SEARCH_ALT_TEXT}" aria-label="${SEARCH_BUTTON_LABEL}" data-dojo-attach-point="_searchButton" data-dojo-attach-event="onclick: openSearchPane">\n		<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewbox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n			<g>\n				<path d="M12,1C5.926,1,1,5.926,1,12c0,6.074,4.926,11,11,11s11-4.926,11-11C23,5.926,18.074,1,12,1z M12,21c-4.962,0-9-4.038-9-9 s4.038-9,9-9s9,4.038,9,9S16.962,21,12,21z"></path>\n				<rect x="23.879" y="21.05" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -10.7696 26)" width="4.243" height="9.899"></rect>\n				<circle cx="21" cy="21" r="1"></circle>\n			</g>\n		</svg>\n	</a>\n	<div style="display: none;" data-dojo-props="SEARCH_PLACEHOLDER: \'${GLOBAL_SCOPE_PLACEHOLDER}\', globalScopeLabel: \'${globalScope.label}\', globalScopeAria: \'${GLOBAL_SCOPE_BUTTON}\'" data-dojo-attach-point="_otherSearchBar" data-dojo-type="ic-search/searchPanel/SearchBar"></div>\n	<form style="display: none;" action="" data-dojo-attach-point="formNode">\n		<input type="hidden" name="query" value="" data-dojo-attach-point="queryNode">\n		<input type="hidden" name="scope" value="" data-dojo-attach-point="scopeNode">\n		<input type="hidden" name="component" value="" data-dojo-attach-point="featureNode">\n	</form>\n</div>');

;define("dojo/i18n!ic-core/peopleFinder/directory/nls/PeopleFinderService", {"DIRECTORY_RESULTS":"DIRECTORY","MORE_DIRECTORY_ARIA_LABEL":"Selecting this option it will bring you to the Profile Directory page","MORE_DIRECTORY_RESULTS":"More Directory Results...","ENTRY_ARIA_LABEL":"Selecting this option will bring you to the person Profile page"});
if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["ic-personcard"]=true;

;define("dojo/text!ic-personcard/widget/templates/PersonWidget.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="lconn_personContainer">\n	<div class="lconn_profileImage">\n		<img alt="" role="presentation" src="${photoUrl}" style="max-width: ${_normalSize}px; max-height: ${_normalSize}px;" data-dojo-attach-point="photoNode">\n	</div>\n	<div class="lconn_profileInfo">\n		<div class="vcard">\n			<a href="${profileUrl}" class="fn url lotusPerson bidiAware" title="${displayNameEscaped}" data-dojo-attach-point="linkNode">${!displayNameString}</a>\n			<span style="display: none;" class="email">${_escapedMail}</span>\n			<span style="display: none;" class="x-lconn-userid">${userId}</span>\n		</div>\n		<div>\n			<span data-dojo-attach-point="jobResponsibilityNode">${!jobResponsibility}</span>\n		</div>\n		<div>\n			<span data-dojo-attach-point="addressNode">${!address}</span>\n		</div>\n		<div class="lconn_additionalInfo lotusHidden" data-dojo-attach-point="additionalInfo">\n			<div>\n				<a href="mailto:${_escapedMail}" data-dojo-attach-point="mailNode" data-dojo-attach-event="onclick: _mailClicked">${!mail}</a>\n			</div>\n			<div>\n				<span data-dojo-attach-point="phoneNode">${!phone}</span>\n			</div>\n		</div>\n		<div class="lotusHidden" data-dojo-attach-point="tagsContainer">\n			<span class="lconn_highlightedTagsTitle">${TAGS_L}</span>\n			<div class="lconn_highlightedTags" data-dojo-attach-point="highlightedTags">${!tagString}</div>\n		</div>\n	</div>\n</div>\n');

;define("dojo/text!ic-personcard/widget/templates/PersonWidget_medium.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="lconn_personContainer">\n	<div class="lconn_profileImage">\n		<img alt="" role="presentation" src="${photoUrl}" style="max-width: ${_bigSize}px; max-height: ${_bigSize}px;" data-dojo-attach-point="photoNode">\n	</div>\n	<div class="lconn_profileInfo lconn_medium_confidence">\n		<div class="vcard">\n			<a href="${profileUrl}" class="fn url lotusPerson bidiAware" title="${displayNameEscaped}" data-dojo-attach-point="linkNode">${!displayNameString}</a>\n			<span style="display: none;" class="email">${_escapedMail}</span>\n			<span style="display: none;" class="x-lconn-userid">${userId}</span>\n		</div>\n		<div>\n			<span data-dojo-attach-point="jobResponsibilityNode">${!jobResponsibility}</span>\n		</div>\n		<div>\n			<span data-dojo-attach-point="addressNode">${!address}</span>\n		</div>\n		<div class="lconn_additionalInfo" data-dojo-attach-point="additionalInfo">\n			<div>\n				<a href="mailto:${_escapedMail}" data-dojo-attach-point="mailNode" data-dojo-attach-event="onclick: _mailClicked">${!mail}</a>\n			</div>\n			<div>\n				<span data-dojo-attach-point="phoneNode">${!phone}</span>\n			</div>\n		</div>\n		<div class="lotusHidden" data-dojo-attach-point="tagsContainer">\n			<span class="lconn_highlightedTagsTitle">${TAGS_L}</span>\n			<div class="lconn_highlightedTags" data-dojo-attach-point="highlightedTags">${!tagString}</div>\n		</div>\n	</div>\n</div>\n');

;define("dojo/text!ic-personcard/widget/templates/PersonWidget_high.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="lconn_personContainer">\n	<div class="lconn_profileImage">\n		<img alt="" role="presentation" src="${photoUrl}" style="max-width: ${_bigSize}px; max-height: ${_bigSize}px;" data-dojo-attach-point="photoNode">\n	</div>\n	<div class="lconn_profileInfo-high">\n		<div class="vcard">\n			<a href="${profileUrl}" class="fn url lotusPerson bidiAware" title="${displayNameEscaped}" data-dojo-attach-point="linkNode">${!displayNameString}</a>\n			<span style="display: none;" class="email">${_escapedMail}</span>\n			<span style="display: none;" class="x-lconn-userid">${userId}</span>\n		</div>\n		<div>\n			<span data-dojo-attach-point="jobResponsibilityNode">${!jobResponsibility}</span>\n		</div>\n		<div>\n			<span data-dojo-attach-point="addressNode">${!address}</span>\n		</div>\n		<div class="lconn_additionalInfo" data-dojo-attach-point="additionalInfo">\n			<div>\n				<a href="mailto:${_escapedMail}" data-dojo-attach-point="mailNode" data-dojo-attach-event="onclick: _mailClicked">${!mail}</a>\n			</div>\n			<div>\n				<span data-dojo-attach-point="phoneNode">${!phone}</span>\n			</div>\n		</div>\n	</div>\n	<div class="lconn_separator"></div>\n	<div class="lconn_tags" data-dojo-attach-point="tagsContainer">\n		<div class="lconn_title">${TAGS}</div>\n		<div data-dojo-attach-point="tagCloudNode">${!tagString}</div>\n		<div class="lotusHidden" data-dojo-attach-point="exceededTags">${!exceedingTagString}</div>\n		<a href="javascript:;" class="lotusHidden" data-dojo-attach-point="exceededMessage" data-dojo-attach-event="onclick: showExceedingTags"></a>\n	</div>\n</div>\n');

;define("dojo/text!ic-personcard/widget/templates/PersonWidget_compact.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="lconn_personContainer compact">\n	<div class="lconn_profileImage">\n		<img class="lconn_userImage" alt="" role="presentation" src="${photoUrl}" style="max-width: ${_compactSize}px; max-height: ${_compactSize}px;" data-dojo-attach-point="photoNode">\n	</div>\n	<div class="lconn_profileInfo">\n		<div>\n			<span class="lconn_title" data-dojo-attach-point="linkNode">${!displayNameString}</span>\n			<a class="lconn_title" href="${profileUrl}" style="display: none;" data-dojo-attach-point="hiddenLinkNode">${!displayNameString}</a>\n		</div>\n		<div class="lconn_gray">\n			<span data-dojo-attach-point="jobResponsibilityNode">${!jobResponsibility}</span>\n		</div>\n		<div class="lconn_gray">\n			<span data-dojo-attach-point="addressNode">${!address}</span>\n		</div>\n	</div>\n</div>\n');

;define("dojo/text!ic-personcard/widget/templates/PersonWidget_medium_compact.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="lconn_personContainer compact">\n	<div class="lconn_profileImage">\n		<img class="lconn_userImage" alt="" role="presentation" src="${photoUrl}" style="max-width: ${_compactSize}px; max-height: ${_compactSize}px;" data-dojo-attach-point="photoNode">\n	</div>\n	<div class="lconn_profileInfo">\n		<div>\n			<span class="lconn_title" data-dojo-attach-point="linkNode">${!displayNameString}</span>\n			<a class="lconn_title" href="${profileUrl}" style="display: none;" data-dojo-attach-point="hiddenLinkNode">${!displayNameString}</a>\n		</div>\n		<div class="lconn_gray">\n			<span data-dojo-attach-point="jobResponsibilityNode">${!jobResponsibility}</span>\n		</div>\n		<div class="lconn_gray">\n			<span data-dojo-attach-point="addressNode">${!address}</span>\n		</div>\n		<div class="lconn_additionalInfo-compact lconn_gray">\n			<div>\n				<span data-dojo-attach-point="mailNode">${!mail}</span>\n			</div>\n			<div>\n				<span data-dojo-attach-point="phoneNode">${!phone}</span>\n			</div>\n		</div>\n	</div>\n</div>\n');

;define("dojo/text!ic-personcard/widget/templates/PersonWidget_high_compact.html", '<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<div class="lconn_personContainer compact">\n	<div class="lconn_profileImage">\n		<img class="lconn_userImage" alt="" role="presentation" src="${photoUrl}" style="max-width: ${_compactSize}px; max-height: ${_compactSize}px;" data-dojo-attach-point="photoNode">\n	</div>\n	<div class="lconn_profileInfo">\n		<div>\n			<span class="lconn_title" data-dojo-attach-point="linkNode">${!displayNameString}</span>\n			<a class="lconn_title" href="${profileUrl}" style="display: none;" data-dojo-attach-point="hiddenLinkNode">${!displayNameString}</a>\n		</div>\n		<div class="lconn_gray">\n			<span data-dojo-attach-point="jobResponsibilityNode">${!jobResponsibility}</span>\n		</div>\n		<div class="lconn_gray">\n			<span data-dojo-attach-point="addressNode">${!address}</span>\n		</div>\n		<div class="lconn_additionalInfo-compact lconn_gray">\n			<div>\n				<span data-dojo-attach-point="mailNode">${!mail}</span>\n			</div>\n			<div>\n				<span data-dojo-attach-point="phoneNode">${!phone}</span>\n			</div>\n		</div>\n		<div class="lconn_separator-compact"></div>\n		<div class="lconn_tags-compact lconn_gray" data-dojo-attach-point="tagsContainer">\n			<div data-dojo-attach-point="tagCloudNode">${!tagString}</div>\n		</div>\n	</div>\n</div>\n');

;define("dojo/text!ic-personcard/widget/templates/PersonWidget_compactFocusable.html", '<!-- Copyright IBM Corp. 2015, 2016  All Rights Reserved.                    -->\n<div class="lconn_personContainer compact">\n	<div class="lconn_profileImage">\n		<img class="lconn_userImage" alt="" role="presentation" src="${photoUrl}" style="max-width: ${_compactSize}px; max-height: ${_compactSize}px;" data-dojo-attach-point="photoNode">\n	</div>\n	<div class="lconn_profileInfo">\n		<div>\n			<span class="lconn_title" style="display: none;" data-dojo-attach-point="linkNode">${!displayNameString}</span>\n			<a class="lconn_title" href="${profileUrl}" aria-describedby="${id}_metaData" data-dojo-attach-point="hiddenLinkNode" data-dojo-attach-event="onclick: linkClicked, onfocus: onEntryFocused">${!displayNameString}</a>\n		</div>\n		<div id="${id}_metaData" data-dojo-attach-point="metaDataNode">\n			<div class="lconn_gray">\n				<span data-dojo-attach-point="jobResponsibilityNode">${!jobResponsibility}</span>\n			</div>\n			<div class="lconn_gray">\n				<span data-dojo-attach-point="addressNode">${!address}</span>\n			</div>\n		</div>\n	</div>\n</div>\n');

;define("dojo/text!ic-personcard/widget/templates/PersonWidget_medium_compactFocusable.html", '<!-- Copyright IBM Corp. 2015, 2016  All Rights Reserved.                    -->\n<div class="lconn_personContainer compact">\n	<div class="lconn_profileImage">\n		<img class="lconn_userImage" alt="" role="presentation" src="${photoUrl}" style="max-width: ${_compactSize}px; max-height: ${_compactSize}px;" data-dojo-attach-point="photoNode">\n	</div>\n	<div class="lconn_profileInfo">\n		<div>\n			<span class="lconn_title" style="display: none;" data-dojo-attach-point="linkNode">${!displayNameString}</span>\n			<a class="lconn_title" href="${profileUrl}" aria-describedby="${id}_metaData" data-dojo-attach-point="hiddenLinkNode" data-dojo-attach-event="onclick: linkClicked, onfocus: onEntryFocused">${!displayNameString}</a>\n		</div>\n		<div id="${id}_metaData" data-dojo-attach-point="metaDataNode">\n			<div class="lconn_gray">\n				<span data-dojo-attach-point="jobResponsibilityNode">${!jobResponsibility}</span>\n			</div>\n			<div class="lconn_gray">\n				<span data-dojo-attach-point="addressNode">${!address}</span>\n			</div>\n			<div class="lconn_additionalInfo-compact lconn_gray">\n				<div>\n					<a href="mailto:${_escapedMail}" data-dojo-attach-point="mailNode" data-dojo-attach-event="onclick: linkClicked, onfocus: onEntryFocused">${!mail}</a>\n				</div>\n				<div>\n					<span data-dojo-attach-point="phoneNode">${!phone}</span>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n');

;define("dojo/text!ic-personcard/widget/templates/PersonWidget_high_compactFocusable.html", '<!-- Copyright IBM Corp. 2015, 2016  All Rights Reserved.                    -->\n<div class="lconn_personContainer compact">\n	<div class="lconn_profileImage">\n		<img class="lconn_userImage" alt="" role="presentation" src="${photoUrl}" style="max-width: ${_compactSize}px; max-height: ${_compactSize}px;" data-dojo-attach-point="photoNode">\n	</div>\n	<div class="lconn_profileInfo">\n		<div>\n			<span class="lconn_title" style="display: none;" data-dojo-attach-point="linkNode">${!displayNameString}</span>\n			<a class="lconn_title" href="${profileUrl}" aria-describedby="${id}_metaData" data-dojo-attach-point="hiddenLinkNode" data-dojo-attach-event="onclick: linkClicked, onfocus: onEntryFocused">${!displayNameString}</a>\n		</div>\n		<div id="${id}_metaData" data-dojo-attach-point="metaDataNode">\n			<div class="lconn_gray">\n				<span data-dojo-attach-point="jobResponsibilityNode">${!jobResponsibility}</span>\n			</div>\n			<div class="lconn_gray">\n				<span data-dojo-attach-point="addressNode">${!address}</span>\n			</div>\n			<div class="lconn_additionalInfo-compact lconn_gray">\n				<div>\n					<a href="mailto:${_escapedMail}" data-dojo-attach-point="mailNode" data-dojo-attach-event="onclick: linkClicked, onfocus: onEntryFocused">${!mail}</a>\n				</div>\n				<div>\n					<span data-dojo-attach-point="phoneNode">${!phone}</span>\n				</div>\n			</div>\n			<div class="lconn_separator-compact"></div>\n			<div class="lconn_tags-compact lconn_gray" data-dojo-attach-point="tagsContainer">\n				<div data-dojo-attach-point="tagCloudNode">${!tagString}</div>\n			</div>\n		</div>\n	</div>\n</div>\n');

;define("ic-core/globalization/bidiUtil",["dojo/_base/lang","dojo/dom","dojo/dom-class","dojo/has","dojo/on","dojo/query","dojox/string/BidiComplex","ic-core/globalization/api","ic-core/globalization/config"],function(_1,_2,_3,_4,on,_5,_6,_7,_8){
var w={};
w.LRM="\u200e";
w.RLM="\u200f";
w.LRE="\u202a";
w.RLE="\u202b";
w.PDF="\u202c";
w.enforceTextDirectionOnPage=function(_9){
if(_8.areSettingsEnabled()&&_7.isBidiEnabled()){
var _a=_7.getTextDirection();
var _b="";
var _c="";
var ch="";
var t=_9?_5(".bidiAware",_9):_5(".bidiAware");
for(var i=0;i<t.length;i++){
var _d=t[i];
if(_d.tagName=="INPUT"||_d.tagName=="TEXTAREA"||(_d.tagName=="DIV"&&_d.contentEditable=="true")){
on(_d,"keyup",_1.hitch(_d,function(){
w.inputRTLProcessing(this,_a);
}));
this.inputRTLProcessing(_d,_a);
}else{
if(_d.tagName=="DIV"||_d.tagName=="H1"||_d.tagName=="H2"||_d.tagName=="H3"||_d.tagName=="H4"||_d.tagName=="B"||_d.tagName=="P"){
_d.innerHTML=this.enforceTextDirection(_d.innerHTML,_a);
}else{
if(_d.tagName=="SELECT"){
this.enforceTextDirectionForSelect(_d,_a);
}else{
_d.dir=_d.style.direction=this.getTextDirection(_d.value||_d.text||_d.outerText||_d.innerHTML,_a);
if(_d.tagName=="A"){
_c=_d.innerHTML;
ch=_c.charAt(_c.length-1);
if((ch==w.LRM&&_d.dir==="rtl")||(ch==w.RLM&&_d.dir==="ltr")){
_d.innerHTML=_c.substr(0,_c.length-1);
}
}
}
}
}
}
t=_9?dojo.query(".url",_9):dojo.query(".url");
for(i=0;i<t.length;i++){
var _d=t[i];
if(_d.tagName=="A"){
if(_d.innerHTML.indexOf("@")==0||_d.innerHTML.indexOf("http")==0){
_d.dir="ltr";
}
}
}
var _e=_9?_5(".bidiSTT_URL",_9):_5(".bidiSTT_URL");
for(i=0;i<_e.length;i++){
if(_e[i].tagName=="INPUT"||_e[i].tagName=="TEXTAREA"){
_6.attachInput(_e[i],"URL");
}else{
_b=dojox.string.BidiComplex.createDisplayString(_e[i].innerHTML,"URL");
try{
_e[i].innerHTML=_b;
}
catch(ignore){
while(_e[i].firstChild){
_e[i].removeChild(_e[i].firstChild);
}
_e[i].appendChild(document.createTextNode(_b));
}
}
}
var _f=_9?_5(".bidiSTT_EMAIL",_9):_5(".bidiSTT_EMAIL");
for(i=0;i<_f.length;i++){
if(_f[i].tagName=="INPUT"||_f[i].tagName=="TEXTAREA"){
_6.attachInput(_f[i],"EMAIL");
}else{
_f[i].innerHTML=_6.createDisplayString(_f[i].innerHTML,"EMAIL");
}
}
var _10=_9?dojo.query(".bidiSTT_AT_USER",_9):dojo.query(".bidiSTT_AT_USER");
for(i=0;i<_10.length;i++){
if(_10[i].tagName=="INPUT"||_10[i].tagName=="TEXTAREA"){
dojox.string.BidiComplex.attachInput(_10[i],"AT_USER");
}else{
_b=dojox.string.BidiComplex.createDisplayString(_10[i].innerHTML,"AT_USER");
while(_10[i].firstChild){
_10[i].removeChild(_10[i].firstChild);
}
_10[i].appendChild(document.createTextNode(_b));
}
}
_10=_9?dojo.query(".bidiSTT_AT_USER1",_9):dojo.query(".bidiSTT_AT_USER1");
for(i=0;i<_10.length;i++){
if(_10[i].tagName=="INPUT"||_10[i].tagName=="TEXTAREA"){
dojox.string.BidiComplex.attachInput(_10[i],"AT_USER");
}else{
_10[i].innerHTML=w.enforceTextDirectionMultiLine(_10[i].innerHTML,"AT_USER");
}
}
var _11=(_e.length>0?_e[0].form:(_f.length>0?_f[0].form:null));
if(_11){
on(_11,"submit",_1.hitch(_11,function(){
w.stripSpecialCharacters(_9);
}));
}
var f=_9?_5(".bidiFileInput",_9):_5(".bidiFileInput");
for(i=0;i<f.length;i++){
var _d=f[i];
on(_d,"keydown",_1.hitch(_d,function(){
w.onFileKeyDown(this);
}));
on(_d,"change",_1.hitch(_d,function(){
w.processChange(this);
}));
on(_d,"focus",_1.hitch(_d,function(){
w.fileOnFocus(this);
}));
on(_d,"mousedown",_1.hitch(_d,function(){
w.onFileMouseDown(this);
}));
var _12=_2.byId("bidi_faked_"+_d.id);
if(_12){
on(_12,"focus",_1.hitch(_12,function(){
w.onfocus(this);
}));
on(_12,"keydown",_1.hitch(_12,function(){
w.onFakeKeyDown(event,this);
}));
on(_12,"copy",_1.hitch(_12,function(){
w.processCopy(this);
}));
on(_12,"paste",_1.hitch(_12,function(){
return false;
}));
on(_12,"cut",_1.hitch(_12,function(){
return false;
}));
}
}
}
};
w.inputRTLProcessing=function(_13,_14){
if(_8.areSettingsEnabled()&&_7.isBidiEnabled()&&_13!=null&&(_13.value!=""||_13.innerHTML!="")){
_14=this.getTextDirectionPref(_14);
if(_13.tagName=="INPUT"||_13.tagName=="TEXTAREA"||(_13.tagName=="DIV"&&_13.contentEditable=="true")&&(_13.value||_13.innerHTML)){
if(_14==_8.TEXT_DIRECTION.CONTEXTUAL){
if(this.isRTLValue(_13.value||_13.innerHTML)){
_13.dir=_13.style.direction="rtl";
}else{
_13.dir=_13.style.direction="ltr";
}
}else{
if(_14==_8.TEXT_DIRECTION.LEFT_TO_RIGHT){
_13.dir=_13.style.direction="ltr";
}else{
if(_14==_8.TEXT_DIRECTION.RIGHT_TO_LEFT){
_13.dir=_13.style.direction="rtl";
}
}
}
if(_3.contains(_13,"lotusLeft")&&_13.style.direction==="rtl"){
_13.style.textAlign="right";
}else{
if(_3.contains(_13,"lotusRight")&&_13.style.direction==="ltr"){
_13.style.textAlign="left";
}
}
}
}
};
w.enforceTextDirectionForSelect=function(_15,_16){
if(_8.areSettingsEnabled()&&_7.isBidiEnabled()){
var _17=_5("option",_15);
for(var i=0;i<_17.length;i++){
var _18=_17[i];
_18.text=this.enforceTextDirection(_18.text,_16);
}
}
};
w.enforceTextDirectionMultiLine=function(_19,_1a){
if(typeof (_19)!="string"){
return _19;
}
var _1b="\n";
if(_19.indexOf("<br>")>-1){
_1b="<br>";
}
if(_19.indexOf("<BR>")>-1){
_1b="<BR>";
}
var arr=_19.split(_1b);
var _1c="";
var str="";
for(var i=0;i<arr.length;i++){
str=arr[i];
str=this.enforceTextDirection(str);
if(typeof (_1a)=="string"){
str=dojox.string.BidiComplex.createDisplayString(str,_1a);
}
if(i>0){
_1c=_1c+_1b;
}
_1c=_1c+str;
}
return _1c;
};
w.enforceTextDirection=function(_1d,_1e){
_1e=this.getTextDirectionPref(_1e);
var _1f=this.getTextDirection(_1d,_1e);
var _20=_1d;
if(_1f=="ltr"){
_20=this.LRE+_20+this.PDF;
}else{
if(_1f=="rtl"){
_20=this.RLE+_20+this.PDF;
}
}
return _20;
};
w.getTextDirection=function(_21,_22){
_22=this.getTextDirectionPref(_22);
var _23="";
if(typeof (_21)!="undefined"&&_21!=""){
if(_22==_8.TEXT_DIRECTION.CONTEXTUAL){
if(this.isRTLValue(_21)){
_23="rtl";
}else{
_23="ltr";
}
}else{
if(_22==_8.TEXT_DIRECTION.LEFT_TO_RIGHT){
_23="ltr";
}else{
if(_22==_8.TEXT_DIRECTION.RIGHT_TO_LEFT){
_23="rtl";
}
}
}
}
return _23;
};
w.getTextDirectionPref=function(_24){
var _25="";
if(typeof (_24)!="undefined"){
_25=_24;
}else{
if(_8.areSettingsEnabled()&&_7.isBidiEnabled()){
_25=_7.getTextDirection();
}
}
return _25;
};
w.isRTLValue=function(_26){
var i;
for(i=0;i<_26.length;i++){
if(this.isBidiChar(_26.charCodeAt(i))){
return true;
}else{
if(this.isLatinChar(_26.charCodeAt(i))){
return false;
}
}
}
return false;
};
w.isBidiChar=function(c){
if(c>=1488&&c<=1535){
return true;
}else{
if(c>=1536&&c<=1631){
return true;
}else{
if(c>=1642&&c<=1775){
return true;
}else{
if(c>=1786&&c<=2047){
return true;
}else{
if(c>=64285&&c<=65023){
return true;
}else{
if(c>=65136&&c<=65276){
return true;
}else{
return false;
}
}
}
}
}
}
};
w.isLatinChar=function(c){
if((c>64&&c<91)||(c>96&&c<123)){
return true;
}else{
return false;
}
};
w.fakeOnFocus=function(obj){
this.setRelatedElements(obj);
};
w.fileOnFocus=function(obj){
this.setRelatedElements(obj);
obj.relatedElement.value=_6.createDisplayString(obj.value,"FILE_PATH");
};
w.processChange=function(obj){
obj.relatedElement.value=_6.createDisplayString(obj.value,"FILE_PATH");
obj.relatedElement.focus();
};
w.onFakeKeyDown=function(_27,obj){
this.setRelatedElements(obj);
_27=(_27)?_27:((window.event)?window.event:"");
var _28=_27.keyCode;
if(_27.altKey||_27.ctrlKey||_28==VK_SHIFT){
return true;
}else{
if(!(_28==VK_HOME||_28==VK_END||_28==VK_LEFT||_28==VK_RIGHT)){
obj.relatedElement.focus();
return false;
}else{
return true;
}
}
};
w.onFileMouseDown=function(obj){
this.setRelatedElements(obj);
obj.relatedElement.focus();
return false;
};
w.onFileKeyDown=function(obj){
this.setRelatedElements(obj);
obj.relatedElement.focus();
return false;
};
w.setRelatedElements=function(obj){
if(obj.relatedElement){
return;
}
var _29=obj.parentNode.childNodes;
var _2a;
for(var i=0;i<_29.length;i++){
if(obj.id=="bidi_faked_"+_29[i].id||_29[i].id=="bidi_faked_"+obj.id){
_2a=_29[i];
break;
}
}
obj.relatedElement=_2a;
_2a.relatedElement=obj;
};
w.processCopy=function(obj){
var _2b="";
try{
if(_4("ie")){
var w=obj.document.parentWindow;
var e=w.event;
var _2c=obj.document.selection.createRange();
_2b=_2c.text;
}else{
_2b=obj.document.getSelection();
}
var _2d=_6.stripSpecialCharacters(_2b);
if(window.clipboardData){
window.clipboardData.setData("Text",_2d);
e.returnValue=false;
}
}
catch(ex){
}
};
w.stripSpecialCharacters=function(_2e){
var _2f=_2e?_5(".bidiSTT_URL",_2e):_5(".bidiSTT_URL");
for(var i=0;i<_2f.length;i++){
if(_2f[i].tagName=="INPUT"||_2f[i].tagName=="TEXTAREA"){
_2f[i].value=_6.stripSpecialCharacters(_2f[i].value);
}
}
var _30=_2e?_5(".bidiSTT_EMAIL",_2e):_5(".bidiSTT_EMAIL");
for(var i=0;i<_30.length;i++){
if(_30[i].tagName=="INPUT"||_30[i].tagName=="TEXTAREA"){
_30[i].value=_6.stripSpecialCharacters(_30[i].value);
}
}
};
w.substituteWithSTT=function(_31,_32){
var _33=this.isBidiChar(_31.charCodeAt(0));
var i;
if(_33){
for(i=0;i<_32.length;i++){
_32[i]=this.RLM+dojox.string.BidiComplex.createDisplayString(_32[i],"FILE_PATH")+this.RLM;
}
}
var _34=dojo.string.substitute(_31,_32);
if(_33){
_34=this.RLE+_34+this.PDF;
}
return _34;
};
return w;
});


;define("ic-core/widgetUtils",["dojo","dojo/_base/lang","dojo/dom","dojo/dom-construct","dojo/json","ic-core/config","ic-core/errorhandling","ic-core/url","ic-core/utilities"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
var _b={};
_b.handleRefresh=function(_c,_d){
var _e=_d.widgetId,_f=_2.getObject("refreshInfoHolder");
if(_f&&_f[_e]){
_c=_8.rewrite(_c,{preventCache:new Date().getTime()});
}
return _c;
};
_b.addVersionNumber=function(url){
var _10=_6.versionStamp;
if(_10){
url=_8.rewrite(url,{etag:_10});
}
return url;
};
_b.search=function(_11,_12,_13,_14){
try{
var _15=_11.getiWidgetAttributes();
var _16=_11.widgetId+"_TabItem";
var _17=_3.byId(_16);
var _18=_15.getItemValue("searchKeywords");
var _19=_15.getItemValue("tagCloudItemValue");
var _1a=_15.getItemValue("resourceId");
var _1b=_11.getUserProfile().getItemValue("userid");
var _1c=_3.byId("search_searchResults_filterInfo");
_b.searchC(_12,_13,_18,_19,_1a,_1b,_2.hitch(_11.io,_11.io.rewriteURI),_14,_1c,_17);
}
catch(exception){
console.log("exception occurred during widgetUtils.search()");
console.log(exception);
_7.DefaultErrorHandler("widgetUtils.search",exception,{htmlContainerElemId:_13});
}
};
return _b;
});


;define("dojo/i18n!ic-personcard/widget/nls/strings", {"EXCEEDED_ONE_TAG":"Plus 1 more tag...","EXCEEDED_TAGS":"Plus ${count} more tags...","TAGS_L":"Tags:","TAGS":"TAGS"});

;define("ic-personcard/widget/Localization",["dojo/_base/declare","dojo/_base/lang","dojo/i18n","dojo/i18n!ic-personcard/widget/nls/strings","dojo/string"],function(_1,_2,_3,_4,_5){
var _6=_1("com.ibm.social.personcard.widget.Localization",null,{commonStrings:null,postMixInProperties:function(){
this.commonStrings=_4;
_2.mixin(this,this.commonStrings);
this.inherited(arguments);
},getString:function(_7,_8){
return _5.substitute(this.commonStrings[_7],_8);
}});
return _6;
});


;define("ic-personcard/widget/PersonWidget",["dojo/_base/declare","dojo/dom-class","dojo/has","dojo/text!./templates/PersonWidget.html","dojo/text!./templates/PersonWidget_medium.html","dojo/text!./templates/PersonWidget_high.html","dojo/text!./templates/PersonWidget_compact.html","dojo/text!./templates/PersonWidget_medium_compact.html","dojo/text!./templates/PersonWidget_high_compact.html","dojo/text!./templates/PersonWidget_compactFocusable.html","dojo/text!./templates/PersonWidget_medium_compactFocusable.html","dojo/text!./templates/PersonWidget_high_compactFocusable.html","dojo/topic","dijit/_Templated","dijit/_Widget","ic-core/globalization/bidiUtil","ic-core/url","ic-core/widgetUtils","ic-personcard/widget/Localization","ic-ui/layout/people"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,url,_11,_12,_13){
var _14=_1("com.ibm.social.personcard.widget.PersonWidget",[_f,_e,_12],{templateString:_4,medium_templatePath:_5,high_templatePath:_6,compact_templatePath:_7,mediumCompact_templatePath:_8,highCompact_templatePath:_9,compactFocusable_templatePath:_a,mediumCompactFocusable_templatePath:_b,highCompactFocusable_templatePath:_c,HIGH_CONFIDENCE:"high",MEDIUM_CONFIDENCE:"medium",LOW_CONFIDENCE:"low",profileUrl:"",photoUrl:"",userId:"",displayNameString:"",displayNameEscaped:"",preferredName:"",givenNames:null,jobResponsibility:"",mail:"",_escapedMail:"",address:"",phone:"",tags:null,tagString:"",_exceededTagsCount:-1,exceedingTagString:"",maxTags:20,compact:false,maxTagsInCompact:3,confidence:"",isFocusable:false,_compactSize:40,_normalSize:60,_bigSize:128,constructor:function(_15){
this._setValues(_15);
this._chooseTemplate();
},postCreate:function(){
this.connect(this.linkNode,"onfocus","_nameFocused");
if(!this.compact){
if(this.confidence==this.LOW_CONFIDENCE||this.confidence==this.MEDIUM_CONFIDENCE){
if(this.mail.match(/(<b>|<\/b>)/ig)||this.phone.match(/(<b>|<\/b>)/ig)){
_2.remove(this.additionalInfo,"lotusHidden");
}
if(this.tags){
_2.remove(this.tagsContainer,"lotusHidden");
}
}
if(this.mailNode&&!this.mail){
_2.add(this.mailNode,"lotusHidden");
}
}
if(this.tagsContainer){
var _16=[];
if(_3("ie")<=8){
_16=this.tagsContainer.querySelectorAll(".tag");
}else{
_16=this.tagsContainer.getElementsByClassName("tag");
}
for(var i=0;i<_16.length;i++){
this.connect(_16[i],"onclick","_tagClicked");
}
}
if(this._exceededTagsCount>0&&this.exceededMessage){
this.exceededMessage.innerHTML=this._exceededTagsCount>1?this.getString("EXCEEDED_TAGS",{count:this._exceededTagsCount}):this.getString("EXCEEDED_ONE_TAG");
_2.remove(this.exceededMessage,"lotusHidden");
_2.add(this.exceededMessage,"exceededMessage");
}
this.inherited(arguments);
},_setValues:function(_17){
if(_17.maxTags){
this.maxTags=_17.maxTags;
}
if(_17.maxTagsInCompact){
this.maxTagsInCompact=_17.maxTagsInCompact;
}
this.isFocusable=_17.isFocusable?true:false;
this.compact=_17.compact?true:false;
this.userId=_17.userId?_17.userId:"NULL";
this.preferredName=_17.preferredName?_17.preferredName:"";
this.givenNames=_17.givenNames?_17.givenNames:null;
this.displayNameString=_17.displayName?_17.displayName:"";
if(!this.preferredName&&this.givenNames){
for(var i=0;i<this.givenNames.length&&!this.preferredName;i++){
var gn=this.givenNames[i].match(/<b>\w*<\/b>/i);
if(!gn){
continue;
}
var reg=new RegExp(gn[0],"i");
if(!this.displayNameString.match(reg)){
this.preferredName=this.givenNames[i];
}
}
}
if(this.preferredName){
this.displayNameString+=" ("+this.preferredName+")\u200e";
}
this.displayNameEscaped=this.displayNameString.replace(/(<b>|<\/b>)/ig,"");
this.jobResponsibility=_17.jobResponsibility?_17.jobResponsibility:"";
this.mail=_17.mail?_17.mail:"";
this._escapedMail=this.mail.replace(/(<b>|<\/b>)/ig,"");
this.address=_17.address?_17.address:"";
this.phone=_17.phone?_17.phone:"";
this.tags=_17.tags?_17.tags:null;
this.confidence=_17.confidence;
if(!this.compact&&_17.tags){
var t=_17.tags;
for(var i=0;i<t.length;i++){
t[i]=_10.enforceTextDirection(t[i],document.dir);
}
var _18=t.slice(0,this.maxTags);
var _19=t.slice(this.maxTags);
this._exceededTagsCount=_19.length;
this.tagString="<a href='javascript:;' class='tag'>"+_18.join("</a>, <a href='javascript:;' class='tag'>")+"</a>";
if(this._exceededTagsCount>0){
this.exceedingTagString="<a href='javascript:;' class='tag'>"+_19.join("</a>, <a href='javascript:;' class='tag'>")+"</a>";
}
}else{
if(_17.tags){
var t=_17.tags;
for(var i=0;i<t.length;i++){
t[i]=_10.enforceTextDirection(t[i],document.dir);
}
var _18=t.slice(0,this.maxTagsInCompact);
this.tagString="<span class='tag'>"+_18.join("</span>, <span class='tag'>")+"</span>"+(_17.tags.length>this.maxTagsInCompact?"...":"");
}
}
},_chooseTemplate:function(){
this.profileUrl=_13.getProfileUrl({userid:this.userId});
if(this.compact){
this.photoUrl=_11.addVersionNumber(_13.getImageUrl({userid:this.userId},this._compactSize));
this.templateString=this.isFocusable?this.compactFocusable_templatePath:this.compact_templatePath;
if(((this.mail&&(this.confidence==this.MEDIUM_CONFIDENCE||this.confidence==this.HIGH_CONFIDENCE))||this.phone)&&!this.tags){
this.templateString=this.isFocusable?this.mediumCompactFocusable_templatePath:this.mediumCompact_templatePath;
}
if(this.tags){
this.templateString=this.isFocusable?this.highCompactFocusable_templatePath:this.highCompact_templatePath;
}
}else{
var _1a=this.confidence==this.LOW_CONFIDENCE?this._normalSize:this._bigSize;
if(this.confidence==this.MEDIUM_CONFIDENCE){
this.templateString=this.medium_templatePath;
}else{
if(this.confidence==this.HIGH_CONFIDENCE){
this.templateString=this.high_templatePath;
}
}
this.photoUrl=_11.addVersionNumber(_13.getImageUrl({userid:this.userId},_1a));
}
},showExceedingTags:function(evt){
if(evt){
evt.preventDefault(),evt.stopPropagation();
}
_2.add(this.exceededMessage,"lotusHidden");
_2.remove(this.exceededMessage,"exceededMessage");
_2.remove(this.exceededTags,"lotusHidden");
},_tagClicked:function(evt){
if(evt){
evt.preventDefault(),evt.stopPropagation();
}
var _1b=evt.target;
if(!_2.contains(_1b,"tag")){
_1b=_1b.parentElement;
}
this.onTagClicked(_1b.innerHTML.replace(/(<b>|<\/b>)/ig,""));
},_nameFocused:function(evt){
if(evt){
evt.preventDefault(),evt.stopPropagation();
}
this.onNameFocused(this.domNode);
},_mailClicked:function(evt){
if(evt){
if(_3("ie")<=8){
evt.cancelBubble();
}else{
evt.stopPropagation();
}
}
},personClick:function(){
if(this.compact){
this.hiddenLinkNode.click();
}else{
this.linkNode.click();
}
},linkClicked:function(evt){
if(evt){
evt.stopPropagation();
}
},onTagClicked:function(tag){
},onNameFocused:function(_1c){
},onEntryFocused:function(evt){
}});
return _14;
});


;define("ic-core/typeahead/DataReader",["dojo","dojo/Deferred","dojo/_base/declare","dojo/_base/lang","dijit/_Widget","../auth","../url","../config/services"],function(_1,_2,_3,_4,_5,_6,_7,_8){
var _9=_3("lconn.core.typeahead.DataReader",_5,{lastQuery:null,pageSize:4,highlight:true,canSendEmptyQueries:false,basicAuthentication:"/fba",anonymousAuthentication:"/anonymous",path:"",resultsId:"",_xhr:null,_promise:null,timeout:0,startup:function(){
this.inherited(arguments);
var _a=_7.getServiceUrl(_8.search);
var _b=(_6.isAuthenticated()?this.basicAuthentication:this.anonymousAuthentication);
this._initLastQuery(_a+_b);
},_initLastQuery:function(_c){
this.lastQuery={url:_c+this.path,query:"",pageSize:this.pageSize,page:1};
},resetLastQuery:function(){
this.lastQuery.query="";
this.lastQuery.page=1;
},executeQuery:function(_d){
this.abortLastRequest();
this._promise=new _2();
if(_d){
this.lastQuery.query=_d;
}else{
if(!this.lastQuery.query&&!this.canSendEmptyQueries){
setTimeout(_4.hitch(this,function(){
this._promise.cancel();
}),1);
return this._promise.promise;
}
}
var _e={url:this._constructLastQueryString(),content:"",handleAs:"json",load:_4.hitch(this,"_querySuccess"),error:_4.hitch(this,"_queryError"),failOk:true};
if(this.timeout>0){
_e.timeout=this.timeout;
}
this._xhr=_1.xhrGet(_e);
return this._promise.promise;
},getNextPage:function(){
this.lastQuery.page++;
return this.executeQuery(null);
},_constructLastQueryString:function(){
return _7.rewrite(this.lastQuery.url,{query:(this.lastQuery.query?this.lastQuery.query:undefined),pageSize:this.lastQuery.pageSize,page:(this.lastQuery.page>1?this.lastQuery.page:undefined),highlight:this.highlight});
},_querySuccess:function(_f,_10){
if(_10.xhr.status==200){
if(this._promise&&(!this._promise.isResolved()||!this._promise.isCanceled())){
var _11={data:_f[this.resultsId],totalResults:_f.totalResults,pageSize:this.pageSize};
this._promise.resolve(_11);
}
}else{
this._queryError(null,{status:_10.xhr.status});
}
},_queryError:function(_12){
if(_12&&_12.dojoType=="cancel"){
if(_1.config.isDebug){
console.debug(_12);
}
}
if(this._promise){
this._promise.reject(_12);
}
},abortLastRequest:function(){
if(this._xhr){
this._xhr.cancel();
}else{
if(this._promise){
this._promise.cancel();
}
}
},setPageSize:function(_13){
this.lastQuery.pageSize=_13>0?_13:this.pageSize;
}});
return _9;
});


;define("ic-core/peopleFinder/DataReader",["dojo/_base/declare","../url","../typeahead/DataReader"],function(_1,_2,_3){
var _3=_1("lconn.core.peopleFinder.DataReader",_3,{additionalFields:{low:["city","country"],high:["workPhone","tag"]},searchOnlyNameAndEmail:false,mustMatchNameOrEmail:false,disablePhonetics:false,path:"/people/typeahead",resultsId:"persons",_initLastQuery:function(_4){
this.inherited(arguments);
this.lastQuery.additionalFields=JSON.stringify(this.additionalFields);
},executeQuery:function(_5,_6,_7){
var _8=this.inherited(arguments);
_8.then(_6);
_8.otherwise(_7);
},getNextPage:function(_9,_a){
this.lastQuery.page++;
this.executeQuery(null,_9,_a);
},_constructLastQueryString:function(){
return _2.rewrite(this.lastQuery.url,{query:(this.lastQuery.query?this.lastQuery.query:undefined),pageSize:this.lastQuery.pageSize,page:(this.lastQuery.page>1?this.lastQuery.page:undefined),additionalFields:this.lastQuery.additionalFields,source:"ic_searchbox_dropdown",highlight:this.highlight,searchOnlyNameAndEmail:this.searchOnlyNameAndEmail,mustMatchNameOrEmail:this.mustMatchNameOrEmail,disablePhonetics:this.disablePhonetics});
}});
return _3;
});


;define("ic-core/typeahead/Service",["dojo/Deferred","dojo/_base/declare","dojo/_base/lang","dijit/_Widget","../auth","./DataReader"],function(_1,_2,_3,_4,_5,_6){
var _7=_2("lconn.core.typeahead.Service",_4,{header:null,footer:null,isLoginNeeded:false,isDisabled:false,minToDisplay:-1,lengthToIgnoreMin:-1,isFocusable:false,useAriaNodes:true,_dataReader:null,_createdWidgets:null,postCreate:function(){
this._dataReader=new _6();
this._dataReader.startup();
},startup:function(){
this._createdWidgets=[];
},destroy:function(){
this._cleanAll();
},_cleanAll:function(){
if(this._createdWidgets){
for(var i=0;i<this._createdWidgets.length;i++){
this._createdWidgets[i].destroyRecursive();
}
}
if(this.header&&this.header.parentNode){
this.header.parentNode.removeChild(this.header);
}
if(this.footer&&this.footer.parentNode){
this.footer.parentNode.removeChild(this.footer);
}
this._createdWidgets=[];
},executeQuery:function(_8){
var _9=new _1();
if(this._checkBeforeQueryExec(_9)){
var _a=this._dataReader.executeQuery(_8);
_a.then(_3.hitch(this,"_handleResults",_9,_8));
_a.otherwise(_3.hitch(this,"_handleError",_9));
}
return _9.promise;
},getNextPage:function(){
var _b=new _1();
if(this._checkBeforeQueryExec(_b)){
var _c=this._dataReader.getNextPage();
_c.then(_3.hitch(this,"_handleResults",_b,this._dataReader.lastQuery.query));
_c.otherwise(_3.hitch(this,"_handleError",_b));
}
return _b.promise;
},_checkBeforeQueryExec:function(_d){
var _e=true;
if(this.isDisabled){
this._handleDisabled(_d);
_e=false;
}else{
if(this.isLoginNeeded&&!_5.isAuthenticated()){
this._handleLogin(_d);
_e=false;
}
}
return _e;
},_handleResults:function(_f,_10,_11){
this._cleanAll();
var _12={header:this.header,footer:this.footer,aria:this.useAriaNodes?this.initAriaNodes():[],results:this.initResults(_11.data),totalResults:_11.totalResults,pageSize:_11.pageSize};
if(this.minToDisplay>=0&&(_10.length<=this.lengthToIgnoreMin||this.lengthToIgnoreMin<0)){
_12.minToDisplay=this.minToDisplay;
}else{
if(this.minToDisplay<0){
_12.minToDisplay=_12.totalResults;
}
}
_f.resolve(_12);
},_handleError:function(_13,_14){
if(_14&&_14.dojoType=="cancel"){
_13.cancel(_14);
}else{
this._cleanAll();
_13.resolve({});
}
},_handleLogin:function(_15){
_15.resolve({showLogin:true});
},_handleDisabled:function(_16){
this._cleanAll();
_16.resolve({serviceDisabled:true});
},initResults:function(_17){
return {};
},initAriaNodes:function(){
return [];
},setTimeout:function(_18){
this._dataReader.timeout=_18;
},setPageSize:function(_19){
this._dataReader.setPageSize(_19);
},focusCallback:function(_1a){
}});
return _7;
});


;define("ic-core/peopleFinder/directory/PeopleFinderService",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/i18n","dojo/i18n!./nls/PeopleFinderService","ic-personcard/widget/PersonWidget","../../auth","../../url","../../config/services","../DataReader","../../typeahead/Service"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
var _d=_2("lconn.core.peopleFinder.directory.PeopleFinderService",_c,{additionalFields:null,resultsNumber:4,highlight:true,searchOnlyNameAndEmail:false,mustMatchNameOrEmail:false,escapeLowConfidence:true,minToDisplay:1,lengthToIgnoreMin:3,postMixInProperties:function(){
this.inherited(arguments);
this.strings=_6;
_3.mixin(this,this.strings);
},postCreate:function(){
if(!this.isDisabled){
this.isDisabled=(_8.getUser()&&_8.getUser().isExternal);
}
this._dataReader=new _b({pageSize:this.resultsNumber,highlight:this.highlight,searchOnlyNameAndEmail:this.searchOnlyNameAndEmail,mustMatchNameOrEmail:this.mustMatchNameOrEmail});
if(this.additionalFields){
_3.mixin(this._dataReader.additionalFields,this.additionalFields);
}
this._dataReader.startup();
this.header=document.createElement("div");
_4.add(this.header,"pfTitle");
this.header.innerHTML=this.DIRECTORY_RESULTS;
this.footer=document.createElement("div");
this.footer.setAttribute("aria-describedby",this.id+"_moreDirectoryAria");
_1.addClass(this.footer,"pfDirectoryLink");
var _e=document.createElement("span");
_1.addClass(_e,"pfLinkNode");
_e.innerHTML=this.MORE_DIRECTORY_RESULTS;
this.footer.appendChild(_e);
this.connect(this.footer,"onclick","redirectToDirectory");
},executeQuery:function(_f){
var _10=new _1.Deferred();
if(this.isDisabled){
this._handleDisabled(_10);
}else{
if(this.isLoginNeeded&&!_8.isAuthenticated()){
this._handleLogin(_10);
}else{
this._dataReader.executeQuery(_f,_3.hitch(this,"_handleResults",_10,_f),_3.hitch(this,"_handleError",_10));
}
}
return _10.promise;
},initResults:function(_11){
var _12={high:[],medium:[],low:[]};
for(var i=0;i<_11.length;i++){
if(this.escapeLowConfidence&&_11[i].confidence=="low"){
continue;
}
var _13=new _7({userId:(_11[i].id?_11[i].id:""),displayName:(_11[i].name?_11[i].name:""),preferredName:(_11[i].preferredFirstName?_11[i].preferredFirstName:""),givenNames:(_11[i].givenNames?_11[i].givenNames:null),jobResponsibility:(_11[i].jobResponsibility?_11[i].jobResponsibility:""),mail:(_11[i].email?_11[i].email:""),address:(_11[i].city?_11[i].city:"")+(_11[i].city&&_11[i].country?", ":"")+(_11[i].country?_11[i].country:""),phone:(_11[i].workPhone?_11[i].workPhone:""),tags:(_11[i].confidence&&_11[i].confidence=="high"?_11[i].tag:null),compact:true,confidence:_11[i].confidence?_11[i].confidence:"low",isFocusable:this.isFocusable});
_13.startup();
this._createdWidgets.push(_13);
if(this.useAriaNodes){
_13.domNode.setAttribute("aria-describedby",this.id+"_entryAria");
}
_13.connect(_13.domNode,"onclick",_3.hitch(this,"entrySelected",_13));
_13.connect(_13,"linkClicked",_3.hitch(this,"entryClicked",_13));
if(this.isFocusable){
_13.connect(_13,"onEntryFocused",_3.hitch(this,"focusCallback",_13.domNode));
}
_12[_13.confidence].push(_13.domNode);
}
return _12;
},initAriaNodes:function(){
var _14=document.createElement("div");
_4.add(_14,"lotusHidden");
_14.innerHTML=this.ENTRY_ARIA_LABEL;
_14.id=this.id+"_entryAria";
var _15=document.createElement("div");
_4.add(_15,"lotusHidden");
_15.innerHTML=this.MORE_DIRECTORY_ARIA_LABEL;
_15.id=this.id+"_moreDirectoryAria";
return [_14,_15];
},entrySelected:function(_16,evt){
_16.personClick();
},entryClicked:function(_17,evt){
},redirectToDirectory:function(){
var url=this.getDirectoryLink();
url+="#q="+encodeURIComponent(this._dataReader.lastQuery.query);
window.location=url;
},getDirectoryLink:function(){
var url=_9.getServiceUrl(_a.profiles)||_9.getServiceUrl(_a.scprofiles).toString().replace(/\/contacts/,"");
url+="/html/searchProfiles.do";
return url;
}});
return _d;
});


;define("dojo/i18n!ic-core/quickResults/nls/QuickResultsService", {"QUICK_RESULTS":"RECENT","ENTRY_ARIA_LABEL":"Selecting this option will bring you to the selected recent page"});

;define("ic-core/quickResults/DataReader",["dojo/_base/declare","../url","../typeahead/DataReader"],function(_1,_2,_3){
var _3=_1("lconn.core.quickResults.DataReader",_3,{disableSpellingCorrection:false,path:"/quickresults/typeahead",resultsId:"pages",_constructLastQueryString:function(){
return _2.rewrite(this.lastQuery.url,{query:(this.lastQuery.query?this.lastQuery.query:undefined),pageSize:this.lastQuery.pageSize,page:(this.lastQuery.page>1?this.lastQuery.page:undefined),highlight:this.highlight,disableSpellingCorrection:this.disableSpellingCorrection});
}});
return _3;
});


;define("dojo/i18n!ic-core/quickResults/nls/GenericEntry", {"BOOKMARK_VIEWED_HOURS_AGO":"Bookmark viewed ${hours} hours ago","FILE_VIEWED_TODAY":"File viewed today","BLOG_VIEWED_SECONDS_AGO":"Blog viewed ${seconds} seconds ago","EVENT_VIEWED_YESTERDAY":"Event viewed yesterday","PROFILE_VIEWED_1_SECOND_AGO":"Profile viewed 1 second ago","PROFILE_VIEWED_HOURS_AGO":"Profile viewed ${hours} hours ago","ACTIVITY_VIEWED_YESTERDAY":"Activity viewed yesterday","TODO_VIEWED_AT_DATE":"To Do viewed ${date}","BLOG_VIEWED_1_HOUR_AGO":"Blog viewed 1 hour ago","BLOG_VIEWED_HOURS_AGO":"Blog viewed ${hours} hours ago","PROFILE_VIEWED_TODAY":"Profile viewed today","FILE_VIEWED_AT_DATE":"File viewed ${date}","EVENT_VIEWED_1_MINUTE_AGO":"Event viewed 1 minute ago","FILE_VIEWED_1_MINUTE_AGO":"File viewed 1 minute ago","PROFILE_VIEWED_MINUTES_AGO":"Profile viewed ${minutes} minutes ago","BOOKMARK_VIEWED_AT_DATE":"Bookmark viewed ${date}","FORUM_VIEWED_1_MINUTE_AGO":"Forum viewed 1 minute ago","ACTIVITY_VIEWED_AT_DATE":"Activity viewed ${date}","EVENT_VIEWED_SECONDS_AGO":"Event viewed ${seconds} seconds ago","COMMUNITY_VIEWED_AT_DATE":"Community viewed ${date}","ACTIVITY_VIEWED_1_MINUTE_AGO":"Activity viewed 1 minute ago","BLOG_VIEWED_AT_DATE":"Blog viewed ${date}","WIKI_VIEWED_SECONDS_AGO":"Wiki viewed ${seconds} seconds ago","BOOKMARK_VIEWED_1_SECOND_AGO":"Bookmark viewed 1 second ago","PROFILE_VIEWED_1_HOUR_AGO":"Profile viewed 1 hour ago","EVENT_VIEWED_HOURS_AGO":"Event viewed ${hours} hours ago","ACTIVITY_VIEWED_1_HOUR_AGO":"Activity viewed 1 hour ago","TODO_VIEWED_MINUTES_AGO":"To Do viewed ${minutes} minutes ago","FILE_VIEWED_YESTERDAY":"File viewed yesterday","BLOG_VIEWED_1_MINUTE_AGO":"Blog viewed 1 minute ago","FORUM_VIEWED_SECONDS_AGO":"Forum viewed ${seconds} seconds ago","ACTIVITY_VIEWED_HOURS_AGO":"Activity viewed ${hours} hours ago","TODO_VIEWED_1_SECOND_AGO":"To Do viewed 1 second ago","COMMUNITY_VIEWED_1_SECOND_AGO":"Community viewed 1 second ago","FILE_VIEWED_MINUTES_AGO":"File viewed ${minutes} minutes ago","WIKI_VIEWED_TODAY":"Wiki viewed today","ACTIVITY_VIEWED_TODAY":"Activity viewed today","BOOKMARK_VIEWED_MINUTES_AGO":"Bookmark viewed ${minutes} minutes ago","WIKI_VIEWED_1_MINUTE_AGO":"Wiki viewed 1 minute ago","EVENT_VIEWED_AT_DATE":"Event viewed ${date}","FORUM_VIEWED_YESTERDAY":"Forum viewed yesterday","BLOG_VIEWED_MINUTES_AGO":"Blog viewed ${minutes} minutes ago","WIKI_VIEWED_AT_DATE":"Wiki viewed ${date}","FILE_VIEWED_1_HOUR_AGO":"File viewed 1 hour ago","PROFILE_VIEWED_AT_DATE":"Profile viewed ${date}","UPDATED_BY":"Updated by ${author}","ACTIVITY_VIEWED_SECONDS_AGO":"Activity viewed ${seconds} seconds ago","TODO_VIEWED_TODAY":"To Do viewed today","COMMUNITY_VIEWED_1_HOUR_AGO":"Community viewed 1 hour ago","FILE_VIEWED_HOURS_AGO":"File viewed ${hours} hours ago","EVENT_VIEWED_1_SECOND_AGO":"Event viewed 1 second ago","COMMUNITY_VIEWED_SECONDS_AGO":"Community viewed ${seconds} seconds ago","FILE_VIEWED_1_SECOND_AGO":"File viewed 1 second ago","FORUM_VIEWED_1_SECOND_AGO":"Forum viewed 1 second ago","BOOKMARK_VIEWED_TODAY":"Bookmark viewed today","EVENT_VIEWED_MINUTES_AGO":"Event viewed ${minutes} minutes ago","WIKI_VIEWED_YESTERDAY":"Wiki viewed yesterday","ACTIVITY_VIEWED_1_SECOND_AGO":"Activity viewed 1 second ago","FORUM_VIEWED_HOURS_AGO":"Forum viewed ${hours} hours ago","COMMUNITY_VIEWED_YESTERDAY":"Community viewed yesterday","WIKI_VIEWED_MINUTES_AGO":"Wiki viewed ${minutes} minutes ago","BLOG_VIEWED_TODAY":"Blog viewed today","FORUM_VIEWED_TODAY":"Forum viewed today","WIKI_VIEWED_1_HOUR_AGO":"Wiki viewed 1 hour ago","BLOG_VIEWED_1_SECOND_AGO":"Blog viewed 1 second ago","FORUM_VIEWED_MINUTES_AGO":"Forum viewed ${minutes} minutes ago","BOOKMARK_VIEWED_1_HOUR_AGO":"Bookmark viewed 1 hour ago","PROFILE_VIEWED_1_MINUTE_AGO":"Profile viewed 1 minute ago","WIKI_VIEWED_1_SECOND_AGO":"Wiki viewed 1 second ago","FORUM_VIEWED_1_HOUR_AGO":"Forum viewed 1 hour ago","TODO_VIEWED_1_HOUR_AGO":"To Do viewed 1 hour ago","TODO_VIEWED_YESTERDAY":"To Do viewed yesterday","PROFILE_VIEWED_SECONDS_AGO":"Profile viewed ${seconds} seconds ago","EVENT_VIEWED_TODAY":"Event viewed today","WIKI_VIEWED_HOURS_AGO":"Wiki viewed ${hours} hours ago","BOOKMARK_VIEWED_YESTERDAY":"Bookmark viewed yesterday","COMMUNITY_VIEWED_HOURS_AGO":"Community viewed ${hours} hours ago","COMMUNITY_VIEWED_TODAY":"Community viewed today","PROFILE_VIEWED_YESTERDAY":"Profile viewed yesterday","ACTIVITY_VIEWED_MINUTES_AGO":"Activity viewed ${minutes} minutes ago","BOOKMARK_VIEWED_1_MINUTE_AGO":"Bookmark viewed 1 minute ago","COMMUNITY_VIEWED_MINUTES_AGO":"Community viewed ${minutes} minutes ago","BLOG_VIEWED_YESTERDAY":"Blog viewed yesterday","TODO_VIEWED_SECONDS_AGO":"To Do viewed ${seconds} seconds ago","TODO_VIEWED_1_MINUTE_AGO":"To Do viewed 1 minute ago","PREVIEW_MODE_ONLY":"(Preview Mode Only)","COMMUNITY_VIEWED_1_MINUTE_AGO":"Community viewed 1 minute ago","FILE_VIEWED_SECONDS_AGO":"File viewed ${seconds} seconds ago","EVENT_VIEWED_1_HOUR_AGO":"Event viewed 1 hour ago","BOOKMARK_VIEWED_SECONDS_AGO":"Bookmark viewed ${seconds} seconds ago","TODO_VIEWED_HOURS_AGO":"To Do viewed ${hours} hours ago","FORUM_VIEWED_AT_DATE":"Forum viewed ${date}"});

;define("dojo/text!ic-core/quickResults/templates/GenericEntry.html", '<!-- Copyright IBM Corp. 2014, 2016  All Rights Reserved.              -->\n\n<div class="lconn_personContainer compact">\n	<div class="lconn_profileImage">\n		<img class="${_additionalClass}" data-dojo-attach-point="photoNode" alt="" role="presentation" src="${photoUrl}" style="max-width: 40px; max-height: 40px;">\n	</div>\n	<div class="lconn_profileInfo">\n		<div>\n			<span class="lconn_title" data-dojo-attach-point="linkNode">${!entryTitle}</span>\n			<a class="lconn_title" data-dojo-attach-point="hiddenLinkNode" data-dojo-attach-event="onclick: linkClicked" href="${resourceUrl}" style="display: none;">${!entryTitle}</a>\n		</div>\n		<div id="${id}_metaData" data-dojo-attach-point="metaDataNode">\n			<div class="lconn_gray">\n				<span data-dojo-attach-point="detailsNode">${details}</span>\n			</div>\n			<div class="lconn_gray">\n				<span data-dojo-attach-point="authorNode">${_authorString}</span>\n				<span class="lotusHidden" data-dojo-attach-point="_separator"> | </span>\n				<span class="lotusHidden" data-dojo-attach-point="dateNode">${_dateString}</span>\n				<span class="lotusHidden" data-dojo-attach-point="previewOnlyNode">${PREVIEW_MODE_ONLY}</span>\n			</div>\n		</div>\n	</div>\n</div>\n');

;define("ic-core/Res",["dojo","dojo/_base/declare","dojo/string"],function(_1,_2,_3){
var _4=_1.i18n;
var _5=_2("lconn.core.Res",[],{bundleFor:"ic-core",resBundle:null,loadDefaultBundle:function(){
this.resBundle=_4.getLocalization(this.bundleFor,"strings");
},loadBundle:function(_6){
this.resBundle=_4.getLocalization(_6,"strings");
},getDefaultBundle:function(){
return _4.getLocalization(this.bundleFor,"strings");
},getBundle:function(_7){
return _4.getLocalization(_7,"strings");
},getStringFrom:function(_8,_9,_a){
var _b=_4.getLocalization(_8,"strings")[_9];
if(_a==undefined){
return _b;
}else{
return _3.substitute(_b,_a);
}
},getString:function(_c,_d){
var _e=_4.getLocalization(this.bundleFor,"strings")[_c];
if(_d==undefined){
return _e;
}else{
return _3.substitute(_e,_d);
}
}});
return _5;
});


;define("ic-core/locale",["dojo/_base/kernel"],function(_1){
function _2(_3,_4){
return _3.getLocale().split("-")[_4]||"";
};
return {getLocale:function(){
return _1.locale;
},getLanguage:function(){
return _2(this,0);
},getCountry:function(){
return _2(this,1);
},getVariant:function(){
return _2(this,2);
},toJavaLocale:function(){
var _5,_6=this.getLanguage(),_7=this.getCountry();
if(_6==="pt"&&!_7){
_7="pt";
}else{
if(_6==="he"){
_6="iw";
}else{
if(_6==="nb"){
_6="no";
}else{
if(_6==="id"){
_6="in";
}
}
}
}
_5=_6;
if(_7){
_5+="_"+_7.toUpperCase();
}
return _5;
}};
});


;define("ic-core/DateUtil",["dojo","dojo/_base/kernel","dojo/date/locale","dojo/i18n","dojo/i18n!dojo/cldr/nls/gregorian","dojo/i18n!ic-core/nls/strings","dojo/string","ic-core/Res","ic-core/globalization/BidiDateUtil","ic-core/locale"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
var w={},_b=_9;
w.MILLS_IN_DAY=86400000;
w.inited=null;
w.Today="Error: not inited";
w.Yesterday="Error: not inited";
w.Tomorrow="Error: not inited";
w.initResStrings=function(){
var _c=new _8();
_c.loadDefaultBundle();
var b=_c.resBundle;
this.Today=b.rs_today;
this.Yesterday=b.rs_yesterday;
this.Tomorrow=b.rs_tomorrow;
this.At=b.rs_at;
this.inited=true;
};
w.delta=function(_d,_e){
var _f=_d.getTime()-_e;
var _10=Math.ceil(_f/(this.MILLS_IN_DAY));
return _10;
};
w.toString=function(_11,_12){
var _13;
if(!_11||!(_13=Date.parse(_11))){
console.log("Invalid date passed to DateUtil.toString(): "+_11);
return;
}
var _14="";
_14=this.toStringForTimeinMs(_13,_12);
return _14;
};
w.toStringForTimeinMs=function(_15,_16,_17){
if(this.Days==null){
this.Days=_5["days-format-wide"];
}
if(this.Month==null){
this.Month=_5["months-format-abbr"];
}
if(!_b.isGregorian()){
this.Month=_b.getDateComponent("months","abbr");
}
if(this.inited==null){
this.initResStrings();
}
var _18=new Date();
_18.setHours(0,0,0,0);
var _19=new Date();
_19.setTime(_15);
var _1a=this.delta(_18,_15);
var _1b="";
if(!_b.isGregorian()){
_19=_b.fromGregorian(_19);
_18=_b.fromGregorian(_18);
}
if(_1a<=2&&_1a>=-2){
if(_1a==2){
if(!_16){
_1b=this.Days[_19.getDay()]+" "+this.At+" "+this.getLocalizedTime(_19);
}else{
_1b=this.Days[_19.getDay()];
}
}else{
if(_1a==1){
if(!_16){
_1b=this.Yesterday+" "+this.At+" "+this.getLocalizedTime(_19);
}else{
_1b=this.Yesterday;
}
}else{
if(_1a==0){
if(!_16){
_1b=this.Today+" "+this.At+" "+this.getLocalizedTime(_19);
}else{
_1b=this.Today;
}
}else{
if(_1a==-1){
_1b=this.Tomorrow;
}else{
if(_1a==-2){
_1b=this.Days[_19.getDay()];
}
}
}
}
}
}else{
if(_18.getFullYear()==_19.getFullYear()){
var lcl=_a,_1c=lcl.getLanguage(),_1d=lcl.getCountry();
if(_1c==="en"&&(!_1d||_1d==="us")&&!_17){
_1b=this.Month[_19.getMonth()]+" "+_19.getDate();
}else{
_1b=this.getLocalizedDate(_19);
}
}else{
var lcl=_a,_1c=lcl.getLanguage(),_1d=lcl.getCountry();
if(_1c==="en"&&(!_1d||_1d==="us")){
_1b=this.Month[_19.getMonth()]+" "+_19.getDate()+", "+_19.getFullYear();
}else{
_1b=this.getLocalizedDate(_19);
}
}
}
if(_2.locale=="ar"){
return "\u200f"+_1b;
}
return _1b;
};
w.getLocalizedTime=function(_1e){
return _3.format(_1e,{selector:"time",formatLength:"short",locale:_2.locale});
};
w.getLocalizedDate=function(_1f){
if(_b.isGregorian()){
return _3.format(_1f,{selector:"date",formatLength:"medium",locale:_2.locale});
}else{
return _b.formatBidiDate(_1f,{selector:"date",formatLength:"medium",locale:_2.locale});
}
};
w.getLocaleString=function(_20){
var _21=new Date();
_21.setTime(_20);
if(_b.isGregorian()){
return _21.toLocaleString();
}else{
return _b.formatBidiDate(_21,{selector:"date",formatLength:"medium",locale:_2.locale});
}
};
w.atomDateToJsDate=function atomDateToJsDate(_22){
var _23=null;
var s=_22;
var _24=(s.charAt(s.length-1)=="Z");
var _25=s.indexOf("-");
if(s.length>="yyyy-mm-ddThh:mm".length){
s=s.substring(_25-4);
var y=parseInt(s.substr(0,4));
var m=parseInt(s.substr(5,2),10)-1;
var d=parseInt(s.substr(8,2),10);
var h=parseInt(s.substr(11,2),10);
var mi=parseInt(s.substr(14,2),10);
var utc=0;
if(_24){
var _26=s.substring(17,s.length-1);
var _27=parseFloat(_26);
utc=Date.UTC(y,m,d,h,mi)+_27*1000;
}else{
var zh=0;
var zm=0;
var _28=s.length-6;
var _29=s.charAt(_28);
if((_29=="+"||_29=="-")&&s.indexOf("T")<s.length-5){
var se=parseInt(s.substr(17,2),10);
var zh=parseInt(s.substr(_28,3),10);
var zm=parseInt(s.substr(_28+4,2),10);
}
utc=Date.UTC(y,m,d,h,mi,se)-(zh*60*60*1000+zm*60*1000);
}
_23=new Date(utc);
}
return _23;
};
w.AtomDateToString=function AtomDateToString(_2a,_2b){
var _2c=w.atomDateToJsDate(_2a);
var _2d=new Date(_2a);
_2c=_2d.getDay()&&!_2c?_2d:_2c;
return _2c?w.toString(_2c,_2b):_2a;
};
return w;
});


;define("ic-core/quickResults/GenericEntry",["dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/date","dojo/dom-class","dojo/dom-attr","dojo/i18n","dojo/i18n!./nls/GenericEntry","dojo/string","dojo/text!./templates/GenericEntry.html","dijit/_Templated","dijit/_Widget","../globalization/bidiUtil","../globalization/config","../DateUtil","../url","../widgetUtils","../config/services","ic-ui/layout/people"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13){
var _14=_1("lconn.core.quickResults.GenericEntry",[_c,_b],{templateString:_a,contentId:"",entryTitle:"",details:"",author:"",date:null,source:"",itemType:"",isUpdate:false,resourceUrl:"",photoUrl:"",fileType:"",isFocusable:false,_strings:null,_authorString:"",_dateString:"",_additionalClass:"",postMixInProperties:function(){
this.inherited(arguments);
if(this.source=="updates"){
this.isUpdate=true;
}
this._strings=_8;
_2.mixin(this,this._strings);
this._initStrings();
this._initIcon();
},_initStrings:function(){
this._authorString=this.isUpdate?_9.substitute(this.UPDATED_BY,{author:this.author}):this.author;
var _15=this._getEntryTypeString();
if(this.date&&_15){
var _16=new Date();
switch(_4.difference(_16,this.date,"day")){
case 0:
var _17;
if((_17=_4.difference(this.date,_16,"hour"))>0){
var str=_17==1?this._strings[_15+"VIEWED_1_HOUR_AGO"]:this._strings[_15+"VIEWED_HOURS_AGO"];
this._dateString=_9.substitute(str,{hours:_17});
}else{
if((_17=_4.difference(this.date,_16,"minute"))>0){
var str=_17==1?this._strings[_15+"VIEWED_1_MINUTE_AGO"]:this._strings[_15+"VIEWED_MINUTES_AGO"];
this._dateString=_9.substitute(str,{minutes:_17});
}else{
_17=_4.difference(this.date,_16,"second");
var str="";
if(_17<1){
str=this._strings[_15+"VIEWED_TODAY"];
}else{
if(_17==1){
str=this._strings[_15+"VIEWED_1_SECOND_AGO"];
}else{
str=this._strings[_15+"VIEWED_SECONDS_AGO"];
}
}
this._dateString=_9.substitute(str,{seconds:_17});
}
}
break;
case -1:
this._dateString=this._strings[_15+"VIEWED_YESTERDAY"];
break;
default:
this._dateString=_9.substitute(this._strings[_15+"VIEWED_AT_DATE"],{date:_f.toString(this.date)});
break;
}
}
},_initIcon:function(){
switch(this.source.toLowerCase()){
case "communities":
var _18=_10.getServiceUrl(_12.communities);
this.photoUrl=_18+"/service/html/image?communityUuid="+this.contentId+"&showDefaultForNoPermissions=true";
break;
case "files":
case "ecm":
this.photoUrl=this._blankGif;
if(this.itemType.toLowerCase()=="files_folder"){
this._additionalClass="lconnSprite-iconFolderClose32";
}else{
var _19=this.fileType;
var _1a=this.entryTitle.replace(/(<b>|<\/b>)/ig,"");
if(!this.fileType&&_1a.match(/.*[.](\w*)$/i)){
_19=_1a.match(/.*[.](\w*)$/i)[1];
}
this._additionalClass="lconn-ftype32 lconn-ftype32-"+_19;
}
this.entryTitle=_d.enforceTextDirection(this.entryTitle,_e.TEXT_DIRECTION.LEFT_TO_RIGHT);
break;
case "profiles":
this.photoUrl=_11.addVersionNumber(_13.getImageUrl({userid:this.contentId},40));
this._additionalClass="lconn_userImage";
break;
case "activities":
this.photoUrl=this._blankGif;
if(this.itemType.toLowerCase()=="activities_todo"){
this._additionalClass="lconnSprite-iconTodos30";
}else{
this._additionalClass="lconnSprite-iconActivities30";
}
break;
case "bookmarks":
this.photoUrl=this._blankGif;
this._additionalClass="lconnSprite-iconBookmarks30";
break;
case "blogs":
case "ideationblog":
this.photoUrl=this._blankGif;
this._additionalClass="lconnSprite-iconBlogs30";
break;
case "forums":
this.photoUrl=this._blankGif;
this._additionalClass="lconnSprite-iconForums30";
break;
case "wikis":
this.photoUrl=this._blankGif;
this._additionalClass="lconnSprite-iconWikis30";
break;
case "calendar":
this.photoUrl=this._blankGif;
this._additionalClass="lconnSprite-iconCalendar30";
break;
}
},_getEntryTypeString:function(){
var _1b="";
switch(this.source.toLowerCase()){
case "communities":
_1b="COMMUNITY_";
break;
case "files":
case "ecm":
_1b="FILE_";
break;
case "profiles":
_1b="PROFILE_";
break;
case "activities":
_1b="ACTIVITY_";
break;
case "bookmarks":
_1b="BOOKMARK_";
break;
case "blogs":
case "ideationblog":
_1b="BLOG_";
break;
case "forums":
_1b="FORUM_";
break;
case "wikis":
_1b="WIKI_";
break;
case "todos":
_1b="TODO_";
break;
case "calendar":
_1b="EVENT_";
break;
}
return _1b;
},startup:function(){
if(this.date){
_5.remove(this.dateNode,"lotusHidden");
}
if(this.date&&this._authorString){
_5.remove(this._separator,"lotusHidden");
}
if(this.source.toLowerCase()=="files"){
_5.add(this.dateNode,"lconnHideOnSelected");
_5.add(this.previewOnlyNode,"lconnShowOnSelected");
_5.remove(this.previewOnlyNode,"lotusHidden");
}
if(this.isFocusable){
this.domNode.focus=_2.hitch(this,"_focusEntry");
this.hiddenLinkNode.style.display="";
this.linkNode.style.display="none";
_6.set(this.hiddenLinkNode,"aria-describedby",this.metaDataNode.id);
}
this.inherited(arguments);
},_focusEntry:function(){
this.hiddenLinkNode.focus();
},entryClick:function(){
this.hiddenLinkNode.click();
},linkClicked:function(evt){
var _1c=_2.getObject("lconn.share.fileviewer.ConnectionsFileViewer.openFromUrl");
if(this.source.toLowerCase()=="files"&&(this.itemType.toLowerCase()!="files_folder"&&this.itemType.toLowerCase()!="forums_topic")&&_1c){
if(evt){
_3.stop(evt);
}
_1c(this.hiddenLinkNode.href);
}else{
if(evt){
evt.stopPropagation();
}
}
}});
return _14;
});


;define("ic-core/quickResults/QuickResultsService",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/i18n","dojo/i18n!./nls/QuickResultsService","./DataReader","./GenericEntry","../typeahead/Service","../config/properties"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
var _a=_1("lconn.core.quickResults.QuickResultsService",_8,{SERVICE_NAME:"quickResultsEnabled",disableSpellingCorrection:false,isLoginNeeded:true,minToDisplay:4,postMixInProperties:function(){
this.inherited(arguments);
this.strings=_5;
_2.mixin(this,this.strings);
},postCreate:function(){
this._dataReader=new _6({disableSpellingCorrection:this.disableSpellingCorrection});
this._dataReader.startup();
this.header=document.createElement("div");
_3.add(this.header,"pfTitle");
this.header.innerHTML=this.QUICK_RESULTS;
this.isDisabled=_9[this.SERVICE_NAME]!=="true";
},initResults:function(_b){
var _c=[];
for(var i=0;i<_b.length;i++){
var _d=new _7({contentId:(_b[i].contentId?_b[i].contentId:""),entryTitle:(_b[i].title?_b[i].title:""),details:(_b[i].details?_b[i].details:""),author:(_b[i].author?_b[i].author:""),date:(_b[i].date?new Date(_b[i].date):null),source:(_b[i].source?_b[i].source:""),itemType:(_b[i].itemType?_b[i].itemType:""),resourceUrl:(_b[i].url?_b[i].url:""),isFocusable:this.isFocusable});
_d.startup();
this._createdWidgets.push(_d);
if(this.useAriaNodes){
_d.domNode.setAttribute("aria-describedby",this.id+"_entryAria");
}
_d.connect(_d.domNode,"onclick",_2.hitch(this,"entrySelected",_d));
_d.connect(_d,"linkClicked",_2.hitch(this,"entryClicked",_d));
if(this.isFocusable){
_d.connect(_d.hiddenLinkNode,"onfocus",_2.hitch(this,"focusCallback",_d.domNode));
}
_c.push(_d.domNode);
}
return {medium:_c};
},initAriaNodes:function(){
var _e=document.createElement("div");
_3.add(_e,"lotusHidden");
_e.innerHTML=this.ENTRY_ARIA_LABEL;
_e.id=this.id+"_entryAria";
return [_e];
},_handleError:function(_f,_10){
if(!(_10&&_10.dojoType=="cancel")){
this.isDisabled=true;
}
this.inherited(arguments);
},entrySelected:function(_11,evt){
_11.entryClick();
},entryClicked:function(_12,evt){
}});
return _a;
});


;define("dojo/i18n!ic-search/searchPanel/nls/SearchBar", {"SEARCH_ALT_TEXT":"Search","SEARCH_PLACEHOLDER":"Search All Content"});

;define("dojo/text!ic-search/searchPanel/templates/SearchBar.html", '<div class="icSearchBar">\n	<div data-dojo-props="title: \'${SEARCH_PLACEHOLDER}\', placeholder: \'${SEARCH_PLACEHOLDER}\'" data-dojo-attach-point="searchBox" data-dojo-attach-event="onFocus: onBarFocused" data-dojo-type="dijit/form/TextBox"></div>\n	<a class="icSearchIcon" href="javascript:;" role="button" class="icSvgIcon icSvgSearch" title="${SEARCH_ALT_TEXT}" aria-label="${SEARCH_ALT_TEXT}" data-dojo-attach-point="_searchButton" data-dojo-attach-event="onclick: onSearchClicked">\n		<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewbox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">\n			<g>\n				<path d="M12,1C5.926,1,1,5.926,1,12c0,6.074,4.926,11,11,11s11-4.926,11-11C23,5.926,18.074,1,12,1z M12,21c-4.962,0-9-4.038-9-9 s4.038-9,9-9s9,4.038,9,9S16.962,21,12,21z"></path>\n				<rect x="23.879" y="21.05" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -10.7696 26)" width="4.243" height="9.899"></rect>\n				<circle cx="21" cy="21" r="1"></circle>\n			</g>\n		</svg>\n	</a>\n	<div id="${id}_ariaLiveNode" class="lotusOffScreen" data-dojo-attach-point="ariaLiveNode" role="status" aria-live="assertive"></div>\n	<div class="icScopes lotusHidden" data-dojo-attach-point="_optionsNode">\n		<a href="javascript:;" class="icGlobalScope" aria-label="${globalScopeAria}" data-dojo-attach-point="_globalOptionNode" data-dojo-attach-event="onclick: onGlobalOptionClicked">${globalScopeLabel}</a>\n		<a href="javascript:;" class="icLocalScope" style="display: none;" data-dojo-attach-point="_localOptionNode" data-dojo-attach-event="onclick: onLocalOptionClicked"></a>\n	</div>\n</div>');

;define("ic-search/searchPanel/SearchBar",["dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/has","dojo/i18n","dojo/i18n!./nls/SearchBar","dojo/text!./templates/SearchBar.html","dojo/dom-class","dojo/dom-attr","dijit/_Templated","dijit/_Widget","dijit/form/TextBox","ic-core/config/features","ic-ui/layout/insights/NewRelic","ic-ui/layout/insights/tracker"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_4,_d,_e){
var _f=_e.getInstance("search");
if(!_4("search-panel-ui-insights")){
_f={track:function(){
}};
}
var _10=_1("lconn.search.searchPanel.SearchBar",[_b,_a],{templateString:_7,widgetsInTemplate:true,commonStrings:null,globalScopeAria:"",globalScopeLabel:"",_selectedScope:null,_queryTimeout:200,_lastQuery:"",_timeoutID:null,_keyPressed:false,_keyToIgnore:{9:true,16:true,17:true,18:true,27:true},constructor:function(){
this.commonStrings=_6;
_2.mixin(this,this.commonStrings);
this.inherited(arguments);
},postCreate:function(){
this.connect(this.getTextField(),"onkeypress","typeAheadCallback");
if(!_4("ie")){
this.connect(this.getTextField(),"oninput","_onInput");
}
this.connect(this.getTextField(),"onfocus","onBarFocused");
this.connect(this.getTextField(),"onblur","onBarBlurred");
_9.set(this.searchBox.textbox,"aria-control",this.ariaLiveNode.id);
},typeAheadCallback:function(evt){
var _11=evt.which||evt.keyCode;
if(!evt.keyChar&&_11==13){
_3.stop(evt);
this.onSearchClicked(evt);
return;
}
if(this._keyToIgnore[_11]){
return;
}
this.runQuery();
this._keyPressed=true;
},_onInput:function(evt){
if(!this._keyPressed){
this.typeAheadCallback(evt);
}
this._keyPressed=false;
},runQuery:function(){
clearTimeout(this._timeoutID);
this._timeoutID=setTimeout(_2.hitch(this,function(){
var str=this.searchBox?this.searchBox.get("value"):"";
str=_2.trim(str);
_f.track("panel.typeQuery",{queryLength:str.length});
if(!str){
this._lastQuery="";
this.onEmptyQuery();
return;
}
if(str===this._lastQuery){
return;
}
this._lastQuery=str;
this.onTypeahead(str);
}),this._queryTimeout);
},setLocalScopeOption:function(_12,_13){
this._localOptionNode.innerHTML="";
this._localOptionNode.style.display="none";
if(_12&&_13){
_9.set(this._localOptionNode,"aria-label",_13);
this._localOptionNode.appendChild(document.createTextNode(_12));
this._localOptionNode.style.display="";
}
},selectScope:function(_14,_15){
if(this._selectedScope){
_8.remove(this._selectedScope,"icSelectedScope");
}
this._selectedScope=_14;
_8.add(this._selectedScope,"icSelectedScope");
if(_15){
this._setCurrentScopePlaceholder(_15);
}
},showScopes:function(){
_8.remove(this._optionsNode,"lotusHidden");
},hideScopes:function(){
_8.add(this._optionsNode,"lotusHidden");
},_getCurrentScopePlaceHolder:function(){
return this.SEARCH_PLACEHOLDER;
},_setCurrentScopePlaceholder:function(_16){
this.SEARCH_PLACEHOLDER=_16;
this.searchBox.set("title",this.SEARCH_PLACEHOLDER);
this.searchBox.set("placeholder",this.SEARCH_PLACEHOLDER);
},getTextField:function(){
return this.searchBox.textbox;
},getTextValue:function(){
return this.searchBox.get("value");
},setTextValue:function(_17){
this.searchBox.set("value",_17);
this.runQuery();
},setAriaLiveString:function(_18){
this.ariaLiveNode.textContent=_18;
},focus:function(){
this.searchBox.focus();
},onTypeahead:function(_19){
},onEmptyQuery:function(){
},onSearchClicked:function(evt){
if(this._selectedScope==this._localOptionNode){
this.onLocalOptionClicked(evt);
}else{
this.onGlobalOptionClicked(evt);
}
},onLocalOptionClicked:function(evt){
},onGlobalOptionClicked:function(evt){
},onBarFocused:function(){
},onBarBlurred:function(){
}});
return _10;
});


;define("dojo/i18n!ic-search/searchPanel/nls/SearchPane", {"CLOSE":"Close","PANEL_LABEL":"Search and History Panel"});

;define("dojo/text!ic-search/searchPanel/templates/SearchPane.html", '<div role="region" class="icSearchPane" style="display: none;" aria-label="${PANEL_LABEL}">\n	<div data-dojo-attach-point="scrollFixer">\n		<div class="icSection icTopSection" data-dojo-attach-point="topSection"></div>\n		<div data-dojo-attach-point="bottomSection"></div>\n	</div>\n</div>');

;define("ic-search/searchPanel/SearchPane",["dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/dom-geometry","dojo/dom-class","dojo/fx","dojo/_base/fx","dojo/keys","dojo/i18n","dojo/i18n!./nls/SearchPane","dojo/text!./templates/SearchPane.html","dijit/_DialogMixin","dijit/_Templated","dijit/_Widget","dijit/focus"],function(_1,_2,_3,_4,_5,_6,fx,_7,_8,_9,_a,_b,_c,_d,_e){
var _f=_1("lconn.search.searchPanel.SearchPane",[_d,_c,_b],{templateString:_a,paneWidth:400,topSectionClass:"",topSectionStyle:"",bottomSectionClass:"",bottomSectionStyle:"",commonStrings:null,_modalOnKey:null,_focusHandler:null,_secondFocusHandler:null,_lastFocusEntry:null,_isVisible:false,postMixInProperties:function(){
this.commonStrings=_9;
_2.mixin(this,this.commonStrings);
this.inherited(arguments);
},startup:function(){
this.scrollFixer.style.width=(this.paneWidth-17)+"px";
document.body.appendChild(this.domNode);
this.containerNode=this.domNode;
this.connect(this.domNode,"onscroll","onScrollToUpdate");
},show:function(){
if(this._isVisible){
return;
}
this._isVisible=true;
this._modalOnKey=this.connect(this.domNode,"keydown",_2.hitch(this,"_onKey"));
var _10=this.domNode;
var _11=this;
fx.animateProperty({node:_10,duration:500,properties:{width:{start:0,end:this.paneWidth,units:"px"}},onBegin:function(){
_10.style.display="";
},onEnd:function(){
_11._focusHandler=_e.watch("curNode",function(_12,_13,_14){
if(!_11.domNode.contains(_14)&&_e.activeStack.indexOf(_11.id)<0&&_11._isVisible){
_11.hide();
}
_11._checkLastFocus(_14);
});
_11._secondFocusHandler=_e.watch("activeStack",function(_15,_16,_17){
if(_17.indexOf(_11.id)<0&&_11._isVisible){
_11.hide();
}
});
_11.onShowEnded();
}}).play();
},hide:function(){
if(!this._isVisible){
return;
}
this._isVisible=false;
var _18=this.domNode;
var _19=this;
fx.animateProperty({node:_18,duration:500,properties:{width:{start:this.paneWidth,end:0,units:"px"}},onBegin:function(){
_19._focusHandler.remove();
_19._secondFocusHandler.remove();
},onEnd:function(){
_18.style.display="none";
_19.onHideEnded();
}}).play();
this._modalOnKey.remove();
},_onKey:function(evt){
if(evt.keyCode==_7.TAB){
this._getFocusItems(this.domNode);
var _1a=evt.target;
if(this._firstFocusItem==this._lastFocusItem){
_3.stop(evt);
}else{
if(_1a==this._firstFocusItem&&evt.shiftKey){
_e.focus(this._lastFocusItem);
_3.stop(evt);
}else{
if(_1a==this._lastFocusItem&&!evt.shiftKey){
_e.focus(this._firstFocusItem);
_3.stop(evt);
}
}
}
}else{
if(evt.keyCode==_7.ESCAPE){
this.hide();
}
}
},_checkLastFocus:function(_1b){
if(this._lastFocusEntry&&!this._lastFocusEntry.contains(_1b)){
_5.remove(this._lastFocusEntry,"spSelected");
}
},_onEntryFocused:function(_1c){
if(this._lastFocusEntry){
_5.remove(this._lastFocusEntry,"spSelected");
}
if(!_1c){
return;
}
this._lastFocusEntry=_1c;
_5.add(this._lastFocusEntry,"spSelected");
var _1d=_4.position(this.domNode);
var _1e=_4.position(_1c);
if((_1e.y+_1e.h)>(_1d.y+_1d.h)){
this.domNode.scrollTop+=(_1e.y+_1e.h)-(_1d.y+_1d.h);
}else{
if(_1e.y<_1d.y){
this.domNode.scrollTop+=_1e.y-_1d.y;
}
}
},focus:function(){
},onScrollToUpdate:function(){
},onShowEnded:function(){
},onHideEnded:function(){
}});
return _f;
});


;define("dojo/i18n!ic-search/searchPanel/history/nls/HistoryWidget", {"TODAY":"Today","LOGIN_MESSAGE":"\x3ca href=\'javascript:;\' style=\'color: #1F7CAE; font-weight: bold;\'\x3eLog in\x3c/a\x3e to see the pages\x3cbr /\x3eyou have visited.","RECENTLY_VISITED":"RECENTLY VISITED","RECENT_SEARCHES":"RECENT SEARCHES","PREV_7_DAYS":"Previous 7 Days","LOADING":"Loading...","PREV_30_DAYS":"Previous 30 Days","NO_HISTORY_MESSAGE":"Once you visit pages you\'ll see them here. Think of it as a shortcut.\x3cbr/\x3e\x3cbr/\x3eGo ahead and search to get started."});

;define("dojo/text!ic-search/searchPanel/history/templates/HistoryWidget.html", '<div>\n	<div class="lotusHidden" data-dojo-attach-point="recentSearchesNode"></div>\n	<div class="icHistoryContent lotusHidden" data-dojo-attach-point="historyContentNode"></div>\n	<div data-dojo-attach-point="loadingFrame" class="lconnApplicationLoading">\n		<img class="lotusLoading" src="${_blankGif}" role="presentation" alt="">\n		<div tabindex="0" data-dojo-attach-point="loadingFrameFocusable">${LOADING}</div>\n	</div>\n	<div class="icNoHistoryMessage" style="display: none;" data-dojo-attach-point="noHistoryMessageNode" role="alert">\n		<p style="margin: 0 auto;">${!NO_HISTORY_MESSAGE}</p>\n	</div>\n	<div class="icNoHistoryMessage" style="display: none;" data-dojo-attach-point="loginNeededNode" data-dojo-attach-event="onclick: _login" role="alert">\n		<p style="cursor: pointer; margin: 0 auto;">${!LOGIN_MESSAGE}</p>\n	</div>\n</div>');

;define("ic-search/searchPanel/history/HistoryService",["dojo/_base/declare","dojo/_base/lang","dojo/i18n","dojo/i18n!./nls/HistoryWidget","dojo/date","dojo/date/locale","dojo/dom-class","ic-core/config/properties","ic-core/quickResults/DataReader","ic-core/quickResults/QuickResultsService","ic-core/quickResults/GenericEntry"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){
var _c=_1("lconn.search.searchPanel.history.HistoryService",_a,{minToDisplay:-1,resultPerPage:5,_strings:_4,_toBeCleared:false,postCreate:function(){
this._dataReader=new _9({disableSpellingCorrection:this.disableSpellingCorrection,canSendEmptyQueries:true,pageSize:this.resultPerPage});
this._dataReader.startup();
this.header=document.createElement("div");
_7.add(this.header,"pfTitle");
this.header.innerHTML=this.QUICK_RESULTS;
this.isDisabled=_8[this.SERVICE_NAME]!=="true";
},destroy:function(){
this._toBeCleared=true;
},executeQuery:function(_d){
this._dataReader.resetLastQuery();
return this.inherited(arguments);
},initResults:function(_e){
var _f={_index:[],_size:_e.length};
for(var i=0;i<_e.length;i++){
var _10=new _b({contentId:(_e[i].contentId?_e[i].contentId:""),entryTitle:(_e[i].title?_e[i].title:""),details:(_e[i].details?_e[i].details:""),author:(_e[i].author?_e[i].author:""),date:(_e[i].date?new Date(_e[i].date):null),source:(_e[i].source?_e[i].source:""),itemType:(_e[i].itemType?_e[i].itemType:""),resourceUrl:(_e[i].url?_e[i].url:""),isFocusable:this.isFocusable});
_10.startup();
this._createdWidgets.push(_10);
_10.connect(_10.domNode,"onclick",_2.hitch(this,"entrySelected",_10));
_10.connect(_10,"linkClicked",_2.hitch(this,"entryClicked",_10));
if(this.isFocusable){
_10.connect(_10.hiddenLinkNode,"onfocus",_2.hitch(this,"focusCallback",_10.domNode));
}
var _11=this._getGroupId(_10.date);
if(!_f[_11]){
_f[_11]={header:this._createHeader(_11),elements:[]};
_f._index.push(_11);
}
_f[_11].elements.push(_10.domNode);
}
return _f;
},_createHeader:function(_12){
var _13=document.createElement("div");
_7.add(_13,"pfTitle");
_13.innerHTML=_12.charAt(0).toUpperCase()+_12.slice(1);
return _13;
},_getGroupId:function(_14){
var _15=new Date();
var _16=_5.difference(_14,_15,"day");
var _17=_5.difference(_14,_15,"year");
var _18=_14.getFullYear();
if(_16==0){
_18=this._strings.TODAY;
}else{
if(_16<=7){
_18=this._strings.PREV_7_DAYS;
}else{
if(_16<=30){
_18=this._strings.PREV_30_DAYS;
}else{
if(_17==0){
_18=_6.format(_14,{selector:"date",datePattern:"MMMM"});
}
}
}
}
return _18.toString();
},_cleanAll:function(){
if(this._toBeCleared){
this.inherited(arguments);
}
},_handleError:function(){
this._toBeCleared=true;
this.inherited(arguments);
this._toBeCleared=false;
},_handleDisabled:function(){
this._toBeCleared=true;
this.inherited(arguments);
this._toBeCleared=false;
},focusCallback:function(_19){
}});
return _c;
});


;define("ic-search/searchPanel/history/HistoryWidget",["dojo/dom-construct","dojo/i18n!./nls/HistoryWidget","dojo/i18n","dojo/dom-class","dojo/dom-geometry","dojo/dom-attr","dojo/_base/declare","dojo/_base/lang","dojo/text!./templates/HistoryWidget.html","dijit/_Templated","dijit/_Widget","./HistoryService","ic-core/auth","ic-core/config/features","ic-ui/layout/insights/NewRelic","ic-ui/layout/insights/tracker"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){
var _11=_10.getInstance("search");
if(!_e("search-panel-ui-insights")){
_11={track:function(){
}};
}
var _12=_7("lconn.search.searchPanel.history.HistoryWidget",[_b,_a],{templateString:_9,commonStrings:null,resultPerPage:5,historyService:null,selectionArray:null,isVisible:false,scrollNode:null,containerWidth:400,_groupKeys:null,_groupNodes:null,_toGiveFocus:null,_lastEntry:null,_handlers:null,_isNextPageRunning:false,postMixInProperties:function(){
this.commonStrings=_2;
_8.mixin(this,this.commonStrings);
this.inherited(arguments);
},postCreate:function(){
this.historyService=new _c({resultPerPage:this.resultPerPage,isFocusable:true,focusCallback:_8.hitch(this,"onEntryFocused")});
this.historyService.startup();
this.connect(this.historyService,"entryClicked",function(_13,evt){
_11.track("panel.clickHistoryEntry",{resultType:_13.source,viewedDate:_13.date.toISOString()});
});
this.selectionArray=[];
this._handlers=[];
this.connect(this.loadingFrameFocusable,"onfocus",_8.hitch(this,"onEntryFocused",this.loadingFrame));
var _14=this.scrollNode||document.body;
this.connect(_14,"onscroll","checkMoreResultsNeeded");
this.connect(_14,"onscroll",_8.hitch(this,function(){
_11.track("panel.scrollHistory",{loadedResults:this.selectionArray.length});
}));
this.connect(window,"onresize","checkMoreResultsNeeded");
this.noHistoryMessageNode.style.width=(this.containerWidth-68)+"px";
this.loginNeededNode.style.width=(this.containerWidth-68)+"px";
},initHistoryContent:function(){
this.noHistoryMessageNode.style.display="none";
var _15=this.historyService.executeQuery("");
_15=_15.then(_8.hitch(this,"_handleHistoryResults"));
return _15;
},getMoreHistoryContent:function(){
this._isNextPageRunning=true;
var _16=this.historyService.getNextPage();
_16.then(_8.hitch(this,"_appendResults"));
},_releaseHandlers:function(){
for(var i=0;i<this._handlers.length;i++){
this._handlers[i].remove();
}
this._handlers=[];
},_handleHistoryResults:function(_17){
this.selectionArray=[];
this._groupKeys=[];
this._groupNodes=[];
this._releaseHandlers();
this.loadingFrame.style.display="";
if(!_17.results||!_17.totalResults>0){
this.handleNoResults();
return;
}
_1.empty(this.historyContentNode);
_4.remove(this.historyContentNode,"lotusHidden");
this._appendResults(_17);
this.checkMoreResultsNeeded();
},_appendResults:function(_18){
this._isNextPageRunning=false;
this._checkLastPage(_18.results._size,_18.totalResults,_18.pageSize);
this._insertHistory(_18);
if(document.activeElement==this.loadingFrameFocusable&&this._toGiveFocus){
this._toGiveFocus.focus();
this._toGiveFocus=null;
}
},_insertHistory:function(_19){
for(var k=0;k<_19.results._index.length;k++){
var key=_19.results._index[k];
var _1a=_19.results[key];
if(this._groupKeys.indexOf(key)<0){
var _1b=document.createElement("div");
_6.set(_1b,"role","navigation");
_6.set(_1b,"aria-label",_1a.header.textContent);
_1b.appendChild(_1a.header);
this.historyContentNode.appendChild(_1b);
this._groupKeys.push(key);
this._groupNodes[key]=_1b;
}else{
_4.remove(this._groupNodes[key].lastChild,"pfLastEntry");
}
for(var i=0;i<_1a.elements.length;i++){
_4.add(_1a.elements[i],"pfEntry");
if(i==_1a.elements.length-1){
_4.add(_1a.elements[i],"pfLastEntry");
}
this._groupNodes[key].appendChild(_1a.elements[i]);
this._handlers.push(this.connect(_1a.elements[i],"onclick","entryClicked"));
this.selectionArray.push(_1a.elements[i]);
if((document.activeElement==this.loadingFrameFocusable||document.activeElement==this._lastEntry)&&!this._toGiveFocus){
this._toGiveFocus=_1a.elements[i];
}
this._lastEntry=_1a.elements[i];
}
}
},getSelectionArray:function(){
return this.selectionArray;
},checkMoreResultsNeeded:function(){
if(!this.loadingFrame||this._isNextPageRunning){
return;
}
setTimeout(_8.hitch(this,function(){
if(this._checkElementIsDisplayed()){
this.getMoreHistoryContent();
}
}),1);
},_checkElementIsDisplayed:function(){
if(this.loadingFrame.style.display=="none"){
return false;
}
var _1c=_5.position(this.scrollNode);
var _1d=_1c?(_1c.y+_1c.h):(_e("ie")<=8?document.documentElement.clientHeight:window.innerHeight);
var _1e=_5.position(this.loadingFrame);
return (_1e.y<_1d);
},_checkLastPage:function(_1f,_20,_21){
if(_20<=_21||_1f<_21){
if(this._lastEntry){
this._lastEntry.focus();
this._lastEntry=null;
}
this.loadingFrame.style.display="none";
}
},hideWidget:function(){
_4.add(this.domNode,"lotusHidden");
this.isVisible=false;
},showWidget:function(){
_4.remove(this.domNode,"lotusHidden");
this.isVisible=true;
setTimeout(_8.hitch(this,"_forceAriaReadings"),30);
},handleNoResults:function(){
_4.add(this.historyContentNode,"lotusHidden");
if(_d.isAuthenticated()){
this.noHistoryMessageNode.style.display="";
this.loginNeededNode.style.display="none";
}else{
this.noHistoryMessageNode.style.display="none";
this.loginNeededNode.style.display="";
}
this.loadingFrame.style.display="none";
},_forceAriaReadings:function(){
if(this.noHistoryMessageNode.style.display!="none"){
this.noHistoryMessageNode.innerHTML=this.noHistoryMessageNode.innerHTML;
}
if(this.loginNeededNode.style.display!="none"){
this.loginNeededNode.innerHTML=this.loginNeededNode.innerHTML;
}
},_login:function(){
_d.login();
},onEntryFocused:function(_22){
},entryClicked:function(){
}});
return _12;
});


;define("dojo/i18n!ic-search/searchPanel/typeahead/nls/TypeaheadWidget", {"NO_RESULTS_MESSAGE":"Sorry, there are no results for this search. Try a different word or more general term.","LOGIN_MESSAGE":"\x3ca href=\'javascript:;\' style=\'color: #1F7CAE; font-weight: bold;\'\x3eLog in\x3c/a\x3e to see more results including Files, Wikis, Communities and more."});

;define("dojo/text!ic-search/searchPanel/typeahead/templates/TypeaheadWidget.html", '<div class="lotusHidden">\n	<div class="pfDirectoryResults lconnSearchHighlight" data-dojo-attach-point="resultsContainer"></div>\n	<div class="pfDirectoryResults">\n		<div class="pfTitle" style="font-weight: normal;" data-dojo-attach-point="noResultsNode" role="alert" aria-live="assertive">${NO_RESULTS_MESSAGE}</div>\n		<div class="pfEntry" style="margin-top: 10px;" data-dojo-attach-point="loginNode" data-dojo-attach-event="onclick: _login">\n			<div class="lconn_gray">${!LOGIN_MESSAGE}</div>\n		</div>\n	</div>\n</div>');

;define("ic-search/searchPanel/typeahead/TypeaheadWidget",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-attr","dijit/_Widget","dijit/_Templated","dojo/i18n","dojo/i18n!./nls/TypeaheadWidget","dojo/text!./templates/TypeaheadWidget.html","ic-core/auth","ic-core/peopleFinder/directory/PeopleFinderService","ic-core/quickResults/QuickResultsService"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){
var _d=_1("lconn.search.searchPanel.typeahead.TypeaheadWidget",[_5,_6],{maxResults:7,disableFooters:false,templateString:_9,servicesList:null,isVisible:false,commonStrings:null,_serviceOrder:null,_serviceNodeIndex:null,_showLogin:false,postMixInProperties:function(){
this.commonStrings=_8;
_2.mixin(this,this.commonStrings);
this.inherited(arguments);
},postCreate:function(){
this._serviceOrder=[];
this._serviceNodeIndex=[];
var _e=this.loginNode.getElementsByTagName("a")[0];
if(_e){
this.connect(_e,"onfocus",_2.hitch(this,"loginNodeFocused",this.loginNode));
}
},addServiceResponse:function(_f){
var _10=document.createElement("div");
_10.id=_f+"_resultsNode";
_4.set(_10,"role","navigation");
this.resultsContainer.appendChild(_10);
this._serviceNodeIndex[_f]={node:_10,tmpNode:document.createElement("div"),results:[],response:null};
this._serviceOrder.push(_f);
},setResults:function(_11,_12){
if(!this._serviceNodeIndex[_11]){
return;
}
this._serviceNodeIndex[_11].results=[];
this._serviceNodeIndex[_11].response=_12;
},_prepareResultsContent:function(){
var _13=this._populateResults();
if(_13==0){
_3.remove(this.noResultsNode,"lotusHidden");
setTimeout(_2.hitch(this,"_forceNoResultsMessage"));
}else{
_3.add(this.noResultsNode,"lotusHidden");
}
if(this._showLogin){
_3.remove(this.loginNode,"lotusHidden");
}else{
_3.add(this.loginNode,"lotusHidden");
}
},_populateResults:function(){
var _14=0;
var _15=[];
var _16=[];
var low=[];
for(var i=0;i<this._serviceOrder.length;i++){
var _17=this._serviceOrder[i];
this._serviceNodeIndex[_17].node.innerHTML="";
if(this._serviceNodeIndex[_17].response&&this._serviceNodeIndex[_17].response.totalResults>0){
var max=this._serviceNodeIndex[_17].response.minToDisplay||0;
var _18=0;
if(this._serviceNodeIndex[_17].response.results.high){
_18+=this._insertElements(_17,this._serviceNodeIndex[_17].response.results.high,max-_18,_15);
}
if(this._serviceNodeIndex[_17].response.results.medium){
_18+=this._insertElements(_17,this._serviceNodeIndex[_17].response.results.medium,max-_18,_16);
}
if(this._serviceNodeIndex[_17].response.results.low){
_18+=this._insertElements(_17,this._serviceNodeIndex[_17].response.results.low,max-_18,low);
}
_14+=_18;
}
}
var _19=_15.concat(_16,low);
_14=this._insertFillers(_19,_14);
for(var i=0;i<this._serviceOrder.length;i++){
this._addHeader(this._serviceOrder[i]);
if(!this.disableFooters){
this._addFooter(this._serviceOrder[i]);
}
var _1a=this._serviceNodeIndex[this._serviceOrder[i]].node;
_1a.style.display=_1a.children.length>0?"":"none";
}
return _14;
},_insertElements:function(_1b,_1c,max,_1d){
for(var i=0;i<_1c.length;i++){
_3.add(_1c[i],"pfEntry");
if(i<max){
this._serviceNodeIndex[_1b].node.appendChild(_1c[i]);
this._serviceNodeIndex[_1b].results.push(_1c[i]);
}else{
_1d.push({id:_1b,item:_1c[i]});
}
}
return (i<max?i:max);
},_insertFillers:function(_1e,_1f){
for(var i=0;i<_1e.length&&_1f<this.maxResults;i++){
var _20=_1e[i].id;
var _21=_1e[i].item;
this._serviceNodeIndex[_20].node.appendChild(_21);
this._serviceNodeIndex[_20].results.push(_21);
_1f++;
}
return _1f;
},_addHeader:function(_22){
if(this._serviceNodeIndex[_22].response.header&&this._serviceNodeIndex[_22].results.length>0){
_4.set(this._serviceNodeIndex[_22].node,"aria-label",this._serviceNodeIndex[_22].response.header.textContent);
this._serviceNodeIndex[_22].node.insertBefore(this._serviceNodeIndex[_22].response.header,this._serviceNodeIndex[_22].node.firstChild);
}
},_addFooter:function(_23){
if(this._serviceNodeIndex[_23].response.footer&&this._serviceNodeIndex[_23].results.length>0){
_3.add(this._serviceNodeIndex[_23].response.footer,"pfEntry");
this._serviceNodeIndex[_23].node.appendChild(this._serviceNodeIndex[_23].response.footer);
this._serviceNodeIndex[_23].results.push(this._serviceNodeIndex[_23].response.footer);
}
},_forceNoResultsMessage:function(){
this.noResultsNode.innerHTML=this.noResultsNode.innerHTML;
},_login:function(){
_a.login();
},loginNodeFocused:function(_24){
},showLogin:function(_25){
this._showLogin=_25;
},hideWidget:function(){
_3.add(this.domNode,"lotusHidden");
this.isVisible=false;
},showWidget:function(){
this._prepareResultsContent();
_3.remove(this.domNode,"lotusHidden");
this.isVisible=true;
},getResultsCountForService:function(_26){
return this._serviceNodeIndex[_26].results.length;
}});
return _d;
});


;define("ic-search/searchPanel/SearchPaneManager",["dojo/_base/declare","dojo/_base/lang","dojo/_base/fx","dojo/_base/event","dojo/DeferredList","dojo/dom-class","dojo/dom-geometry","dojo/dom-attr","dojo/i18n","dojo/i18n!./nls/SearchPaneManager","dojo/text!./templates/SearchPaneManager.html","dojo/string","dijit/_Widget","dijit/_Templated","ic-core/url","ic-core/config/services","ic-core/config/features","ic-core/peopleFinder/directory/PeopleFinderService","ic-core/quickResults/QuickResultsService","ic-ui/layout/insights/NewRelic","ic-ui/layout/insights/tracker","./SearchBar","./SearchPane","./history/HistoryWidget","./typeahead/TypeaheadWidget"],function(_1,_2,fx,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,has,_10,_11,_12,_13,_14,_15,_16,_17){
var _18=_13.getInstance("search");
if(!has("search-panel-ui-insights")){
_18={track:function(){
}};
}
var _19=_1("lconn.search.searchPanel.SearchPaneManager",[_c,_d],{localOptions:null,SEARCH_DIRECTORY:"directory",SEARCH_PATH:"/web/search",searchBar:null,_tmpSearchBar:null,isSearchBarModeOn:false,templateString:_a,widgetsInTemplate:true,commonStrings:null,historyWidget:null,typeaheadWidget:null,searchPane:null,servicesList:null,globalScope:null,_offsets:{},_serciveTimeout:1500,_maxResults:7,_globalOptionNode:null,_localOptionNode:null,_optionsNode:null,_selectedOption:null,_disabled:true,postMixInProperties:function(){
this.commonStrings=_9;
_2.mixin(this,this.commonStrings);
this.globalScope={label:this.ALL_CONTENT,scope:"allconnections",action:_e.getServiceUrl(_f.search)+this.SEARCH_PATH,method:"GET"};
this.inherited(arguments);
},postCreate:function(){
if(this.localOptions instanceof Array){
this.localOptions=this.localOptions[0];
}
this._selectedOption=this.globalScope;
this.connect(this.domNode,"onclick","openSearchPane");
this.connect(this._otherSearchBar,"onGlobalOptionClicked",_2.hitch(this,"runSearch",false));
this.connect(this._otherSearchBar,"onLocalOptionClicked",_2.hitch(this,"runSearch",true));
this.searchBar=new _14({SEARCH_PLACEHOLDER:this.GLOBAL_SCOPE_PLACEHOLDER,globalScopeLabel:this.globalScope.label,globalScopeAria:this.GLOBAL_SCOPE_BUTTON});
this.searchBar.startup();
this.searchBar.selectScope(this.searchBar._globalOptionNode);
if(this.localOptions&&this.localOptions.label){
this.searchBar.setLocalScopeOption(this.localOptions.label,_b.substitute(this.LOCAL_SCOPE_BUTTON,{scope:this.localOptions.label}));
}
this.connect(this.searchBar,"onGlobalOptionClicked",_2.hitch(this,"runSearch",false));
this.connect(this.searchBar,"onLocalOptionClicked",_2.hitch(this,"runSearch",true));
this.connect(this.searchBar,"onEmptyQuery","_handleEmptyQuery");
this.connect(this.searchBar,"onTypeahead","runTypeaheadQuery");
var _1a=this;
this.connect(this.searchBar,"runQuery",function(){
setTimeout(function(){
if(_1a.searchBar.getTextField().value){
_1a.historyWidget.hideWidget();
_1a.searchBar.showScopes();
}
},1);
});
this.searchPane=new _15();
this.searchPane.topSection.appendChild(this.searchBar.domNode);
this.searchPane.startup();
this.searchBar.connect(this.searchPane,"onShowEnded",this.searchBar.focus);
this.connect(this.searchPane,"onHideEnded","_focus");
this.connect(document,"onscroll","_scroll");
this.connect(this._searchButton,"onfocus",function(){
_5.add(this.domNode,"icSearchFocused");
});
this.connect(this._searchButton,"onblur",function(){
_5.remove(this.domNode,"icSearchFocused");
});
this.historyWidget=new _16({resultPerPage:10,scrollNode:this.searchPane.domNode,containerWidth:this.searchPane.paneWidth});
this.historyWidget.startup();
this.historyWidget.hideWidget();
this.searchPane.bottomSection.appendChild(this.historyWidget.domNode);
this.searchPane.connect(this.historyWidget,"onEntryFocused","_onEntryFocused");
if(!this.servicesList){
this._initServices();
}
this.typeaheadWidget=new _17({disableFooters:true});
this.typeaheadWidget.startup();
this.connect(this.typeaheadWidget,"loginNodeFocused",_2.hitch(this.searchPane,"_onEntryFocused"));
this.typeaheadWidget.hideWidget();
this.searchPane.bottomSection.appendChild(this.typeaheadWidget.domNode);
for(var i=0;i<this.servicesList.length;i++){
var _1b=this.servicesList[i];
_1b.setTimeout(this._serciveTimeout);
_1b.setPageSize(this._maxResults);
_1b.focusCallback=_2.hitch(this.searchPane,"_onEntryFocused");
this.typeaheadWidget.addServiceResponse(_1b.id);
}
this.domNode.style.display="none";
this._checkNavBar();
},_checkNavBar:function(){
var _1c=document.querySelector(".ics-scbanner");
if(!document.body.classList.contains("scloud3")){
this._disabled=false;
this._finalizeWidget();
}else{
if(_1c&&!_1c.classList.contains("loading")){
this._disabled=false;
this._finalizeWidget();
}else{
setTimeout(_2.hitch(this,"_checkNavBar"),100);
}
}
},_finalizeWidget:function(){
if(this._disabled){
return;
}
this.domNode.style.display="";
this._initPosition();
this._scroll();
if(this.isSearchBarModeOn){
this._switchSearchBarMode();
}
},_initPosition:function(){
if(this._disabled){
return;
}
if(document.getElementById("lotusBanner")){
var _1d=_6.position("lotusBanner");
this._populateOffsets(_1d.y+_1d.h);
if(!this.isSearchBarModeOn){
this.domNode.style.top=this._offsets.domNode+"px";
this.searchPane.domNode.style.top=this._offsets.searchPane+"px";
}
}
},_initServices:function(){
var _1e=new _10({isFocusable:true,SEARCH_PANE_COUNT_ID:"PEOPLE_FINDER_ANNOUNCEMENT"});
_1e.startup();
this.connect(_1e,"entryClicked",function(_1f,evt){
if(evt.currentTarget&&evt.currentTarget.href&&evt.currentTarget.href.match(/^mailto:/i)){
_18.track("panel.clickPFMail",{confidence:_1f.confidence});
}else{
_18.track("panel.clickPFEntry",{confidence:_1f.confidence});
}
});
var _20=new _11({isFocusable:true,SEARCH_PANE_COUNT_ID:"QUICK_RESULTS_ANNOUNCEMENT"});
_20.startup();
this.connect(_20,"entryClicked",function(_21,evt){
_18.track("panel.clickQREntry",{resultType:_21.source,viewedDate:_21.date.toISOString()});
});
this.servicesList=[_20,_1e];
},destroy:function(){
this.searchBar.destroy();
this.historyWidget.destroy();
this.typeaheadWidget.destroy();
this.searchPane.destroy();
},_focus:function(){
if(this.searchPane.domNode.contains(document.activeElement)){
this.focus();
}
},focus:function(){
this._searchButton.focus();
},runSearch:function(_22){
var _23=this.searchBar.getTextValue();
if(!_23.trim()){
return;
}
this._selectedOption=_22?this.localOptions:this.globalScope;
_18.track("panel.search",{queryLength:_23.length,queryScope:this._selectedOption.scope||this._selectedOption.feature});
if(this.onSubmit()){
if(_22&&this.localOptions.valueReplaceParam){
var url=this.localOptions.action;
url=url.replace(new RegExp("{"+this.localOptions.valueReplaceParam+"}","gi"),encodeURIComponent(_23));
window.location.href=url;
return;
}
this._prepareForm(this._selectedOption,_23);
this.formNode.submit();
}
},_prepareForm:function(_24,_25){
if(_24.scope){
this.scopeNode.value=_24.scope;
this.featureNode.value=_24.feature?_24.feature:"";
}else{
if(_24.feature){
if(_24.feature=="allareas"){
this.featureNode.value="";
}else{
this.featureNode.value=_24.feature;
}
this.scopeNode.value="";
}
}
if(_24.action){
if(_24.scope=="extkeyword"){
this.formNode.method="GET";
this.formNode.action=_24.action;
}else{
this.formNode.method="POST";
this.formNode.action=_24.action;
}
}else{
this.formNode.method="GET";
this.formNode.action=this.globalScope.action;
}
if(_24.method&&_24.method=="GET"||_24.method=="POST"){
this.formNode.method=_24.method;
}
this.queryNode.value=_25;
this.featureNode.name=_24.action==this.globalScope.action?"scope":"component";
if(!this.featureNode.value){
_7.set(this.featureNode,"disabled",true);
}else{
_7.remove(this.featureNode,"disabled");
}
if(!this.scopeNode.value){
_7.set(this.scopeNode,"disabled",true);
}else{
_7.remove(this.scopeNode,"disabled");
}
},runTypeaheadQuery:function(_26){
this.typeaheadWidget._showLogin=false;
var _27=[];
for(var i=0;i<this.servicesList.length;i++){
var _28=this.servicesList[i];
var _29=_28.executeQuery(_26);
_29.then(_2.hitch(this,"_setTypeaheadResults",_28.id));
_27.push(_29);
}
var _2a=new _4(_27);
_2a.then(_2.hitch(this,"_showTypeaheadResults"));
},_setTypeaheadResults:function(_2b,_2c){
this.typeaheadWidget.setResults(_2b,_2c);
if(_2c&&_2c.showLogin){
this.typeaheadWidget.showLogin(_2c.showLogin);
}
},_showTypeaheadResults:function(){
this.typeaheadWidget.showWidget();
var _2d=[];
for(var i=0;i<this.servicesList.length;i++){
var _2e=this.servicesList[i];
var n=this.typeaheadWidget.getResultsCountForService(_2e.id);
if(n>0){
_2d.push(_b.substitute((n>1?this.commonStrings[_2e.SEARCH_PANE_COUNT_ID]:this.commonStrings[_2e.SEARCH_PANE_COUNT_ID+"_SINGULAR"]),{number:n}));
}
}
if(_2d.length>0){
_2d.push(_b.substitute(this.SEARCH_SCOPE_ANNOUNCEMENT,{scope:this.isSearchBarModeOn&&this.localOptions?this.localOptions.label:this.globalScope.label}));
}
setTimeout(_2.hitch(this,function(){
this.searchBar.setAriaLiveString(_2d.join(". "));
}),1);
},runHistoryQuery:function(){
var _2f=this.historyWidget.initHistoryContent();
_2f.then(_2.hitch(this,function(){
this.historyWidget.showWidget();
}));
},_handleEmptyQuery:function(){
setTimeout(_2.hitch(this,function(){
this.searchBar.setAriaLiveString("");
}),1);
this.searchBar.hideScopes();
this.typeaheadWidget.hideWidget();
this.runHistoryQuery();
},_populateOffsets:function(_30){
if(this._disabled){
return;
}
this._offsets.domNode=_6.position(this.domNode).y;
var _31=this.searchPane.domNode.style.display;
this.searchPane.domNode.style.display="";
this._offsets.searchPane=_6.position(this.searchPane.domNode).y;
this.searchPane.domNode.style.display=_31;
if(_30){
this._offsets.domNode+=_30;
this._offsets.searchPane+=_30;
}
},_scroll:function(evt){
if(this._disabled){
return;
}
if(this.isSearchBarModeOn){
return;
}
if(!this._offsets.domNode){
this._populateOffsets();
}
var _32=this._offsets.domNode-window.scrollY;
var _33=this._offsets.searchPane-window.scrollY;
if(_32<=20&&window.scrollY>0){
this.domNode.style.top="20px";
this.searchPane.domNode.style.top="0px";
}else{
if(_32<=20&&window.scrollY<=0){
this.domNode.style.top=this._offsets.domNode+"px";
this.searchPane.domNode.style.top=this._offsets.searchPane+"px";
}else{
this.domNode.style.top=_32+"px";
this.searchPane.domNode.style.top=_33+"px";
}
}
},setLocalOptions:function(_34){
this.localOptions=_34||{label:""};
if(this.localOptions instanceof Array){
this.localOptions=this.localOptions[0];
}
this.searchBar.setLocalScopeOption(this.localOptions.label,_b.substitute(this.LOCAL_SCOPE_BUTTON,{scope:this.localOptions.label}));
},openSearchPane:function(evt){
if(this.isSearchBarModeOn){
return;
}
if(this._disabled){
setTimeout(_2.hitch(this,"openSearchPane",evt),100);
}
if(evt){
_3.stop(evt);
}
_18.track("panel.open",{pageScrollOffset:window.scrollY});
this.searchPane.show();
if(!this.searchBar._lastQuery){
this.runHistoryQuery();
}
},getSelectedOption:function(){
return this._selectedOption;
},setSearchBarMode:function(_35){
_35=!!_35;
if(this.isSearchBarModeOn==_35){
return;
}
this.isSearchBarModeOn=_35;
this._switchSearchBarMode();
},_switchSearchBarMode:function(){
if(this._disabled){
return;
}
if(this.isSearchBarModeOn){
_5.add(this.domNode,"icSearchBarMode");
var _36=this.searchBar.getTextValue();
this._otherSearchBar.setTextValue(_36);
this._tmpSearchBar=this.searchBar;
this.searchBar=this._otherSearchBar;
if(this.localOptions&&this.localOptions.label){
this.searchBar.setLocalScopeOption(this.localOptions.label,_b.substitute(this.LOCAL_SCOPE_BUTTON,{scope:this.localOptions.label}));
this.searchBar.selectScope(this.searchBar._localOptionNode,_b.substitute(this.LOCAL_SCOPE_PLACEHOLDER,{scope:this.localOptions.label}));
this._selectedOption=this.localOptions;
}
this._searchButton.style.display="none";
this.domNode.style.top="0px";
this.searchBar.domNode.style.display="";
this.searchPane.hide();
}else{
_5.remove(this.domNode,"icSearchBarMode");
var _36=this.searchBar.getTextValue();
this._tmpSearchBar.setTextValue(_36);
this.searchBar.selectScope(this.searchBar._globalOptionNode,this.GLOBAL_SCOPE_PLACEHOLDER);
this.searchBar=this._tmpSearchBar;
this._selectedOption=this.globalScope;
this._otherSearchBar.domNode.style.display="none";
this._searchButton.style.display="";
this._scroll();
}
},onSubmit:function(){
return true;
}});
return _19;
});

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["lconn.search"]=true;

;if(!dojo._hasResource["lconn.search.searchPanel.SearchPaneManager"]){
dojo._hasResource["lconn.search.searchPanel.SearchPaneManager"]=true;
dojo.provide("lconn.search.searchPanel.SearchPaneManager");


dojo.deprecated("lconn.search.searchPanel.SearchPaneManager","Use ic-search.searchPanel.SearchPaneManager instead.","5.5");
}

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.social.incontext"]=true;

;if(!dojo._hasResource["com.ibm.social.incontext.util.text"]){
dojo._hasResource["com.ibm.social.incontext.util.text"]=true;
dojo.provide("com.ibm.social.incontext.util.text");


com.ibm.social.incontext.util.text={possessive:function(s){
if(s&&s[s.length-1]!="s"){
s+="'s";
}else{
s+="'";
}
return s;
},getExtension:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf(".");
if(i!=-1){
return s.substring(i+1).toLowerCase();
}
return "";
},trimExtension:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf(".");
if(i!=-1){
return s.substring(0,i);
}
return s;
},getFilename:function(s){
if(!s){
return "";
}
var i=s.lastIndexOf("\\");
var j=s.lastIndexOf("/");
if(i==j){
return s;
}
i=Math.max(i,j);
return s.substring(i+1);
},trimToLength:function(s,_1,_2){
if(!s){
return "";
}
s=com.ibm.social.incontext.util.text.trimEnd(s);
var _3="...";
if(_2>0){
var _4=s.split(/[\s\u3000]/);
for(var i=0;i<_4.length;i++){
if(_4[i].length>_2){
var l=s.indexOf(_4[i])+_2;
if(l>_1){
break;
}
return com.ibm.social.incontext.util.text.trimEnd(s.substring(0,l-_3.length))+_3;
}
}
}
if(s.length>_1){
s=com.ibm.social.incontext.util.text.trimEnd(s.substring(0,_1-_3.length))+_3;
}
return s;
},trim:function(s){
if(!s){
return "";
}
var e=/^[\s\u3000]*(.*?)[\s\u3000]*$/.exec(s+"");
return e?e[1]:s;
},trimEnd:function(s){
if(!s){
return "";
}
s+="";
s=/^(.*?)[\s\u3000]*$/.exec(s)[1];
return s;
},parseInt:function(s,_5){
if(typeof _5=="undefined"){
_5=0;
}
if(!s){
return _5;
}
var a=parseInt(s);
return isNaN(a)?_5:a;
},parseFloat:function(s,_6){
if(typeof _6=="undefined"){
_6=0;
}
if(!s){
return _6;
}
var a=parseFloat(s);
return isNaN(a)?_6:a;
},formatSize:function(){
var _7,_8;
if(arguments.length==2){
_7=arguments[0];
_8=arguments[1];
}else{
_8=arguments[0];
}
if(typeof _8=="undefined"||_8==null||typeof _8=="string"){
return _8;
}
var _7=_7||com.ibm.social.incontext.util.text._SIZE;
if(!_7){
throw "Must pass nls to formatSize or set the com.ibm.social.incontext.util.text._SIZE property during init";
}
if(_8>10*1024*1024*1024){
return dojo.string.substitute(_7.GB,[dojo.number.format(Math.floor(_8*10/(1024*1024*1024))/10)]);
}else{
if(_8>=1*1024*1024*1024){
return dojo.string.substitute(_7.GB,[dojo.number.format(Math.floor(_8*100/(1024*1024*1024))/100)]);
}else{
if(_8>100*1024*1024){
return dojo.string.substitute(_7.MB,[dojo.number.format(Math.floor(_8/(1024*1024)))]);
}else{
if(_8>10*1024*1024){
return dojo.string.substitute(_7.MB,[dojo.number.format(Math.floor(_8*10/(1024*1024))/10)]);
}else{
if(_8>=1*1024*1024){
return dojo.string.substitute(_7.MB,[dojo.number.format(Math.floor(_8*100/(1024*1024))/100)]);
}else{
if(_8>1*1024){
return dojo.string.substitute(_7.KB,[dojo.number.format(Math.floor(_8/1024))]);
}
}
}
}
}
}
return dojo.string.substitute(_7.KB,[dojo.number.format(_8>0?1:0)]);
},lengthUtf8:function(s){
var _9=0;
var _a=s.length;
for(var i=0;i<_a;i++){
var c=s.charCodeAt(i);
if(c<=127){
_9++;
}else{
if(c<=2047){
_9+=2;
}else{
if(c<=65535){
_9+=3;
if((c>>11)==27){
_9++;
i++;
}
}else{
_9+=4;
}
}
}
}
return _9;
},getCharIndexForUtf8Index:function(s,_b){
var _c=0;
var _d=s.length;
for(var i=0;i<_d;i++){
var c=s.charCodeAt(i);
if(c<=127){
_c++;
}else{
if(c<=2047){
_c+=2;
}else{
if(c<=65535){
_c+=3;
if((c>>11)==27){
_c++;
i++;
}
}else{
_c+=4;
}
}
}
if(_c>_b){
return i;
}
}
return -1;
},encodeHeaderUtf8:function(s){
return "=?UTF-8?Q?"+encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,"=$1")+"?=";
},decodeSpecialHtmlChars:function(_e){
if(!_e){
return "";
}
var _f=dojo.doc.createElement("textarea");
_f.innerHTML=_e.replace(/</g,"&lt;").replace(/>/g,"&gt;");
return _f.value;
},base64Encode:function(_10){
var _11=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];
if(!_10){
return "";
}
var _12=com.ibm.social.incontext.util.text.getUTF8ByteArray(_10);
var _13="";
var _14=0;
var _15=0;
for(;_14<_12.length-2;_14+=3){
_13+=_11[_12[_14]>>>2&63];
_15++;
_13+=_11[_12[_14+1]>>>4&15|_12[_14]<<4&63];
_15++;
_13+=_11[_12[_14+2]>>>6&3|_12[_14+1]<<2&63];
_15++;
_13+=_11[_12[_14+2]&63];
_15++;
}
if(_14<_12.length){
_13+=_11[_12[_14]>>>2&63];
_15++;
if(_14<_12.length-1){
_13+=_11[_12[_14+1]>>>4&15|_12[_14]<<4&63];
_15++;
_13+=_11[_12[_14+1]<<2&63];
_15++;
}else{
_13+=_11[_12[_14]<<4&63];
_15++;
}
}
var _16=Math.floor(((_12.length+2)/3)*4-1);
if(_16%4==1){
_16--;
}else{
if(_16%4==3){
_16++;
}
}
for(;_15<_16;_15++){
_13+="=";
}
return _13;
},getUTF8ByteArray:function(str){
if(!str){
return [];
}
var _17=[];
for(var i=0;i<str.length;i++){
var _18=str.charCodeAt(i);
if(_18>=0&&_18<128){
_17[_17.length]=_18;
}else{
if(_18>=128&&_18<2048){
_17[_17.length]=192|((_18>>>6)&31);
_17[_17.length]=128|(_18&63);
}else{
if(_18>=2048&&_18<65536){
_17[_17.length]=224|((_18>>>12)&15);
_17[_17.length]=128|((_18>>>6)&63);
_17[_17.length]=128|(_18&63);
}else{
if(_18>=65536&&_18<=1114111){
_17[_17.length]=240|((_18>>>18)&7);
_17[_17.length]=128|((_18>>>12)&63);
_17[_17.length]=128|((_18>>>6)&63);
_17[_17.length]=128|(_18&63);
}else{
_17[_17.length]=-1;
}
}
}
}
}
return _17;
},breakString:function(s,d,el,_19,_1a){
if(!s){
return;
}
var _1b=5;
var _1c=function(el,s){
if(!s){
return;
}
if(_1a){
var br=/\n/g;
if(br.test(s)){
var _1d;
while((_1d=s.indexOf("\n"))!=-1){
if(_1d>0){
el.appendChild(d.createTextNode(s.substring(0,_1d)));
}
dojo.create("br",{},el);
s=s.substring(_1d+1);
}
if(s){
el.appendChild(d.createTextNode(s));
}
}else{
el.appendChild(d.createTextNode(s));
}
}else{
el.appendChild(d.createTextNode(s));
}
};
_19=_19||10;
var b=new RegExp("[^\\s]{"+(_19+1)+",}","g");
var _1e=/\s*(\S*)$/;
var r;
var _1f=0,end,tmp,_20,_21,_22,i,_23,_24,_25,str,_26,_27;
var _28=(dojo.isIE||dojo.isWebKit)?"":"\u200b";
while(r=b.exec(s)){
end=b.lastIndex;
tmp=s.substring(_1f,end);
_20=_1e.exec(tmp)[1];
_1c(el,s.substring(_1f,end-_20.length));
_21=Math.floor(_20.length/_19);
_22=0;
_24=_20.length%_19;
if(_24&&_24<_1b){
_21--;
_22=_19-(_1b-(_20.length%_19));
}
var _23=0;
var _29=0;
for(i=0;i<_21;i++){
_27=_23+_19-_29;
_29=0;
_26=_20.charCodeAt(_27-1);
if(_26>=55296&&_26<56192){
_29=1;
}
_25=!(i===_21-1&&!_22&&!_24);
str=_20.substring(_23,_27+_29);
_1c(el,str+(_25?_28:""));
if(!_28&&_25){
el.appendChild(d.createElement("wbr"));
}
_23+=str.length;
}
if(_22){
_23=_20.length-_1b-_22;
_27=_23+_22;
_23+=_29;
_29=0;
_26=_20.charCodeAt(_27-1);
if(_26>=55296&&_26<56192){
_29=1;
}
str=_20.substring(_23,_27+_29);
_1c(el,str+_28);
if(!_28){
el.appendChild(d.createElement("wbr"));
}
}
if(_24){
if(_22){
_1c(el,_20.substring(_20.length-_1b+_29,_20.length));
}else{
_1c(el,_20.substring(_20.length-_24+_29,_20.length));
}
}
_1f=end;
}
_1c(el,s.substring(end));
},breakStringHTML:function(el,len){
var _2a=this;
var _2b=[];
_2b.push(el);
if(!len){
len=10;
}
while(_2b.length){
var _2c=_2b.pop();
var _2d=[];
dojo.forEach(_2c.childNodes,function(_2e){
_2d.push(_2e);
});
dojo.forEach(_2d,function(_2f){
if(_2f.nodeType==3){
var _30=dojo.create("span");
_2a.breakString(_2f.nodeValue,dojo.doc,_30,len);
var _31=[];
dojo.forEach(_30.childNodes,function(_32){
_31.push(_32);
});
dojo.forEach(_31,function(_33){
_2f.parentNode.insertBefore(_33,_2f);
});
_2f.parentNode.removeChild(_2f);
}else{
if((_2f.nodeType==1)&&(_2f.childNodes.length>0)){
_2b.push(_2f);
}
}
});
}
}};
}


;if(!dojo._hasResource["com.ibm.social.incontext.util._dom"]){
dojo._hasResource["com.ibm.social.incontext.util._dom"]=true;
dojo.provide("com.ibm.social.incontext.util._dom");
(function(){
com.ibm.social.incontext.util.dom={XML_DECLARATION:"<?xml version=\"1.0\" encoding=\"UTF-8\"?>",XML_DECLARATION_WITH_ENTITIES:"<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE html [<!ENTITY amp \"&#38;#38;\"><!ENTITY lt \"&#60;#60;\"><!ENTITY gt \"&#62;#62;\"><!ENTITY nbsp \"&#32;\"><!ENTITY apos \"&#39;\"><!ENTITY quot \"&#34;\">]>",NAMESPACES:{ATOM:{LONG:"http://www.w3.org/2005/Atom",SHORT:"atom"},DOCUMENTS_ATOM:{LONG:"urn:ibm.com/td",SHORT:"td"},APP:{LONG:"http://www.w3.org/2007/app",SHORT:"app"},CMISRA:{LONG:"http://docs.oasis-open.org/ns/cmis/restatom/200908/",SHORT:"cmisra"},CMISM:{LONG:"http://docs.oasis-open.org/ns/cmis/messaging/200908/",SHORT:"cmism"},LCMIS:{LONG:"http://www.ibm.com/xmlns/prod/sn/cmis",SHORT:"lcmis"},CMIS:{LONG:"http://docs.oasis-open.org/ns/cmis/core/200908/",SHORT:"cmis"}},NAMESPACE_PREFIX:{},xmlText:function(_1){
return (_1)?(dojo.isIE?(_1.text?_1.text:(_1.innerText?_1.innerText:_1.textContent)):_1.textContent):_1;
},isNamedNS:function(el,_2,_3){
if(dojo.isIE){
if(_3){
return el.baseName==_2&&_3.LONG==el.namespaceURI;
}
return el.nodeName==_2;
}
if(_3){
return el.localName==_2&&_3.LONG==el.namespaceURI;
}
return el.nodeName==_2;
},getChildElementTextContentNS:function(el,_4,_5){
if(!el){
return null;
}
var c;
var _6=el.childNodes;
if(dojo.isIE){
for(var i=0;c=_6[i];i++){
if(c.baseName==_4&&(_5===null||c.namespaceURI==_5.LONG)){
if(c.innerText){
return c.innerText;
}
var a=[];
for(var j=0,c2;c2=c.childNodes[j];j++){
if(c2.nodeType==3){
a.push(c2.nodeValue);
}
}
return a.join("");
}
}
}else{
var _6=el.getElementsByTagNameNS(_5.LONG,_4);
for(var i=0,c;c=_6[i];i++){
if(c.parentNode==el){
if(c.textContent){
return c.textContent;
}
var a=[];
for(var j=0,c2;c2=c.childNodes[j];j++){
if(c2.nodeType==3){
a.push(c2.nodeValue);
}
}
return a.join("");
}
}
}
return null;
}};
var _7=com.ibm.social.incontext.util.dom,n1=_7.NAMESPACES;
for(var _8 in n1){
var _9=n1[_8];
_7[_8+"_NAMESPACE"]=_9;
_7.NAMESPACE_PREFIX[_9.SHORT]=_9.LONG;
}
})();
}


;if(!dojo._hasResource["com.ibm.social.incontext.util.dom"]){
dojo._hasResource["com.ibm.social.incontext.util.dom"]=true;
dojo.provide("com.ibm.social.incontext.util.dom");


(function(){
var _1=com.ibm.social.incontext.util.dom,n1=_1.NAMESPACES,_2,_3;
n1.XML={LONG:"http://www.w3.org/XML/1998/namespace",SHORT:"xml"};
n1.DOCUMENTS_ATOM_BATCH={LONG:"urn:ibm.com/td/batch",SHORT:"batch"};
n1.OPENSEARCH={LONG:"http://a9.com/-/spec/opensearch/1.1/",SHORT:"opensearch"};
n1.THREAD_ATOM={LONG:"http://purl.org/syndication/thread/1.0",SHORT:"thr"};
n1.CA={LONG:"http://www.ibm.com/xmlns/prod/composite-applications/v1.0",SHORT:"ca"};
n1.SNX={LONG:"http://www.ibm.com/xmlns/prod/sn",SHORT:"snx"};
n1.XRD={LONG:"xri://$XRD*($v*2.0)",SHORT:"xrd"};
n1.ATOM={LONG:"http://www.w3.org/2005/Atom",SHORT:"atom"};
n1.APP={LONG:"http://www.w3.org/2007/app",SHORT:"app"};
n1.CMIS={LONG:"http://docs.oasis-open.org/ns/cmis/core/200908/",SHORT:"cmis"};
n1.CMISM={LONG:"http://docs.oasis-open.org/ns/cmis/messaging/200908/",SHORT:"cmism"};
n1.CMISRA={LONG:"http://docs.oasis-open.org/ns/cmis/restatom/200908/",SHORT:"cmisra"};
n1.LCMIS={LONG:"http://www.ibm.com/xmlns/prod/sn/cmis",SHORT:"lcmis"};
_1.SELECTION_NAMESPACES=[];
if(n1){
for(_2 in n1){
_3=n1[_2];
_1[_2+"_NAMESPACE"]=_3;
_1.NAMESPACE_PREFIX[_3.SHORT]=_3.LONG;
_1.SELECTION_NAMESPACES.push("xmlns:"+_3.SHORT+"='"+_3.LONG+"'");
}
}
_1.SELECTION_NAMESPACES=_1.SELECTION_NAMESPACES.join(" ");
_1.xpathNSResolver=function(ns){
return _1.NAMESPACE_PREFIX[ns];
};
_1.xpathNumber=function(_4,_5){
if(!_4){
return NaN;
}
return this.xpath(_4,_5,"number");
};
_1.xpathString=function(_6,_7){
if(!_6){
return "";
}
return this.xpath(_6,_7,"string");
};
_1.xpathNode=function(_8,_9){
if(!_8){
return null;
}
return this.xpath(_8,_9,"node");
};
_1.xpathNodes=function(_a,_b){
if(!_a){
return [];
}
return this.xpath(_a,_b,"nodes");
};
_1.xpath=function(_c,_d,_e){
if(!_c){
return null;
}
var _f=null,_10,a,c,i,_11,tmp;
if(dojo.isIE){
switch(_e){
case "number":
case "string":
_10=_c.selectNodes(_d);
if(_10.length==1&&_10[0].text){
_f=_10[0].text;
}else{
a=[],c=null;
for(i=0;c=_10[i];i++){
if(c.nodeType==3){
a.push(c.nodeValue);
}
}
_f=a.join("");
}
if(_e=="number"){
_f=parseInt(_f);
}
break;
case "node":
_11=_c.selectNodes(_d);
_f=_11?_11[0]:null;
break;
default:
_f=_c.selectNodes(_d);
break;
}
}else{
switch(_e){
case "number":
_f=_c.ownerDocument.evaluate(_d,_c,_1.xpathNSResolver,XPathResult.NUMBER_TYPE,null).numberValue;
break;
case "string":
_f=_c.ownerDocument.evaluate(_d,_c,_1.xpathNSResolver,XPathResult.STRING_TYPE,null).stringValue;
break;
case "node":
_f=_c.ownerDocument.evaluate(_d,_c,_1.xpathNSResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;
break;
case "nodes":
_10=_c.ownerDocument.evaluate(_d,_c,_1.xpathNSResolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);
_f=[];
while(tmp=_10.iterateNext()){
_f.push(tmp);
}
break;
default:
_10=_c.ownerDocument.evaluate(_d,_c,_1.xpathNSResolver,XPathResult.ANY_TYPE,null);
_f=[];
while(tmp=_10.iterateNext()){
_f.push(tmp);
}
break;
}
}
return _f;
};
_1.prependXmlProlog=function(xml){
if(/^\s*<\?xml\s/.test(xml)){
xml=xml.substring(xml.indexOf("?>")+2);
}
return _1.XML_DECLARATION+xml;
};
_1.serializeXMLDocument=function(doc,_12){
var s;
if(doc.xml){
s=doc.xml;
}else{
s=new XMLSerializer().serializeToString(doc);
}
if(!_12){
if(/^\s*<\?xml\s/.test(s)){
s=s.substring(s.indexOf("?>")+2);
}
}else{
s=_1.prependXmlProlog(s);
}
return s;
};
_1.newXMLDocument=function(_13,_14,_15){
if(!_13){
_13="";
}
var _16="",doc,_17,_18,p,_19,i;
if(_14){
if(_14.LONG){
_16=_14.LONG;
}else{
_16=_14;
}
}
if(document.implementation&&document.implementation.createDocument&&!dojo.isIE){
return document.implementation.createDocument(_16,_13,null);
}else{
doc=new ActiveXObject("MSXML2.DOMDocument");
if(_13){
_17="";
_18=_13;
p=_13.indexOf(":");
if(p!=-1){
_17=_13.substring(0,p);
_18=_13.substring(p+1);
}
if(!_17&&_14&&_14.SHORT){
_17=_14.SHORT;
}else{
_17=null;
}
_19="<"+(_17?(_17+":"):"")+_18+(_16?(" xmlns"+(_17?(":"+_17):"")+"=\""+_16+"\""):"");
if(_15){
for(i=0;i<_15.length;i++){
_19+=" xmlns:"+_15[i].SHORT+"=\""+_15[i].LONG+"\"";
}
}
_19+="/>";
doc.loadXML(_19);
}
return doc;
}
};
_1.xmlDocumentFromString=function(str){
if(!str){
return _1.newXMLDocument();
}
var doc,url,_1a;
if(typeof DOMParser!="undefined"){
return (new DOMParser()).parseFromString(str,"application/xml");
}else{
if(typeof ActiveXObject!="undefined"){
doc=new ActiveXObject("MSXML2.DOMDocument");
doc.loadXML(str);
return doc;
}else{
url="data:text/xml;charset=utf-8,"+encodeURIComponent(str);
_1a=new XMLHttpRequest();
_1a.open("GET",url,false);
_1a.send(null);
return _1a.responseXML;
}
}
};
_1.getElementByLanguage=function(_1b,_1c){
var c,i,j,_1d,_1e=[_1c];
while((i=_1c.lastIndexOf("-"))!=-1){
_1e.push(_1c=_1c.substring(0,i));
}
if(dojo.indexOf(_1e,"en-us")==-1){
_1e.push("en-us");
}
if(dojo.indexOf(_1e,"en")==-1){
_1e.push("en");
}
if(dojo.indexOf(_1e,"")==-1){
_1e.push("");
}
for(i=0;i<_1e.length;i++){
for(j=0;c=_1b[j];j++){
_1d=(dojo.isIE)?c.getAttribute(_1.XML_NAMESPACE.SHORT+":lang"):c.getAttributeNS(_1.XML_NAMESPACE.LONG,"lang");
_1d=_1d?_1d:"";
if(_1d==_1e[i]){
return c;
}
}
}
return null;
};
_1.getAttributeNS=function(el,_1f,_20){
return (dojo.isIE)?el.getAttribute(_20.SHORT+":"+_1f):el.getAttributeNS(_20.LONG,_1f);
};
_1._getNSPrefix=function(el,_21){
var _22,_23;
for(_22=el,_23=null;_22&&!_23&&_22.nodeType==1;_22=_22.parentNode){
_23=_22.getAttribute("xmlns");
}
return (_23==_21.LONG)?"":(_21.SHORT+":");
};
_1.getElementsByTagNameNS=function(el,_24,_25){
return (dojo.isIE)?el.getElementsByTagName(this._getNSPrefix(el,_25)+_24):el.getElementsByTagNameNS(_25.LONG,_24);
};
_1.createElementNS=function(d,_26,_27){
return (dojo.isIE)?d.createElement(_27.SHORT+":"+_26):d.createElementNS(_27.LONG,_26);
};
_1.setAttributeNS=function(el,_28,_29,_2a){
(dojo.isIE)?el.setAttribute(_2a.SHORT+":"+_28,_29):el.setAttributeNS(_2a.LONG,_2a.SHORT+":"+_28,_29);
};
_1.insertBefore=function(el,_2b,_2c){
(_2c)?el.insertBefore(_2b,_2c):el.appendChild(_2b);
return _2b;
};
_1.getChildElement=function(el,_2d){
var arr=el.childNodes,i,c;
for(i=0;c=arr[i];i++){
if(c.nodeName==_2d||c.localName==_2d){
return c;
}
}
};
_1.getChildElementNS=function(el,_2e,_2f){
var arr=(dojo.isIE)?el.getElementsByTagName(_1._getNSPrefix(el,_2f)+_2e):el.getElementsByTagNameNS(_2f.LONG,_2e),i,c;
for(i=0;c=arr[i];i++){
if(c.parentNode==el){
return c;
}
}
};
_1.getChildElementTextContent=function(el,_30){
if(!el){
return null;
}
var arr=el.getElementsByTagName(_30),i,c;
for(i=0;c=arr[i];i++){
if(c.parentNode==el){
return _1.getTextContent(c);
}
}
return null;
};
_1.getChildElementTextContentNS=function(el,_31,_32){
return _1.getTextContent(_1.getChildElementNS(el,_31,_32));
};
_1.getTextContent=function(el){
if(!el){
return null;
}
if(el.textContent){
return el.textContent;
}
if(el.innerText){
return el.innerText;
}
var a=[],j,c;
for(j=0;c=el.childNodes[j];j++){
if(c.nodeType==4||c.nodeType==3){
a.push(c.nodeValue);
}
}
return a.join("");
};
_1.getChildElementAttribute=function(_33,_34,_35){
if(!_33){
return null;
}
if(_35=="class"&&dojo.isIE){
_35="className";
}
var arr=_33.getElementsByTagName(_34),i,c;
for(i=0;c=arr[i];i++){
if(c.parentNode==_33){
return c.getAttribute(_35);
}
}
return null;
};
_1.getChildElementNSAttribute=function(_36,_37,_38,_39){
if(!_36||!_39){
return null;
}
if(!_38){
return _1.getChildElementAttribute(_36,_37,_39);
}
if(dojo.isIE){
if(_39=="class"){
_39="className";
}
}
var el=_1.getChildElementNS(_36,_37,_38);
if(el){
return el.getAttribute(_39);
}
return null;
};
_1.getChildElementAttributeNS=function(_3a,_3b,_3c,_3d,_3e){
if(!_3a){
return null;
}
var c,i,arr;
if(dojo.isIE){
if(_3d=="class"){
_3d="className";
}
for(i=0;c=_3a.childNodes[i];i++){
if(c.baseName==_3b&&(_3c==null||c.namespaceURI==_3c.LONG)){
return c.getAttribute(_3e.SHORT+":"+_3d);
}
}
}else{
if(_3c){
arr=_3a.getElementsByTagNameNS(_3c.LONG,_3b);
for(i=0;c=arr[i];i++){
if(c.parentNode==_3a){
return c.getAttributeNS(_3e.LONG,_3d);
}
}
}else{
arr=_3a.getElementsByTagName(_3b);
for(i=0;c=arr[i];i++){
if(c.parentNode==_3a){
return c.getAttributeNS(_3e.LONG,_3d);
}
}
}
}
return null;
};
_1.getChildElementAttributeMatching=function(_3f,_40,_41,_42,_43){
if(!_3f){
return null;
}
if(_41=="class"&&dojo.isIE){
_41="className";
}
if(_43=="class"&&document.all){
_43="className";
}
var arr=_3f.getElementsByTagName(_40),i,_44;
for(i=0;_44=arr[i];i++){
if(_44.getAttribute(_41)==_42){
return _44.getAttribute(_43);
}
}
return null;
};
_1.getChildElementAttributeMatchingNS=function(_45,_46,_47,_48,_49,_4a,_4b,_4c){
var _4d,_4e,_4f,arr,i,c;
if(!_45){
return null;
}
if(_48=="class"&&dojo.isIE){
_48="className";
}
if(_4b=="class"&&document.all){
_4b="className";
}
if(dojo.isIE){
_4d=_47?this._getNSPrefix(_45,_47)+_46:_46;
_4e=_49?_49.SHORT+":"+_48:_48;
_4f=_4c?_4c.SHORT+":"+_4b:_4b;
arr=_45.getElementsByTagName(_4d);
for(i=0;c=arr[i];i++){
if(c.getAttribute(_4e)==_4a){
return c.getAttribute(_4f);
}
}
}else{
if(_47){
arr=_45.getElementsByTagNameNS(_47.LONG,_46);
if(_49){
for(i=0;c=arr[i];i++){
if(c.getAttributeNS(_49.LONG,_48)==_4a){
return _4c?c.getAttributeNS(_4c.LONG,_4b):c.getAttribute(_4b);
}
}
}else{
for(i=0;c=arr[i];i++){
if(c.getAttribute(_48)==_4a){
return _4c?c.getAttributeNS(_4c.LONG,_4b):c.getAttribute(_4b);
}
}
}
}else{
arr=_45.getElementsByTagName(_46);
if(_49){
for(i=0;child=arr[i];i++){
if(child.getAttributeNS(_49.LONG,_48)==_4a){
return _4c?c.getAttributeNS(_4c.LONG,_4b):c.getAttribute(_4b);
}
}
}else{
for(i=0;child=arr[i];i++){
if(child.getAttribute(_48)==_4a){
return _4c?c.getAttributeNS(_4c.LONG,_4b):c.getAttribute(_4b);
}
}
}
}
}
return null;
};
_1.getChildElementMatchingAttribute=function(_50,_51,_52,_53){
if(!_50){
return null;
}
if(_52=="class"&&dojo.isIE){
_52="className";
}
var arr=_50.getElementsByTagName(_51),i;
for(i=0;child=arr[i];i++){
if(child.getAttribute(_52)==_53){
return child;
}
}
return null;
};
_1.getChildElementMatchingAttributeNS=function(_54,_55,_56,_57,_58,_59){
if(!_54){
return null;
}
var _5a,_5b,arr,i,c;
if(_57=="class"&&dojo.isIE){
_57="className";
}
if(dojo.isIE){
_5a=_56?this._getNSPrefix(_54,_56)+_55:_55;
_5b=_58?_58.SHORT+":"+_57:_57;
arr=_54.getElementsByTagName(_5a);
for(i=0;c=arr[i];i++){
if(c.getAttribute(_5b)==_59){
return c;
}
}
}else{
if(_56){
arr=_54.getElementsByTagNameNS(_56.LONG,_55);
if(_58){
for(i=0;c=arr[i];i++){
if(c.getAttributeNS(_58.LONG,_57)==_59){
return c;
}
}
}else{
for(i=0;c=arr[i];i++){
if(c.getAttribute(_57)==_59){
return c;
}
}
}
}else{
arr=_54.getElementsByTagName(_55);
if(_58){
for(i=0;child=arr[i];i++){
if(child.getAttributeNS(_58.LONG,_57)==_59){
return c;
}
}
}else{
for(i=0;child=arr[i];i++){
if(child.getAttribute(_57)==_59){
return c;
}
}
}
}
}
return null;
};
_1.getChildElementMatchingAttributeTextContent=function(_5c,_5d,_5e,_5f){
if(!_5c){
return null;
}
var arr,i,_60;
if(_5e=="class"&&dojo.isIE){
_5e="className";
}
arr=_5c.getElementsByTagName(_5d);
for(i=0;_60=arr[i];i++){
if(_60.getAttribute(_5e)==_5f){
return _1.xmlText(_60);
}
}
return null;
};
_1.getChildElementMatchingAttributeTextContentNS=function(_61,_62,_63,_64,_65,_66){
if(!_61){
return null;
}
var _67,_68,_69,arr,i;
if(dojo.isIE){
if(_64=="class"){
_64="className";
}
_68=_63==null?_62:_63.SHORT+":"+_62;
_69=_65==null?_64:_65.SHORT+":"+_64;
arr=_61.getElementsByTagName(_68);
for(i=0;_67=arr[i];i++){
if(_67.parentNode==_61&&_67.getAttribute(_69)==_66){
return _1.xmlText(_67);
}
}
}else{
if(_63){
arr=_61.getElementsByTagNameNS(_63.LONG,_62);
if(_65){
for(i=0;_67=arr[i];i++){
if(_67.parentNode==_61&&_67.getAttributeNS(_65.LONG,_64)==_66){
return _1.xmlText(_67);
}
}
}else{
for(i=0;_67=arr[i];i++){
if(_67.parentNode==_61&&_67.getAttribute(_64)==_66){
return _1.xmlText(_67);
}
}
}
}else{
arr=_61.getElementsByTagName(_62);
if(_65){
for(i=0;_67=arr[i];i++){
if(_67.parentNode==_61&&_67.getAttributeNS(_65.LONG,_64)==_66){
return _1.xmlText(_67);
}
}
}else{
for(i=0;_67=arr[i];i++){
if(_67.parentNode==_61&&_67.getAttribute(_64)==_66){
return _1.xmlText(_67);
}
}
}
}
}
return null;
};
_1.domNodesToXml=function(_6a){
var doc,_6b,i,_6c;
if(_6a&&_6a.length>0){
if(_6a.length>1){
doc=_1.newXMLDocument("div");
_6b=doc.documentElement;
}
for(i=0;i<_6a.length;i++){
_6c=_6a.item(i);
doc=_1.domToXml(_6c,_6b,doc);
}
}else{
doc=_1.newXMLDocument("div");
}
return _1.XML_DECLARATION_WITH_ENTITIES+_1.serializeXMLDocument(doc);
};
_1.domToXml=function(_6d,_6e,doc){
var _6f,_70,_71,isA,_72,i,_73,_3,_74,_75;
if(_6d.nodeType==3){
if(!_6e){
doc=_1.newXMLDocument("div");
_6e=doc.documentElement;
}
_6e.appendChild(doc.createTextNode(_6d.nodeValue));
return doc;
}
_70=_6d.nodeName.toLowerCase();
if(!doc){
doc=_1.newXMLDocument(_70);
_6f=doc.documentElement;
}else{
_6f=doc.createElement(_70);
_6e.appendChild(_6f);
}
_71=_6d.attributes;
if(_71&&_71.length>0){
isA=_70=="a";
_72=_70=="img";
for(i=0;i<_71.length;i++){
_73=_71.item(i);
if(_73.specified){
if((_72&&_73.name=="src")||(isA&&_73.name=="href")){
_3=_6d.getAttribute("_fcksavedurl");
_6f.setAttribute(_73.name,_3);
}else{
_6f.setAttribute(_73.name,_73.value);
}
}
}
}
_74=_6d.childNodes;
if(_74&&_74.length>0){
for(i=0;i<_74.length;i++){
_75=_74.item(i);
_1.domToXml(_75,_6f,doc);
}
}
return doc;
};
_1.setTextNode=function(d,loc,_76){
if(loc.firstChild){
dojo.destroy(loc.firstChild);
}
loc.appendChild(d.createTextNode(_76||""));
};
_1.getChildElementsNS=function(el,_77,_78){
var arr=(dojo.isIE)?el.getElementsByTagName(_1._getNSPrefix(el,_78)+_77):el.getElementsByTagNameNS(_78.LONG,_77),_79=[],i,c;
for(i=0;c=arr[i];i++){
if(c.parentNode==el){
_79.push(c);
}
}
return _79;
};
_1.getElementMatchingAttributeValueNS=function(_7a,_7b,_7c,_7d,_7e,_7f){
var _80=_1.getElementsByTagNameNS(_7a,_7b,_7c),_81=_7e==null?_7d:_7e.SHORT+":"+_7d,i;
for(i=0;i<_80.length;i++){
if((_80[i].nodeType==1)&&(_80[i].getAttribute(_81)==_7f)){
return _80[i];
}
}
return null;
};
})();
}

if(typeof define!=="undefined"&&typeof define._packages!=="undefined")define._packages["com.ibm.social.ee"]=true;

;if(!dojo._hasResource["com.ibm.social.ee.data.DomBuilder"]){
dojo._hasResource["com.ibm.social.ee.data.DomBuilder"]=true;
dojo.provide("com.ibm.social.ee.data.DomBuilder");




(function(){
var du=com.ibm.social.incontext.util.dom;
var tu=com.ibm.social.incontext.util.text;
dojo.declare("com.ibm.social.ee.data.DomBuilder",null,{getPostViewDefBody:function(_1){
var i,_2,_3,_4=du.newXMLDocument("entry",du.ATOM_NAMESPACE,[du.DOCUMENTS_ATOM_NAMESPACE]);
var _5=_4.documentElement;
if(_1.title){
_3=du.createElementNS(_4,"title",du.ATOM_NAMESPACE);
_3.setAttribute("type","text");
_3.appendChild(_4.createTextNode(_1.title));
_5.appendChild(_3);
}
if(_1.titleKey){
_2=du.createElementNS(_4,"titleKey",du.DOCUMENTS_ATOM_NAMESPACE);
_2.appendChild(_4.createTextNode(_1.titleKey));
_5.appendChild(_2);
}
if(_1.description&&typeof _1.description=="string"){
var _6=du.createElementNS(_4,"summary",du.ATOM_NAMESPACE);
_6.setAttribute("type","text");
_6.appendChild(_4.createTextNode(_1.description));
_5.appendChild(_6);
}
if(_1.descriptionKey&&typeof _1.descriptionKey=="string"){
var _7=du.createElementNS(_4,"summaryKey",du.DOCUMENTS_ATOM_NAMESPACE);
_7.setAttribute("type","text");
_7.appendChild(_4.createTextNode(_1.descriptionKey));
_5.appendChild(_7);
}
if(_1.category){
var _8=du.createElementNS(_4,"category",du.ATOM_NAMESPACE);
_8.setAttribute("term",_1.category);
_8.setAttribute("label",_1.category);
_8.setAttribute("scheme","tag:ibm.com,2006:td/type");
_5.appendChild(_8);
}
if(_1.propertySheetTypeId){
var _9=du.createElementNS(_4,"propertySheetTypeId",du.DOCUMENTS_ATOM_NAMESPACE);
_9.appendChild(_4.createTextNode(_1.propertySheetTypeId));
_5.appendChild(_9);
}
if(_1.sortOrder){
var _a=du.createElementNS(_4,"sortOrder",du.DOCUMENTS_ATOM_NAMESPACE);
_a.appendChild(_4.createTextNode(_1.sortOrder));
_5.appendChild(_a);
}
if(_1.sortId){
var _b=du.createElementNS(_4,"sortId",du.DOCUMENTS_ATOM_NAMESPACE);
_b.appendChild(_4.createTextNode(_1.sortId));
_5.appendChild(_b);
}
if(_1.columns||_1.conditions){
var _c=du.createElementNS(_4,"content",du.ATOM_NAMESPACE);
_c.setAttribute("type","application/xml");
var _d=du.createElementNS(_4,"viewContent",du.DOCUMENTS_ATOM_NAMESPACE);
if(_1.columns){
var _e=du.createElementNS(_4,"columns",du.DOCUMENTS_ATOM_NAMESPACE);
for(i=0;i<_1.columns.length;i++){
var _f=_1.columns[i];
var _10=du.createElementNS(_4,"column",du.DOCUMENTS_ATOM_NAMESPACE);
if(_f.getColumnId&&_f.getColumnId()){
var _11=du.createElementNS(_4,"columnId",du.DOCUMENTS_ATOM_NAMESPACE);
_11.appendChild(_4.createTextNode(_f.getColumnId()));
_10.appendChild(_11);
}
if(_f.getTitle()){
_3=du.createElementNS(_4,"title",du.DOCUMENTS_ATOM_NAMESPACE);
_3.appendChild(_4.createTextNode(_f.getTitle()));
_10.appendChild(_3);
}
if(_f.getTitleKey()){
_2=du.createElementNS(_4,"titleKey",du.DOCUMENTS_ATOM_NAMESPACE);
_2.appendChild(_4.createTextNode(_f.getTitleKey()));
_10.appendChild(_2);
}
if(_f.getWidth()){
var _12=du.createElementNS(_4,"width",du.DOCUMENTS_ATOM_NAMESPACE);
_12.appendChild(_4.createTextNode(_f.getWidth()));
_10.appendChild(_12);
}
var _13=du.createElementNS(_4,"field",du.DOCUMENTS_ATOM_NAMESPACE);
if(_f.getStandardField()){
_13.setAttribute("standardField",_f.getStandardField());
}else{
if(_f.getPropSheetFieldId()){
_13.setAttribute("propSheetFieldId",_f.getPropSheetFieldId());
}
}
_10.appendChild(_13);
_e.appendChild(_10);
}
_d.appendChild(_e);
}
if(_1.conditions){
var _14=du.createElementNS(_4,"filter",du.DOCUMENTS_ATOM_NAMESPACE);
var _15=du.createElementNS(_4,"predicate",du.DOCUMENTS_ATOM_NAMESPACE);
if(_1.conditions.conditionalOperator){
_15.setAttribute("conditionalOperator",_1.conditions.conditionalOperator);
}else{
_15.setAttribute("conditionalOperator","and");
}
for(i=0;i<_1.conditions.length;i++){
var _16=_1.conditions[i];
if(_16.getValue()){
var _17=du.createElementNS(_4,"condition",du.DOCUMENTS_ATOM_NAMESPACE);
_17.setAttribute("dataOperator",_16.getOp());
var _18=du.createElementNS(_4,"leftAttribute",du.DOCUMENTS_ATOM_NAMESPACE);
if(_16.isStdField()){
_18.setAttribute("standardField",_16.getFieldId());
}else{
_18.setAttribute("propSheetFieldId",_16.getFieldId());
}
_17.appendChild(_18);
var _19=du.createElementNS(_4,"rightValue",du.DOCUMENTS_ATOM_NAMESPACE);
_19.setAttribute("value",_16.getValue());
_17.appendChild(_19);
_15.appendChild(_17);
}
}
if(_15.childNodes&&_15.childNodes.length>0){
_14.appendChild(_15);
}
if(_14.childNodes&&_14.childNodes.length>0){
_d.appendChild(_14);
}
}
_c.appendChild(_d);
}
if(_c!==null){
_5.appendChild(_c);
}
var _1a=du.XML_DECLARATION+du.serializeXMLDocument(_4);
return tu.trim(_1a);
},getPostACLBody:function(_1b){
var doc=du.newXMLDocument("entry",du.ATOM_NAMESPACE,[du.DOCUMENTS_ATOM_NAMESPACE,du.SNX_NAMESPACE]);
var _1c=doc.documentElement;
if(_1b.category){
var _1d=du.createElementNS(doc,"category",du.ATOM_NAMESPACE);
_1d.setAttribute("term",_1b.category);
_1d.setAttribute("label",_1b.category);
_1d.setAttribute("scheme","tag:ibm.com,2006:td/type");
_1c.appendChild(_1d);
}
if(_1b.sharedWhat){
var _1e=du.createElementNS(doc,"sharedWhat",du.DOCUMENTS_ATOM_NAMESPACE);
_1e.appendChild(doc.createTextNode(_1b.sharedWhat));
_1c.appendChild(_1e);
}
if(_1b.sharedWith&&_1b.sharedWith.length>0){
for(var i=0;i<_1b.sharedWith.length;i++){
if(_1b.sharedWith[i].users&&_1b.sharedWith[i].users.length>0&&_1b.sharedWith[i].sharePermission&&_1b.sharedWith[i].sharePermission!==""){
var _1f=du.createElementNS(doc,"sharedWith",du.DOCUMENTS_ATOM_NAMESPACE);
for(var j=0;j<_1b.sharedWith[i].users.length;j++){
var _20=du.createElementNS(doc,"user",du.DOCUMENTS_ATOM_NAMESPACE);
var uri=du.createElementNS(doc,"userid",du.SNX_NAMESPACE);
uri.appendChild(doc.createTextNode(encodeURIComponent(_1b.sharedWith[i].users[j].id)));
_20.appendChild(uri);
_1f.appendChild(_20);
}
var _21=du.createElementNS(doc,"sharePermission",du.DOCUMENTS_ATOM_NAMESPACE);
_21.appendChild(doc.createTextNode(_1b.sharedWith[i].sharePermission));
_1f.appendChild(_21);
_1c.appendChild(_1f);
}
}
}
if(_1b.sharePermission){
var _22=du.createElementNS(doc,"sharePermission",du.DOCUMENTS_ATOM_NAMESPACE);
_22.appendChild(doc.createTextNode(_1b.sharePermission));
_1c.appendChild(_22);
}
if(typeof _1b.description=="string"&&_1b.description!==null){
var _23=du.createElementNS(doc,"summary",du.ATOM_NAMESPACE);
_23.setAttribute("type","text");
_23.appendChild(doc.createTextNode(_1b.description));
_1c.appendChild(_23);
}
var _24=du.XML_DECLARATION+du.serializeXMLDocument(doc);
return tu.trim(_24);
},propertyMapToFormContents:function(_25,_26){
if(_25&&_26){
var cnt=0;
if(_25){
for(var _27 in _25){
var pst=_25[_27];
if(pst){
for(var fid in pst){
_26["snxFid_"+cnt]=fid;
_26["snxPstId_"+cnt]=_27;
var _28=pst[fid].value;
if(dojo.isArray(_28)){
for(var i=0;i<_28.length;i++){
_26["snxValue_"+cnt+"_"+i]=_28[i];
}
}else{
_26["snxValue_"+cnt+"_0"]=_28;
}
cnt++;
}
}
_26.snxPstfCount=cnt;
}
}
}
},getCheckInPostBody:function(_29){
var doc=du.newXMLDocument("entry",du.ATOM_NAMESPACE,[du.DOCUMENTS_ATOM_NAMESPACE]);
var _2a=doc.documentElement;
if(_29.atomId){
var _2b=du.createElementNS(doc,"id",du.ATOM_NAMESPACE);
_2b.appendChild(doc.createTextNode(_29.atomId));
_2a.appendChild(_2b);
}
var _2c=du.createElementNS(doc,"locked",du.DOCUMENTS_ATOM_NAMESPACE);
_2c.appendChild(doc.createTextNode("false"));
_2a.appendChild(_2c);
var _2d=du.XML_DECLARATION+du.serializeXMLDocument(doc);
return tu.trim(_2d);
},getPostBody:function(_2e){
var _2f,_30,doc=du.newXMLDocument("entry",du.ATOM_NAMESPACE,[du.DOCUMENTS_ATOM_NAMESPACE,du.SNX_NAMESPACE,du.THREAD_ATOM_NAMESPACE]);
var _31=doc.documentElement;
if(_2e.category){
var _32=du.createElementNS(doc,"category",du.ATOM_NAMESPACE);
_32.setAttribute("term",_2e.category);
_32.setAttribute("label",_2e.category);
_32.setAttribute("scheme","tag:ibm.com,2006:td/type");
_31.appendChild(_32);
}
if(_2e.atomId){
var _33=du.createElementNS(doc,"id",du.ATOM_NAMESPACE);
_33.appendChild(doc.createTextNode(_2e.atomId));
_31.appendChild(_33);
}
if(_2e.name){
var _34=du.createElementNS(doc,"label",du.DOCUMENTS_ATOM_NAMESPACE);
_34.appendChild(doc.createTextNode(_2e.name));
_31.appendChild(_34);
if(!_2e.title){
_30=du.createElementNS(doc,"title",du.ATOM_NAMESPACE);
_30.appendChild(doc.createTextNode(_2e.name));
_31.appendChild(_30);
}
}
if(_2e.title){
_30=du.createElementNS(doc,"title",du.ATOM_NAMESPACE);
_30.appendChild(doc.createTextNode(_2e.title));
_31.appendChild(_30);
}
if(_2e.visibility){
var _35=du.createElementNS(doc,"visibility",du.DOCUMENTS_ATOM_NAMESPACE);
_35.appendChild(doc.createTextNode((_2e.visibility=="public")?"public":"private"));
_31.appendChild(_35);
}
if(_2e.viralShareAllowed===true||_2e.viralShareAllowed===false){
var _36=du.createElementNS(doc,"propagation",du.DOCUMENTS_ATOM_NAMESPACE);
_36.appendChild(doc.createTextNode(_2e.viralShareAllowed?"true":"false"));
_31.appendChild(_36);
}
if(typeof _2e.description=="string"&&_2e.description!==null){
var _37=du.createElementNS(doc,"summary",du.ATOM_NAMESPACE);
_37.setAttribute("type","text");
_37.appendChild(doc.createTextNode(_2e.description));
_31.appendChild(_37);
}
if(_2e.changeSummary){
var _38=du.createElementNS(doc,"changeSummary",du.DOCUMENTS_ATOM_NAMESPACE);
_38.appendChild(doc.createTextNode(_2e.changeSummary));
_31.appendChild(_38);
}
if(_2e.contents&&_2e.mimeType){
var _39=du.createElementNS(doc,"content",du.ATOM_NAMESPACE);
_39.setAttribute("type",_2e.mimeType);
_39.appendChild(doc.createTextNode(_2e.contents));
_31.appendChild(_39);
}
if(_2e.versionUuid){
var _3a=du.createElementNS(doc,"versionUuid",du.DOCUMENTS_ATOM_NAMESPACE);
_3a.appendChild(doc.createTextNode(_2e.versionUuid));
_31.appendChild(_3a);
}
if(_2e.documentUuid){
var _3b=du.createElementNS(doc,"documentUuid",du.DOCUMENTS_ATOM_NAMESPACE);
_3b.appendChild(doc.createTextNode(_2e.documentUuid));
_31.appendChild(_3b);
}
if(_2e.locked===true||_2e.locked===false){
var _3c=du.createElementNS(doc,"locked",du.DOCUMENTS_ATOM_NAMESPACE);
_3c.appendChild(doc.createTextNode(_2e.locked?"true":"false"));
_31.appendChild(_3c);
}
if(typeof _2e.replyTo!="undefined"&&_2e.replyTo){
var _3d=du.createElementNS(doc,"in-reply-to",du.THREAD_ATOM_NAMESPACE);
_3d.setAttribute("ref",_2e.replyTo);
_31.appendChild(_3d);
}
if(_2e.snxFields){
for(var _3e in _2e.snxFields){
var pst=_2e.snxFields[_3e];
if(pst){
for(var fid in pst){
if(pst[fid]){
var _3f=pst[fid].value;
if((_3f||_3f===""||(_3f&&tu.trim(_3f)===""))&&pst[fid].dataType){
if(typeof _3f!="string"&&typeof _3f!="number"){
for(var i=0;i<_3f.length;i++){
_2f=du.createElementNS(doc,"field",du.SNX_NAMESPACE);
_2f.setAttribute("fid",fid);
_2f.setAttribute("pstId",_3e);
_2f.setAttribute("type",pst[fid].dataType);
_2f.appendChild(doc.createTextNode(_3f[i]));
_31.appendChild(_2f);
}
}else{
_2f=du.createElementNS(doc,"field",du.SNX_NAMESPACE);
_2f.setAttribute("fid",fid);
_2f.setAttribute("pstId",_3e);
_2f.setAttribute("type",pst[fid].dataType);
_2f.appendChild(doc.createTextNode(_3f));
_31.appendChild(_2f);
}
}
}
}
}
}
}
var _40=du.XML_DECLARATION+du.serializeXMLDocument(doc);
return tu.trim(_40);
},getPostNotificationBody:function(_41){
var doc=du.newXMLDocument("entry",du.ATOM_NAMESPACE,[du.DOCUMENTS_ATOM_NAMESPACE]);
var _42=doc.documentElement;
var _43=du.createElementNS(doc,"notifications",du.DOCUMENTS_ATOM_NAMESPACE);
if(_41.notifications){
if(_41.notifications.comment){
var _44=du.createElementNS(doc,"comment",du.DOCUMENTS_ATOM_NAMESPACE);
_44.appendChild(doc.createTextNode(_41.notifications.comment));
_43.appendChild(_44);
}
if(_41.notifications.media){
var _45=du.createElementNS(doc,"media",du.DOCUMENTS_ATOM_NAMESPACE);
_45.appendChild(doc.createTextNode(_41.notifications.media));
_43.appendChild(_45);
}
}
_42.appendChild(_43);
var _46=du.XML_DECLARATION+du.serializeXMLDocument(doc);
return tu.trim(_46);
},getFlagItemPostBody:function(_47){
var _48=du.NAMESPACES.ATOM;
var snx=du.NAMESPACES.SNX;
var doc=du.newXMLDocument("entry",_48,[snx]);
var _49=doc.documentElement;
var e=du.createElementNS(doc,"in-ref-to",snx);
e.setAttribute("rel","http://www.ibm.com/xmlns/prod/sn/report-item");
e.setAttribute("ref",_47.flagRef);
e.setAttribute("ref-item-type",_47.flagRefitemType);
_49.appendChild(e);
var d=du.createElementNS(doc,"content",_48);
d.setAttribute("type","text");
d.appendChild(doc.createTextNode(_47.flagReason));
_49.appendChild(d);
var _4a=du.XML_DECLARATION+du.serializeXMLDocument(doc);
return tu.trim(_4a);
},getFollowUserPostBody:function(uid){
var _4b=du.NAMESPACES.ATOM;
var doc=du.newXMLDocument("entry",_4b,[]);
var _4c=doc.documentElement;
var e=du.createElementNS(doc,"category",_4b);
e.setAttribute("scheme","http://www.ibm.com/xmlns/prod/sn/source");
e.setAttribute("term","profiles");
_4c.appendChild(e);
e=du.createElementNS(doc,"category",_4b);
e.setAttribute("scheme","http://www.ibm.com/xmlns/prod/sn/resource-type");
e.setAttribute("term","profile");
_4c.appendChild(e);
e=du.createElementNS(doc,"category",_4b);
e.setAttribute("scheme","http://www.ibm.com/xmlns/prod/sn/resource-id");
e.setAttribute("term",uid);
_4c.appendChild(e);
var _4d=du.XML_DECLARATION+du.serializeXMLDocument(doc);
return tu.trim(_4d);
}});
})();
}


;if(!dojo._hasResource["com.ibm.social.incontext.util.proxy"]){
dojo._hasResource["com.ibm.social.incontext.util.proxy"]=true;
(function(){
dojo.provide("com.ibm.social.incontext.util.proxy");
var _1=com.ibm.social.incontext.util;
var _2=function(_3){
return _3=="https"?443:80;
};
var _4=dojo.getObject("com.ibm.social.as.util.xhr.XhrHandler");
var _5=_4===undefined||!_4.useOauth;
var _6=dojo.config.proxy;
if(_5&&_6){
var _7=window.location;
var _8=_7.hostname;
var _9=(_7.protocol||"http").replace(":","");
var _a=_7.port||_2(_9);
_1.proxy=function(_b){
var _c=new dojo._Url(_b);
var _d=_c.host;
if(_d){
var _e=_c.scheme||_9;
var _f=_c.port||_2(_e);
if(_e!=_9||_f!=_a||_d!=_8){
return _6+"/"+_e+"/"+encodeURIComponent(_d+":"+_f)+(_c.path||"")+(_c.query?("?"+_c.query):"");
}
}
return _b;
};
}else{
_1.proxy=function(url){
return url;
};
}
})();
}


;if(!dojo._hasResource["com.ibm.social.incontext.util.url"]){
dojo._hasResource["com.ibm.social.incontext.util.url"]=true;
dojo.provide("com.ibm.social.incontext.util.url");
dojo.provide("com.ibm.social.incontext.util.url.ProxyUrlHelper");


(function(){
var _1=com.ibm.social.incontext.util.url;
_1._const={regex:/(^[a-zA-Z]+)\:\/\/([a-zA-Z\d][\a-z\A-Z\d\-\.]*)(:\d{1,5})?([\/\?\#].*)?/,protocolPorts:{"http":80,"https":443}};
_1.parse=function(_2){
if(!_2){
return null;
}
if(typeof _2!="string"&&console.trace){
throw "Argument for URI must be a string";
}
_2=new dojo._Url(_2);
_2.queryParameters=_1.getRequestParameters(_2);
return _2;
};
_1.write=function(_3){
if(!_3){
return null;
}
var _4="";
if(_3.scheme){
_4+=_3.scheme+":";
}
if(_3.authority){
_4+="//"+_3.authority;
}
_4+=_3.path;
if(_3.queryParameters){
_4+=_1.writeParameters(_3.queryParameters);
}else{
if(_3.query){
_4+=((_3.query.charAt(0)!="?")?"?":"")+_3.query;
}
}
if(_3.fragment){
_4+="#"+_3.fragment;
}
return _4;
};
dojo._Url.prototype.toCanonicalString=function(){
return _1.write(this);
};
_1.rewrite=function(_5,p){
if(_5&&p){
_5=_1.parse(_5);
dojo.mixin(_5.queryParameters,p);
_5=_1.write(_5);
}
return _5;
};
_1.splitQuery=function(_6){
var _7={};
if(!_6){
return _7;
}
if(_6.charAt(0)=="?"){
_6=_6.substring(1);
}
var _8=_6.split("&");
for(var i=0;i<_8.length;i++){
if(_8[i].length>0){
var _9=_8[i].indexOf("=");
if(_9==-1){
var _a=decodeURIComponent(_8[i]);
var _b=_7[_a];
if(dojo.isArray(_b)){
_b.push("");
}else{
if(_b){
_7[_a]=[_b,""];
}else{
_7[_a]="";
}
}
}else{
if(_9>0){
var _a=decodeURIComponent(_8[i].substring(0,_9));
var _c=decodeURIComponent(_8[i].substring(_9+1));
var _b=_7[_a];
if(dojo.isArray(_b)){
_b.push(_c);
}else{
if(_b){
_7[_a]=[_b,_c];
}else{
_7[_a]=_c;
}
}
}
}
}
}
return _7;
};
_1.getRequestParameters=function(_d){
if(!_d){
return {};
}
if(typeof _d=="string"){
_d=new dojo._Url(_d);
}
return _1.splitQuery(_d.query);
};
_1.writeParameters=function(_e){
var _f=[];
for(var key in _e){
var _10=_e[key];
if(typeof _10!="undefined"&&_10!=null){
key=encodeURIComponent(key);
if(dojo.isArray(_10)){
for(var i=0;i<_10.length;i++){
if(_10[i]){
_f.push(_f.length==0?"?":"&");
_f.push(key);
_f.push("=");
_f.push(encodeURIComponent(_10[i]));
}
}
}else{
_f.push(_f.length==0?"?":"&");
_f.push(key);
_f.push("=");
_f.push(encodeURIComponent(_10));
}
}
}
return _f.join("");
};
_1.removeRelativePathFromHost=function(uri){
var _11=_1.parse(uri);
_11=_11.scheme+"://"+_11.host;
return _11;
};
_1.ProxyUrlHelper=function(){
};
_1.ProxyUrlHelper.prototype={getProxifiedURL:function(url){
return com.ibm.social.incontext.util.proxy(url);
}};
})();
}


;if(!dojo._hasResource["com.ibm.social.incontext.util.uri"]){
dojo._hasResource["com.ibm.social.incontext.util.uri"]=true;
dojo.provide("com.ibm.social.incontext.util.uri");


(function(){
var _1=com.ibm.social.incontext.util.uri,_2=com.ibm.social.incontext.util.url;
_1.parseUri=_2.parse;
_1.writeUri=_2.write;
_1.rewriteUri=_2.rewrite;
_1.splitQuery=_2.splitQuery;
_1.getRequestParameters=_2.getRequestParameters;
_1.writeParameters=_2.writeParameters;
_1.makeAtomUrlIESafe=function(_3){
if(dojo.isIE&&_3){
_3=_2.parse(_3);
_3.queryParameters.format="xml";
_3=_2.write(_3);
}
return _3;
};
})();
}


;if(!dojo._hasResource["com.ibm.social.ee.data.DataStore"]){
dojo._hasResource["com.ibm.social.ee.data.DataStore"]=true;
dojo.provide("com.ibm.social.ee.data.DataStore");




dojo.declare("com.ibm.social.ee.data.DataStore",null,{timeout:0,defaultStart:1,defaultCount:10,features:{"dojo.data.api.Read":true,"dojo.data.api.Write":true},constructor:function(_1){
dojo.mixin(this,_1);
this.dirtyItems=[];
},getValue:function(_2,_3,_4){
if(_2){
var _5=_2.getAttribute(_3);
if(typeof _5=="undefined"||_5===null){
_5=_4;
}
return _5;
}else{
return null;
}
},getValues:function(_6,_7){
var _8=this.getValue(_6,_7);
if(_8){
return [_8];
}else{
return [];
}
},getAttributes:function(_9){
var _a=_9.getAttributes();
return _a;
},hasAttribute:function(_b,_c){
return _b.hasAttribute(_c);
},containsValue:function(_d,_e,_f){
return dojo.indexOf(_d.getValues(_d,_e),_f)!=-1;
},isItem:function(_10){
return (_10!==null&&(typeof _10.getAttribute=="function"||(_10.ds&&_10.ds.isNew)));
},isItemLoaded:function(_11){
return _11.isFullyLoaded;
},fetch:function(kw){
var _12=kw;
if(!_12.abort){
_12=dojo.mixin(_12,{abort:dojo.hitch(this,this.abortRequest,_12)});
}
if(this.currentTimerConnection){
dojo.disconnect(this.currentTimerConnection);
}
this._fetch(_12);
return _12;
},_fetch:function(_13){
var _14=_13.sync?true:false;
var url=_13.url?_13.url:this.url;
var _15={url:url,sync:_14,handleAs:this.getFetchHandleAs(),timeout:this.timeout,handle:dojo.hitch(this,this.handleGet,dojo.hitch(this,this.dataLoaded,_13),dojo.hitch(this,this.dataError,_13)),preventCache:true};
_13.httpReq=this.net.get(_15);
},getFetchHandleAs:function(){
return "xml";
},abortRequest:function(_16){
_16.httpReq.cancel();
},getFeatures:function(){
return this.features;
},close:function(_17){
},getLabel:function(_18){
return undefined;
},getLabelAttributes:function(_19){
return null;
},deleteItem:function(_1a){
if(!this.isItem(_1a)){
throw "Not an item";
}
if(!_1a.ds.isDirty){
this.dirtyItems.push(_1a);
}
_1a.ds.isDeleted=true;
_1a.ds.isDirty=true;
_1a.ds.isNew=false;
return true;
},setValue:function(_1b,_1c,_1d){
if(!this.isItem(_1b)){
throw "Not an item";
}
if(typeof _1c!="string"){
throw "Attribute not a string";
}
if(typeof _1d=="undefined"){
throw "Value undefined";
}
if(!_1b.ds.isDirty){
this.dirtyItems.push(_1b);
}
_1b.ds.isDirty=true;
this._setValue(_1c,_1d,_1b.ds.attributes);
return true;
},_setValue:function(_1e,_1f,map){
map[_1e]=_1f;
},setValues:function(_20,_21,_22){
if(!this.isItem(_20)){
throw "Not an item";
}
if(typeof _21!="string"){
throw "Attribute not a string";
}
if(!_22||!_22.length){
throw "Values not an array";
}
if(_22.length===0){
_20.ds.attributes[_21]=null;
}else{
_20.ds.attributes[_21]=_22;
}
if(!_20.ds.isDirty){
this.dirtyItems.push(_20);
}
_20.ds.isDirty=true;
},unsetAttribute:function(_23,_24){
if(!this.isItem(_23)){
throw "Not an item";
}
if(typeof _24!="string"){
throw "Attribute not a string";
}
_23.ds.attributes[_24]=null;
if(!_23.ds.isDirty){
this.dirtyItems.push(_23);
}
_23.ds.isDirty=true;
},save:function(_25){
if(this.dirtyItems.length===0){
var _26=_25.scope?_25.scope:dojo.global;
if(_25.onComplete){
_25.onComplete.call(_26);
}
return;
}
_25.requests=this.dirtyItems.length;
while(this.dirtyItems.length>0){
var _27=this.dirtyItems.pop();
if(_27.ds.isDeleted){
this._deleteItem(_27,_25);
}else{
if(_27.ds.isNew){
this._newItem(_27,_25);
}else{
this._saveItem(_27,_25);
}
}
}
},_newItem:function(_28,_29){
},_deleteItem:function(_2a,_2b){
},_saveItem:function(_2c,_2d){
},loadItem:function(_2e,_2f){
},itemFromDocEl:function(el,_30){
return null;
},dataError:function(_31,err,_32){
if(err&&err.dojoType=="timeout"){
err.code="timeout";
err.type="timeout";
}else{
if(_32&&_32.xhr&&_32.xhr.status==404){
err.code="ItemNotFound";
err.type="ItemNotFound";
}else{
if(_32&&_32.xhr&&_32.xhr.status==401){
err.code="AccessDenied";
err.type="AccessDenied";
}
}
}
if(_31.onError){
var _33=(_31.scope)?_31.scope:dojo.global;
_31.onError.call(_33,err);
}
},handleGet:function(_34,_35,_36,_37){
if((typeof _36=="Error")||(_36.name=="Error")){
if(_36&&_36.dojoType=="timeout"){
if(_37&&_37.xhr&&_37.xhr.status==200){
_36=dojo._contentHandlers[_37.handleAs](_37.xhr);
_34(_36,_37);
}else{
_35(_36,_37);
}
}else{
_35(_36,_37);
}
}else{
_34(_36,_37);
}
},revert:function(){
while(this.dirtyItems.length>0){
this.dirtyItems[this.dirtyItems.length-1].ds.isDirty=false;
this.dirtyItems[this.dirtyItems.length-1].ds.isDeleted=false;
this.dirtyItems[this.dirtyItems.length-1].ds.isNew=false;
this.dirtyItems[this.dirtyItems.length-1].ds.attributes={};
this.dirtyItems.pop();
}
return true;
},newItem:function(_38,_39){
if(typeof _38!="object"){
throw "keywordArgs is not an object";
}
var _3a=this._createNewItem(_38,_39);
if(_3a){
_3a.ds={attributes:_38};
_3a.ds.isNew=true;
_3a.ds.isDirty=true;
this.dirtyItems.push(_3a);
var _3b=_38.category;
if(_3b){
this.setValue(_3a,"category",_3b);
}
}
return _3a;
},_createNewItem:function(_3c,_3d){
return {};
},isDirty:function(_3e){
if(_3e){
if(!this.isItem(_3e)){
throw "Not an item";
}
return _3e.ds&&_3e.ds.isDirty;
}else{
return this.dirtyItems.length>0;
}
}});
}


;if(!dojo._hasResource["com.ibm.social.incontext.util.atom"]){
dojo._hasResource["com.ibm.social.incontext.util.atom"]=true;
dojo.provide("com.ibm.social.incontext.util.atom");


(function(){
var _1=com.ibm.social.incontext.util.atom,_2=com.ibm.social.incontext.util.dom;
_1._htmlText=function(el){
if(!el){
return null;
}
var a=[];
for(var j=0,c;c=el.childNodes[j];j++){
if(c.nodeType==3){
a.push(c.nodeValue);
}
}
return a.length>0?a.join(""):null;
};
_1.getErrorCode=function(_3,_4){
var _5=_1.getError(_3,_4);
return (_5?_5.code:null);
};
_1._CMIS_ERROR_CODES={"objectNotFound":"ItemNotFound","permissionDenied":"AccessDenied","contentAlreadyExists":"ItemExists","updateConflict":"ConcurrentModification","nameConstraintViolation":"InvalidPath"};
_1.getError=function(_6,_7,_8){
if(_6 instanceof Error&&_6.code){
return _6;
}
var _9=null;
var _a=_6;
_6=_6||{};
_7=_7||{};
var _b=_7.xhr;
var _c;
try{
if(_b){
_c=_b.status;
}
}
catch(e){
}
var _d;
try{
if(_b){
var h=_b.getResponseHeader("X-LConn-Auth");
_d=(h=="true"||h=="false");
}
}
catch(e){
}
if(dojo.isIE&&_c==1223){
_c=204;
}
var _e=false;
_e=_e||_6 instanceof Error;
_e=_e||(_c>0&&!(_c>=200&&_c<300));
_e=_e||(dojo.isIE&&_6.number==-2147024891);
if(_8&&_8.requireData){
_e=_e||(_7.handleAs=="xml"&&!_6.documentElement);
_e=_e||(dojo.indexOf(["json","json-comment-filtered"],_7.handleAs)!=-1&&(!_a||typeof _a!="object"));
}
if(_e){
_9=new Error();
if("cancel"==_6.dojoType&&_7.error&&typeof _7.error=="object"){
var _f=_7.error;
if(_f.name=="NS_ERROR_FILE_ACCESS_DENIED"){
_9.message=_9.code="FileAccessDenied";
}
}
if(!_9.code&&dojo.indexOf(["cancel","timeout","unauthenticated"],_6.dojoType)!=-1){
_9.message=_9.code=_9.dojoType=_6.dojoType;
}
if(!_9.code&&dojo.isIE&&_6.number==-2147024891){
_9.message=_9.code="FileDoesNotExist";
}
if(!_9.code&&_c==412&&_b&&_b.responseXML&&_b.responseXML.documentElement&&_2.isNamedNS(_b.responseXML.documentElement,"entry",_2.NAMESPACES.ATOM)){
_9.message=_9.code="ConcurrentModification";
_9.entry=_b.responseXML.documentElement;
}
if(!_9.code&&_b&&_b.responseXML&&_b.responseXML.documentElement){
var el=_b.responseXML.documentElement;
var _10=_2.getChildElementTextContentNS(el,"errorCode",_2.DOCUMENTS_ATOM_NAMESPACE);
if(!_10){
_10=_2.getChildElementTextContentNS(el,"code",_2.LCMIS_NAMESPACE);
if(_10){
_10=_1._CMIS_ERROR_CODES[_10]||"unknown";
}
}
var _11=(_10?dojo.trim(_10):"");
if(_11.length>0){
_9.message=_9.code=_11;
_9.el=el;
_9.message=_2.getChildElementTextContentNS(el,"errorMessage",_2.DOCUMENTS_ATOM_NAMESPACE);
if(!_9.message){
_9.message=_2.getChildElementTextContentNS(el,"message",_2.LCMIS_NAMESPACE);
}
if(_11=="QuotaViolation"){
_9.libraryQuota=parseInt(_2.getChildElementTextContentNS(el,"libraryQuota",_2.DOCUMENTS_ATOM_NAMESPACE));
_9.librarySize=parseInt(_2.getChildElementTextContentNS(el,"librarySize",_2.DOCUMENTS_ATOM_NAMESPACE));
_9.uploadSize=parseInt(_2.getChildElementTextContentNS(el,"uploadSize",_2.DOCUMENTS_ATOM_NAMESPACE));
}else{
if(_11=="ExtensionViolation"){
_9.extension=_2.getChildElementTextContentNS(el,"extension",_2.DOCUMENTS_ATOM_NAMESPACE);
}
}
}
}
if(!_9.code&&_c==404){
if(_d===false){
_9.message=_9.dojoType=_9.code="timeout";
}else{
_9.message=_9.code="ItemNotFound";
}
}
if(!_9.code&&(_c==401||_c==403||dojo.isIE&&_c==0)){
_9.message=_9.code="Unauthorized";
}
if(!_9.code&&_c==0){
_9.message=_9.code="NetworkRequestFailed";
}
if(!_9.code&&_c==409){
_9.message=_9.code="ItemExists";
}
if(!_9.code){
_9.message=_9.code="unknown";
}
if(_c==412&&_9.code=="InvalidUser"){
_9.message=_9.code="SessionInvalidated";
}
}
return _9;
};
_1.getJsonResponseFromHtml=function(d){
var r={};
try{
if(d&&d.body){
var _12=dojo.filter(d.getElementsByTagName("meta"),function(el){
return el.name=="status";
})[0];
r.status=_12?parseInt(_12.content):200||200;
try{
var _13=_1._htmlText(d.body);
var _14=dojo.fromJson(_13);
if(typeof _14=="object"){
r.contents=_14;
}
}
catch(e){
console.log("util::getJsonResponseFromHtml DEBUG innerHTML not JSON");
}
}
}
catch(e){
console.log("util::getJsonResponseFromHtml DEBUG unable to access body");
}
return r;
};
_1.getJsonError=function(r){
if(r&&r.status==404){
var _15=new Error();
_15.message=_15.code="ItemNotFound";
return _15;
}
if(!r||!r.contents||typeof r.contents!="object"){
var _15=new Error();
_15.message=_15.code="unknown";
return _15;
}
if(r.status==412){
var _15=new Error();
_15.message=_15.code="ConcurrentModification";
_15.entry=r.contents;
return _15;
}else{
if(typeof r.contents.errorCode=="string"){
var _15=new Error();
_15.message=r.contents.errorMessage;
_15.code=r.contents.errorCode;
for(var key in r.contents){
if(key!="errorCode"&&key!="errorMessage"){
_15[key]=r.contents[key];
}
}
return _15;
}else{
if(typeof r.contents.code=="string"){
var _15=new Error();
_15.message=r.contents.message;
_15.code=_1._CMIS_ERROR_CODES[r.contents.code]||"unknown";
for(var key in r.contents){
if(key!="code"&&key!="message"){
_15[key]=r.contents[key];
}
}
return _15;
}else{
if(r.status<200||r.status>=300){
var _15=new Error();
_15.message=_15.code="unknown";
return _15;
}
}
}
}
return null;
};
_1.detectLoginForMultipartResponse=function(_16,_17){
var _18=false;
if(_16&&!(_16 instanceof Error)){
var _19;
try{
_19=_16.body;
}
catch(e){
}
if(_19&&!dojo.hasClass(_19,"X-LConn-API-Response")){
_18=true;
console.log("util::detectLoginForMultipartAtomResponse DEBUG The body of the document does not have the expected class");
}
}
return _18;
};
_1.createOperationId=function(){
var s=dojo._toArray(arguments).join("_");
if(s.length>256){
s=s.substring(0,256);
}
return dojo.trim(s);
};
})();
}


;if(!dojo._hasResource["com.ibm.social.ee.data.FeedDataStore"]){
dojo._hasResource["com.ibm.social.ee.data.FeedDataStore"]=true;
dojo.provide("com.ibm.social.ee.data.FeedDataStore");








(function(){
var _1=com.ibm.social.incontext.util;
dojo.declare("com.ibm.social.ee.data.FeedDataStore",[com.ibm.social.ee.data.DataStore],{requireData:true,rewriteUri:function(_2,_3){
if(_3){
return _1.url.rewrite(_2,_3);
}else{
return _2;
}
},_newItem:function(_4,_5){
var _6=this._getPostBody(_4.ds.attributes);
this.net.postXml({noStatus:true,url:this._getNewItemUrl(_4),postData:_6,requireData:this.requireData,headers:{"Content-Type":"application/atom+xml;charset=\"UTF-8\""},handle:dojo.hitch(this,this._saveItemComplete,_4,_5)});
},_getNewItemUrl:function(_7){
return this.url;
},_deleteItem:function(_8,_9){
var _a=this._getDeleteItemUrl(_8);
this.net.deleteXml({url:this.rewriteUri(_a,{}),handle:dojo.hitch(this,this._saveItemComplete,_8,_9),headers:{"Content-Type":"application/atom+xml;charset=\"UTF-8\""},handleAs:this.getDeleteHandleAs()});
},_getDeleteItemUrl:function(_b){
return this.getValue(_b,"urlEntry");
},getDeleteHandleAs:function(){
return "xml";
},_saveItem:function(_c,_d){
var _e=this._getSaveItemAttrs(_c);
var _f=this._getPutBody(_e);
this.net.putXml({noStatus:true,url:this._getSaveItemUrl(_c,_e),postData:_f,headers:{"Content-Type":this._getSaveItemHeadersContentType()},handle:dojo.hitch(this,this._saveItemComplete,_c,_d)});
},_getSaveItemHeadersContentType:function(){
return "application/atom+xml;charset=\"UTF-8\"";
},_getSaveItemAttrs:function(_10){
return _10.ds.attributes;
},_getSaveItemUrl:function(_11){
var url=this.getValue(_11,"urlEntry");
return this.rewriteUri(url);
},_getPostBody:function(_12){
return this._domBuilder.getPostBody(_12);
},_getPutBody:function(_13){
return this._getPostBody(_13);
},_saveItemComplete:function(_14,_15,_16,_17){
_14.isFullyLoaded=false;
_14.ds.isDirty=false;
_14.ds.isNew=false;
if(_15.requests){
_15.requests--;
}
var _18=_15.scope?_15.scope:dojo.global;
var _19;
if(typeof _16=="Error"||_16 instanceof Error){
_19=_16;
}else{
_19=_1.atom.getError(_16,_17);
}
if(_19&&_19.code){
if(_15.onError){
_15.onError.call(_18,_19);
}
return;
}else{
if(_14.setDocumentElement&&_16&&_16.documentElement){
_14.setDocumentElement(_16.documentElement);
}
}
if((!_15.requests||_15.requests===0)&&_15.onComplete){
var _1a=null;
if(_16){
if(_14&&_14.ds&&_14.ds.isDeleted){
_1a=_16;
}else{
_1a=this.itemFromDocEl(_16.documentElement);
_1a.ds={isDirty:false,isDeleted:false,isNew:false,attributes:{}};
this.initializeItem(_1a);
}
}
_15.onComplete.call(_18,_1a,_17);
}
},dataLoaded:function(_1b,doc,_1c,_1d){
var i,_1d=_1d?_1d:{};
var _1e=_1.atom.getError(doc,_1c);
if(_1e&&_1e.type){
this.dataError(_1b,_1e);
return;
}
var el=doc.documentElement;
var _1f=_1.dom.getAttributeNS(el,"base",_1.dom.XML_NAMESPACE);
this.preInitializeItems(_1b,el,_1f);
var _20=this.getDataLoadedEntries(el);
var _21=_1b.items?_1b.items:[];
for(i=0;i<_20.length;i++){
var _22=this.itemFromDocEl(_20[i],_1f);
_22.isFullyLoaded=true;
_22.ds={isDirty:false,isDeleted:false,isNew:false,attributes:{}};
this.initializeItem(_22);
_21.push(_22);
}
this.totalItems=this.getTotalItems(el);
if(_1d.checkForNext&&this.totalItems<0){
var _23=_1.dom.getChildElementAttributeMatchingNS(el,"link",_1.dom.ATOM_NAMESPACE,"rel",null,"next","href");
if(_23){
_1b.nextFlag=true;
}
}
var _24=this.preprocessItems(_21,_1b);
var _25=(_1b.scope)?_1b.scope:dojo.global;
if(_1b.onBegin){
_1b.onBegin.call(_25,this.totalItems,_1b);
}
if(_1b.onItem){
for(i=0;i<_24.length;i++){
_1b.onItem.call(_25,_24[i],_1b);
}
}
if(_1b.onComplete){
var _26=(_1b.onItem)?null:_24;
_1b.onComplete.call(_25,_26,_1b);
}
this.postInitializeItems(_1b);
},preprocessItems:function(_27,_28){
return _27;
},getDataLoadedEntries:function(el){
return _1.dom.getChildElementsNS(el,"entry",_1.dom.ATOM_NAMESPACE);
},getTotalItems:function(el){
return -1;
},initializeItem:function(_29){
},preInitializeItems:function(_2a,el,_2b){
},postInitializeItems:function(_2c){
},itemError:function(_2d,_2e,_2f){
if(_2d.onError){
var _30=_1.atom.getError(_2e,_2f);
var _31=_2d.scope?_2d.scope:dojo.global;
_2d.onError.call(_31,_30?_30:_2e);
}
},itemLoaded:function(_32,_33,_34){
var _35=_1.atom.getError(_33,_34);
if(_35&&_35.type){
var _36=_32.scope?_32.scope:dojo.global;
if(_32.onError){
_32.onError.call(_36,_35);
}
return;
}
var el=_33.documentElement;
var _37=this.getCategory(el);
var _38=this.itemFromDocElAndCat(el,null,_37,_32);
if(_38.isFullyLoaded!==false&&_38.isFullyLoaded!==true){
_38.isFullyLoaded=true;
}
_38.ds=_32.item.ds;
_38.ds.attributes={};
var _36=_32.scope?_32.scope:dojo.global;
if(_32.onItem){
_32.onItem.call(_36,_38);
}
},loadItem:function(_39,_3a){
var _3b=_39.item;
var _3c=_39.sync?true:false;
if((!this.isItemLoaded(_3b))||_39.forceLoad){
var _3d=this.getValue(_3b,"urlEntry");
_3d=this.rewriteUri(_3d,_3a);
var _3e={url:_3d,handleAs:"xml",timeout:this.timeout,sync:_3c,handle:dojo.hitch(this,this.handleGet,dojo.hitch(this,this.itemLoaded,_39),dojo.hitch(this,this.itemError,_39))};
this.net.get(_3e);
}
},itemFromDocElAndCat:function(el,_3f,_40,_41){
return null;
}});
})();
}


;if(!dojo._hasResource["com.ibm.social.incontext.util.misc"]){
dojo._hasResource["com.ibm.social.incontext.util.misc"]=true;
dojo.provide("com.ibm.social.incontext.util.misc");


dojo.j=dojo.getObject("Jiffy")||{mark:function(){
},measure:function(){
}};
com.ibm.social.incontext.util.misc={indexById:function(_1,_2,_3){
if(_1){
for(var i=0;i<_1.length;i++){
if(_1[i]&&_1[i][_2]==_3){
return _1[i];
}
}
}
},initFromArray:function(_4,a,b,c,d,e,f,g){
var _5;
if(_4===null){
return null;
}
_5=typeof _4;
if(_5=="function"){
return _4(a,b,c,d,e,f,g);
}
var _6=[];
if(dojo.isArray(_4)){
for(var i=0;i<_4.length;i++){
var o=_4[i];
_5=typeof o;
if(_5=="function"){
_6[i]=o(a,b,c,d,e,f,g);
}
if(_5=="string"){
_6[i]=new dojo.getObject(o)(a,b,c,d,e,f,g);
}
}
}
return _6;
},sort:function(_7){
if(!dojo.isArray(_7)||_7.length<2){
return _7;
}
if(arguments.length==1){
return _7.sort();
}
var _8=arguments;
var _9=[];
for(var i=1;i<_8.length;i++){
var _a=_8[i];
var _b=1;
if(dojo.isArray(_a)){
_b=_a[1];
_a=_a[0];
}
var f=(typeof _7[0][_a]=="string"&&"".localeCompare)?com.ibm.social.incontext.util.misc.orderLocale:com.ibm.social.incontext.util.misc.order;
_9.push(dojo.partial(f,_a,_b));
}
if(_9.length==1){
return _7.sort(_9[0]);
}
return _7.sort(function(a,b){
var l=_9.length;
for(var i=0;i<l;i++){
var c=_9[i](a,b);
if(c!==0){
return c;
}
}
return 0;
});
},slice:function(_c,f,_d){
var _e=[];
for(var i=0;i<_c.length;){
var _f=_c[i];
if(f.call(_d,_f)){
_e.push(_f);
_c.splice(i,1);
}else{
i++;
}
}
return _e;
},hitchDeferred:function(dfd){
return function(_10){
dfd.callback.apply(dfd,arguments);
return _10;
};
},orderLocale:function(key,_11,a,b){
return a[key].localeCompare(b[key])*_11;
},order:function(key,_12,a,b){
a=a[key];
b=b[key];
if(a==b){
return 0;
}
return (a>b?1:-1)*_12;
},destroy:function(){
var i;
if(arguments.length>1){
for(i=0;i<arguments.length;i++){
com.ibm.social.incontext.util.misc.destroy(arguments[i]);
}
}else{
if(arguments.length==1){
var arg=arguments[0];
if(arg&&typeof arg=="object"&&arg.length>0){
for(i=0;i<arg.length;i++){
com.ibm.social.incontext.util.misc.destroy(arg[i]);
}
}else{
var w=arg;
if(typeof w=="string"){
w=dijit.byId(w);
}
if(w){
if(w.destroyRecursive){
w.destroyRecursive();
}else{
if(w.destroy){
w.destroy();
}
}
}
}
}
}
},first:function(o){
return (o&&dojo.isArrayLike(o))?o[0]:o;
},last:function(o){
return (o&&dojo.isArrayLike(o))?o[o.length-1]:o;
},size:function(o){
var c=0;
if(o){
for(var i in o){
c++;
}
}
return c;
},date:{convertAtomDate:dojo.date.stamp.fromISOString},hasListeners:function(f){
return (f._listeners&&dojo.some(f._listeners,function(l){
return l;
}));
},animateBackground:function(p,_13,end){
var n=p.node;
var pr=p.properties=p.properties||{};
pr.backgroundColor={start:_13,defEnd:end,end:function(){
var bg=dojo.getComputedStyle(n).backgroundColor;
if(bg=="rgba(0, 0, 0, 0)"){
bg="rgba(255, 255, 255, 0)";
}
return bg||this.defEnd;
}};
p.onEnd=function(){
dojo.byId(n).style.backgroundColor="";
};
return p;
}};
}


;if(!dojo._hasResource["com.ibm.social.ee.bean.Bean"]){
dojo._hasResource["com.ibm.social.ee.bean.Bean"]=true;
dojo.provide("com.ibm.social.ee.bean.Bean");


dojo.declare("com.ibm.social.ee.bean.Bean",null,{isFullyLoaded:false,setBase:function(_1,_2){
if(_2){
this.base=_2;
}else{
if(_1){
this.base=com.ibm.social.incontext.util.dom.getAttributeNS(_1,"base",com.ibm.social.incontext.util.dom.XML_NAMESPACE);
}
}
},prependBase:function(_3){
if(this.base&&_3&&_3.indexOf(":")==-1){
return this.base+_3;
}else{
return _3;
}
},getAttribute:function(_4){
var ds=this.ds;
if(ds){
var _5=ds.attributes;
if(_5&&_5[_4]){
return _5[_4];
}
}
var _6=this._methodName1(_4);
var _7=this[_6];
if(typeof _7=="function"){
return _7.call(this);
}else{
_6=this._methodName2(_4);
_7=this[_6];
if(typeof _7=="function"){
return _7.call(this);
}else{
if(typeof this[_4]!="undefined"){
return this[_4];
}
}
}
return null;
},hasAttribute:function(_8){
var ds=this.ds;
if(ds){
var _9=ds.attributes;
if(_9&&_9[_8]){
return true;
}
}
var _a=this._methodName1(_8);
if(typeof this[_a]=="function"){
return true;
}else{
_a=this._methodName2(_8);
if(typeof this[_a]=="function"){
return true;
}else{
if(typeof this[_8]!="undefined"){
return true;
}
}
}
return false;
},_methodName1:function(_b){
var _c=["get",_b.substring(0,1).toUpperCase(),_b.substring(1,_b.length)];
return _c.join("");
},_methodName2:function(_d){
var _e=["is",_d.substring(0,1).toUpperCase(),_d.substring(1,_d.length)];
return _e.join("");
},_attributeName:function(_f,_10){
return _f.substring(_10,_10+1).toLowerCase()+_f.substring(_10+1,_f.length);
},getAttributes:function(){
var _11=[];
for(var i in this){
if(i=="getAttribute"){
continue;
}
if((i.substring(0,2)=="is")&&typeof this[i]=="function"){
_11.push(this._attributeName(i,2));
}else{
if((i.substring(0,3)=="get")&&typeof this[i]=="function"){
_11.push(this._attributeName(i,3));
}
}
}
return _11;
}});
}


;if(!dojo._hasResource["com.ibm.social.ee.bean.User"]){
dojo._hasResource["com.ibm.social.ee.bean.User"]=true;
dojo.provide("com.ibm.social.ee.bean.User");




dojo.declare("com.ibm.social.ee.bean.User",null,{constructor:function(e){
var _1=com.ibm.social.incontext.util.dom;
this.userid=_1.getChildElementTextContentNS(e,"userid",_1.SNX_NAMESPACE)||_1.getChildElementTextContentNS(e,"principalid",_1.LCMIS_NAMESPACE);
this.id=this.userid?this.userid:_1.getChildElementTextContentNS(e,"name",_1.DOCUMENTS_ATOM_NAMESPACE);
this.uri=_1.getChildElementTextContentNS(e,"uri",_1.DOCUMENTS_ATOM_NAMESPACE)||_1.getChildElementTextContentNS(e,"uri",_1.ATOM_NAMESPACE);
this.name=_1.getChildElementTextContentNS(e,"name",_1.DOCUMENTS_ATOM_NAMESPACE)||_1.getChildElementTextContentNS(e,"name",_1.ATOM_NAMESPACE)||_1.getChildElementTextContentNS(e,"displayname",_1.LCMIS_NAMESPACE);
this.email=_1.getChildElementTextContentNS(e,"email",_1.DOCUMENTS_ATOM_NAMESPACE)||_1.getChildElementTextContentNS(e,"email",_1.ATOM_NAMESPACE)||_1.getChildElementTextContentNS(e,"email",_1.LCMIS_NAMESPACE);
this.hasEmail=(this.email!==null&&typeof (this.email)!="undefined")||(com.ibm.social.incontext.util.text.trim(this.email).length>0);
this.state=_1.getChildElementTextContentNS(e,"userState",_1.SNX_NAMESPACE);
this.inactive=(this.state==="inactive");
},getId:function(){
return this.id;
},getUri:function(){
return this.uri;
},getName:function(){
return this.name;
},getEmail:function(){
return this.email;
},isHasEmail:function(){
return this.hasEmail;
},getState:function(){
return this.state;
}});
com.ibm.social.ee.bean.User.decodeUserUri=function(s){
return decodeURIComponent(s.replace("+"," "));
};
}


;if(!dojo._hasResource["com.ibm.social.ee.bean.AtomBean"]){
dojo._hasResource["com.ibm.social.ee.bean.AtomBean"]=true;
dojo.provide("com.ibm.social.ee.bean.AtomBean");












(function(){
var _1=com.ibm.social.incontext.util;
dojo.declare("com.ibm.social.ee.bean.AtomBean",com.ibm.social.ee.bean.Bean,{constructor:function(_2,_3,_4){
this.e=_2;
this.setBase(_2,_3);
if(_4){
dojo.mixin(this,_4);
}
},setDocumentElement:function(_5){
this.e=_5;
this.setBase(this.e);
this.category=null;
this.atomId=null;
this.id=null;
this.title=null;
this.description=null;
this.author=null;
this.updated=null;
this.permissions=null;
this.modifier=null;
this.modified=null;
},getEntry:function(){
return this.e;
},getCategory:function(){
if(!this.category){
this.category=_1.dom.getChildElementNSAttribute(this.e,"category",_1.dom.ATOM_NAMESPACE,"term");
}
return this.category;
},getAtomId:function(){
if(!this.atomId){
this.atomId=_1.dom.getChildElementTextContentNS(this.e,"id",_1.dom.ATOM_NAMESPACE);
if(!this.atomId||this.atomId===""){
this.throwRequiredPropertyError("id");
}
}
return this.atomId;
},getTitle:function(){
if(!this.title){
this.title=_1.dom.getChildElementTextContentNS(this.e,"title",_1.dom.ATOM_NAMESPACE);
}
return this.title;
},getDescription:function(){
if(!this.description){
this.description=_1.dom.getChildElementTextContentNS(this.e,"summary",_1.dom.ATOM_NAMESPACE);
if(!this.description&&this.description!==""){
this.throwRequiredPropertyError("summary");
}
}
return this.description;
},getContents:function(){
return this.getContent();
},getContent:function(){
return _1.dom.getChildElementTextContentNS(this.e,"content",_1.dom.ATOM_NAMESPACE);
},getAuthor:function(){
if(!this.author){
this.author=new com.ibm.social.ee.bean.User(_1.dom.getElementsByTagNameNS(this.e,"author",_1.dom.ATOM_NAMESPACE)[0]);
}
return this.author;
},getOwner:function(){
return this.getAuthor();
},getCreator:function(){
return this.getAuthor();
},getUpdated:function(){
if(!this.updated){
this.updated=_1.misc.date.convertAtomDate(_1.dom.getChildElementTextContentNS(this.e,"updated",_1.dom.ATOM_NAMESPACE));
if(!this.updated){
this.throwRequiredPropertyError("updated");
}
}
return this.updated;
},getPublished:function(){
if(!this.published){
this.published=_1.misc.date.convertAtomDate(_1.dom.getChildElementTextContentNS(this.e,"published",_1.dom.ATOM_NAMESPACE));
if(!this.published){
this.throwRequiredPropertyError("published");
}
}
return this.published;
},getUrlDownload:function(){
return this.prependBase(_1.dom.getChildElementAttributeMatchingNS(this.e,"link",_1.dom.ATOM_NAMESPACE,"rel",null,"enclosure","href"));
},getUrlAlternate:function(){
return _1.dom.getChildElementAttributeMatchingNS(this.e,"link",_1.dom.ATOM_NAMESPACE,"rel",null,"alternate","href",null,true);
},getUrlEntry:function(){
return this.prependBase(_1.uri.makeAtomUrlIESafe(_1.dom.getChildElementAttributeMatchingNS(this.e,"link",_1.dom.ATOM_NAMESPACE,"rel",null,"self","href")));
},getUrlFeed:function(){
return this.prependBase(_1.uri.makeAtomUrlIESafe(_1.dom.getChildElementAttributeMatchingNS(this.e,"link",_1.dom.ATOM_NAMESPACE,"rel",null,"replies","href")));
},getId:function(){
if(!this.id){
this.id=_1.dom.getChildElementTextContentNS(this.e,"uuid",_1.dom.DOCUMENTS_ATOM_NAMESPACE);
if(!this.id||this.id.length===0){
this.id=_1.dom.getChildElementTextContentNS(this.e,"id",_1.dom.ATOM_NAMESPACE);
var _6="urn:lsid:ibm.com:td:";
var _7=this.id.indexOf(_6);
if(_7!=-1){
this.id=this.id.substring(_7+_6.length);
}
}
}
return this.id;
},getLabel:function(){
return _1.dom.getChildElementTextContentNS(this.e,"label",_1.dom.DOCUMENTS_ATOM_NAMESPACE);
},getName:function(){
var _8=this.getLabel();
if(!_8||_8.length===0){
_8=this.getTitle();
}
return _8;
},getModifier:function(){
if(!this.modifier){
this.modifier=new com.ibm.social.ee.bean.User(_1.dom.getElementsByTagNameNS(this.e,"modifier",_1.dom.DOCUMENTS_ATOM_NAMESPACE)[0]);
}
return this.modifier;
},getPermissions:function(){
if(!this.permissions){
this.permissions=this._getPermissions("permissions");
}
return this.permissions;
},_getPermissions:function(_9){
var s=_1.dom.getChildElementTextContentNS(this.e,_9,_1.dom.DOCUMENTS_ATOM_NAMESPACE);
var p={View:true};
if(s){
s=_1.text.trim(s);
dojo.forEach(s.split(/\s*,\s*/),function(a){
if(a&&a.length>0){
p[a]=true;
}
});
}
return p;
},getModified:function(){
if(!this.modified){
this.modified=_1.misc.date.convertAtomDate(_1.dom.getChildElementTextContentNS(this.e,"modified",_1.dom.DOCUMENTS_ATOM_NAMESPACE))||this.getUpdated();
}
return this.modified;
},getCreated:function(){
if(!this.created){
this.created=_1.misc.date.convertAtomDate(_1.dom.getChildElementTextContentNS(this.e,"created",_1.dom.DOCUMENTS_ATOM_NAMESPACE))||this.getPublished();
}
return this.created;
},throwRequiredPropertyError:function(_a){
console.error("Property '"+_a+"' is required");
}});
})();
}


;if(!dojo._hasResource["com.ibm.social.ee.bean.File"]){
dojo._hasResource["com.ibm.social.ee.bean.File"]=true;
dojo.provide("com.ibm.social.ee.bean.File");






(function(){
var _1=com.ibm.social.incontext.util;
dojo.declare("com.ibm.social.ee.bean.File",[com.ibm.social.ee.bean.AtomBean],{getSize:function(){
if(typeof this.size=="undefined"){
this.size=_1.text.parseInt(_1.dom.getChildElementAttributeMatchingNS(this.e,"link",_1.dom.ATOM_NAMESPACE,"rel",null,"enclosure","length",null));
}
return this.size;
},getTotalMediaSize:function(){
if(typeof this.totalSize=="undefined"){
this.totalSize=_1.text.parseInt(_1.dom.getChildElementTextContentNS(this.e,"totalMediaSize",_1.dom.DOCUMENTS_ATOM_NAMESPACE));
}
return this.totalSize;
},getTags:function(){
if(!this.tags){
var _2=[];
for(var i=0;i<this.e.childNodes.length;i++){
var _3=this.e.childNodes[i];
if(_3.nodeName=="category"&&_3.getAttribute("scheme")===null){
_2.push(_3.getAttribute("term"));
}
}
this.tags=_2;
}
return this.tags;
},getVisibility:function(){
if(!("visibility" in this)){
this.visibility=_1.dom.getChildElementTextContentNS(this.e,"visibility",_1.dom.DOCUMENTS_ATOM_NAMESPACE);
}
return this.visibility;
},getUrlRendition:function(){
return this.prependBase(_1.dom.getChildElementAttributeMatchingNS(this.e,"link",_1.dom.ATOM_NAMESPACE,"rel",null,"rendition","href"));
}});
})();
}


;if(!dojo._hasResource["com.ibm.social.ee.data.QCSFeedDataStore"]){
dojo._hasResource["com.ibm.social.ee.data.QCSFeedDataStore"]=true;
dojo.provide("com.ibm.social.ee.data.QCSFeedDataStore");










(function(){
var tu=com.ibm.social.incontext.util.text;
var du=com.ibm.social.incontext.util.dom;
dojo.declare("com.ibm.social.ee.data.QCSFeedDataStore",[com.ibm.social.ee.data.FeedDataStore],{_domBuilder:new com.ibm.social.ee.data.DomBuilder(),getTotalItems:function(el){
return parseInt(du.getChildElementTextContentNS(el,"totalResults",du.OPENSEARCH_NAMESPACE));
},getStdParams:function(_1){
var _2={};
if(dojo.isIE){
_2.format="xml";
}
var _3=null;
if(_1.start){
_3=_1.start+1;
}
if(_3){
_2.sI=_3;
}
if(_1.count){
_2.pageSize=_1.count;
}
if(_1.sort&&_1.sort.length>0){
_2.sK=_1.sort[0].attribute;
_2.sO=(_1.sort[0].descending)?"dsc":"asc";
}
return _2;
},getCategory:function(el){
return du.getChildElementAttribute(el,"category","term");
},getDeleteHandleAs:function(){
return "text";
},itemFromDocElAndCat:function(el,_4,_5,_6){
return new com.ibm.social.ee.bean.File(el,_4);
}});
})();
}


;if(!dojo._hasResource["com.ibm.social.ee.data.RecommendationsDataStore"]){
dojo._hasResource["com.ibm.social.ee.data.RecommendationsDataStore"]=true;
dojo.provide("com.ibm.social.ee.data.RecommendationsDataStore");


dojo.declare("com.ibm.social.ee.data.RecommendationsDataStore",[com.ibm.social.ee.data.QCSFeedDataStore],{constructor:function(){
this.baseCount=this.recommendCount-(this.hasRecommended?1:0);
},_getIdentifierAttribute:function(){
return "id";
},fetchItemByIdentity:function(_1){
if(!this.authUser.ds){
this.authUser.isFullyLoaded=true;
this.authUser.ds={isDirty:false,isDeleted:false,isNew:false,attributes:{}};
}
if(_1.onItem){
_1.onItem.apply(this,[this.hasRecommended?this.authUser:null]);
}
},isItem:function(_2){
if("id" in _2){
return true;
}
return false;
},getValue:function(_3,_4,_5){
if(_4 in _3){
return _3[_4];
}
return _5;
},dataLoaded:function(_6,_7){
var _8=_8?_8:{};
var _9=_6.items?_6.items:[];
for(var i=0;i<_7.items.length;i++){
var _a=_7.items[i];
_a.isFullyLoaded=true;
_a.ds={isDirty:false,isDeleted:false,isNew:false,attributes:{}};
_9.push(_a);
}
this.totalItems=_7.totalSize;
var _b=(_6.scope)?_6.scope:dojo.global;
if(_6.onBegin){
_6.onBegin.call(_b,this.totalItems,_6);
}
if(_6.onItem){
for(i=0;i<_9.length;i++){
_6.onItem.call(_b,_9[i],_6);
}
}
if(_6.onComplete){
var _c=(_6.onItem)?null:_9;
_6.onComplete.call(_b,_c,_6);
}
},getFetchHandleAs:function(){
return "json";
},_fetch:function(_d){
if(!this.countOnly){
var _e=this._addAddtlParams(_d);
var _f=com.ibm.social.incontext.util.uri.rewriteUri(this.url,_e);
_d.url=_f;
_d.params=_e;
this.inherited(arguments,[_d]);
}else{
this.dataLoaded(_d,{items:[],totalSize:this.recommendCount});
}
},_addAddtlParams:function(_10){
_10.sort=[{attribute:"createdByName",descending:false}];
var _11=this.getStdParams(_10);
_11.format="json";
return _11;
},_getNewItemUrl:function(_12){
return this.documentFeed;
},_getPostBody:function(_13){
return this.inherited(arguments,[{category:"recommendation"}]);
},_newItem:function(_14,_15){
_15.recommending=true;
dojo.publish("com/ibm/social/ee/like/beforeLike");
this.inherited(arguments);
},_saveItemComplete:function(_16,_17,_18,_19,_1a){
_16.isFullyLoaded=false;
_16.ds.isDirty=false;
_16.ds.isNew=false;
if(_17.requests){
_17.requests--;
}
var _1b=_17.scope?_17.scope:dojo.global;
var _1c;
if(typeof _18=="Error"||_18 instanceof Error){
_1c=_18;
}else{
_1c=com.ibm.social.incontext.util.atom.getError(_18,_19);
}
if(_1c&&_1c.code){
if(_17.onError){
_17.onError.call(_1b,_1c);
}
return;
}else{
if(_16.setDocumentElement&&_18&&_18.documentElement){
_16.setDocumentElement(_18.documentElement);
}
}
if((!_17.requests||_17.requests===0)&&_17.onComplete){
if(_17.recommending){
this.hasRecommended=true;
this.recommendCount=this.baseCount+1;
this.captureResponseUrl(_18);
dojo.publish("com/ibm/social/ee/like/liked");
}else{
this.hasRecommended=false;
this.recommendCount=this.baseCount;
dojo.publish("com/ibm/social/ee/like/unliked");
}
_17.onComplete.call(_1b,_18,_19);
}
},_deleteItem:function(_1d,_1e){
_1e.recommending=false;
dojo.publish("com/ibm/social/ee/like/beforeUnlike");
this.inherited(arguments);
},_getDeleteItemUrl:function(_1f){
return this.entryUrl;
},captureResponseUrl:function(_20){
}});
}


window['_js_modules']=(window['_js_modules']||[]).concat(["lconn.core.bundle_common"]);
