window.___jsl=window.___jsl||{};
(window.___jsl.ci=window.___jsl.ci||[]).push({container:{relayPath:"/connections/opensocial/gadgets/files/container/rpc_relay.html",enableRpcArbitration:!0},rpc:{passReferrer:"c2p:query",commSwf:"/connections/opensocial/xpc.swf",useLegacyProtocol:!1,parentRelayUrl:"/container/rpc_relay.html",rpcDelay:1},"core.io":{unparseableCruft:"throw 1; \x3c 'invalid javascript' \x3e",nonceUrl:"//%host%/connections/opensocial/gadgets/nonceRequest",proxyUrl:"//apps.na.collabserv.com/connections/opensocial/gadgets/proxy%filename%?container\x3d%container%\x26refresh\x3d%refresh%\x26url\x3d%url%\x26stream\x3d%stream%%authz%%rewriteMime%",jsonProxyUrl:"//%host%/connections/opensocial/gadgets/makeRequest",
appendTokenAlways:!0},"osapi.services":{"gadgets.rpc":["container.listMethods"],"//%host%/connections/opensocial/rpc":"gadgets.supportedFields gadgets.cajole http.head http.post scpeople.get people.update legacy-scpeople.get http.delete activitystreams.delete gadgets.metadata activitystreams.supportedFields customlist.post gadgets.proxySupportedFields ublog.delete activitystreams.create gadgets.proxy cache.invalidate people.supportedFields http.put customlist.delete gadgets.cajaSupportedFields activitystreams.get customlist.put gadgets.js http.get gadgets.token ublog.create activitystreams.update legacy-scpeople.update system.listMethods gadgets.tokenSupportedFields customlist.get gadgets.jsSupportedFields people.get scpeople.supportedFields scpeople.update legacy-scpeople.supportedFields ublog.get".split(" ")},
osapi:{endPoints:["//%host%/connections/opensocial/rpc"]},opensocial:{invalidatePath:"http://%host%/connections/opensocial/rpc",domain:"shindig",path:"http://%host%/connections/opensocial/rpc",supportedFields:{activityEntry:"actor content generator icon id object published provider target title updated url verb".split(" "),person:["id",{name:["familyName","givenName","unstructured"]},"thumbnailUrl","profileUrl"],activity:"appId body bodyId externalId id mediaItems postedTime priority streamFaviconUrl streamSourceUrl streamTitle streamUrl templateParams title url userId".split(" ")},
enableCaja:!1},"cre.config":{container:"default"},"shindig-container":{serverBase:"/connections/opensocial/gadgets/"},views:{"default":{urlTemplate:"http://localhost/connections/opensocial/gadgets/default?{var}",isOnlyVisible:!1,aliases:["home","profile","canvas"]},canvas:{urlTemplate:"http://localhost/connections/opensocial/gadgets/canvas?{var}",isOnlyVisible:!0,aliases:["FULL_PAGE"]},profile:{urlTemplate:"http://localhost/connections/opensocial/gadgets/profile?{var}",isOnlyVisible:!1,aliases:["DASHBOARD",
"default"]}}});window.___jsl=window.___jsl||{};window['___jsl']['f'] = ['actions','auth-refresh','com.ibm.connections.ee','com.ibm.connections.sharedialog','container','container.nongadget','container.site','container.site.gadget','container.site.url','container.util','core','core.config','core.config.base','core.io','core.json','core.legacy','core.log','core.prefs','core.util','core.util.base','core.util.dom','core.util.event','core.util.onload','core.util.string','core.util.urlparams','cre.config','cre.constants','cre.constants.services','cre.endpoint','cre.globals','cre.iruntime','cre.iwidget','cre.iwidget.event','cre.iwidget.iscopeService','cre.iwidget.itemset','cre.localehelper','cre.messages.en','cre.oah','cre.osgadget','cre.promise','cre.resourcemanager','cre.service.event','cre.service.people','cre.service.people_1.1','cre.service.proxy','cre.service.uri','cre.servicemanager','cre.util','cre.util.array','cre.util.function','cre.util.json','cre.util.json.extended','cre.util.loop','cre.util.object','cre.util.object.extended','cre.util.string','cre.util.token','cre.wire','cre.xhr','domnode','dynamic-height','dynamic-height.height','dynamic-size.util','embedded-experiences','enabler.constants.iwidget','gadgets.json.ext','globals','ibm.connections.ee','ibm.connections.sharedialog','locked-domain','open-views','open-views.common','open-views.ee','open-views.gadget','open-views.results','open-views.url','opensocial','opensocial-base','opensocial-data-context','opensocial-jsonrpc','opensocial-reference','org.openajax.hub-2.0.7','osapi','osapi.base','pubsub-2','rpc','security-token','selection','shared-script-frame','shindig-container','shindig.auth','shindig.sha1','shindig.uri','shindig.uri.ext','taming','views','xmlutil'];gadgets=window.gadgets||{};shindig=window.shindig||{};osapi=window.osapi||{};var DOM_ELEMENT_NODE=1,DOM_ATTRIBUTE_NODE=2,DOM_TEXT_NODE=3,DOM_CDATA_SECTION_NODE=4,DOM_ENTITY_REFERENCE_NODE=5,DOM_ENTITY_NODE=6,DOM_PROCESSING_INSTRUCTION_NODE=7,DOM_COMMENT_NODE=8,DOM_DOCUMENT_NODE=9,DOM_DOCUMENT_TYPE_NODE=10,DOM_DOCUMENT_FRAGMENT_NODE=11,DOM_NOTATION_NODE=12;var safeJSON=window.safeJSON,tamings___=window.tamings___||[],bridge___,caja___=window.caja___,___=window.___;window.gadgets.config||(gadgets.config=function(){function l(a,b){for(var e in b)b.hasOwnProperty(e)&&("object"===typeof a[e]&&"object"===typeof b[e]?l(a[e],b[e]):a[e]=b[e])}function q(a){var b="";if(a.nodeType==DOM_TEXT_NODE||a.nodeType==DOM_CDATA_SECTION_NODE)b=a.nodeValue;else if(a.innerText)b=a.innerText;else if(a.innerHTML)b=a.innerHTML;else if(a.firstChild){b=[];for(a=a.firstChild;a;a=a.nextSibling)b.push(q(a));b=b.join("")}return b}function r(a){var b=(f["core.io"]||{}).jsPath||null,e=[],d=
0,c=document.scripts||document.getElementsByTagName("script");if(c&&0!=c.length){for(var h=0;h<c.length;++h){var g=c[h].src,k=null!=b&&g&&g.indexOf(b)||-1;-1!=k&&/.*[.]js.*[?&]c=[01](#|&|$).*/.test(g.substring(k+b.length))&&(e[d++]=c[h])}e.length||(b=c[c.length-1],b.src&&(e[0]=b))}if(e.length)for(b=0;b<e.length;b++){d=q(e[b]);c=void 0;try{c=(new Function("return ("+d+"\n)"))()}catch(n){}if("object"===typeof c)d=c;else{try{c=(new Function("return ({"+d+"\n})"))()}catch(p){}d="object"===typeof c?c:
{}}m.f&&1==m.f.length&&!d[m.f[0]]&&(c={},c[m.f[0]]=d,d=c);l(a,d);(d=window.___cfg)&&l(a,d)}}function p(a){for(var b in k)if(k.hasOwnProperty(b))for(var e=k[b],d=0,c=e.length;d<c;++d)a(b,e[d])}var m,k={},f={},n=!1;return{register:function(a,b,e,d){var c=k[a];c||(c=[],k[a]=c);c.push({validators:b||{},callback:e,callOnUpdate:d});n&&e&&e(f)},get:function(a){return a?f[a]||{}:f},init:function(a,b){m=window.___jsl||{};l(f,a);r(f);l(f,window.___config||{});p(function(a,d){var c=f[a];if(c&&!b){var h=d.validators,
g;for(g in h)if(h.hasOwnProperty(g)&&!h[g](c[g]))throw Error('Invalid config value "'+c[g]+'" for parameter "'+g+'" in component "'+a+'"');}d.callback&&d.callback(f)});n=!0},update:function(a,b){var e=[];p(function(c,d){(a.hasOwnProperty(c)||b&&f&&f[c])&&d.callback&&d.callOnUpdate&&e.push(d.callback)});f=b?{}:f||{};l(f,a);for(var d=0,c=e.length;d<c;++d)e[d](f)},clear:function(){gadgets.warn("This method is for testing.");m=void 0;f={};n=!1}}}());gadgets.log=function(){function d(a,c){"undefined"===typeof b&&(b=window.console?window.console:window.opera?window.opera.postError:null);!(a<f)&&b&&(a===e&&b.warn?b.warn(c):a===g&&b.error?b.error(c):b.log&&b.log(c))}var e=2,g=3,c=function(a){d(1,a)};gadgets.warn=function(a){d(e,a)};gadgets.error=function(a){d(g,a)};gadgets.setLogLevel=function(a){f=a};c.INFO=1;c.WARNING=e;c.NONE=4;var f=1,b;return c}();gadgets.util=gadgets.util||{};
(function(){var e=null;gadgets.util.getUrlParameters=function(a){var g="undefined"===typeof a;if(null!==e&&g)return e;var f={};a=a||document.location.href;var d=a.indexOf("?"),b=a.indexOf("#");a=(-1===b?a.substr(d+1):[a.substr(d+1,b-d-1),"\x26",a.substr(b+1)].join("")).split("\x26");for(var d=window.decodeURIComponent?decodeURIComponent:unescape,b=0,h=a.length;b<h;++b){var c=a[b].indexOf("\x3d");if(-1!==c){var k=a[b].substring(0,c),c=a[b].substring(c+1),c=c.replace(/\+/g," ");try{f[k]=d(c)}catch(l){}}}g&&
(e=f);return f}})();gadgets.util.getUrlParameters();(function(){gadgets.config.EnumValidator=function(a){var c=[];if(1<arguments.length)for(var b=0,d;d=arguments[b];++b)c.push(d);else c=a;return function(a){for(var b=0;c[b];++b)if(a===c[b])return!0;return!1}};gadgets.config.RegExValidator=function(a){return function(c){return a.test(c)}};gadgets.config.ExistsValidator=function(a){return"undefined"!==typeof a};gadgets.config.NonEmptyStringValidator=function(a){return"string"===typeof a&&0<a.length};gadgets.config.BooleanValidator=function(a){return"boolean"===
typeof a};gadgets.config.LikeValidator=function(a){return function(c){for(var b in a)if(a.hasOwnProperty(b)&&!(0,a[b])(c[b]))return!1;return!0}}})();gadgets.util=gadgets.util||{};gadgets.util.makeClosure=function(e,c,a){for(var d=[],b=2,f=arguments.length;b<f;++b)d.push(arguments[b]);return function(){for(var a=d.slice(),b=0,f=arguments.length;b<f;++b)a.push(arguments[b]);return c.apply(e,a)}};gadgets.util.makeEnum=function(e){var c,a,d={};for(c=0;a=e[c];++c)d[a]=a;return d};gadgets.util.shouldPollXhrReadyStateChange=function(){return document.all&&!document.querySelector?!0:!1};gadgets.util=gadgets.util||{};
(function(){gadgets.util.createElement=function(a){var b;if(!document.body||document.body.namespaceURI)try{b=document.createElementNS("http://www.w3.org/1999/xhtml",a)}catch(d){}return b||document.createElement(a)};gadgets.util.createIframeElement=function(a){var b=gadgets.util.createElement("iframe");try{var d,c=["\x3c","iframe"],g=a||{},e;for(e in g)g.hasOwnProperty(e)&&(c.push(" "),c.push(e),c.push('\x3d"'),c.push(gadgets.util.escapeString(g[e])),c.push('"'));c.push("\x3e\x3c/");c.push("iframe");
c.push("\x3e");d=c.join("");var f=gadgets.util.createElement(d);if(f&&(!b||f.tagName==b.tagName&&f.namespaceURI==b.namespaceURI))b=f}catch(k){}d=b;a=a||{};for(var h in a)a.hasOwnProperty(h)&&(d[h]=a[h]);return b};gadgets.util.getBodyElement=function(){if(document.body)return document.body;try{var a=document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","body");if(a&&1==a.length)return a[0]}catch(b){}return document.documentElement||document}})();gadgets.util=gadgets.util||{};gadgets.util.attachBrowserEvent=function(a,b,c,d){"undefined"!=typeof a.addEventListener?a.addEventListener(b,c,d):"undefined"!=typeof a.attachEvent?a.attachEvent("on"+b,c):gadgets.warn("cannot attachBrowserEvent: "+b)};gadgets.util.removeBrowserEvent=function(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent?a.detachEvent("on"+b,c):gadgets.warn("cannot removeBrowserEvent: "+b)};gadgets.util=gadgets.util||{};
(function(){var c=[];gadgets.util.registerOnLoadHandler=function(a){c.push(a)};window.__preOnLoadHandlers="undefined"!==typeof window.__preOnLoadHandlers?window.__preOnLoadHandlers:[];gadgets.util.registerPreOnLoadHandler=function(a){window.__preOnLoadHandlers.push(a)};window.__postOnLoadHandlers="undefined"!==typeof window.__postOnLoadHandlers?window.__postOnLoadHandlers:[];gadgets.util.registerPostOnLoadHandler=function(a){window.__postOnLoadHandlers.push(a)};var d=!1;gadgets.util.runOnLoadHandlers=
function(){if("undefined"!==typeof featureSetsToLoad&&0<featureSetsToLoad)gadgets.util.isDebug&&gadgets.util.isDebug()&&console.log("featureSetsToLoad \x3d "+featureSetsToLoad+", retrying runOnLoadHandlers in 100mS"),gadgets.util._onLoadHandlerTimeoutId&&clearTimeout(gadgets.util._onLoadHandlerTimeoutId),gadgets.util._onLoadHandlerTimeoutId=setTimeout("gadgets.util.runOnLoadHandlers()",50);else if(d){clearTimeout(gadgets.util._onLoadHandlerTimeoutId);gadgets.util._onLoadHandlerTimeoutId=null;gadgets.util.registerPreOnLoadHandler=
function(a){a()};if(window.__preOnLoadHandlers&&0<window.__preOnLoadHandlers.length){for(var a=0,b=window.__preOnLoadHandlers.length;a<b;a++)try{window.__preOnLoadHandlers[a]()}catch(h){gadgets.warn("Could not fire preonloadhandler["+a+"] "+h.message)}window.__preOnLoadHandlers=void 0}gadgets.util.registerOnLoadHandler=function(a){a()};if(c){a=0;for(b=c.length;a<b;++a)try{c[a]()}catch(e){gadgets.warn("Could not fire onloadhandler["+a+"] "+e.message)}c=void 0}gadgets.util.registerPostOnLoadHandler=
function(a){a()};if(window.__postOnLoadHandlers&&0<window.__postOnLoadHandlers.length){a=0;for(b=window.__postOnLoadHandlers.length;a<b;a++)try{window.__postOnLoadHandlers[a]()}catch(f){gadgets.warn("Could not fire postonloadhandler["+a+"] "+f.message)}window.__postOnLoadHandlers=void 0}}else d=!0,setTimeout("gadgets.util.runOnLoadHandlers()",10)};window.setTimeout&&(gadgets.util._onLoadHandlerTimeoutId=setTimeout("gadgets.util.runOnLoadHandlers();",50));(function(){gadgets.util.attachBrowserEvent(document,
"DOMContentLoaded",gadgets.util.runOnLoadHandlers,!1);var a=window.onload;window.onload=function(){a&&a();gadgets.util.runOnLoadHandlers()};var b="";window&&(window.location&&window.location.href)&&(b=gadgets.util.getUrlParameters(window.location.href).libs);if(b=/(?:js\/)([^&|\.]+)/g.exec(b))for(var b=decodeURIComponent(b[1]),c=document.getElementsByTagName("script")||[],e=0;e<c.length;e++){var f=c[e],d=f.src;if(d&&b&&-1!==d.indexOf(b)){var g=f.onload;f.onload=function(){g&&g();gadgets.util.runOnLoadHandlers()}}}})()})();gadgets.util=gadgets.util||{};
(function(){function f(a,d){return String.fromCharCode(d)}var g={"0":!1,10:!0,13:!0,34:!0,39:!0,60:!0,62:!0,92:!0,8232:!0,8233:!0,65282:!0,65287:!0,65308:!0,65310:!0,65340:!0};gadgets.util.escape=function(a,d){if(a){if("string"===typeof a)return gadgets.util.escapeString(a);if("array"===typeof a)for(var b=0,c=a.length;b<c;++b)a[b]=gadgets.util.escape(a[b]);else if("object"===typeof a&&d){b={};for(c in a)a.hasOwnProperty(c)&&(b[gadgets.util.escapeString(c)]=gadgets.util.escape(a[c],!0));return b}}return a};
gadgets.util.escapeString=function(a){if(!a)return a;for(var d=[],b,c,e=0,f=a.length;e<f;++e)b=a.charCodeAt(e),c=g[b],!0===c?d.push("\x26#",b,";"):!1!==c&&d.push(a.charAt(e));return d.join("")};gadgets.util.unescapeString=function(a){return!a?a:a.replace(/&#([0-9]+);/g,f)}})();gadgets.util=gadgets.util||{};
(function(){function f(a){a=(a=a["core.io"])&&a.jsPath;for(var b=document.getElementsByTagName("script"),c=0;a&&c<b.length;c++){var d=b[c].src;if(d&&-1<d.indexOf(a))return e="1"==gadgets.util.getUrlParameters(d).debug}e=!1}function g(a){b=a["core.util"]||{}}var b={},h={},e;gadgets.config&&(gadgets.config.register("core.util",null,g),gadgets.config.register("core.io",void 0,f,f));gadgets.util.getFeatureParameters=function(a){return"undefined"===typeof b[a]?null:b[a]};gadgets.util.hasFeature=function(a){return"undefined"!==
typeof b[a]};gadgets.util.getServices=function(){return h};gadgets.util.isDebug=function(){return e}})();"undefined"===typeof shindig.uri&&(shindig.uri=function(){var E=/^(?:([^:/?#]+):)?(?:\/\/([^/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/;return function(k){function r(a){if(null===a.match(E))throw"Malformed URL: "+a;l=RegExp.$1;m=RegExp.$2;p=RegExp.$3;g=RegExp.$4;h=RegExp.$5}function s(a){for(var b=[],d=0,F=a.length;d<F;++d){var n=a[d][0],c=a[d][1];"undefined"!=typeof c&&b.push(t(n)+(null!==c?"\x3d"+t(c):""))}return b.join("\x26")}function u(){c&&(g=s(c),c=null);return g}function v(){f&&(h=s(f),f=null);
return h}function w(a){c=c||q(g);return x(c,a)}function y(a){f=f||q(h);return x(f,a)}function z(a,b){c=A(c||q(g),a,b);return e}function B(a,b){f=A(f||q(h),a,b);return e}function C(){return[l,""!==l?":":"",""!==m?"//":"",m].join("")}function q(a){var b=[];if(""===a)return b;a=a.split("\x26");for(var d=0,c=a.length;d<c;++d){var n=a[d].split("\x3d"),f=n.shift(),e=null;0<n.length&&(e=n.join("").replace(/\+/g," "));b.push([f,null!=e?G(e):null])}return b}function x(a,b){for(var d=0,c=a.length;d<c;++d)if(a[d][0]==
b)return a[d][1]}function A(a,b,d){var c=b;"string"===typeof b&&(c={},c[b]=d);for(var e in c){b=!1;d=0;for(var f=a.length;!b&&d<f;++d)a[d][0]==e&&(a[d][1]=c[e],b=!0);b||a.push([e,c[e]])}return a}function D(a,b){a=a||"";a[0]===b&&(a=a.substr(b.length));return a}var l="",m="",p="",g="",c=null,h="",f=null,G=window.decodeURIComponent?decodeURIComponent:unescape,t=window.encodeURIComponent?encodeURIComponent:escape,e=null;"object"===typeof k&&"function"===typeof k.toString?r(k.toString()):k&&r(k);return e=
{getSchema:function(){return l},getAuthority:function(){return m},getOrigin:C,getPath:function(){return p},getQuery:u,getFragment:v,getQP:w,getFP:y,setSchema:function(a){l=a;return e},setAuthority:function(a){m=a;return e},setPath:function(a){"undefined"!==typeof a&&null!=a&&(p=("/"===a.charAt(0)?"":"/")+a);return e},setQuery:function(a){c=null;g=D(a,"?");return e},setFragment:function(a){f=null;h=D(a,"#");return e},setQP:z,setFP:B,setExistingP:function(a,b){"undefined"!=typeof w(a,b)&&z(a,b);"undefined"!=
typeof y(a,b)&&B(a,b);return e},removePrefix:function(a){return 0==a.indexOf("http://")?a.substr(7):0==a.indexOf("https://")?a.substr(8):0==a.indexOf("//")?a.substr(2):a},toString:function(){var a=u(),b=v();return[C(),p,""!==a?"?":"",a,""!==b?"#":"",b].join("")}}}}());window.JSON&&(window.JSON.parse&&window.JSON.stringify)&&(gadgets.json=function(){function d(a,b){return this[a]}var e=/___$/;return{parse:function(a){try{return window.JSON.parse(a)}catch(b){return!1}},stringify:function(a){function b(a){return c.call(this,a,d)}var c=window.JSON.stringify,f=Array.prototype.toJSON&&'"[{\\"x\\": 1}]"'===c([{x:1}])?b:c;try{return f(a,function(a,b){return!e.test(a)?b:void 0})}catch(g){return null}}}}());if(!window.JSON||!window.JSON.parse||!window.JSON.stringify)gadgets.json=function(){function c(a){return 10>a?"0"+a:a}function e(a){var d,b,c;d=/[\"\\\x00-\x1f\x7f-\x9f]/g;switch(typeof a){case "string":return d.test(a)?'"'+a.replace(d,function(a){var b=f[a];if(b)return b;b=a.charCodeAt();return"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16)})+'"':'"'+a+'"';case "number":return isFinite(a)?String(a):"null";case "boolean":case "null":return String(a);case "object":if(!a)return"null";d=[];
if("number"===typeof a.length&&!a.propertyIsEnumerable("length")){c=a.length;for(b=0;b<c;b+=1)d.push(e(a[b])||"null");return"["+d.join(",")+"]"}for(b in a)!/___$/.test(b)&&a.hasOwnProperty(b)&&"string"===typeof b&&(c=e(a[b]))&&d.push(e(b)+":"+c);return"{"+d.join(",")+"}"}return""}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",c(this.getUTCMonth()+1),"-",c(this.getUTCDate()),"T",c(this.getUTCHours()),":",c(this.getUTCMinutes()),":",c(this.getUTCSeconds()),"Z"].join("")};var f={"\b":"\\b",
"\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return{stringify:e,parse:function(a){return/^[\],:{}\s]*$/.test(a.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))?eval("("+a+")"):!1}}}();gadgets.json.flatten=function(a){var c={};if(null===a||"undefined"==typeof a)return c;for(var d in a)if(a.hasOwnProperty(d)){var b=a[d];null===b||"undefined"==typeof b||(c[d]="string"===typeof b?b:gadgets.json.stringify(b))}return c};shindig.Auth=function(){function g(a){for(var b=c.split("\x26"),f=0;f<b.length;f++){var d=b[f].split("\x3d");if(2===d.length){var e=d[0],d=d[1];"$"===d&&(d=encodeURIComponent(a[e]),b[f]=e+"\x3d"+d)}}c=b.join("\x26")}var c=null,e=null;gadgets.config.register("shindig.auth",null,function(a){var b=gadgets.util.getUrlParameters();a=a["shindig.auth"]||{};a.authToken?c=a.authToken:b.st&&(c=b.st);null!==c&&g(b);a.trustedJson&&(e=eval("("+a.trustedJson+")"))});return{getSecurityToken:function(){return c},
updateSecurityToken:function(a){c=a},getTrustedData:function(){return e}}};shindig&&!shindig.auth&&(shindig.auth=new shindig.Auth);gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.wpm||(gadgets.rpctx.wpm=function(){function g(a,b,c){"undefined"!=typeof window.addEventListener?window.addEventListener(a,b,c):"undefined"!=typeof window.attachEvent&&window.attachEvent("on"+a,b)}function h(a){var b=gadgets.json.parse(a.data);if(b&&b.f){var c=gadgets.rpc.getTargetOrigin(b.f);(!e||!("undefined"!==typeof a.origin?a.origin!==c:a.domain!==/^.+:\/\/([^:]+).*/.exec(c)[1]))&&f(b,a.origin)}}var f,d,e=!0;return{getCode:function(){return"wpm"},isParentVerifiable:function(){return!0},
init:function(a,b){gadgets.config.register("rpc",null,function(a){if("true"===String((a?a.rpc:{}).disableForceSecure))e=!1});f=a;d=b;g("message",h,!1);d("..",!0);return!0},setup:function(a,b){d(a,!0);return!0},call:function(a,b,c){var d=gadgets.rpc.getTargetOrigin(a),e=gadgets.rpc._getTargetWin(a);d?window.setTimeout(function(){e.postMessage(gadgets.json.stringify(c),d)},0):gadgets.error("No relay set (used as window.postMessage targetOrigin), cannot send cross-domain message");return!0}}}());gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.flash||(gadgets.rpctx.flash=function(){function k(a,b){p[b]=p[b]||function(){a.apply({},arguments)};return q+"."+b}function r(){if(null===c&&document.body&&l){var a=l+"?cb\x3d"+Math.random()+"\x26origin\x3d"+I+"\x26jsl\x3d1",b=document.createElement("div");b.style.height="1px";b.style.width="1px";a='\x3cobject height\x3d"1" width\x3d"1" id\x3d"'+J+'" type\x3d"application/x-shockwave-flash"\x3e\x3cparam name\x3d"allowScriptAccess" value\x3d"always"\x3e\x3c/param\x3e\x3cparam name\x3d"movie" value\x3d"'+a+
'"\x3e\x3c/param\x3e\x3cembed type\x3d"application/x-shockwave-flash" allowScriptAccess\x3d"always" src\x3d"'+a+'" height\x3d"1" width\x3d"1"\x3e\x3c/embed\x3e\x3c/object\x3e';document.body.appendChild(b);b.innerHTML=a;c=b.firstChild}++s;null!==e&&(null!==c||s>=K)?window.clearTimeout(e):e=window.setTimeout(r,t)}function u(){m[".."]||(v(".."),w++,w>=L&&null!==g?(window.clearTimeout(g),g=null):g=window.setTimeout(u,x))}function n(){if(null!==c&&c.setup){for(;0<h.length;){var a=h.shift(),b=a.targetId,
a=a.token;if(void 0===a||null===a||""===a)a=y;c.setup(a,".."===b?gadgets.rpc.RPC_ID:b,".."===b?"INNER":"OUTER")}null!==f&&(window.clearTimeout(f),f=null)}else 0<h.length&&z<M&&(z++,null!==f&&(window.clearTimeout(f),f=null),f=window.setTimeout(n,N))}function A(){n();null!==e&&window.clearTimeout(e);e=null}function B(){!m[".."]&&null===g&&(g=window.setTimeout(u,x))}function C(a,b,e){if(!c||null===c)return!0;b=gadgets.rpc.getTargetOrigin(a);var d=gadgets.rpc.getAuthToken(a);if(void 0===d||null===d||
""===d)d=y;a="sendMessage_"+(".."===a?gadgets.rpc.RPC_ID:a)+"_"+d+"_"+(".."===a?"INNER":"OUTER");d=c[a];if(!d||null===d)return"undefined"!==typeof console&&(null!==console&&"undefined"!==typeof console.log&&null!==console.log)&&console.log("There isn't message handler was found for the target message and then returning false, handleKey \x3d "+a),!1;d.call(c,gadgets.json.stringify(e),b);return!0}function D(a,b,c){var d=gadgets.json.parse(a);(a=d[E])?(F(a,!0),m[a]=!0,".."!==a&&v(a,!0)):window.setTimeout(function(){G(d,
b)},0)}function v(a,b){var c=gadgets.rpc.RPC_ID,d={};d[E]=b?"..":c;d[O]=c;C(a,c,d)}var J="___xpcswf",l=null,H=!1,G=null,F=null,c=null,t=100,K=200,h=[],f=null,N=500,e=null,s=0,E="_scr",O="_pnt",x=100,L=50,w=0,g=null,m={},I=window.location.protocol+"//"+window.location.host,q,y="NOKEY",z=0,M=30,p=function(){window.___jsl=window.___jsl||{};var a=window.___jsl._fm={};q="___jsl._fm";return a}();gadgets.config.register("rpc",null,function(a){H&&(l=a.rpc.commSwf||"//xpc.googleusercontent.com/gadgets/xpc.swf")});
k(A,"ready");k(B,"setupDone");k(D,"receiveMessage");return{getCode:function(){return"flash"},isParentVerifiable:function(){return!0},init:function(a,b){G=a;F=b;return H=!0},setup:function(a,b){h.push({token:b,targetId:a});null===c&&null===e&&(e=window.setTimeout(r,t));n();return!0},call:C,_receiveMessage:D,_ready:A,_setupDone:B}}());gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.frameElement||(gadgets.rpctx.frameElement=function(){function k(a,l,e){try{if(".."!==l){var d=window.frameElement;if("function"===typeof d[b])return"function"!==typeof d[b][c]&&(d[b][c]=function(a){f(gadgets.json.parse(a))}),d[b](gadgets.json.stringify(e)),!0}else{var g=document.getElementById(a);if("function"===typeof g[b]&&"function"===typeof g[b][c])return g[b][c](gadgets.json.stringify(e)),!0}}catch(h){}return!1}var b="__g2c_rpc",c="__c2g_rpc",f,h;return{getCode:function(){return"fe"},
isParentVerifiable:function(){return!1},init:function(a,b){f=a;h=b;return!0},setup:function(a,c){if(".."!==a)try{document.getElementById(a)[b]=function(a){f(gadgets.json.parse(a))}}catch(e){return!1}".."===a&&(h("..",!0),gadgets.util.registerOnLoadHandler(function(){window.setTimeout(function(){gadgets.rpc.call(a,gadgets.rpc.ACK)},500)}));return!0},call:function(a,b,c){return k(a,b,c)}}}());gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.nix||(gadgets.rpctx.nix=function(){function f(){var a=d[".."];if(!a)if(++g>h)gadgets.warn("Nix transport setup failed, falling back..."),e("..",!1);else{if(!a&&(window.opener&&"GetAuthToken"in window.opener)&&(a=window.opener,a.GetAuthToken()==gadgets.rpc.getAuthToken(".."))){var b=gadgets.rpc.getAuthToken("..");a.CreateChannel(window[c]("..",b),b);d[".."]=a;window.opener=null;e("..",!0);return}window.setTimeout(function(){f()},k)}}var c="GRPC____NIXVBS_get_wrapper",h=10,k=500,d={},
e,g=0;return{getCode:function(){return"nix"},isParentVerifiable:function(){return!1},init:function(a,b){e=b;if("unknown"!==typeof window[c]){window.GRPC____NIXVBS_handle_message=function(b){window.setTimeout(function(){a(gadgets.json.parse(b))},0)};window.GRPC____NIXVBS_create_channel=function(a,b,c){gadgets.rpc.getAuthToken(a)===c&&(d[a]=b,e(a,!0))};var l="Class GRPC____NIXVBS_wrapper\n Private m_Intended\nPrivate m_Auth\nPublic Sub SetIntendedName(name)\n If isEmpty(m_Intended) Then\nm_Intended \x3d name\nEnd If\nEnd Sub\nPublic Sub SetAuth(auth)\n If isEmpty(m_Auth) Then\nm_Auth \x3d auth\nEnd If\nEnd Sub\nPublic Sub SendMessage(data)\n GRPC____NIXVBS_handle_message(data)\nEnd Sub\nPublic Function GetAuthToken()\n GetAuthToken \x3d m_Auth\nEnd Function\nPublic Sub CreateChannel(channel, auth)\n Call GRPC____NIXVBS_create_channel(m_Intended, channel, auth)\nEnd Sub\nEnd Class\nFunction "+
c+"(name, auth)\nDim wrap\nSet wrap \x3d New GRPC____NIXVBS_wrapper\nwrap.SetIntendedName name\nwrap.SetAuth auth\nSet "+c+" \x3d wrap\nEnd Function";try{window.execScript(l,"vbscript")}catch(m){return!1}}return!0},setup:function(a,b){if(".."===a)return f(),!0;try{var d=document.getElementById(a),e=window[c](a,b);d.contentWindow.opener=e}catch(g){return!1}return!0},call:function(a,b,c){try{d[a]&&d[a].SendMessage(gadgets.json.stringify(c))}catch(e){return!1}return!0}}}());gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.rmr||(gadgets.rpctx.rmr=function(){function m(a,b,c,e){var d=function(){document.body.appendChild(a);a.src="about:blank";e&&(a.onload=function(){f(e)});a.src=b+"#"+c};document.body?d():gadgets.util.registerOnLoadHandler(function(){d()})}function n(a){var b=null;g[a].searchCounter++;try{var c=gadgets.rpc._getTargetWin(a),b=".."===a?c.frames["rmrtransport-"+gadgets.rpc.RPC_ID]:c.frames["rmrtransport-.."]}catch(e){}c=!1;b&&(c=t(a,b));!c&&!(g[a].searchCounter>u)&&window.setTimeout(function(){n(a)},
v)}function p(a,b,c,e){var d=null;if(d=".."!==c?g[".."]:g[a]){b!==gadgets.rpc.ACK&&d.queue.push(e);if(d.waiting||0===d.queue.length&&!(b===gadgets.rpc.ACK&&e&&!0===e.ackAlone))return!0;0<d.queue.length&&(d.waiting=!0);a=d.relayUri+"#"+l(a);try{d.frame.contentWindow.location=a;var h=10==d.width?20:10;d.frame.style.width=h+"px";d.width=h}catch(q){return!1}}return!0}function l(a){a=g[a];var b={id:a.sendId};if(a){b.d=Array.prototype.slice.call(a.queue,0);var c={s:gadgets.rpc.ACK,id:a.recvId};a.originVerified||
(c.sendToken=a.verifySendToken);a.verifyRecvToken&&(c.recvToken=a.verifyRecvToken);b.d.push(c)}return gadgets.json.stringify(b)}function f(a){for(var b=g[a],c=b.receiveWindow.location.hash.substring(1),e=gadgets.json.parse(decodeURIComponent(c))||{},c=e.d||[],d=!1,h=!1,q=0,e=b.recvId-e.id,f=0;f<c.length;++f){var k=c[f];if(k.s===gadgets.rpc.ACK){r(a,!0);b.verifyRecvToken=k.sendToken;!b.originVerified&&(k.recvToken&&String(k.recvToken)==String(b.verifySendToken))&&(b.originVerified=!0);b.waiting&&(h=
!0);b.waiting=!1;var l=Math.max(0,k.id-b.sendId);b.queue.splice(0,l);b.sendId=Math.max(b.sendId,k.id||0)}else d=!0,++q<=e||(++b.recvId,s(k,b.originVerified?b.relayOrigin:void 0))}if(d||h&&0<b.queue.length)p(a,gadgets.rpc.ACK,".."===a?gadgets.rpc.RPC_ID:"..",{ackAlone:d})}function t(a,b){function c(){f(a)}var e=g[a];try{var d=!1,d="document"in b;if(!d)return!1;d="object"==typeof b.document;if(!d||"about:blank"===b.location.href)return!1}catch(h){return!1}e.receiveWindow=b;"undefined"===typeof b.attachEvent?
b.onresize=c:b.attachEvent("onresize",c);".."===a?m(e.frame,e.relayUri,l(a),a):f(a);return!0}var v=500,u=10,g={},w=gadgets.util.getUrlParameters().parent,s,r;return{getCode:function(){return"rmr"},isParentVerifiable:function(){return!0},init:function(a,b){s=a;r=b;return!0},setup:function(a,b){try{if("object"!==typeof g[a]){var c=document.createElement("iframe"),e=c.style;e.position="absolute";e.top="0px";e.border="0";e.opacity="0";e.width="10px";e.height="1px";c.id="rmrtransport-"+a;c.name=c.id;var d=
gadgets.rpc.getRelayUrl(a),h=gadgets.rpc.getOrigin(w);d||(d=h+"/robots.txt");g[a]={frame:c,receiveWindow:null,relayUri:d,relayOrigin:h,searchCounter:0,width:10,waiting:!0,queue:[],sendId:0,recvId:0,verifySendToken:String(Math.random()),verifyRecvToken:null,originVerified:!1};".."!==a&&m(c,d,l(a));n(a)}}catch(f){return gadgets.warn("Caught exception setting up RMR: "+f),!1}return!0},call:function(a,b,c){return p(a,c.s,b,c)}}}());gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.ifpc||(gadgets.rpctx.ifpc=function(){function m(d){for(var a=[],c=0,b=d.length;c<b;++c)a.push(encodeURIComponent(gadgets.json.stringify(d[c])));return a.join("\x26")}function n(d){for(var a,c=f.length-1;0<=c;--c){var b=f[c];try{if(b&&(b.recyclable||"complete"===b.readyState))if(b.parentNode.removeChild(b),window.ActiveXObject)f[c]=b=null,f.splice(c,1);else{b.recyclable=!1;a=b;break}}catch(g){}}a||(a=document.createElement("iframe"),a.style.border=a.style.width=a.style.height="0px",a.style.visibility=
"hidden",a.style.position="absolute",a.onload=function(){this.recyclable=!0},f.push(a));a.src=d;window.setTimeout(function(){document.body.appendChild(a)},0)}var f=[],k=0,l,e={};return{getCode:function(){return"ifpc"},isParentVerifiable:function(){return!0},init:function(d,a){l=a;l("..",!0);return!0},setup:function(d,a){l(d,!0);return!0},call:function(d,a,c){var b=gadgets.rpc.getRelayUrl(d);++k;if(!b)return gadgets.warn("No relay file assigned for IFPC"),!1;var g=null,h=[];if(c.l)g=[b,"#",m([a,k,
1,0,m([a,c.s,"","",a].concat(c.a))])].join(""),h.push(g);else{g=[b,"#",d,"\x26",a,"@",k,"\x26"].join("");d=encodeURIComponent(gadgets.json.stringify(c));a=2E3-g.length;c=Math.ceil(d.length/a);for(var b=0,e;0<d.length;)e=d.substring(0,a),d=d.substring(a),h.push([g,c,"\x26",b,"\x26",e].join("")),b+=1}do n(h.shift());while(0<h.length);return!0},_receiveMessage:function(d,a){var c=d[1],b=parseInt(d[2],10),g=parseInt(d[3],10),h=d[d.length-1],f=1===b;if(1<b){e[c]||(e[c]=[]);e[c][g]=h;a:{for(b-=1;0<=b;--b)if("undefined"===
typeof e[c][b]){b=!1;break a}b=!0}b&&(h=e[c].join(""),delete e[c],f=!0)}f&&a(gadgets.json.parse(decodeURIComponent(h)))}}}());window.gadgets.rpc||(gadgets.rpc=function(){function D(a,b){if(!r[a]){var c=k;b||(c=w);r[a]=c;for(var d=t[a]||[],e=0;e<d.length;++e){var h=d[e];h.t=l[a];c.call(a,h.f,h)}t[a]=[]}}function Z(){function a(){R=!0}S||("undefined"!=typeof window.addEventListener?window.addEventListener("unload",a,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onunload",a),S=!0)}function $(a,b,c,d,e){if(!l[b]||l[b]!==c)gadgets.error("Invalid auth token. "+l[b]+" vs "+c),x(b,E);e.onunload=function(){m[b]&&
!R&&(x(b,T),gadgets.rpc.removeReceiver(b))};Z();d=gadgets.json.parse(decodeURIComponent(d))}function y(a,b){if(a&&"string"===typeof a.s&&"string"===typeof a.f&&a.a instanceof Array){var c=".."===a.f?a.ta:a.f,d=!0;if(".."===a.f)d=!1;else if(osapi&&osapi.globals_inline)for(var e=1,h=a.a.length;e<h;e++)a.a[e]&&"undefined"!==typeof a.a[e].mid&&osapi.globals_inline[a.a[e].mid]&&".."===a.f&&a.ta===osapi.globals_inline[a.a[e].mid].iframeId&&(d=!1);if(!d||"function"!==typeof arbitrate||arbitrate(a.s,c))if(l[a.f]&&
l[a.f]!==a.t&&(gadgets.error("Invalid auth token. "+l[a.f]+" vs "+a.t),x(a.f,E)),a.s===z)window.setTimeout(function(){D(a.f,!0)},0);else{a.c&&(a[aa]=function(b){gadgets.rpc.call(a.f,u,null,a.c,b)});if(b){c=q(b);a[ba]=b;d=a.r;if(!d||q(d)!=c)d=b;a[ca]=d}c=(n[a.s]||n[s]).apply(a,a.a);a.c&&"undefined"!==typeof c&&gadgets.rpc.call(a.f,u,null,a.c,c)}}}function q(a){if(a){if("*"===a)return a}else return"";a=a.toLowerCase();0==a.indexOf("//")&&(a=window.location.protocol+a);-1==a.indexOf("://")&&(a=window.location.protocol+
"//"+a);var b=a.substring(a.indexOf("://")+3),c=b.indexOf("/");-1!=c&&(b=b.substring(0,c));a=a.substring(0,a.indexOf("://"));var c="",d=b.indexOf(":");if(-1!=d){var e=b.substring(d+1),b=b.substring(0,d);if("http"===a&&"80"!==e||"https"===a&&"443"!==e)c=":"+e}return a+"://"+b+c}function v(a){if("/"==a.charAt(0)){var b=a.indexOf(U),c=0<b?a.substring(1,b):a.substring(1);a=0<b?a.substring(b+1):null;return{id:c,origin:a}}return null}function F(a){if("undefined"===typeof a||".."===a){a=window.parent;if(window.location.hash){var b=
window.location.hash.substring(1).split("\x26");if(b){for(var c=b.length,d=0;c--;)if(0===b[c].indexOf("embeddedlevel")){d=b[c].split("\x3d")[1];break}if(0<d)for(;d--&&a;)a=a.parent}}return a?a:window.parent}if(b=v(a)){for(a=window;!a.frames[b.id]&&a!==window.top;)a=a.parent;return a.frames[b.id]}a=String(a);return(b=G(a))&&b.contentWindow?b.contentWindow:(b=window.frames[a])&&!b.closed?b:null}function G(a){var b=document.getElementById(a);if(!b)for(var c=frames.length;c--;)try{if(b=frames[c].document.getElementById(a))break}catch(d){}return b}
function V(a,b){if(!0!==m[a]){"undefined"===typeof m[a]&&(m[a]=0);var c=F(a);(".."===a||null!=c)&&!0===k.setup(a,b)?m[a]=!0:!0!==m[a]&&m[a]++<da?window.setTimeout(function(){V(a,b)},ea):(r[a]=w,m[a]=!0)}}function fa(a,b){var c=F(a);try{if(!f[a]||f[a]!==A&&c.Function.prototype!==f[a].constructor.prototype){var d=H(a);if(q(d)!==q(window.location.href))return f[a]=A,!1;try{f[a]=c.gadgets.rpc.receiveSameDomain}catch(e){return f[a]=A,!1}}}catch(h){return!1}return f[a]&&f[a]!==A?(f[a](b),!0):!1}function H(a){(a=
I[a])&&"/"===a.substring(0,1)&&(a="/"===a.substring(1,2)?document.location.protocol+a:document.location.protocol+"//"+document.location.host+a);return a}function J(a,b,c){!/http(s)?:\/\/.+/.test(b)&&"*"!==b&&(0==b.indexOf("//")?b=window.location.protocol+b:"/"==b.charAt(0)?b=window.location.protocol+"//"+window.location.host+b:-1==b.indexOf("://")&&(b=window.location.protocol+"//"+b));I[a]=b;"undefined"!==typeof c&&(B[a]=!!c)}function K(a,b){b=b||"";l[a]=String(b);V(a,b)}function W(a){a=(a.passReferrer||
"").split(":",2);C=a[0]||"none";L=a[1]||"origin"}function X(a){"true"===String(a.useLegacyProtocol)&&(k=gadgets.rpctx.ifpc,k.init(y,D))}function ga(a,b){function c(c){c=c?c.rpc:{};W(c);var e=c.parentRelayUrl||"",e=q(p.parent||b)+e;J("..",e,"true"===String(c.useLegacyProtocol));X(c);K("..",a)}!p.parent&&b?c({}):gadgets.config.register("rpc",null,c)}function M(a,b,c){if(".."===a)ga(c||p.rpctoken||p.ifpctok||"",b);else a:{var d=null;if("/"!=a.charAt(0)){if(!gadgets.util)break a;d=G(a);if(!d)throw Error("Cannot set up gadgets.rpc receiver with ID: "+
a+", element not found.");}d=d&&d.src;b=b||gadgets.rpc.getOrigin(d);J(a,b);b=gadgets.util.getUrlParameters(d);K(a,c||b.rpctoken)}}var u="__cb",s="",z="__ack",ea=500,da=10,U="|",aa="callback",ba="origin",ca="referer",n={},I={},B={},l={},N=0,O={},m={},f={},p={},r={},t={},C=null,L=null,ha=!!gadgets.util.getUrlParameters().parent&&window.top!==window.self,P=window.name,x=function(){},T=1,E=2,Q=window.console,Y=Q&&Q.log?function(a){Q.log(a)}:function(){},w=function(){function a(a){return function(){Y(a+
": call ignored")}}return{getCode:function(){return"noop"},isParentVerifiable:function(){return!0},init:a("init"),setup:a("setup"),call:a("call")}}();gadgets.util&&(p=gadgets.util.getUrlParameters());var R=!1,S=!1,k="flash"==p.rpctx?gadgets.rpctx.flash:"rmr"==p.rpctx?gadgets.rpctx.rmr:"function"===typeof window.postMessage?gadgets.rpctx.wpm:"object"===typeof window.postMessage?gadgets.rpctx.wpm:window.ActiveXObject?gadgets.rpctx.flash?gadgets.rpctx.flash:gadgets.rpctx.nix:0<navigator.userAgent.indexOf("WebKit")?
gadgets.rpctx.rmr:"Gecko"===navigator.product?gadgets.rpctx.frameElement:gadgets.rpctx.ifpc;n[s]=function(){Y("Unknown RPC service: "+this.s)};n[u]=function(a,b){var c=O[a];c&&(delete O[a],c.call(this,b))};var A={};return{config:function(a){"function"===typeof a.securityCallback&&(x=a.securityCallback);"function"===typeof a.arbitrator&&(arbitrate=a.arbitrator)},register:function(a,b){if(a===u||a===z)throw Error("Cannot overwrite callback/ack service");if(a===s)throw Error("Cannot overwrite default service: use registerDefault");
var c=n[a];n[a]=b;return c},unregister:function(a){if(a===u||a===z)throw Error("Cannot delete callback/ack service");if(a===s)throw Error("Cannot delete default service: use unregisterDefault");delete n[a]},registerDefault:function(a){n[s]=a},unregisterDefault:function(){delete n[s]},forceParentVerifiable:function(){k.isParentVerifiable()||(k=gadgets.rpctx.ifpc)},call:function(a,b,c,d){a=a||"..";var e="..";".."===a?e=P:"/"==a.charAt(0)&&(e=gadgets.rpc.getOrigin(window.location.href),e="/"+P+(e?U+
e:""));++N;c&&(O[N]=c);var h={s:b,f:e,c:c?N:0,a:Array.prototype.slice.call(arguments,3),t:l[a],l:!!B[a],ta:a},g;a:if("bidir"===C||"c2p"===C&&".."===a||"p2c"===C&&".."!==a){g=window.location.href;var f="?";if("query"===L)f="#";else if("hash"===L)break a;f=g.lastIndexOf(f);f=-1===f?g.length:f;g=g.substring(0,f)}else g=null;g&&(h.r=g);!(".."!==a&&null==v(a)&&!G(a))&&!fa(a,h)&&(g=r[a],!g&&null!==v(a)&&(g=k),g?(B[a]&&(g=gadgets.rpctx.ifpc),!1===g.call(a,e,h)&&(r[a]=w,k.call(a,e,h))):t[a]?t[a].push(h):
t[a]=[h])},getRelayUrl:H,setRelayUrl:J,setAuthToken:K,setupReceiver:M,getAuthToken:function(a){return l[a]},removeReceiver:function(a){delete I[a];delete B[a];delete l[a];delete m[a];delete f[a];delete r[a]},getRelayChannel:function(){return k.getCode()},receive:function(a,b){4<a.length?k._receiveMessage(a,y):$.apply(null,a.concat(b))},receiveSameDomain:function(a){a.a=Array.prototype.slice.call(a.a);window.setTimeout(function(){y(a)},0)},getOrigin:q,getTargetOrigin:function(a){var b=null,b=H(a);
b||(b=(b=v(a))?b.origin:".."==a?p.parent:document.getElementById(a).src);return q(b)},init:function(){!1===k.init(y,D)&&(k=w);ha?M(".."):(M(".."),gadgets.config.register("rpc",null,function(a){a=a.rpc||{};W(a);X(a)}))},_getTargetWin:F,_parseSiblingId:v,ACK:z,RPC_ID:P||"..",SEC_ERROR_LOAD_TIMEOUT:0,SEC_ERROR_FRAME_PHISH:T,SEC_ERROR_FORGED_MSG:E}}(),gadgets.rpc.init());gadgets.io=function(){function C(){var b;if("undefined"!=typeof shindig&&shindig.xhrwrapper&&shindig.xhrwrapper.createXHR)return shindig.xhrwrapper.createXHR();if("undefined"!=typeof ActiveXObject)try{return(b=new ActiveXObject("Msxml2.XMLHTTP"))||(b=new ActiveXObject("Microsoft.XMLHTTP")),b}catch(d){}if("undefined"!=typeof XMLHttpRequest||window.XMLHttpRequest)return new window.XMLHttpRequest;throw"no xhr available";}function A(b,d,c,a,g){if(4!==b.readyState)return!0;var h;try{if(200!==b.status){var l=
b.responseText,f=l;if(l&&c&&a){var k=q.unparseableCruft,e=l.indexOf(k)+k.length;if(e===k.length){var l=l.substr(e),n=eval("("+l+")");n&&(n=n[a])}if(c.AUTHORIZATION===gadgets.io.AuthorizationType.SSO){var p=c.SSO_REAUTH_DETECTOR;401===b.status?(f=b.statusText?b.statusText:"Unauthorized: check login",h=p&&"function"===typeof p):n&&p&&"function"===typeof p?h=p(n.body,n.rc,n.headers):b.getResponseHeader("content-type")&&0===b.getResponseHeader("content-type").indexOf("application/json")&&(p&&"function"===
typeof p)&&(h=p("",b.status,{}))}}var m=""+b.status;f&&(m=m+" "+f);var r={errors:[m],rc:b.status,text:f};"undefined"!==typeof h&&(r.ssoReauthNeeded=h);t(r,c,a,d,g);u(r);d(r);return!0}}catch(s){return r={errors:[s.number+" Error not specified"],rc:s.number,text:s.description},"undefined"!==typeof h&&(r.ssoReauthNeeded=h),t(r,c,a,d,g),u(r),d(r),!0}return!1}function D(b,d,c,a){A(a,d,c,b)||d(w(c,{body:a.responseText}))}function x(b,d,c,a,g){if(!A(a,d,c,b,g)){a=a.responseText;var h=q.unparseableCruft,
l=a.indexOf(h)+h.length;l<h.length||(a=a.substr(l),a=eval("("+a+")"),a=a[b],a.oauthState&&(s=a.oauthState),a.st&&shindig.auth.updateSecurityToken(a.st),a=w(c,a),t(a,c,b,d,g),u(a),d(a))}}function w(b,d){var c={text:d.body,rc:d.rc||200,headers:d.headers,oauthApprovalUrl:d.oauthApprovalUrl,oauthError:d.oauthError,oauthErrorText:d.oauthErrorText,oauthErrorTrace:d.oauthErrorTrace,oauthErrorUri:d.oauthErrorUri,oauthErrorExplanation:d.oauthErrorExplanation,errors:[],samlApprovalUrl:d.samlApprovalUrl};if(200>
c.rc||400<=c.rc)c.errors=[c.rc+" Error"];else if(c.text)switch(300<=c.rc&&400>c.rc&&(b.CONTENT_TYPE="TEXT"),b.CONTENT_TYPE){case "JSON":case "FEED":c.data=gadgets.json.parse(c.text);c.data||(c.errors.push("500 Failed to parse JSON"),c.rc=500,c.data=null);break;case "DOM":var a;E?(a=new ActiveXObject("Microsoft.XMLDOM"),a.async=!1,a.validateOnParse=!1,a.resolveExternals=!1,a.loadXML(c.text)?c.data=a:(c.errors.push("500 Failed to parse XML"),c.rc=500)):"undefined"!=typeof DOMParser?(a=(new DOMParser).parseFromString(c.text,
"text/xml"),"parsererror"===a.documentElement.nodeName?(c.errors.push("500 Failed to parse XML"),c.rc=500):c.data=a):(c.errors.push("500 Failed to parse XML because no DOM parser was available"),c.rc=500);break;default:c.data=c.text}b.AUTHORIZATION===gadgets.io.AuthorizationType.SSO&&(b.SSO_REAUTH_DETECTOR&&"function"===typeof b.SSO_REAUTH_DETECTOR)&&(a=b.SSO_REAUTH_DETECTOR,c.ssoReauthNeeded=a(d.body,d.rc,d.headers));return c}function y(b,d,c,a,g,h,l,f,k){var e=C();0==d.indexOf("//")&&(d=document.location.protocol+
d);e.open(g,d,!0);c&&(b=gadgets.util.makeClosure(null,l,b,c,h,e,k),gadgets.util.shouldPollXhrReadyStateChange()?F(e,b):e.onreadystatechange=b);"string"===typeof f&&(f={});f=f||{};null!==a&&(f["Content-Type"]||(f["Content-Type"]="application/x-www-form-urlencoded"));for(var n in f)e.setRequestHeader(n,f[n]);e.send(a)}function F(b,d){var c=B;z[c]=window.setInterval(function(){b&&4===b.readyState&&(window.clearInterval(z[c]),delete z[c],d&&d())},q.xhrPollIntervalMs||50);B++}function v(b){return q.securityTokenInCookie?
"":"\x26st\x3d"+encodeURIComponent(b)}function t(b,d,c,a,g){if(b.samlApprovalUrl&&!0==b.ssoReauthNeeded)if(d.SSO_REAUTH_CALLBACK&&"function"===typeof d.SSO_REAUTH_CALLBACK)d=d.SSO_REAUTH_CALLBACK,d(b);else{b=b.samlApprovalUrl;if(null==b||void 0==b||"META_DATA_REAUTH_URL_NOT_SET"==b)b=gadgets.rpc.call("..","_cre_sso_reauth_cb");null==b||void 0==b||"META_DATA_REAUTH_URL_NOT_SET"==b?console.error("Failed to get valid reauth URL to do login for saml reauth."):confirm("Do you want to do reauth for SAML now?")&&
(d=new cre$.sso.ReauthHandler(function(){},function(){gadgets.io.makeRequest(c,a,g)}),d.setReauthURL(b),d.createHandlerOnClick()(),d.renderComplete())}}function u(b){if(null!=b&&void 0!=b){var d;d=null;b=b.headers;null!=b&&(void 0!=b&&""!=b)&&(d=b["set-cookie"]);if(null!=d&&void 0!=d){d=String(d).split("\x26");b=0;for(var c=d.length;b<c;b++){var a=d[b];"prx_saml_"==a.substring(0,9)&&(-1!==a.indexOf("; HttpOnly")&&(a=a.replace("; HttpOnly","")),document.cookie=a)}}}}var B=0,z={},q={},s,E=window.ActiveXObject?
!0:!1;gadgets.config.register("core.io",null,function(b){q=b["core.io"]||{}});return{makeRequest:function(b,d,c){var a=c||{},g=a.METHOD||"GET",h=a.REFRESH_INTERVAL,l,f;a.AUTHORIZATION&&"NONE"!==a.AUTHORIZATION&&(l=a.AUTHORIZATION.toLowerCase(),f=shindig.auth.getSecurityToken());var k=!0;"undefined"!==typeof a.SIGN_OWNER&&(k=a.SIGN_OWNER);var e=!0;"undefined"!==typeof a.SIGN_VIEWER&&(e=a.SIGN_VIEWER);var n=a.HEADERS||{};"POST"===g&&!n["Content-Type"]&&(n["Content-Type"]="application/x-www-form-urlencoded");
var p=gadgets.util.getUrlParameters(),k={url:b,httpMethod:g,headers:gadgets.io.encodeValues(n,!1),postData:a.POST_DATA||"",authz:l||"",st:f||"",contentType:a.CONTENT_TYPE||"TEXT",numEntries:a.NUM_ENTRIES||"3",getSummaries:!!a.GET_SUMMARIES,signOwner:k,signViewer:e,gadget:p.url,container:p.container||p.synd||"default",bypassSpecCache:gadgets.util.getUrlParameters().nocache||"",getFullHeaders:!!a.GET_FULL_HEADERS};if("oauth"===l||"signed"===l||"oauth2"===l){gadgets.io.oauthReceivedCallbackUrl_&&(k.OAUTH_RECEIVED_CALLBACK=
gadgets.io.oauthReceivedCallbackUrl_,gadgets.io.oauthReceivedCallbackUrl_=null);k.oauthState=s||"";for(var m in a)if(a.hasOwnProperty(m)&&(0===m.indexOf("OAUTH_")||"code"===m))k[m]=a[m]}l=(f=f||shindig.auth.getSecurityToken())?{"X-Shindig-ST":f}:{};f=q.jsonProxyUrl.replace("%host%",document.location.host);a:{if(gadgets.io.preloaded_&&"GET"===k.httpMethod)for(m=0;m<gadgets.io.preloaded_.length;m++)if((e=gadgets.io.preloaded_[m])&&e.id===k.url){delete gadgets.io.preloaded_[m];200!==e.rc?d({rc:e.rc,
errors:[e.rc+" Error"]}):(e.oauthState&&(s=e.oauthState),m=w(a,{body:e.body,rc:e.rc,headers:e.headers,oauthApprovalUrl:e.oauthApprovalUrl,oauthError:e.oauthError,oauthErrorText:e.oauthErrorText,oauthErrorTrace:e.oauthErrorTrace,oauthErrorUri:e.oauthErrorUri,oauthErrorExplanation:e.oauthErrorExplanation,errors:[],samlApprovalUrl:e.samlApprovalUrl}),t(m,a,url,d,c),u(m),d(m));m=!0;break a}m=!1}m||("GET"==g&&"undefined"!=typeof h&&(k.refresh=h),"GET"===g&&!k.authz?(g="?"+gadgets.io.encodeValues(k),h=
f+g,-1!=f.indexOf("url\x3d")&&(h=f+encodeURIComponent(g)),y(b,h,d,null,"GET",a,x,l,c)):(g=gadgets.io.encodeValues(k),y(b,f,d,g,"POST",a,x,l,c)))},makeNonProxiedRequest:function(b,d,c,a){c=c||{};y(b,b,d,c.POST_DATA,c.METHOD,c,D,a)},clearOAuthState:function(){s=void 0},encodeValues:function(b,d){var c=!d,a=[],g=!1,h;for(h in b)b.hasOwnProperty(h)&&!/___$/.test(h)&&(g?a.push("\x26"):g=!0,a.push(c?encodeURIComponent(h):h),a.push("\x3d"),a.push(c?encodeURIComponent(b[h]):b[h]));return a.join("")},getProxyUrl:function(b,
d){var c=q.proxyUrl;if(!c)return c;var a=window.__gadgetIdentifier;a&&q.securityTokenInCookie&&(c=c.replace(/proxy/,"proxy/"+a));var g=d||{},a=g.REFRESH_INTERVAL;"undefined"==typeof a&&(a="3600");var h=g.STREAM;"undefined"==typeof h&&(h=!1);var l=gadgets.util.getUrlParameters(),f=shindig.auth.getSecurityToken(),k=g[gadgets.io.RequestParameters.AUTHORIZATION],e=g[gadgets.io.RequestParameters.OAUTH_SERVICE_NAME],g=g.rewriteMime?"\x26rewriteMime\x3d"+encodeURIComponent(g.rewriteMime):"",n="";k?n=k==
gadgets.io.AuthorizationType.OAUTH||k==gadgets.io.AuthorizationType.OAUTH2?"\x26authz\x3d"+k.toLowerCase()+v(f)+"\x26OAUTH_SERVICE_NAME\x3d"+encodeURIComponent(e):k==gadgets.io.AuthorizationType.SSO?"\x26authz\x3d"+k.toLowerCase()+v(f):!0==q.appendTokenAlways?"\x26authz\x3d"+k.toLowerCase()+v(f):"\x26authz\x3d"+k.toLowerCase():!0==q.appendTokenAlways&&(n=v(f));f=shindig.uri(b).getPath();k="";e=f.lastIndexOf("/");-1!==e&&(k=f.substring(e));c=c.replace("%url%",encodeURIComponent(b)).replace("%host%",
document.location.host).replace("%rawurl%",b).replace("%filename%",k).replace("%refresh%",encodeURIComponent(a)).replace("%gadget%",encodeURIComponent(l.url)).replace("%container%",encodeURIComponent(l.container||l.synd||"default")).replace("%stream%",h?1:0).replace("%authz%",n).replace("%rewriteMime%",g);0==c.indexOf("//")&&(c=window.location.protocol+c);return c},processResponse_:x}}();gadgets.io.RequestParameters=gadgets.util.makeEnum("ALIAS METHOD CONTENT_TYPE POST_DATA HEADERS AUTHORIZATION NUM_ENTRIES GET_SUMMARIES GET_FULL_HEADERS REFRESH_INTERVAL STREAM SIGN_OWNER SIGN_VIEWER OAUTH_SERVICE_NAME OAUTH_USE_TOKEN OAUTH_TOKEN_NAME OAUTH_REQUEST_TOKEN OAUTH_REQUEST_TOKEN_SECRET OAUTH_RECEIVED_CALLBACK SSO_REAUTH_DETECTOR".split(" "));
gadgets.io.MethodType=gadgets.util.makeEnum(["GET","POST","PUT","DELETE","HEAD"]);gadgets.io.ContentType=gadgets.util.makeEnum(["TEXT","DOM","JSON","FEED"]);gadgets.io.AuthorizationType=gadgets.util.makeEnum(["NONE","SIGNED","OAUTH","OAUTH2","SSO"]);(function(){osapi.newBatch=function(){var e={},g=[],l=function(b){var c={method:b.request.method,id:b.key};b.request.rpc&&(c.params=b.request.rpc);return c};e.execute=function(b){for(var c={},f={},e=0,k=[],d=0;d<g.length;d++){var a=g[d].request.transport;f[a.name]||(k.push(a),e++);f[a.name]=f[a.name]||[];f[a.name].push(l(g[d]))}d=function(a){a.error&&(c.error=a.error);for(var d=0;d<g.length;d++){var f=g[d].key,h=a[f];h&&(c[f]=h.error?h:h.data||h.result)}e--;0===e&&b(c)};for(a=0;a<k.length;a++)k[a].execute(f[k[a].name],
d);0==e&&window.setTimeout(function(){b(c)},0)};e.add=function(b,c){c&&b&&g.push({key:b,request:c});return e};return e}})();osapi._registerMethod=function(b,d){if("newBatch"!==b){for(var a=b.split("."),c=osapi,f=0;f<a.length-1;f++)c[a[f]]=c[a[f]]||{},c=c[a[f]];var e=a[a.length-1],g;c[e]&&(g=c[e]);c[e]=function(a){a=a||{};a.userId=a.userId||"@viewer";a.groupId=a.groupId||"@self";return new osapi._BoundCall(b,d,a)};"undefined"!==typeof tamings___&&(a=function(){caja___.markFunction(c[e],b)},g&&g.__taming_index?(c[e].__taming_index=g.__taming_index,tamings___[g.__taming_index]=a):(c[e].__taming_index=tamings___.length,tamings___.push(a)))}};
osapi._BoundCall=function(b,d,a){this.method=b;this.transport=d;this.rpc=a};osapi._BoundCall.prototype.execute=function(b){var d="undefined"!==typeof caja___&&caja___.getUseless&&caja___.getUseless(),a=d?caja___.getUseless():this,c=d?caja___.untame(b):b;b=osapi.newBatch();b.add(this.method,this);b.execute(function(b){b.error?c.call(a,{error:b.error}):c.call(a,b[a.method])})};(function(){function k(a,d){var c={POST_DATA:gadgets.json.stringify(a),CONTENT_TYPE:"JSON",METHOD:"POST",AUTHORIZATION:"SIGNED"},e={"Content-Type":"application/json"},f=this.name,g=shindig.auth.getSecurityToken();g&&(h?e.Authorization="OAuth2 "+g:e["X-Shindig-ST"]=g);gadgets.io.makeNonProxiedRequest(f,function(b){if(b.errors[0])d({error:{code:b.rc,message:b.text}});else if(b=b.result||b.data,b.error)d(b);else{for(var c={},a=0;a<b.length;a++)c[b[a].id]=b[a];d(c)}},c,e)}function l(a){var d=a["osapi.services"];
h=a["osapi.useOAuth2"];if(d)for(var c in d)if(d.hasOwnProperty(c)&&(0==c.indexOf("http")||0==c.indexOf("//"))){a={name:c.replace("%host%",document.location.host),execute:k};for(var e=d[c],f=0;f<e.length;f++)osapi._registerMethod(e[f],a)}}var h;gadgets.config&&gadgets.config.register("osapi.services",null,l)})();gadgets.util.registerOnLoadHandler(function(){osapi&&(osapi.people&&osapi.people.get)&&(osapi.people.getViewer=function(a){a=a||{};a.userId="@viewer";a.groupId="@self";return osapi.people.get(a)},osapi.people.getViewerFriends=function(a){a=a||{};a.userId="@viewer";a.groupId="@friends";return osapi.people.get(a)},osapi.people.getOwner=function(a){a=a||{};a.userId="@owner";a.groupId="@self";return osapi.people.get(a)},osapi.people.getOwnerFriends=function(a){a=a||{};a.userId="@owner";a.groupId="@friends";
return osapi.people.get(a)})});shindig._uri=shindig.uri;shindig.uri=function(){var f=shindig._uri;shindig._uri=null;return function(g){var a=f(g);a.hasSameOrigin=function(b){return a.getOrigin()==b.getOrigin()};a.resolve=function(b){""==a.getSchema()&&a.setSchema(b.getSchema());""==a.getAuthority()&&a.setAuthority(b.getAuthority());var c=a.getPath();if(""==c||"/"!=c.charAt(0)){var d=b.getPath(),e=d.lastIndexOf("/");-1!=e&&d.substring(0,e+1);a.setPath(b.getPath()+c)}};return a}}();Function.prototype.inherits=function(b){function a(){}this.superClass_=a.prototype=b.prototype;this.prototype=new a;this.prototype.constructor=this};shindig.cookies={};shindig.cookies.JsType_={UNDEFINED:"undefined"};shindig.cookies.isDef=function(a){return typeof a!=shindig.cookies.JsType_.UNDEFINED};
shindig.cookies.set=function(a,b,c,d,e){if(/;=/g.test(a))throw Error('Invalid cookie name "'+a+'"');if(/;/g.test(b))throw Error('Invalid cookie value "'+b+'"');shindig.cookies.isDef(c)||(c=-1);e=e?";domain\x3d"+e:"";d=d?";path\x3d"+d:"";c=0>c?"":0===c?";expires\x3d"+(new Date(1970,1,1)).toUTCString():";expires\x3d"+(new Date((new Date).getTime()+1E3*c)).toUTCString();document.cookie=a+"\x3d"+b+e+d+c};
shindig.cookies.get=function(a,b){for(var c=a+"\x3d",d=String(document.cookie),e=-1;0<=(e=d.indexOf(c,e+1));){for(var f=e;0<=--f;)if(";"==d.charAt(f)){f=-1;break}if(-1==f)return f=d.indexOf(";",e),0>f&&(f=d.length),d.substring(e+c.length,f)}return b};shindig.cookies.remove=function(a,b,c){var d=shindig.cookies.containsKey(a);shindig.cookies.set(a,"",0,b,c);return d};
shindig.cookies.getKeyValues_=function(){for(var a=String(document.cookie).split(/\s*;\s*/),b=[],c=[],d,e,f=0;e=a[f];f++)d=e.indexOf("\x3d"),-1==d?(b.push(""),c.push(e)):(b.push(e.substring(0,d)),c.push(e.substring(d+1)));return{keys:b,values:c}};shindig.cookies.getKeys=function(){return shindig.cookies.getKeyValues_().keys};shindig.cookies.getValues=function(){return shindig.cookies.getKeyValues_().values};shindig.cookies.isEmpty=function(){return""===document.cookie};
shindig.cookies.getCount=function(){var a=String(document.cookie);return""===a?0:a.split(/\s*;\s*/).length};shindig.cookies.containsKey=function(a){var b={};return shindig.cookies.get(a,b)!==b};shindig.cookies.containsValue=function(a){for(var b=shindig.cookies.getKeyValues_().values,c=0;c<b.length;c++)if(b[c]==a)return!0;return!1};shindig.cookies.clear=function(){for(var a=shindig.cookies.getKeyValues_().keys,b=a.length-1;0<=b;b--)shindig.cookies.remove(a[b])};shindig.cookies.MAX_COOKIE_LENGTH=3950;shindig.errors={};shindig.errors.SUBCLASS_RESPONSIBILITY="subclass responsibility";shindig.errors.TO_BE_DONE="to be done";shindig.callAsyncAndJoin=function(a,b,c){for(var d=a.length,f=[],e=0;e<a.length;e++)(function(e){var g=a[e];"string"===typeof g&&(g=c[g]);g.call(c,function(a){f[e]=a;0===--d&&b(f)})})(e)};shindig.Extensible=function(){};shindig.Extensible.prototype.setDependencies=function(a){for(var b in a)this[b]=a[b]};shindig.Extensible.prototype.getDependencies=function(a){return this[a]};
shindig.UserPrefStore=function(){};shindig.UserPrefStore.prototype.getPrefs=function(a){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY);};shindig.UserPrefStore.prototype.savePrefs=function(a){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY);};shindig.DefaultUserPrefStore=function(){shindig.UserPrefStore.call(this)};shindig.DefaultUserPrefStore.inherits(shindig.UserPrefStore);shindig.DefaultUserPrefStore.prototype.getPrefs=function(a){};shindig.DefaultUserPrefStore.prototype.savePrefs=function(a){};
shindig.GadgetService=function(){};shindig.GadgetService.prototype.setHeight=function(a,b){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY);};shindig.GadgetService.prototype.setTitle=function(a,b){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY);};shindig.GadgetService.prototype.setUserPref=function(a){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY);};
shindig.IfrGadgetService=function(){shindig.GadgetService.call(this);gadgets.rpc.register("resize_iframe",this.setHeight);gadgets.rpc.register("set_pref",this.setUserPref);gadgets.rpc.register("set_title",this.setTitle);gadgets.rpc.register("requestNavigateTo",this.requestNavigateTo);gadgets.rpc.register("requestSendMessage",this.requestSendMessage)};shindig.IfrGadgetService.inherits(shindig.GadgetService);
shindig.IfrGadgetService.prototype.setHeight=function(a){a>shindig.container.maxheight_&&(a=shindig.container.maxheight_);var b=document.getElementById(this.f);b&&(b.style.height=a+"px")};shindig.IfrGadgetService.prototype.setTitle=function(a){var b=document.getElementById(this.f+"_title");b&&(b.innerHTML=a.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"))};
shindig.IfrGadgetService.prototype.setUserPref=function(a,b,c){for(var d=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f),d=shindig.container.getGadget(d),f=1,e=arguments.length;f<e;f+=2)this.userPrefs[arguments[f]].value=arguments[f+1];d.saveUserPrefs()};shindig.IfrGadgetService.prototype.requestSendMessage=function(a,b,c,d){c&&window.setTimeout(function(){c(new opensocial.ResponseItem(null,null,opensocial.ResponseItem.Error.NOT_IMPLEMENTED,null))},0)};
shindig.IfrGadgetService.prototype.requestNavigateTo=function(a,b){shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var c=shindig.container.gadgetService.getUrlForView(a);if(b){var d=gadgets.json.stringify(b);0<d.length&&(c+="\x26appParams\x3d"+encodeURIComponent(d))}c&&-1==document.location.href.indexOf(c)&&(document.location.href=c)};shindig.IfrGadgetService.prototype.getUrlForView=function(a){return"canvas"===a?"/canvas":"profile"===a?"/profile":null};
shindig.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(a){return parseInt(a.match(/_([0-9]+)$/)[1],10)};shindig.LayoutManager=function(){};shindig.LayoutManager.prototype.getGadgetChrome=function(a){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY);};shindig.StaticLayoutManager=function(){shindig.LayoutManager.call(this)};shindig.StaticLayoutManager.inherits(shindig.LayoutManager);shindig.StaticLayoutManager.prototype.setGadgetChromeIds=function(a){this.gadgetChromeIds_=a};
shindig.StaticLayoutManager.prototype.getGadgetChrome=function(a){return(a=this.gadgetChromeIds_[a.id])?document.getElementById(a):null};shindig.FloatLeftLayoutManager=function(a){shindig.LayoutManager.call(this);this.layoutRootId_=a};shindig.FloatLeftLayoutManager.inherits(shindig.LayoutManager);
shindig.FloatLeftLayoutManager.prototype.getGadgetChrome=function(a){if(a=document.getElementById(this.layoutRootId_)){var b=document.createElement("div");b.className="gadgets-gadget-chrome";b.style.cssFloat="left";a.appendChild(b);return b}return null};shindig.Gadget=function(a){this.userPrefs={};if(a)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);this.secureToken||(this.secureToken="john.doe:john.doe:appid:cont:url:0:default")};
shindig.Gadget.prototype.setServerBase=function(a){this.serverBase_=a};shindig.Gadget.prototype.getServerBase=function(){return this.serverBase_};shindig.Gadget.prototype.getUserPrefs=function(){return this.userPrefs};shindig.Gadget.prototype.saveUserPrefs=function(){shindig.container.userPrefStore.savePrefs(this)};shindig.Gadget.prototype.getUserPrefValue=function(a){a=this.userPrefs[a];return"undefined"!=typeof a.value&&null!=a.value?a.value:a["default"]};
shindig.Gadget.prototype.render=function(a){if(a){var b=this;this.getContent(function(c){a.innerHTML=c;b.finishRender(a)})}};shindig.Gadget.prototype.getContent=function(a){shindig.callAsyncAndJoin(["getTitleBarContent","getUserPrefsDialogContent","getMainContent"],function(b){a(b.join(""))},this)};shindig.Gadget.prototype.getTitleBarContent=function(a){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY);};
shindig.Gadget.prototype.getUserPrefsDialogContent=function(a){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY);};shindig.Gadget.prototype.getMainContent=function(a){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY);};shindig.Gadget.prototype.finishRender=function(a){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY);};shindig.Gadget.prototype.getAdditionalParams=function(){return""};
shindig.BaseIfrGadget=function(a){shindig.Gadget.call(this,a);this.serverBase_?0>this.serverBase_.indexOf("/gadgets")&&(this.serverBase_+="/gadgets/"):this.serverBase_="/gadgets/";this.queryIfrGadgetType_()};shindig.BaseIfrGadget.inherits(shindig.Gadget);shindig.BaseIfrGadget.prototype.GADGET_IFRAME_PREFIX_="remote_iframe_";shindig.BaseIfrGadget.prototype.CONTAINER="default";shindig.BaseIfrGadget.prototype.cssClassGadget="gadgets-gadget";shindig.BaseIfrGadget.prototype.cssClassTitleBar="gadgets-gadget-title-bar";
shindig.BaseIfrGadget.prototype.cssClassTitle="gadgets-gadget-title";shindig.BaseIfrGadget.prototype.cssClassTitleButtonBar="gadgets-gadget-title-button-bar";shindig.BaseIfrGadget.prototype.cssClassGadgetUserPrefsDialog="gadgets-gadget-user-prefs-dialog";shindig.BaseIfrGadget.prototype.cssClassGadgetUserPrefsDialogActionBar="gadgets-gadget-user-prefs-dialog-action-bar";shindig.BaseIfrGadget.prototype.cssClassTitleButton="gadgets-gadget-title-button";
shindig.BaseIfrGadget.prototype.cssClassGadgetContent="gadgets-gadget-content";shindig.BaseIfrGadget.prototype.rpcToken=2147483647*Math.random()|0;shindig.BaseIfrGadget.prototype.rpcRelay="../container/rpc_relay.html";
shindig.BaseIfrGadget.prototype.getTitleBarContent=function(a){var b=this.hasViewablePrefs_()?'\x3ca href\x3d"#" onclick\x3d"shindig.container.getGadget('+this.id+').handleOpenUserPrefsDialog();return false;" class\x3d"'+this.cssClassTitleButton+'"\x3esettings\x3c/a\x3e ':"";a('\x3cdiv id\x3d"'+this.cssClassTitleBar+"-"+this.id+'" class\x3d"'+this.cssClassTitleBar+'"\x3e\x3cspan id\x3d"'+this.getIframeId()+'_title" class\x3d"'+this.cssClassTitle+'"\x3e'+(this.title?this.title:"Title")+'\x3c/span\x3e | \x3cspan class\x3d"'+
this.cssClassTitleButtonBar+'"\x3e'+b+'\x3ca href\x3d"#" onclick\x3d"shindig.container.getGadget('+this.id+').handleToggle();return false;" class\x3d"'+this.cssClassTitleButton+'"\x3etoggle\x3c/a\x3e\x3c/span\x3e\x3c/div\x3e')};shindig.BaseIfrGadget.prototype.getUserPrefsDialogContent=function(a){a('\x3cdiv id\x3d"'+this.getUserPrefsDialogId()+'" class\x3d"'+this.cssClassGadgetUserPrefsDialog+'"\x3e\x3c/div\x3e')};
shindig.BaseIfrGadget.prototype.getMainContent=function(a){var b=this;window.setTimeout(function(){b.getMainContent(a)},0)};shindig.BaseIfrGadget.prototype.getIframeId=function(){return this.GADGET_IFRAME_PREFIX_+this.id};shindig.BaseIfrGadget.prototype.getUserPrefsDialogId=function(){return this.getIframeId()+"_userPrefsDialog"};
shindig.BaseIfrGadget.prototype.getUserPrefsParams=function(){var a="",b;for(b in this.getUserPrefs())a+="\x26up_"+encodeURIComponent(b)+"\x3d"+encodeURIComponent(this.getUserPrefValue(b));return a};shindig.BaseIfrGadget.prototype.handleToggle=function(){var a=document.getElementById(this.getIframeId());a&&(a=a.parentNode,a.style.display=a.style.display?"":"none")};
shindig.BaseIfrGadget.prototype.hasViewablePrefs_=function(){for(var a in this.getUserPrefs())if("hidden"!=this.userPrefs[a].type)return!0;return!1};
shindig.BaseIfrGadget.prototype.handleOpenUserPrefsDialog=function(){if(this.userPrefsDialogContentLoaded)this.showUserPrefsDialog();else{var a=this;window["ig_callback_"+this.id]=function(b){a.userPrefsDialogContentLoaded=!0;a.buildUserPrefsDialog(b);a.showUserPrefsDialog()};var b=document.createElement("script");b.src="http://www.gmodules.com/ig/gadgetsettings?mid\x3d"+this.id+"\x26output\x3djs"+this.getUserPrefsParams()+"\x26url\x3d"+this.specUrl;document.body.appendChild(b)}};
shindig.BaseIfrGadget.prototype.buildUserPrefsDialog=function(a){var b=document.getElementById(this.getUserPrefsDialogId());b.innerHTML=a+'\x3cdiv class\x3d"'+this.cssClassGadgetUserPrefsDialogActionBar+'"\x3e\x3cinput type\x3d"button" value\x3d"Save" onclick\x3d"shindig.container.getGadget('+this.id+').handleSaveUserPrefs()"\x3e \x3cinput type\x3d"button" value\x3d"Cancel" onclick\x3d"shindig.container.getGadget('+this.id+').handleCancelUserPrefs()"\x3e\x3c/div\x3e';b.childNodes[0].style.display=
""};shindig.BaseIfrGadget.prototype.showUserPrefsDialog=function(a){document.getElementById(this.getUserPrefsDialogId()).style.display=a||"undefined"==typeof a?"":"none"};shindig.BaseIfrGadget.prototype.hideUserPrefsDialog=function(){this.showUserPrefsDialog(!1)};
shindig.BaseIfrGadget.prototype.handleSaveUserPrefs=function(){this.hideUserPrefsDialog();for(var a=document.getElementById("m_"+this.id+"_numfields").value,b=0;b<a;b++){var c=document.getElementById("m_"+this.id+"_"+b),d=c.name.substring(("m_"+this.id+"_up_").length);this.userPrefs[d].value=c.value}this.saveUserPrefs();this.refresh()};shindig.BaseIfrGadget.prototype.handleCancelUserPrefs=function(){this.hideUserPrefsDialog()};
shindig.BaseIfrGadget.prototype.refresh=function(){var a=this.getIframeId();document.getElementById(a).src=this.getIframeUrl(Math.random())};
shindig.BaseIfrGadget.prototype.queryIfrGadgetType_=function(){var a={CONTENT_TYPE:"JSON",METHOD:"POST",POST_DATA:gadgets.json.stringify({context:{country:"default",language:"default",view:"default",container:"default"},gadgets:[{url:this.specUrl,moduleId:1}]})};gadgets.io.makeNonProxiedRequest(this.serverBase_+"metadata?st\x3d"+this.secureToken,function(a){var d=!1;a=a.data.gadgets[0].features;for(var f=0;f<a.length;f++)if("pubsub-2"===a[f]){d=!0;break}var d=d?shindig.OAAIfrGadget:shindig.IfrGadget,
e;for(e in d)d.hasOwnProperty(e)&&(b[e]=d[e])},a,{"Content-Type":"application/javascript"});var b=this};
shindig.IfrGadget={getMainContent:function(a){var b=this.getIframeId();gadgets.rpc.setRelayUrl(b,this.serverBase_+this.rpcRelay);gadgets.rpc.setAuthToken(b,this.rpcToken);a('\x3cdiv class\x3d"'+this.cssClassGadgetContent+'"\x3e\x3ciframe id\x3d"'+b+'" name\x3d"'+b+'" class\x3d"'+this.cssClassGadget+'" src\x3d"about:blank" frameborder\x3d"no" scrolling\x3d"no"'+(this.height?' height\x3d"'+this.height+'"':"")+(this.width?' width\x3d"'+this.width+'"':"")+"\x3e\x3c/iframe\x3e\x3c/div\x3e")},finishRender:function(a){window.frames[this.getIframeId()].location=
this.getIframeUrl()},getIframeUrl:function(a){return this.serverBase_+"ifr?container\x3d"+this.CONTAINER+"\x26mid\x3d"+this.id+"\x26nocache\x3d"+shindig.container.nocache_+"\x26country\x3d"+shindig.container.country_+"\x26lang\x3d"+shindig.container.language_+"\x26view\x3d"+shindig.container.view_+(this.specVersion?"\x26v\x3d"+this.specVersion:"")+(shindig.container.parentUrl_?"\x26parent\x3d"+encodeURIComponent(shindig.container.parentUrl_):"")+(this.debug?"\x26debug\x3d1":"")+this.getAdditionalParams()+
this.getUserPrefsParams()+(this.secureToken?"\x26st\x3d"+this.secureToken:"")+"\x26url\x3d"+encodeURIComponent(this.specUrl)+(this.viewParams?"\x26view-params\x3d"+encodeURIComponent(gadgets.json.stringify(this.viewParams)):"")+(a?"\x26r\x3d"+a:"")+"#rpctoken\x3d"+this.rpcToken+(this.hashData?"\x26"+this.hashData:"")}};
shindig.OAAIfrGadget={getMainContent:function(a){a('\x3cdiv id\x3d"'+this.cssClassGadgetContent+"-"+this.id+'" class\x3d"'+this.cssClassGadgetContent+'"\x3e\x3c/div\x3e')},finishRender:function(a){a={className:this.cssClassGadget,frameborder:"no",scrolling:"no"};this.height&&(a.height=this.height);this.width&&(a.width=this.width);new OpenAjax.hub.IframeContainer(gadgets.pubsub2router.hub,this.getIframeId(),{Container:{onSecurityAlert:function(a,c){gadgets.error("Security error for container "+a.getClientID()+
" : "+c);a.getIframe().src="about:blank"}},IframeContainer:{parent:document.getElementById(this.cssClassGadgetContent+"-"+this.id),uri:this.getIframeUrl(),tunnelURI:shindig.uri(this.serverBase_+this.rpcRelay).resolve(shindig.uri(window.location.href)),iframeAttrs:a}})},getIframeUrl:function(a){return this.serverBase_+"ifr?container\x3d"+this.CONTAINER+"\x26mid\x3d"+this.id+"\x26nocache\x3d"+shindig.container.nocache_+"\x26country\x3d"+shindig.container.country_+"\x26lang\x3d"+shindig.container.language_+
"\x26view\x3d"+shindig.container.view_+(this.specVersion?"\x26v\x3d"+this.specVersion:"")+(this.debug?"\x26debug\x3d1":"")+this.getAdditionalParams()+this.getUserPrefsParams()+(this.secureToken?"\x26st\x3d"+this.secureToken:"")+"\x26url\x3d"+encodeURIComponent(this.specUrl)+(this.viewParams?"\x26view-params\x3d"+encodeURIComponent(gadgets.json.stringify(this.viewParams)):"")+(a?"\x26r\x3d"+a:"")+(this.hashData?"#"+this.hashData:"")}};
shindig.Container=function(){this.gadgets_={};this.parentUrl_=document.location.href+"://"+document.location.host;this.language_=this.country_="ALL";this.view_="default";this.nocache_=1;this.maxheight_=2147483647};shindig.Container.inherits(shindig.Extensible);shindig.Container.prototype.gadgetClass=shindig.Gadget;shindig.Container.prototype.userPrefStore=new shindig.DefaultUserPrefStore;shindig.Container.prototype.gadgetService=new shindig.GadgetService;
shindig.Container.prototype.layoutManager=new shindig.StaticLayoutManager;shindig.Container.prototype.setParentUrl=function(a){this.parentUrl_=a};shindig.Container.prototype.setCountry=function(a){this.country_=a};shindig.Container.prototype.setNoCache=function(a){this.nocache_=a};shindig.Container.prototype.setLanguage=function(a){this.language_=a};shindig.Container.prototype.setView=function(a){this.view_=a};shindig.Container.prototype.setMaxHeight=function(a){this.maxheight_=a};
shindig.Container.prototype.getGadgetKey_=function(a){return"gadget_"+a};shindig.Container.prototype.getGadget=function(a){return this.gadgets_[this.getGadgetKey_(a)]};shindig.Container.prototype.createGadget=function(a){return new this.gadgetClass(a)};shindig.Container.prototype.addGadget=function(a){a.id=this.getNextGadgetInstanceId();this.gadgets_[this.getGadgetKey_(a.id)]=a};shindig.Container.prototype.addGadgets=function(a){for(var b=0;b<a.length;b++)this.addGadget(a[b])};
shindig.Container.prototype.renderGadgets=function(){for(var a in this.gadgets_)this.renderGadget(this.gadgets_[a])};shindig.Container.prototype.renderGadget=function(a){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY);};shindig.Container.prototype.nextGadgetInstanceId_=0;shindig.Container.prototype.getNextGadgetInstanceId=function(){return this.nextGadgetInstanceId_++};shindig.Container.prototype.refreshGadgets=function(){for(var a in this.gadgets_)this.gadgets_[a].refresh()};
shindig.IfrContainer=function(){shindig.Container.call(this)};shindig.IfrContainer.inherits(shindig.Container);shindig.IfrContainer.prototype.gadgetClass=shindig.BaseIfrGadget;shindig.IfrContainer.prototype.gadgetService=new shindig.IfrGadgetService;shindig.IfrContainer.prototype.setParentUrl=function(a){a.match(/^http[s]?:\/\//)||(a=document.location.href.match(/^[^?#]+\//)[0]+a);this.parentUrl_=a};
shindig.IfrContainer.prototype.renderGadget=function(a){var b=this.layoutManager.getGadgetChrome(a);a.render(b)};function init(a){shindig.Gadget.prototype.setServerBase(a["shindig-container"].serverBase)}gadgets.config&&gadgets.config.register("shindig-container",null,init);shindig.container=new shindig.IfrContainer;if(gadgets&&gadgets.rpc){osapi._handleGadgetRpcMethod=function(a){for(var e=Array(a.length),d=0,g=this.callback,b=function(a,b){b({})},c=0;c<a.length;c++){var f=osapi;if(-1==a[c].method.indexOf("_"))for(var k=a[c].method.split("."),h=0;h<k.length;h++)if(f.hasOwnProperty(k[h]))f=f[k[h]];else{f=b;break}else f=b;f(a[c].params,function(b){return function(c){e[b]={id:a[b].id,data:c};d++;d==a.length&&g(e)}}(c))}};osapi.container={};osapi.container.listMethods=function(a,e){var d=[];recurseNames(osapi,"",
5,d);e(d)};var recurseNames=function(a,e,d,g){if(0!=d)for(var b in a)if(a.hasOwnProperty(b)&&-1==b.indexOf("_")){var c=typeof a[b];"function"==c?g.push(e+b):"object"==c&&recurseNames(a[b],e+b+".",d-1,g)}};gadgets.rpc.register("osapi._handleGadgetRpcMethod",osapi._handleGadgetRpcMethod)};osapi.container={};osapi.container.MetadataParam={LOCAL_EXPIRE_TIME:"localExpireTimeMs",URL:"url"};osapi.container.MetadataResponse={IFRAME_URLS:"iframeUrls",NEEDS_TOKEN_REFRESH:"needsTokenRefresh",VIEWS:"views",EXPIRE_TIME_MS:"expireTimeMs",FEATURES:"features",HEIGHT:"height",MODULE_PREFS:"modulePrefs",PREFERRED_HEIGHT:"preferredHeight",PREFERRED_WIDTH:"preferredWidth",RESPONSE_TIME_MS:"responseTimeMs",WIDTH:"width",TOKEN_TTL:"tokenTTL"};
osapi.container.TokenResponse={TOKEN:"token",TOKEN_TTL:"tokenTTL",MODULE_ID:"moduleId"};osapi.container.NavigateTiming={URL:"url",ID:"id",START:"start",XRT:"xrt",SRT:"srt",DL:"dl",OL:"ol",PRT:"prt"};osapi.container.RenderParam={ALLOW_DEFAULT_VIEW:"allowDefaultView",CAJOLE:"cajole",CLASS:"class",DEBUG:"debug",HEIGHT:"height",NO_CACHE:"nocache",REFRESH:"refresh",TEST_MODE:"testmode",USER_PREFS:"userPrefs",VIEW:"view",WIDTH:"width",MODULE_ID:"moduleid"};osapi.container.ViewParam={VIEW:"view"};
osapi.container.CallbackType={ON_BEFORE_PRELOAD:"onBeforePreload",ON_PRELOADED:"onPreloaded",ON_BEFORE_NAVIGATE:"onBeforeNavigate",ON_NAVIGATED:"onNavigated",ON_BEFORE_CLOSE:"onBeforeClose",ON_CLOSED:"onClosed",ON_BEFORE_UNLOAD:"onBeforeUnload",ON_UNLOADED:"onUnloaded",ON_BEFORE_RENDER:"onBeforeRender",ON_RENDER:"onRender",GADGET_ON_LOAD:"__gadgetOnLoad"};
osapi.container.ContainerConfig={ALLOW_DEFAULT_VIEW:"allowDefaultView",RENDER_CAJOLE:"renderCajole",RENDER_DEBUG:"renderDebug",RENDER_DEBUG_PARAM:"renderDebugParam",RENDER_TEST:"renderTest",TOKEN_REFRESH_INTERVAL:"tokenRefreshInterval",NAVIGATE_CALLBACK:"navigateCallback",PRELOAD_REF_TIME:"preloadRefTime",PRELOAD_METADATAS:"preloadMetadatas",PRELOAD_TOKENS:"preloadTokens",GET_LANGUAGE:"GET_LANGUAGE",GET_COUNTRY:"GET_COUNTRY",GET_PREFERENCES:"GET_PREFERENCES",SET_PREFERENCES:"SET_PREFERENCES",RPC_ARBITRATOR:"rpcArbitrator",
GET_GADGET_TOKEN:"GET_GADGET_TOKEN",GET_CONTAINER_TOKEN:"GET_CONTAINER_TOKEN"};osapi.container.ServiceConfig={API_HOST:"apiHost",API_PATH:"apiPath"};osapi.container.util={};osapi.container.util.getSafeJsonValue=function(a,b,c){return"undefined"!=typeof a[b]&&null!=a[b]?a[b]:c};osapi.container.util.mergeJsons=function(a,b){var c={},d;for(d in a)c[d]=a[d];for(d in b)c[d]=b[d];return c};osapi.container.util.newMetadataRequest=function(a){osapi.container.util.isArray(a)||(a=[a]);return{container:window.__CONTAINER,ids:a,fields:"iframeUrls modulePrefs.* needsTokenRefresh userPrefs.* views.preferredHeight views.preferredWidth expireTimeMs responseTimeMs rpcServiceIds tokenTTL".split(" ")}};
osapi.container.util.newTokenRequest=function(a){osapi.container.util.isArray(a)||(a=[a]);return{container:window.__CONTAINER,ids:a,fields:["token","tokenTTL","moduleId"]}};osapi.container.util.toArrayOfJsonKeys=function(a){var b=[],c;for(c in a)b.push(c);return b};osapi.container.util.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)};osapi.container.util.isEmptyJson=function(a){for(var b in a)return!1;return!0};osapi.container.util.getCurrentTimeMs=function(){return(new Date).getTime()};
osapi.container.util.createIframeHtml=function(a){var b=[],c=0;b[c++]="\x3ciframe ";for(var d in a){var e=a[d];"undefined"!=typeof e&&(b[c++]=d,b[c++]='\x3d"',b[c++]=e,b[c++]='" ')}b[c++]="\x3e\x3c/iframe\x3e";return b.join("")};osapi.container.util.buildTokenRequestUrl=function(a,b){a=shindig.uri(a);b&&a.setFP("moduleId",b);return a.toString()};osapi.container.Site=function(a,b,c,d){this.container_=a;this.service_=b;this.id_=(this.el_=c)&&this.el_.id?this.el_.id:osapi.container.Site.prototype.nextUniqueSiteId_++;this.title_=this.ownerId_=this.parentId_=void 0};osapi.container.Site.DEFAULT_TITLE="default title";osapi.container.Site.prototype.nextUniqueSiteId_=0;osapi.container.Site.prototype.onConstructed=function(){};osapi.container.Site.prototype.getId=function(){return this.id_};
osapi.container.Site.prototype.setWidth=function(a){var b=this.getActiveSiteHolder();if(b&&(b=b.getIframeElement()))b.style.width=a;return this};osapi.container.Site.prototype.setHeight=function(a){var b=this.getActiveSiteHolder();if(b&&(b=b.getIframeElement()))b.style.height=a;return this};osapi.container.Site.prototype.setTitle=function(a){this.title_=a;var b=this.getActiveSiteHolder();b&&b.setTitle(a);return this};
osapi.container.Site.prototype.getTitle=function(){if("undefined"!==typeof this.title_)return this.title_;var a=this.getActiveSiteHolder();return a&&a.gadgetInfo_&&(a=a.gadgetInfo_)&&a.modulePrefs&&a.modulePrefs.title?a.modulePrefs.title:osapi.container.Site.DEFAULT_TITLE};osapi.container.Site.prototype.close=function(){var a=this.getActiveSiteHolder();a&&a.dispose()};osapi.container.Site.prototype.getParentId=function(){return this.parentId_};
osapi.container.Site.prototype.setParentId=function(a){this.parentId_=a;return this};osapi.container.Site.prototype.getActiveSiteHolder=function(){throw Error("This method must be implemented by a subclass.");};osapi.container.Site.prototype.render=function(){throw Error("This method must be implemented by a subclass.");};osapi.container.SiteHolder=function(b,a,c){this.site_=b;this.el_=a;this.onLoad_=c;this.renderParams_=this.iframeId_=void 0;this.onConstructed()};osapi.container.SiteHolder.prototype.onConstructed=function(){};osapi.container.SiteHolder.prototype.getElement=function(){return this.el_};osapi.container.SiteHolder.prototype.getIframeId=function(){return this.iframeId_};
osapi.container.SiteHolder.prototype.dispose=function(){var b=this.el_,a=function(){b&&b.firstChild&&b.removeChild(b.firstChild)};"undefined"===typeof window.__CONTAINER_URI?setTimeout(a,50):a()};osapi.container.SiteHolder.prototype.createIframeHtml=function(b,a){var c=this.createIframeAttributeMap(b,a);c.onload=this.onLoad_?"window."+this.onLoad_+"('"+this.getUrl()+"', '"+this.site_.getId()+"');":void 0;return osapi.container.util.createIframeHtml(c)};
osapi.container.SiteHolder.prototype.createIframeAttributeMap=function(b,a){var c=this.renderParams_||{},c={id:this.iframeId_,name:this.iframeId_,src:b,scrolling:"no",marginwidth:0,marginheight:0,frameborder:0,vspace:0,hspace:0,"class":c[osapi.container.RenderParam.CLASS],height:c[osapi.container.RenderParam.HEIGHT],width:c[osapi.container.RenderParam.WIDTH]};if(a)for(var d in a)c[d]=a[d];return c};
osapi.container.SiteHolder.prototype.setTitle=function(b){var a=this.getIframeElement();a&&(a.title=b)};osapi.container.SiteHolder.prototype.getIframeElement=function(){throw Error("This method must be implemented by a subclass.");};osapi.container.SiteHolder.prototype.render=function(){throw Error("This method must be implemented by a subclass.");};osapi.container.SiteHolder.prototype.getUrl=function(){throw Error("This method must be implemented by a subclass.");};osapi.container.GadgetHolder=function(a,c,b){osapi.container.SiteHolder.call(this,a,c,b);this.securityTokenTTL_=this.securityToken_=this.viewParams_=this.gadgetInfo_=void 0;this.onConstructed()};osapi.container.GadgetHolder.prototype=new osapi.container.SiteHolder;osapi.container.GadgetHolder.prototype.relayPath_=null;osapi.container.GadgetHolder.prototype.getGadgetInfo=function(){return this.gadgetInfo_};
osapi.container.GadgetHolder.prototype.dispose=function(){osapi.container.SiteHolder.prototype.dispose.call(this);this.gadgetInfo_=null};osapi.container.GadgetHolder.prototype.getUrl=function(){return this.gadgetInfo_&&this.gadgetInfo_.url};osapi.container.GadgetHolder.prototype.getView=function(){return this.renderParams_[osapi.container.RenderParam.VIEW]};osapi.container.GadgetHolder.prototype.getIframeElement=function(){return this.el_.getElementsByTagName("iframe")[0]};
osapi.container.GadgetHolder.prototype.setSecurityToken=function(a,c){this.securityToken_=a;this.securityTokenTTL_=c;return this};osapi.container.GadgetHolder.prototype.render=function(a,c,b){this.iframeId_=osapi.container.GadgetHolder.IFRAME_ID_PREFIX_+this.site_.getId();this.gadgetInfo_=a;this.viewParams_=c;this.renderParams_=b;this.hasFeature_(a,"pubsub-2")?this.doOaaIframeHtml_(this.renderParams_):this.doNormalIframeHtml_(this.renderParams_)};osapi.container.GadgetHolder.IFRAME_ID_PREFIX_="__gadget_";
osapi.container.GadgetHolder.DEFAULT_GADGET_TITLE="gadget contents";
osapi.container.GadgetHolder.prototype.doNormalIframeHtml_=function(a){var c=this.removeStFromIfrAddr(this.getIframeUrl_()),b=null;if(this.el_.ownerDocument&&null!==this.el_.ownerDocument){for(var b=this.el_.ownerDocument.defaultView,d=0;b&&b!==window;)b=b.parent,d++;b=shindig.uri(c);b.setFP("embeddedlevel",d)}else b=shindig.uri(c);c=document.createElement("div");d={};a&&!0===a.isSandboxAttrEnabled&&(a=cre$.config.sandbox,null!==a&&(void 0!==a&&"string"===typeof a)&&(d.sandbox=a));d.title=this.site_.getTitle();
d.role="presentation";for(c.innerHTML=this.createIframeHtml(b.toString(),d);this.el_.firstChild;)this.el_.removeChild(this.el_.firstChild);this.el_.appendChild(c.children[0]);a=shindig.uri().setSchema(b.getSchema()).setAuthority(b.getAuthority()).setPath(this.relayPath_);gadgets.rpc.setupReceiver(this.iframeId_,a.toString(),b.getFP("rpctoken"))};
osapi.container.GadgetHolder.prototype.doOaaIframeHtml_=function(a){this.removeOaaContainer_(this.iframeId_);var c=this.removeStFromIfrAddr(this.getIframeUrl_()),b=this,d={};a&&!0===a.isSandboxAttrEnabled&&(a=cre$.config.sandbox,null!==a&&(void 0!==a&&"string"===typeof a)&&(d.sandbox=a));d.title=this.site_.getTitle();d.role="presentation";new OpenAjax.hub.IframeContainer(gadgets.pubsub2router.hub,this.iframeId_,{Container:{onSecurityAlert:function(a,b){gadgets.error(["Security error for container ",
a.getClientID()," : ",b].join(""));a.getIframe().src="about:blank"},onConnect:function(a){gadgets.log(["connected: ",a.getClientID()].join(""))}},IframeContainer:{parent:this.el_,uri:c,tunnelURI:shindig.uri(this.relayPath_).resolve(shindig.uri(window.location.href)),iframeAttrs:this.createIframeAttributeMap(c,d),onGadgetLoad:function(){if(b.onLoad_)window[b.onLoad_](b.getUrl(),b.site_.getId())}}})};
osapi.container.GadgetHolder.prototype.removeOaaContainer_=function(a){(a=gadgets.pubsub2router.hub.getContainer(a))&&gadgets.pubsub2router.hub.removeContainer(a)};osapi.container.GadgetHolder.prototype.hasFeature_=function(a,c){var b=a[osapi.container.MetadataResponse.MODULE_PREFS];return b&&(b=b[osapi.container.MetadataResponse.FEATURES])&&b[c]?!0:!1};
osapi.container.GadgetHolder.prototype.getIframeUrl_=function(){var a=shindig.uri(this.gadgetInfo_[osapi.container.MetadataResponse.IFRAME_URLS][this.getView()]);a.setQP("debug",this.renderParams_[osapi.container.RenderParam.DEBUG]?"1":"0");a.setQP("nocache",this.renderParams_[osapi.container.RenderParam.NO_CACHE]?"1":"0");a.setQP("testmode",this.renderParams_[osapi.container.RenderParam.TEST_MODE]?"1":"0");a.setQP("view",this.getView());if(this.renderParams_[osapi.container.RenderParam.CAJOLE]){var c=
a.getQP("libs");null==c||""==c?a.setQP("libs","caja"):a.setQP("libs",[c,":caja"].join(""));a.setQP("caja","1")}this.renderParams_[osapi.container.RenderParam.REFRESH]&&a.setQP("refresh",this.renderParams_[osapi.container.RenderParam.REFRESH]);this.updateUserPrefParams_(a);a.setQP("parent",window.__CONTAINER_URI.getOrigin());!this.securityTokenInCookie_&&this.securityToken_?a.setExistingP("st",this.securityToken_):this.securityTokenInCookie_&&(c=a.getQP("st"),"undefined"!=typeof c&&(this.securityToken_||
(this.securityToken_=c),a.setQP("st",void 0)));a.setQP("mid",String(this.site_.getModuleId()));osapi.container.util.isEmptyJson(this.viewParams_)||(c=gadgets.json.stringify(this.viewParams_),a.setFP("view-params",c));"undefined"===typeof a.getFP("rpctoken")&&(c=2147483647*Math.random()|0,a.setFP("rpctoken",c));var c=this.site_.service_.getLanguage(),b=this.site_.service_.getCountry(),d=a.getQP("lang"),e=a.getQP("country");-1!=d.indexOf("%")&&a.setQP("lang",c);-1!=e.indexOf("%")&&a.setQP("country",
b);return a.toString()};osapi.container.GadgetHolder.prototype.updateUserPrefParams_=function(a){var c=this.renderParams_[osapi.container.RenderParam.USER_PREFS];if(c)for(var b in c){var d="up_"+b,e=c[b];e instanceof Array&&(e=e.join("|"));a.setExistingP(d,e)}};
osapi.container.GadgetHolder.prototype.removeStFromIfrAddr=function(a){if("string"===typeof a){var c=a,b=a.indexOf("st\x3d"),d=a.indexOf("\x26",b);if(-1!=b){var e;-1!=d?(e=a.substring(b+3,d),c=d+1<a.length?a.substring(0,b)+a.substring(d+1):a.substring(0,b)):(b+3<a.length&&(e=a.substring(b)),c=a.substring(0,b));this.securityToken_=e}return this.securityTokenInCookie_?c:a}return a};
gadgets.config&&gadgets.config.register("container",null,function(a){a.container&&(osapi.container.GadgetHolder.prototype.relayPath_=a.container.relayPath);a["core.io"]&&(osapi.container.GadgetHolder.prototype.securityTokenInCookie_=a["core.io"].securityTokenInCookie)});osapi.container.GadgetSite=function(b,c,d){osapi.container.Site.call(this,b,c,d.gadgetEl);this.navigateCallback_=d.navigateCallback;this.loadingGadgetEl_=d.bufferEl;this.gadgetOnLoad_=d.gadgetOnLoad;this.moduleId_=0;this.loadingGadgetHolder_=this.currentGadgetHolder_=void 0;this.onConstructed()};osapi.container.GadgetSite.prototype=new osapi.container.Site;osapi.container.GadgetSite.prototype.getModuleId=function(){return this.moduleId_};
osapi.container.GadgetSite.prototype.setModuleId_=function(b,c,d){if(c&&this.moduleId_!=c){var a=this;b=osapi.container.util.buildTokenRequestUrl(b,c);if(!a.service_.getCachedGadgetToken(b)){c=osapi.container.util.newTokenRequest([b]);a.service_.getGadgetToken(c,function(c){var e;if(c&&c[b]&&((e=c[b][osapi.container.TokenResponse.TOKEN_TTL])&&a.container_.scheduleRefreshTokens_(e),(c=c[b][osapi.container.TokenResponse.MODULE_ID])||0==c))a.moduleId_=c;d&&d()});return}}d&&d()};
osapi.container.GadgetSite.prototype.getActiveSiteHolder=function(){return this.loadingGadgetHolder_||this.currentGadgetHolder_};osapi.container.GadgetSite.prototype.setTitle=function(b){osapi.container.Site.prototype.setTitle.call(this,b);this.loadingGadgetHolder_&&this.currentGadgetHolder_&&this.currentGadgetHolder_.setTitle(b);return this};
osapi.container.GadgetSite.prototype.getFeature=function(b,c){var d=c||this.getActiveSiteHolder().getGadgetInfo();return d[osapi.container.MetadataResponse.FEATURES]&&d[osapi.container.MetadataResponse.FEATURES][b]};
osapi.container.GadgetSite.prototype.navigateTo=function(b,c,d,a){var f=osapi.container.util.getCurrentTimeMs(),e=this.service_.getCachedGadgetMetadata(b),h=a||function(){};a=osapi.container.util.newMetadataRequest([b]);var g=this;this.service_.getGadgetMetadata(a,function(a){var l=!e?osapi.container.util.getCurrentTimeMs()-f:0,k=a[b];k.error?(a=["Failed to navigate for gadget ",b,"."].join(""),gadgets.warn(a),a=["Detailed error: ",k.error.code||""," ",k.error.message||""].join(""),gadgets.log(a)):
g.setModuleId_(b,d[osapi.container.RenderParam.MODULE_ID]||0,function(){g.container_.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_BEFORE_RENDER,k);g.render(k,c,d)});a={};a[osapi.container.NavigateTiming.URL]=b;a[osapi.container.NavigateTiming.ID]=g.id_;a[osapi.container.NavigateTiming.START]=f;a[osapi.container.NavigateTiming.XRT]=l;g.onNavigateTo(a);h(k)})};
osapi.container.GadgetSite.prototype.onNavigateTo=function(b){if(this.navigateCallback_){var c=window[this.navigateCallback_];"function"===typeof c&&c(b)}};
osapi.container.GadgetSite.prototype.render=function(b,c,d){var a=null;if((this.currentGadgetHolder_?this.currentGadgetHolder_.getUrl():null)==b.url)a=this.currentGadgetHolder_.getView();var f=function(a){if("undefined"!==typeof a&&null!=a){a=a.aliases||[];for(var c=0;c<a.length;c++)if(b[osapi.container.MetadataResponse.VIEWS][a[c]])return{view:a[c],viewInfo:b[osapi.container.MetadataResponse.VIEWS][a[c]]}}return null},a=d[osapi.container.RenderParam.VIEW]||c[osapi.container.ViewParam.VIEW]||a,e=
b[osapi.container.MetadataResponse.VIEWS][a];if(a&&!e){var h=f(gadgets.config.get("views")[a]);h&&(a=h.view,e=h.viewInfo)}if(!e&&(d[osapi.container.RenderParam.ALLOW_DEFAULT_VIEW]&&a!=osapi.container.GadgetSite.DEFAULT_VIEW_)&&(a=osapi.container.GadgetSite.DEFAULT_VIEW_,e=b[osapi.container.MetadataResponse.VIEWS][a],!e&&(h=f(gadgets.config.get("views")[a]))))a=h.view,e=h.viewInfo;if(e){this.currentGadgetHolder_&&!this.loadingGadgetEl_?(this.loadingGadgetHolder_=this.currentGadgetHolder_,this.currentGadgetHolder_=
null):this.loadingGadgetHolder_=new osapi.container.GadgetHolder(this,this.loadingGadgetEl_||this.el_,this.gadgetOnLoad_);var f={},g;for(g in d)f[g]=d[g];f[osapi.container.RenderParam.VIEW]=a;f[osapi.container.RenderParam.HEIGHT]=d[osapi.container.RenderParam.HEIGHT]||e[osapi.container.MetadataResponse.PREFERRED_HEIGHT]||b[osapi.container.MetadataResponse.MODULE_PREFS][osapi.container.MetadataResponse.HEIGHT]||String(osapi.container.GadgetSite.DEFAULT_HEIGHT_);f[osapi.container.RenderParam.WIDTH]=
d[osapi.container.RenderParam.WIDTH]||e[osapi.container.MetadataResponse.PREFERRED_WIDTH]||b[osapi.container.MetadataResponse.MODULE_PREFS][osapi.container.MetadataResponse.WIDTH]||String(osapi.container.GadgetSite.DEFAULT_WIDTH_);this.updateSecurityToken_(b,f);this.loadingGadgetHolder_.render(b,c,f)}else gadgets.warn(["Unsupported view ",a," for gadget ",b.url,"."].join(""))};
osapi.container.GadgetSite.prototype.onRender=function(){this.loadingGadgetHolder_&&(this.swapBuffers_(),this.currentGadgetHolder_&&this.currentGadgetHolder_.dispose(),this.currentGadgetHolder_=this.loadingGadgetHolder_,this.loadingGadgetHolder_=null)};osapi.container.GadgetSite.prototype.rpcCall=function(b,c,d){this.currentGadgetHolder_&&gadgets.rpc.call(this.currentGadgetHolder_.getIframeId(),b,c,d)};
osapi.container.GadgetSite.prototype.updateSecurityToken_=function(b,c){var d=osapi.container.util.buildTokenRequestUrl(b.url,this.moduleId_);(d=this.service_.getCachedGadgetToken(d))&&this.loadingGadgetHolder_.setSecurityToken(d[osapi.container.TokenResponse.TOKEN])};osapi.container.GadgetSite.prototype.close=function(){this.loadingGadgetHolder_&&this.loadingGadgetHolder_.dispose();this.currentGadgetHolder_&&this.currentGadgetHolder_.dispose()};
osapi.container.GadgetSite.prototype.swapBuffers_=function(){if(this.loadingGadgetEl_){this.loadingGadgetEl_.style.left="";this.loadingGadgetEl_.style.position="";this.el_.style.position="absolute";this.el_.style.left="-2000px";var b=this.el_;this.el_=this.loadingGadgetEl_;this.loadingGadgetEl_=b}};osapi.container.GadgetSite.RPC_ARG_KEY="gs";osapi.container.GadgetSite.DEFAULT_HEIGHT_=200;osapi.container.GadgetSite.DEFAULT_WIDTH_=320;osapi.container.GadgetSite.DEFAULT_VIEW_="default";osapi.container.UrlHolder=function(a,b,c){osapi.container.SiteHolder.call(this,a,b,c);this.url_=void 0;this.onConstructed()};osapi.container.UrlHolder.prototype=new osapi.container.SiteHolder;osapi.container.UrlHolder.prototype.dispose=function(){osapi.container.SiteHolder.prototype.dispose.call(this);this.url_=null};osapi.container.UrlHolder.prototype.getIframeElement=function(){return this.el_.firstChild};osapi.container.UrlHolder.prototype.getUrl=function(){return this.url_};
osapi.container.UrlHolder.prototype.render=function(a,b){this.iframeId_=osapi.container.UrlHolder.IFRAME_PREFIX_+this.site_.getId();this.renderParams_=b;this.el_.innerHTML=this.createIframeHtml(this.url_=a,{scrolling:"auto",title:this.site_.getTitle(),role:"presentation"})};osapi.container.UrlHolder.IFRAME_PREFIX_="__url_";osapi.container.UrlSite=function(c,a,b){osapi.container.Site.call(this,c,a,b[osapi.container.UrlSite.URL_ELEMENT]);this.url_=this.holder_=void 0;this.onConstructed()};osapi.container.UrlSite.prototype=new osapi.container.Site;osapi.container.UrlSite.prototype.getActiveSiteHolder=function(){return this.holder_};osapi.container.UrlSite.prototype.render=function(c,a){this.holder_=new osapi.container.UrlHolder(this,this.el_);var b={},d;for(d in a)b[d]=a[d];this.holder_.render(c,b)};
osapi.container.UrlSite.URL_ELEMENT="urlEl";osapi.container.Service=function(a){this.container_=a;a=this.config_=a.config_||{};var b=((gadgets.config.get("osapi")||{}).endPoints||[window.__API_URI.getOrigin()+"/rpc"])[0],b=/^([^\/]*\/\/[^\/]+)(.*)$/.exec(b);this.apiHost_=String(osapi.container.util.getSafeJsonValue(a,osapi.container.ServiceConfig.API_HOST,b[1]));this.apiPath_=String(osapi.container.util.getSafeJsonValue(a,osapi.container.ServiceConfig.API_PATH,b[2]));this.cachedMetadatas_={};this.cachedTokens_={};a.GET_LANGUAGE&&(this.getLanguage=
a.GET_LANGUAGE);a.GET_COUNTRY&&(this.getCountry=a.GET_COUNTRY);this.registerOsapiServices();this.onConstructed(a,self)};osapi.container.Service.prototype.onConstructed=function(a,b){};
osapi.container.Service.prototype.getGadgetMetadata=function(a,b){var f=b||function(){},d=osapi.container.util.toArrayOfJsonKeys(this.getUncachedDataByRequest_(this.cachedMetadatas_,a)),c=this.getCachedDataByRequest_(this.cachedMetadatas_,a);if(0==d.length)f(c);else{var g=this;a.ids=d;a.language=this.getLanguage();a.country=this.getCountry();this.updateContainerSecurityToken(function(b){if(b){for(var e=0;e<a.ids.length;e++)c[a.ids[e]]={error:b};f(c)}else osapi.gadgets.metadata(a).execute(function(b){if(b.error)for(var e=
0;e<a.ids.length;e++){var d=a.ids[e];c[d]={error:b.error}}else for(d in e=osapi.container.util.getCurrentTimeMs(),b){var h=b[d];g.updateResponse_(h,d,e);g.cachedMetadatas_[d]=h;c[d]=h}f(c)})})}};osapi.container.Service.prototype.addGadgetMetadatas=function(a,b){this.addToCache_(a,b,this.cachedMetadatas_)};osapi.container.Service.prototype.addGadgetTokens=function(a,b){this.addToCache_(a,b,this.cachedTokens_)};
osapi.container.Service.prototype.addToCache_=function(a,b,f){var d=osapi.container.util.getCurrentTimeMs(),c;for(c in a){var g=a[c];this.updateResponse_(g,c,d,b);f[c]=g}};osapi.container.Service.prototype.updateResponse_=function(a,b,f,d){a[osapi.container.MetadataParam.URL]=b;a[osapi.container.MetadataParam.LOCAL_EXPIRE_TIME]=a[osapi.container.MetadataResponse.EXPIRE_TIME_MS]-(null==d?a[osapi.container.MetadataResponse.RESPONSE_TIME_MS]:d)+f};
osapi.container.Service.prototype.getGadgetToken=function(a,b){var f=b||function(){},d=this,c=function(b){var c={};if(b.error)for(var e=0;e<a.ids.length;e++)c[a.ids[e]]={error:b.error};else for(e in b){var m=osapi.container.util.buildTokenRequestUrl(e,b[e][osapi.container.TokenResponse.MODULE_ID]);d.cachedTokens_[m]=b[e];c[e]=b[e]}f(c)};d.updateContainerSecurityToken(function(b){if(b)c({error:b});else if(d.config_[osapi.container.ContainerConfig.GET_GADGET_TOKEN])d.config_[osapi.container.ContainerConfig.GET_GADGET_TOKEN](a,
c);else osapi.gadgets.token(a).execute(c)})};osapi.container.Service.prototype.getCachedGadgetMetadata=function(a){return this.cachedMetadatas_[a]};osapi.container.Service.prototype.getCachedGadgetToken=function(a){return this.cachedTokens_[a]};
osapi.container.Service.prototype.uncacheStaleGadgetMetadataExcept=function(a){for(var b in this.cachedMetadatas_)"undefined"===typeof a[b]&&this.cachedMetadatas_[b][osapi.container.MetadataParam.LOCAL_EXPIRE_TIME]<osapi.container.util.getCurrentTimeMs()&&delete this.cachedMetadatas_[b]};
osapi.container.Service.prototype.registerOsapiServices=function(){var a=this.apiHost_+this.apiPath_,b={"gadgets.rpc":["container.listMethods"]};b[a]=["gadgets.metadata","gadgets.token"];gadgets.config.init({osapi:{endPoints:[a]},"osapi.services":b})};osapi.container.Service.prototype.getCachedDataByRequest_=function(a,b){return this.filterCachedDataByRequest_(a,b,function(a){return"undefined"!==typeof a})};
osapi.container.Service.prototype.getUncachedDataByRequest_=function(a,b){return this.filterCachedDataByRequest_(a,b,function(a){return"undefined"===typeof a})};osapi.container.Service.prototype.filterCachedDataByRequest_=function(a,b,f){for(var d={},c=0;c<b.ids.length;c++){var g=b.ids[c],h=a[g];f(h)&&(d[g]=h)}return d};osapi.container.Service.prototype.getLocale_=function(){var a=window.navigator;return a.userLanguage||a.systemLanguage||a.language};
osapi.container.Service.prototype.getLanguage=function(){try{return this.getLocale_().split("-")[0]||"ALL"}catch(a){return"ALL"}};osapi.container.Service.prototype.getCountry=function(){try{return this.getLocale_().split("-")[1]||"ALL"}catch(a){return"ALL"}};
(function(){function a(a,b){for(;a.length;)a.shift().call(null,b)}function b(e){var m=this;f&&(clearTimeout(f),f=0);(e=e||this.config_[osapi.container.ContainerConfig.GET_CONTAINER_TOKEN])?c||(c=!0,e(function(e,l,k){c=!1;(g="number"==typeof l?800*l:g)&&(f=setTimeout(gadgets.util.makeClosure(m,b,null),g));e?(shindig.auth.updateSecurityToken(e),d=osapi.container.util.getCurrentTimeMs(),a(h)):k&&a(h,k)})):(c=!1,a(h))}var f,d,c,g=144E4,h=[];osapi.container.Service.prototype.updateContainerSecurityToken=
function(a,f,n){var l=osapi.container.util.getCurrentTimeMs(),k="boolean"!=typeof f&&f||void 0;f="boolean"==typeof f&&f;g&&(c||k||!d||l>d+g)?(d&&!(l>d+95*g/80)&&a?a():a&&h.push(a),k?b.call(this,function(a){a(k,n)}):!c&&!f&&b.call(this)):a&&a()}})();osapi.container.Container=function(a){a=this.config_=a||{};this.gadgetLifecycleCallbacks_={};this.preloadedGadgetUrls_={};this.sites_={};this.allowDefaultView_=Boolean(osapi.container.util.getSafeJsonValue(a,osapi.container.ContainerConfig.ALLOW_DEFAULT_VIEW,!0));this.renderCajole_=Boolean(osapi.container.util.getSafeJsonValue(a,osapi.container.ContainerConfig.RENDER_CAJOLE,!1));this.renderDebugParam_=String(osapi.container.util.getSafeJsonValue(a,osapi.container.ContainerConfig.RENDER_DEBUG_PARAM,
osapi.container.ContainerConfig.RENDER_DEBUG));window._osapi_container_ContainerArray=window._osapi_container_ContainerArray||[];window._osapi_container_ContainerArray.push(this);this._callPostServiceConstruction=[];osapi.container.Container.prototype._finish_init_=function(a){if(window.__CONTAINER_URI){var b=window._osapi_container_ContainerArray[a],e=window.__CONTAINER_URI.getQP(b.renderDebugParam_);window._osapi_container_ContainerArray[a].renderDebug_="undefined"===typeof e?Boolean(osapi.container.util.getSafeJsonValue(b.config_,
osapi.container.ContainerConfig.RENDER_DEBUG,!1)):"1"===e;b.service_=new osapi.container.Service(b);a=0;for(e=b._callPostServiceConstruction.length;a<e;a++)try{b._callPostServiceConstruction[a](b)}catch(f){console.log("error: "+f.message)}b.initializeMixins_(b);b.setupRpcArbitrator_(b,b.config_);b.preloadCaches(b,b.config_);b.registerRpcServices_(b);b.onConstructed(b.config_,b)}else setTimeout("osapi.container.Container.prototype._finish_init_("+a+");",10)};osapi.container.Container.prototype._finish_init_(window._osapi_container_ContainerArray.length-
1);this.renderTest_=Boolean(osapi.container.util.getSafeJsonValue(a,osapi.container.ContainerConfig.RENDER_TEST,!1));this.tokenRefreshInterval_=Number(osapi.container.util.getSafeJsonValue(a,osapi.container.ContainerConfig.TOKEN_REFRESH_INTERVAL,0));this.lastRefresh_=0;this.navigateCallback_=String(osapi.container.util.getSafeJsonValue(a,osapi.container.ContainerConfig.NAVIGATE_CALLBACK,null));this.tokenRefreshTimer_=null;var b=this;window[osapi.container.CallbackType.GADGET_ON_LOAD]=function(a,d){b.getSiteById(d).onRender();
b.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_RENDER,a,d)}};osapi.container.Container.prototype.newGadgetSite=function(a,b){if(null===a||void 0===a){var c=["Failed to create gadget site because gadgetEl is ",a,"."].join("");gadgets.error(c);return null}c=new osapi.container.GadgetSite(this,this.service_,{navigateCallback:this.navigateCallback_,gadgetEl:a,bufferEl:b||null,gadgetOnLoad:osapi.container.CallbackType.GADGET_ON_LOAD});return this.sites_[c.getId()]=c};
osapi.container.Container.prototype.navigateGadget=function(a,b,c,d,e){var f=e||function(){};e=osapi.container.ContainerConfig;var g=osapi.container.RenderParam;this.allowDefaultView_&&(d[g.ALLOW_DEFAULT_VIEW]=!0);this.renderCajole_&&(d[g.CAJOLE]=!0);this.renderDebug_&&(d[g.NO_CACHE]=!0,d[g.DEBUG]=!0);this.renderTest_&&(d[g.TEST_MODE]=!0);this.refreshService_();var h=this,k=function(e){d[g.USER_PREFS]=e;h.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_BEFORE_NAVIGATE,b,a.getId());a.navigateTo(b,
c,d,function(c){c.error?gadgets.warn(["Failed to possibly schedule token refresh for gadget ",b,"."].join("")):c[osapi.container.MetadataResponse.NEEDS_TOKEN_REFRESH]&&h.scheduleRefreshTokens_(c[osapi.container.MetadataResponse.TOKEN_TTL]);h.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_NAVIGATED,a);f(c)})};if(this.config_[e.GET_PREFERENCES]&&!d[g.USER_PREFS])this.config_[e.GET_PREFERENCES](a.getId(),b,k);else k(d[g.USER_PREFS])};
osapi.container.Container.prototype.closeGadget=function(a){var b=a.getId();this.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_BEFORE_CLOSE,a);a.close();this.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_CLOSED,a);delete this.sites_[b];a instanceof osapi.container.GadgetSite&&this.unscheduleRefreshTokens_()};osapi.container.Container.prototype.addGadgetLifecycleCallback=function(a,b){return!this.gadgetLifecycleCallbacks_[a]?(this.gadgetLifecycleCallbacks_[a]=b,!0):!1};
osapi.container.Container.prototype.removeGadgetLifecycleCallback=function(a){delete this.gadgetLifecycleCallbacks_[a]};osapi.container.Container.prototype.preloadGadget=function(a,b){this.preloadGadgets([a],b)};
osapi.container.Container.prototype.preloadGadgets=function(a,b){var c=b||function(){},d=osapi.container.util.newMetadataRequest(a),e=this;this.refreshService_();this.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_BEFORE_PRELOAD,a);this.service_?this.service_.getGadgetMetadata(d,function(a){e.addPreloadGadgets_(a);e.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_PRELOADED,a);c(a)}):this._callPostServiceConstruction.push(function(a){a.service_.getGadgetMetadata(d,function(b){a.addPreloadGadgets_(b);
a.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_PRELOADED,b);c(b)})})};osapi.container.Container.prototype.unloadGadget=function(a){this.unloadGadgets([a])};osapi.container.Container.prototype.unloadGadgets=function(a){for(var b=0;b<a.length;b++){var c=a[b];this.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_BEFORE_UNLOAD,c);delete this.preloadedGadgetUrls_[c];this.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_UNLOADED,c)}};
osapi.container.Container.prototype.getGadgetMetadata=function(a,b){var c=osapi.container.util.newMetadataRequest([a]);this.service_?(this.refreshService_(),this.service_.getGadgetMetadata(c,b)):this._callPostServiceConstruction.push(function(a){a.refreshService_();a.service_.getGadgetMetadata(c,b)})};
osapi.container.Container.prototype.rpcRegister=function(a,b){var c=this;return gadgets.rpc.register(a,function(){this[osapi.container.GadgetSite.RPC_ARG_KEY]=c.getGadgetSiteByIframeId_(this.f);for(var a=[this],e=0;e<arguments.length;++e)a.push(arguments[e]);return b.apply(c,a)})};osapi.container.Container.prototype.onConstructed=function(a,b){};
osapi.container.Container.addMixin=function(a,b){var c=osapi.container.Container.prototype.mixins_;if(c[a]){var d=c[a];c[a]=function(a){d.call(this,a);return b.call(this,a)}}else osapi.container.Container.prototype.mixinsOrder_.push(a),c[a]=b};osapi.container.Container.prototype.mixins_={};osapi.container.Container.prototype.mixinsOrder_=[];
osapi.container.Container.prototype.initializeMixins_=function(a){for(var b=osapi.container.Container.prototype.mixins_,c=osapi.container.Container.prototype.mixinsOrder_,d=0;d<c.length;d++){var e=c[d];a[e]=new b[e](a)}};
osapi.container.Container.prototype.addPreloadGadgets_=function(a,b){var c=b||{},d;for(d in a)if(a[d].error){var e=["Failed to preload gadget ",d,"."].join("");gadgets.warn(e);e=["Detailed error: ",a[d].error.code||""," ",a[d].error.message||""].join("");gadgets.log(e)}else this.addPreloadedGadgetUrl_(d),a[d][osapi.container.MetadataResponse.NEEDS_TOKEN_REFRESH]&&this.scheduleRefreshTokens_(c[d]?c[d][osapi.container.TokenResponse.TOKEN_TTL]:a[d][osapi.container.MetadataResponse.TOKEN_TTL])};
osapi.container.Container.prototype.preloadCaches=function(a,b){var c=osapi.container.util.getSafeJsonValue(b,osapi.container.ContainerConfig.PRELOAD_METADATAS,{}),d=osapi.container.util.getSafeJsonValue(b,osapi.container.ContainerConfig.PRELOAD_TOKENS,{}),e=osapi.container.util.getSafeJsonValue(b,osapi.container.ContainerConfig.PRELOAD_REF_TIME,null),f=[],g;for(g in c)c.hasOwnProperty(g)&&f.push(g);a.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_BEFORE_PRELOAD,f);a.service_.addGadgetMetadatas(c,
e);a.service_.addGadgetTokens(d,e);a.addPreloadGadgets_(c,d);a.applyLifecycleCallbacks_(osapi.container.CallbackType.ON_PRELOADED,c)};osapi.container.Container.prototype.refreshService_=function(){var a=this.getActiveGadgetUrls_();this.service_.uncacheStaleGadgetMetadataExcept(a)};osapi.container.Container.prototype.getGadgetSiteByIframeId_=function(a){for(var b in this.sites_){var c=this.sites_[b],d=c.getActiveSiteHolder();if(d&&d.getIframeId()===a)return c}return null};
osapi.container.Container.prototype.getSiteById=function(a){return this.sites_[a]};osapi.container.Container.prototype.updateContainerSecurityToken=function(a,b,c){this.service_?this.service_.updateContainerSecurityToken(a,b,c):this._callPostServiceConstruction.push(function(d){d.service_.updateContainerSecurityToken(a,b,c)})};
osapi.container.Container.prototype.scheduleRefreshTokens_=function(a){var b=this,c=this.tokenRefreshInterval_,d=a?this.setRefreshTokenInterval_(1E3*a):c,e=function(){function a(c){c?setTimeout(gadgets.util.makeClosure(b,b.updateContainerSecurityToken,a,!0),1):(b.lastRefresh_=osapi.container.util.getCurrentTimeMs(),b.tokenRefreshTimer_=setTimeout(e,d),b.refreshTokens_())}b.updateContainerSecurityToken(a)};if(this.isRefreshTokensEnabled_()&&(!this.tokenRefreshTimer_||d!=c))a=osapi.container.util.getCurrentTimeMs(),
this.tokenRefreshTimer_?(c=(this.lastRefresh_||0)+c,c<a&&(c=a+d,d=1),c>a+d&&(clearTimeout(this.tokenRefreshTimer_),this.tokenRefreshTimer_=setTimeout(e,d))):(this.lastRefresh_=a,this.tokenRefreshTimer_=setTimeout(e,d))};osapi.container.Container.prototype.unscheduleRefreshTokens_=function(){this.tokenRefreshTimer_&&0>=this.getTokenRefreshableGadgetUrls_().length&&(clearTimeout(this.tokenRefreshTimer_),this.tokenRefreshTimer_=null)};
osapi.container.Container.prototype.isRefreshTokensEnabled_=function(){return 0<this.tokenRefreshInterval_};osapi.container.Container.prototype.setRefreshTokenInterval_=function(a){if(a){a*=0.8;var b=this.tokenRefreshInterval_;return 0>b?b:this.tokenRefreshInterval_=0==b?a:Math.min(b,a)}};
osapi.container.Container.prototype.registerRpcServices_=function(a){a.rpcRegister("resize_iframe",function(a,c){var d=a[osapi.container.GadgetSite.RPC_ARG_KEY];d&&d.setHeight(c)});a.rpcRegister("resize_iframe_width",function(a,c){var d=a[osapi.container.GadgetSite.RPC_ARG_KEY];d&&d.setWidth(c);return!0});this.rpcRegister("set_pref",function(b,c,d){var e=b[osapi.container.GadgetSite.RPC_ARG_KEY],f=a.config_[osapi.container.ContainerConfig.SET_PREFERENCES];if(e&&f){for(var g={},h=2,k=arguments.length;h<
k;h+=2)g[arguments[h]]=arguments[h+1];f(e.getId(),e.getActiveSiteHolder().getUrl(),g)}})};
osapi.container.Container.prototype.setupRpcArbitrator_=function(a,b){var c=gadgets.config.get("container");"undefined"!==typeof c.enableRpcArbitration&&c.enableRpcArbitration&&((c=osapi.container.util.getSafeJsonValue(b,osapi.container.ContainerConfig.RPC_ARBITRATOR,null))||(c=function(b,c){var f=a.getGadgetSiteByIframeId_(c);if(f&&f.getActiveSiteHolder()&&(f=a.service_.getCachedGadgetMetadata(f.getActiveSiteHolder().getUrl()),!f.error&&f.rpcServiceIds))for(var g=0,h;h=f.rpcServiceIds[g];g++)if(h==
b)return!0;gadgets.warn("RPC call to "+b+" was not allowed.");return!1}),gadgets.rpc.config({arbitrator:c}))};osapi.container.Container.prototype.addPreloadedGadgetUrl_=function(a){this.preloadedGadgetUrls_[a]=null};
osapi.container.Container.prototype.getTokenRefreshableGadgetUrls_=function(){var a={},b;for(b in this.getActiveGadgetUrls_())this.service_.getCachedGadgetMetadata(b)[osapi.container.MetadataResponse.NEEDS_TOKEN_REFRESH]&&(a[b]=1);for(var c in this.sites_){var d=this.sites_[c];if(d instanceof osapi.container.GadgetSite&&(b=d.getActiveSiteHolder()))b=b.getUrl(),mid=d.getModuleId(),a[b]&&(a[osapi.container.util.buildTokenRequestUrl(b,mid)]=1)}return osapi.container.util.toArrayOfJsonKeys(a)};
osapi.container.Container.prototype.getActiveGadgetUrls_=function(){return osapi.container.util.mergeJsons(this.getNavigatedGadgetUrls_(),this.preloadedGadgetUrls_)};osapi.container.Container.prototype.getNavigatedGadgetUrls_=function(){var a={},b;for(b in this.sites_){var c=this.sites_[b];c instanceof osapi.container.GadgetSite&&(c=c.getActiveSiteHolder())&&(a[c.getUrl()]=1)}return a};
osapi.container.Container.prototype.refreshTokens_=function(){var a=this.getTokenRefreshableGadgetUrls_(),a=osapi.container.util.newTokenRequest(a),b=this;this.service_.getGadgetToken(a,function(a){for(var d in b.sites_){var e=b.sites_[d];if(e instanceof osapi.container.GadgetSite){var f=e.getActiveSiteHolder();if(f&&b.service_.getCachedGadgetMetadata(f.getUrl())[osapi.container.MetadataResponse.NEEDS_TOKEN_REFRESH]){var e=e.getModuleId(),e=osapi.container.util.buildTokenRequestUrl(f.getUrl(),e),
g=a[e];g.error?gadgets.warn(["Failed to get token for gadget ",e,"."].join("")):gadgets.rpc.call(f.getIframeId(),"update_security_token",null,g[osapi.container.TokenResponse.TOKEN])}}}})};osapi.container.Container.prototype.invalidateAllTokens_=function(){for(var a in this.sites_){var b=this.sites_[a];b instanceof osapi.container.GadgetSite&&(b=b.getActiveSiteHolder(),this.service_.getCachedGadgetMetadata(b.getUrl())[osapi.container.MetadataResponse.NEEDS_TOKEN_REFRESH]=!0)}};
osapi.container.Container.prototype.forceRefreshAllTokens=function(){this.invalidateAllTokens_();this.refreshTokens_()};osapi.container.Container.prototype.applyLifecycleCallbacks_=function(a){var b=Array.prototype.slice.call(arguments,1);for(name in this.gadgetLifecycleCallbacks_){var c=this.gadgetLifecycleCallbacks_[name][a];c&&c.apply(null,b)}};
osapi.container.Container.prototype.newUrlSite=function(a){var b={};b[osapi.container.UrlSite.URL_ELEMENT]=a;a=new osapi.container.UrlSite(this,this.service_,b);return this.sites_[a.getId()]=a};osapi.container.Container.prototype.navigateUrl=function(a,b,c){a.render(b,c);return a};gadgets.config.register("container",null,function(a){if("undefined"===typeof window.__CONTAINER_URI&&"undefined"===typeof window.__API_URI){var b=null;"undefined"!==typeof a.container&&"undefined"!==typeof a.container.jsPath&&(b=a.container.jsPath);window.__CONTAINER_URI=shindig.uri(window.location.href);a=window.__API_URI=null;if(window.__CONTAINER_SCRIPT_ID)a=document.getElementById(window.__CONTAINER_SCRIPT_ID);else for(var c=document.getElementsByTagName("script"),d=0;c&&d<c.length;d++){var e=
c[d].src,f=null!=b&&e&&e.indexOf(b)||-1;if(-1!=f&&/.*container.*[.]js.*[?&]c=1(#|&|$).*/.test(e.substring(f+b.length))){a=c[d];break}}a&&(window.__API_URI=shindig.uri(a.src),window.__API_URI.resolve(window.__CONTAINER_URI));window.__CONTAINER=window.__API_URI?window.__API_URI.getQP("container"):"default"}},!1);osapi.container.Container.addMixin("views",function(b){var f=this;b.rpcRegister("gadgets.views.close",function(a,d){var e=b.getGadgetSiteByIframeId_(a.f),c="undefined"!=typeof d&&null!=d?b.getSiteById(d):e;c&&(c==e||c.ownerId_==a.f)&&f.destroyElement(c)});b.rpcRegister("gadgets.window.getContainerDimensions",function(a){a=document.documentElement;return{width:a?a.clientWidth:-1,height:a?a.clientHeight:-1}});this.destroyElement=function(a){console.log("container needs to define destroyElement function")}});osapi.container.Container.addMixin("views",function(a){this.resultCallbacks_={};this.returnValues_={};var c=this,f={};f[osapi.container.CallbackType.ON_BEFORE_CLOSE]=function(d){var b=d.getId(),e=c.returnValues_[b],a=c.resultCallbacks_[b];"undefined"!==typeof a&&d.ownerId_&&gadgets.rpc.call(d.ownerId_,"gadgets.views.deliverResult",null,a,e);delete c.returnValues_[b];delete c.resultCallbacks_[b]};a.addGadgetLifecycleCallback("open-views",f);a.rpcRegister("gadgets.views.setReturnValue",function(d,b){var e=
a.getGadgetSiteByIframeId_(d.f);e&&(c.returnValues_[e.getId()]=b)})});osapi.container.ee={};osapi.container.ee.RenderParam={GADGET_RENDER_PARAMS:"gadgetRenderParams",GADGET_VIEW_PARAMS:"gadgetViewParams",URL_RENDER_PARAMS:"urlRenderParams",DATA_MODEL:"eeDataModel",EMBEDDED:"embedded"};osapi.container.ee.DataModel={CONTEXT:"context",GADGET:"gadget",URL:"url",PREVIEW_IMAGE:"previewImage",PREFERRED_EXPERIENCE:"preferredExperience"};osapi.container.ee.PreferredExperience={TARGET:"target",DISPLAY:"display",TYPE:"type",VIEW:"view",VIEW_TARGET:"viewTarget"};
osapi.container.ee.Context={ASSOCIATED_CONTEXT:"associatedContext",OPENSOCIAL:"openSocial"};osapi.container.ee.AssociatedContext={ID:"id",TYPE:"type",OBJECT_REFERENCE:"objectReference"};osapi.container.ee.TargetType={GADGET:"gadget",URL:"url"};osapi.container.ee.DisplayType={IMAGE:"image",TEXT:"text"};osapi.container.ee.ContainerConfig={GET_EE_NAVIGATION_TYPE:"GET_EE_NAVIGATION_TYPE"};(function(){osapi.container.Container.addMixin("ee",function(e){function v(b,a,h,f,l,p){var c=h[osapi.container.ee.RenderParam.GADGET_VIEW_PARAMS]||{},q=h[osapi.container.ee.RenderParam.GADGET_RENDER_PARAMS]||{};q[osapi.container.RenderParam.VIEW]=osapi.container.ee.RenderParam.EMBEDDED;var d=a[g.PREFERRED_EXPERIENCE];d&&(d=d[k.TARGET])&&d[k.TYPE]===w.GADGET&&d[k.VIEW]&&(q[osapi.container.RenderParam.VIEW]=d[k.VIEW]);if(l){var d=a[g.CONTEXT],m=!0;d?"object"!=typeof d&&(m=!1):d={};if(m){m={};m[r.ASSOCIATED_CONTEXT]=
{};for(var s in l)l.hasOwnProperty(s)&&(m[s]=l[s]);d[r.OPENSOCIAL]=m;a[g.CONTEXT]=d}}q[osapi.container.ee.RenderParam.DATA_MODEL]=a;var t=e.newGadgetSite(b,p),n=a[g.GADGET];e.preloadGadget(n,function(d){!d[n]||d[n].error?null!=a[g.URL]?u(b,a,h,f):null!=f&&f(t,d[n]||{error:d}):e.navigateGadget(t,n,c,q,function(a){null!=f&&f(t,a)})})}function u(b,a,h,f){h=h[osapi.container.ee.RenderParam.URL_RENDER_PARAMS]||{};b=e.newUrlSite(b);a=e.navigateUrl(b,a[g.URL],h);f&&f(a,null)}var g=osapi.container.ee.DataModel,
k=osapi.container.ee.PreferredExperience,w=osapi.container.ee.TargetType,r=osapi.container.ee.Context,p=osapi.container.ee.ContainerConfig;e.rpcRegister("ee_gadget_rendered",function(b){return(b=b.gs.getActiveSiteHolder().renderParams_.eeDataModel)?b[g.CONTEXT]:null});return{navigate:function(b,a,h,f,l,r){var c=null;if(e.config_&&e.config_[p.GET_EE_NAVIGATION_TYPE]&&"function"===typeof e.config_[p.GET_EE_NAVIGATION_TYPE])c=e.config_[p.GET_EE_NAVIGATION_TYPE].call(e,a);else a:{if(a[g.PREFERRED_EXPERIENCE]&&
(c=a[g.PREFERRED_EXPERIENCE],c[k.TARGET]&&(c=c[k.TARGET])&&c[k.TYPE]))if(c=c[k.TYPE],osapi.container.ee.TargetType.URL===c&&"undefined"!==typeof a.url||osapi.container.ee.TargetType.GADGET===c&&"undefined"!==typeof a.gadget)break a;c=null}null===c&&(a[g.GADGET]?c=osapi.container.ee.TargetType.GADGET:a[g.URL]&&(c=osapi.container.ee.TargetType.URL));c===osapi.container.ee.TargetType.GADGET?v(b,a,h,f,l,r):c===osapi.container.ee.TargetType.URL&&u(b,a,h,f)},close:function(b){b instanceof osapi.container.GadgetSite&&
e.closeGadget(b);b instanceof osapi.container.UrlSite&&b.close()}}})})();gadgets.json.xml=function(){function l(d,c){for(var f=0;f<d.length;f++){var a=d[f];if(a.nodeType==DOM_TEXT_NODE){var b=a.nodeName,e=c[b];c[b]=null!=e?h(e,a.nodeValue):a.nodeValue}else if(0==a.childNodes.length)if(null!=a.attributes&&0!=a.attributes.length)if(b=a,a=c,e=a[b.nodeName],null==e)a[b.nodeName]={},k(b.attributes,a[b.nodeName]);else{var g={};k(b.attributes,g);a[b.nodeName]=h(e,g)}else c[a.nodeName]=null;else 1==a.childNodes.length&&a.firstChild.nodeType==DOM_TEXT_NODE&&(null==a.attributes||
0==a.attributes.length)?(b=a.nodeName,a=a.firstChild,e=c[b],c[b]=null!=e?h(e,a.nodeValue):a.nodeValue):(b=c,e=b[a.nodeName],null==e?(b[a.nodeName]={},null!=a.attributes&&0!=a.attributes.length&&k(a.attributes,b[a.nodeName]),l(a.childNodes,b[a.nodeName])):(g={},null!=a.attributes&&0!=a.attributes.length&&k(a.attributes,g),l(a.childNodes,g),b[a.nodeName]=h(e,g)))}}function h(d,c){return d instanceof Array?(d[d.length]=c,d):[d,c]}function k(d,c){for(var f=null,a=0;a<d.length;a++)f=d[a],c["@"+f.nodeName]=
f.nodeValue}return{convertXmlToJson:function(d){var c={};l(d.childNodes,c);return c}}}();var opensocial=opensocial||{};opensocial.xmlutil=opensocial.xmlutil||{};opensocial.xmlutil.parser_=null;
opensocial.xmlutil.parseXML=function(b){if("undefined"!=typeof DOMParser){opensocial.xmlutil.parser_=opensocial.xmlutil.parser_||new DOMParser;var a=opensocial.xmlutil.parser_.parseFromString(b,"text/xml");if(a.firstChild&&"parsererror"==a.firstChild.tagName)throw Error(a.firstChild.firstChild.nodeValue);return a}if("undefined"!=typeof ActiveXObject){a=new ActiveXObject("MSXML2.DomDocument");a.validateOnParse=!1;a.loadXML(b);if(a.parseError&&a.parseError.errorCode)throw Error(a.parseError.reason);
return a}throw Error("No XML parser found in this browser.");};opensocial.xmlutil.NSMAP={os:"http://opensocial.org/"};opensocial.xmlutil.getRequiredNamespaces=function(b,a){var c=a?opensocial.xmlutil.getNamespaceDeclarations_(a):{},d;for(d in opensocial.xmlutil.NSMAP)opensocial.xmlutil.NSMAP.hasOwnProperty(d)&&(!c.hasOwnProperty(d)&&0<=b.indexOf("\x3c"+d+":")&&0>b.indexOf("xmlns:"+d+":"))&&(c[d]=opensocial.xmlutil.NSMAP[d]);return opensocial.xmlutil.serializeNamespaces_(c)};
opensocial.xmlutil.serializeNamespaces_=function(b){var a=[],c;for(c in b)b.hasOwnProperty(c)&&a.push(" xmlns:",c,'\x3d"',b[c],'"');return a.join("")};opensocial.xmlutil.getNamespaceDeclarations_=function(b){for(var a={},c=0;c<b.attributes.length;c++){var d=b.attributes[c].nodeName;"xmlns:"==d.substring(0,6)&&(a[d.substring(6,d.length)]=b.getAttribute(d))}return a};opensocial.xmlutil.ENTITIES='\x3c!ENTITY nbsp "\x26#160;"\x3e';
opensocial.xmlutil.prepareXML=function(b,a){var c=opensocial.xmlutil.getRequiredNamespaces(b,a);return"\x3c!DOCTYPE root ["+opensocial.xmlutil.ENTITIES+']\x3e\x3croot xml:space\x3d"preserve"'+c+"\x3e"+b+"\x3c/root\x3e"};osapi.container.Container.addMixin("views",function(f){var l=this;f.rpcRegister("gadgets.views.openEmbeddedExperience",function(d,p,c,a){var k=d.callback,m=d.f,b=c.gadget;if("string"==typeof c)if((d=/^<(embed)>/i.exec(c))&&d[1])try{var g=gadgets.json.xml.convertXmlToJson(opensocial.xmlutil.parseXML(c));c=g&&g[d[1]]||c}catch(s){}else try{c=(g=gadgets.json.parse(c))||c}catch(t){}var e=function(h){function d(h){var b={};b[osapi.container.RenderParam.VIEW]=osapi.container.ee.RenderParam.EMBEDDED;b[osapi.container.RenderParam.WIDTH]=
"100%";b[osapi.container.RenderParam.HEIGHT]="100%";var a={};a[osapi.container.RenderParam.WIDTH]="100%";a[osapi.container.RenderParam.HEIGHT]="100%";var e={};e[osapi.container.ee.RenderParam.GADGET_RENDER_PARAMS]=b;e[osapi.container.ee.RenderParam.URL_RENDER_PARAMS]=a;e[osapi.container.ee.RenderParam.GADGET_VIEW_PARAMS]=g;f.ee.navigate(h,c,e,function(b,c){b.ownerId_=m;c&&(l.resultCallbacks_[b.getId()]=p);k&&k([b.getId(),c])},q)}var b="",g={},e;a&&(a.viewTarget&&(b=a.viewTarget),a.viewParams&&(g=
a.viewParams),a.coordinates&&(e=a.coordinates));var n=f.getGadgetSiteByIframeId_(m),r=n.getActiveSiteHolder().getIframeElement(),q=l.getContainerAssociatedContext(c,h);(h=l.createElementForEmbeddedExperience(r,h,b,e,n,d))&&d(h)};b?f.preloadGadget(b,function(a){(!a[b]||a[b].error)&&!c.url?null!=k&&k([null,a[b]||{error:a}]):e(a[b])}):e()});this.createElementForEmbeddedExperience=function(d,f,c,a,k,l){console.log("container needs to define createElementForEmbeddedExperience function")};this.getContainerAssociatedContext=
function(d,f){return null}});osapi.container.Container.addMixin("views",function(e){var k=this;e.rpcRegister("gadgets.views.openGadget",function(d,q,a){var f=d.callback,r=d.f,c="",b=e.getGadgetSiteByIframeId_(d.f);"undefined"!=typeof b&&"undefined"!=typeof b.getActiveSiteHolder()&&(c=b.getActiveSiteHolder().getUrl());var g="",l="",m={},n;a&&(a.view&&(g=a.view),a.viewTarget&&(l=a.viewTarget),a.viewParams&&(m=a.viewParams),a.coordinates&&(n=a.coordinates));var s=e.getGadgetSiteByIframeId_(d.f).getActiveSiteHolder().getIframeElement();
e.preloadGadget(c,function(a){function d(a){var b={},h=e.newGadgetSite(a);h.ownerId_=r;"undefined"!=typeof g&&""!==g&&(b[osapi.container.RenderParam.VIEW]=g);b[osapi.container.RenderParam.WIDTH]="100%";b[osapi.container.RenderParam.HEIGHT]="100%";e.navigateGadget(h,c,m,b,function(a){a&&(k.resultCallbacks_[h.getId()]=q);f&&f([h.getId(),a])})}var p={};if("undefined"!=typeof a&&"undefined"!=typeof a[c]){if(a[c].error){gadgets.error("Failed to preload gadget : "+c);null!=f&&f([null,a[c]]);return}p=a[c]}(a=
k.createElementForGadget(p,s,g,l,n,b,d))&&d(a)})});this.createElementForGadget=function(d,e,a,f,k,c,b){console.log("container needs to define createElementForGadget function")}});osapi.container.Container.addMixin("views",function(b){var k=this;b.rpcRegister("gadgets.views.openUrl",function(d,f,a,g){function e(c){c=b.newUrlSite(c);var a={};a[osapi.container.RenderParam.WIDTH]="100%";a[osapi.container.RenderParam.HEIGHT]="100%";b.navigateUrl(c,f,a);c.ownerId_=d.f;d.callback([c.getId()])}var h=b.getGadgetSiteByIframeId_(d.f),l=h.getActiveSiteHolder().getIframeElement();(a=k.createElementForUrl(l,a,g,h,e))&&e(a)});this.createElementForUrl=function(b,f,a,g,e){console.log("container needs to define createElementForUrl function")}});com=(window||this).com||{};com.ibm=com.ibm||{};com.ibm.cre=com.ibm.cre||{};cre$=com.ibm.cre;cre$.iwidget=cre$.iwidget||{};cre$.services=cre$.services||{};cre$.util=cre$.util||{};"undefined"==typeof __trace&&(__trace={enter:function(){},msg:function(){},evalFunction:function(){return"function() { }"},evalResult:function(){},exit:function(){},assertFunction:function(){return"function() { }"},debug:function(){}});
"undefined"==typeof __logging&&(__logging={logLevel:{TRACE:500,INFO:800,WARNING:900,SEVERE:1E3},log:function(){}});if(!window.console){var c=window.console={};c.assert=c.debug=c.error=c.info=c.log=c.trace=c.warn=function(){}}console.debug||(console.debug=console.error);(function(){var a=cre$.util,b=window.dojo,p=Object.prototype.toString;"undefined"===typeof a._scopeMap&&(a._scopeMap=b?b._scopeMap:{});a.global=b?b.global:this;var d="$Rev: 22487 $".match(/\d+/);a.version=b?b.version:{major:1,minor:5,patch:0,flag:"",revision:d?+d[0]:NaN,toString:function(){}};var h,l,k={},e;for(e in{toString:1}){h=[];break}h=b?b._extraNames:h||"hasOwnProperty valueOf isPrototypeOf propertyIsEnumerable toLocaleString toString constructor".split(" ");a._extraNames=h;l=h.length;a._mixin=
b?b._mixin:function(a,b){var c,f,g;for(c in b)if(f=b[c],!(c in a)||a[c]!==f&&(!(c in k)||k[c]!==f))a[c]=f;if(l&&b)for(g=0;g<l;++g)if(c=h[g],f=b[c],!(c in a)||a[c]!==f&&(!(c in k)||k[c]!==f))a[c]=f;return a};a.evalFn=function(a,b){var c;!b&&window.execScript?(a&&window.execScript(a,"JavaScript"),c=""):c=window.eval.call(window,a);return c};a.mixin=b?b.mixin:function(b,d){b||(b={});for(var c=1,f=arguments.length;c<f;c++)a._mixin(b,arguments[c]);return b};a._getProp=b?b._getProp:function(b,d,c){c=c||
a.global;for(var f=0,g;c&&(g=b[f]);f++)0===f&&a._scopeMap[g]&&(g=a._scopeMap[g]),c=g in c?c[g]:d?c[g]={}:void 0;return c};a.setObject=b?b.setObject:function(b,d,c){var f=b.split(".");b=f.pop();return(c=a._getProp(f,!0,c))&&b?c[b]=d:void 0};a.getObject=b?b.getObject:function(b,d,c){return a._getProp(b.split("."),d,c)};a.exists=b?b.exists:function(b,d){return!!a.getObject(b,!1,d)};if(b)a.isBrowser=b.isBrowser,a._name=b._name,a.isOpera=b.isOpera,a.isAIR=b.isAIR,a.isKhtml=b.isKhtml,a.isWebKit=b.isWebKit,
a.isChrome=b.isChrome,a.isMac=b.isMac,a.isSafari=b.isSafari,a.isMozilla=a.isMoz=b.isMozilla,a.isFF=b.isFF,a.isIE=b.isIE;else if("undefined"!==typeof window){a.isBrowser=!0;a._name="browser";e=navigator;d=e.userAgent;e=e.appVersion;var m=parseFloat(e);0<=d.indexOf("Opera")&&(a.isOpera=m);0<=d.indexOf("AdobeAIR")&&(a.isAIR=1);a.isKhtml=0<=e.indexOf("Konqueror")?m:0;a.isWebKit=parseFloat(d.split("WebKit/")[1])||void 0;a.isChrome=parseFloat(d.split("Chrome/")[1])||void 0;a.isMac=0<=e.indexOf("Macintosh");
var n=Math.max(e.indexOf("WebKit"),e.indexOf("Safari"),0);if(n&&!a.isChrome&&(a.isSafari=parseFloat(e.split("Version/")[1]),!a.isSafari||419.3>=parseFloat(e.substr(n+7))))a.isSafari=2;0<=d.indexOf("Gecko")&&(!a.isKhtml&&!a.isWebKit)&&(a.isMozilla=a.isMoz=m);a.isMoz&&(a.isFF=parseFloat(d.split("Firefox/")[1]||d.split("Minefield/")[1])||void 0);if(document.all&&!a.isOpera&&(a.isIE=parseFloat(e.split("MSIE ")[1])||void 0,(d=document.documentMode)&&5!=d&&Math.floor(a.isIE)!=d))a.isIE=d}a.isObject=b?b.isObject:
function(b){return void 0!==b&&(null===b||"object"===typeof b||a.isArray(b)||a.isFunction(b))};a.isFunction=b?b.isFunction:function(a){return"[object Function]"===p.call(a)};a.isArray=b?b.isArray:function(a){return a&&(a instanceof Array||"array"===typeof a)};a.isString=b?b.isString:function(a){return"string"==typeof a||a instanceof String};a.objectToQuery=b?b.objectToQuery:function(b){var d=encodeURIComponent,c=[],f={},g;for(g in b)if(Object.prototype.hasOwnProperty.call(b,g)){var e=b[g];if(e!=f[g]){var h=
d(g)+"\x3d";if(a.isArray(e))for(var k=0;k<e.length;k++)c.push(h+d(e[k]));else c.push(h+d(e))}}return c.join("\x26")}})();(function(){var c=cre$.util,d=window.dojo,k={};c.isArrayLike=d?d.isArrayLike:function(a){return a&&void 0!==a&&!c.isString(a)&&!c.isFunction(a)&&!(a.tagName&&"form"===a.tagName.toLowerCase())&&(c.isArray(a)||isFinite(a.length))};var h=function(a,b,e){return(e||[]).concat(Array.prototype.slice.call(a,b||0))},l=function(a,b,e){e=e||[];for(b=b||0;b<a.length;b++)e.push(a[b]);return e};c._toArray=d?d._toArray:c.isIE?function(a){return(a.item?l:h).apply(this,arguments)}:h;c.filter=d?d.filter:function(a,
b,e){var f=0,c=a&&a.length||0,d=[],g;c&&"string"==typeof a&&(a=a.split(""));"string"==typeof b&&(b=k[b]||buildFn(b));if(e)for(;f<c;++f)g=a[f],b.call(e,g,f,a)&&d.push(g);else for(;f<c;++f)g=a[f],b(g,f,a)&&d.push(g);return d}})();(function(){var a=com.ibm=com.ibm||{},a=a.mm=a.mm||{},a=a.iwidget=a.iwidget||{},a=a.Constants=a.Constants||{};cre$.util.mixin(a,{WIDGETEVENT_PREFIX:"widgetevents.",WILDCARD_PREFIX:"*.",mode:{VIEW:"view",EDIT:"edit",PERSONALIZE:"personalize",CONFIG:"config",HELP:"help"},mode_view:"view",mode_edit:"edit",mode_help:"help",event:{TITLE:"title",DESCRIPTION:"description"},ATTRIBUTES:"attributes",IDESCRIPTOR:"idescriptor",USERPROFILE:"userprofile",windowstate:{NORMAL:"normal",MINIMIZE:"minimize",MAXIMIZE:"maximize"},
status:{SUCCESS:200,TIMEOUT:408,NOTFOUND:404,INTERROR:500,OTHER:303},changeType:{CHANGEDVALUE:"changedValue",NEWITEM:"newItem",REMOVEDITEM:"removedItem"},iDescriptorItems:{title:"title",name:"name",description:"description",defaultHeight:"defaultHeight",defaultWidth:"defaultWidth",displayLocale:"displayLocale",mode:"mode",author:"author",email:"email",website:"website",version:"version",icon:"icon",windowState:"windowState",messageLocale:"messageLocale",availableMessageLocales:"availableMessageLocales",
thumbnail:"thumbnail"},IW_PREFIX:"iw-",IW_DEFINITION_TYPE:"iwidget",OSGADGET_DEFINITION_TYPE:"os-gadget",CSSCLASS_INSTANCE:{iwWidget:"iWidget",iwOSGadget:"OSGadget",iwSandbox:"Sandbox",iwDefinition:"Definition",iwEventDescription:"EventDescription",iwPayloadType:"PayloadType",iwHandled:"Handled",iwPublished:"Published",iwDescription:"Description",iwTitle:"Title",iwEvent:"Event",iwDescRef:"DescRef",iwGlobalid:"Globalid",iwHandler:"Handler",iwNewWire:"NewWire",iwRemoveWire:"RemoveWire",iwReadOnly:"ReadOnly",
iwItemSet:"ItemSet",iwItem:"Item",iwValue:"Value",iwContent:"Content",iwReceivedEvent:"ReceivedEvent",iwSourceEvent:"SourceEvent",iwTargetEvent:"TargetEvent",iwMappedName:"MappedName",iwStandalone:"Standalone"},CSSCLASS_PREFIXED_INSTANCE:{},CSSCLASS_PERSONALIZED:"mm-Personalized",RESOURCE:{src:"src",id:"id",globalid:"globalid",mimeType:"mimeType",callback:"callback",version:"version",blockInit:"blockInit",skipLoad:"skipLoad"},EVENTS:{onLoad:"onLoad",onUnLoad:"onUnload",onModeChanged:"onModeChanged",
onItemSetChanged:"onItemSetChanged",unloadWidget:"/enabler/unloadWidget",unSubscribeWire:"/enabler/unSubscribeWire",modeChanged:"modeChanged",onSizeChanged:"onSizeChanged",onNavStateChanged:"onNavStateChanged",onAttributeSaved:"com.ibm.mashups.iwidget.onAttributeSaved",onWindowStateChanged:"onWindowStateChanged",onIncompleteEventDescription:"onIncompleteEventDescription"},eventservice:{type:{MAIN:"MAIN",IFRAME:"IFRAME"}}});for(var b in a.CSSCLASS_INSTANCE)Object.prototype.hasOwnProperty.call(a.CSSCLASS_INSTANCE,
b)&&(a.CSSCLASS_PREFIXED_INSTANCE[b]=a.IW_PREFIX+a.CSSCLASS_INSTANCE[b])})();iwConstants=com.ibm.mm.iwidget.Constants;(function(){var c=cre$.util,a=window.dojo;c.isAlien=a?a.isAlien:function(b){return b&&!c.isFunction(b)&&/\{\s*\[native code\]\s*\}/.test(String(b))};c.delegate=c._delegate=a?a.delegate:function(){function b(){}return function(d,a){b.prototype=d;var e=new b;b.prototype=null;a&&c._mixin(e,a);return e}}();c._hitchArgs=a?a._hitchArgs:function(b,d){var a=c._toArray(arguments,2),e=c.isString(d);return function(){var g=c._toArray(arguments),f=e?(b||c.global)[d]:d;return f&&f.apply(b||this,a.concat(g))}};
c.hitch=a?a.hitch:function(b,a){if(2<arguments.length)return c._hitchArgs.apply(c,arguments);a||(a=b,b=null);if(c.isString(a)){b=b||c.global;if(!b[a])throw['cu.hitch: scope["',a,'"] is null (scope\x3d"',b,'")'].join("");return function(){return b[a].apply(b,arguments||[])}}return!b?a:function(){return a.apply(b,arguments||[])}};c.partial=a?a.partial:function(a){return c.hitch.apply(c,[null].concat(c._toArray(arguments)))}})();(function(){var e=cre$.util,d=window.dojo;e.forEach=d?d.forEach:function(a,b,c){if(a&&a.length){b=["string"==typeof a?a.split(""):a,c||e.global,"string"==typeof b?new Function("item","index","array",b):b];a=b[0];c=0;for(var d=a.length;c<d;++c)b[2].call(b[1],a[c],c,a)}}})();(function(){var b=cre$.util;b.forIn=function(a,e,c){if(a&&"object"==typeof a){c=c||null;var b,d;for(d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b=a[d],cre$.util.hitch(c,e)(b,d,a))}};b.each=function(a,b,c){a&&(a instanceof Array||"number"===typeof a.length?cre$.util.forEach(a,b,c):cre$.util.forIn(a,b,c))}})();cre$.endpoint=cre$.endpoint||{};
(function(){function f(a){a=decodeURIComponent(a);(a=d[a])&&("/"!==a.charAt(0)&&"http"!==a.substr(0,4))&&(a="/"+a);return a}var e=cre$.endpoint,g=Object.prototype.hasOwnProperty,d={};e.registerEndpoints=function(a){for(var b=a.length;b--;)d[a[b].name]=a[b].url};e.removeEndpoint=function(a){g.call(d,a)&&delete d[a]};e.resolveEndpoint=function(a){if(!a)return null;if(a=a.toString()){var b=a.indexOf("endpoint://",0);if(0===b){var c,b=a.indexOf("/",11);if(0<b){if(c=a.substring(11,b),a=a.substring(b+1),
c=f(c))return a="/"===c.charAt(c.length-1)?c+a:c+"/"+a}else return c=a.substring(11),a=f(c)}else if(0<b&&(c=a.substring(0,b),a=a.substring(b),a=e.resolveEndpoint(a)))return"/"===a.charAt(0)?c+a.substring(1):c+a}return null}})();cre$.constants=cre$.constants||{};cre$.constants.componentType={IWIDGET:iwConstants.CSSCLASS_INSTANCE.iwWidget,GADGET:"gadget"};cre$.constants.renderType={INLINE:"inline",SANDBOX:"sandbox",IFRAME:"iframe",DEFAULT:"default",FRAGMENT:"fragment"};
cre$.constants.event={TITLE:iwConstants.event.TITLE,DESCRIPTION:iwConstants.event.DESCRIPTION,topic:{WIDGET_LOADED:"widgetLoaded_",WIDGET_MODECHANGED:"widgetModeChanged",STUB_SYNC:"_stub_sync_",BROADCAST_SHAREABLEITEMSET_CHANGE:"broadcast_shareableitemset_change",BROADCAST_WIRES_CHANGE:"broadcast_wires_change",STUB_SYNC_WIRES:"_stub_sync_wires_",REQUEST_WIRES:"request_wires_",REQUEST_PAGEDATA:"request_pagedata_",SYNC:"sync_",PAGE_DATA_:"page_data_"},payload:{METHODNAME:"methodname",PARAMS:"params"}};
cre$.constants.request={URL:"url",HEADERS:"headers",CONTENT_TYPE:"contentType",PARAM_DATA:"paramData",RESPONSE_TYPE:"responseType",method:{GET:"GET",PUT:"PUT",POST:"POST",DELETE:"DELETE"},header:{CONTENT_TYPE:"Content-Type"},HEADER_CRE_PERSISTENCE_URL:"X-CRE-persistenceurl",CONTAINER:"container",HEADER_SHINDIG_ST:"X-Shindig-ST",contentType:{JSON:"application/json",X_WWW_FORM_URLENCODED:"application/x-www-form-urlencoded"},SYNC:"sync"};
cre$.constants.response={protocol:{HTTP:"http",HTTPS:"https"},type:{XML:"xml",JSON:"json",JSON_COMMENT_OPTIONAL:"json-comment-optional",JSON_COMMENT_FILTERED:"json-comment-filtered",JAVASCRIPT:"javascript"}};
cre$.constants.resource={resourceType:{JAVASCRIPT:"javascript",CSS:"css",IMAGE:"image",UNKNOW:"\x3cunknown\x3e",SRC:iwConstants.RESOURCE.src,ID:iwConstants.RESOURCE.id,GLOBALID:iwConstants.RESOURCE.globalid,MIMETYPE:iwConstants.RESOURCE.mimeType,CALLBACK:iwConstants.RESOURCE.callback,VERSION:iwConstants.RESOURCE.version,BLOCKINIT:iwConstants.RESOURCE.blockInit,SKIPLOAD:iwConstants.RESOURCE.skipLoad},mimeType:{JAVASCRIPT:"text/javascript",CSS:"text/css",IMAGE:"image/"}};
cre$.constants.featureName={IRUNTIME:"cre.iruntime",WIRE:"cre.wire",OSGADGET:"cre.osgadget",ITEMSET:"cre.iwidget.itemset",EVENT:"cre.iwidget.event"};cre$.constants.keys={SHIFT:1,ALT:2,CTRL:4,META:8,CAPSLOCK:16};cre$.constants.windowstate={NORMAL:iwConstants.windowstate.NORMAL,MINIMIZE:iwConstants.windowstate.MINIMIZE,MAXIMIZE:iwConstants.windowstate.MAXIMIZE};
cre$.constants.status={SUCCESS:iwConstants.status.SUCCESS,TIMEOUT:iwConstants.status.TIMEOUT,NOTFOUND:iwConstants.status.NOTFOUND,INTERROR:iwConstants.status.INTERROR,OTHER:iwConstants.status.OTHER};cre$.constants.changeType={CHANGED_VALUE:iwConstants.changeType.CHANGEDVALUE,NEW_ITEM:iwConstants.changeType.NEWITEM,UPDATED_VALUE:"updatedValue",REMOVED_ITEM:iwConstants.changeType.REMOVEDITEM,DELETE_TOKEN:"DELETE_TOKEN",ON_STATESET_CHANGED:"onStateSetChanged"};
cre$.constants.predefinedEvents={onLoad:iwConstants.EVENTS.onLoad,onUnLoad:iwConstants.EVENTS.onUnLoad,onModeChanged:iwConstants.EVENTS.onModeChanged,onWindowStateChanged:iwConstants.EVENTS.onWindowStateChanged,onSizeChanged:iwConstants.EVENTS.onSizeChanged,onNavStateChanged:iwConstants.EVENTS.onNavStateChanged,onItemSetChanged:iwConstants.EVENTS.onItemSetChanged,onRefreshNeeded:"onRefreshNeeded",onNewWire:"onNewWire",onRemoveWire:"onRemoveWire",onIncompleteEventDescription:iwConstants.EVENTS.onIncompleteEventDescription};
cre$.constants.state={ERROR:1,INITIAL:2,PRELOADED:3,LOADED:4};cre$.constants.others={DEFAULT:"default",IW_IWIDGET:"iw-iWidget",IW_DEFINITION:"iw-Definition",GADGET_SITE:"gadget-site-",TRUE:"true",FALSE:"false"};cre$.constants.endpoints={PROXY:"endpoint://creproxyurl",PERSISTENCE:"endpoint://persistence",CRE_SERVER:"endpoint://creserverurl",DATA_FETCH:"endpoint://dataFetch"};
cre$.constants.iDescriptorItems={TITLE:iwConstants.iDescriptorItems.title,NAME:iwConstants.iDescriptorItems.name,DESCRIPTION:iwConstants.iDescriptorItems.description,DEFAULTWIDTH:iwConstants.iDescriptorItems.defaultWidth,DEFAULTHEIGHT:iwConstants.iDescriptorItems.defaultHeight,DISPLAYLOCALE:iwConstants.iDescriptorItems.displayLocale,MODE:iwConstants.iDescriptorItems.mode,AUTHOR:iwConstants.iDescriptorItems.author,EMAIL:iwConstants.iDescriptorItems.email,WEBSITE:iwConstants.iDescriptorItems.website,
VERSION:iwConstants.iDescriptorItems.version,ICON:iwConstants.iDescriptorItems.icon,WINDOWSTATE:iwConstants.iDescriptorItems.windowState,MESSAGELOCALE:iwConstants.iDescriptorItems.messageLocale,AVAILABLEMESSAGELOCALES:iwConstants.iDescriptorItems.availableMessageLocales,THUMBNAIL:iwConstants.iDescriptorItems.thumbnail};
cre$.constants.osgadgetItems={TITLE:iwConstants.iDescriptorItems.title,NAME:iwConstants.iDescriptorItems.name,TOPIC:"topic",SUBSCRIBE:"subscribe",PUBLISH:"publish",ABOUTURL:"aboutUrl",DESCRIPTION:"description",TYPE:"type"};cre$.constants.persistence={PERSISTENCE_URL:"endpoint://persistence"};cre$.promise=cre$.promise||{};
(function(){var f=cre$,g=cre$.util,l=g.isFunction,m=g.mixin,k=g.each,p=g.partial,q=g.hitch;cre$.promise={};var e=cre$.promise,r=0;f.promise=f.promise||{};e.Promise=function(b){this._cbs=[];this._stat=-1;this._id=b;this._counter=r++;if(!b){var a=arguments.callee;this.id=(a=a?a.caller:null)?a.name&&0<a.name.length?a.name:a.toString():""}};m(f.promise,{isPromise:function(b){return b&&l(b.then)},resolved:function(b){var a=new e.Promise("resolved("+b+")["+this._counter+"]");a.resolve(b);return a},rejected:function(b){var a=
new e.Promise("rejected("+b+")["+this._counter+"]");a.reject(b);return a},join:function(b){var a=new e.Promise("join["+this._counter+"]"),c=Array(b.length),d=0,h=!1,n=function(){if(++d>=c.length)a[h?"reject":"resolve"](c)};0<b.length?k(b,function(a,b){a.then(function(a){c[b]=a;n()},function(a){h=!0;c[b]=a;n()})}):a.resolve([]);return a}});m(e,{when:function(b){return cre$.promise.isPromise(b)?b:cre$.promise.resolved(b)},whenAll:function(b){var a=[];k(arguments,function(b){a.push(e.when(b))});return f.promise.join(a)}});
e.Promise.prototype={_fin:function(b,a){if(-1!==this._stat)throw Error(cre$.LocaleHelper.getLocalizedMessages().ERR_PROMISE_ALREADY_RESOLVED);this._v=b;this._stat=a;this._cbk();return this},_cbk:function(){var b=this._stat,a=this._cbs,c=this._v,d;if(0===b&&f.promise.isPromise(c))for(;0<a.length;)c.then.apply(c,a.shift());for(;0<a.length;)if(d=a.shift()[b])try{d(c)}catch(h){d=__logging.isLogTrace,__logging.isLogTrace=!0,__logging.log("cre$.promise.Promise","_cbk",h),__logging.isLogTrace=d}},_delegate:function(b){var a=
new e.Promise("_delegate["+this._counter+"]");this.then(p(b,a),q(a,"reject"));return a},resolve:function(b){var a=arguments.callee;calledBy=(a=a?a.caller:null)?a.name&&0<a.name.length?a.name:a.toString():"";return this._fin(b,0)},reject:function(b){var a=arguments.callee;calledBy=(a=a?a.caller:null)?a.name&&0<a.name.length?a.name:a.toString():"";return this._fin(b,1)},progress:function(b){k(this._cbs,function(a){if(a[2])a[2](b)});return this},then:function(b,a,c){var d=new e.Promise("then["+this._counter+
"]");this._cbs.push([function(a){try{if(b){var c=b(a);void 0!==c&&(a=c)}d.resolve(a)}catch(e){throw d.reject(e),e;}},function(b){var c=b;try{a&&(c=a(b),void 0===c&&(c=b)),d.reject(c)}catch(e){throw d.reject(e),e;}},c]);-1!==this._stat&&this._cbk();return d},call:function(b,a){return this._delegate(function(c,d){d&&l(d[b])?c.resolve(d[b].apply(d,a)):c.reject(Error(b+" "+cre$.LocaleHelper.getLocalizedMessages().ERR_NOT_A_FUNC+" "+d))})},get:function(b){return this._delegate(function(a,c){c?a.resolve(c[b]):
a.reject(Error(cre$.LocaleHelper.getLocalizedMessages().ERR_IS_NULL_UNDEFINED)+" "+c)})}}})();"undefined"===typeof cre$.config&&(cre$.config={},function(){var b=window.location.protocol,c=b.indexOf(":"),a=cre$.config;a.HOST=window.location.host;a.CONTEXT_ROOT="/cre";a.SCHEME=-1!==c?b.substring(0,c):b;a.APP_VERSION=null;a.PROCESSWIDGETS_URL="/common/processWidgets?format\x3djson";a.SANDBOXWIDGETS_URL="/common/sandboxedWidget";a.REFRESHTOKEN_URL="/common/tokenRefresh";a.MAX_TOKEN_TTL=72E3;a.USERPROFILE_URL="/userprofile";a.SERVERLOG_URL="/common/log";a.SERVERLOG_DELIVER_THRESHOLD=50;a.PERSISTENCE_USE_PATH_PARMS=
!1;a.COMBINE_RESOURCES=!0;a.BROADCASTALLEVENTS=!0;a.SUPPORTED_LOCALES="ar ca cs da de el en es fi fr hu it iw ja kk ko nl no pl pt pt-br ru sl sv th tr zh-cn zh-tw".split(" ");a.isDebug=!1;a.traceConfig=[];a.loadScriptsDefaultRefresh=-1;a.getCREServerUrl=function(b){var d,c=0;b=b?b:"";d=(c=cre$.endpoint.resolveEndpoint(cre$.constants.endpoints.CRE_SERVER))?c:a.SERVER_URL?a.SERVER_URL:a.PORT?a.SCHEME+"://"+a.HOST+":"+a.PORT+a.CONTEXT_ROOT:a.SCHEME+"://"+a.HOST+a.CONTEXT_ROOT;c=d.length;"/"===d.charAt(c-
1)&&(d=d.substring(0,c-1));0<b.length&&("/"!==b.charAt(0)&&(b="/"+b),d+=b);return d};a.CONTAINER=gadgets.config.get("cre.config").container?gadgets.config.get("cre.config").container:"default";a.ServiceManagerCallbacks=[];a.buildLabel="CRE_BUILD_LABEL_REPLACEMENT";a.timestamp=(new Date).valueOf();a.userid=null;a.sandbox="allow-scripts allow-same-origin allow-forms"}(),gadgets.config.register("cre.config",null,function(b){if(b=gadgets.config.get("cre.config")){var c=b.container;c&&(cre$.config.CONTAINER=
c);b=b.sandbox;null!==b&&(void 0!==b&&"string"===typeof b)&&(cre$.config.sandbox=b)}},null));cre$.xhr=cre$.xhr||{};
(function(){var d=cre$.xhr,h=cre$.constants,g=h.request,k=h.response;d.parseToJson=function(b){return/^[\],:{}\s]*$/.test(b.replace(/\\['"\\\/b-ux]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))?eval("("+b+")"):!1};d.registerEventHandler=function(b,a,d){void 0!==b.addEventListener?b.addEventListener(a,d,!1):b.attachEvent&&b.attachEvent("on"+a,d)};d.makeXhr=function(){var b;if("undefined"!==typeof XMLHttpRequest||window.XMLHttpRequest)return new window.XMLHttpRequest;
if("undefined"!==typeof ActiveXObject)return(b=new ActiveXObject("Msxml2.XMLHTTP"))||(b=new ActiveXObject("Microsoft.XMLHTTP")),b;throw"no xhr available";};d.xhr=function(b,a){if(!a||!a.url)return null;var f=new cre$.promise.Promise("xhr: "+a.url),c=d.makeXhr(),e=b||g.method.GET,m=a.sync||!1,n=a.responseType||null,h=function(a){if(4===a.readyState)if(200<=a.status&&300>a.status||304==a.status)if(clearTimeout(p),n===k.type.XML&&a.responseXML)f.resolve({data:a.responseXML,xhr:a});else if(n===(k.type.JSON_COMMENT_FILTERED||
k.type.JSON_COMMENT_OPTIONAL)&&a.responseText&&/^[^{\[]*\/\*/.test(a.responseText)){var b=a.responseText,c=b.indexOf("/*"),e=b.lastIndexOf("*/");if(-1==c||-1==e)throw Error("JSON was not comment filtered");f.resolve({data:d.parseToJson(b.substring(c+2,e)),xhr:a})}else n===(k.type.JSON||k.type.JSON_COMMENT_OPTIONAL)?f.resolve({data:d.parseToJson(a.responseText),xhr:a}):f.resolve({data:a.responseText,xhr:a});else f.reject({data:a.status,xhr:a})};"object"===typeof c.onprogress&&m?c.onload=c.onerror=
c.onabort=function(){h(c)}:c.onreadystatechange=function(){4===c.readyState&&h(c)};a.user&&a.password?c.open(e,a.url,!m,a.user,a.password):c.open(e,a.url,!m);if(a.headers)for(var l in a.headers)"content-type"===l.toLowerCase()&&!a.contentType?a.contentType=a.headers[l]:a.headers[l]&&c.setRequestHeader(l,a.headers[l]);e="";a.paramData&&(e+=a.paramData);a.form&&(""!=e&&(e+="\x26"),e+=a.form+"\x3d"+escape(document.getElementById(a.form).value));a.paramData||a.form?(c.setRequestHeader(g.header.CONTENT_TYPE,
a.contentType||g.contentType.X_WWW_FORM_URLENCODED),c.send(e)):c.send(null);var p;a.timeout&&(0!==a.timeout&&0<a.timeout)&&(p=setTimeout(function(){c.abort()},a.timeout));d.registerEventHandler(window,"unload",function(){f&&delete f.xhr;c&&(delete c.onreadystatechange,delete c.responseXML,delete c.responseText,c=null)});f.xhr=c;return f};d.xhrGet=function(b){return d.xhr(g.method.GET,b)};d.xhrPut=function(b){return d.xhr(g.method.PUT,b)};d.xhrPost=function(b){return d.xhr(g.method.POST,b)};d.xhrDelete=
function(b){return d.xhr(g.method.DELETE,b)};cre$.config.ServiceManagerCallbacks.push(function(b){b.setService(cre$.services.XHR,cre$.xhr)})})();(function(){var f=cre$.util,g=window.dojo,h={};f.extend=g?g.extend:function(a,e){for(var c=1,d=arguments.length;c<d;c++)f._mixin(a.prototype,arguments[c]);return a};f.clone=g?g.clone:function(a){if(!a||"object"!=typeof a||f.isFunction(a))return a;if(a.nodeType&&"cloneNode"in a)return a.cloneNode(!0);if(a instanceof Date)return new Date(a.getTime());var e,c,d,b;if(f.isArray(a)){e=[];c=0;for(d=a.length;c<d;++c)c in a&&e.push(f.clone(a[c]))}else e=a.constructor?new a.constructor:{};for(b in a)if(d=a[b],
!(b in e)||e[b]!==d&&(!(b in h)||h[b]!==d))e[b]=f.clone(d);if(0<f._extraNames.length)for(c=0;c<f._extraNames.length;++c)if(b=f._extraNames[c],d=a[b],!(b in e)||e[b]!==d&&(!(b in h)||h[b]!==d))e[b]=d;return e}})();cre$.constants.ResourceManager=cre$.constants.ResourceManager||{};cre$.constants.ResourceManager.state={ERROR:-1,INIT:1,DOWNLOADED:2,LOADED:3};cre$.ResourceManager=cre$.ResourceManager||{};
(function(){function v(b,f,d,a,g,c){if(!b||!f)throw Error("resourcePromise "+cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_PARAM);c=c?c:{};var e=new cre$.promise.Promise("resourcePromise");g=g||n.constants.resourceType.JAVASCRIPT;var k=u[g];switch(g){case n.constants.resourceType.JAVASCRIPT:case n.constants.resourceType.CSS:g="";k&&(g=k.join("::"));req={url:f,sync:a};req[cre$.constants.request.HEADERS]=cre$.internalutil.getCREContainerToken()?{"X-Shindig-ST":cre$.internalutil.getCREContainerToken().token}:{};
""!==g&&(req[cre$.constants.request.HEADERS]["Client-Loaded-Resources"]=g);a=req[cre$.constants.request.HEADERS]["Client-Loaded-Features"]=n.getLoadedFeatures().join("::");var h=shindig.sha1();h.update(g+a);req.url+=-1==f.indexOf("?")?"?_h\x3d":"\x26_h\x3d";req.url+=h.digestString();e=cre$.xhr.xhrGet(req).then(function(a){var e=cre$.util.clone(a.xhr.responseText),d=cre$.util.clone(a.xhr.status);delete a.xhr;return cre$.util.mixin(c,{url:f,globalid:b,data:e,status:d})},function(a){var e=cre$.util.clone(a.xhr.responseText),
d=cre$.util.clone(a.xhr.status);delete a.xhr;return cre$.util.mixin(c,{url:f,globalid:b,data:e,status:d})});if(d&&d.length&&0<d.length){g=d.length;h=k.join();for(a=0;a<g;a++){var l=d[a];0>h.indexOf(l)&&k.push(l)}}break;case n.constants.resourceType.IMAGE:d=!1;k&&0<k.join().indexOf(f)&&(d=!0);d?e.resolve({url:f,globalid:b}):(d=new Image,d.src=f,a&&console.warn(cre$.LocaleHelper.getLocalizedMessages().ERR_CANT_LOAD_IMAGE_SYNC),d.onload=function(){e.resolve({url:f,globalid:b});k.push(f)},d.onerror=function(){e.resolve({url:f,
globalid:b})});break;default:throw Error("[resourcePromise]"+cre$.LocaleHelper.getLocalizedMessages().ERR_CANT_SUPPORT_TYPE+" "+g);}return e}function A(b,f){for(var d=/url\s*\(\s*('[^\s'"]+'|"[^\s'"]+"|[^\s'"]+)\s*\)/gi,a,g="",c=f.lastIndexOf("?"),e=-1===c?f:f.substring(0,c),e=e.substring(0,e.lastIndexOf("/")+1),k=f.substring(0,f.indexOf("/",f.indexOf("://")+3)),c=0;null!==(a=d.exec(b));){g+=b.substring(c,a.index);c=a[1];if("'"===c.charAt(0)||'"'===c.charAt(0))c=c.substring(1,c.length-1);/^http[s]?:\/\/.+/.test(c)||
(c="/"===c.charAt(0)?k+c:e+c);g=g+'url("'+c+'")';c=a.index+a[0].length}c<b.length&&(g+=b.substring(c,b.length));return g}function x(b,f,d){var a="";if(-1===f.indexOf("/gadgets/js/")){var g=cre$.internalutil.parseToJson(d);if(g)for(var c in g[0])Object.prototype.hasOwnProperty.call(g[0],c)&&(d=g[0][c],-1===d.indexOf("ERROR|@|")?a+=d+"\n":b.error={message:"Error fetching '"+f+"'"});else a=d}else a=d;""===a&&(f="Error fetching "+f+".",b.error={message:f},__logging.log("cre$.ResourceManager","_filterRes",
f));return a}function B(b,f){var d={};if(!b[0]||!b[0].resourceUris)return[];for(var a="",g=[],c=[],e=0,k=b.length;e<k;e++)a+=b[e].resourceUris.join("|")+"|";g=a.substring(0,a.lastIndexOf("|")).split("|");e=0;for(k=b.length;e<k;e++){if((globalid=b[e].globalid?b[e].globalid:b[e].uri)&&f[e])for(var a=f[e][globalid],h=b[e].type===n.constants.resourceType.JAVASCRIPT?eval(a):[a],l=0,q=g.length;l<q;l++){var p=g[l],a=h&&h[e]?h[e][p]:null;"undefined"!==typeof a&&(null!==a&&"ERROR|@|"===a.replace(/(^\s*)(\s*$)/g,
""))&&(a={url:p,type:m[globalid].resource.type},b[e].error&&(a.error=b[e].error),c.push(a),d[p]=p)}if(0===c.length&&b[e].error&&m[globalid].state===r.state.LOADED)if(h=b[e].error.message.split("|"),l=h.length,1!==l)for(;l--;)h[l]&&(""!==h[l].trim()&&!(h[l]in d))&&(a={url:h[l],type:m[globalid].resource.type},b[e].error&&(a.error=b[e].error),c.push(a));else{h=eval(b[e].data);l=b[e].resourceUris;q=h.length;for(p=l.length;q--;)for(;p--;)"ERROR|@|"===h[q][l[p]]&&(a={url:l[p],type:m[globalid].resource.type},
b[e].error&&(a.error=b[e].error),c.push(a))}}return c}function w(b,f){for(var d=[],a=0,g=b.length;a<g;a++){var c=b[a],e=c.url,k=c.globalid,h=m[k],l=h.resource;if(h.state===r.state.DOWNLOADED){var q="";if(l.type!==n.constants.resourceType.IMAGE){var q=c.data,p={};p[k]=q;d[a]=p}if(l.type===n.constants.resourceType.JAVASCRIPT)if(l.isDojoAMD){q=cre$.internalutil.parseToJson(q);p="";if(q){var s={},u=!1,t;for(t in q[0])if(Object.prototype.hasOwnProperty.call(q[0],t)){var v=q[0][t];if(-1===v.indexOf("ERROR|@|")){var w=
c.modules[t];w?(u=!0,s[w]=new Function(v)):p+=t+"|"}else p+=t+"|"}else p+=t+"|"}u?(s["*noref"]=!0,require({cache:s})):(l.error={message:p},__logging.log("cre$.ResourceManager","_injectResources","Failure fetching AMD js from "+e+"."),h.resource=l,m[k]=h)}else{c=null;try{var z=x(h,e,q),c=y.evalFn(z)}catch(C){l.error={message:C.message},__logging.log("cre$.ResourceManager","_injectResources","An error occurred when evaluating the js, resource url is "+e+".")}(null===c||void 0===c)&&__logging.log("cre$.ResourceManager",
"_injectResources","",[e])}else l.type===n.constants.resourceType.CSS&&(c=document.createElement("style"),c.setAttribute("type",cre$.constants.resource.mimeType.CSS),c.styleSheet?c.styleSheet.cssText=A(x(h,e,q),e):c.innerHTML=A(x(h,e,q),e),document.getElementsByTagName("head")[0].appendChild(c));n.registerResource(l.uri,k)}else if(h.state===r.state.LOADED)for(e=f.length;e--;)b[a].globalid===f[e].uri&&b[a].error&&(f[e]=b[a])}return B(f,d)}function z(b,f){if(!y.isArray(b))throw Error(cre$.LocaleHelper.getLocalizedMessages().ERR_RESOURCE_NOT_ARRAY);
for(var d=[],a,g=function(a){m[a.globalid].state!==r.state.LOADED&&(m[a.globalid].state=r.state.DOWNLOADED)},c=function(a){var b=m[a.globalid].state;b!==r.state.LOADED&&b!==r.state.DOWNLOADED&&(m[a.globalid].state=r.state.ERROR);a.error={message:"Resource failed to load"}},e=0;e<b.length;e++){var k=b[e],h=k.globalid?k.globalid:k.uri,l=k;if(h){if(s.call(m,h)){if(k=m[h],a=k.promise,k.state===r.state.INIT&&f||k.state===r.state.ERROR)a=k.resource,a=v(h,a.uri,a.resourceUris,f,a.type,l),m[h].promise=a,
a.then(g,c)}else m[h]={resource:k,state:r.state.INIT,promise:null},a=v(h,k.uri,k.resourceUris,f,k.type,l),m[h].promise=a,a.then(g,c);a&&d.push(a)}}return cre$.promise.whenAll.apply(cre$.promise,d).then(function(a){return w(a,b)},function(a){return w(a,b)})}var n=cre$.ResourceManager,s=Object.prototype.hasOwnProperty,y=cre$.util,r=cre$.constants.ResourceManager,m={};n.constants={resourceType:{JAVASCRIPT:cre$.constants.resource.resourceType.JAVASCRIPT,CSS:cre$.constants.resource.resourceType.CSS,IMAGE:cre$.constants.resource.resourceType.IMAGE}};
var u;cre$.ResourceManager.resourcesLoaded?u=cre$.ResourceManager.resourcesLoaded:cre$.ResourceManager.resourcesLoaded=u={javascript:[],css:[],image:[]};n.makeProxyUrl=function(b,f){var d=null,a,d=cre$.services.ServiceManager?getServiceManager().getService(cre$.services.PROXYSERVICE,!0):cre$.promise.rejected("Service Manager is not loaded.");d.then(function(d){a=d.makeProxyUrl(b,f)},function(b){a=null});return a};n.registerResource=function(b,f){var d=f?f:b;s.call(m,d)||(m[d]={});m[d].state=r.state.LOADED};
n.isResourceRegistered=function(b){return b&&s.call(m,b)&&m[b].state===r.state.LOADED?!0:!1};n.isResourceDownloaded=function(b){return b&&s.call(m,b)&&(m[b].state===r.state.DOWNLOADED||m[b].state===r.state.LOADED)?!0:!1};n.loadResources=function(b,f,d){for(var a=0;a<b.length;a++)b[a].uri=n.makeProxyUrl(b[a].uri,d);return z(b,f)};n.isFeatureLoaded=function(b){if(!window.___jsl)return!1;for(var f=window.___jsl.l||[],d=0,a=f.length;d<a;d++)if(f[d]===b)return!0;return!1};n.getLoadedFeatures=function(){return window.___jsl?
window.___jsl.l||[]:[]};n.loadFeatures=function(b,f,d,a){if(!b||0===b.length)throw Error("[loadFeatures]"+cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_PARAM);for(var g=b.length,c=!0;g--;)if(!n.isFeatureLoaded(b[g])){c=!1;break}if(c)return cre$.promise.resolved(!0);b=["/gadgets/js/",b.join(":")];d?b.push("!",d.join(":")):window.___jsl&&b.push("!",(window.___jsl.l||[]).join(":"));b.push(".js");a=y.mixin({},a,{c:"1",debug:cre$.config.isDebug?1:0});b.push("?",function(a){var b=encodeURIComponent,
c=[],d={},f;for(f in a)if(s.call(a,f)){var g=a[f];if(g!==d[f]){var m=b(f)+"\x3d";c.push(m+b(g))}}return c.join("\x26")}(a));d=cre$.config.getCREServerUrl(b.join(""));return n.loadResources([{uri:d,type:cre$.constants.resource.resourceType.JAVASCRIPT}],f)}})();(function(){cre$.ResourceManager.getOrigin=function(a){var c={http:80,https:443};if(null===a.match(/^(?:([^:/?#]+):)?(?:\/\/([^/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/))throw"Malformed URL: "+a;a=RegExp.$1;var b=RegExp.$2;""!==b&&-1===b.indexOf(":")&&c[a]&&(b+=":"+c[a]);return[a,""!==a?":":"",""!==b?"//":"",b].join("")}})();cre$.services=cre$.services||{};
(function(){var a=cre$.services;a.URI="cre.uri";a.XHR="cre.xhr";a.XHRAGGREGATOR="cre.xhr.aggregator";a.AUTH="cre.auth";a.XML="cre.xml.Xmldoc";a.XPATH="cre.xml.xpath";a.XSLT="cre.xml.xslt";a.LOGGING="cre.logging";a.PEOPLE_11="cre.people_11";a.PEOPLE_11_DATA="cre.people_11.data";a.PEOPLE_11_RENDER="cre.people_11.render";a.CONFIG="cre.services.config";a.EVENTSERVICE="eventService";a.ITEMSETPERSISTENCE="persistenceService.itemSet";a.WIREPERSISTENCE="persistenceService.wire";a.WIDGETPERSISTENCE="persistenceService.widget";
a.PAGEPERSISTENCE="persistenceService.page";a.PROXYSERVICE="proxyURLService";a.IRUNTIME="cre.iRuntime";a.XHRWRAPPER="cre.services.xhrwrapper";a.DATAFETCHSERVICE="cre.services.dataFetch";a.JSONDATAFACTORYSERVICE="cre.services.jsonDataFactory";a.AUTOWIRE="cre.services.AutoWire";a.EVENTMATCHING="cre.services.EventNameMatching";a.NAMEDQUEUE="cre.services.NamedQueue";a.queueNames={};a.queueNames.WIDGETDEF="WIDGETDEF"})();"undefined"===typeof cre$.services.ServiceManager&&(cre$.services.ServiceManager=function(){this._serviceEntries={}},cre$.services.ServiceManager.prototype.getService=function(a,b){var c=this._serviceEntries[a]||null;if(null!==c){var d=c.serviceHandler||null;null===d&&(d=this._createService(c),null===d&&(d=cre$.iRuntime.loadFeatures([c.path],b).then(cre$.util.hitch(this,function(){return this._createService(c)}),function(){throw Error("[getService]"+cre$.LocaleHelper.getLocalizedMessages().ERR_CANT_LOAD_SERVICE+
a);})),this._serviceEntries[a].serviceHandler=cre$.promise.when(d));return this._serviceEntries[a].serviceHandler}return cre$.promise.rejected("service"+a+" is not registered.")},cre$.services.ServiceManager.prototype.setService=function(a,b,c){b=b||null;if(null===b)return null;var d=this._serviceEntries[a];null!==(d||null)&&delete this._serviceEntries[a];this._serviceEntries[a]||(this._serviceEntries[a]={});cre$.util.isString(b)?(this._serviceEntries[a].baseClass=b,this._serviceEntries[a].path=c):
this._serviceEntries[a].serviceHandler=cre$.promise.resolved(b)},cre$.services.ServiceManager.prototype.serviceLoaded=function(a){a=(a=this._serviceEntries[a])||null;return null!==a&&(a=a.serviceHandler,null!==(a||null))?!0:!1},cre$.services.ServiceManager.prototype._createService=function(a){var b=null;try{b=new (cre$.util.getObject(a.baseClass))}catch(c){}return b},function(){var a=null;cre$.services.getServiceManager=function(){if(null===a)try{a=new cre$.services.ServiceManager}catch(b){__logging.log("cre$.services",
"getServiceManager",cre$.LocaleHelper.getLocalizedMessages().ERR_CREATE_SERVICEMGR)}return a};window.getServiceManager=cre$.services.getServiceManager;for(var b=cre$.config.ServiceManagerCallbacks,c=b.length,d=cre$.services.getServiceManager();c--;)b[c].call(null,d)}());(function(){cre$.util.stringify=gadgets&&gadgets.json&&gadgets.json.stringify?gadgets.json.stringify:function(a,d,e){var c,b,f;c=/["\\\x00-\x1f\x7f-\x9f]/g;var g={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(a===window)return"#window";e=e?e:0;d=d?d:10;if(e>d)return"#hit_max_depth";switch(typeof a){case "string":return c.test(a)?'"'+a.replace(c,function(a){var b=g[a];if(b)return b;b=a.charCodeAt(0);return"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16)})+
'"':'"'+a+'"';case "number":return isFinite(a)?String(a):"null";case "boolean":case "null":return String(a);case "object":if(!a)return"null";c=[];if("number"===typeof a.length&&!a.propertyIsEnumerable("length")){f=a.length;for(b=0;b<f;b+=1)c.push(this.stringify(a[b],d,e+1)||"null");return"["+c.join(",")+"]"}for(b in a)!b.match("___$")&&a.hasOwnProperty&&a.hasOwnProperty(b)&&"string"===typeof b&&(f=this.stringify(a[b],d,e+1))&&c.push(this.stringify(b)+":"+f);return"{"+c.join(",")+"}"}return""}})();"undefined"==typeof cre$.Uri&&(shindig&&shindig.uri)&&(cre$.Uri=shindig.uri);cre$.Uri&&getServiceManager().setService(cre$.services.URI,cre$.Uri);shindig.sha1=function(){function s(){d[0]=1732584193;d[1]=4023233417;d[2]=2562383102;d[3]=271733878;d[4]=3285377520;g=e=0}function m(b){for(var c=u,a=0;64>a;a+=4)c[a/4]=b[a]<<24|b[a+1]<<16|b[a+2]<<8|b[a+3];for(a=16;80>a;a++)c[a]=((c[a-3]^c[a-8]^c[a-14]^c[a-16])<<1|(c[a-3]^c[a-8]^c[a-14]^c[a-16])>>>31)&4294967295;b=d[0];for(var f=d[1],h=d[2],e=d[3],g=d[4],k,l,a=0;80>a;a++)40>a?20>a?(k=e^f&(h^e),l=1518500249):(k=f^h^e,l=1859775393):60>a?(k=f&h|e&(f|h),l=2400959708):(k=f^h^e,l=3395469782),k=((b<<5|b>>>
27)&4294967295)+k+g+l+c[a]&4294967295,g=e,e=h,h=(f<<30|f>>>2)&4294967295,f=b,b=k;d[0]=d[0]+b&4294967295;d[1]=d[1]+f&4294967295;d[2]=d[2]+h&4294967295;d[3]=d[3]+e&4294967295;d[4]=d[4]+g&4294967295}function p(b,c){if("string"===typeof b){b=unescape(encodeURIComponent(b));for(var a=[],d=0,h=b.length;d<h;++d)a.push(b.charCodeAt(d));b=a}c||(c=b.length);a=0;if(0==e)for(;a+64<c;)m(b.slice(a,a+64)),a+=64,g+=64;for(;a<c;)if(n[e++]=b[a++],g++,64==e){e=0;for(m(n);a+64<c;)m(b.slice(a,a+64)),a+=64,g+=64}}function t(){var b=
[],c=8*g;56>e?p(q,56-e):p(q,64-(e-56));for(var a=63;56<=a;a--)n[a]=c&255,c>>>=8;m(n);for(a=c=0;5>a;a++)for(var f=24;0<=f;f-=8)b[c++]=d[a]>>f&255;return b}for(var d=[],n=[],u=[],q=[128],r=1;64>r;++r)q[r]=0;var e,g;s();return{reset:s,update:p,digest:t,digestString:function(){for(var b=t(),c="",a=0;a<b.length;a++)c+="0123456789ABCDEF".charAt(Math.floor(b[a]/16))+"0123456789ABCDEF".charAt(b[a]%16);return c}}};var OpenAjax=OpenAjax||{};
OpenAjax.hub||(OpenAjax.hub=function(){var a={};return{implementer:"http://openajax.org",implVersion:"2.0.7",specVersion:"2.0",implExtraData:{},libraries:a,registerLibrary:function(b,c,d,e){a[b]={prefix:b,namespaceURI:c,version:d,extraData:e};this.publish("org.openajax.hub.registerLibrary",a[b])},unregisterLibrary:function(b){this.publish("org.openajax.hub.unregisterLibrary",a[b]);delete a[b]}}}(),OpenAjax.hub.Error={BadParameters:"OpenAjax.hub.Error.BadParameters",Disconnected:"OpenAjax.hub.Error.Disconnected",Duplicate:"OpenAjax.hub.Error.Duplicate",
NoContainer:"OpenAjax.hub.Error.NoContainer",NoSubscription:"OpenAjax.hub.Error.NoSubscription",NotAllowed:"OpenAjax.hub.Error.NotAllowed",WrongProtocol:"OpenAjax.hub.Error.WrongProtocol",IncompatBrowser:"OpenAjax.hub.Error.IncompatBrowser"},OpenAjax.hub.SecurityAlert={LoadTimeout:"OpenAjax.hub.SecurityAlert.LoadTimeout",FramePhish:"OpenAjax.hub.SecurityAlert.FramePhish",ForgedMsg:"OpenAjax.hub.SecurityAlert.ForgedMsg"},OpenAjax.hub._debugger=function(){},OpenAjax.hub.ManagedHub=function(a){if(!a||
!a.onPublish||!a.onSubscribe)throw Error(OpenAjax.hub.Error.BadParameters);this._p=a;this._onUnsubscribe=a.onUnsubscribe?a.onUnsubscribe:null;this._scope=a.scope||window;if(a.log){var b=this;this._log=function(c){try{a.log.call(b._scope,"ManagedHub: "+c)}catch(d){OpenAjax.hub._debugger()}}}else this._log=function(){};this._subscriptions={c:{},s:null};this._containers={};this._seq=0;this._active=!0;this._isPublishing=!1;this._pubQ=[]},OpenAjax.hub.ManagedHub.prototype.subscribeForClient=function(a,
b,c){this._assertConn();if(this._invokeOnSubscribe(b,a))return this._subscribe(b,this._sendToClient,this,{c:a,sid:c});throw Error(OpenAjax.hub.Error.NotAllowed);},OpenAjax.hub.ManagedHub.prototype.unsubscribeForClient=function(a,b){this._unsubscribe(b);this._invokeOnUnsubscribe(a,b)},OpenAjax.hub.ManagedHub.prototype.publishForClient=function(a,b,c){this._assertConn();this._publish(b,c,a)},OpenAjax.hub.ManagedHub.prototype.disconnect=function(){this._active=!1;for(var a in this._containers)this.removeContainer(this._containers[a])},
OpenAjax.hub.ManagedHub.prototype.getContainer=function(a){return(a=this._containers[a])?a:null},OpenAjax.hub.ManagedHub.prototype.listContainers=function(){var a=[],b;for(b in this._containers)a.push(this._containers[b]);return a},OpenAjax.hub.ManagedHub.prototype.addContainer=function(a){this._assertConn();var b=a.getClientID();if(this._containers[b])throw Error(OpenAjax.hub.Error.Duplicate);this._containers[b]=a},OpenAjax.hub.ManagedHub.prototype.removeContainer=function(a){var b=a.getClientID();
if(!this._containers[b])throw Error(OpenAjax.hub.Error.NoContainer);a.remove();delete this._containers[b]},OpenAjax.hub.ManagedHub.prototype.subscribe=function(a,b,c,d,e){function f(a,d,f,h){if(g._invokeOnPublish(a,d,h,null))try{b.call(c,a,d,e)}catch(k){OpenAjax.hub._debugger(),g._log("caught error from onData callback to Hub.subscribe(): "+k.message)}}this._assertConn();this._assertSubTopic(a);if(!b)throw Error(OpenAjax.hub.Error.BadParameters);c=c||window;if(this._invokeOnSubscribe(a,null)){var g=
this;a=this._subscribe(a,f,c,e);this._invokeOnComplete(d,c,a,!0);return a}this._invokeOnComplete(d,c,null,!1,OpenAjax.hub.Error.NotAllowed)},OpenAjax.hub.ManagedHub.prototype.publish=function(a,b){this._assertConn();this._assertPubTopic(a);this._publish(a,b,null)},OpenAjax.hub.ManagedHub.prototype.unsubscribe=function(a,b,c){this._assertConn();if(!a)throw Error(OpenAjax.hub.Error.BadParameters);this._unsubscribe(a);this._invokeOnUnsubscribe(null,a);this._invokeOnComplete(b,c,a,!0)},OpenAjax.hub.ManagedHub.prototype.isConnected=
function(){return this._active},OpenAjax.hub.ManagedHub.prototype.getScope=function(){return this._scope},OpenAjax.hub.ManagedHub.prototype.getSubscriberData=function(a){this._assertConn();a=a.split(".");var b=a.pop();if(a=this._getSubscriptionObject(this._subscriptions,a,0,b))return a.data;throw Error(OpenAjax.hub.Error.NoSubscription);},OpenAjax.hub.ManagedHub.prototype.getSubscriberScope=function(a){this._assertConn();a=a.split(".");var b=a.pop();if(a=this._getSubscriptionObject(this._subscriptions,
a,0,b))return a.scope;throw Error(OpenAjax.hub.Error.NoSubscription);},OpenAjax.hub.ManagedHub.prototype.getParameters=function(){return this._p},OpenAjax.hub.ManagedHub.prototype._sendToClient=function(a,b,c,d){this.isConnected()&&this._invokeOnPublish(a,b,d,c.c)&&c.c.sendToClient(a,b,c.sid)},OpenAjax.hub.ManagedHub.prototype._assertConn=function(){if(!this.isConnected())throw Error(OpenAjax.hub.Error.Disconnected);},OpenAjax.hub.ManagedHub.prototype._assertPubTopic=function(a){if(!a||""===a||-1!=
a.indexOf("*")||-1!=a.indexOf("..")||"."==a.charAt(0)||"."==a.charAt(a.length-1))throw Error(OpenAjax.hub.Error.BadParameters);},OpenAjax.hub.ManagedHub.prototype._assertSubTopic=function(a){if(!a)throw Error(OpenAjax.hub.Error.BadParameters);a=a.split(".");for(var b=a.length,c=0;c<b;c++){var d=a[c];if(""===d||-1!=d.indexOf("*")&&"*"!=d&&"**"!=d)throw Error(OpenAjax.hub.Error.BadParameters);if("**"==d&&c<b-1)throw Error(OpenAjax.hub.Error.BadParameters);}},OpenAjax.hub.ManagedHub.prototype._invokeOnComplete=
function(a,b,c,d,e){if(a)try{b=b||window,a.call(b,c,d,e)}catch(f){OpenAjax.hub._debugger(),this._log("caught error from onComplete callback: "+f.message)}},OpenAjax.hub.ManagedHub.prototype._invokeOnPublish=function(a,b,c,d){try{return this._p.onPublish.call(this._scope,a,b,c,d)}catch(e){OpenAjax.hub._debugger(),this._log("caught error from onPublish callback to constructor: "+e.message)}return!1},OpenAjax.hub.ManagedHub.prototype._invokeOnSubscribe=function(a,b){try{return this._p.onSubscribe.call(this._scope,
a,b)}catch(c){OpenAjax.hub._debugger(),this._log("caught error from onSubscribe callback to constructor: "+c.message)}return!1},OpenAjax.hub.ManagedHub.prototype._invokeOnUnsubscribe=function(a,b){if(this._onUnsubscribe){var c=b.slice(0,b.lastIndexOf("."));try{this._onUnsubscribe.call(this._scope,c,a)}catch(d){OpenAjax.hub._debugger(),this._log("caught error from onUnsubscribe callback to constructor: "+d.message)}}},OpenAjax.hub.ManagedHub.prototype._subscribe=function(a,b,c,d){var e=a+"."+this._seq;
b={scope:c,cb:b,data:d,sid:this._seq++};a=a.split(".");this._recursiveSubscribe(this._subscriptions,a,0,b);return e},OpenAjax.hub.ManagedHub.prototype._recursiveSubscribe=function(a,b,c,d){var e=b[c];c==b.length?(d.next=a.s,a.s=d):("undefined"==typeof a.c&&(a.c={}),"undefined"==typeof a.c[e]&&(a.c[e]={c:{},s:null}),this._recursiveSubscribe(a.c[e],b,c+1,d))},OpenAjax.hub.ManagedHub.prototype._publish=function(a,b,c){if(this._isPublishing)this._pubQ.push({t:a,d:b,p:c});else for(this._safePublish(a,
b,c);0<this._pubQ.length;)a=this._pubQ.shift(),this._safePublish(a.t,a.d,a.p)},OpenAjax.hub.ManagedHub.prototype._safePublish=function(a,b,c){this._isPublishing=!0;var d=a.split(".");this._recursivePublish(this._subscriptions,d,0,a,b,c);this._isPublishing=!1},OpenAjax.hub.ManagedHub.prototype._recursivePublish=function(a,b,c,d,e,f){if("undefined"!=typeof a&&(c!=b.length&&(this._recursivePublish(a.c[b[c]],b,c+1,d,e,f),this._recursivePublish(a.c["*"],b,c+1,d,e,f),a=a.c["**"]),"undefined"!=typeof a))for(a=
a.s;a;){b=a.scope;c=a.cb;var g=a.data;"string"==typeof c&&(c=b[c]);c.call(b,d,e,g,f);a=a.next}},OpenAjax.hub.ManagedHub.prototype._unsubscribe=function(a){a=a.split(".");var b=a.pop();if(!this._recursiveUnsubscribe(this._subscriptions,a,0,b))throw Error(OpenAjax.hub.Error.NoSubscription);},OpenAjax.hub.ManagedHub.prototype._recursiveUnsubscribe=function(a,b,c,d){if("undefined"==typeof a)return!1;if(c<b.length){var e=a.c[b[c]];if(!e)return!1;this._recursiveUnsubscribe(e,b,c+1,d);if(!e.s){for(var f in e.c)return!0;
delete a.c[b[c]]}}else{b=a.s;c=null;for(e=!1;b;){if(d==b.sid){e=!0;b==a.s?a.s=b.next:c.next=b.next;break}c=b;b=b.next}if(!e)return!1}return!0},OpenAjax.hub.ManagedHub.prototype._getSubscriptionObject=function(a,b,c,d){if("undefined"!=typeof a){if(c<b.length)return this._getSubscriptionObject(a.c[b[c]],b,c+1,d);for(a=a.s;a;){if(d==a.sid)return a;a=a.next}}return null},OpenAjax.hub._hub=new OpenAjax.hub.ManagedHub({onSubscribe:function(a,b){return!0},onPublish:function(a,b,c,d){return!0}}),OpenAjax.hub.subscribe=
function(a,b,c,d){"string"===typeof b&&(c=c||window,b=c[b]||null);return OpenAjax.hub._hub.subscribe(a,b,c,null,d)},OpenAjax.hub.unsubscribe=function(a){return OpenAjax.hub._hub.unsubscribe(a)},OpenAjax.hub.publish=function(a,b){OpenAjax.hub._hub.publish(a,b)},OpenAjax.hub.registerLibrary("OpenAjax","http://openajax.org/hub","2.0",{}));var OpenAjax=OpenAjax||{};OpenAjax.hub=OpenAjax.hub||{};OpenAjax.gadgets="object"===typeof OpenAjax.gadgets?OpenAjax.gadgets:"object"===typeof gadgets?gadgets:{};OpenAjax.gadgets.rpctx=OpenAjax.gadgets.rpctx||{};
(function(){if("undefined"===typeof gadgets){if("undefined"===typeof oaaConfig)for(var q=document.getElementsByTagName("script"),f=/openajax(?:managedhub-(?:all|core).*|-mashup)\.js$/i,h=q.length-1;0<=h;h--){var b=q[h].getAttribute("src");if(b&&b.match(f)){if(q=q[h].getAttribute("oaaConfig"))try{oaaConfig=eval("({ "+q+" })")}catch(e){}break}}"undefined"!==typeof oaaConfig&&oaaConfig.gadgetsGlobal&&(gadgets=OpenAjax.gadgets)}})();
OpenAjax.hub.IframeContainer||function(){OpenAjax.hub.IframeContainer=function(f,h,b){function e(){OpenAjax.gadgets.rpc.call(c,"openajax.pubsub",function(a){if(a&&(l=!0,clearTimeout(w),u.getElementById(c).style.visibility="visible",b.Container.onConnect))try{b.Container.onConnect.call(r,m)}catch(s){OpenAjax.hub._debugger(),t("caught error from onConnect callback to constructor: "+s.message)}},"cmd","con")}function v(){if(l){l=!1;u.getElementById(c).style.visibility="hidden";for(var x in a)f.unsubscribeForClient(m,
a[x]);a={}}}function d(a){try{b.Container.onSecurityAlert.call(r,m,a)}catch(c){OpenAjax.hub._debugger(),t("caught error from onSecurityAlert callback to constructor: "+c.message)}}function k(){w=setTimeout(function(){d(OpenAjax.hub.SecurityAlert.LoadTimeout);m._handleIncomingRPC=function(){}},g)}(function(a){var b=a[1],c=a[2];if(!a[0]||!b||!c||!c.Container||!c.Container.onSecurityAlert||!c.IframeContainer||!c.IframeContainer.parent||!c.IframeContainer.uri)throw Error(OpenAjax.hub.Error.BadParameters);
})(arguments);var m=this,r=b.Container.scope||window,l=!1,a={},s,c,g=b.IframeContainer.timeout||15E3,w,u=b.IframeContainer.parent.ownerDocument,t=b.Container.log?function(a){try{b.Container.log.call(r,"IframeContainer::"+h+": "+a)}catch(c){OpenAjax.hub._debugger()}}:function(){};this._init=function(){f.addContainer(this);c=OpenAjax.hub.IframeContainer._rpcRouter.add(h,this);var a=b,g=r,n=t;if(!OpenAjax.hub.IframeContainer._prng){var d=(new Date).getTime()+Math.random()+document.cookie;OpenAjax.hub.IframeContainer._prng=
OpenAjax._smash.crypto.newPRNG(d)}if((a=a.IframeContainer||a.IframeHubClient)&&a.seed)try{var p=a.seed.call(g);OpenAjax.hub.IframeContainer._prng.addSeed(p)}catch(e){OpenAjax.hub._debugger(),n("caught error from 'seed' callback: "+e.message)}s=OpenAjax.hub.IframeContainer._prng.nextRandomB64Str(a&&a.tokenLength||6);g=b.IframeContainer.clientRelay;n=OpenAjax.gadgets.rpc.getRelayChannel();if(b.IframeContainer.tunnelURI){if("wpm"!==n&&"ifpc"!==n&&"flash"!==n)throw Error(OpenAjax.hub.Error.IncompatBrowser);
}else t("WARNING: Parameter 'IframeContaienr.tunnelURI' not specified. Connection will not be fully secure."),"rmr"===n&&!g&&(g=OpenAjax.gadgets.rpc.getOrigin(b.IframeContainer.uri)+"/robots.txt");n=document.createElement("span");b.IframeContainer.parent.appendChild(n);p='\x3ciframe id\x3d"'+c+'" name\x3d"'+c+'" src\x3d"javascript:\'\x3chtml\x3e\x3c/html\x3e\'"';a="";if(d=b.IframeContainer.iframeAttrs)for(var m in d)switch(m){case "style":for(var l in d.style)a+=l+":"+d.style[l]+";";break;case "className":p+=
' class\x3d"'+d[m]+'"';break;default:p+=" "+m+'\x3d"'+d[m]+'"'}p+=' style\x3d"'+(a+"visibility:hidden;")+'"\x3e\x3c/iframe\x3e';n.innerHTML=p;m=b.IframeContainer.tunnelURI?"\x26parent\x3d"+encodeURIComponent(b.IframeContainer.tunnelURI)+"\x26forcesecure\x3dtrue":"\x26oahParent\x3d"+encodeURIComponent(OpenAjax.gadgets.rpc.getOrigin(window.location.href));l="";c!==h&&(l="\x26oahId\x3d"+c.substring(c.lastIndexOf("_")+1));n=u.getElementById(c);b.IframeContainer.onGadgetLoad&&(n.attachEvent?n.attachEvent("onload",
b.IframeContainer.onGadgetLoad):n.onload=b.IframeContainer.onGadgetLoad);b.IframeContainer.uri.indexOf("#");p=b.IframeContainer.parent.ownerDocument.defaultView;for(a=0;p&&p!==window;)p=p.parent,a++;n.src=b.IframeContainer.uri+"#rpctoken\x3d"+s+m+l+"\x26embeddedlevel\x3d"+a;OpenAjax.gadgets.rpc.setupReceiver(c,g);"undefined"!==typeof b.nonGadget&&"true"===b.nonGadget&&OpenAjax.gadgets.rpc.setUpRpcIdsForNonGadgetIframe(h,h,b.IframeContainer.uri,["openajax.pubsub","__cb"]);k()};this.sendToClient=function(a,
b,s){OpenAjax.gadgets.rpc.call(c,"openajax.pubsub",null,"pub",a,b,s)};this.remove=function(){v();clearTimeout(w);OpenAjax.gadgets.rpc.removeReceiver(c);var a=document.getElementById(c);a.parentNode.removeChild(a);OpenAjax.hub.IframeContainer._rpcRouter.remove(c)};this.isConnected=function(){return l};this.getClientID=function(){return h};this.getPartnerOrigin=function(){if(l){var a=OpenAjax.gadgets.rpc.getReceiverOrigin(c);if(a)return/^([a-zA-Z]+:\/\/[^:]+).*/.exec(a)[1]}return null};this.getParameters=
function(){return b};this.getHub=function(){return f};this.getIframe=function(){return u.getElementById(c)};this._handleIncomingRPC=function(c,s,g){switch(c){case "pub":f.publishForClient(m,s,g);break;case "sub":c="";try{a[g]=f.subscribeForClient(m,s,g)}catch(d){c=d.message}return c;case "uns":return f.unsubscribeForClient(m,a[g]),delete a[g],g;case "con":return e(),!0;case "dis":k();v();if(b.Container.onDisconnect)try{b.Container.onDisconnect.call(r,m)}catch(h){OpenAjax.hub._debugger(),t("caught error from onDisconnect callback to constructor: "+
h.message)}return!0}};this._onSecurityAlert=function(a){d(q[a])};this._init()};OpenAjax.hub.IframeHubClient=function(f){function h(){if(!d)throw Error(OpenAjax.hub.Error.Disconnected);}function b(a){if(!a)throw Error(OpenAjax.hub.Error.BadParameters);a=a.split(".");for(var b=a.length,c=0;c<b;c++){var g=a[c];if(""===g||-1!=g.indexOf("*")&&"*"!=g&&"**"!=g)throw Error(OpenAjax.hub.Error.BadParameters);if("**"==g&&c<b-1)throw Error(OpenAjax.hub.Error.BadParameters);}}if(!f||!f.HubClient||!f.HubClient.onSecurityAlert)throw Error(OpenAjax.hub.Error.BadParameters);
var e=this,q=f.HubClient.scope||window,d=!1,k={},m=0,r,l=f.HubClient.log?function(a){try{f.HubClient.log.call(q,"IframeHubClient::"+r+": "+a)}catch(b){OpenAjax.hub._debugger()}}:function(){};this._init=function(){var a=OpenAjax.gadgets,b=a.util.getUrlParameters();b.parent||a.rpc.setupReceiver("..",b.oahParent+"/robots.txt");if(f.IframeHubClient&&f.IframeHubClient.requireParentVerifiable&&null===a.rpc.getReceiverOrigin(".."))throw a.rpc.removeReceiver(".."),Error(OpenAjax.hub.Error.IncompatBrowser);
OpenAjax.hub.IframeContainer._rpcRouter.add("..",this);r=OpenAjax.gadgets.rpc.RPC_ID;b.oahId&&(r=r.substring(0,r.lastIndexOf("_")))};this.connect=function(a,b){if(d)throw Error(OpenAjax.hub.Error.Duplicate);OpenAjax.gadgets.rpc.call("..","openajax.pubsub",function(c){if(c&&(d=!0,a))try{a.call(b||window,e,!0)}catch(g){OpenAjax.hub._debugger(),l("caught error from onComplete callback to connect(): "+g.message)}},"con")};this.disconnect=function(a,b){if(!d)throw Error(OpenAjax.hub.Error.Disconnected);
d=!1;var c=null;a&&(c=function(c){try{a.call(b||window,e,!0)}catch(d){OpenAjax.hub._debugger(),l("caught error from onComplete callback to disconnect(): "+d.message)}});OpenAjax.gadgets.rpc.call("..","openajax.pubsub",c,"dis")};this.getPartnerOrigin=function(){if(d){var a=OpenAjax.gadgets.rpc.getReceiverOrigin("..");if(a)return/^([a-zA-Z]+:\/\/[^:]+).*/.exec(a)[1]}return null};this.getClientID=function(){return r};this.subscribe=function(a,d,c,g,f){h();b(a);if(!d)throw Error(OpenAjax.hub.Error.BadParameters);
c=c||window;var e=""+m++;k[e]={cb:d,sc:c,d:f};OpenAjax.gadgets.rpc.call("..","openajax.pubsub",function(a){""!==a&&delete k[e];if(g)try{g.call(c,e,""===a,a)}catch(b){OpenAjax.hub._debugger(),l("caught error from onComplete callback to subscribe(): "+b.message)}},"sub",a,e);return e};this.publish=function(a,b){h();if(!a||""===a||-1!=a.indexOf("*")||-1!=a.indexOf("..")||"."==a.charAt(0)||"."==a.charAt(a.length-1))throw Error(OpenAjax.hub.Error.BadParameters);OpenAjax.gadgets.rpc.call("..","openajax.pubsub",
null,"pub",a,b)};this.unsubscribe=function(a,b,c){h();if(!a)throw Error(OpenAjax.hub.Error.BadParameters);if(!k[a]||k[a].uns)throw Error(OpenAjax.hub.Error.NoSubscription);k[a].uns=!0;OpenAjax.gadgets.rpc.call("..","openajax.pubsub",function(d){delete k[a];if(b)try{b.call(c||window,a,!0)}catch(e){OpenAjax.hub._debugger(),l("caught error from onComplete callback to unsubscribe(): "+e.message)}},"uns",null,a)};this.isConnected=function(){return d};this.getScope=function(){return q};this.getSubscriberData=
function(a){h();if(k[a])return k[a].d;throw Error(OpenAjax.hub.Error.NoSubscription);};this.getSubscriberScope=function(a){h();if(k[a])return k[a].sc;throw Error(OpenAjax.hub.Error.NoSubscription);};this.getParameters=function(){return f};this._handleIncomingRPC=function(a,b,c,d){if("pub"===a&&k[d]&&!k[d].uns)try{k[d].cb.call(k[d].sc,b,c,k[d].d)}catch(e){OpenAjax.hub._debugger(),l("caught error from onData callback to subscribe(): "+e.message)}return"con"===b?!0:!1};this._init()};OpenAjax.hub.IframeContainer._rpcRouter=
function(){function f(){var e=b[this.f];if(e)return e._handleIncomingRPC.apply(e,arguments)}function h(e,f){var d=b[e];d&&d._onSecurityAlert.call(d,f)}var b={};return{add:function(e,v){function d(d,e){if(".."===d)b[".."]||(b[".."]=e);else{for(var f=d;document.getElementById(f);)f=d+"_"+(32767*Math.random()|0).toString(16);b[f]=e;return f}}OpenAjax.gadgets.rpc.register("openajax.pubsub",f);OpenAjax.gadgets.rpc.config({securityCallback:h});q[OpenAjax.gadgets.rpc.SEC_ERROR_LOAD_TIMEOUT]=OpenAjax.hub.SecurityAlert.LoadTimeout;
q[OpenAjax.gadgets.rpc.SEC_ERROR_FRAME_PHISH]=OpenAjax.hub.SecurityAlert.FramePhish;q[OpenAjax.gadgets.rpc.SEC_ERROR_FORGED_MSG]=OpenAjax.hub.SecurityAlert.ForgedMsg;this.add=d;return d(e,v)},remove:function(e){delete b[e]}}}();var q={}}();OpenAjax.hub.InlineContainer=function(a,c,d){function f(b,f,a,c,d){if(b)try{f=f||window,b.call(f,a,c,d)}catch(e){OpenAjax.hub._debugger(),r._log("caught error from onComplete callback: "+e.message)}}function e(){for(var b in l)a.unsubscribeForClient(this,l[b].h);l=[];s=0;g=!1}function m(){if(!g)throw Error(OpenAjax.hub.Error.Disconnected);}function p(b){if(b=l[b])return b;throw Error(OpenAjax.hub.Error.NoSubscription);}if(!a||!c||!d||!d.Container||!d.Container.onSecurityAlert)throw Error(OpenAjax.hub.Error.BadParameters);
var h=d.Container.scope||window,g=!1,l=[],s=0,r=null,t=d.Container.log?function(b){try{d.Container.log.call(h,"InlineContainer::"+c+": "+b)}catch(f){OpenAjax.hub._debugger()}}:function(){};this._init=function(){a.addContainer(this)};this.getHub=function(){return a};this.sendToClient=function(b,f,a){if(g){a=l[a];try{a.cb.call(a.sc,b,f,a.d)}catch(c){OpenAjax.hub._debugger(),r._log("caught error from onData callback to HubClient.subscribe(): "+c.message)}}};this.remove=function(){g&&e()};this.isConnected=
function(){return g};this.getClientID=function(){return c};this.getPartnerOrigin=function(){return g?window.location.protocol+"//"+window.location.hostname:null};this.getParameters=function(){return d};this.connect=function(b,a,c){if(g)throw Error(OpenAjax.hub.Error.Duplicate);g=!0;r=b;if(d.Container.onConnect)try{d.Container.onConnect.call(h,this)}catch(e){OpenAjax.hub._debugger(),t("caught error from onConnect callback to constructor: "+e.message)}f(a,c,b,!0)};this.disconnect=function(b,a,c){if(!g)throw Error(OpenAjax.hub.Error.Disconnected);
e();if(d.Container.onDisconnect)try{d.Container.onDisconnect.call(h,this)}catch(m){OpenAjax.hub._debugger(),t("caught error from onDisconnect callback to constructor: "+m.message)}f(a,c,b,!0)};this.subscribe=function(b,c,e,d,g){m();if(!b)throw Error(OpenAjax.hub.Error.BadParameters);for(var k=b.split("."),q=k.length,n=0;n<q;n++){var h=k[n];if(""===h||-1!=h.indexOf("*")&&"*"!=h&&"**"!=h)throw Error(OpenAjax.hub.Error.BadParameters);if("**"==h&&n<q-1)throw Error(OpenAjax.hub.Error.BadParameters);}if(!c)throw Error(OpenAjax.hub.Error.BadParameters);
k=""+s++;q=!1;n=null;try{var p=a.subscribeForClient(this,b,k),q=!0}catch(r){k=null,n=r.message}e=e||window;q&&(l[k]={h:p,cb:c,sc:e,d:g});f(d,e,k,q,n);return k};this.publish=function(b,f){m();if(null==b||""===b||-1!=b.indexOf("*")||-1!=b.indexOf("..")||"."==b.charAt(0)||"."==b.charAt(b.length-1))throw Error(OpenAjax.hub.Error.BadParameters);a.publishForClient(this,b,f)};this.unsubscribe=function(b,c,e){m();if("undefined"===typeof b||null===b)throw Error(OpenAjax.hub.Error.BadParameters);var d=l[b];
if(!d)throw Error(OpenAjax.hub.Error.NoSubscription);a.unsubscribeForClient(this,d.h);delete l[b];f(c,e,b,!0)};this.getSubscriberData=function(b){m();return p(b).d};this.getSubscriberScope=function(b){m();return p(b).sc};this._init()};
OpenAjax.hub.InlineHubClient=function(a){if(!a||!a.HubClient||!a.HubClient.onSecurityAlert||!a.InlineHubClient||!a.InlineHubClient.container)throw Error(OpenAjax.hub.Error.BadParameters);var c=a.InlineHubClient.container,d=a.HubClient.scope||window;this._log=a.HubClient.log?function(f){try{a.HubClient.log.call(d,"InlineHubClient::"+c.getClientID()+": "+f)}catch(e){OpenAjax.hub._debugger()}}:function(){};this.connect=function(a,e){c.connect(this,a,e)};this.disconnect=function(a,e){c.disconnect(this,
a,e)};this.getPartnerOrigin=function(){return c.getPartnerOrigin()};this.getClientID=function(){return c.getClientID()};this.subscribe=function(a,e,d,p,h){return c.subscribe(a,e,d,p,h)};this.publish=function(a,e){c.publish(a,e)};this.unsubscribe=function(a,e,d){c.unsubscribe(a,e,d)};this.isConnected=function(){return c.isConnected()};this.getScope=function(){return d};this.getSubscriberData=function(a){return c.getSubscriberData(a)};this.getSubscriberScope=function(a){return c.getSubscriberScope(a)};
this.getParameters=function(){return a}};"undefined"==typeof OpenAjax._smash&&(OpenAjax._smash={});
OpenAjax._smash.crypto={strToWA:function(a,b){for(var f=[],c=(1<<b)-1,d=0;d<a.length*b;d+=b)f[d>>5]|=(a.charCodeAt(d/b)&c)<<32-b-d%32;return f},hmac_sha1:function(a,b,f){for(var c=Array(16),d=Array(16),g=0;16>g;g++)c[g]=a[g]^909522486,d[g]=a[g]^1549556828;a=this.sha1(c.concat(this.strToWA(b,f)),512+b.length*f);return this.sha1(d.concat(a),672)},newPRNG:function(a){function b(a){a=f.hmac_sha1(c,a,8);for(var b=0;5>b;b++)d[b]^=a[b]}var f=this;("string"!=typeof a||12>a.length)&&alert("WARNING: Seed length too short ...");
var c=[43417,15926,18182,33130,9585,30800,49772,40144,47678,55453,4659,38181,65340,6787,54417,65301],d=[],g=0;b(a);return{addSeed:function(a){b(a)},nextRandomOctets:function(a){for(var b=[];0<a;){g+=1;var c=f.hmac_sha1(d,g.toString(16),8);for(i=0;20>i&0<a;i++,a--)b.push((c[i>>2]>>i%4)%256)}return b},nextRandomB64Str:function(a){for(var b=this.nextRandomOctets(a),c="",d=0;d<a;d++)c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(b[d]&63);return c}}},sha1:function(){var a=
function(a,f){var c=(a&65535)+(f&65535);return(a>>16)+(f>>16)+(c>>16)<<16|c&65535};return function(b,f){b[f>>5]|=128<<24-f%32;b[(f+64>>9<<4)+15]=f;for(var c=Array(80),d=1732584193,g=-271733879,n=-1732584194,p=271733878,q=-1009589776,r=0;r<b.length;r+=16){for(var m=d,h=g,k=n,l=p,s=q,e=0;80>e;e++){c[e]=16>e?b[r+e]:(c[e-3]^c[e-8]^c[e-14]^c[e-16])<<1|(c[e-3]^c[e-8]^c[e-14]^c[e-16])>>>31;var t=m<<5|m>>>27,u;u=20>e?h&k|~h&l:40>e?h^k^l:60>e?h&k|h&l|k&l:h^k^l;t=a(a(t,u),a(a(s,c[e]),20>e?1518500249:40>e?1859775393:
60>e?-1894007588:-899497514));s=l;l=k;k=h<<30|h>>>2;h=m;m=t}d=a(m,d);g=a(h,g);n=a(k,n);p=a(l,p);q=a(s,q)}return[d,g,n,p,q]}}()};(function(){var b=cre$.util,d=window.dojo;b.toJsonIndentStr="\t";b.serializeJson=function(a){return null===a?null:window.JSON&&window.JSON.parse&&window.JSON.stringify?window.JSON.stringify(a):b.stringify(a)};b._escapeString=d?d._escapeString:function(a){return('"'+a.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")};b.map=d?d.map:function(a,c,b,e){c=_getParts(a,b,c);a=c[0];e=e?new e:[];b=0;for(var f=
a.length;b<f;++b)e.push(c[2].call(c[1],a[b],b,a));return e};b.toJson=d?d.toJson:function(a,c,d){if(void 0===a)return"undefined";var e=typeof a;if("number"==e||"boolean"==e)return a+"";if(null===a)return"null";if(b.isString(a))return b._escapeString(a);var f=arguments.callee,g;d=d||"";var k=c?d+b.toJsonIndentStr:"";g=a.__json__||a.json;if(b.isFunction(g)&&(g=g.call(a),a!==g))return f(g,c,k);if(a.nodeType&&a.cloneNode)throw Error("Can't serialize DOM nodes");g=c?" ":"";var l=c?"\n":"";if(b.isArray(a))return"["+
b.map(a,function(a){a=f(a,c,k);"string"!=typeof a&&(a="undefined");return l+k+a}).join(","+g)+l+d+"]";if("function"==e)return null;var e=[],h;for(h in a){var m,n;if("number"==typeof h)m='"'+h+'"';else if("string"==typeof h)m=b._escapeString(h);else continue;n=f(a[h],c,k);"string"==typeof n&&e.push(l+k+m+":"+g+n)}return"{"+e.join(","+g)+l+d+"}"};b.fromJson=d?d.fromJson:function(a){return eval("("+a+")")};b.queryToObject=d?d.queryToObject:function(a){var c={};a=a.split("\x26");var d=decodeURIComponent;
b.forEach(a,function(a){if(a.length){var f=a.split("\x3d");a=d(f.shift());f=d(f.join("\x3d"));"string"==typeof c[a]&&(c[a]=[c[a]]);b.isArray(c[a])?c[a].push(f):c[a]=f}});return c}})();(function(){var e=cre$.util;e._tokenRefreshers={};e.registerTokenRefresher=function(a,c){cre$.util._tokenRefreshers[a]=c};e.getTokenRefresher=function(a){return cre$.util._tokenRefreshers[a]};e.applyTokenToUrl=function(a,c,b){if(a&&c)return cre$.config.getCREServerUrl(),cre$.iRuntime.makeProxyUrl(a),c=cre$.iRuntime.getProxyUrl().replace("%host%",document.location.host),0<c.indexOf("?")&&(c=c.substring(0,c.indexOf("?"))),0<a.indexOf(c)&&b&&(a=shindig.uri(a),b=a.getPath()+"/"+b,a.setPath(b),a=a.toString()),
a};e._injectFirstParamToUrl=function(a,c,b){a=shindig.uri(a);var d=a.getQuery();null!==d?(a.setQuery(""),a.setQP(c,b),a=shindig.uri(a.toString()+"\x26"+d)):a.setQP(c,b);return a.toString()};e._hasSTinUrl=function(a){return"undefined"!==typeof shindig.uri(a).getQP("st")?!0:!1};e.removeSTIfExist=function(a){a=shindig.uri(a);if("undefined"!==typeof a.getQP("st"))return a.getQP("st")};e.refreshToken=function(a,c){var b=cre$.config.getCREServerUrl()+cre$.config.REFRESHTOKEN_URL,b=b+"?type\x3d"+c;if(cre$.config.userid){var d=
shindig.sha1();d.update(cre$.config.userid);d=d.digestString();b=b+"\x26u\x3d"+d}else b=b+"\x26u\x3d"+cre$.config.timestamp;b=cre$.iRuntime.makeProxyUrl(b);d={};d.url=b;d.headers={"Cache-control":"no-cache"};null!==cre$.internalutil.getCREContainerToken()&&(d.headers["X-Shindig-ST"]=cre$.internalutil.getCREContainerToken().token,b=cre$.util.applyTokenToUrl(b,cre$.internalutil.getCREContainerToken()));"container"!==c&&(d.headers.token=a);d.headers.container=cre$.config.CONTAINER;return cre$.xhr.xhrGet(d).then(function(a){delete a.xhr;
a=cre$.internalutil.parseToJson(a.data);return a.containerToken?a.containerToken:a.errors?a.errors[0]:null},function(a){delete a.xhr;return null})};e.scheduleTokenRefresher=function(a,c,b,d){var e=1E3*cre$.config.MAX_TOKEN_TTL,g=this,f=function(){if(c&&cre$.util._tokenRefreshers[c])cre$.util._tokenRefreshers[c](b);else g.refreshToken(a,c).then(b);d(setTimeout(f,e))};d(setTimeout(f,e))};e.unscheduleTokenRefresher=function(a){clearTimeout(a)}})();cre$.LocaleHelper=cre$.LocaleHelper||{};
(function(){var b=cre$.LocaleHelper;b.getLocale=function(){var c="en",a=null,a=cre$.config.locales&&cre$.util.isArray(cre$.config.locales)&&0<cre$.config.locales.length?cre$.config.locales:[(navigator.userLanguage?navigator.userLanguage:navigator.language).toLowerCase()];if(null!==a&&cre$.util.isArray(a))for(var b=a.length,d=0;d<b;d++){for(var f=!1,g=cre$.config.SUPPORTED_LOCALES.length,e=0;e<g;e++)if(a[d]===cre$.config.SUPPORTED_LOCALES[e]){f=!0;break}if(f){c=a[d];break}}return c};b.getLocalizedMessages=
function(){var c=null,a=!0;cre$.messages||(a=cre$.iRuntime.loadFeatures(["cre.messages."+b.getLocale()],!0));cre$.promise.when(a).then(function(a){c=cre$.messages});return c}})();cre$.ProxyService=function(){this._iu=cre$.ProxyInternalUtil};cre$.ProxyService.prototype.makeProxyUrl=function(a,b){return"undefined"===typeof a||null===a?null:this._iu.makeProxyUrl(a,b)};cre$.ProxyService.prototype.getProxyUrl=function(){return this._iu.getProxyUrl()};cre$.ProxyInternalUtil=cre$.ProxyInternalUtil||{};
(function(){var e=cre$.ProxyInternalUtil;e.getProxyUrl=function(){return(cre$.endpoint.resolveEndpoint(cre$.constants.endpoints.PROXY)||"//%host%"+cre$.config.CONTEXT_ROOT+"/common/proxy?refresh\x3d%refresh%\x26url\x3d%url%%rewriteMime%").replace("%host%",document.location.host)};e.makeProxyUrl=function(a,h){var d=h||{},c=a,f=d.isXhr;"undefined"===typeof f&&(f=!0);var g=function(a,c){var b=a.refreshInterval;void 0===b&&(b="3600");var d=a.rewriteMime?"\x26rewriteMime\x3d"+encodeURIComponent(a.rewriteMime):
"",b=e.getProxyUrl().replace("%url%",encodeURIComponent(c)).replace("%rawurl%",c).replace("%refresh%",encodeURIComponent(b)).replace("%container%",encodeURIComponent(a.container||a.synd||"default")).replace("%rewriteMime%",d);0===b.indexOf("//")&&(b=window.location.protocol+b);cre$.ResourceManager.getOrigin(b)===cre$.ResourceManager.getOrigin(c)&&(b=c);a.pst&&(b=b+"\x26pst\x3d"+a.pst);return b};-1===a.indexOf(":/")?0===a.indexOf("/")?c=window.location.protocol+"//"+window.location.host+a:d.widgetBaseUri&&
(a=d.widgetBaseUri+a,c=window.location.protocol+"//"+window.location.host,c=cre$.ResourceManager.getOrigin(a)!==cre$.ResourceManager.getOrigin(c)?g(d,a):a):f&&(c=g(d,a));return c}})();cre$.oah=cre$.oah||{};cre$.oah.ManagedHub=function(){this._inlineHubClients={};this.PREFIX_INLINE="_inline_";this.PREFIX_IFRAME="_iframe_";var a=function(a,b,c,d){c&&c.getClientID();d&&d.getClientID();return!0},b=function(a,b){b&&b.getClientID();return!0},c=function(a,b){};this.managedHubInstance||(this.managedHubInstance=new OpenAjax.hub.ManagedHub({onPublish:a,onSubscribe:b,onSecurityAlert:c}))};var _dummycallback=function(){};
cre$.oah.ManagedHub.prototype={createInlineHubContainer:function(a){return new OpenAjax.hub.InlineContainer(this.managedHubInstance,this.PREFIX_INLINE+a,{Container:{onConnect:function(a){},onDisconnect:function(a){},onSecurityAlert:function(a,c){},onError:function(a,c){}}})},createInlineHubClient:function(a){a=this.PREFIX_INLINE+a;var b=this.getContainer(a),b=new OpenAjax.hub.InlineHubClient({HubClient:{onSecurityAlert:function(a,b){}},InlineHubClient:{container:b}});b.connect(function(a,b,g){});
return this._inlineHubClients[a]=b},createIframeHubContainer:function(a,b,c,m,g,n){a=this.PREFIX_IFRAME+a;var d=cre$.config.CONTEXT_ROOT+"/container/rpc_relay.html",h=window.location.protocol,e=window.location.hostname,f=window.location.port,p=h+"//"+e+":"+f+d;""===f&&(p=h+"//"+e+d);d=function(a){};h=function(a){};e=function(a,b){};f=null;try{var k,l;l=k="100%";m&&(k=m);g&&(l=g);n&&(e=n);f=new OpenAjax.hub.IframeContainer(this.managedHubInstance,a,{Container:{onConnect:d,onDisconnect:h,onSecurityAlert:e},
IframeContainer:{uri:b,tunnelURI:p,parent:c,iframeAttrs:{title:"iframe",style:{width:k,height:l,border:"0px",overflow:"auto"}},onGadgetLoad:_dummycallback,timeout:12E5}})}catch(q){__logging.log("cre$.oah.ManagedHub","createIframeHubContainer",cre$.LocaleHelper.getLocalizedMessages().EXCEPTION_CREATE_IFR_CONTAINER,[q.message])}return f},_getInlineHubClient:function(a){if(!a)return null;a=this._inlineHubClients[this.PREFIX_INLINE+a];"undefined"===typeof a&&(a=null);return a},getInlineHubClient:function(a){return!a?
this.managedHubInstance:(a=this._getInlineHubClient(a))?a:this.managedHubInstance},removeInlineHubClient:function(a){var b=this._getInlineHubClient(a);a=this.PREFIX_INLINE+a;b&&(b.disconnect(function(a,b,g){}),delete this._inlineHubClients[a],(b=this.managedHubInstance.getContainer(a))&&this.managedHubInstance.removeContainer(b))},getContainer:function(a){return this.managedHubInstance.getContainer(a)},getManagedHubInstance:function(){return this.managedHubInstance}};cre$.oah.isManagedHub=!0;
cre$.oah.managedHub=new cre$.oah.ManagedHub;(function(){cre$.WidgetRefInternal=function(){this._componentType=cre$.constants.componentType.IWIDGET;this._failedResources=this._error=this._domNode=this._domId=this._definition=null;this._hashedDomain=!1;this._instanceMetadata=this._hashedDomainURL=null;this._isSandboxAttrEnabled=!1;this._loadInstanceData=null;this._notificationHandlers=[];this._parentId=null;this._renderType=cre$.constants.renderType.DEFAULT;this._widgetRef=this._widgetMetadata=this._userProfile=this._tokenInfo=this._supportedWindowStates=
this._supportedModes=this._state=this._siteResources=this._response=null;this._childrenIds=[];this._iContext=null;this._windowManager={};this._viewParams=this._renderParams=this._eeContext=this._eeDataModel=this._callback=this._rootElement=null};cre$.WidgetRefInternal.prototype.setComponentType=function(a){a===cre$.constants.componentType.IWIDGET||a===cre$.constants.componentType.GADGET?(this._componentType=a,cre$.config.isDebug||(this.componentType=this._componentType)):__logging.log("cre$.WidgetRefInternal",
"setComponentType",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_COMPONENT_TYPE,[this._definition],__logging.logLevel.WARNING)};cre$.WidgetRefInternal.prototype.getComponentType=function(){!cre$.config.isDebug&&this._componentType!==this.componentType&&(this._componentType=this.componentType);return this._componentType};cre$.WidgetRefInternal.prototype.setDefinition=function(a){if(cre$.util.isString(a))return this._definition=a,cre$.config.isDebug||(this.definition=this._definition),!0;__logging.log("cre$.WidgetRefInternal",
"setDefinition",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getDefinition=function(){!cre$.config.isDebug&&this._definition!==this.definition&&(this._definition=this.definition);return this._definition};cre$.WidgetRefInternal.prototype.getDynamicEvents=function(){var a=this.getInstanceMetadata();if(a&&cre$.util.isObject(a))return void 0===a.dynamicEvents?null:a.dynamicEvents;__logging.log("cre$.WidgetRefInternal",
"getDynamicEvents",cre$.LocaleHelper.getLocalizedMessages().ERR_INSTANCE_METADATA_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return null};cre$.WidgetRefInternal.prototype.setDomId=function(a){if(cre$.util.isString(a))return this._domId=a,cre$.config.isDebug||(this.domId=this._domId),!0;__logging.log("cre$.WidgetRefInternal","setDomId",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getDomId=
function(){!cre$.config.isDebug&&this._domId!==this.domId&&(this._domId=this.domId);return this._domId};cre$.WidgetRefInternal.prototype.setDomNode=function(a){if(a&&cre$.util.isObject(a))return this._domNode=a,cre$.config.isDebug||(this.domNode=this._domNode),!0;__logging.log("cre$.WidgetRefInternal","setDomNode",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getDomNode=function(){!cre$.config.isDebug&&
this._domNode!==this.domNode&&(this._domNode=this.domNode);return this._domNode};cre$.WidgetRefInternal.prototype.setError=function(a){if(a&&cre$.util.isObject(a))return this._error=a,cre$.config.isDebug||(this.error=this._error),!0;__logging.log("cre$.WidgetRefInternal","setError",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getError=function(){!cre$.config.isDebug&&this._error!==this.error&&(this._error=
this.error);return this._error};cre$.WidgetRefInternal.prototype.getEvent=function(){var a=this.getWidgetMetadata();if(a&&cre$.util.isObject(a))return void 0===a.event?null:a.event;__logging.log("cre$.WidgetRefInternal","getEvent",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return null};cre$.WidgetRefInternal.prototype.getEventDescription=function(){var a=this.getWidgetMetadata();if(a&&cre$.util.isObject(a))return void 0===
a.eventDescription?null:a.eventDescription;__logging.log("cre$.WidgetRefInternal","getEvent",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return null};cre$.WidgetRefInternal.prototype.setFailedResources=function(a){if(a&&cre$.util.isObject(a))return this._failedResources=a,cre$.config.isDebug||(this.failedResources=this._failedResources),!0;__logging.log("cre$.WidgetRefInternal","setFailedResources",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,
[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getFailedResources=function(){!cre$.config.isDebug&&this._failedResources!==this.failedResources&&(this._failedResources=this.failedResources);return this._failedResources};cre$.WidgetRefInternal.prototype.setHashedDomain=function(a){if(!0===a||!1===a)return this._hashedDomain=a,cre$.config.isDebug||(this.hashedDomain=this._hashedDomain),!0;__logging.log("cre$.WidgetRefInternal","setHashedDomain",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_BOOLEAN_PARAM,
[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.isHashedDomain=function(){!cre$.config.isDebug&&this._hashedDomain!==this.hashedDomain&&(this._hashedDomain=this.hashedDomain);return this._hashedDomain};cre$.WidgetRefInternal.prototype.setHashedDomainURL=function(a){if(cre$.util.isString(a))return this._hashedDomainURL=a,cre$.config.isDebug||(this.hashedDomainURL=this._hashedDomainURL),!0;__logging.log("cre$.WidgetRefInternal","setHashedDomainURL",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,
[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getHashedDomainURL=function(){!cre$.config.isDebug&&this._hashedDomainURL!==this.hashedDomainURL&&(this._hashedDomainURL=this.hashedDomainURL);return this._hashedDomainURL};cre$.WidgetRefInternal.prototype.setInstanceItemSet=function(a){if(a&&cre$.util.isObject(a)){var b=this.getInstanceMetadata();if(b&&cre$.util.isObject(b))return b.itemSet=a,!cre$.config.isDebug&&this.instanceMetaData&&(this.instanceMetaData.itemSet=b.itemSet),
!0;__logging.log("cre$.WidgetRefInternal","setInstanceItemSet",cre$.LocaleHelper.getLocalizedMessages().ERR_INSTANCE_PARAMS_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return!1}__logging.log("cre$.WidgetRefInternal","setInstanceItemSet",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getInstanceItemSet=function(){var a=this.getInstanceMetadata();if(a&&cre$.util.isObject(a))return void 0===a.itemSet?
null:a.itemSet;__logging.log("cre$.WidgetRefInternal","setReceivedEvents",cre$.LocaleHelper.getLocalizedMessages().ERR_INSTANCE_PARAMS_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return null};cre$.WidgetRefInternal.prototype.setInstanceMetadata=function(a){if(a&&cre$.util.isObject(a))return this._instanceMetadata=a,cre$.config.isDebug||(this.instanceMetaData=this._instanceMetadata),!0;__logging.log("cre$.WidgetRefInternal","setInstanceMetaData",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,
[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getInstanceMetadata=function(){!cre$.config.isDebug&&this._instanceMetadata!==this.instanceMetaData&&(this._instanceMetadata=this.instanceMetaData);return this._instanceMetadata};cre$.WidgetRefInternal.prototype.setSandboxAttrEnabled=function(a){if(a&&(!0===a||!1===a))return this._isSandboxAttrEnabled=a,!0;__logging.log("cre$.WidgetRefInternal","setSandboxAttrEnabled",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,
[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.isSandboxAttrEnabled=function(){return this._isSandboxAttrEnabled};cre$.WidgetRefInternal.prototype.setWidgetItemSet=function(a){if(a&&cre$.util.isObject(a)){var b=this.getWidgetMetadata();if(null!==b&&void 0!==b)return b.itemSet=a,!cre$.config.isDebug&&this.widgetMetadata&&(this.widgetMetadata.itemSet=b.itemSet),!0;__logging.log("cre$.WidgetRefInternal","setWidgetItemSet",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,
[this._definition],__logging.logLevel.WARNING);return!1}__logging.log("cre$.WidgetRefInternal","setWidgetItemSet",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a]);return!1};cre$.WidgetRefInternal.prototype.getWidgetItemSet=function(){var a=this.getWidgetMetadata();if(a&&cre$.util.isObject(a))return void 0===a.itemSet?null:a.itemSet;__logging.log("cre$.WidgetRefInternal","getWidgetItemSet",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,[this._definition],
__logging.logLevel.WARNING);return null};cre$.WidgetRefInternal.prototype.setLoadInstanceData=function(a){if(a&&cre$.util.isObject(a))return this._loadInstanceData=a,cre$.config.isDebug||(this.loadInstanceData=this._loadInstanceData),!0;__logging.log("cre$.WidgetRefInternal","setLoadInstanceData",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getLoadInstanceData=function(){!cre$.config.isDebug&&this._loadInstanceData!==
this.loadInstanceData&&(this._loadInstanceData=this.loadInstanceData);return this._loadInstanceData};cre$.WidgetRefInternal.prototype.removeLoadInstanceData=function(){!cre$.config.isDebug&&this._loadInstanceData!==this.loadInstanceData&&(this._loadInstanceData=this.loadInstanceData);var a=this._loadInstanceData;this._loadInstanceData=null;delete this._loadInstanceData;return a};cre$.WidgetRefInternal.prototype.parseLoadInstanceData=function(a){if(a&&cre$.util.isObject(a))a.callback&&this.setCallback(a.callback),
a.eeDataModel&&this.setEEDataModel(a.eeDataModel),a.renderParams&&this.setRenderParams(a.renderParams),a.renderType&&this.setRenderType(a.renderType),a.viewParams&&this.setViewParams(a.viewParams);else return __logging.log("cre$.WidgetRefInternal","setLoadInstanceData",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING),!1};cre$.WidgetRefInternal.prototype.getModuleId=function(){var a=null;if(this.getComponentType()===cre$.constants.componentType.IWIDGET){var b=
this.getInstanceMetadata();b&&cre$.util.isObject(b)&&(a=void 0===b.moduleId?null:b.moduleId)}else if(this.getComponentType()===cre$.constants.componentType.GADGET){if(cre$.iRuntime.getCommonContainer()){b=null;if(0===this.getDomId().indexOf(cre$.constants.others.GADGET_SITE))b=document.getElementById(this.getDomId());else{var d=document.getElementById(this.getDomId());d&&1===d.nodeType&&(d=d.childNodes[0])&&(d.id&&0===d.id.indexOf(cre$.constants.others.GADGET_SITE))&&(b=d)}var c;cre$.iRuntime.getCommonContainer().then(function(a){c=
a.sites_});for(var e in c)c[e].el_===b&&(a=e)}}else __logging.log("cre$.WidgetRefInternal","getModuleId",cre$.LocaleHelper.getLocalizedMessages().ERR_CC_NOT_LOADED);return a};cre$.WidgetRefInternal.prototype.registerNotificationHandler=function(a){if(a&&cre$.util.isFunction(a))this._notificationHandlers.push(a);else return __logging.log("cre$.WidgetRefInternal","registerNotificationHandler",""),!1};cre$.WidgetRefInternal.prototype.setParentId=function(a){if(cre$.util.isString(a))return this._parentId=
a,cre$.config.isDebug||(this.parentId=this._parentId),!0;__logging.log("cre$.WidgetRefInternal","setParentId",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getParentId=function(){!cre$.config.isDebug&&this._parentId!==this.parentId&&(this._parentId=this.parentId);return this._parentId};cre$.WidgetRefInternal.prototype.setReceivedEvents=function(a){if(a&&cre$.util.isObject(a)){var b=this.getInstanceMetadata();
if(b&&cre$.util.isObject(b))return b.receivedEvents=a,!cre$.config.isDebug&&this.instanceMetaData&&(this.instanceMetaData.receivedEvents=b.receivedEvents),!0;__logging.log("cre$.WidgetRefInternal","setReceivedEvents",cre$.LocaleHelper.getLocalizedMessages().ERR_INSTANCE_PARAMS_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return!1}__logging.log("cre$.WidgetRefInternal","setReceivedEvents",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);
return!1};cre$.WidgetRefInternal.prototype.getReceivedEvents=function(){var a=this.getInstanceMetadata();if(a&&cre$.util.isObject(a))return void 0===a.receivedEvents?null:a.receivedEvents;__logging.log("cre$.WidgetRefInternal","getReceivedEvents",cre$.LocaleHelper.getLocalizedMessages().ERR_INSTANCE_PARAMS_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return null};cre$.WidgetRefInternal.prototype.setRenderType=function(a){if(a===cre$.constants.renderType.INLINE||a===cre$.constants.renderType.SANDBOX||
a===cre$.constants.renderType.IFRAME||a===cre$.constants.renderType.DEFAULT||"fragment"===a)return this._renderType=a,cre$.config.isDebug||(this.renderType=this._renderType),!0;__logging.log("cre$.WidgetRefInternal","setRenderType",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_RENDER_TYPE,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getRenderType=function(){!cre$.config.isDebug&&this._renderType!==this.renderType&&(this._renderType=this.renderType);return this._renderType};
cre$.WidgetRefInternal.prototype.getResource=function(){var a=this.getWidgetMetadata();if(a&&cre$.util.isObject(a))return void 0===a.resource?null:a.resource;__logging.log("cre$.WidgetRefInternal","getEvent",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return null};cre$.WidgetRefInternal.prototype.setResponse=function(a){if(a&&cre$.util.isObject(a))return this._response=a,cre$.config.isDebug||(this.response=this._response),!0;
__logging.log("cre$.WidgetRefInternal","setResponse",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[hashedDomain],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getResponse=function(){!cre$.config.isDebug&&this._response!==this.response&&(this._response=this.response);return this._response};cre$.WidgetRefInternal.prototype.setSiteResources=function(a){if(a&&cre$.util.isObject(a))return this._siteResources=a,cre$.config.isDebug||(this.siteResources=this._siteResources),
!0;__logging.log("cre$.WidgetRefInternal","setSiteResources",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getSiteResources=function(){!cre$.config.isDebug&&this._siteResources!==this.siteResources&&(this._siteResources=this.siteResources);return this._siteResources};cre$.WidgetRefInternal.prototype.setState=function(a){if(a===cre$.constants.state.ERROR||a===cre$.constants.state.INITIAL||a===cre$.constants.state.PRELOADED||
a===cre$.constants.state.LOADED)return this._state=a,cre$.config.isDebug||(this.state=this._state),!0;__logging.log("cre$.WidgetRefInternal","setState",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_WIDGET_STATE,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getState=function(){!cre$.config.isDebug&&this._state!==this.state&&(this._state=this.state);return this._state};cre$.WidgetRefInternal.prototype.getSupportedModes=function(){if(cre$.util.isArray(this._supportedModes))return this._supportedModes;
var a=this.getWidgetMetadata();if(a&&cre$.util.isObject(a))return cre$.util.isString(a.supportedModes)?this._supportedModes=a.supportedModes.split(" "):null;__logging.log("cre$.WidgetRefInternal","getSupportedModes",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return null};cre$.WidgetRefInternal.prototype.getSupportedWindowStates=function(){if(cre$.util.isArray(this._supportedWindowStates))return this._supportedWindowStates;
var a=this.getWidgetMetadata();if(a&&cre$.util.isObject(a))return cre$.util.isString(a.supportedWindowStates)?this._supportedWindowStates=a.supportedWindowStates.split(" "):null;__logging.log("cre$.WidgetRefInternal","getSupportedWindowStates",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return null};cre$.WidgetRefInternal.prototype.setTokenInfo=function(a){if(a&&cre$.util.isObject(a))return this._tokenInfo=a,cre$.config.isDebug||
(this.tokenInfo=this._tokenInfo),!0;__logging.log("cre$.WidgetRefInternal","setTokenInfo",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getTokenInfo=function(){!cre$.config.isDebug&&this._tokenInfo!==this.tokenInfo&&(this._tokenInfo=this.tokenInfo);return this._tokenInfo};cre$.WidgetRefInternal.prototype.setUserProfile=function(a){if(a&&cre$.util.isObject(a))return this._userProfile=a,cre$.config.isDebug||
(this.userProfile=this._userProfile),!0;__logging.log("cre$.WidgetRefInternal","setUserProfile",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getUserProfile=function(){!cre$.config.isDebug&&this._userProfile!==this.userProfile&&(this._userProfile=this.userProfile);return this._userProfile};cre$.WidgetRefInternal.prototype.setWidgetMetadata=function(a){if(a&&cre$.util.isObject(a))return this._widgetMetadata=
a,this._supportedWindowStates=this._supportedModes=null,cre$.config.isDebug||(this.widgetMetadata=this._widgetMetadata),!0;__logging.log("cre$.WidgetRefInternal","setWidgetMetadata",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getWidgetMetadata=function(){!cre$.config.isDebug&&this._widgetMetadata!==this.widgetMetadata&&(this._widgetMetadata=this.widgetMetadata,this._supportedWindowStates=this._supportedModes=
null);return this._widgetMetadata};cre$.WidgetRefInternal.prototype.setWidgetRef=function(a){if(a&&cre$.util.isObject(a))return this._widgetRef=a,cre$.config.isDebug||(this.widgetRef=this._widgetRef),!0;__logging.log("cre$.WidgetRefInternal","setWidgetRef",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getWidgetRef=function(){!this._widgetRef&&!this.widgetRef&&(this._widgetRef=new cre$.WidgetRef(this));cre$.config.isDebug||
(this._widgetRef._componentType=this._componentType,this._widgetRef._definition=this._definition,this._widgetRef._domId=this._domId,this._widgetRef._domNode=this._domNode,this._widgetRef._error=this._error,this._widgetRef._failedResources=this._failedResources,this._widgetRef._hashedDomain=this._hashedDomain,this._widgetRef._hashedDomainURL=this._hashedDomainURL,this._widgetRef._instanceMetadata=this._instanceMetadata,this._widgetRef._loadInstanceData=this._loadInstanceData,this._widgetRef._notificationHandlers=
this._notificationHandlers,this._widgetRef._parentId=this._parentId,this._widgetRef._renderType=this._renderType,this._widgetRef._response=this._response,this._widgetRef._siteResources=this._siteResources,this._widgetRef._state=this._state,this._widgetRef._supportedModes=this._supportedModes,this._widgetRef._supportedWindowStates=this._supportedWindowStates,this._widgetRef._tokenInfo=this._tokenInfo,this._widgetRef._userProfile=this._userProfile,this._widgetRef._widgetMetadata=this._widgetMetadata,
this._widgetRef._childrenIds=this._childrenIds,this._widgetRef._iContext=this._iContext,this._widgetRef._windowManager=this._windowManager,this._widgetRef._rootElement=this._rootElement,this._widgetRef._callback=this._callback,this._widgetRef._eeDataModel=this._eeDataModel,this._widgetRef._eeContext=this._eeContext,this._widgetRef._renderParams=this._renderParams,this._widgetRef._viewParams=this._viewParams,this.widgetRef=this._widgetRef);return this._widgetRef};cre$.WidgetRefInternal.prototype.removeWidgetRef=
function(){!cre$.config.isDebug&&this._widgetRef!==this.widgetRef&&(this._widgetRef=this.widgetRef);var a=this._widgetRef;this._widgetRef=null;return a};cre$.WidgetRefInternal.prototype.handleEvent=function(a,b,d){var c=!1;"undefined"!==typeof a&&null!=a&&(a===this._iContext.constants.predefinedEvents.onModeChanged?c=this.handleModeChange(d.newMode):d&&d.newMode&&this._isOnModeEvent(a,b,d)?(this.invokeOnModeMethod(d.newMode),c=!0):c=this._handleEventInternal(a,b,d));return c};cre$.WidgetRefInternal.prototype.pushChildId=
function(a){this.getComponentType()!==cre$.constants.componentType.IWIDGET&&__logging.log("cre$.WidgetRefInternal","pushChildId",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_IWIDGET,[],__logging.logLevel.WARNING);if(a&&cre$.util.isString(a))return this._childrenIds.push(a),!0;__logging.log("cre$.WidgetRefInternal","pushChildId",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getChildrenIds=function(){return this.getComponentType()!==
cre$.constants.componentType.IWIDGET?(__logging.log("cre$.WidgetRefInternal","getChildrenIds",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_IWIDGET,[],__logging.logLevel.WARNING),null):this._childrenIds};cre$.WidgetRefInternal.prototype.setIContext=function(a){if(this.getComponentType()!==cre$.constants.componentType.IWIDGET)return __logging.log("cre$.WidgetRefInternal","setIContext",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_IWIDGET,[],__logging.logLevel.WARNING),!1;if(a&&
cre$.util.isObject(a))return this._iContext=a,this._rootElement=a._rootElement,!0;__logging.log("cre$.WidgetRefInternal","setIContext",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getIContext=function(){return this.getComponentType()!==cre$.constants.componentType.IWIDGET?(__logging.log("cre$.WidgetRefInternal","getIContext",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_IWIDGET,[],__logging.logLevel.WARNING),
null):this._iContext};cre$.WidgetRefInternal.prototype.handleModeChange=function(a,b){if(this.getComponentType()!==cre$.constants.componentType.IWIDGET)return __logging.log("cre$.WidgetRefInternal","handleModeChange",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_IWIDGET,[],__logging.logLevel.WARNING),!1;var d=!1,c=null,e=this.getIContext();if(null===b||"undefined"===typeof b)b=e.getiDescriptor().getItemValue(cre$.iwidget.iDescriptor.prototype.iDescriptorItems.mode);if(null===a||"undefined"===
typeof a||null!==a&&a===b)return!1;var g=this.getWidgetMetadata().defaultMode;g||(g=e.constants.mode.View);var c=this._windowManager[a]||null,f=null,g=!1;"undefined"!==typeof c&&null!==c&&(c=c.root,null!==c&&(f=c,d=g=!0,c.style.display=""));if(!g){if(null===f||"undefined"===typeof f)d=document.createElement("div"),d.className=this.getModuleId()+"Content "+a,this._rootElement.appendChild(d),f=this._rootElement.lastChild;d=this._updateMarkup(a,f)}if(d){var h=this._windowManager[b];null===h||"undefined"===
typeof h?(c=cre$.internalutil.getElementsByClass(this._rootElement,b),null!==c&&0<c.length&&(c=c[0],this._windowManager[b]={id:b,root:c,active:!1},c.style.display="none")):(c=h.root,h.active=!1,c.style.display="none");e._mode=a;e.getiDescriptor()._setItemValue(cre$.iwidget.iDescriptor.prototype.iDescriptorItems.mode,a);this._windowManager[a]={id:a,root:f,active:!0};g||this._evalScripts(f);this.invokeOnModeMethod(a);var k={moduleId:this.getModuleId(),newMode:a,oldMode:b};getServiceManager().serviceLoaded(cre$.services.EVENTSERVICE)&&
getServiceManager().getService(cre$.services.EVENTSERVICE).then(function(a){a.publishEvent(cre$.constants.event.topic.WIDGET_MODECHANGED,k)})}return d};cre$.WidgetRefInternal.prototype.invokeOnModeMethod=function(a){if(this.getComponentType()!==cre$.constants.componentType.IWIDGET)return __logging.log("cre$.WidgetRefInternal","invokeOnModeMethod",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_IWIDGET,[],__logging.logLevel.WARNING),!1;var b=!1,d=this.getIContext()._iScope;if(d){var c="on"+
a;d[c]&&"function"===typeof d[c]?b=!0:(c="on"+a.substr(0,1).toUpperCase()+a.substr(1),d[c]&&"function"===typeof d[c]?b=!0:(c="on"+a.substr(0,1).toLowerCase()+a.substr(1),d[c]&&"function"===typeof d[c]&&(b=!0)));if(b)try{d[c].call(d)}catch(e){console.log("widgetWrapper","invokeOnModeMethod",this.widgetId+" had an exception in its "+c+" function:\n"+e)}}return b};cre$.WidgetRefInternal.prototype._handleEventInternal=function(a,b,d){var c=!1,e=this._iContext._iScope;e&&(e[a]&&"function"===typeof e[a])&&
(e[a].call(e,{name:a,type:b,payload:d}),c=!0);return c};cre$.WidgetRefInternal.prototype._isOnModeEvent=function(a,b,d){b=!1;0===a.indexOf("on")&&this._isSupportedMode(d.newMode)&&(b=!0);return b};cre$.WidgetRefInternal.prototype._isSupportedMode=function(a){if("undefined"===typeof this._supportedModes||null===this._supportedModes)this.getWidgetMetadata().supportedModes?this._supportedModes=this.getWidgetMetadata().supportedModes.split(" "):this._supportedModes=["view"];return cre$.internalutil.contains(this._supportedModes,
a)};cre$.WidgetRefInternal.prototype._updateMarkup=function(a,b){var d=this.getIContext(),c=d._getMarkupByMode(a);if("undefined"===typeof c||null===c)return null;0===c.indexOf("\x3cscript")&&(c="\x26nbsp;"+c);var e=document.createElement("DIV");e.innerHTML=c;d._processScripts(e);b.innerHTML=e.innerHTML;cre$.internalutil.destroyNode(e);return!0};cre$.WidgetRefInternal.prototype._evalScripts=function(a){};cre$.WidgetRefInternal.prototype.setCallback=function(a){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal",
"setCallback",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,[],__logging.logLevel.WARNING),!1;if(a&&cre$.util.isString(a))return this._callback=a,cre$.config.isDebug||(this.callback=this._callback),!0;__logging.log("cre$.WidgetRefInternal","setCallback",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getCallback=function(){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal",
"getCallback",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,[],__logging.logLevel.WARNING),null;!cre$.config.isDebug&&this._callback!==this.callback&&(this._callback=this.callback);return this._callback};cre$.WidgetRefInternal.prototype.setEEDataModel=function(a){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal","setEEDataModel",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,[],__logging.logLevel.WARNING),
!1;if(a&&cre$.util.isObject(a))return this._eeDataModel=a,cre$.config.isDebug||(this.eeDataModel=this._eeDataModel),!0;__logging.log("cre$.WidgetRefInternal","setEEDataModel",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getEEDataModel=function(){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal","getEEDataModel",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,
[],__logging.logLevel.WARNING),null;!cre$.config.isDebug&&this._eeDataModel!==this.eeDataModel&&(this._eeDataModel=this.eeDataModel);return this._eeDataModel};cre$.WidgetRefInternal.prototype.setEEContext=function(a){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal","setEEContext",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,[],__logging.logLevel.WARNING),null;if(a&&cre$.util.isObject(a))return this._eeContext=a,cre$.config.isDebug||
(this.eeContext=this._eeContext),!0;__logging.log("cre$.WidgetRefInternal","setEEContext",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getEEContext=function(){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal","getEEContext",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,[],__logging.logLevel.WARNING),null;!cre$.config.isDebug&&
this._eeContext!==this.eeContext&&(this._eeContext=this.eeContext);return this._eeContext};cre$.WidgetRefInternal.prototype.setGadgetSiteId=function(a){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal","setGadgetSiteId",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,[],__logging.logLevel.WARNING),!1;if(cre$.util.isString(a)){var b=this.getRenderParams();if(b&&cre$.util.isObject(b))return b.gadgetSiteId=a,!cre$.config.isDebug&&
this.renderParams&&(this.renderParams.gadgetSiteId=b.gadgetSiteId),!0;__logging.log("cre$.WidgetRefInternal","setGadgetSiteId",cre$.LocaleHelper.getLocalizedMessages().ERR_RENDER_PARAMS_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return!1}__logging.log("cre$.WidgetRefInternal","setGadgetSiteId",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getGadgetSiteId=function(){if(this.getComponentType()!==
cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal","getGadgetSiteId",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,[],__logging.logLevel.WARNING),null;var a=this.getRenderParams();if(a&&cre$.util.isObject(a))return void 0===a.gadgetSiteId?null:a.gadgetSiteId;__logging.log("cre$.WidgetRefInternal","getGadgetSiteId",cre$.LocaleHelper.getLocalizedMessages().ERR_RENDER_PARAMS_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return null};cre$.WidgetRefInternal.prototype.setRenderParams=
function(a){if(a&&cre$.util.isObject(a))return this._renderParams=a,cre$.config.isDebug||(this.renderParams=this._renderParams),!0;__logging.log("cre$.WidgetRefInternal","setRenderParams",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[a],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getRenderParams=function(){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal","getRenderParams",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,
[],__logging.logLevel.WARNING),null;!cre$.config.isDebug&&this._renderParams!==this.renderParams&&(this._renderParams=this.renderParams);return this._renderParams};cre$.WidgetRefInternal.prototype.setTopics=function(a){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal","setTopics",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,[],__logging.logLevel.WARNING),!1;if(cre$.util.isArray(a)){var b=this.getWidgetMetadata();if(b&&
cre$.util.isObject(b))return b.topics=a,!cre$.config.isDebug&&this.widgetMetadata&&(this.widgetMetadata.topics=b.topics),!0;__logging.log("cre$.WidgetRefInternal","setTopics",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);return!1}__logging.log("cre$.WidgetRefInternal","setTopics",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_ARRAY_PARAM,[supportedModes],__logging.logLevel.WARNING);return!1};cre$.WidgetRefInternal.prototype.getTopics=
function(){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal","getTopics",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,[],__logging.logLevel.WARNING),null;var a=this.getWidgetMetadata();if(a&&cre$.util.isObject(a))return void 0===a.topics?null:a.topics;__logging.log("cre$.WidgetRefInternal","getTopics",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,[this._definition],__logging.logLevel.WARNING);
return null};cre$.WidgetRefInternal.prototype.setViewParams=function(a){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal","setViewParams",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,[],__logging.logLevel.WARNING),!1;if(a&&cre$.util.isObject(a))this._viewParams=a,cre$.config.isDebug||(this.viewParams=this._viewParams),!0;else return __logging.log("cre$.WidgetRefInternal","viewParams",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,
[a],__logging.logLevel.WARNING),!1};cre$.WidgetRefInternal.prototype.getViewParams=function(){if(this.getComponentType()!==cre$.constants.componentType.GADGET)return __logging.log("cre$.WidgetRefInternal","getViewParams",cre$.LocaleHelper.getLocalizedMessages().ERR_ONLY_SUPPORT_GADGET,[],__logging.logLevel.WARNING),null;!cre$.config.isDebug&&this._viewParams!==this.viewParams&&(this._viewParams=this.viewParams);return this._viewParams};cre$.WidgetRefInternal.prototype.changeMode=function(a){var b=
this.getDomId(),d=cre$.iRuntime.getWidgetIdByDomId(b),c=this.getComponentType();getServiceManager().getService(c).then(function(b){b.changeMode?b.changeMode(d,a):__logging.log("cre$.WidgetRef","changeMode",cre$.LocaleHelper.getLocalizedMessages().ERR_CANT_CHANGE_MODE,[c])})};cre$.WidgetRefInternal.prototype.changeState=function(a){var b=this.getState();if(a!==b){for(var d=this._notificationHandlers.length;d--;)this._notificationHandlers[d](a,b);this.setState(a)}}})();(function(){cre$.WidgetMetadataRepos=function(){this._metadata={}};cre$.WidgetMetadataRepos.prototype.putWidgetMetadata=function(a,b){var c=null;if(cre$.util.isString(a)&&cre$.util.isObject(b)){var d={};d.metadata=b;d.instanceNum=0;this.getWidgetMetadata(a)&&(__logging.log("cre$.WidgetMetadataRepos","putWidgetMetadata",cre$.LocaleHelper.getLocalizedMessages().ERR_RENDER_PARAMS_NOT_FOUND,[a],__logging.logLevel.WARNING),c=this.getWidgetMetadata(a).metadata);this._metadata[a]=d}else __logging.log("cre$.WidgetMetadataRepos",
"putWidgetMetadata",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,[a],__logging.logLevel.WARNING),__logging.log("cre$.WidgetMetadataRepos","putWidgetMetadata",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_OBJECT_PARAM,[b],__logging.logLevel.WARNING);return c};cre$.WidgetMetadataRepos.prototype.removeWidgetMetadata=function(a){var b=null;cre$.util.isString(a)?(b=this._metadata[a],delete this._metadata[a],b=cre$.util.isObject(b)?b.metadata:null):__logging.log("cre$.WidgetMetadataRepos",
"removeWidgetMetadata",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,[a],__logging.logLevel.WARNING);return b};cre$.WidgetMetadataRepos.prototype.getWidgetMetadata=function(a){var b=null;cre$.util.isString(a)?b=cre$.util.isObject(this._metadata[a])?this._metadata[a].metadata:null:__logging.log("cre$.WidgetMetadataRepos","getWidgetMetadata",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,[a],__logging.logLevel.WARNING);return b};cre$.WidgetMetadataRepos.prototype.addInstanceNum=
function(a){var b=!1;if(cre$.util.isString(a)){var c=this._metadata[a];cre$.util.isObject(c)?(c.instanceNum++,b=!0):__logging.log("cre$.WidgetMetadataRepos","addInstanceNum",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,[a],__logging.logLevel.WARNING)}else __logging.log("cre$.WidgetMetadataRepos","addInstanceNum",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,[a],__logging.logLevel.WARNING);return b};cre$.WidgetMetadataRepos.prototype.reduceInstanceNum=
function(a){var b=!1;if(cre$.util.isString(a)){var c=this._metadata[a];cre$.util.isObject(c)&&0<c.instanceNum?(c.instanceNum--,b=!0):__logging.log("cre$.WidgetMetadataRepos","reduceInstanceNum",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,[a],__logging.logLevel.WARNING)}else __logging.log("cre$.WidgetMetadataRepos","reduceInstanceNum",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,[a],__logging.logLevel.WARNING);return b};cre$.WidgetMetadataRepos.prototype.getInstanceNum=
function(a){var b=null;if(cre$.util.isString(a)){var c=this._metadata[a];cre$.util.isObject(c)?b=c.instanceNum:__logging.log("cre$.WidgetMetadataRepos","getInstanceNum",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_METADATA_NOT_FOUND,[a],__logging.logLevel.WARNING)}else __logging.log("cre$.WidgetMetadataRepos","getInstanceNum",cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_STRING_PARAM,[a],__logging.logLevel.WARNING);return b}})();(function(){cre$.WidgetRef=function(a){this._widgetRefInternal=a;a.setWidgetRef(this);this.widgetObject=a};cre$.WidgetRef.prototype.getEvents=function(a){var d=this;return getServiceManager().getService(this._widgetRefInternal.getComponentType()).then(function(c){return c.getEvents(d._widgetRefInternal,a)})};cre$.WidgetRef.prototype.getWidgetId=function(){return this._widgetRefInternal.getModuleId()};cre$.WidgetRef.prototype.load=function(){return cre$.iRuntime.loadWidgets([this._getParam()])};cre$.WidgetRef.prototype.preload=
function(){return cre$.iRuntime.preloadWidgets([this._getParam()])};cre$.WidgetRef.prototype.unload=function(){return cre$.iRuntime.unLoadWidgets([this._widgetRefInternal.getModuleId()],!0)};cre$.WidgetRef.prototype.unpreload=function(){return cre$.iRuntime.unLoadWidgets([this._widgetRefInternal.getModuleId()])};cre$.WidgetRef.prototype.clone=function(a,d,c){if(this._widgetRefInternal.getState()===cre$.constants.state.ERROR)throw Error("the widget state is error.");c=c||{};var b=new cre$.WidgetRefInternal;
b.setDomId(d);b.setDefinition(this._widgetRefInternal.getDefinition());b.setComponentType(this._widgetRefInternal.getComponentType());b.setInstanceMetadata({});b.setModuleId(a);this._widgetRefInternal.getComponentType()===cre$.constants.componentType.IWIDGET?(b.setReceivedEvents(c.wires||[]),b.setInstanceMetadataItemSet(c.itemSet||[]),b.setRenderType(c.renderType)):this._widgetRefInternal.getComponentType()===cre$.constants.componentType.GADGET&&(b.setRenderParams(c.renderParams),b.setRenderType(c.renderType),
b.setViewParams(c.viewParams),b.setCallback(c.callback),b.setEEDataModel(c.eeDataModel));b.setState(cre$.constants.state.INITIAL);return new cre$.WidgetRef(b)};cre$.WidgetRef.prototype.getMetadata=function(){return this._widgetRefInternal.getWidgetMetadata()};cre$.WidgetRef.prototype.registerNotificationHandler=function(a){this._widgetRefInternal.registerNotificationHandler(a)};cre$.WidgetRef.prototype.getContainer=function(){if(this._widgetRefInternal.getState()===cre$.constants.state.LOADED){if(this._widgetRefInternal.getComponentType()===
cre$.constants.componentType.IWIDGET)return this._widgetRefInternal.getIContext();if(this._widgetRefInternal.getComponentType()===cre$.constants.componentType.GADGET)return cre$.iRuntime.getCommonContainer()}else return null};cre$.WidgetRef.prototype.getScopingInstance=function(){if(this._widgetRefInternal.getState()===cre$.constants.state.LOADED){var a=this._widgetRefInternal.getIContext();if(a&&a._iScope)return a._iScope}return null};cre$.WidgetRef.prototype.getError=function(){if(this._widgetRefInternal.getState()===
cre$.constants.state.ERROR)return this._widgetRefInternal.getError();console.warn("widget's state is "+this._widgetRefInternal.getState()+", can't get error info.");return null};cre$.WidgetRef.prototype.getDomId=function(){return this._widgetRefInternal.getDomId()};cre$.WidgetRef.prototype.getState=function(){return this._widgetRefInternal.getState()};cre$.WidgetRef.prototype.getParentId=function(){return this._widgetRefInternal.getParentId()};cre$.WidgetRef.prototype.setParentId=function(a){return this._widgetRefInternal.setParentId(a)};
cre$.WidgetRef.prototype.getComponentType=function(){return this._widgetRefInternal.getComponentType()};cre$.WidgetRef.prototype.toggle=function(){var a=document.getElementById(this.getDomId());a&&(a.style.display="none"==a.style.display?"":"none")};cre$.WidgetRef.prototype.pushChildrenId=function(a){return this._widgetRefInternal.pushChildrenId(a)};cre$.WidgetRef.prototype.isError=function(){return this._widgetRefInternal.getState()===cre$.constants.state.ERROR};cre$.WidgetRef.prototype.isPreloaded=
function(){return this._widgetRefInternal.getState()===cre$.constants.state.PRELOADED};cre$.WidgetRef.prototype.isLoaded=function(){return this._widgetRefInternal.getState()===cre$.constants.state.LOADED};cre$.WidgetRef.prototype.isSandboxAttrEnabled=function(){return this._widgetRefInternal.isSandboxAttrEnabled()};cre$.WidgetRef.prototype._getParam=function(){var a={};a.placement=this._widgetRefInternal.getDomId();a.definitionUrl=this._widgetRefInternal.getDefinition();a.componentType=this._widgetRefInternal.getComponentType();
var d=this._widgetRefInternal.getState();d!==cre$.constants.state.ERROR&&(a.moduleId=this._widgetRefInternal.getModuleId(),this._widgetRefInternal.getComponentType()===cre$.constants.componentType.IWIDGET?a.instanceData={wires:this._widgetRefInternal.getReceivedEvents(),renderType:this._widgetRefInternal.getRenderType(),itemSet:this._widgetRefInternal.getInstanceMetadataItemSet()}:this._widgetRefInternal.getComponentType()===cre$.constants.componentType.GADGET&&(a.instanceData={renderParams:this._widgetRefInternal.getRenderParams(),
renderType:this._widgetRefInternal.getRenderType(),viewParams:this._widgetRefInternal.getViewParams(),callback:this._widgetRefInternal.getCallback(),eeDataModel:this._widgetRefInternal.getEEDataModel()}));if(d===cre$.constants.state.ERROR||d===cre$.constants.state.INITIAL)a.widgetRef=this;return a}})();cre$.WidgetRefArr=cre$.WidgetRefArr||{};cre$.WidgetRefArr.load=function(){for(var a=this.length,b=[];a--;)b.push(this[a]._getParam());return cre$.iRuntime.loadWidgets(b)};cre$.WidgetRefArr.preload=function(){for(var a=this.length,b=[];a--;)b.push(this[a]._getParam());return cre$.iRuntime.preloadWidgets(b)};cre$.WidgetRefArr.unload=function(){return cre$.iRuntime.unLoadWidgets(this._getUnloadIdArr(),!0)};cre$.WidgetRefArr.unpreload=function(){return cre$.iRuntime.unLoadWidgets(this._getUnloadIdArr())};
cre$.WidgetRefArr.registerNotificationHandler=function(a){for(var b=this.length;b--;)this[b].registerNotificationHandler(a)};cre$.WidgetRefArr.getWidgetRefByDomId=function(a){for(var b=this.length;b--;)if(this[b].widgetRefInternal.getDomId()===a)return this[b];return null};cre$.WidgetRefArr._getUnloadIdArr=function(){for(var a=[],b,c=this.length;c--;)b=this[c],a.push(cre$.iRuntime.getWidgetIdByDomId(b.widgetRefInternal.getDomId()));return a};
cre$.WidgetRefArr.getWidgetRefArr=function(){var a=[];a.push.apply(a,arguments);a.load=cre$.WidgetRefArr.load;a.preload=cre$.WidgetRefArr.preload;a.unload=cre$.WidgetRefArr.unload;a.unpreload=cre$.WidgetRefArr.unpreload;a.registerNotificationHandler=cre$.WidgetRefArr.registerNotificationHandler;a.getWidgetRefByDomId=cre$.WidgetRefArr.getWidgetRefByDomId;a._getUnloadIdArr=cre$.WidgetRefArr._getUnloadIdArr;return a};cre$.constants.iRuntime=cre$.constants.iRuntime||{};cre$.constants.iRuntime.resourceScope={SITE:"site",PAGE:"page"};cre$.constants.iRuntime.url={GADGETS_JS:"/gadgets/js"};cre$.constants.iRuntime.pageData={USERPROFILE:"userProfile",WIDGETMETADATA:"widgetMetadata",INSTANCEDATA:"instanceData",ITEMSET:"itemSet",DOMID_MAX:1000000001};cre$.constants.iRuntime.field={INSTANCEDATA:"instanceData",METADATA:"metadata"};
cre$.constants.mode={VIEW:iwConstants.mode.VIEW,EDIT:iwConstants.mode.EDIT,PERSONALIZE:iwConstants.mode.PERSONALIZE,CONFIG:iwConstants.mode.CONFIG,HELP:iwConstants.mode.HELP};cre$.constants.itemSet={USERPROFILE:"userProfile",IDESCRIPTOR:iwConstants.IDESCRIPTOR,ATTRIBUTES:iwConstants.ATTRIBUTES,ONITEMSETCHANGED:iwConstants.EVENTS.onItemSetChanged,ONPERSISTENCERESPONSE:"onPersistenceResponse"};cre$.internalutil=cre$.internalutil||{};
(function(){var d=cre$.internalutil,q=cre$.util,r=cre$.constants,h=r.renderType,t=r.componentType,u=r.iRuntime,k=null,v=null;d.setCREContainerToken=function(b){if(b&&"undefined"==typeof window.__isgadget){k=b;shindig.auth&&shindig.auth.updateSecurityToken(b.token);var c=function(a){v=a},a=function(a){k=a;shindig.auth&&shindig.auth.updateSecurityToken(b.token)};k&&(k.needsTokenRefresh?v?(d.clearContainerTokenRefresher(),cre$.util.scheduleTokenRefresher(k.token,"container",a,c)):(cre$.util.scheduleTokenRefresher(k.token,
"container",a,c),d.registerEventHandler(window,"unload",d.clearContainerTokenRefresher)):v&&d.clearContainerTokenRefresher())}};d.clearContainerTokenRefresher=function(){v&&cre$.util.unscheduleTokenRefresher(v)};d.getCREContainerToken=function(){return k};d.checkContainerToken=function(b){var c=null;"undefined"!==typeof b&&b.containerToken&&d.setCREContainerToken(b.containerToken);c=null===k?(b=q.getTokenRefresher("container"))?b(function(a){d.setCREContainerToken(a)}):cre$.util.refreshToken("","container").then(function(a){d.setCREContainerToken(a)}):
cre$.promise.resolved("container token already exist");return c};d.registerEventHandler=function(b,c,a){void 0!==b.addEventListener?b.addEventListener(c,a,!1):b.attachEvent&&b.attachEvent("on"+c,a)};d.checkWire=function(b){for(var c=!1,a=0;a<b.length;a++){var e=b[a],d=e.getReceivedEvents();if(d&&0<d.length){c=!0;break}if((e=e.getEvent())&&0<e.length){c=!0;break}}return c};d.createWiresForWidgetRefInternal=function(b){var c=[];if(b){var a=cre$.iRuntime.getWires(),c=b.getLoadInstanceData();b=b.getInstanceMetadata();
b=c?c:b?b:{};c=b.wires?b.wires:b.receivedEvents?b.receivedEvents:[];for(i=c.length;i--;)b=c[i],a.createWire(b.sourceWidget,b.sourceEvent,b.targetWidget,b.targetEvent)}return c};d.combineInstanceData=function(b,c){if(c&&c.instanceData){var a=c.instanceData,e=b.getInstanceMetadata();a.itemSet&&(this.createNewObjIfNotExisting(e.itemSet,!0),b.setInstanceItemSet(e.itemSet.concat(a.itemSet)));a.wires&&0<a.wires.length&&(this.createNewObjIfNotExisting(e.receivedEvents,!0),b.setReceivedEvents(e.receivedEvents.concat(a.wires)));
a.renderType&&b.setRenderType(a.renderType);a.eeDataModel&&b.setEEDataModel(a.eeDataModel);a.viewParams&&b.setViewParams(a.viewParams);a.renderParams&&b.setRenderParams(a.renderParams);a.callback&&b.setCallback(a.callback)}};d.createNewObjIfNotExisting=function(b,c){};d.composeWidgetRefInternal=function(b,c){var a=b[u.pageData.WIDGETMETADATA],e=b[u.pageData.INSTANCEDATA],d={widgets:{},errorArr:[]};if(a&&e){for(var k=a.length,m={},f,n=null;k--;)(f=a[k].definitionUrl)&&(m[f]=a[k]);for(k=e.length;k--;){a=
new cre$.WidgetRefInternal;f=e[k];a.setComponentType(t.GADGET);a.setInstanceMetadata(f.instanceMetaData);a.setDefinition(f.definition);a.setDomId(f.domId);a.setParentId(f.parentId);a.setRenderType(f.renderType);a.setTokenInfo(f.tokenInfo);f=a.getDefinition();if(c)for(var s in c)if(Object.prototype.hasOwnProperty.call(c,s)){var g=c[s],l=g.definitionUrl;0==l.indexOf("/")&&(l=l.substring(1,l.length));if(a.getDomId()===g.placement&&(f===g.definitionUrl||f.substring(f.length-l.length)===l))g.definitionUrl=
f,this.combineInstanceData(a,g)}if(f&&m[f]&&m[f].error)a.setError(m[f].error),a.setState(r.state.ERROR),d.errorArr.push(a);else if("fragment"===a.getRenderType()&&!(cre$.util.isIE&&10<=cre$.util.isIE||cre$.util.isFF&&17<=cre$.util.isFF||cre$.util.isChrome&&4<=cre$.util.isChrome||cre$.util.isSafari&&5<=cre$.util.isSafari||cre$.util.isOpera&&15<=cre$.util.isOpera))a.setError({message:"Fragment type is not supported in the current browser for widget "+a.getDefinition()}),a.setState(r.state.ERROR),d.errorArr.push(a);
else{f?(g=cre$.iRuntime.getWidgetMetadataRepos().getWidgetMetadata(f),a.setWidgetMetadata(g),a.setComponentType(g.componentType)):a.setComponentType(t.GADGET);var g=a,l=g.getRenderType(),p=g.getComponentType(),l=l?l:h.DEFAULT;if(p===t.IWIDGET)switch(l){case h.INLINE:case h.DEFAULT:g.setRenderType(h.INLINE);break;case h.SANDBOX:case h.IFRAME:g.setRenderType(h.SANDBOX);break;case h.FRAGMENT:g.setRenderType(h.SANDBOX);g.setSandboxAttrEnabled(!0);break;default:throw Error("[_normalizeRenderType]"+cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_RENDER_TYPE+
l);}else if(p===t.GADGET)switch(l){case h.INLINE:case h.SANDBOX:case h.IFRAME:case h.DEFAULT:g.setRenderType(h.DEFAULT);break;case h.FRAGMENT:g.setRenderType(h.SANDBOX);g.setSandboxAttrEnabled(!0);break;default:throw Error("[_normalizeRenderType]"+cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_RENDER_TYPE+l);}g.getRenderType();if(a.getComponentType()===t.IWIDGET&&a.getRenderType()===h.SANDBOX){if(null===n){for(var n=b.resourceList,g=0,l=n.length,p=void 0,q=[],g=0;g<l;g++)p=n[g],(p.scope===u.resourceScope.SITE||
p.scope===u.resourceScope.PAGE)&&(-1===p.uri.indexOf(r.featureName.IRUNTIME)&&-1===p.uri.indexOf(u.url.GADGETS_JS))&&q.push(p);n=q}0<n.length&&a.setSiteResources(n);a.setUserProfile(b.userProfile||cre$.iRuntime.getStateSet(null,r.itemSet.USERPROFILE).userProfile)}d.widgets[a.getComponentType()]||(d.widgets[a.getComponentType()]=[]);d.widgets[a.getComponentType()].push(a)}f&&m[f]&&delete m[f]}for(s in m)Object.prototype.hasOwnProperty.call(m,s)&&(e=m[s].componentType,d.widgets[e]||(d.widgets[e]=[]),
a=new cre$.WidgetRefInternal,a.setWidgetMetadata(m[s]),a.setComponentType(e),a.setDefinition(m[s].definitionUrl),d.widgets[e].push(a))}return d};d.createUPStateSet=function(b){var c={id:b.id,widgetIds:["*"],userProfile:b};b.onItemSetChanged&&(c.onStateSetChanged=b.onItemSetChanged);c.items={};if(b.item)for(var a=b.item.length;a--;){var e=new cre$.StateItem(b.item[a]);c.items[e.id]=e}return new cre$.StateSet(c)};d.contains=function(b,c){for(var a=!1,e=0;e<b.length;e++)if(c===b[e]){a=!0;break}return a};
d.encodePath=function(b,c){if(0===b.length)return b;for(var a=b.split("/"),e=0;e<a.length;++e)a[e]=c?unescape(a[e]):escape(unescape(a[e]));return a.join("/")};d.destroyNode=function(b){var c=document.getElementById("IELeakGarbageBin");c||(c=document.createElement("DIV"),c.setAttribute("id","IELeakGarbageBin"),c.style.display="none",document.body.appendChild(c));c.appendChild(b);c.innerHTML="";3!==b.nodeType&&(q.isIE&&10>Math.floor(q.isIE))&&(b.outerHTML="")};d.convertDomToString=function(b,c){if(!b)return"";
var a=null,e=document.createElement("div");e.appendChild(b);a=q.isIE&&10>Math.floor(q.isIE)?e.innerHTML.replace(/=([^\s\">\/]+)(\s|>|\/)/gi,'\x3d"$1"$2').replace(/(<\s*\w+)|(<\/\s*\w+)/gi,function(a){return a.toLowerCase()}):e.innerHTML;c&&this.destroyNode(e);return a};d.getElementsByClass=function(b,c){var a=[];if(b.getElementsByClassName)for(var e=b.getElementsByClassName(c),d=0;d<e.length;d++)a[d]=e[d];else for(var e=b.getElementsByTagName("*"),h=0,k=RegExp("(\\S+\\s+|^\\s*)"+c+"(\\s+\\S+|\\s*$)"),
f=e.length,d=0;d<f;d++){var n=e[d];k.test(n.className)&&(a[h++]=n)}return a}})();cre$.internalutil=cre$.internalutil||{};(function(){cre$.internalutil.parseToJson=function(a){return/^[\],:{}\s]*$/.test(a.replace(/\\['"\\\/b-ux]/g,"@").replace(/"[^"\\\n\r]*"|'[^'\\\n\r]*'|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))?eval("("+a+")"):!1}})();"undefined"===typeof cre$.iRuntime&&(cre$.iRuntime=function(){function P(a){for(var b=k.length;b--;)if(k[b].id===p.itemSet.USERPROFILE){k.splice(b,1);break}k.push(a)}function V(a){var b=null;1===a.nodeType?b=a.id:"string"===typeof a&&(b=a);return b}function W(a,b){var d=a.length;return 0===d?b:b.then(function(b){for(var c=new cre$.promise.Promise("combinePreloadGadgetsResult"),e;d--;){var g=a[d];(e=g.definition)?C[e]?C[e].error?(g.error=C[e].error,g.state=cre$.constants.state.ERROR,b.errorArr.push(g)):
g.domId&&(g.response=C[e],b.widgetArr.push(g)):(g.error={message:"No response from preloadGadgets"},g.state=cre$.constants.state.ERROR,b.errorArr.push(g)):b.widgetArr.push(g)}0<b.errorArr.length?c.reject(b):c.resolve(b);return c})}function Q(a,b,d,f){var c=a[p.iRuntime.pageData.WIDGETMETADATA],e=null;if(c&&0<c.length)for(var g=c.length,v;g--;)(v=c[g].definitionUrl)&&!c[g].error&&F.putWidgetMetadata(v,c[g]);var k=new cre$.promise.Promise("_processPreloadResponse");f=l.composeWidgetRefInternal(a,f);
var r=f.errorArr,h=f.widgets,w=function(a){for(var b=a.length,d=[],e=[],c=null;b--;)d=d.concat(a[b].widgetArr),e=e.concat(a[b].errorArr);e=e.concat(r);for(b=d.length;b--;)a=d[b],(c=a.getDefinition())&&F.addInstanceNum(c),a.setState(D.INITIAL),a.setDomNode(R[a.getDomId()]),q[a.getDomId()]=a;!I&&l.checkWire(d)?c=cre$.iRuntime.loadFeatures([cre$.constants.featureName.WIRE]).then(function(){I||(I=new cre$.Wire(cre$.oah.isManagedHub,cre$.oah.managedHub));I.init(q);if(0<A.length)for(var a=A.length,b=0;b<
a;b++)A[b].object[A[b].callback].call(A[b].object)}):(c=new cre$.promise.Promise("wirePromise"),c.resolve());cre$.promise.when(c).then(function(){0<e.length?k.reject(d.concat(e)):k.resolve(d)})},E=function(a,b,e){var c=[];N.call(a,p.itemSet.USERPROFILE)&&P(l.createUPStateSet(a[p.itemSet.USERPROFILE]));for(var f in b)Object.prototype.hasOwnProperty.call(b,f)&&c.push(m.getService(f).then(s.partial(function(a,e){if(a===J.GADGET){for(var c=b[a],f=c.length,g=[],h=[];f--;)C[c[f].definition]?h.push(c[f]):
g.push(c[f]);return W(h,e.preload(g,d))}return e.preload(b[a],d)},f)));cre$.promise.whenAll.apply(cre$.promise,c).then(e,e)},u=function(a){var b=cre$.iRuntime._jsFailedToLoad;if("undefined"!==typeof b&&0<b.length){var d=b.length;a||(a=[]);for(var c=0;c<d;c++)a.push({url:b[c],type:t.constants.resourceType.JAVASCRIPT})}if(a&&0<a.length)for(b=a.length;b--;)if(d=a[b],d.error)for(var c=h.iWidget,e=c.length;e--;)for(var f=c[e],g=f.getResource(),g=g?g:[],E=g.length;E--;)d.url===g[E].fullUri&&(f.setFailedResources(f.getFailedResources()?
f.getFailedResources():[]),f.getFailedResources().push(d))};f=function(a){var b=null,d=!1;if(c)for(var e=c.length;e--&&!d;){var f=c[e],g=f.resource;if(g)for(var h=g.length;h--;)if(g[h].fullUri==a){b=f;d=!0;break}}return b};g=[];e=[];if(b){b=a.resourceList;v=b.length;for(var n,x;v--;){n=b[v].skipLoad;x=!1;if(n)try{x=window.eval(n)}catch(z){x=!1}b[v].type!==p.resource.resourceType.IMAGE&&(-1!==b[v].uri.lastIndexOf("\x26")?b[v].uri+="\x26isClientInjection\x3dtrue":b[v].uri+="?isClientInjection\x3dtrue");
if(!x){var K=b[v];n=K.resourceUris;n||(n=K.uri);if(n&&0<n.length){n=n[0];var y=f(n);if(y){x=y.componentType;var B=new cre$.promise.Promise("augmentedResourcePromise: "+n);g.push(B);m.getService(x).then(function(a){a.augmentResource(K,y,B)})}e.push(K)}}}}cre$.promise.whenAll.apply(cre$.promise,g).then(function(b){(e&&0<e.length?t.loadResources(e,""):cre$.promise.resolved(null)).then(function(b){u(b);E(a,h,w)},function(b){u(b);E(a,h,w)})},function(a){for(var b=h.iWidget,d=[],c=[],e=b.length,f=a.length;e--;){for(var g=
[];f--;)a[f]&&a[f].definitionUrl===b[e].definition&&g.push({definitionUrl:a[f].definitionUrl,message:a[f].message});0<g.length?(b[e].error=g,c.push(b[e])):d.push(b[e])}w([{errorArr:c,widgetArr:d}])});return k}function X(a){var b={},d;for(d in a)N.call(a,d)&&(b[d]=a[d]);a.placement.id?b.placement=a.placement.id:(d="_widget_"+Math.floor(Math.random()*S.DOMID_MAX),a.placement.id=d,b.placement=d);R[a.placement.id]=a.placement;return b}function Y(a){var b={},d=cre$.config.getCREServerUrl()+cre$.config.PROCESSWIDGETS_URL,
f={},c=[],e,g=a.length,v;f.loadedFeatures=t.getLoadedFeatures();for(f.combineResources=cre$.config.COMBINE_RESOURCES;g--;)e={fields:{}},"string"===typeof a[g]?(e.format="dom",e.widget=a[g],e.fields[G.INSTANCEDATA]=!0,e.fields[G.METADATA]=!0):1===a[g].nodeType?(v=l.getElementsByClass(a[g],p.others.IW_DEFINITION)[0].href,e.format="dom",e.widget=l.convertDomToString(a[g]),e.fields[G.INSTANCEDATA]=!0,F.getWidgetMetadata(v)||(e.fields[G.METADATA]=!0)):(e.format="json",e.widget=cre$.util.clone(a[g]),delete e.widget.instanceData,
a[g].placement&&(e.fields[G.INSTANCEDATA]=!0),F.getWidgetMetadata(a[g].definitionUrl)||(e.fields[G.METADATA]=!0)),c.push(e);f.widgets=c;a=!1;for(c=0;c<k.length;c++)if(k[c].id===p.itemSet.USERPROFILE){a=!0;break}f.requireUserProfile=!a;b[z.PARAM_DATA]=s.serializeJson(f);b[z.URL]=s.applyTokenToUrl(t.makeProxyUrl(d),l.getCREContainerToken());d={};l.getCREContainerToken()&&(d[z.HEADER_SHINDIG_ST]=l.getCREContainerToken().token);d[z.HEADER_CRE_PERSISTENCE_URL]=cre$.endpoint.resolveEndpoint(cre$.constants.persistence.PERSISTENCE_URL);
d[z.CONTAINER]=cre$.config.CONTAINER;b[z.HEADERS]=d;b[z.CONTENT_TYPE]=z.contentType.JSON;b[z.RESPONSE_TYPE]=p.response.type.JSON;return b}function Z(a,b,d){m.serviceLoaded(cre$.services.EVENTSERVICE)&&m.getService(cre$.services.EVENTSERVICE).then(function(f){f.publishEvent(a,b,d)})}function $(a){var b=new cre$.promise.Promise("_renderWidget: "+a.getDefinition());cre$.WidgetParser.parse(a,k);return b=m.getService(a.getComponentType()).then(function(b){return b.render(a).then(function(a){a.changeState(D.LOADED);
l.createWiresForWidgetRefInternal(a);return a},function(a){delete q[a.widgetRefInternal.getDomId()];a._changeState(D.ERROR);return a})})}function aa(a,b){var d=new cre$.promise.Promise("_preloadWidgets"),f=H;H=d;var c=function(){O(a,b).then(function(a){d.resolve(a)},function(a){d.reject(a)})};f.then(c,c);return d}function T(a){var b=new cre$.promise.Promise("_loadWidgets"),d=s.isArray(a)&&0<a.length&&1===a[0].nodeType,f=H;H=b;s.isObject(a)&&a[p.itemSet.USERPROFILE]&&P(l.createUPStateSet(a[p.itemSet.USERPROFILE]));
var c=function(){if(s.isArray(a)&&0<a.length){for(var d=a.length;d--;)y.push(a[d]);O(a,!1).then(e,e)}else if(s.isObject(a)&&a.instanceData&&a.instanceData.length&&0<a.instanceData.length){for(var d=a.instanceData,c=d.length;c--;){var f=d[c];f.placement=f.domId;y.push(f)}O(a,!1).then(e,e)}else b.resolve([])},e=function(a){for(var c=[],e,f=[],h,k=a.length,E=function(){if(d||!h.getParentId())e=$(h).then(function(){var a=h.getModuleId();Z(p.event.topic.WIDGET_LOADED+a,a)}),c.push(e)};k--;){h=a[k];var u,
n,x=!1;for(n=y.length;0<n;){u=y.shift();if(h.getDomId()==u.placement){if(u.isAbandon){u.toPreloadState||h.changeState(D.INITIAL);x=!0;break}}else y.push(u);n--}if(!x)if((u=h.getFailedResources())&&0<u.length){for(var x=n="",l=0;l<u.length;l++)__logging.log("cre$.iRuntime","renderWidgets","fail to load ${0} for widget ${1}.",[u[l].url,h.getDefinition()],__logging.logLevel.WARNING),n+=u[l].type+"|",x+=u[l].url+" \n ";-1!==n.indexOf(cre$.constants.resource.resourceType.JAVASCRIPT)?(h.setState(D.ERROR),
h.setError({message:"can not load resources : "+x+" for widget "+h.getDefinition()}),f.push(h)):E()}else h.getState()===D.ERROR?f.push(h):E()}cre$.promise.whenAll.apply(cre$.promise,c).then(function(a){0<f.length?b.reject(f):b.resolve(a)},function(a){b.reject(a.concat(f))})};f.then(c,c);return b}function O(a,b){var d=new cre$.promise.Promise("_preload"),f=[],c=[],e,g,k=[],m={},r=function(a){for(var b=a.length;b--;){var d=a[b];d.getState()===D.INITIAL&&d.changeState(D.PRELOADED)}for(b=f.length;b--;)a.push(f[b]);
return a},h=function(a){var b=a.placement||a.id;if(b){var d=q[b];d?(a.instanceData?d.setLoadInstanceData(a.instanceData):d.removeLoadInstanceData(),f.push(q[b])):(m[a.definitionUrl+a.placement]=a,c.push(a))}else F.getWidgetMetadata(a.definitionUrl)||c.push(a)};if(s.isArray(a)){for(e=a.length;e--;)if(1===a[e].nodeType){g=l.getElementsByClass(a[e],p.others.IW_IWIDGET);for(var w=g.length;w--;)h(g[w])}else"string"===typeof a[e]?c.push(a[e]):(a[e].widgetRef&&(a[e].widgetRef.widgetRefInternal.getDomId(),
delete a[e].widgetRef),a[e].componentType===J.GADGET&&("undefined"!==typeof a[e].instanceData&&"function"===typeof a[e].instanceData.callback)&&(g=V(a[e].placement),null!==g&&(U[g]=a[e].instanceData.callback)),g=a[e].placement&&1===a[e].placement.nodeType?X(a[e]):a[e],h(g));0<c.length&&(k=cre$.xhr.xhrPost(Y(c)).then(function(a){delete a.xhr;return Q(a.data,!0,b,m)},function(a){delete a.xhr;for(var b=c.length,d=[];b--;)d.push({domId:c[b].placement||c[b].id,error:{message:"send xhr error.",code:a.data},
state:D.ERROR});return d}))}else k=Q(a,a.loadResource,b);cre$.promise.when(k).then(function(a){d.resolve(r(a))},function(a){d.reject(r(a))});return d}function B(a){if(s.isArray(a)&&0<a.length){for(var b=[],d=0;d<a.length;d++)b.push(a[d].getWidgetRef());return b}return a}var F=new cre$.WidgetMetadataRepos,q={},C={},k=[],R={},I=null,A=[],L=null,U={},M,H=cre$.promise.resolved(),s=cre$.util,N=Object.prototype.hasOwnProperty,l=cre$.internalutil,t=cre$.ResourceManager,m=getServiceManager(),p=cre$.constants,
J=p.componentType,S=p.iRuntime.pageData,G=p.iRuntime.field,z=p.request,D=p.state,y=[];l.registerEventHandler(window,"beforeunload",function(a){for(var b in q){var d=q[b],f=d.getIContext();if(f&&d.getState()===cre$.constants.state.LOADED&&f.canNavigateAway&&!f.canNavigateAway())return a.returnValue=cre$.LocaleHelper.getLocalizedMessages().LOG_NAVAIGATE_AWAY,""}});M={inIFrame:!1,init:function(a,b){if(!s.isObject(a))throw Error("[init]"+cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_PARAM_OBJ);
a.loadResource=b;a.containerToken&&l.setCREContainerToken(a.containerToken);return T(a)},loadWidgets:function(a){if(!s.isArray(a))throw Error("[loadWidgets]"+cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_PARAM_OBJ);var b=l.checkContainerToken(a).then(function(){return T(a)}),d=new cre$.promise.Promise("loadWidgets");b.then(function(a){d.resolve(B(a))},function(a){d.reject(B(a))});return d},preloadWidgets:function(a){if((!s.isObject(a)||!N.call(a,S.WIDGETMETADATA))&&!s.isArray(a))throw Error("[preloadWidgets]"+
cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_PARAM_OBJ);var b=new cre$.promise.Promise("preloadWidgets");0<a.length||a.widgetMetadata?l.checkContainerToken(a).then(function(){return aa(a,!0)}).then(function(a){b.resolve(B(a))},function(a){b.reject(B(a))}):(b=new cre$.promise.Promise("preloadWidgets"),b.rejected(a));return b},processResultArray:function(a){if(a instanceof Array||"array"===typeof a){for(var b=[],d=[],f=0;f<a.length;f++){var c=a[f];"object"===typeof c&&c.widgetRefInternal&&c.widgetRefInternal.getState()?
c.widgetRefInternal.getState()===c._stateConstants.ERROR?d.push(c):b.push(c):d.push(c)}a={};a.succ=b;a.fail=d;return a}throw Error("[processResultArray]"+cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_PARAM_OBJ);},commonContainerPreloadCallback:function(a){for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(C[b]={},a[b].error?(C[b].error=a[b].error,C[b].state=cre$.constants.state.ERROR):C[b]=a[b])},getCREServerUrl:cre$.config.getCREServerUrl,getStateSet:function(a,b,d){for(var f=!1,c=
{},e=k.length;e--;){var g=k[e];if(b===g.id){var m=g.widgetIds;if("*"===m[0]){f=!0;c=g;break}else for(var q=m.length;q--;)if(a===m[q]){f=!0;c=g;break}}}!f&&b===p.itemSet.USERPROFILE&&(e=t.makeProxyUrl(cre$.config.USERPROFILE_URL),g={},g[z.URL]=s.applyTokenToUrl(e,l.getCREContainerToken()),g[z.HEADERS]=l.getCREContainerToken()?{"X-Shindig-ST":l.getCREContainerToken().token}:{},cre$.xhr.xhrGet(g).then(function(a){delete a.xhr;a=l.parseToJson(a.data);k.push(l.createUPStateSet(a.userProfile))},function(a){delete a.xhr;
throw Error("[getStateSet]"+cre$.LocaleHelper.getLocalizedMessages().ERR_CANT_SET_USERPROFILE+"xhr.status: "+a.data);}));!f&&d&&(b==p.itemSet.ATTRIBUTES?(c=p.mode,c=new cre$.StateSetHierarchy(b,[c.CONFIG,c.EDIT,c.PERSONALIZE],{}),c.widgetIds=[a]):(c={id:b,widgetIds:[a],items:{}},c=s.mixin(c,d),c=new cre$.StateSet(c)),k.push(c));e=k.length;a=[];for(b={};e--;)if(c.definitionUrl&&k[e].definitionUrl===c.definitionUrl)if(k[e].sets.config._dirty){d=k[e].sets.config.items;b.config={};for(var r in d)d.hasOwnProperty(r)&&
(b.config[r]=d[r].value);b.config.stateSet=k[e].sets.config}else a.push(e);for(e=a.length;e--;)if(b.config){for(r in b.config)b.config.hasOwnProperty(r)&&(k[a[e]].setItemValue(r,b.config[r]),c.setItemValue(r,b.config[r]));c.sets.config=k[a[e]].sets.config=b.config.stateSet}return c},getShareableStateSet:function(a,b){for(var d=null,f=k.length;f--;){var c=k[f];if(!0===c.shareable&&!0!==c.global&&(b===c.id||b===c.alias)){var e=c.widgetIds;if("*"===e[0]){d=c;break}else for(var g=e.length;g--;)if(a===
e[g]){d=c;break}}}return d},getGlobalShareableStateSet:function(a){for(var b=!1,d=null,f=k.length;f--;){var c=k[f];if(!0===c.shareable&&!0===c.global&&(a===c.id||a===c.alias)){b=!0;d=c;break}}b||(d=new cre$.StateSet({id:a,shareable:!0,global:!0,items:{}}),k.push(d));return d},loadFeatures:function(a,b,d,f){var c=cre$.config.APP_VERSION;c&&(f||(f={}),f.ver=c);return t.loadFeatures(a,b,d,f)},isFeatureLoaded:t.isFeatureLoaded,getLoadedFeatures:t.getLoadedFeatures,makeProxyUrl:t.makeProxyUrl,getProxyUrl:function(){var a=
null,b,a=cre$.services.ServiceManager?getServiceManager().getService(cre$.services.PROXYSERVICE,!0):cre$.promise.rejected("Service Manager is not loaded.");a.then(function(a){b=a.getProxyUrl()},function(a){b=null});return b},unLoadWidgets:function(a,b){if(a&&!s.isArray(a))throw Error("[unLoadWidgets]"+cre$.LocaleHelper.getLocalizedMessages().ERR_INVALID_PARAM_TYPE);b="undefined"===typeof b?!0:b;var d=new cre$.promise.Promise("unLoadWidgets"),f=[],c=[],e,g,k=H;H=d;var p=function(){for(var a=f.length,
e;a--;)g=M.getWidgetIdByDomId(f[a].getDomId()),e=m.getService(f[a].getComponentType()).then(s.partial(function(a,b){return b.canUnload(a)},g)),c.push(e);cre$.promise.whenAll.apply(cre$.promise,c).then(function(){r(f,b)},function(){confirm(cre$.LocaleHelper.getLocalizedMessages().WARN_DATA_NOT_SAVED)?r(f,b):d.reject([])})},r=function(a,b){for(var c=a.length,e=[],f;c--;)f=m.getService(a[c].getComponentType()).then(cre$.util.partial(function(c,d){var e=a[c];d.unload(e.getModuleId(),b);return e},c)),
e.push(f);cre$.promise.whenAll.apply(cre$.promise,e).then(function(a){d.resolve(a)},function(a){d.reject(a)})};for(e in q)Object.prototype.hasOwnProperty.call(q,e)&&(g=this.getWidgetIdByDomId(e),(!a||l.contains(a,g)||l.contains(a,e))&&f.push(q[e]));if(a){var h,w,t,u=!1;for(e=a.length-1;0<=e;){unLoadId=a[e];for(unloadWidgetRefInternalIdx=f.length-1;0<=t;){h=f[t];h=h.getModuleId();if(unLoadId==h){u=!0;break}t--}if(!u)for(w=y.length-1;0<=w;)h=y[w],h.moduleId&&unLoadId==h.moduleId&&(h.isAbandon=!0,h.toPreloadState=
b),w--;e--}}else for(w=y.length-1;0<=w;)h=y[w],h.isAbandon=!0,h.toPreloadState=b,w--;k.then(p,p);var n=new cre$.promise.Promise("unLoadWidgets");d.then(function(a){n.resolve(B(a))},function(a){n.reject(B(a))});return n},registerWireLoadedCallbacks:function(a){for(var b=0,d=A.length;b<d;b++)if(A[b].id===a.id)return!1;A.push(a);return!0},removeWireLoadedCallbackById:function(a){for(var b=A.length;b--;)if(A[b].id===a)return A.splice(b,1),!0;return!1},getWidgetIdByDomId:function(a){var b=null;q[a]?b=
q[a].getModuleId():__logging.log("cre$.iRuntime","getWidgetIdByDomId",cre$.LocaleHelper.getLocalizedMessages().ERR_WIDGET_NOT_EXIST);return b},getWidgetMetadata:function(a){var b=F.getWidgetMetadata(a);return retPromise=b?b.content?cre$.promise.resolved(b):m.getService(b.componentType).then(function(b){return b.getMetadata(a)}):cre$.promise.rejected("Can not get metadata of a widget that is not preloaded.")},getWidgetById:function(a){var b=null,d;for(d in q){var f=q[d];a===f.getModuleId()&&(b=f.getWidgetRef())}return b},
initResourceRegistry:function(){},loadResources:t.loadResources,registerResource:t.registerResource,isResourceRegistered:t.isResourceRegistered,isResourceDownloaded:t.isResourceDownloaded,registerEndpoints:cre$.endpoint.registerEndpoints,removeEndpoint:cre$.endpoint.removeEndpoint,resolveEndpoint:cre$.endpoint.resolveEndpoint,config:cre$.config,getWires:function(){return I},_getGadgetLoadedCallbacks:function(){return U},getOAH:function(){return cre$.oah},getCommonContainer:function(){if(null===L)if(cre$.commoncontainer)L=
cre$.commoncontainer.getCommonContainer();else return __logging.log("cre$.iRuntime","getCommonContainer",cre$.LocaleHelper.getLocalizedMessages().ERR_CC_NOT_LOADED),cre$.promise.rejected(cre$.LocaleHelper.getLocalizedMessages().ERR_CC_NOT_LOADED);return L},setCommonContainer:function(a,b){L=m.getService(J.GADGET).then(function(d){return d.configCommonContainer(a,b)})},getWidgetRefInternals:function(){return q},getWidgetRefs:function(){return B(q)},getWidgetObjects:function(){return q},getWidgetMetadataRepos:function(){return F},
getStateSets:function(){return k},getServiceManager:cre$.services.getServiceManager};m.setService(cre$.services.EVENTSERVICE,"com.ibm.cre.EventService","cre.service.event");m.setService(cre$.services.PAGEPERSISTENCE,"com.ibm.cre.PagePersistenceService","cre.service.persistence.page");m.setService(cre$.services.WIDGETPERSISTENCE,"com.ibm.cre.WidgetPersistenceService","cre.service.persistence.widget");m.setService(cre$.services.WIREPERSISTENCE,"com.ibm.cre.WirePersistenceService","cre.service.persistence.wire");
m.setService(cre$.services.ITEMSETPERSISTENCE,"com.ibm.cre.ItemSetPersistenceService","cre.service.persistence.itemset");m.setService(cre$.services.PROXYSERVICE,"com.ibm.cre.ProxyService","cre.service.proxy");m.setService(cre$.services.JSONDATAFACTORYSERVICE,"com.ibm.cre.jsonDataFactory","cre.service.jsonData");m.setService(J.GADGET,"com.ibm.cre.osgadget.gadgetService","cre.osgadget");m.setService(J.IWIDGET,"com.ibm.cre.iwidget.iwidgetService","cre.iwidget");m.setService(cre$.services.IRUNTIME,M);
return M}());(function(){function m(a,d,c,g,e){var h=a._dirty;h||(a._dirty=!0);var b=a._change?a._change:{};b.id=d;e?h&&b.changeType&&b.changeType==f.NEW_ITEM?(a._dirty=!1,delete a._change):h?b.changeType=f.REMOVED_ITEM:(a._change.changeType=f.REMOVED_ITEM,a._change.oldVal=c):(h&&b.changeType?(b.changeType!=f.NEW_ITEM&&(b.changeType=f.UPDATED_VALUE),b.newVal=g):(b.changeType=f.NEW_ITEM,"undefined"!==typeof c&&null!==c&&(b.oldVal=c,b.changeType=f.UPDATED_VALUE),"undefined"!==typeof g&&null!==g&&(b.newVal=g)),a._change=
b)}var n=Object.prototype.hasOwnProperty,p=cre$.constants,f=p.changeType;cre$.StateSetPrototype=function(){this.addListener=function(a,d){var c;"undefined"==typeof count?count=0:count++;c=count;var g=cre$.util;this.listeners[c]=function(c){c.payload||(c={name:f.ON_STATESET_CHANGED,type:null,payload:c,source:null});var b=c.payload,l=c.name;if(!(l===cre$.constants.itemSet.ONITEMSETCHANGED||l===f.ON_STATESET_CHANGED)||b&&b.changes&&0<b.changes.length){if(g.isString(a)){b=this.widgetIds?this.widgetIds[0]:
null;d&&(b=d);var l=a,k=window["_"+b+"_"+l];"undefined"==typeof k&&(widgetScope=window["_"+b+"_iContext"].iScope())&&widgetScope[l]&&(k=widgetScope);if("undefined"==typeof k||null===k)k=window[l];b="undefined"==typeof k||null===k?null:k;b&&(a=g.hitch(b,a))}g.isFunction(a)&&g.partial(a)(c)}};return c};this.getListeners=function(){return!this.listeners?null:this.listeners};this.removeListener=function(a){return this.listeners[a]?(delete this.listeners[a],!0):!1}};cre$.StateSet=function(a){this.listeners=
{};for(var d in a)n.call(a,d)&&(this[d]=cre$.util.clone(a[d]));n.call(this,f.ON_STATESET_CHANGED)&&this.addListener(this.onStateSetChanged)};var b=cre$.StateSet;b.prototype=new cre$.StateSetPrototype;b.prototype.getItemValue=function(a){if(!(a in this.items))return null;a=this.items[a].getValue();return a==f.DELETE_TOKEN?null:a};b.prototype.getLocalizedItemValue=function(a,d){if(a&&d){if(!(a in this.items))return null;var c=this.items[a].getLocalValue(d);return c==f.DELETE_TOKEN?null:c}};b.prototype.setItemValue=
function(a,d){if(!a||"undefined"==typeof d||null===d)return null;var c={};if(a in this.items){var g=this.items[a];if(g.isReadOnly())throw"The specified item ["+a+"] is readOnly!";c=g.value;g.value=d;m(g,a,c,d);g._dirty&&(this._dirty=!0,this.parent&&(this.parent._dirty=!0))}else c={},c.id=a,c.value=d,this.items[a]=new cre$.StateItem(c),m(c,a,null,d),c._dirty&&(this._dirty=!0,this.parent&&(this.parent._dirty=!0));return this};b.prototype.setLocalizedItemValue=function(a,d,c){if(!a||!d)return null;var g=
{},e={},e=cre$.util,b=null;c.replace(/-/g,"_");if(a in this.items){b=this.items[a];if(b.isReadOnly())throw"The specified item ["+a+"] is readOnly!";b.alt&&(g=e.clone(b.alt));b.setLocalValue(d,c);e=e.clone(b.alt);m(b,a,g,e);b._dirty&&(this._dirty=!0,this.parent&&(this.parent._dirty=!0));return this}b={};b.id=a;b.setLocalValue(d,c);this.items[a]=new cre$.StateItem(b);e=e.clone(b.alt);m(b,a,null,e);b._dirty&&(this._dirty=!0,this.parent&&(this.parent._dirty=!0));return this};b.prototype.removeItemValue=
function(a){this.removeLocalizedItemValue(a,"")};b.prototype.removeLocalizedItemValue=function(a,d){d||(d="");var c=d.replace(/-/g,"_"),b=!1;if(a in this.items){var e=this.items[a];if(e._dirty){var h=e._change?e._change:{};if(h.changeType===f.REMOVED_ITEM)return null;h.changeType==f.NEW_ITEM?(""===c&&(e.value&&e.value!=f.DELETE_TOKEN)&&(delete this.items[a].value,e._change.newVal[""]&&delete e._change.newVal[""],b=!0),""!=c&&e.getLocalValue(c)&&(e.deleteLocalValue(c),e._change.newVal[c]&&delete e._change.newVal[c],
b=!0)):(""==c&&(e.value&&e.value!=f.DELETE_TOKEN)&&(delete e.value,e._change.newVal[""]&&delete e._change.newVal[""],b=!0),e.getLocalValue(c)&&(e.deleteLocalValue(c),e._change.newVal[c]&&delete e._change.newVal[c],b=!0))}else""==c&&e.value?(e._change={id:a,changeType:f.REMOVED_ITEM,oldVal:e.getValue()},delete e.value):(e._change={id:a,changeType:f.REMOVED_ITEM,oldVal:e.getLocalValue(c)},e.deleteLocalValue(c)),b=e._dirty=!0}return b?(this._dirty=!0,this.parent&&(this.parent._dirty=!0),this):null};
b.prototype.removeItem=function(a){var d={},d=!1;if(a in this.items){d=this.items[a];if(d.isReadOnly())throw"The specified item ["+a+"] is readOnly!";if(d._dirty){d.value=f.DELETE_TOKEN;d=d._change?d._change:{};if(d.changeType==f.NEW_ITEM)return delete this.items[a],this;d.changeType=f.REMOVED_ITEM}else d._change={changeType:f.REMOVED_ITEM,itemName:a,oldVal:d.getValue()},d.value=f.DELETE_TOKEN,d._dirty=!0;d=!0}return d?(this._dirty=!0,this.parent&&(this.parent._dirty=!0),this):null};b.prototype.getAllItemNames=
function(){var a=[],d;for(d in this.items)n.call(this.items,d)&&a.push(d);return a};b.prototype.getItem=function(a){return!(a in this.items)?null:this.items[a]};b.prototype._setItemDirty=function(a,d){a&&this.items[a]&&(this.items[a]._dirty=d,"undefined"!=typeof d&&!d&&(delete this.items[a]._dirty,delete this.items[a]._change),this.items[a].value&&this.items[a].value==f.DELETE_TOKEN&&delete this.items[a].value,"undefined"==typeof this.items[a].value&&delete this.items[a])};cre$.StateSetHierarchy=
function(a,d,c){this.id=a;this.computed=new cre$.StateSet({id:a,items:{}});this.computed.parent=this;this.levelDef=d;this.sets={};this.listeners={};for(d=this.levelDef.length;d--;){var b=this.levelDef[d],e=c[b];e||(e={id:a,items:{}});e=new cre$.StateSet(e);e.mode=b;e.parent=this;this.sets[b]=e;for(var f in e.items)this.computed.items.hasOwnProperty(f)||(this.computed.items[f]=cre$.util.clone(e.items[f]))}this.getListeners=function(){var a=this.listeners?this.listeners:{},d;for(d in this.sets)cre$.util.mixin(a,
this.sets[d].listeners);return a}};b=cre$.StateSetHierarchy;b.prototype=new cre$.StateSetPrototype;b.prototype.setItemValue=function(a,d,c){var b=this.levelDef.length;if(c){for(var e=0;e<b&&c!=this.levelDef[e];e++);e==b&&(c=this.levelDef[b-1])}else c=this.levelDef[b-1];if(this.isReadOnly(a,c))throw"The specified item ["+a+"] is readOnly!";this.sets[c].setItemValue(a,d);for(d=this.levelDef.length;d--;)if(c=this.sets[this.levelDef[d]].getItem(a)){this.computed.setItemValue(a,c.getValue());break}return this};
b.prototype.getItemValue=function(a,d,c){if(d){if(!0===c||p.others.TRUE==c)return this.sets[d].getItemValue(a);c=!1;for(var b=null,e=this.levelDef.length;e--;)if(this.levelDef[e]==d&&(c=!0),c&&(b=this.sets[this.levelDef[e]].getItem(a))&&b.getValue()!=f.DELETE_TOKEN)return b.getValue();return!c?this.computed.getItemValue(a):null}return this.computed.getItemValue(a)};b.prototype.removeItem=function(a,d){var c=this.levelDef.length,b;if(d){for(b=0;b<c&&d!=this.levelDef[b];b++);b==c&&(d=this.levelDef[c-
1])}else d=this.levelDef[c-1];if(this.isReadOnly(a,d))throw"The specified item ["+a+"] is readOnly!";c=null;this.sets[d].removeItem(a);for(b=this.levelDef.length;b--;)if((c=this.sets[this.levelDef[b]].getItem(a))&&c.getValue()!=f.DELETE_TOKEN){this.computed.setItemValue(a,c.getValue());break}(null===c||c.getValue()==f.DELETE_TOKEN)&&this.computed.removeItem(a);return this};b.prototype.getAllItemNames=function(a){return a?this.sets[a].getAllNames():this.computed.getAllItemNames()};b.prototype.isReadOnly=
function(a,b){for(var c=!1,f=b?!1:!0,e=this.levelDef.length;e--;)if(!f&&this.levelDef[e]==b&&(f=!0),f){var h=this.sets[this.levelDef[e]].getItem(a);h&&h.isReadOnly()&&(c=!0)}return c};b.prototype.getItem=function(a){return this.computed.getItem(a)};b.prototype.clone=function(){};cre$.StateItem=function(a){for(var b in a)n.call(a,b)&&(this[b]=a[b])};b=cre$.StateItem;b.prototype.getName=function(){return this.id};b.prototype.getValue=function(){return this.value};b.prototype.isReadOnly=function(){var a=
!1,b=this.readOnly;"boolean"===typeof b&&(a=b);"string"===typeof b&&b===p.others.TRUE&&(a=!0);return a};b.prototype.getLocalsWithValues=function(){if(!this.alt)return null;var a=[];this.value&&a.push("");for(var b=this.alt.length;b--;){var c=this.alt[b];c.value&&c.lang&&a.push(c.lang)}return a};b.prototype.getLocalValue=function(a){if(!this.alt)return null;for(var b=this.alt.length;b--;){var c=this.alt[b];if(a===c.lang)return c.value}return null};b.prototype.deleteLocalValue=function(a){if(!this.alt)return null;
for(var b=this.alt.length;b--;){var c=this.alt[b];a===c.lang&&delete c.value}return null};b.prototype.setLocalValue=function(a,b){if(!this.alt)return null;for(var c=this.alt.length;c--;){var f=this.alt[c];if(b===f.lang)return f.value=a,this}return null}})();cre$.WidgetParser={parse:function(n,k){if(cre$.constants.componentType.IWIDGET===n.getComponentType())return cre$.IWidgetParser.parse(n,k);if(cre$.constants.componentType.GADGET===n.getComponentType())return cre$.OSGadgetParser.parse(n,k)}};
cre$.IWidgetParser=function(){function n(a,h,b,e,d){a.shareable=a["private"]===q.others.FALSE?!0:!1;if(a.shareable){for(var g=!1,c=e.length;c--;){var f=e[c],l=a.alias||a.id;if(!0===f.global&&f.shareable&&(l===f.id||l===f.alias)){g=!0;break}}g||e.push(s(a,h,b))}e.push(t(a,h,b,d))}function k(a){var h={id:a.id,items:{}};if(a.item)for(var b=a.item.length;b--;){var e=a.item[b],d=new cre$.StateItem(cre$.util.clone(e));h.items[e.id]=d}a.mode&&(h.mode=a.mode);a.itemSetId&&(h.itemSetId=a.itemSetId);return new cre$.StateSet(h)}
function t(a,h,b,e){var d=null,g;if(a.id===q.itemSet.IDESCRIPTOR)d=k(a);else if(a.id===q.itemSet.ATTRIBUTES){for(var c={},f,d=b.length;d--;)f=b[d],f.mode=f.mode||p.PERSONALIZE,c[f.mode]=k(f);c.config||(c.config=k(a));d=new cre$.StateSetHierarchy(a.id,[p.CONFIG,p.EDIT,p.PERSONALIZE],c);d.definitionUrl=e;c[p.PERSONALIZE]&&c[p.PERSONALIZE].itemSetId&&(d.itemSetId=c[p.PERSONALIZE].itemSetId)}else{e=cre$.util.clone(a);var c=e.item,l;f={};for(d=b.length;d--;){l=b[d].item;for(g=l.length;g--;)f[l[g].id]=
l[g].value}if(void 0!==c&&null!==c)for(d=c.length;d--;)b=c[d],b.readOnly===q.others.FALSE&&void 0!==f[b.id]&&(b.value=f[b.id]);d=k(e)}d.id=a.id;d.shareable=a.shareable;d.alias=a.alias;a.onItemSetChanged&&d.addListener(a.onItemSetChanged,h);d.widgetIds=[h];return d}function s(a,h,b){b=k(a);var e=a.alias||a.id;b.id=e;b.shareable=!0;b.global=!0;b.alias=e;a.onItemSetChanged&&b.addListener(a.onItemSetChanged,h);b.widgetIds=["*"];return b}function r(a,h){var b=[];if(a)for(var e=a.length;e--;){var d=a[e];
d.id===h&&b.push(d)}return b}var q=cre$.constants,p=q.mode;return{parse:function(a,h){if(a&&a.getWidgetMetadata()){a.getWidgetItemSet()||a.setWidgetItemSet({});var b=a.getWidgetItemSet(),e=a.getInstanceItemSet(),d=a.getModuleId(),g=b.length,c,f=a.getLoadInstanceData(),l;"undefined"!==typeof f&&null!==f&&(l=f.itemSet);var m=null;c=!1;f=[];for(c=m=null;g--;)c=b[g],m=r(l,c.id),0===m.length&&(m=r(e,c.id)),f.push(c.id),n(c,d,m,h,a.getDefinition());if(e)for(b=e.length;b--;){var k=e[b];c=!1;for(g=f.length;g--;)if(m=
f[g],k.id===m){c=!0;break}c||(g=[],m=r(l,k.id),0===m.length&&(m=r(e,k.id)),f.push(k.id),c={},c.id=k.id,n(c,d,m,h,a.getDefinition()))}if(l)for(e=l.length;e--;){b=l[e];c=!1;for(g=f.length;g--;)if(m=f[g],b.id===m){c=!0;break}c||(g=[],g.push(b),c={},c.id=b.id,n(c,d,g,h,a.getDefinition()))}}return h}}}();cre$.OSGadgetParser=function(){return{parse:function(n){return new cre$.StateSet}}}();cre$.WidgetEvent=function(a){this.name=a.name;this.type=a.type;this.isHandled=a.isHandled;this.isPublished=a.isPublished;this.description=a.description};cre$.EventService=function(){this.isManagedHub=cre$.oah.isManagedHub;this.managedHub=cre$.oah.managedHub};
cre$.EventService.prototype={fireEvent:function(a,d,b,c,e){(a=window["_"+a+"_iContext"])&&a.iEvents.fireEvent(d,c,b)},broadcastEvent:function(a,d,b,c,e,f,h){var g={};g.targetEvent=a;g.payload=d;g.payloadType=b;this.broadcastEvents([g],c,e,f,h)},broadcastEvents:function(a,d,b,c,e){d=a.length;for(b=0;b<d;b++){c=a[b];var f={};f.name=c.targetEvent;f.payload=c.payload;f.type=c.payloadType;this.publishEvent(c.targetEvent,f);e&&(f=cre$.iRuntime.getWires())&&f.addQueuedEvent(null,c.targetEvent,{payload:c.payload,
payloadType:c.payloadType})}},publishEvent:function(a,d,b,c){this.isManagedHub?(b=this.managedHub.getInlineHubClient(c))&&("undefined"===typeof d||null===d?b.publish(a):b.publish(a,d)):OpenAjax.hub.publish(a,d)},subscribeEvent:function(a,d,b,c){var e;return this.isManagedHub?this.managedHub.getInlineHubClient(c).subscribe(a,function(a,c,g){e=b;d&&b&&(e=cre$.util.hitch(d,b));e&&e(c)},null,function(b,a,c){}):OpenAjax.hub.subscribe(a,function(a,c){d&&b&&(e=cre$.util.hitch(d,b));e&&e(c)})},unsubscribeEvent:function(a,
d){if(a)if(this.isManagedHub){var b=this.managedHub.getInlineHubClient(d);try{b&&b.unsubscribe(a)}catch(c){}}else OpenAjax.hub.unsubscribe(a)}};cre$.EventService&&getServiceManager().setService(cre$.services.EVENTSERVICE,new cre$.EventService);cre$.IfrEventService=function(){this.queuedSubEvents=[];this.queuedPubEvents=[];this.queuedBroadcastEvents=[];this.queuedUnsubEvents=[];this.isManagedHub=cre$.oah.isManagedHub;this.managedHub=cre$.oah.managedHub;this.hubClient=this.createIframeHubClient()};
cre$.IfrEventService.prototype={createIframeHubClient:function(){if(this.hubClient)return this.hubClient;var a=new OpenAjax.hub.IframeHubClient({HubClient:{onSecurityAlert:function(b,a){}}}),b=this;a.connect(function(a,g,d){b.hubClient=a;for(var c in b.queuedSubEvents)Object.prototype.hasOwnProperty.call(b.queuedSubEvents,c)&&(a=b.queuedSubEvents[c],b.subscribeEvent.apply(b,a));for(c in b.queuedPubEvents)Object.prototype.hasOwnProperty.call(b.queuedPubEvents,c)&&(a=b.queuedPubEvents[c],b.publishEvent.apply(b,
a));for(c in b.queuedBroadcastEvents)Object.prototype.hasOwnProperty.call(b.queuedBroadcastEvents,c)&&(a=b.queuedBroadcastEvents[c],b.broadcastEvents.apply(b,a));for(c in b.queuedUnsubEvents)Object.prototype.hasOwnProperty.call(b.queuedUnsubEvents,c)&&(a=b.queuedUnsubEvents[c],b.unsubscribeEvent.apply(b,a))});this.hubClient=a},fireEvent:function(a,b,f,g,d){(a=window["_"+a+"_iContext"])&&a.iEvents.fireEvent(b,g,g)},broadcastEvent:function(a,b,f,g,d,c){var e={};e.targetEvent=a;e.payload=b;e.payloadType=
f;this.broadcastEvents([e],g,d,c)},broadcastEvents:function(a,b,f,g){if(this.hubClient)for(var d=a.length,c=0;c<d;c++){var e=a[c],h={};h.name=e.targetEvent;h.payload=e.payload;h.type=e.payloadType;this.publishEvent(e.targetEvent,h);(h=cre$.iRuntime.getWires())&&h.addQueuedEvent(null,e.targetEvent,{payload:e.payload,payloadType:e.payloadType})}else this.queuedBroadcastEvents.push(arguments)},publishEvent:function(a,b,f,g){this.hubClient?this.hubClient&&("undefined"===typeof b||null===b?this.hubClient.publish(a):
this.hubClient.publish(a,b)):this.queuedPubEvents.push(arguments)},subscribeEvent:function(a,b,f,g,d){if(this.hubClient){var c=null;this.hubClient&&(c=this.hubClient.subscribe(a,function(a,c,d){a=f;b&&f&&(a=cre$.util.hitch(b,f));a&&a(c)},null,function(a,c,f){b&&d&&(d=cre$.util.hitch(b,d));d&&d.apply(this,[a,c,f])}));return c}this.queuedSubEvents.push(arguments)},unsubscribeEvent:function(a,b){if(this.hubClient){if(a)try{this.hubClient&&this.hubClient.unsubscribe(a)}catch(f){}}else this.queuedUnsubEvents.push(arguments)}};cre$.Wire=function(a,b){this.isManagedHub=!0;"undefined"!==typeof a&&!a&&(this.isManagedHub=!1);this.wires=[];this._createWireDelegators=[];this._newWireCallbacks=[];this._removeWireCallbacks=[];this._widgetRefInternals={};this._managedHub=b;this._queuedEvents=[]};
cre$.Wire.prototype={init:function(a){this._widgetRefInternals=a;if(this.isManagedHub)for(var b in this._widgetRefInternals)Object.prototype.hasOwnProperty.call(this._widgetRefInternals,b)&&(a=this._widgetRefInternals[b].instanceMetaData)&&a.moduleId&&this._verifyHubClientCreated(a.moduleId)},createWire:function(a,b,d,c){var e=null,f=null,h=cre$.constants.event;if(this._isWireExist(a,b,d,c))return cre$.promise.resolved();if(cre$.iRuntime.inIFrame||this._isCompatible(a,b,d,c)){this._verifyHubClientCreated(a);
this._verifyHubClientCreated(d);var g=this.getCreateWireDelegator(d);g?e=g.object[g.createWireDelegator].call(g.object,a,b,d,c):f=cre$.promise.rejected("target widget not ready, can't create wire!")}e&&(f=cre$.util.hitch(this,function(e){if(e){this.wires.push(e);var f=getServiceManager().getService(cre$.services.EVENTSERVICE),g={};cre$.iRuntime.inIFrame?f.then(function(a){g[h.payload.METHODNAME]="_syncWiresDone";g[h.payload.PARAMS]=[e];a.publishEvent("sync_"+d,g)}):f.then(function(a){g[h.payload.METHODNAME]=
"_syncWiresCreated";g[h.payload.PARAMS]=[e];a.publishEvent(h.topic.BROADCAST_WIRES_CHANGE,g)})}this.invokeOnNewWire(a,b,d,c);for(var k in this._widgetRefInternals)if(this._widgetRefInternals[k].instanceMetaData&&this._widgetRefInternals[k].instanceMetaData.moduleId===d){if(this._widgetRefInternals[k].instanceMetaData.receivedEvents){f=this._widgetRefInternals[k].instanceMetaData.receivedEvents;k=this._widgetRefInternals[k].instanceMetaData.receivedEvents.length;for(var p=!1,l=0;l<k;l++){var m=f[l];
m.sourceEvent===b&&(m.sourceWidget===a&&m.targetEvent===c)&&(p=!0)}p||f.push({sourceWidget:a,sourceEvent:b,targetEvent:c})}else this._widgetRefInternals[k].instanceMetaData.receivedEvents=[{sourceWidget:a,sourceEvent:b,targetEvent:c}];break}}),f=e.then(f));return f},invokeOnNewWire:function(a,b,d,c){for(var e=this._newWireCallbacks.length,f=0;f<e;f++){var h=this._newWireCallbacks[f],g=h.object,n=h.callback;(h.widgetId===a&&h.eventId===b||h.widgetId===d&&h.eventId===c)&&"function"===typeof g[n]&&g[n].call(g,
{targetWidget:d,targetEvent:c,sourceWidget:a,sourceEvent:b})}},updateWire:function(a){for(var b=this.wires.length,d=0;d<b;d++){var c=this.wires[d];if(c&&this._matched(c,a.sourceWidget,a.sourceEvent,a.targetWidget,a.targetEvent))break}},removeWire:function(a,b,d,c){for(var e=null,f=this.wires.length,h=0;h<f;h++){var g=this.wires[h];if(g&&this._matched(g,a,b,d,c)){e=g;break}}this._removeWire(e)},removeWireBySourceWidget:function(a){this.removeQueuedEvent(a);var b=this.wires.length;if(0<b)for(;b--;){var d=
this.wires[b];d&&d.sourceWidget===a&&this._removeWire(d)}},removeWireByTargetWidget:function(a){var b=this.wires.length;if(0<b)for(;b--;){var d=this.wires[b];d&&d.targetWidget===a&&this._removeWire(d)}},_verifyHubClientCreated:function(a){var b=cre$.iRuntime.getWidgetRefInternals(),d=cre$.constants.componentType.IWIDGET,c=null,e;for(e in b)if(b[e].componentType===d&&b[e].getModuleId()===a){c=b[e];break}c&&(c.getComponentType()===d&&c.getRenderType()!==cre$.constants.renderType.SANDBOX)&&!this._managedHub._getInlineHubClient(a)&&
(this._managedHub.createInlineHubContainer(a),this._managedHub.createInlineHubClient(a))},_removeWire:function(a){var b=this.wires.length,d=cre$.constants.event;if(a){var c=getServiceManager().getService(cre$.services.EVENTSERVICE);if(a.wireId){c.then(cre$.util.partial(function(a,b){b.unsubscribeEvent(a.wireId)},a));for(var c=this._removeWireCallbacks.length,e=0;e<c;e++){var f=this._removeWireCallbacks[e].object,h=this._removeWireCallbacks[e].callback;(this._removeWireCallbacks[e].widgetId===a.sourceWidget&&
this._removeWireCallbacks[e].eventId===a.sourceEvent||this._removeWireCallbacks[e].widgetId===a.targetWidget&&this._removeWireCallbacks[e].eventId===a.targetEvent)&&"function"===typeof f[h]&&f[h].call(f,{targetWidget:a.targetWidget,targetEvent:a.targetEvent,sourceWidget:a.sourceWidget,sourceEvent:a.sourceEvent})}for(var g in this._widgetRefInternals)if(c=this._widgetRefInternals[g],c.getModuleId()===a.targetWidget){if(g=c.getReceivedEvents())for(c=g.length;c--;)if(e=g[c],e.sourceEvent===a.sourceEvent&&
e.sourceWidget===a.sourceWidget&&e.targetEvent===a.targetEvent){g.splice(c,1);break}break}for(;b--;)this.wires[b]===a&&this.wires.splice(b,1)}else for(c.then(cre$.util.partial(function(a,b,c){var e={};e[d.payload.METHODNAME]="_syncRemoveWire";e[d.payload.PARAMS]=b;c.publishEvent(a,e)},cre$.iRuntime.inIFrame?d.topic.SYNC+a.targetWidget:d.topic.STUB_SYNC+a.targetWidget,[a]));b--;)this.wires[b]===a&&(this.wires.splice(b,1),cre$.iRuntime.inIFrame||c.then(function(b){var c={};c[d.payload.METHODNAME]="_syncWiresRemoved";
c[d.payload.PARAMS]=[a];b.publishEvent(d.topic.BROADCAST_WIRES_CHANGE,c)}))}},getWireByTargetWidget:function(a){for(var b=[],d=this.wires.length,c=0;c<d;c++){var e=this.wires[c];e&&e.targetWidget===a&&b.push(e)}return b},_isWireExist:function(a,b,d,c){for(var e=this.wires.length,f=0;f<e;f++)if(this._matched(this.wires[f],a,b,d,c))return this.wires[f];return null},_matched:function(a,b,d,c,e){return a.sourceWidget===b&&a.sourceEvent===d&&a.targetWidget===c&&a.targetEvent===e},_getWidgetRefInternal:function(a){for(var b in this._widgetRefInternals)if(this._widgetRefInternals[b].getModuleId()===
a)return this._widgetRefInternals[b];return null},_findEventObj:function(a,b){var d,c,e=b.getEvent();if(e){d=e.length;for(c=0;c<d;c++){var f=e[c];if(f.id===a)return f}}if(e=b.getDynamicEvents()){d=e.length;for(c=0;c<d;c++)if(f=e[c],f.name===a)return f}return null},_findEventPayload:function(a,b){var d,c;if(a.eventDescName){var e=b.widgetMetadata.eventDescription;d=e.length;for(c=0;c<d;c++){var f=e[c];if(f.id===a.eventDescName)return f.payloadType}}else if(a.name)return a.type;return null},_isCompatible:function(a,
b,d,c){a=this._getWidgetRefInternal(a);d=this._getWidgetRefInternal(d);return a&&d?!this._findEventObj(c,d)?!1:!0:!1},_isRegistered:function(a,b,d){for(var c=d.length,e=0;e<c;e++){var f=d[e];if(f.widgetId===a&&f.eventId===b)return!0}return!1},_isDelegatorRegistered:function(a,b){for(var d=b.length,c=0;c<d;c++)if(b[c].widgetId===a)return!0;return!1},registerNewWireCallback:function(a,b,d,c){this._isRegistered(a,b,this._newWireCallbacks)||this._newWireCallbacks.push({widgetId:a,eventId:b,callback:d,
object:c})},registerRemoveWireCallback:function(a,b,d,c){this._isRegistered(a,b,this._removeWireCallbacks)||this._removeWireCallbacks.push({widgetId:a,eventId:b,callback:d,object:c})},getCreateWireDelegator:function(a){for(var b=this._createWireDelegators.length;b--;){var d=this._createWireDelegators[b];if(d.widgetId===a)return d}return null},registerCreateWireDelegators:function(a,b,d){this._isDelegatorRegistered(a,this._createWireDelegators)||this._createWireDelegators.push({widgetId:a,createWireDelegator:b,
object:d})},removeWireDelegator:function(a){for(var b=this._createWireDelegators.length;b--;)if(this._createWireDelegators[b].widgetId===a)return this._createWireDelegators.splice(b,1),!0;return!1},addQueuedEvent:function(a,b,d){var c=this._queuedEvents.length;null===a&&(a="broadcast");for(var e=0;e<c;e++){var f=this._queuedEvents[e];if(f.widgetId===a&&f.eventId===b){f.payload=d;return}}this._queuedEvents.push({widgetId:a,eventId:b,payload:d})},removeQueuedEvent:function(a){var b=this._queuedEvents.length;
if(0<b)for(;b--;)(!a||this._queuedEvents[b].widgetId===a)&&this._queuedEvents.splice(b,1)}};void 0==cre$.constants.iWidget&&(cre$.constants.iWidget={});cre$.constants.iWidget.ISCOPETYPES={dojoAMD:"_dojoAMDWrapper"};
(function(){void 0==cre$.iwidget.iwidgetService&&(cre$.iwidget.iwidgetService=function(){});cre$.iwidget.iscopeService=function(){};cre$.iwidget.iscopeService.prototype._dojoAMDWrapper=function(c){var d=new cre$.promise.Promise("_dojoAMDWrapper");window.require?(c=c.replace(/\./g,"/"),require([c,"dojo"],function(a,c){var b;cre$.util.isFunction(a)?b=new a:(__logging.log("cre$.iwidget.iscopeService","_dojoAMDWrapper",cre$.LocaleHelper.getLocalizedMessages().ERR_CREATE_ISCOPE),b={});d.resolve(b)})):
(__logging.log("iscopeService.","_dojoAMDWrapper","Dojo is not loaded"),d.resolve({}));return d};cre$.iwidget.iscopeService.prototype.makeInstance=function(c,d){var a=new cre$.promise.Promise("makeInstance"),e=cre$.constants.iWidget.ISCOPETYPES[c];e?this[e].call(this,d).then(function(b){a.resolve(b)},function(b){a.reject(b)}):a.resolve({});return a}})();cre$.constants.iWidget=cre$.constants.iWidget||{};cre$.constants.iWidget.ISCOPESERVICE="com.ibm.cre.iwidget.iscopeService";getServiceManager().setService(cre$.constants.iWidget.ISCOPESERVICE,cre$.constants.iWidget.ISCOPESERVICE,"cre.iwidget.iscopeService");cre$.iwidget.internalutil=cre$.iwidget.internalutil||{};
(function(){function n(a,b){return-1!==a.indexOf(b,a.length-b.length)}var c=cre$.iwidget.internalutil,p=Object.prototype.hasOwnProperty;c._handleEvent=function(a){var b=a.scope;b||(b=this);var d=a.methodname;d&&(b[d]&&cre$.util.isFunction(b[d]))&&b[d].apply(b,a.params||[])};c._handleDataSync=function(a){a.id===this.constants.ATTRIBUTES?(this._syncAttr(a),this.getiWidgetAttributes().commit(null,!0)):a.id===this.constants.IDESCRIPTOR&&(this._synciDescriptor(a),this.getiDescriptor().commit(null,!0))};
c._syncAttr=function(a){var b=this.getiWidgetAttributes()._stateSet,d=null,e=null,f=null,c;for(c in a.sets)if(Object.prototype.hasOwnProperty.call(a.sets,c))for(d in a.sets[c].items)if(Object.prototype.hasOwnProperty.call(a.sets[c].items,d)){var e=a.sets[c].items[d],g=e.readOnly?e.readOnly:!1;(f=e.value)&&f===cre$.constants.changeType.DELETE_TOKEN?b.removeItem(e.id,c):void 0===f?b.removeItemValue(e.id,c):g||b.setItemValue(e.id,f,c)}};c._synciDescriptor=function(a){var b=this.getiDescriptor(),d=null,
e=null;for(d in a.items)Object.prototype.hasOwnProperty.call(a.items,d)&&((e=a.items[d])&&e===cre$.constants.changeType.DELETE_TOKEN?b.removeItem(d):b.setItemValue(d,e))};c._syncCreateWire=function(a){this._iRuntime.getWires().createWire(a.sourceWidget,a.sourceEvent,a.targetWidget,a.targetEvent)};c._syncRemoveWire=function(a){this._iRuntime.getWires().removeWire(a.sourceWidget,a.sourceEvent,a.targetWidget,a.targetEvent)};c._syncCreateEvent=function(a){this._isWrapperContext&&this.iEvents.setEvent(a)};
c._syncCreateEvents=function(a){this._isWrapperContext&&this.iEvents.setEvents(a)};c._syncRemoveEvent=function(a){this._isWrapperContext&&this.iEvents.removeEvent(a)};c._syncRemoveEvents=function(a){this._isWrapperContext&&this.iEvents.removeEvents(a)};c._syncWiresCreated=function(a){for(var b=!1,d=this._iRuntime.getWires().wires,e=d.length,f=0;f<e;f++)if(d[f].sourceWidget===a.sourceWidget&&d[f].sourceEvent===a.sourceEvent&&d[f].targetWidget===a.targetWidget&&d[f].targetEvent===a.targetEvent){b=!0;
break}b||this._iRuntime.getWires().wires.push(a)};c._syncWiresDone=function(a){this._iRuntime.getWires().invokeOnNewWire(a.sourceWidget,a.sourceEvent,a.targetWidget,a.targetEvent)};c._syncWiresRemoved=function(a){var b=this._iRuntime.getWires().wires;if(b&&b.length)for(var d=b.length;d--;){var e=b[d];if(e&&e.sourceWidget===a.sourceWidget&&e.sourceEvent===a.sourceEvent&&e.targetWidget===a.targetWidget&&e.targetEvent===a.targetEvent){b.splice(d,1);break}}};c._getIframeUrl=function(){var a=cre$.config.getCREServerUrl();
!0===this._widgetRefInternal.isHashedDomain()&&(a=0===a.indexOf("http")?a.replace("://","://"+this._widgetRefInternal.getHashedDomainURL()+"."):this._widgetRefInternal.getHashedDomainURL()+"."+a);var b=a+cre$.config.SANDBOXWIDGETS_URL+"?wid\x3d"+this.getWidgetId()+"\x26domId\x3d"+this._widgetRefInternal.getDomId()+"\x26locale\x3d"+cre$.LocaleHelper.getLocale()+"\x26container\x3d"+cre$.config.CONTAINER;this._widgetRefInternal.isHashedDomain()&&(b=b+"\x26hashedDomain\x3d"+this._widgetRefInternal.isHashedDomain());
var d=!this._metadata.resource?0:this._metadata.resource.length,e=/dojo(\.xd)?\.js(\W|$)/i,f,c,g;for(f=0;f<d;f++)if(c=this._metadata.resource[f].uri,g=c.match(e)){a=window.encodeURIComponent(a+"/common/proxy/"+this.getWidgetId()+"?url\x3d"+this._buildAbsoluteUrl(c));b=b+"\x26dojouri\x3d"+a;break}cre$.config.isDebug&&(b+="\x26debug\x3d1");return b};c._getMarkupByMode=function(a){a=this._metadata.allowInstanceContent?this._instanceData.content&&this._instanceData.content[0][a]?this._instanceData.content[0][a]:
this._metadata.content[0][a]:this._metadata.content[0][a];if("undefined"===typeof a||null===a)a="";return a=this.processMarkup(a)};c._processScripts=function(a,b){var d=a.getElementsByTagName("script"),e;if(null!==d&&"undefined"!==typeof d){var f="_scr#",f=null===b||"undefined"===typeof b||""===b?f+"cre_":f+(b+"_");e=0;for(l=d.length;e<l;e++){var c=d[e],g=c.getAttribute("id");(null===g||"undefined"===typeof g||""===g)&&c.setAttribute("id",f+e);this._processExternalScripts(c)||cre$.util.evalFn(c.innerHTML)}}};
c._processExternalScripts=function(a){a=this._getScriptUrl(a);var b=!1;a&&(cre$.ResourceManager&&(a=cre$.ResourceManager.makeProxyUrl(a)),this._loadExternalScript(a),b=!0);return b};c._getScriptUrl=function(a){var b=null;if(a.getAttribute)b=a.getAttribute("src");else{var d=a.toLowerCase().indexOf("\x3cscript"),e=a.toLowerCase().indexOf("\x3e");a=a.substring(d,e);d=a.indexOf("src");if(-1!=d){var b=a.indexOf("'",d),e=a.indexOf('"',d),f='"',d=doubleQuoteSrcAttrContentIndex;if(-1==doubleQuoteSrcAttrContentIndex||
-1!=b&&b<e)f="'",d=b;b=a.indexOf(f,d+1);b=a.substring(d+1,b)}}return b};c._loadExternalScript=function(a){var b={};b[cre$.constants.request.URL]=a;b[cre$.constants.request.SYNC]=!0;cre$.xhr.xhrGet(b).then(function(a){window.execScript?window.execScript(c._stripHTMLComments(a.data),"JavaScript"):eval.call(self,a.data)},function(a){__logging.log("cre$.iwidget.internalutil","_loadExternalScript",cre$.LocaleHelper.getLocalizedMessages().ERR_ISCOPE_METHOD_NOT_DEFINED)})};c._stripHTMLComments=function(a){for(var b=
"",d=a.indexOf("\x3c!--"),b=-1!=d?a.substring(0,d):a;0<=d;){d=a.indexOf("--\x3e");if(0>d)throw Error("Unclosed HTML comment found!!");b+=a.substring(d+3);d=a.indexOf("\x3c!--",d+3)}return b};c._getDomByMode=function(a){if(this._isWrapperContext)return null;a=this._instanceData.moduleId+"Content "+a;for(var b=this._rootElement.firstChild;b;){if(a===b.className)return b;b=b.nextSibling}return null};c.unload=function(){var a=this.getWidgetId(),b="_"+a+"_iContext",d=this._iRuntime.getWires(),e=this._iRuntime.getStateSets();
this.removeRootElement();this._iRuntime.removeWireLoadedCallbackById(a);d&&(d.removeWireBySourceWidget(a),d.removeWireByTargetWidget(a),d.removeWireDelegator(a));if(e)for(d=e.length;d--;){var f=e[d],c=f.widgetIds.length||0;if(1===c&&a===f.widgetIds[0])delete e[d],e.splice(d,1);else if(1<c)for(;c--;)if(a===f.widgetIds[c]){delete f.widgetIds[c];f.widgetIds.splice(c,1);break}}var g=this;getServiceManager().getService(cre$.services.EVENTSERVICE).then(function(a){var b=g._subHandlers.length;if(0<b)for(;b--;)a.unsubscribeEvent(g._subHandlers[b])});
try{delete window[b]}catch(m){window[b]=void 0}};c._syncGlobalShareableItemSet=function(a,b,d){var e=null,f=null;if(a!==this.getWidgetId()){f=cre$.iRuntime.getGlobalShareableStateSet(b);for(e in d)d[e]&&d[e]===cre$.constants.changeType.DELETE_TOKEN?f.removeItem(e):d[e]&&f.setItemValue(e,d[e]);if(a=f.getAllItemNames()){b={};b.itemSetName=f.id;b.changes=[];e=0;for(d=a.length;e<d;e++){var c=a[e],g=f.getItem(c);f._dirty&&(g._dirty&&g._change)&&(b.changes.push(g._change),f._setItemDirty(c,!1))}delete f._dirty;
e={name:cre$.constants.predefinedEvents.onItemSetChanged,type:null,payload:b,source:this._iContext.getWidgetId()};a=f.getListeners();for(var m in a)Object.prototype.hasOwnProperty.call(a,m)&&a[m].call(f,e)}}};c._syncLocalShareableItemSet=function(a,b){var d=this.getShareableItemSet(a),e=null;for(e in b)b[e]&&b[e]===cre$.constants.changeType.DELETE_TOKEN?d.removeItem(e):b[e]&&d.setItemValue(e,b[e]);d.commit(null,!0)};c._getSimpleType=function(a){var b=a.indexOf("?");-1!==b&&(a=a.substring(0,b));return n(a,
".js")?cre$.constants.resource.resourceType.JAVASCRIPT:n(a,".css")?cre$.constants.resource.resourceType.CSS:n(a,".bmp")||n(a,".jpg")||n(a,".png")||n(a,".gif")||n(a,".tiff")||n(a,".ico")?cre$.constants.resource.resourceType.IMAGE:cre$.constants.resource.resourceType.UNKNOW};c._getResourceType=function(a){return void 0===a||null===a?cre$.constants.resource.resourceType.UNKNOW:cre$.constants.resource.mimeType.JAVASCRIPT===a?cre$.constants.resource.resourceType.JAVASCRIPT:cre$.constants.resource.mimeType.CSS===
a?cre$.constants.resource.resourceType.CSS:0===a.indexOf(cre$.constants.resource.mimeType.IMAGE)?cre$.constants.resource.resourceType.IMAGE:a};c._buildAbsoluteUrl=function(a){var b=null;return b=cre$.ResourceManager.getOrigin(a)?a:0===a.indexOf("/")?cre$.ResourceManager.getOrigin(this._widgetBaseUri).concat(a):this._widgetBaseUri.concat(a)};c._generateIFrResources=function(a){var b=0,d,e=[],f=a.getResource();if(f&&0<f.length){a=f.length;for(b=0;b<a;b++){d=f[b];var c={scope:"widget",type:d.mimeType?
this._getResourceType(d.mimeType):this._getSimpleType(d.uri),cachetype:"client",uri:this._buildAbsoluteUrl(d.uri)};p.call(d,cre$.constants.resource.resourceType.GLOBALID)&&(c.globalid=d.globalid);p.call(d,cre$.constants.resource.resourceType.SKIPLOAD)?c.skipLoad=d.skipLoad:p.call(d,"@"+cre$.constants.resource.resourceType.SKIPLOAD)&&(c.skipLoad=d["@"+cre$.constants.resource.resourceType.SKIPLOAD]);e.push(c)}}return e};c._processSandboxPageData=function(a){var b=this;getServiceManager().getService(cre$.services.EVENTSERVICE).then(function(a){var e=
(b._widgetRefInternal.getSiteResources()||[]).concat(b._generateIFrResources(b._widgetRefInternal)),c={userProfile:b._widgetRefInternal.getUserProfile(),widgetMetadata:[b._widgetRefInternal.getWidgetMetadata()],instanceData:[{domId:b._widgetRefInternal.getDomId(),renderType:b._widgetRefInternal.getRenderType(),definition:b._widgetRefInternal.getDefinition(),instanceMetaData:b._widgetRefInternal.getInstanceMetadata(),tokenInfo:b._widgetRefInternal.getTokenInfo(),componentType:b._widgetRefInternal.getComponentType()}],
containerToken:cre$.internalutil.getCREContainerToken()};if(e&&e.length){var h=e.length,g=/dojo(\.xd)?\.js(\W|$)/i,m,k,q=[];for(k=0;k<h;k++)(m=e[k].uri.match(g))||q.push(e[k]);c.resourceList=q}a.publishEvent(cre$.constants.event.topic.PAGE_DATA_+b.getWidgetId(),c)})};c._sendWiresToSandbox=function(){var a=this,b=a._iRuntime.getWires();b&&b.wires&&getServiceManager().getService(cre$.services.EVENTSERVICE).then(function(b){var e=cre$.constants.event.topic.STUB_SYNC_WIRES+a.getWidgetId();b.publishEvent(e,
a._iRuntime.getWires().wires)})};c._handleSyncWires=function(a){for(var b=0,d=a.length;b<d;b++)this._iRuntime.getWires().wires.push(a[b])};c._initializeWire=function(){var a=!0,b=[],d=this._iRuntime.getWires();if(d){var e,c,h;d.registerCreateWireDelegators(this.getWidgetId(),"_createWire",this);if(this._isWrapperContext){if(this._instanceData&&this._instanceData.receivedEvents){e=this._instanceData.receivedEvents.length;for(c=0;c<e;c++)h=this._instanceData.receivedEvents[c],d.wires.push({sourceWidget:h.sourceWidget,
sourceEvent:h.sourceEvent,targetWidget:this.getWidgetId(),targetEvent:h.targetEvent})}}else{var g=this.iEvents.getEvents(),m=g.length;for(e=m;e--;)g[e].onNewWire&&d.registerNewWireCallback(this.getWidgetId(),g[e].name,g[e].onNewWire,this._iScope),g[e].onRemoveWire&&d.registerRemoveWireCallback(this.getWidgetId(),g[e].name,g[e].onRemoveWire,this._iScope);if(this._instanceData&&this._instanceData.receivedEvents)for(c=e=this._instanceData.receivedEvents.length;c--;)h=this._instanceData.receivedEvents[c],
b.push(d.createWire(h.sourceWidget,h.sourceEvent,this.getWidgetId(),h.targetEvent));this._subHandlerGlobalEvents=[];for(c=m;c--;)if(g[c].isHandled&&g[c].handlingFn){var d=g[c].handlingFn,k=null,k="function"===typeof d?d:cre$.util.hitch(this,function(a,b){this._iScope[a].call(this._iScope,b)},d);getServiceManager().getService(cre$.services.EVENTSERVICE).then(this._util.hitch(this,function(a){this._subHandlerGlobalEvents.push(a.subscribeEvent(g[c].name,null,k))}))}}}else __logging.log("cre$.iwidget.iContext",
"_initializeWire",cre$.LocaleHelper.getLocalizedMessages().LOG_WIRE_NOT_INIT,null,__logging.logLevel.INFO);0<b.length&&(a=cre$.promise.whenAll.apply(cre$,b));return cre$.promise.when(a)};c._cleanSubscription=function(){if(this._subHandlerGlobalEvents)for(var a=this._subHandlerGlobalEvents.length,b=0;b<a;b++){var d=this._subHandlerGlobalEvents[b];getServiceManager().getService(cre$.services.EVENTSERVICE).then(this._util.hitch(this,function(a){a.unsubscribeEvent(d)}))}};c._processIwWidget=function(a){};
c._createWire=function(a,b,d,e){var c={};c.sourceWidget=a;c.sourceEvent=b;c.targetWidget=d;c.targetEvent=e;var h=getServiceManager().getService(cre$.services.EVENTSERVICE),g=a+"_"+b+"_"+d+"_"+e;a=this._util.hitch(this,function(a){if(this._isWrapperContext){var b="_stub_sync_"+this.getWidgetId();a.publishEvent(b,{methodname:"_syncCreateWire",params:[c]})}else{var b="",d=this.iEvents.getEvents({name:e});1===d.length&&(b=d[0].handlingFn);var h=this,d=null,d="function"===typeof b?b:cre$.util.hitch(this,
function(a,b){try{this._iScope[a].call(this._iScope,b)}catch(d){__logging.log("cre$.iwidget.iContext","eventCallback",cre$.LocaleHelper.getLocalizedMessages().ERR_ISCOPE_METHOD_NOT_DEFINED)}},b);cre$.iRuntime.inIFrame?a.subscribeEvent(g,this,d,function(a){c.wireId=a;h._iRuntime.getWires().updateWire(c)}):c.wireId=a.subscribeEvent(g,this,d)}return c});return h.then(a)};c._invokeQueuedEvent=function(){var a=this._iRuntime.getWires()._queuedEvents,b=a.length,d=this,c,f,h=function(a,b){var c=d.iEvents.getEvents({name:a});
1===c.length&&(c=c[0].handlingFn,"function"===typeof c?c(b):d._iScope[c]&&d._iScope[c].call(d._iScope,b))};if(this._instanceData&&this._instanceData.receivedEvents){var g=this._instanceData.receivedEvents.length;for(f=0;f<g;f++){var m=this._instanceData.receivedEvents[f];for(c=0;c<b;c++)if(a[c].widgetId===m.sourceWidget&&a[c].eventId===m.sourceEvent){var k={};k.name=m.targetEvent;k.payload=a[c].payload.payload;k.type=a[c].payload.payloadType;k.source=m.sourceWidget;h(m.targetEvent,k)}}}for(c=0;c<
b;c++)"broadcast"===a[c].widgetId&&h(a[c].eventId,{name:a[c].eventId,payload:a[c].payload.payload,type:a[c].payload.payloadType})};c.clearCookies=function(a){if(cre$.util.isArray(a))for(var b=0;b<a.length;b++)c.clearCookie(a[b]);else c.clearCookie(a)};c.clearCookie=function(a){a.value="";a.expires=new Date(0);c.setCookie(a)};c.getDomainAndPath=function(a){var b=cre$.iRuntime.getProxyUrl().replace("%host%",document.location.host),b=shindig.uri(b);a=b.getPath()+"/"+a;b.setPath(a);b=b.toString();b=shindig.uri().removePrefix(b);
0<b.indexOf("/")?(a=b.substring(0,b.indexOf("/")),b=b.substring(b.indexOf("/"),b.indexOf("?"))):(a=b,b="/");0<a.indexOf(":")&&(a=a.substring(0,a.indexOf(":")));return{domain:a,path:b}};c.setCookies=function(a){if(cre$.util.isArray(a))for(var b=0;b<a.length;b++)c.setCookie(a[b]);else c.setCookie(a)};c.setCookie=function(a){var b=a.name+"\x3d"+a.value+";domain\x3d"+a.domain+";path\x3d"+a.path;a.expires&&(b+=";expires\x3d"+a.expires);document.cookie=b};c.isUseProxy=function(a){return 0<a.indexOf("/common/proxy?")||
0<a.indexOf("%2Fcommon%2Fproxy%3F")};c.constants={mode:{VIEW:cre$.constants.mode.VIEW,EDIT:cre$.constants.mode.EDIT,PERSONALIZE:cre$.constants.mode.PERSONALIZE,CONFIG:cre$.constants.mode.CONFIG,HELP:cre$.constants.mode.HELP},event:{TITLE:cre$.constants.event.TITLE,DESCRIPTION:cre$.constants.event.DESCRIPTION},ATTRIBUTES:cre$.constants.itemSet.ATTRIBUTES,IDESCRIPTOR:cre$.constants.itemSet.IDESCRIPTOR,USERPROFILE:"userProfile",keys:{SHIFT:cre$.constants.keys.SHIFT,ALT:cre$.constants.keys.ALT,CTRL:cre$.constants.keys.CTRL,
META:cre$.constants.keys.META,CAPSLOCK:cre$.constants.keys.CAPSLOCK},windowstate:{NORMAL:cre$.constants.windowstate.NORMAL,MINIMIZE:cre$.constants.windowstate.MINIMIZE,MAXIMIZE:cre$.constants.windowstate.MAXIMIZE},status:{SUCCESS:cre$.constants.status.SUCCESS,TIMEOUT:cre$.constants.status.TIMEOUT,NOTFOUND:cre$.constants.status.NOTFOUND,INTERROR:cre$.constants.status.INTERROR,OTHER:cre$.constants.status.OTHER},changeType:{CHANGEDVALUE:cre$.constants.changeType.CHANGED_VALUE,NEWITEM:cre$.constants.changeType.NEW_ITEM,
REMOVEDITEM:cre$.constants.changeType.REMOVED_ITEM},predefinedEvents:{onLoad:cre$.constants.predefinedEvents.onLoad,onUnLoad:cre$.constants.predefinedEvents.onUnLoad,onModeChanged:cre$.constants.predefinedEvents.onModeChanged,onWindowStateChanged:cre$.constants.predefinedEvents.onWindowStateChanged,onSizeChanged:cre$.constants.predefinedEvents.onSizeChanged,onNavStateChanged:cre$.constants.predefinedEvents.onNavStateChanged,onItemSetChanged:cre$.constants.predefinedEvents.onItemSetChanged,onRefreshNeeded:cre$.constants.predefinedEvents.onRefreshNeeded,
onNewWire:cre$.constants.predefinedEvents.onNewWire,onRemoveWire:cre$.constants.predefinedEvents.onRemoveWire,onIncompleteEventDescription:cre$.constants.predefinedEvents.onIncompleteEventDescription}}})();cre$.iwidget.iContext=function(a,c){this._canNavigateAway=!0;this._widgetObject=this._widgetRefInternal=a;this._metadata=a.getWidgetMetadata();this._instanceData=a.getInstanceMetadata();this._loadInstanceData=a.getLoadInstanceData();this._iRuntime=cre$.iRuntime;this._util=cre$.util;this._isWrapperContext=!(cre$.iRuntime.inIFrame||this._widgetRefInternal.getRenderType()===cre$.constants.renderType.INLINE);this._widgetBaseUri=a.getDefinition();var b=this._widgetBaseUri.lastIndexOf("/");this._widgetBaseUri=
-1===b?"":this._widgetBaseUri.substring(0,b+1);this._rootElement=c;this._hubContainer=null;this._tokenInfo=a.getTokenInfo();this._subHandlers=[];this._proxyCookiePath=this._proxyCookieDomain=null;var d=this,b=cre$.iRuntime.getProxyUrl().replace("%host%",document.location.host),b=shindig.uri(b),e=b.getPath()+"/"+this._instanceData.moduleId;b.setPath(e);b=b.toString();b=shindig.uri().removePrefix(b);0<b.indexOf("/")?(this._proxyCookieDomain=b.substring(0,b.indexOf("/")),this._proxyCookiePath=b.substring(b.indexOf("/"),
b.indexOf("?"))):(this._proxyCookieDomain=b,this._proxyCookiePath="/");0<this._proxyCookieDomain.indexOf(":")&&(this._proxyCookieDomain=this._proxyCookieDomain.substring(0,this._proxyCookieDomain.indexOf(":")));a.getRenderType()===cre$.constants.renderType.SANDBOX&&(e=new Date,e.setTime(e.getTime()+this._tokenInfo.expireTimeMs),b=[],e={name:"st",value:encodeURIComponent(this._tokenInfo.token),domain:this._proxyCookieDomain,path:this._proxyCookiePath,expires:e},b.push(e),cre$.iwidget.internalutil.setCookies(b));
b=function(a){d._tokenInfo.expireTimeMs=a.expireTimeMs;d._tokenInfo.token=a.token;d._isWrapperContext||(document.cookie="st\x3d"+d._tokenInfo.token+";domain\x3d"+d._proxyCookieDomain+";path\x3d"+d._proxyCookiePath)};e=function(a){d._tokenRefreshTimer=a};this._tokenInfo.needsTokenRefresh&&cre$.util.scheduleTokenRefresher(this._tokenInfo.token,"widget",b,e)};
cre$.iwidget.iContext.prototype._createiScopeObject=function(a,c){a._iScope={};var b=a._metadata.iScope,d=a._widgetRefInternal.getWidgetMetadata()["cre_ns-sep_iScopeType"];if(b)try{if(d)getServiceManager().getService(cre$.constants.iWidget.ISCOPESERVICE,!0).then(function(e){e.makeInstance(d,b).then(function(b){a._iScope=b;a._iScope.iContext=a;c.resolve()},function(b){__logging.log("cre$.iwidget.iContext","_createiScopeObject",cre$.LocaleHelper.getLocalizedMessages().ERR_CREATE_ISCOPE);a._iScope.iContext=
a;c.resolve()})});else{if(-1!=b.indexOf("(")){var e=eval(b);a._iScope=new e}else{var f=a._util.getObject(b,!0);a._iScope="function"===typeof f?new f:a._util.mixin(a._util.mixin(a._iScope,f),f.prototype)}a._iScope.iContext=a;c.resolve()}}catch(h){__logging.log("cre$.iwidget.iContext","_createiScopeObject",cre$.LocaleHelper.getLocalizedMessages().ERR_CREATE_ISCOPE),a._iScope.iContext=a,c.resolve()}else __logging.log("cre$.iwidget.iContext","_createiScopeObject",cre$.LocaleHelper.getLocalizedMessages().ERR_CREATE_ISCOPE),
a._iScope.iContext=a,c.resolve()};
cre$.iwidget.iContext.prototype._determineInitialMode=function(a){var c;if("undefined"!==typeof a._instanceData&&null!==a._instanceData&&"undefined"!==typeof a._instanceData.itemSet&&null!==a._instanceData.itemSet)for(var b=a._instanceData.itemSet,d=b.length;d--;){var e=b[d];if("idescriptor"==e.id){if(e.item){b=e.item;for(d=b.length;d--;)if(e=b[d],"mode"==e.id){c=e.value;break}}break}}var f;if("undefined"!==typeof a._loadInstanceData&&null!==a._loadInstanceData&&"undefined"!==typeof a._loadInstanceData.itemSet&&
null!==a._loadInstanceData.itemSet){b=a._loadInstanceData.itemSet;for(d=b.length;d--;)if(e=b[d],"idescriptor"==e.id){if(e.item){b=e.item;for(d=b.length;d--;)if(e=b[d],"mode"==e.id){f=e.value;break}}break}}return f||c||a._metadata.mode||a.constants.mode.VIEW};cre$.iwidget.iContext.prototype._subscribeEvent=function(a,c,b,d){return c.subscribeEvent(b,a,d)};
cre$.iwidget.iContext.prototype.init=function(){var a=new cre$.promise.Promise("init");if(this._rootElement){var c="_"+this.getWidgetId()+"_iContext",b=window[c]=this,c=new cre$.promise.Promise("iscopePromise");this.widgetId=this.getWidgetId();this._isWrapperContext?c.resolve():this._createiScopeObject(b,c);c.then(function(){b._mode=b._determineInitialMode(b);b.iEvents=new b.iEventsWrapper(b.widgetId);b._widgetRefInternal.setIContext(b);b.widget=b._widgetRefInternal.getWidgetRef();b.widget._widgetObject=
b._widgetRefInternal;b.io=new b.io(b,b._widgetBaseUri);b._initializeWire().then(function(a){b._iRuntime.registerWireLoadedCallbacks({id:b.widgetId,callback:"_initializeWire",object:b});return getServiceManager().getService(cre$.services.EVENTSERVICE)}).then(function(c){try{if(b._isWrapperContext){b._initPromise=a;b.getiDescriptor()._setItemValue(cre$.iwidget.iDescriptor.prototype.iDescriptorItems.mode,b._mode);var e=b._getIframeUrl();b._hubContainer=cre$.oah.managedHub.createIframeHubContainer(b._instanceData.moduleId,
e,b._rootElement,b.getiDescriptor().getItemValue("defaultWidth"),b.getiDescriptor().getItemValue("defaultHeight"));!0===b._widgetRefInternal.isSandboxAttrEnabled()&&b._hubContainer.getIframe().setAttribute("sandbox",cre$.config.sandbox);b._subHandlers.push(b._subscribeEvent(b,c,"sync_"+b.getWidgetId(),b._handleEvent));b._subHandlers.push(b._subscribeEvent(b,c,"request_pagedata_"+b.getWidgetId(),b._processSandboxPageData));b._subHandlers.push(b._subscribeEvent(b,c,"request_wires_"+b.getWidgetId(),
b._sendWiresToSandbox));b._iRuntime.getWires()&&b._invokeQueuedEvent()}else{var f=b._getMarkupByMode(b._mode),h=document.createElement("div");h.innerHTML=f;h.className=b._instanceData.moduleId+" Content "+b._mode;b._rootElement.appendChild(h);b._processScripts(h,b.widgetId);var l=cre$.constants.iDescriptorItems,g=b.getiDescriptor(),m=g?g.getItemValue(l.DEFAULTWIDTH):void 0,n=g?g.getItemValue(l.DEFAULTHEIGHT):void 0;m&&(b._rootElement.style.width=m);n&&(b._rootElement.style.height=n);g._setItemValue(l.MODE,
b._mode);var k=b._iScope;if(k){if(k.onLoad&&"function"===typeof k.onLoad)try{k.onLoad()}catch(p){console.log("iContext","init",b.widgetId+" had an exception in its onLoad handler:\n"+p)}b._widgetRefInternal.invokeOnModeMethod(b._mode)}cre$.iRuntime.inIFrame&&(b._subscribeEvent(b,c,"_stub_sync_"+b.getWidgetId(),b._handleEvent),b._subscribeEvent(b,c,"broadcast_shareableitemset_change",b._handleEvent),b._subscribeEvent(b,c,"broadcast_wires_change",b._handleEvent),b._subscribeEvent(b,c,"_stub_sync_wires_"+
b.getWidgetId(),b._handleEvent),c.publishEvent("request_wires_"+b.getWidgetId()));b._iRuntime.getWires()&&b._invokeQueuedEvent();cre$.iRuntime.inIFrame&&c.publishEvent("sync_"+b.widgetId,{methodname:"_resolveInitPromise"});a.resolve()}}catch(q){a.reject(q)}})},function(a){__logging.log("cre$.iwidget.iContext","init",cre$.LocaleHelper.getLocalizedMessages().ERR_CREATE_ISCOPE+": "+a)})}else a.reject(cre$.LocaleHelper.getLocalizedMessages().ERR_IS_NULL_UNDEFINED+" _RootElement");return a};
cre$.util.mixin(cre$.iwidget.iContext.prototype,cre$.iwidget.internalutil);cre$.iwidget.iContext.prototype.getiWidgetAttributes=function(){if(!this._attributes){var a=this._iRuntime.getStateSet(this._instanceData.moduleId,this.constants.ATTRIBUTES,{});this._attributes=new cre$.iwidget.ManagedItemSet(a,this);this._attributes._iContext=this}return this._attributes};
cre$.iwidget.iContext.prototype.getUserProfile=function(){if(!this._userProfile){var a=this._iRuntime.getStateSet(this._instanceData.moduleId,this.constants.USERPROFILE,{});this._userProfile=new cre$.iwidget.UserProfile(this._instanceData.moduleId,a);this._userProfile._iContext=this}return this._userProfile};
cre$.iwidget.iContext.prototype.getiDescriptor=function(){if(!this._iDescriptor){var a=this._iRuntime.getStateSet(this._instanceData.moduleId,this.constants.IDESCRIPTOR,{});this._iDescriptor=new cre$.iwidget.iDescriptor(this._widgetRefInternal,a);this._iDescriptor._iContext=this}return this._iDescriptor};cre$.iwidget.iContext.prototype.changeMode=function(a){if(a!==this._mode){var c=this.getiDescriptor();c.setItemValue(c.iDescriptorItems.mode,a)}};
cre$.iwidget.iContext.prototype.getItemSet=function(a,c){if(!this._itemSets){var b=this;cre$.iRuntime.loadFeatures(["cre.iwidget.itemset"],!0).then(function(){b._itemSets={}},function(){__logging.log("cre$.iwidget.iContext","getItemSet",cre$.LocaleHelper.getLocalizedMessages().ERR_LOAD_ITEMSET_SRC)})}if(!this._itemSets[a]){var d=this._iRuntime.getStateSet(this._instanceData.moduleId,a,{}),d=new cre$.iwidget.ItemSet(d);this._itemSets[a]=d}return this._itemSets[a]};
cre$.iwidget.iContext.prototype.getShareableItemSet=function(a){if(!this._shareableItemSets){var c=this;cre$.iRuntime.loadFeatures(["cre.iwidget.itemset"],!0).then(function(){c._shareableItemSets={}},function(){__logging.log("cre$.iwidget.iContext","getShareableItemSet",cre$.LocaleHelper.getLocalizedMessages().ERR_LOAD_ITEMSET_SRC)})}this._shareableItemSets[a]||(this._shareableItemSets[a]=this._getShareableItemSet(a));return this._shareableItemSets[a]};
cre$.iwidget.iContext.prototype._getShareableItemSet=function(a){var c=this._iRuntime.getShareableStateSet(this._instanceData.moduleId,a),b=null,b=c?c.alias?this._iRuntime.getGlobalShareableStateSet(c.alias):c:this._iRuntime.getGlobalShareableStateSet(a);return new cre$.iwidget.ShareableItemSet(this,b,c,a)};cre$.iwidget.iContext.prototype.getWidgetId=function(){return this._instanceData.moduleId};cre$.iwidget.iContext.prototype.getMetadata=function(){return this._metadata};
cre$.iwidget.iContext.prototype.iScope=function(){return this._iScope};cre$.iwidget.iContext.prototype.processMarkup=function(a){return a.replace(/_IWID_/g,"_"+this.getWidgetId()+"_").replace(/iContext(?=\.|\s|\(|\))/g,"_"+this.getWidgetId()+"_iContext")};function _handleChildWidgets(a,c){for(var b=a.length,d=cre$.iRuntime.getWidgetById(c);b--;)a[b].getState()!=cre$.constants.state.ERROR&&(a[b].setParentId(c),d.pushChildrenId(a[b].getModuleId()))}
cre$.iwidget.iContext.prototype.processiWidgets=function(a){var c=!0;if(a){var b=cre$.internalutil.getElementsByClass(a,cre$.constants.others.IW_IWIDGET);if(0<(a?b.length:0))var d=this,c=this._iRuntime.loadWidgets([a]).then(function(a){_handleChildWidgets(a,d.getWidgetId())},function(a){_handleChildWidgets(a,d.getWidgetId())})}return cre$.promise.when(c)};
cre$.iwidget.iContext.prototype.getElementById=function(a){var c=cre$.internalutil.getElementsByClass(this._rootElement,this._mode),b=null;if(null!==c&&0<c.length)for(var c=c[0].getElementsByTagName("*"),d=c.length,e=0;e<d;e++)if(c[e].id===a){b=c[e];break}return b};cre$.iwidget.iContext.prototype.getElementByClass=function(a){return cre$.internalutil.getElementsByClass(this._rootElement,a)};cre$.iwidget.iContext.prototype.getRootElement=function(){return this._rootElement};
cre$.iwidget.iContext.prototype.removeRootElement=function(){if(this._rootElement)for(var a=this._rootElement.childNodes,c=a.length-1;0<=c;c--)this._rootElement.removeChild(a[c])};cre$.iwidget.iContext.prototype.requires=function(a,c,b,d,e){};
cre$.iwidget.iContext.prototype.canNavigateAway=function(){if(this._iScope&&this._iScope.onUnload)try{this._iScope.onUnload()}catch(a){console.log("iContext","canNavigateAway",this.widgetId+" had an exception in its onUnload handler:\n"+a)}cre$.util.unscheduleTokenRefresher(this._tokenRefreshTimer);return this._canNavigateAway};
cre$.iwidget.iContext.prototype.getNapromise=function(){this._naPromise=new cre$.promise.Promise("getNapromise");if(this._isWrapperContext){var a="_stub_sync_"+this.getWidgetId();getServiceManager().getService(cre$.services.EVENTSERVICE).then(function(b){b.publishEvent(a,{methodname:"_inframeNapromise",params:[void 0]})})}else{if(this._iScope&&this._iScope.onUnload)try{this._iScope.onUnload()}catch(c){console.log("iContext","canNavigateAway",this.widgetId+" had an exception in its onUnload handler:\n"+
c)}this._tokenRefreshTimer&&cre$.util.unscheduleTokenRefresher(this._tokenRefreshTimer);this._canNavigateAway?this._naPromise.resolve(!0):this._naPromise.reject(!1)}return this._naPromise};
cre$.iwidget.iContext.prototype._inframeNapromise=function(){if(this._iScope&&this._iScope.onUnload)try{this._iScope.onUnload()}catch(a){console.log("iContext","getNapromise",this.widgetId+" had an exception in its onUnload handler:\n"+a)}this._tokenRefreshTimer&&cre$.util.unscheduleTokenRefresher(this._tokenRefreshTimer);var c="sync_"+this.getWidgetId(),b=getServiceManager().getService(cre$.services.EVENTSERVICE),d=[cre$.util.clone(this._canNavigateAway)];b.then(function(a){a.publishEvent(c,{methodname:"_wrapperNapromise",
params:d})})};cre$.iwidget.iContext.prototype._wrapperNapromise=function(a){(this._canNavigateAway=a)?this._naPromise.resolve(!0):this._naPromise.reject(!1)};cre$.iwidget.iContext.prototype._resolveInitPromise=function(){this._initPromise.resolve()};cre$.iwidget.iContext.prototype.cancelNavigateAway=function(){this._canNavigateAway=!1};cre$.iwidget.iContext.prototype.enableNavigateAway=function(){this._canNavigateAway=!0};
cre$.iwidget.iContext.prototype._initiEvents=function(){if(!this._iEvents){var a=this;cre$.iRuntime.loadFeatures(["cre.iwidget.event"],!0).then(function(){a._iEvents=new cre$.iwidget.iEvents(a.widget,a.getWidgetId())},function(){__logging.log("cre$.iwidget.iContext","_initiEvents",cre$.LocaleHelper.getLocalizedMessages().ERR_LOAD_EVENT_SRC)})}};
cre$.iwidget.iContext.prototype.iEventsWrapper=function(a){this.widgetObjName="_"+a+"_iContext";this.esp=getServiceManager().getService(cre$.services.EVENTSERVICE);this.syncTopic="sync_"+a};
cre$.iwidget.iContext.prototype.iEventsWrapper.prototype={fireEvent:function(a,c,b){if("string"===typeof b){var d=cre$.internalutil.parseToJson(b);!1!==d&&(b=d)}window[this.widgetObjName]._initiEvents();0<this.getEvents({name:a}).length?window[this.widgetObjName]._iEvents.fireEvent(a,c,b):window[this.widgetObjName]._widgetRefInternal.handleEvent(a,c,b)||window[this.widgetObjName]._iEvents.fireEvent(a,c,b)},setEvent:function(a){window[this.widgetObjName]._initiEvents();var c=!1;if(window[this.widgetObjName]._iEvents.setEvent(a)){if(!window[this.widgetObjName]._isWrapperContext){var b=
this;this.esp.then(function(c){c.publishEvent(b.syncTopic,{methodname:"_syncCreateEvent",params:[a]})})}c=!0}return c},setEvents:function(a){window[this.widgetObjName]._initiEvents();var c=!1;if(window[this.widgetObjName]._iEvents.setEvents(a)){if(!window[this.widgetObjName]._isWrapperContext){var b=this;this.esp.then(function(c){c.publishEvent(b.syncTopic,{methodname:"_syncCreateEvents",params:[a]})})}c=!0}return c},removeEvent:function(a){window[this.widgetObjName]._initiEvents();var c=!1;if(window[this.widgetObjName]._iEvents.removeEvent(a)){if(!window[this.widgetObjName]._isWrapperContext){var b=
this;this.esp.then(function(c){c.publishEvent(b.syncTopic,{methodname:"_syncRemoveEvent",params:[a]})})}c=!0}return c},removeEvents:function(a){window[this.widgetObjName]._initiEvents();var c=!1;if(window[this.widgetObjName]._iEvents.removeEvents(a)){if(!window[this.widgetObjName]._isWrapperContext){var b=this;this.esp.then(function(c){c.publishEvent(b.syncTopic,{methodname:"_syncRemoveEvents",params:[a]})})}c=!0}return c},getEvents:function(a){window[this.widgetObjName]._initiEvents();return window[this.widgetObjName]._iEvents.getEvents(a)},
createEventDescription:function(a){window[this.widgetObjName]._initiEvents();return window[this.widgetObjName]._iEvents.createEventDescription(a)},publishEvent:function(a,c,b){window[this.widgetObjName]._initiEvents();window[this.widgetObjName]._iEvents.publishEvent(a,c,b)},_getDynamicEvents:function(){window[this.widgetObjName]._initiEvents();return window[this.widgetObjName]._iEvents._getDynamicEvents()}};cre$.iwidget.iContext.prototype.io=function(a,c){this._iContext=a;this._widgetBaseUri=c};
cre$.iwidget.iContext.prototype.io.prototype={XMLHttpRequest:function(){return cre$.xhr.makeXhr()},rewriteURI:function(a,c){var b=cre$.ResourceManager.makeProxyUrl(a,{isXhr:c,widgetBaseUri:this._widgetBaseUri});if(cre$.iwidget.internalutil.isUseProxy(b)){var d=new Date;d.setTime(d.getTime()+this._iContext._tokenInfo.expireTimeMs);var e=[],d={name:"st",value:this._iContext._tokenInfo.token,domain:this._iContext._proxyCookieDomain,path:this._iContext._proxyCookiePath,expires:d.toGMTString()};e.push(d);
cre$.iwidget.internalutil.setCookies(e)}return-1===a.indexOf(":/")?(cre$.iwidget.internalutil.isUseProxy(b)&&(b=shindig.uri(b),e=b.getPath()+"/"+this._iContext._instanceData.moduleId,b.setPath(e),b=b.toString()),b):cre$.util.applyTokenToUrl(b,this._iContext._tokenInfo.token,this._iContext._instanceData.moduleId)},request:function(a,c,b,d,e){a={requestVerb:a,url:c,handleAs:"text",sync:b?!1:!0,handle:b,msgData:d,headers:cre$.util.mixin({},e)};return this.xhrReq(a)},xhrReq:function(a){var c=cre$.constants.request;
a.requestVerb=a.requestVerb.toUpperCase();if(a.requestVerb!=(c.method.GET||c.method.PUT||c.method.POST||c.method.DELETE))a.requestVerb=c.method.GET;a.url=cre$.util.applyTokenToUrl(a.url,this._iContext._tokenInfo.token);var b=null;if(a.headers)for(var d=a.headers.length;d--;){var e=a.headers[d];if(e.headerName===c.header.CONTENT_TYPE){b=e.value;break}}if(a.content){a.url+="?";for(var f in a.content)a.url+=f+"\x3d"+a.content[f]+"\x26";a.url=a.url.slice(0,a.url.length-1)}a.preventCache&&!0===a.preventCache&&
(a.url=a.content?a.url+("\x26preventCache\x3d"+(new Date).getTime()):a.url+("?preventCache\x3d"+(new Date).getTime()));c=cre$.xhr.xhr(a.requestVerb,{url:a.url,headers:{"X-Shindig-ST":this._iContext._tokenInfo.token},paramData:a.msgData,contentType:b,sync:a.sync,timeout:a.timeout,user:a.user,password:a.password,form:a.form});a.handle&&c.then(function(b){a.handle(b.xhr,a)},function(b){a.handle(b.xhr,a)});a.load&&c.then(function(b){a.load(b.xhr,a)},null);a.error&&c.then(null,function(b){a.error(b.xhr,
a)});return c.xhr}};cre$.iwidget.iContext.prototype.xml={};cre$.iwidget.widgetWrapper=function(b,d,c){this._iContext=b;this._widgetRefInternal=d;this._metadata=d.getWidgetMetadata();this._instanceData=d.getInstanceMetadata();this._rootElement=this._iContext._rootElement;this._windowManager={};this._widgetObject=c};
cre$.iwidget.widgetWrapper.prototype={handleEvent:function(b,d,c){var a=!1;"undefined"!==typeof b&&null!=b&&(b===this._iContext.constants.predefinedEvents.onModeChanged?a=this._handleModeChange(c.newMode):c&&c.newMode&&this._isOnModeEvent(b,d,c)?(this._invokeOnModeMethod(c.newMode),a=!0):a=this._handleEventInternal(b,d,c));return a},_isOnModeEvent:function(b,d,c){d=!1;0===b.indexOf("on")&&this._isSupportedMode(c.newMode)&&(d=!0);return d},_isSupportedMode:function(b){if("undefined"===typeof this._supportedModes||
null===this._supportedModes)this._supportedModes=this._metadata.supportedModes?this._metadata.supportedModes.split(" "):["view"];return cre$.internalutil.contains(this._supportedModes,b)},_handleModeChange:function(b,d){var c=!1,a=null;if(null===d||"undefined"===typeof d)d=this._iContext.getiDescriptor().getItemValue(cre$.iwidget.iDescriptor.prototype.iDescriptorItems.mode);if(null===b||"undefined"===typeof b||null!==b&&b===d)return!1;var e=this._metadata.defaultMode;e||(e=this._iContext.constants.mode.View);
var a=this._windowManager[b]||null,f=null,e=!1;"undefined"!==typeof a&&null!==a&&(a=a.root,null!==a&&(f=a,c=e=!0,a.style.display=""));if(!e){if(null===f||"undefined"===typeof f)c=document.createElement("div"),c.className=this._instanceData.moduleId+"Content "+b,this._rootElement.appendChild(c),f=this._rootElement.lastChild;c=this._updateMarkup(b,f)}if(c){var g=this._windowManager[d];null===g||"undefined"===typeof g?(a=cre$.internalutil.getElementsByClass(this._rootElement,d),null!==a&&0<a.length&&
(a=a[0],this._windowManager[d]={id:d,root:a,active:!1},a.style.display="none")):(a=g.root,g.active=!1,a.style.display="none");this._iContext._mode=b;this._iContext.getiDescriptor()._setItemValue(cre$.iwidget.iDescriptor.prototype.iDescriptorItems.mode,b);this._windowManager[b]={id:b,root:f,active:!0};e||this._evalScripts(f);this._invokeOnModeMethod(b);var h={moduleId:this._instanceData.moduleId,newMode:b,oldMode:d};getServiceManager().serviceLoaded(cre$.services.EVENTSERVICE)&&getServiceManager().getService(cre$.services.EVENTSERVICE).then(function(a){a.publishEvent(cre$.constants.event.topic.WIDGET_MODECHANGED,
h)})}return c},_invokeOnModeMethod:function(b){var d=!1,c=this._iContext._iScope;if(c){var a="on"+b;c[a]&&"function"===typeof c[a]?d=!0:(a="on"+b.substr(0,1).toUpperCase()+b.substr(1),c[a]&&"function"===typeof c[a]?d=!0:(a="on"+b.substr(0,1).toLowerCase()+b.substr(1),c[a]&&"function"===typeof c[a]&&(d=!0)));if(d)try{c[a].call(c)}catch(e){console.log("widgetWrapper","_invokeOnModeMethod",this.widgetId+" had an exception in its "+a+" function:\n"+e)}}return d},_handleEventInternal:function(b,d,c){var a=
!1,e=this._iContext._iScope;e&&(e[b]&&"function"===typeof e[b])&&(e[b].call(e,{name:b,type:d,payload:c}),a=!0);return a},_updateMarkup:function(b,d){var c=this._iContext._getMarkupByMode(b);if("undefined"===typeof c||null===c)return null;0===c.indexOf("\x3cscript")&&(c="\x26nbsp;"+c);var a=document.createElement("DIV");a.innerHTML=c;this._iContext._processScripts(a);d.innerHTML=a.innerHTML;cre$.internalutil.destroyNode(a);return!0},_evalScripts:function(b){},predefinedevents:{onLoad:"onLoad",onUnLoad:"onUnload",
onModeChanged:"onModeChanged",onWindowStateChanged:"onWindowStateChanged",onSizeChanged:"onSizeChanged",onNavStateChanged:"onNavStateChanged",onItemSetChanged:"onItemSetChanged",onRefreshNeeded:"onRefreshNeeded",onNewWire:"onNewWire",onRemoveWire:"onRemoveWire",onIncompleteEventDescription:"onIncompleteEventDescription"}};cre$.iwidget.UserProfile=function(a,b){this.widgetId=a;this.user=b.getItemValue("viewer");this._stateSet=b};cre$.iwidget.UserProfile.prototype.getItemValue=function(a){if(!a)return null;var b;Object.prototype.hasOwnProperty.call(this.user,a)&&(b=this.user[a]);"undefined"==typeof b&&(b=null);return b};cre$.iwidget.UserProfile.prototype.setItemValue=function(a,b){if(!a||!b||this.isReadOnly(a))return null;this.user[a]=b;return this};
cre$.iwidget.UserProfile.prototype.isReadOnly=function(a){return this.user.readOnly&&"true"==this.user.readOnly?!0:!1};cre$.iwidget.UserProfile.prototype.getAllNames=function(){var a=[],b;for(b in this.user)Object.prototype.hasOwnProperty.call(this.user,b)&&a.push(b);return a};cre$.iwidget.UserProfile.prototype.removeItem=function(a){return!a||this.isReadOnly(a)?null:Object.prototype.hasOwnProperty.call(this.user,a)?(delete this.user[a],this):null};cre$.iwidget.UserProfile.prototype.save=function(a){return this.commit(a)};
cre$.iwidget.UserProfile.prototype.commit=function(a){};cre$.iwidget.UserProfile.prototype.addListener=function(a){return this._stateSet.addListener(a,this.widgetId)};cre$.iwidget.UserProfile.prototype.removeListener=function(a){return this._stateSet.removeListener(a)};(function(){function l(a){var d=new cre$.promise.Promise("iwService: _render");if(a&&a.getState()===cre$.constants.state.LOADED)d.resolve(a);else{var c=a.getDomId(),e=a.getDomNode()?a.getDomNode():document.getElementById(c);if(e)if(a.getError()){for(var c=a.getError(),e=c.length,b="";e--;)b+=c[e].definitionUrl+" : "+c[e].message+"\n";a.setError({message:b});d.reject(a)}else(new cre$.iwidget.iContext(a,e)).init().then(function(){d.resolve(a)},function(b){a.setError({message:"There was a problem rendering the iWidget. Check that the referenced Javascript for this iWidget is correct. The following Javascript error occurred: "+
b});d.reject(a)});else a.setError({message:"Can't find root element. Dom id is: "+c}),d.reject(a)}return d}function h(a){var d=[],c,e;if((c=cre$.iRuntime.getWidgetById(a))&&(e=c.childrenIds)&&0<e.length)for(c=e.length;c--;)d=d.concat(h(e[c]));return d=d.concat([a])}function m(a,d){var c=cre$.iwidget.internalutil.getDomainAndPath(d);return{name:a,domain:c.domain,path:c.path}}cre$.iwidget.iwidgetService=function(){};cre$.iwidget.iwidgetService.prototype.render=function(a){return l(a)};cre$.iwidget.iwidgetService.prototype.unload=
function(a,d){var c,e,b=cre$.iRuntime.getWidgetRefInternals(),f;for(e in b)if(Object.prototype.hasOwnProperty.call(b,e)&&a===cre$.iRuntime.getWidgetIdByDomId(e)){c=b[e];break}if(c){b=c.getIContext();b._hubContainer&&(cre$.oah.managedHub.getManagedHubInstance().removeContainer(b._hubContainer),b._hubContainer=null);b._cleanSubscription();b.unload();b._tokenRefreshTimer&&cre$.util.unscheduleTokenRefresher(b._tokenRefreshTimer);if(!d){if(b=c.getParentId()){b=cre$.iRuntime.getWidgetById(b).childrenIds;
for(f=b.length;f--;)if(b[f]===a){b.splice(f,1);break}}b=c.getDefinition();f=cre$.iRuntime.getWidgetMetadataRepos();b&&f.getWidgetMetadata(b)&&(1===f.getInstanceNum(b)?f.removeWidgetMetadata(b):f.reduceInstanceNum(b));delete cre$.iRuntime.getWidgetRefInternals()[e]}e=d?cre$.constants.state.PRELOADED:cre$.constants.state.INITIAL;c.changeState(e);c=[];c.push(m("st",a));cre$.iwidget.internalutil.clearCookies(c)}};cre$.iwidget.iwidgetService.prototype.getEvents=function(a,d){a.getModuleId();for(var c=
a.getIContext().iEvents.getEvents(d),e=c.length,b=[],f=null,g=0;g<e;g++)f=c[g],f=new cre$.WidgetEvent({name:f.name,type:f.type,isHandled:f.isHandled,isPublished:f.isPublished,description:f.getDescription()}),b.push(f);return b};cre$.iwidget.iwidgetService.prototype.changeMode=function(a,d){cre$.iRuntime.getWidgetById(a)._iContext.changeMode(d)};cre$.iwidget.iwidgetService.prototype.canUnload=function(a){var d=[];a=h(a);for(var c=a.length,e=null;c--;)(e=cre$.iRuntime.getWidgetById(a[c]))&&e.getState()==
cre$.constants.state.LOADED&&d.push(e.getContainer().getNapromise());return cre$.promise.join(d)};cre$.iwidget.iwidgetService.prototype.preload=function(a){return{widgetArr:a,errorArr:[]}};cre$.iwidget.iwidgetService.prototype.augmentResource=function(a,d,c){var e=null;if(d&&"dojoAMD"==d["cre_ns-sep_iScopeType"]&&a.type===cre$.ResourceManager.constants.resourceType.JAVASCRIPT){a.isDojoAMD=!0;a.iScope=d.iScope;a.modules={};var e=null,b=d.iScope.replace(/\./g,"/"),f=d.resource;if(f&&b)for(var g=f.length;g--;){var h=
f[g].fullUri,k=h.indexOf(b);if(-1!=k){e=h.substring(0,k);break}}if(e)for(b=(d=d.resource)?d.length:0;b--;)f=d[b].fullUri,g=f.indexOf(".js",f.length-3),-1!=g&&(g=f.substring(e.length,g),a.modules[f]=g);else a.error={message:"No widgetRoot found"}}c.resolve()};cre$.iwidget.iwidgetService.prototype.getMetadata=function(a){var d=new cre$.promise.Promise("iwService: getMetadata"),c=cre$.iRuntime.getWidgetRefInternals(),e=null,b;for(b in c)if(Object.prototype.hasOwnProperty.call(c,b)&&c[b].definition===
a){e=c[b];break}e?d.resolve(e):d.reject("Can not get widget metadata of "+a);return d}})();cre$.iwidget.ItemSet=function(a){this._stateSet=a};
cre$.iwidget.ItemSet.prototype={setLocalizedItemValue:function(a,b,c){return this._stateSet.setLocalizedItemValue(a,b,c)},setItemValue:function(a,b,c,d){return c?null:this._stateSet.setLocalizedItemValue(a,b,d)},setItemValue:function(a,b){return this._stateSet.setItemValue(a,b)},getLocalizedItemValue:function(a,b){return this._stateSet.getLocalizedItemValue(a,b)},getItemValue:function(a){return this._stateSet.getItemValue(a)},getItemValue:function(a,b){return this._stateSet.getItemValue(a,b)},removeItem:function(a){return this._stateSet.removeItem(a)},
removeItemValue:function(a,b){return this._stateSet.removeLocalizedItemValue(a,b)},removeItemValue:function(a){return this._stateSet.removeItemValue(a)},removeLocalizedItemValue:function(a,b){return this._stateSet.removeLocalizedItemValue(a,b)},getAllNames:function(){return this._stateSet.getAllItemNames()},getLocalesWithValues:function(a){return(a=this._stateSet.getItem(a))?a.getLocalsWithValues():null}};cre$.iwidget.ManagedItemSet=function(a,b){this._stateSet=a;this._iContext=b};cre$.iwidget.ManagedItemSet.prototype.setItemValue=function(a,b,f){return this._stateSet.setItemValue(a,b,this._iContext._mode)};cre$.iwidget.ManagedItemSet.prototype.getItemValue=function(a,b){return this._iContext._mode===cre$.constants.mode.VIEW?this._stateSet.getItemValue(a):this._stateSet.getItemValue(a,this._iContext._mode,b)};cre$.iwidget.ManagedItemSet.prototype.getAllNames=function(){return this._stateSet.getAllItemNames()};
cre$.iwidget.ManagedItemSet.prototype.removeItem=function(a){return this._stateSet.removeItem(a,this._iContext._mode)};cre$.iwidget.ManagedItemSet.prototype.isReadOnly=function(a){if(null!==this._stateSet.getItem(a))return this._stateSet.getItem(a).isReadOnly();__logging.log("cre$.iwidget.ManagedItemSet","isReadOnly",cre$.LocaleHelper.getLocalizedMessages().LOG_NO_MANAGEDIS,[a],__logging.logLevel.INFO);return!1};
cre$.iwidget.ManagedItemSet.prototype.addListener=function(a){return this._stateSet.addListener(a,this._iContext.getWidgetId())};cre$.iwidget.ManagedItemSet.prototype.removeListener=function(a){return this._stateSet.removeListener(a)};cre$.iwidget.ManagedItemSet.prototype.save=function(a){return this.commit(a)};
cre$.iwidget.ManagedItemSet.prototype.commit=function(a,b){var f=this._stateSet.id,c=this._iContext._mode,c=c===cre$.constants.mode.VIEW?cre$.constants.mode.PERSONALIZE:c;if(c===cre$.constants.mode.CONFIG)for(var d=this._iContext._iRuntime.getStateSets(),e=d.length;e--;)d[e].definitionUrl===this._stateSet.definitionUrl&&(this._iContext._iRuntime.getStateSets()[e].sets.config=this._stateSet.sets.config);if(this._iContext._widgetRefInternal.getRenderType()===cre$.constants.renderType.SANDBOX&&!b){var k=
cre$.iRuntime.inIFrame?cre$.constants.event.topic.SYNC+this._iContext.getWidgetId():cre$.constants.event.topic.STUB_SYNC+this._iContext.getWidgetId(),e=getServiceManager().getService(cre$.services.EVENTSERVICE),g=[cre$.util.clone(this._stateSet)];e.then(function(a){a.publishEvent(k,{methodname:"_handleDataSync",params:g})})}if(!cre$.iRuntime.inIFrame){var m=this._iContext._widgetRefInternal.getModuleId();this.notifyOnItemSetChanged(this._stateSet);if(f===cre$.constants.itemSet.ATTRIBUTES){d=getServiceManager().getService(cre$.services.ITEMSETPERSISTENCE);
if(this._stateSet.levelDef){var e,l=this._stateSet.levelDef.length;for(e=0;e<l&&c!==this._stateSet.levelDef[e];e++);e===l&&(c=this._stateSet.levelDef[l-1])}var h=this;d.then(function(b){b.getItemSets(m,f,c).then(function(e){e.mode=c;var d={name:cre$.constants.itemSet.ONPERSISTENCERESPONSE,type:null,payload:!1,source:h._iContext.getWidgetId()};b.update(m,e).then(function(b){"function"===typeof a&&a(f,!0);d.payload=!0;h.notifyListeners(h._stateSet,d)},function(b){"function"===typeof a&&a(f,!1);h.notifyListeners(h._stateSet,
d)})})})}}};
cre$.iwidget.ManagedItemSet.prototype.notifyOnItemSetChanged=function(a){a.hasOwnProperty("computed")&&(a=a.computed);var b=a.getAllItemNames();if(b){var f={itemSetName:a.id,changes:[]},c=null;a.parent&&(c=a.parent.changes=a.parent.changes?a.parent.changes:[]);for(var d=0,e=b.length;d<e;d++){var k=b[d],g=a.getItem(k);a._dirty&&(g._dirty&&g._change)&&(f.changes.push(g._change),c&&c.push(g._change),a._setItemDirty(k,!1))}delete a._dirty;b={name:cre$.constants.itemSet.ONITEMSETCHANGED,type:null,payload:f,
source:this._iContext.getWidgetId()};this.notifyListeners(a,b)}};cre$.iwidget.ManagedItemSet.prototype.notifyListeners=function(a,b){var f=a.parent&&a.parent.computed===a?a.parent:a,c=f.getListeners(),d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&c[d].call(f,b)};cre$.iwidget.ShareableItemSet=function(a,c,b,d){d&&(this.id=d);b&&(this.id=b.id,this.alias=b.alias?b.alias:this.id,this.defData=b);this.mapping={};this.items={};if(b){d=b.items;var e;a:{for(e in d)if(Object.prototype.hasOwnProperty.call(d,e)){e=!1;break a}e=!0}e&&(d=b.computed.items);for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&(hasMapping=!0,b=f,e=d[f].alias?d[f].alias:null,this.items[f]={id:b},e&&(this.mapping[e]=b,this.items[f].alias=e))}this._iContext=a;this._stateSet=c;this._isDirty=
!1};
cre$.iwidget.ShareableItemSet.prototype={DELETE_TOKEN:cre$.constants.changeType.DELETE_TOKEN,setItemValue:function(a,c){if(!a||!c)return null;"undefined"!==typeof this._isDirty&&!this._isDirty&&(this._isDirty=!0,this._changedItems={});var b=this._resolveMapping(a);b||(b=a);this._changedItems=this._changedItems?this._changedItems:{};this._changedItems[b]=c;return this},getItemValue:function(a){var c=this._resolveMapping(a),b=null;c||(c=a);if(this._isDirty&&this._changedItems){if(this._changedItems[c]&&this._changedItems[c]!==
this.DELETE_TOKEN)return this._changedItems[c];if(this._changedItems[c]&&this._changedItems[c]===this.DELETE_TOKEN)return null}return b=this._stateSet.getItemValue(c)},removeItem:function(a){"undefined"!==typeof this._isDirty&&!this._isDirty&&(this._isDirty=!0,this._changedItems={});var c=this.getAllNames();if(null===c)return null;for(var b=!1,d=0;d<c.length;d++)c[d]===a&&(b=!0);if(!b)return null;(c=this._resolveMapping(a))||(c=a);this._changedItems=this._changedItems?this._changedItems:{};this._changedItems[c]=
this.DELETE_TOKEN;return this},addListener:function(a){var c=this;return this._stateSet.addListener(function(b){var d=b.payload;if(d=d.changes?d.changes:null)for(var e=0;e<d.length;e++)d[e].id=c._convertToLocal(d[e].id);a(b)},this._iContext.getWidgetId())},removeListener:function(a){return this._stateSet.removeListener(a)},getAllNames:function(){var a=this._stateSet.getAllItemNames();if(this._isDirty){for(var c={},b=0;b<a.length;b++){var d=a[b];c[d]=d}if(this._changedItems)for(var e in this._changedItems)this._changedItems[e]&&
this._changedItems[e]===this.DELETE_TOKEN&&c[e]?c[e]=null:this._changedItems[e]&&!c[e]&&(c[e]=e);var a=[],f;for(f in c)Object.prototype.hasOwnProperty.call(c,f)&&a.push(f)}for(c=0;c<a.length;c++)f=a[c],this.mapping[f]&&(a[c]=this.mapping[f]);return 0===a.length?null:a},commit:function(a,c){var b;if(this._isDirty){for(b in this._changedItems)this._changedItems[b]&&this._changedItems[b]===this.DELETE_TOKEN?this._stateSet.removeItem(b):this._changedItems[b]&&this._stateSet.setItemValue(b,this._changedItems[b]);
b=getServiceManager().getService(cre$.services.EVENTSERVICE);var d=null,e=null;cre$.iRuntime.inIFrame?c||(d=cre$.constants.event.topic.SYNC+this._iContext.getWidgetId(),e=[this._stateSet.id,cre$.util.clone(this._changedItems)],b.then(function(a){a.publishEvent(d,{methodname:"_syncLocalShareableItemSet",params:e})})):(this._iContext._isWrapperContext&&!c&&(d=cre$.constants.event.topic.STUB_SYNC+this._iContext.getWidgetId(),e=[this._stateSet.id,cre$.util.clone(this._changedItems)],b.then(cre$.util.partial(function(a,
b,c){c.publishEvent(a,{methodname:"_syncLocalShareableItemSet",params:b})},d,e))),d=cre$.constants.event.topic.BROADCAST_SHAREABLEITEMSET_CHANGE,e=[this._iContext.getWidgetId(),this._stateSet.id,cre$.util.clone(this._changedItems)],b.then(cre$.util.partial(function(a,b,c){c.publishEvent(a,{methodname:"_syncGlobalShareableItemSet",params:b})},d,e)));this._invokeListeners(this._stateSet)}a&&a(this.alias,!0);this._changedItems=null;this._isDirty=!1},_resolveMapping:function(a){return!a||!this.items?
null:this.items[a]&&this.items[a].alias?this.items[a].alias:null},_convertToLocal:function(a){return a&&this.mapping&&this.mapping[a]?this.mapping[a]:a},_invokeListeners:function(a){var c=a.getAllItemNames();if(c){var b={};b.itemSetName=a.id;b.changes=[];for(var d=0,e=c.length;d<e;d++){var f=c[d],g=a.getItem(f);a._dirty&&(g._dirty&&g._change)&&(b.changes.push(g._change),a._setItemDirty(f,!1))}delete a._dirty;var c={name:cre$.constants.predefinedEvents.onItemSetChanged,type:null,payload:b,source:this._iContext.getWidgetId()},
b=a.getListeners(),h;for(h in b)Object.prototype.hasOwnProperty.call(b,h)&&b[h].call(a,c)}}};cre$.iwidget.iDescriptor=function(a,b){cre$.iwidget.ManagedItemSet.call(this,b);this._widgetRefInternal=a};cre$.iwidget.iDescriptor.prototype=new cre$.iwidget.ManagedItemSet;
cre$.iwidget.iDescriptor.prototype.iDescriptorItems={title:cre$.constants.iDescriptorItems.TITLE,name:cre$.constants.iDescriptorItems.NAME,description:cre$.constants.iDescriptorItems.DESCRIPTION,defaultHeight:cre$.constants.iDescriptorItems.DEFAULTHEIGHT,defaultWidth:cre$.constants.iDescriptorItems.DEFAULTWIDTH,displayLocale:cre$.constants.iDescriptorItems.DISPLAYLOCALE,mode:cre$.constants.iDescriptorItems.MODE,author:cre$.constants.iDescriptorItems.AUTHOR,email:cre$.constants.iDescriptorItems.EMAIL,
website:cre$.constants.iDescriptorItems.WEBSITE,version:cre$.constants.iDescriptorItems.VERSION,icon:cre$.constants.iDescriptorItems.ICON,windowState:cre$.constants.iDescriptorItems.WINDOWSTATE,messageLocale:cre$.constants.iDescriptorItems.MESSAGELOCALE,availableMessageLocales:cre$.constants.iDescriptorItems.AVAILABLEMESSAGELOCALES,thumbnail:cre$.constants.iDescriptorItems.THUMBNAIL};
cre$.iwidget.iDescriptor.prototype.readOnlyItems={defaultHeight:cre$.constants.iDescriptorItems.DEFAULTHEIGHT,defaultWidth:cre$.constants.iDescriptorItems.DEFAULTWIDTH,displayLocale:cre$.constants.iDescriptorItems.DISPLAYLOCALE,messageLocale:cre$.constants.iDescriptorItems.MESSAGELOCALE,author:cre$.constants.iDescriptorItems.AUTHOR,email:cre$.constants.iDescriptorItems.EMAIL,website:cre$.constants.iDescriptorItems.WEBSITE,version:cre$.constants.iDescriptorItems.VERSION,icon:cre$.constants.iDescriptorItems.ICON};
cre$.iwidget.iDescriptor.prototype.writableItems={title:cre$.constants.iDescriptorItems.TITLE,name:cre$.constants.iDescriptorItems.NAME,description:cre$.constants.iDescriptorItems.DESCRIPTION,availableMessageLocales:cre$.constants.iDescriptorItems.AVAILABLEMESSAGELOCALES,mode:cre$.constants.iDescriptorItems.MODE,windowState:cre$.constants.iDescriptorItems.WINDOWSTATE};
cre$.iwidget.iDescriptor.prototype.localizedItems={title:cre$.constants.iDescriptorItems.TITLE,name:cre$.constants.iDescriptorItems.NAME,description:cre$.constants.iDescriptorItems.DESCRIPTION};cre$.iwidget.iDescriptor.prototype.isReadOnly=function(a){var b=!1;return b="undefined"===typeof a||null===a?!1:this.readOnlyItems[a]?!0:!1};cre$.iwidget.iDescriptor.prototype.removeItem=function(a){return null};
cre$.iwidget.iDescriptor.prototype.getItemValue=function(a){var b=null;"undefined"===typeof a||null===a?b=null:a===this.iDescriptorItems.displayLocale?b=this._stateSet.getItemValue(a):a===this.iDescriptorItems.messageLocale?b=this._getMessageLocale():a===this.iDescriptorItems.windowState?b=this._getWindowState():this.localizedItems[a]?(b=this._getMessageLocale(),b=this._stateSet.getLocalizedItemValue(a,b)):b=this._stateSet.getItemValue(a);return b};
cre$.iwidget.iDescriptor.prototype._getLocalizedItemValue=function(a,b){if("undefined"===typeof a||null===a||"undefined"===typeof b||null===b)return null;var c=null;this.localizedItems[a]&&(c=this._stateSet.getLocalizedItemValue(a,b));return c};
cre$.iwidget.iDescriptor.prototype.setItemValue=function(a,b){var c=this;if("undefined"===typeof a||null===a||"undefined"===typeof b||null===b)c=null;else if(a===this.iDescriptorItems.mode){var d=this._widgetRefInternal.getSupportedModes();if(d&&cre$.internalutil.contains(d,b))!cre$.iRuntime.inIFrame&&this._widgetRefInternal.getRenderType()===cre$.constants.renderType.SANDBOX?(this._iContext._mode=b,this._iContext.getiDescriptor()._setItemValue(cre$.iwidget.iDescriptor.prototype.iDescriptorItems.mode,
b)):this._iContext._widgetRefInternal.handleModeChange(b,this.getItemValue(this.iDescriptorItems.mode));else throw"The specified mode ["+b+"] is not supported!";}else if(a===this.iDescriptorItems.windowState)if((d=this._widgetRefInternal.getSupportedWindowStates())&&cre$.internalutil.contains(d,b))this._iContext.iEvents.fireEvent(this._iContext.constants.predefinedEvents.onWindowStateChanged,null,b);else throw"The specified widow state ["+b+"] is not supported!";else c=this._setItemValue(a,b);return c};
cre$.iwidget.iDescriptor.prototype._setItemValue=function(a,b){if("undefined"===typeof a||(null===a||"undefined"===typeof b||null===b)||this.readOnlyItems[a])return null;if(this.localizedItems[a]){var c=this._getMessageLocale();this._stateSet.setLocalizedItemValue(a,b,c)}else this._stateSet.setItemValue(a,b);return this};
cre$.iwidget.iDescriptor.prototype._setLocalizedItemValue=function(a,b,c){if(!("undefined"===typeof a||null===a)&&!("undefined"===typeof b||null===b)&&!("undefined"===typeof c||null===c)&&this.localizedItems[a])this._stateSet.setLocalizedItemValue(a,b,c);else return null};
cre$.iwidget.iDescriptor.prototype._getMessageLocale=function(){if(!this.messageLocale){var a=null,a=this._stateSet.getItemValue(this.iDescriptorItems.availableMessageLocales),b=[];a&&(b=a.split(" "));this.messageLocale=a=this._getLocale(b,"en","en")}return this.messageLocale};cre$.iwidget.iDescriptor.prototype._getLocale=function(a,b,c){switch(a.length){case 0:return c;case 1:return a[0];default:return cre$.internalutil.contains(a,b)?b:cre$.internalutil.contains(a,c)?c:a[0]}};
cre$.iwidget.iDescriptor.prototype._getWindowState=function(){return this._iContext.windowState?this._iContext.windowState:cre$.constants.windowstate.NORMAL};
cre$.iwidget.iDescriptor.prototype.commit=function(a,b){if(this._iContext._widgetRefInternal.getRenderType()===cre$.constants.renderType.SANDBOX&&!b){var c=getServiceManager().getService(cre$.services.EVENTSERVICE),d=cre$.iRuntime.inIFrame?cre$.constants.event.topic.SYNC+this._iContext.getWidgetId():cre$.constants.event.topic.STUB_SYNC+this._iContext.getWidgetId(),f={id:cre$.constants.itemSet.IDESCRIPTOR,items:{}},e;for(e in this.writableItems)Object.prototype.hasOwnProperty.call(this.writableItems,
e)&&(f.items[this.writableItems[e]]=this.getItemValue(this.writableItems[e]));c.then(function(a){a.publishEvent(d,{methodname:"_handleDataSync",params:[f]})})}this.notifyOnItemSetChanged(this._stateSet)};(function(){var c=cre$.util,a=window.dojo;c.trim=a?a.trim:String.prototype.trim?function(b){return b.trim()}:function(b){return b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};var d=/\{([^\}]+)\}/g;c.replace=a?a.replace:function(b,a,e){return b.replace(e||d,c.isFunction(a)?a:function(b,d){return c.getObject(d,!1,a)})}})();dojo.require("com.ibm.social.gadget.people._vcard_utils");(function(b){var a=cre$.people_container={};a.getVcard=function(a,c,d,e){return b.generateVcard(a,c,d,e)};gadgets.rpc.register("_ic_cre_people_request_vcard",a.getVcard)})(com.ibm.social.gadget.people._vcard_utils);cre$.osgadget=cre$.osgadget||{};
(function(){function s(a){t(a);u(a);return cre$.iRuntime.getCommonContainer().then(function(b){var c=new cre$.promise.Promise("navPromise"),e=a.getDefinition(),d=a.getDomId();a.getRenderType();var f,h=a.getDomNode()?a.getDomNode():document.getElementById(d);f=a.url?b.newUrlSite(h):a.getGadgetSiteId()?b.sites_[a.getGadgetSiteId()]:0===d.indexOf(cre$.constants.others.GADGET_SITE)?b.newGadgetSite(h):null;var k=a.getViewParams()||{},g=a.getRenderParams()||{},l=null;a.isSandboxAttrEnabled()&&(g.isSandboxAttrEnabled=
!0);if(!f){f=(new Date).getTime()+"";7<f.length&&(f=f.substr(f.length-7,7));f=f+""+p;p++;var m=document.createElement("div");m.setAttribute(cre$.constants.resource.resourceType.ID,cre$.constants.others.GADGET_SITE+f);h.innerHTML="";h.appendChild(m);f=b.newGadgetSite(m)}a.getCallback()&&window[a.getCallback()]?l=window[a.getCallback()]:cre$.iRuntime._getGadgetLoadedCallbacks()[d]&&(l=cre$.iRuntime._getGadgetLoadedCallbacks()[d]);try{if(g.renderType=g.renderType||a.getRenderType()||"default",a.url)b.navigateUrl(f,
a.url,g),c.resolve("navigated to Url");else if(a.getEEDataModel()){var n=a.getEEDataModel();n.url?g.urlRenderParams||(g.urlRenderParams=q(g)):(n.gadget=e,g.gadgetRenderParams||(g.gadgetRenderParams=q(g)));g.gadgetViewParams||(g.gadgetViewParams=k);b.ee.navigate(f.el_,n,g,function(a,b){l=l||function(){};l(a,b);var f={site:a,data:b};null===b||null!==b&&b.error?c.reject(f):c.resolve(f)})}else b.navigateGadget(f,e,k,g,function(a){l=l||function(){};l(a);c.resolve(a)})}catch(r){__logging.log("cre$.osgadget",
"_render",r),c.reject(r)}return c.then(function(b){return a},function(b){a.setError({message:"render gadget error."});return a})})}function t(a){var b=a.getLoadInstanceData();b&&(a.removeLoadInstanceData(),a.parseLoadInstanceData(b))}function u(a){if(a&&!(a.getTopics()&&0<a.getTopics().length)&&a.getResponse()){var b=a.getResponse();if(b.modulePrefs&&(b.modulePrefs.features&&b.modulePrefs.features["pubsub-2"])&&(b=b.modulePrefs.features["pubsub-2"],b.params&&b.params.topics)){var c=b.params.topics,
b=c.length,e=0,d=document.createElement("div");d.style.display="none";document.body.appendChild(d);for(e=0;e<b;e++){var f=document.createElement("span");f.innerHTML=c[e];d.appendChild(f)}c=document.getElementsByTagName(cre$.constants.osgadgetItems.TOPIC);b=c.length;if(0<b){a.setTopics([]);for(e=0;e<b;e++){var f={},h=c[e].parentNode;h&&(h.parentNode&&h.parentNode===d)&&(f.name=c[e].getAttribute(cre$.constants.osgadgetItems.NAME),f.title=c[e].getAttribute(cre$.constants.osgadgetItems.TITLE),f.type=
c[e].getAttribute(cre$.constants.osgadgetItems.TYPE),c[e].getAttribute(cre$.constants.osgadgetItems.SUBSCRIBE)?f.subscribe=Boolean(c[e].getAttribute(cre$.constants.osgadgetItems.SUBSCRIBE)):f.subscribe=!1,c[e].getAttribute(cre$.constants.osgadgetItems.PUBLISH)?f.publish=Boolean(c[e].getAttribute(cre$.constants.osgadgetItems.PUBLISH)):f.publish=!1,f.description=c[e].getAttribute(cre$.constants.osgadgetItems.DESCRIPTION),f.aboutUrl=c[e].getAttribute(cre$.constants.osgadgetItems.ABOUTURL),a.getTopics().push(f))}}cre$.internalutil.destroyNode(d)}}}
function q(a){var b={},c;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b}function v(a,b,c){var e=new cre$.promise.Promise("osgService: _preload");c=[];for(var d=b.length;d--;)b[d].getDefinition()&&c.push(b[d].getDefinition());a.preloadGadgets(c,function(a){for(var c=[],d=[],g=b.length,k;g--;)(k=b[g].getDefinition())?a[k]?a[k].error?(b[g].setError(a[k].error),b[g].setState(cre$.constants.state.ERROR),d.push(b[g])):b[g].getDomId()&&(b[g].setResponse(a[k]),c.push(b[g])):(b[g].setError({message:"No response from preloadGadgets"}),
b[g].setState(cre$.constants.state.ERROR),d.push(b[g])):c.push(b[g]);a={widgetArr:c,errorArr:d};0<d.length?e.reject(a):e.resolve(a)});return e}function w(a,b){var c,e,d;d=cre$.iRuntime.getWidgetRefInternals();for(e in d)if(Object.prototype.hasOwnProperty.call(d,e)&&a===cre$.iRuntime.getWidgetIdByDomId(e)){c=d[e];break}if(c)return d=cre$.iRuntime.getCommonContainer().then(function(d){var h=d.sites_;cre$.iRuntime._getGadgetLoadedCallbacks()[c.getDomId()]&&delete cre$.iRuntime._getGadgetLoadedCallbacks()[c.getDomId()];
h[a]&&(c.getEEContext()?d.ee.close(h[a]):d.closeGadget(h[a]));b||(d.unloadGadget(c.getDefinition()),d=c.getDefinition(),h=cre$.iRuntime.getWidgetMetadataRepos(),d&&h.getWidgetMetadata(d)&&(1===h.getInstanceNum(d)?h.removeWidgetMetadata(d):h.reduceInstanceNum(d)),delete cre$.iRuntime.getWidgetRefInternals()[e]);c.changeState(cre$.constants.state.PRELOADED);return[c.getWidgetRef()]})}function m(a,b,c){return a&&"undefined"!==typeof a[b]?a[b]:c}var k=cre$.osgadget,p=0;k.gadgetService=function(){};k.gadgetService.prototype.render=
function(a){return s(a)};k.gadgetService.prototype.unload=function(a,b){return w(a,b)};k.gadgetService.prototype.augmentResource=function(a,b,c){c.resolve()};k.gadgetService.prototype.getEvents=function(a,b){var c=cre$.iRuntime.getWidgetRefInternals()[a.widgetRefInternal.getDomId()].getTopics(),e=[],d=null;if(c&&0<c.length)for(var f=c.length,h=0;h<f;h++){d=c[h];if(b){if(b.name&&d.name!==b.name)break;if(b.type&&d.type!==b.type)break;if("undefined"!==typeof b.isHandled&&d.subscribe!==b.isHandled)break;
if("undefined"!==typeof b.isPublished&&d.publish!==b.isPublished)break}d=new cre$.WidgetEvent({name:d.name,type:d.type,isHandled:d.subscribe,isPublished:d.publish,description:d.description});e.push(d)}return e};k.gadgetService.prototype.canUnload=function(a){return cre$.promise.resolved(!0)};k.gadgetService.prototype.preload=function(a,b){return cre$.iRuntime.getCommonContainer().then(function(c){return v(c,a,b)},function(){for(var b=a.length,e=[];b--;)e.push({domId:a[b].domId,error:{message:"Can't get common container."}});
return{widgetArr:[],errorArr:e}})};k.gadgetService.prototype.getMetadata=function(a){var b=new cre$.promise.Promise("osgService: getMetadata");cre$.iRuntime.getCommonContainer().then(function(c){c.getGadgetMetadata(a,function(a){b.resolve(a)})});return b};k._containerName="container";k.gadgetService.prototype.configCommonContainer=function(a,b){var c=cre$.promise.resolved(a);cre$.commoncontainer=a;a.managedHub=cre$.oah.managedHub.getManagedHubInstance();gadgets.pubsub2router.init({hub:a.managedHub});
if(m(b,"configInlineOAH",!0))try{a.managedHub.getContainer(k._containerName)||(a.inlineClient=new OpenAjax.hub.InlineContainer(a.managedHub,k._containerName,{Container:{onSecurityAlert:function(a,b){},onConnect:function(a){},onDisconnect:function(a){}}}),a.inlineClient.connect())}catch(e){__logging.log("cre$.osgadget","_getCommonContainer",e)}m(b,"configSecurityToken",!0)&&(c=cre$.internalutil.checkContainerToken().then(function(b){a.updateContainerSecurityToken(null,cre$.internalutil.getCREContainerToken().token,
cre$.config.MAX_TOKEN_TTL);return a}));var d=m(b,"commonContainerViewOverrides",!1);d&&a.views&&(d.createElementForGadget&&(a.views.createElementForGadget=d.createElementForGadget),d.createElementForUrl&&(a.views.createElementForUrl=d.createElementForUrl),d.createElementForEmbeddedExperience&&(a.views.createElementForEmbeddedExperience=d.createElementForEmbeddedExperience),d.destroyElement&&(a.views.destroyElement=d.destroyElement));return c}})();osapi.container.Container.addMixin("SharedScriptFrame",function(e){var g={},h=function(a,c){var b,d={};d[a.toLowerCase()]=1;if(c&&c.params&&(b=c.params.participant))if("string"==typeof b)d[b.toLowerCase()]=1;else for(var f=0,e;e=b[f];f++)d[e.toLowerCase()]=1;b=[];for(f in d)b.push(f);return b.sort().join("")},k={};k[osapi.container.CallbackType.ON_BEFORE_RENDER]=function(a){var c=a.url;try{var b=a.modulePrefs.features["shared-script-frame"],d=a.modulePrefs.features["locked-domain"]}catch(f){}b&&(a=
b,b=h(c,d),g[b]||(d=osapi.container.GadgetSite.DEFAULT_VIEW_,a.params&&a.params.view&&(d=a.params.view[0]),a=document.createElement("div"),a.style.display="none",document.body.appendChild(a),a=g[b]=e.newGadgetSite(a),b={},b[osapi.container.RenderParam.VIEW]=d,e.navigateGadget(a,c,void 0,b)))};e.addGadgetLifecycleCallback("shared-script-frame-setup",k);e.rpcRegister("get_script_frame_name",function(a){a=a.gs.getActiveSiteHolder().getGadgetInfo();a=h(a.url,a.modulePrefs.features["locked-domain"]);var c;
(a=g[a])&&(c=a.getActiveSiteHolder().getIframeId());return c});return{}});osapi.container.Container.prototype.setupNonGadgetRpcEndpoint=function(){var a=this;gadgets.rpc.setUpRpcIdsForNonGadgetIframe=function(c,d,b,e){a.sites_[d]={getActiveSiteHolder:function(){return{getUrl:function(){return b},getIframeId:function(){return c}}}};a.service_.cachedMetadatas_[b]={rpcServiceIds:e}}};cre$.iwidget.iEvents=function(a,c){this._widgetId=c;this._widgetObjName="_"+this._widgetId+"_iContext";this._events=[];this._widget=a;for(var b=window[this._widgetObjName]._widgetRefInternal.getEvent()||[],d=window[this._widgetObjName]._widgetRefInternal.getEventDescription()||[],k=b.length,m=d.length,l=0;l<k;l++){var f={},e=b[l];f.name=e.id;f.alias=e.id;cre$.util.isString(e.handled)&&(f.isHandled="true"===e.handled?!0:!1);cre$.util.isString(e.published)&&(f.isPublished="true"===e.published?!0:!1);
e.onNewWire&&(f.onNewWire=e.onNewWire);e.onRemoveWire&&(f.onRemoveWire=e.onRemoveWire);e.onEvent&&(f.handlingFn=e.onEvent);for(var g=0;g<m;g++){var h=d[g];if(h.id===e.eventDescName){f.type=h.payloadType;f._attr={};f._attr[h.lang]={};f._attr[h.lang][window[this._widgetObjName].constants.event.TITLE]=h.title;f._attr[h.lang][window[this._widgetObjName].constants.event.DESCRIPTION]=h.description;if(h.alt){e=h.alt.length;for(g=0;g<e;g++)f._attr[h.alt[g].lang]={},f._attr[h.alt[g].lang][window[this._widgetObjName].constants.event.TITLE]=
h.alt[g].title,f._attr[h.alt[g].lang][window[this._widgetObjName].constants.event.DESCRIPTION]=h.alt[g].description}break}}f=new cre$.iwidget.iEventDescription(f);this._events.push(f)}};
cre$.iwidget.iEvents.prototype={fireEvent:function(a,c,b){if("string"===typeof b){var d=cre$.internalutil.parseToJson(b);!1!==d&&(b=d)}cre$.config.BROADCASTALLEVENTS?getServiceManager().getService(cre$.services.EVENTSERVICE).then(cre$.util.hitch(this,function(a,d){d.broadcastEvent(a,b,c);this.publishEvent(a,b,c)},a)):this.publishEvent(a,b,c)},_findEventDesc:function(a,c){if(cre$.util.isArray(a)&&0<a.length)for(var b=0;b<a.length;b++){var d=a[b];if(d.name===c)return d}return null},setEvent:function(a){if(!a.name||
!a.type)return __logging.log("cre$.iwidget.iEvents","setEvent",cre$.LocaleHelper.getLocalizedMessages().ERR_EVENT_NAME_TYPE_MISSING),!1;"function"!==typeof a.getDescription&&(a=new cre$.iwidget.iEventDescription(a));var c=this._events.length;if(0===c)this._events.push(a),this._createEventInWidgetInstance(a);else{for(var b=!1,d=0;d<c;d++)if(this._events[d].name===a.name){this._events[d]=a;b=!0;break}!1===b&&(this._events.push(a),this._createEventInWidgetInstance(a))}return!0},setEvents:function(a){for(var c=
a.length,b=0;b<c;b++)if(!this.setEvent(a[b]))return __logging.log("cre$.iwidget.iEvents","setEvents",cre$.LocaleHelper.getLocalizedMessages().ERR_EVENT_FORMAT),!1;return!0},removeEvent:function(a){if(!a||""===a)return __logging.log("cre$.iwidget.iEvents","removeEvent",cre$.LocaleHelper.getLocalizedMessages().ERR_REMOVE_EVENT_EMPTY_NAME),!1;var c=this._events.length;if(0===c)return __logging.log("cre$.iwidget.iEvents","removeEvent",cre$.LocaleHelper.getLocalizedMessages().ERR_REMOVE_EVENT_NO_EVENT),
!1;for(var b=!1;c--;)if(this._events[c].name===a){b=!0;this._removeEventFromWidgetInstance(this._events[c]);delete this._events[c];this._events.splice(c,1);break}return!b?(__logging.log("cre$.iwidget.iEvents","removeEvent",cre$.LocaleHelper.getLocalizedMessages().ERR_REMOVE_EVENT_NOT_EXIST,[a]),!1):!0},removeEvents:function(a){for(var c=a.length,b=0;b<c;b++)if(!this.removeEvent(a[b]))return __logging.log("cre$.iwidget.iEvents","removeEvents",cre$.LocaleHelper.getLocalizedMessages().ERR_REMOVE_EVENT),
!1;return!0},getEvents:function(a){var c=this._events.length;if(0===c)return[];for(var b=[],d=0;d<c;d++){var k=!0,m;for(m in a)Object.prototype.hasOwnProperty.call(a,m)&&this._events[d][m]!==a[m]&&(k=!1);k&&b.push(this._events[d])}return b},createEventDescription:function(a){if(!a.name&&!a.type)return __logging.log("cre$.iwidget.iEvents","createEventDescription",cre$.LocaleHelper.getLocalizedMessages().ERR_EVENT_NAME_TYPE_REQUIRED_DESCITEM),null;for(var c=this._events.length,b=0;b<c;b++)if(this._events[b].name===
a.name)return __logging.log("cre$.iwidget.iEvents","createEventDescription",cre$.LocaleHelper.getLocalizedMessages().ERR_EVENT_ALREADY_EXISTED),null;a._attr={};var d;if(a.localizedAttributes)if(c=a.localizedAttributes.length)for(b=0;b<c;b++){var k=a.localizedAttributes[b];for(d in k)Object.prototype.hasOwnProperty.call(k,d)&&(a._attr[d]=k[d])}else for(d in a.localizedAttributes)Object.prototype.hasOwnProperty.call(a.localizedAttributes,d)&&(a._attr[d]=a.localizedAttributes[d]);if(a.attributes)for(d in a.attributes)Object.prototype.hasOwnProperty.call(a.attributes,
d)&&(a._attr[d]=a.attributes[d]);return new cre$.iwidget.iEventDescription(a)},publishEvent:function(a,c,b){getServiceManager().getService(cre$.services.EVENTSERVICE).then(cre$.util.hitch(this,function(a,d){var l=cre$.iRuntime.getWires();if(l&&l.wires)for(var l=cre$.iRuntime.getWires().wires,f=l.length,e=0;e<f;e++)if(l[e].sourceWidget===this._widgetId&&l[e].sourceEvent===a){var g={};g.name=l[e].targetEvent;g.payload=c;g.type=b;g.source=this._widgetId;d.publishEvent(this._widgetId+"_"+a+"_"+l[e].targetWidget+
"_"+l[e].targetEvent,g)}},a));var d={payload:c,payloadType:b};cre$.iRuntime.getWires().addQueuedEvent(this._widgetId,a,d)},_removeEventFromWidgetInstance:function(a){var c=cre$.iRuntime.getWidgetRefInternals()[window[this._widgetObjName]._widgetRefInternal.getDomId()].getInstanceMetadata();if(c.dynamicEvents)for(var c=c.dynamicEvents,b=c.length;b--;)if(c[b].name===a.name){delete c[b];c.splice(b,1);break}},_createEventInWidgetInstance:function(a){var c=cre$.iRuntime.getWidgetRefInternals()[window[this._widgetObjName]._widgetRefInternal.getDomId()].getInstanceMetadata();
c.dynamicEvents||(c.dynamicEvents=[]);for(var b=c.dynamicEvents.length,d=0;d<b;d++)if(c.dynamicEvents[d].name===a.name)return __logging.log("cre$.iwidget.iEvents","_createEventInWidgetInstance",cre$.LocaleHelper.getLocalizedMessages().ERR_DYN_EVENT_ALREADY_EXIST),!1;c.dynamicEvents.push({name:a.name,type:a.type});return!0},_getDynamicEvents:function(){for(var a=this._events.length,c=[],b=0;b<a;b++){var d;a:{d=this._events[b];var k=window[this._widgetObjName]._widgetRefInternal.getEvent();if(k&&0<
k.length)for(var m=0;m<k.length;m++)if(k[m].name===d.name){d=!0;break a}d=!1}d||c.push(this._events[b])}return c}};cre$.iwidget.iEventDescription=function(a){this.name=a.name;this.alias=a.alias||null;this.type=a.type;this.lang=a.lang||"en";this.handlingFn=a.handlingFn||"";this.isHandled=!1;this.isPublished=!0;"undefined"!==typeof a.isHandled&&(this.isHandled=a.isHandled,this.isPublished=!1);"undefined"!==typeof a.isPublished&&(this.isPublished=a.isPublished);""!==this.handlingFn&&(this.isHandled=!0);this.onNewWire=a.onNewWire||null;this.onRemoveWire=a.onRemoveWire||null;this._attr=a._attr||{}};
cre$.iwidget.iEventDescription.prototype={getDescription:function(a){return a&&this._attr[a]?this._attr[a].description:this._attr.en&&this._attr.en.description?this._attr.en.description:null},setAttribute:function(a,b,c){c?(this._attr[c]||(this._attr[c]={}),this._attr[c][a]=b):this._attr[a]=b},getAttribute:function(a,b){if(b&&this._attr[b]&&this._attr[b][a])return this._attr[b][a];if(this._attr.en&&this._attr.en[a])return this._attr.en[a];if(this._attr[a])return this._attr[a];if(a===cre$.constants.event.DESCRIPTION)return this.name;
__logging.log("cre$.iwidget.iEventDescription","getAttribute",cre$.LocaleHelper.getLocalizedMessages().ERR_NOT_FIND_ATTRIBUTE,[a]);return null}};cre$.iwidget.iEvent=function(a,b,c,d){this.name=a;this.type=b||null;this.payload=c||null;this.source=d||""};gadgets.window=gadgets.window||{};
(function(){function h(c,d){var e=navigator,a=e.appVersion,e=parseFloat(e.userAgent.split("WebKit/")[1])||void 0,a=parseFloat(a.split("MSIE ")[1])||void 0,a=(e?function(a){var b;if(a.nodeType==DOM_ELEMENT_NODE){var c=a.ownerDocument.defaultView;b=c.getComputedStyle(a,null);!b&&a.style&&(a.style.display="",b=c.getComputedStyle(a,null))}return b||{}}:a&&!window.getComputedStyle?function(a){return a.nodeType==DOM_ELEMENT_NODE?a.currentStyle:{}}:function(a){return a.nodeType==DOM_ELEMENT_NODE?a.ownerDocument.defaultView.getComputedStyle(a,
null):{}})(c);return d&&a?a[d]:a}function k(c,d){var e=h(c,d);if(e)return e.match(/^([0-9]+)/),parseInt(RegExp.$1,10)}gadgets.window.getDimen=function(c){for(var d=0,e=[document.body];0<e.length;){var a=e.shift(),l=a.childNodes;if("undefined"!==typeof a.style&&a!==document.body){var b=a.style[c?"overflowY":"overflowX"];b||(b=h(a,c?"overflowY":"overflowX"));if("visible"!=b&&"inherit"!=b&&((b=a.style[c?"height":"width"])||(b=h(a,c?"height":"width")),b&&0<b.length&&"auto"!=b))continue}for(a=0;a<l.length;a++){var f=
l[a];if("undefined"!=typeof f.style){var g=f.offsetTop,m="marginBottom",b=f.offsetHeight,n=h(f,"direction");c||(g=f.offsetLeft,m="marginRight",b=f.offsetWidth,"rtl"==n&&("undefined"!=typeof g&&"undefined"!=typeof b&&f.offsetParent)&&(g=f.offsetParent.offsetWidth-g-b));"undefined"!=typeof g&&"undefined"!=typeof b&&(b=g+b+(k(f,m)||0),d=Math.max(d,b))}e.push(f)}}return d+(k(document.body,c?"borderBottom":"borderRight")||0)+(k(document.body,c?"marginBottom":"marginRight")||0)+(k(document.body,c?"paddingBottom":
"paddingRight")||0)};gadgets.window.getViewportDimensions=function(){var c=0,d=0;self.innerHeight?(c=self.innerWidth,d=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(c=document.documentElement.clientWidth,d=document.documentElement.clientHeight):document.body&&(c=document.body.clientWidth,d=document.body.clientHeight);return{width:c,height:d}}})();gadgets.window=gadgets.window||{};(function(){gadgets.window.getHeight=function(){return gadgets.window.getDimen(1)}})();dojo.require("com.ibm.social.sharebox._dialog_utils");
(function(b){var c={};osapi.container.Container.addMixin("ibm.connections.sharedialog",function(a){a.rpcRegister("_sharedialog_register",function(a){c[a.f]=1});b.onClose=function(){for(var b in c)a.getGadgetSiteByIframeId_(b)?gadgets.rpc.call(b,"_sharedialog_onClose"):delete c[b]};b.onForceResize=function(b){var e,d;for(d in c)(e=a.getGadgetSiteByIframeId_(d))&&e.id_==b&&gadgets.rpc.call(d,"_sharedialog_onForceResize")}});gadgets.rpc.register("_sharedialog_addActivityEntry",function(a){a&&a.itemId&&
b.shareAddActivityEntry(a.itemId)});gadgets.rpc.register("_sharedialog_close",function(){b.close()});gadgets.rpc.register("_sharedialog_displayMessage",function(a){a&&(dojo.isString(a.message)&&0<a.message.length)&&b.displayMessage(a.type||"info",a.message)});gadgets.rpc.register("_sharedialog_setDirty",function(a){a&&b.setDirty(a.actionId,!0===a.isDirty)});gadgets.rpc.register("_sharedialog_setSubmitState",function(a){b.setSubmitState(a.inProgress)})})(com.ibm.social.sharebox._dialog_utils.getInstance());dojo.require("com.ibm.social.sharebox._dialog_utils");(function(b){gadgets.rpc.register("_sharedialog_displayMessageNode",function(a){a&&a.messageHtml&&b.displayMessageHtml(a.type,a.messageHtml)})})(com.ibm.social.sharebox._dialog_utils.getInstance());gadgets.pubsub2router=function(){return{init:function(a){this.hub=a.hub?a.hub:new OpenAjax.hub.ManagedHub({onPublish:a.onPublish,onSubscribe:a.onSubscribe,onUnsubscribe:a.onUnsubscribe})}}}();(function(){function h(a){"function"===typeof a&&d.push(a)}function k(a){for(var b=0,c;c=d[b];b++)if(c===a){d.splice(b,1);break}}var e,d=[],f={};osapi.container.Container.addMixin("selection",function(a){function b(c){e=c;for(var b=0;d[b];b++)d[b](c);for(var g in f)a.getGadgetSiteByIframeId_(g)?gadgets.rpc.call(g,"gadgets.selection.selectionChanged",null,c):delete f[g]}a.rpcRegister("gadgets.selection.set",function(c,a){b(a)});a.rpcRegister("gadgets.selection.register",function(a){f[a.f]=1;return e});
return{setSelection:b,getSelection:function(){return e},addListener:h,removeListener:k}})})();osapi.container.actions={};osapi.container.actions.OptParam={};osapi.container.actions.OptParam.VIEW="view";osapi.container.actions.OptParam.VIEW_TARGET="viewTarget";(function(){function r(a){var c=!0;if(a){var b=a.path,d=a.dataType;if(!a.id||!b&&!d)c=!1}else c=!1;return c}function s(a,c){if(r(a)){g.addAction(a,c);t([a]);for(var b in k)k.hasOwnProperty(b)&&(f.getGadgetSiteByIframeId_(b)?gadgets.rpc.call(b,"actions.onActionShow",null,[a]):delete k[b])}}function u(a){var c=g.getItemById(a);g.removeAction(a);v([c]);for(var b in l)l.hasOwnProperty(b)&&(f.getGadgetSiteByIframeId_(b)?gadgets.rpc.call(b,"actions.onActionHide",null,[c]):delete l[b])}function w(a,c){!c&&
(f&&f.selection)&&(c=f.selection.getSelection());var b=m[a],d;if(b)for(d=0;d<b.length;d++){var e=b[d];e.call(null,a,c)}for(d=0;d<n.length;d++)e=n[d],e.call(null,a,c);if(b=g.getGadgetSites(a))for(d=0;d<b.length;d++)(e=b[d].getActiveSiteHolder())&&gadgets.rpc.call(e.getIframeId(),"actions.runAction",null,a,c)}var m={},n=[],h={};h[osapi.container.CallbackType.ON_PRELOADED]=function(a){for(var c in a)if(a.hasOwnProperty(c)){var b=a[c];if(!b.error&&b.modulePrefs&&(b=(b=b.modulePrefs.features.actions)&&
b.params?b.params["action-contributions"]:null)){"string"!==typeof b&&(b=b.toString());b=b.replace(/\n/g,"");b=b.replace(/\s+</g,"\x3c");b=b.replace(/>\s+/g,"\x3e");-1===b.indexOf("\x3cactions\x3e")&&(b="\x3cactions\x3e"+b+"\x3c/actions\x3e");var d;try{d=opensocial.xmlutil.parseXML(b)}catch(e){}if(d&&(b=gadgets.json.xml.convertXmlToJson(d).actions))for(var b=[].concat(b.action),f=0;f<b.length;f++){var p=b[f],h={},k;for(k in p)p.hasOwnProperty(k)&&(h[k.substring(1)]=p[k]);g.getItemById(h.id)?gadgets.warn(["Duplicated gadget action [",
h.id,"] detected, make sure the gadget actions have unique ids."].join("")):s(h,c)}}}};h[osapi.container.CallbackType.ON_NAVIGATED]=function(a){var c=a.getActiveSiteHolder();c&&(c=c.getUrl(),g.addGadgetSite(c,a))};h[osapi.container.CallbackType.ON_BEFORE_CLOSE]=function(a){a=a.getId();g.removeGadgetSite(a)};h[osapi.container.CallbackType.ON_UNLOADED]=function(a){a=g.getActionsByUrl(a);for(var c=0;c<a.length;c++)u(a[c].id)};var t=function(a){},k={},v=function(a){},l={},x=function(a,c){},g=new function(){this.registryById=
{};this.registryByPath={};this.registryByDataType={};this.registryByUrl={};this.urlToSite={};this.actionToUrl={};this.addAction=function(a,c){if(r(a)){var b=a.id,d=a.path,e=a.dataType;if(d){for(var e=d.split("/"),d=this.registryByPath,f=0;f<e.length;f++){var g=e[f];d[g]||(d[g]={});d=d[g]}e=d["@actions"];d["@actions"]=e?e.concat(a):[a]}else e&&(this.registryByDataType[e]=this.registryByDataType[e]?this.registryByDataType[e].concat(a):[a]);this.registryById[b]=a;c&&(this.actionToUrl[b]=c,this.registryByUrl[c]=
this.registryByUrl[c]?this.registryByUrl[c].concat(a):[a])}};this.removeAction=function(a){var c=this.registryById[a];delete this.registryById[a];var b=c.path;if(b){var b=this.getActionsByPath(b),d=b.indexOf(c);-1!=d&&b.splice(d,1)}else{var d=c.dataType,e=this.registryByDataType[d],b=e.indexOf(c);e.splice(b,1);0==e.length&&delete this.registryByDataType[d]}if(d=this.actionToUrl[a])delete this.actionToUrl[a],a=this.registryByUrl[d],b=a.indexOf(c),a.splice(b,1),0==a.length&&delete this.registryByUrl[d]};
this.getItemById=function(a){return(this.registryById?this.registryById:{})[a]};this.getAllActions=function(){var a=[];for(actionId in this.registryById)this.registryById.hasOwnProperty(actionId)&&(a=a.concat(this.registryById[actionId]));return a};this.getActionsByPath=function(a){var c=[];a=a.split("/");for(var b=this.registryByPath?this.registryByPath:{},d=0;d<a.length;d++){var e=a[d];if(b[e])b=b[e];else return c}b&&(c=b["@actions"]);return c};this.getActionsByDataType=function(a){var c=[];this.registryByDataType[a]&&
(c=this.registryByDataType[a]);return c};this.getActionsByUrl=function(a){var c=[];this.registryByUrl[a]&&(c=c.concat(this.registryByUrl[a]));return c};this.addGadgetSite=function(a,c){var b=this.urlToSite[a];this.urlToSite[a]=b?b.concat(c):[c]};this.removeGadgetSite=function(a){for(var c in this.urlToSite)if(this.urlToSite.hasOwnProperty(c)){var b=this.urlToSite[c];if(b)for(var d=0;d<b.length;d++){var e=b[d];e&&e.getId()==a&&(b.splice(d,1),0==b.length&&delete this.urlToSite[c])}}};this.getGadgetSites=
function(a){var c=this.getItemById(a),b=[];if(a=this.urlToSite[this.actionToUrl[a]])for(var d=0;d<a.length;d++){var e=a[d],f=e.getActiveSiteHolder();(!c.view||f&&f.getView()===c.view)&&b.push(e)}return b};this.getUrl=function(a){return this.actionToUrl[a]}},q={},f=null;osapi.container.Container.addMixin("actions",function(a){f=a;f.rpcRegister("actions.registerHideCallback",function(c){l[c.f]=1});f.rpcRegister("actions.registerShowCallback",function(c){k[c.f]=1});f.rpcRegister("actions.bindAction",
function(c,b){var a=b.id;if(g.getItemById(a)){var e=q[a];e&&(w(a,e.selection),delete q[a])}else s(b)});f.rpcRegister("actions.get_actions_by_type",function(c,a){return[].concat(g.getActionsByDataType(a))});f.rpcRegister("actions.get_actions_by_path",function(c,a){return[].concat(g.getActionsByPath(a))});f.rpcRegister("actions.removeAction",function(c,a){return u(a)});f.rpcRegister("actions.runAction",function(a,b,d){f.actions.runAction(b,d)});f.addGadgetLifecycleCallback&&f.addGadgetLifecycleCallback("actions",
h);return{registerShowActionsHandler:function(a){"function"===typeof a&&(t=a)},registerHideActionsHandler:function(a){"function"===typeof a&&(v=a)},registerNavigateGadgetHandler:function(a){"function"===typeof a&&(x=a)},runAction:function(a,b){var d=g.getItemById(a);if(d){var e=g.getGadgetSites(a);if(!e||0===e.length){e=g.getUrl(a);q[a]={selection:b||f.selection.getSelection()};var h={};d.view&&(h[osapi.container.actions.OptParam.VIEW]=d.view);d.viewTarget&&(h[osapi.container.actions.OptParam.VIEW_TARGET]=
d.viewTarget);x(e,h)}else w(a,b)}},getAction:function(a){return g.getItemById(a)},getAllActions:function(){return g.getAllActions()},getActionsByPath:function(a){return g.getActionsByPath(a)},getActionsByDataType:function(a){return g.getActionsByDataType(a)},addListener:function(a,b){if(a&&"function"!=typeof a)throw Error("listener param must be a function");b?(m[b]=m[b]||[]).push(a):n.push(a)},removeListener:function(a){a=listeners.indexOf(a);-1!=a&&listeners.splice(a,1)}}})})();(function(){gadgets.rpc.register("_conn_ee_close_popup",function(){dojo.publish("com/ibm/social/ee/event/closePopup",[])})})();(function(){gadgets.rpc.register("_conn_ee_activityentry_update",function(a,b){dojo.publish("com/ibm/social/ee/event/updateActivityEntry",[a,b])});gadgets.rpc.register("_conn_ee_setdirty",function(a){dojo.publish("com/ibm/social/ee/event/setDirty",[a])});gadgets.rpc.register("_conn_ee_scrollTop",function(){dojo.publish("com/ibm/social/ee/event/scrollTop",[])});gadgets.rpc.register("_conn_ee_scrollBottom",function(){dojo.publish("com/ibm/social/ee/event/scrollBottom",[])})})();cre$.messages={ERR_CC_NOT_LOADED:"The common container for the gadget cannot load properly.",ERR_WIDGET_NOT_EXIST:"A widget associated with the Document Object Model (DOM) ID cannot be found.",ERR_LOAD_ITEMSET_SRC:"An error occurred when loading a script for the ItemSet API.",ERR_LOAD_EVENT_SRC:"An error occurred when loading a script for an API that supports events.",ERR_ISCOPE_METHOD_NOT_DEFINED:"An error occurred when the iScope object attempted to invoke a method that is defined by the widget.",
LOG_WIRE_NOT_INIT:"A wire required for the page has not been created yet.",ERR_EVENT_NAME_TYPE_MISSING:"An error occurred because the event name and type parameters are missing when calling the iEvents.setEvent API.",ERR_EVENT_FORMAT:"An error occurred because the event format parameter is missing when calling the iEvents.setEvent API.",ERR_REMOVE_EVENT:"An error occurred when attempting to remove an event.",ERR_REMOVE_EVENT_EMPTY_NAME:"The value of the eventName parameter that is passed to the iEvents.removeEvent API cannot be empty.",
ERR_REMOVE_EVENT_NO_EVENT:"The event cannot be removed because it does not exist.",ERR_REMOVE_EVENT_NOT_EXIST:"The following event cannot be removed because the name is not valid: ${0}.",ERR_EVENT_NAME_TYPE_REQUIRED_DESCITEM:"The values of the event name and type are missing for the descriptionItems JSON parameter.",ERR_EVENT_ALREADY_EXISTED:"The event name is already being used for this widget.",ERR_DYN_EVENT_ALREADY_EXIST:"The name of the dynamic event is already being used for this widget.",ERR_NOT_FIND_ATTRIBUTE:"The following attribute cannot be found because the name is wrong: ${0}.",
LOG_NO_MANAGEDIS:"The name provided for the ItemSet API cannot be found: ${0}.",EXCEPTION_CREATE_IFR_CONTAINER:"The following exception occurred when attempting to render a sandboxed iWidget: ${0},",ERR_MISSING_EE_CTX:"The gadget for the embedded experience cannot render because the context is missing.",ERR_CREATE_SERVICEMGR:"A severe error occurred when attempting to the create the service manager.",ERR_INVALID_RENDER_TYPE:"The following value of the render type parameter is not recognized:",ERR_CANT_LOAD_WIRE:"An error occurred when loading a wire from the server.",
ERR_INVALID_TYPE:"The value of the type parameter is not valid.",ERR_CANT_PRELOAD_WIDGET:"The following error occurred when preloading the widget:",ERR_CANT_LOAD_WIDGET:"The following error occurred when loading the widget:",ERR_INVALID_PARAM_OBJ:"The widget cannot load because the parameter object is not an array.",ERR_CANT_SET_USERPROFILE:"The following error occurred when setting the user profile:",ERR_INVALID_PARAM_TYPE:"The widget cannot load because the parameter type is invalid.",ERR_INVALID_COMPONENT_TYPE:"The widget or gadget cannot load because the component type is invalid.",
ERR_CANT_LOAD_CC_FEATURE:"An error occurred when loading a script for the common container.",ERR_CANT_INIT_CC:"An error occurred when attempting to initialize the common container for the gadget.",ERR_PROMISE_ALREADY_RESOLVED:"The Promise object is already resolved.",ERR_NOT_A_FUNC:"The parameter must be a function.",ERR_IS_NULL_UNDEFINED:"The following value is null or undefined:",ERR_INVALID_PARAM:"The parameter name is invalid.",ERR_CANT_SUPPORT_TYPE:"An error occurred because the following resource type is not supported:",
ERR_RESOURCE_NOT_ARRAY:"The parameter must be an array.",ERR_CANT_LOAD_SERVICE:"An error occurred when loading the service:",ERR_LOADING_XML:"An error occurred when passing the following XML string:",ERR_REQ_URL_UNDEFINED:"An internal error occurred when sending a request to the CRE server to load the widget.",LOG_NO_GADGETS_TO_PRELOAD:"No gadgets exist on the page for preloading.",ERR_CANT_LOAD_IMAGE_SYNC:"The image cannot be loaded synchronously.",ERR_CREATE_ISCOPE:"The iScope object for the widget cannot be created.",
ERR_CANT_CHANGE_MODE:"${0} can't switch mode.",LOG_EVALUATION_RESULT_IS_UNDEFINED:"The evaluation result of the eval'ed js is undefined, the resource url is ${0}.",LOG_NAVAIGATE_AWAY:"Navigate Away from the current page?",WARN_DATA_NOT_SAVED:"Data you have entered may not be saved.\nPress OK to continue, or Cancel to stay on the current page.",ERR_LOAD_EXTERNAL_JS:"Failed to load external javascript file.",ERR_INVALID_STRING_PARAM:"The parameter is not a string: ${0}.",ERR_INVALID_OBJECT_PARAM:"The parameter is not a object: ${0}.",
ERR_INVALID_BOOLEAN_PARAM:"The parameter is not a boolean: ${0}.",ERR_INVALID_ARRAY_PARAM:"The parameter is not a array: ${0}.",ERR_INVALID_COMPONENT_TYPE:"The parameter is not a component type: ${0}.",ERR_INVALID_RENDER_TYPE:"The parameter is not a render type: ${0}.",ERR_INVALID_WIDGET_STATE:"The parameter is not a widget state: ${0}.",ERR_OVERRIDE_EXISTENT_METADATA:"Can't override existent widget metadata: ${0}.",ERR_RENDER_PARAMS_NOT_FOUND:"The associated render parameters is not found: ${0}.",
ERR_INSTANCE_PARAMS_NOT_FOUND:"The associated instance parameters is not found: ${0}.",ERR_WIDGET_METADATA_NOT_FOUND:"The associated widget metadata is not found: ${0}.",ERR_ONLY_SUPPORT_IWIDGET:"This action is only supported by iWidget.",ERR_ONLY_SUPPORT_GADGET:"This action is only supported by gadget."};__preOnLoadHandlers="undefined"!==typeof window.__preOnLoadHandlers?window.__preOnLoadHandlers:[];
__preOnLoadHandlers.push(function(){gadgets.config.init({container:{relayPath:"/connections/opensocial/gadgets/files/container/rpc_relay.html",enableRpcArbitration:!0},rpc:{passReferrer:"c2p:query",commSwf:"/connections/opensocial/xpc.swf",useLegacyProtocol:!1,parentRelayUrl:"/container/rpc_relay.html",rpcDelay:1},"core.io":{unparseableCruft:"throw 1; \x3c 'invalid javascript' \x3e",nonceUrl:"//%host%/connections/opensocial/gadgets/nonceRequest",proxyUrl:"//apps.na.collabserv.com/connections/opensocial/gadgets/proxy%filename%?container\x3d%container%\x26refresh\x3d%refresh%\x26url\x3d%url%\x26stream\x3d%stream%%authz%%rewriteMime%",
jsonProxyUrl:"//%host%/connections/opensocial/gadgets/makeRequest",appendTokenAlways:!0},"osapi.services":{"gadgets.rpc":["container.listMethods"],"//%host%/connections/opensocial/rpc":"gadgets.supportedFields gadgets.cajole http.head http.post scpeople.get people.update legacy-scpeople.get http.delete activitystreams.delete gadgets.metadata activitystreams.supportedFields customlist.post gadgets.proxySupportedFields ublog.delete activitystreams.create gadgets.proxy cache.invalidate people.supportedFields http.put customlist.delete gadgets.cajaSupportedFields activitystreams.get customlist.put gadgets.js http.get gadgets.token ublog.create activitystreams.update legacy-scpeople.update system.listMethods gadgets.tokenSupportedFields customlist.get gadgets.jsSupportedFields people.get scpeople.supportedFields scpeople.update legacy-scpeople.supportedFields ublog.get".split(" ")},
osapi:{endPoints:["//%host%/connections/opensocial/rpc"]},opensocial:{invalidatePath:"http://%host%/connections/opensocial/rpc",domain:"shindig",path:"http://%host%/connections/opensocial/rpc",supportedFields:{activityEntry:"actor content generator icon id object published provider target title updated url verb".split(" "),person:["id",{name:["familyName","givenName","unstructured"]},"thumbnailUrl","profileUrl"],activity:"appId body bodyId externalId id mediaItems postedTime priority streamFaviconUrl streamSourceUrl streamTitle streamUrl templateParams title url userId".split(" ")},
enableCaja:!1},"cre.config":{container:"default"},"shindig-container":{serverBase:"/connections/opensocial/gadgets/"},views:{"default":{urlTemplate:"http://localhost/connections/opensocial/gadgets/default?{var}",isOnlyVisible:!1,aliases:["home","profile","canvas"]},canvas:{urlTemplate:"http://localhost/connections/opensocial/gadgets/canvas?{var}",isOnlyVisible:!0,aliases:["FULL_PAGE"]},profile:{urlTemplate:"http://localhost/connections/opensocial/gadgets/profile?{var}",isOnlyVisible:!1,aliases:["DASHBOARD",
"default"]}}})});(function(){"undefined"!=typeof featureSetsToLoad?featureSetsToLoad--:featureSetsToLoad=0})();window['___jsl']['l'] = (window['___jsl']['l'] || []).concat(['actions','com.ibm.connections.ee','com.ibm.connections.sharedialog','container','container.nongadget','core','cre.iruntime','cre.iwidget','cre.iwidget.event','cre.iwidget.itemset','cre.messages.en','cre.osgadget','cre.service.event','cre.service.people','cre.wire','embedded-experiences','ibm.connections.ee','ibm.connections.sharedialog','open-views','pubsub-2','rpc','selection','shared-script-frame','shindig.sha1','views']);