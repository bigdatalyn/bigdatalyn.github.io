
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="author" content="MarkdownViewer++" />
        <title>new 2</title>
        <style type="text/css">
            /* Avoid page breaks inside the most common attributes, especially for exports (i.e. PDF) */
td, h1, h2, h3, h4, h5, p, ul, ol, li {
    page-break-inside: avoid; 
}

            
        </style>
      </head>
    <body>
        <div class="textbox-content">
由于各种各样的原因导致SQL走错了索引，如果是统计信息问题那么重新收集统计信息，如果是索引失效，那么重建索引，使用outline/profile固定执行计划等等，本文介绍使用HINT及手工调整索引的cluster&nbsp;factor值快速调整SQL走的索引：
<br>
<br>首先验证索引的状态统计信息，以及哪个索引的选择性好：
<br><div class="ubbcode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Empty&nbsp;&nbsp;&nbsp;&nbsp;Chain&nbsp;Average&nbsp;Global&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sample&nbsp;Date
<br>TABLE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;Rows&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Blocks&nbsp;&nbsp;&nbsp;&nbsp;Count&nbsp;Row&nbsp;Len&nbsp;Stats&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Size&nbsp;MM-DD-YYYY
<br>------------------------------&nbsp;--------------&nbsp;---------------&nbsp;------------&nbsp;--------&nbsp;-------&nbsp;------&nbsp;--------------&nbsp;----------
<br>A_BIND_TEST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,002,017&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;31,71&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;17&nbsp;YES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;60,409&nbsp;03-29-2016
<br>Column&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Distinct&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sample&nbsp;Date
<br>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Values&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Density&nbsp;Buckets&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nulls&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Size&nbsp;MM-DD-YYYY
<br>------------------------------&nbsp;------------&nbsp;-----------&nbsp;-------&nbsp;------------&nbsp;--------------&nbsp;----------
<br>ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,000,010&nbsp;&nbsp;&nbsp;.00000100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;60,409&nbsp;03-29-2016
<br>NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;.33333333&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6,189&nbsp;03-29-2016
<br>AGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;1.00000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6,189&nbsp;03-29-2016
<br>ADDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;.50000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6,189&nbsp;03-29-2016
<br>SQL&gt;
<br>Index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Leaf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Distinct&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cluster&nbsp;Date
<br>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Blks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keys&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;Rows&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEA&nbsp;&nbsp;&nbsp;&nbsp;Data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Factor&nbsp;MM-DD-YYYY
<br>------------------------------&nbsp;---&nbsp;------------&nbsp;--------------&nbsp;--------------&nbsp;-------&nbsp;-------&nbsp;------------&nbsp;----------
<br>IND_ABT_ID_AGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,652&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;999,023&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,001,220&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3,194&nbsp;03-29-2016
<br>IND_ABT_ID_ADDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3,352&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;999,023&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,001,220&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3,196&nbsp;03-29-2016
<br>SQL&gt;
<br>Index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Column&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Col&nbsp;Column
<br>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pos&nbsp;Details
<br>------------------------------&nbsp;------------------------------&nbsp;----&nbsp;------------------------
<br>IND_ABT_ID_ADDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;NUMBER(22)
<br>IND_ABT_ID_ADDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;VARCHAR2(30)
<br>IND_ABT_ID_AGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;NUMBER(22)
<br>IND_ABT_ID_AGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;NUMBER(22)
<br>
<br>select&nbsp;*&nbsp;from&nbsp;A_BIND_TEST&nbsp;a&nbsp;where&nbsp;id=100&nbsp;and&nbsp;age=38&nbsp;and&nbsp;addr='BeiJing';
<br>
<br>SQL&gt;&nbsp;&nbsp;select&nbsp;id,addr,count(*)&nbsp;from&nbsp;A_BIND_TEST&nbsp;where&nbsp;id=100&nbsp;and&nbsp;age=38&nbsp;and&nbsp;addr='BeiJing'&nbsp;group&nbsp;by&nbsp;id,addr;
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ID&nbsp;ADDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COUNT(*)
<br>----------&nbsp;------------------------------&nbsp;----------
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;BeiJing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100
<br>
<br>SQL&gt;&nbsp;select&nbsp;id,age,count(*)&nbsp;from&nbsp;A_BIND_TEST&nbsp;where&nbsp;id=100&nbsp;and&nbsp;age=38&nbsp;&nbsp;&nbsp;group&nbsp;by&nbsp;id,age;
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AGE&nbsp;&nbsp;&nbsp;COUNT(*)
<br>----------&nbsp;----------&nbsp;----------
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2189</div>
<br>从上面可以看出，根据IND_ABT_ID_ADDR复合索引字段筛选出来的结果集明显要小很多，所以SQL应该走IND_ABT_ID_ADDR索引，通过使用HINT指定索引进一步验证：
<br><div class="ubbcode">select&nbsp;/*+&nbsp;index(a&nbsp;IND_ABT_ID_AGE)&nbsp;*/*&nbsp;from&nbsp;A_BIND_TEST&nbsp;a&nbsp;where&nbsp;id=100&nbsp;and&nbsp;age=38&nbsp;and&nbsp;addr='BeiJing';
<br>select&nbsp;/*+&nbsp;index(a&nbsp;IND_ABT_ID_ADDR)&nbsp;*/*&nbsp;from&nbsp;A_BIND_TEST&nbsp;a&nbsp;where&nbsp;id=100&nbsp;and&nbsp;age=38&nbsp;and&nbsp;addr='BeiJing';
<br>
<br>SQL&gt;&nbsp;&nbsp;select&nbsp;/*+&nbsp;index(a&nbsp;IND_ABT_ID_AGE)&nbsp;*/*&nbsp;from&nbsp;A_BIND_TEST&nbsp;where&nbsp;id=100&nbsp;and&nbsp;age=38&nbsp;and&nbsp;addr='BeiJing';
<br>
<br>100&nbsp;rows&nbsp;selected.
<br>
<br>Execution&nbsp;Plan
<br>----------------------------------------------------------
<br>Plan&nbsp;hash&nbsp;value:&nbsp;2733777954
<br>
<br>----------------------------------------------------------------------------------------------
<br>|&nbsp;Id&nbsp;&nbsp;|&nbsp;Operation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Rows&nbsp;&nbsp;|&nbsp;Bytes&nbsp;|&nbsp;Cost&nbsp;(%CPU)|&nbsp;Time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
<br>----------------------------------------------------------------------------------------------
<br>|&nbsp;&nbsp;&nbsp;0&nbsp;|&nbsp;SELECT&nbsp;STATEMENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;17&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;(0)|&nbsp;00:00:01&nbsp;|
<br>|*&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;TABLE&nbsp;ACCESS&nbsp;BY&nbsp;INDEX&nbsp;ROWID|&nbsp;A_BIND_TEST&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;17&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;(0)|&nbsp;00:00:01&nbsp;|
<br>|*&nbsp;&nbsp;2&nbsp;|&nbsp;&nbsp;&nbsp;INDEX&nbsp;RANGE&nbsp;SCAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;IND_ABT_ID_AGE&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;(0)|&nbsp;00:00:01&nbsp;|
<br>----------------------------------------------------------------------------------------------
<br>
<br>Predicate&nbsp;Information&nbsp;(identified&nbsp;by&nbsp;operation&nbsp;id):
<br>---------------------------------------------------
<br>
<br>&nbsp;&nbsp;&nbsp;1&nbsp;-&nbsp;filter("ADDR"='BeiJing')
<br>&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;access("ID"=100&nbsp;AND&nbsp;"AGE"=38)
<br>
<br>Statistics
<br>----------------------------------------------------------
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;recursive&nbsp;calls
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;db&nbsp;block&nbsp;gets
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;34&nbsp;&nbsp;consistent&nbsp;gets
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;physical&nbsp;reads
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;redo&nbsp;size
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2362&nbsp;&nbsp;bytes&nbsp;sent&nbsp;via&nbsp;SQL*Net&nbsp;to&nbsp;client
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;558&nbsp;&nbsp;bytes&nbsp;received&nbsp;via&nbsp;SQL*Net&nbsp;from&nbsp;client
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;SQL*Net&nbsp;roundtrips&nbsp;to/from&nbsp;client
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;sorts&nbsp;(memory)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;sorts&nbsp;(disk)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;rows&nbsp;processed
<br>
<br>SQL&gt;
<br>SQL&gt;&nbsp;select&nbsp;/*+&nbsp;index(a&nbsp;IND_ABT_ID_ADDR)&nbsp;*/*&nbsp;from&nbsp;A_BIND_TEST&nbsp;a&nbsp;where&nbsp;id=100&nbsp;and&nbsp;age=38&nbsp;and&nbsp;addr='BeiJing';
<br>
<br>100&nbsp;rows&nbsp;selected.
<br>
<br>Execution&nbsp;Plan
<br>----------------------------------------------------------
<br>Plan&nbsp;hash&nbsp;value:&nbsp;397368058
<br>
<br>-----------------------------------------------------------------------------------------------
<br>|&nbsp;Id&nbsp;&nbsp;|&nbsp;Operation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Rows&nbsp;&nbsp;|&nbsp;Bytes&nbsp;|&nbsp;Cost&nbsp;(%CPU)|&nbsp;Time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
<br>-----------------------------------------------------------------------------------------------
<br>|&nbsp;&nbsp;&nbsp;0&nbsp;|&nbsp;SELECT&nbsp;STATEMENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;17&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;(0)|&nbsp;00:00:01&nbsp;|
<br>|*&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;TABLE&nbsp;ACCESS&nbsp;BY&nbsp;INDEX&nbsp;ROWID|&nbsp;A_BIND_TEST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;17&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;(0)|&nbsp;00:00:01&nbsp;|
<br>|*&nbsp;&nbsp;2&nbsp;|&nbsp;&nbsp;&nbsp;INDEX&nbsp;RANGE&nbsp;SCAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;IND_ABT_ID_ADDR&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;(0)|&nbsp;00:00:01&nbsp;|
<br>-----------------------------------------------------------------------------------------------
<br>
<br>Predicate&nbsp;Information&nbsp;(identified&nbsp;by&nbsp;operation&nbsp;id):
<br>---------------------------------------------------
<br>
<br>&nbsp;&nbsp;&nbsp;1&nbsp;-&nbsp;filter("AGE"=38)
<br>&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;access("ID"=100&nbsp;AND&nbsp;"ADDR"='BeiJing')
<br>
<br>Statistics
<br>----------------------------------------------------------
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;recursive&nbsp;calls
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;db&nbsp;block&nbsp;gets
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;19&nbsp;&nbsp;consistent&nbsp;gets
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;physical&nbsp;reads
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;redo&nbsp;size
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2362&nbsp;&nbsp;bytes&nbsp;sent&nbsp;via&nbsp;SQL*Net&nbsp;to&nbsp;client
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;558&nbsp;&nbsp;bytes&nbsp;received&nbsp;via&nbsp;SQL*Net&nbsp;from&nbsp;client
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;SQL*Net&nbsp;roundtrips&nbsp;to/from&nbsp;client
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;sorts&nbsp;(memory)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;sorts&nbsp;(disk)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;&nbsp;rows&nbsp;processed</div>
<br>从上面可以看出执行统计信息看到，的确走IND_ABT_ID_ADDR索引的逻辑读要低一半，当然这种情况需要去改业务SQL，大多数情况下不允许临时调整业务代码。
<br>
<br>还可以手工通过调整索引cluster&nbsp;factor的值，然后将内存中SQL的执行计划置为失效，重新解析生成正确的执行计划。
<br>索引扫描COST的计算公式如下：
<br><div class="ubbcode">B*TREE&nbsp;INDEX&nbsp;RANGE&nbsp;SCAN&nbsp;(IRS)
<br>
<br>(Workload&nbsp;statistics&nbsp;are&nbsp;gathered)
<br>(CPU&nbsp;Costing&nbsp;is&nbsp;enabled)
<br>
<br>IRS&nbsp;Cost&nbsp;=&nbsp;I/O&nbsp;Cost&nbsp;+&nbsp;CPU&nbsp;Cost
<br>
<br>Note:
<br>&nbsp;&nbsp;I/O&nbsp;Cost&nbsp;=&nbsp;Index&nbsp;Access&nbsp;I/O&nbsp;Cost&nbsp;+&nbsp;Table&nbsp;Access&nbsp;I/O&nbsp;Cost
<br>&nbsp;&nbsp;&nbsp;&nbsp;Index&nbsp;Access&nbsp;I/O&nbsp;Cost&nbsp;=&nbsp;LVLS&nbsp;+&nbsp;CEIL(#LB&nbsp;*&nbsp;ix_sel)
<br>&nbsp;&nbsp;&nbsp;&nbsp;Table&nbsp;Access&nbsp;I/O&nbsp;Cost&nbsp;=&nbsp;CEIL(CLUF&nbsp;*&nbsp;ix_sel_with_filters)
<br>
<br>&nbsp;&nbsp;CPU&nbsp;Cost&nbsp;=&nbsp;ROUND(#CPUCycles/cpuspeed/1000/sreadtim)</div>
<br>其中CLUF即为cluster&nbsp;factor的值，其实可以手工调整公式中的任意值来达到目的，！另外需要注意的是调整之后需要确认是否影响到其他SQL！。
<br>简单测试一下通过调整CLUF值的方法，创建测试表和索引：
<br><div class="ubbcode">SQL&gt;&nbsp;select&nbsp;*&nbsp;from&nbsp;v$version
<br>&nbsp;&nbsp;2&nbsp;&nbsp;;
<br>
<br>BANNER
<br>----------------------------------------------------------------
<br>Oracle&nbsp;Database&nbsp;10g&nbsp;Enterprise&nbsp;Edition&nbsp;Release&nbsp;10.2.0.5.0&nbsp;-&nbsp;64bi
<br>PL/SQL&nbsp;Release&nbsp;10.2.0.5.0&nbsp;-&nbsp;Production
<br>CORE&nbsp;&nbsp;&nbsp;&nbsp;10.2.0.5.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Production
<br>TNS&nbsp;for&nbsp;Linux:&nbsp;Version&nbsp;10.2.0.5.0&nbsp;-&nbsp;Production
<br>NLSRTL&nbsp;Version&nbsp;10.2.0.5.0&nbsp;-&nbsp;Production
<br>
<br>create&nbsp;table&nbsp;t_clstfct_test&nbsp;as&nbsp;select&nbsp;*&nbsp;from&nbsp;dba_objects;
<br>create&nbsp;index&nbsp;IND_TCT_OID&nbsp;on&nbsp;t_clstfct_test(object_id);
<br>create&nbsp;index&nbsp;IND_TCT_ONAME&nbsp;on&nbsp;t_clstfct_test(object_name);
<br>
<br>Index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Leaf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Distinct&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cluster&nbsp;Date
<br>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Blks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keys&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;Rows&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEA&nbsp;&nbsp;&nbsp;&nbsp;Data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Factor&nbsp;MM-DD-YYYY
<br>------------------------------&nbsp;---&nbsp;------------&nbsp;--------------&nbsp;--------------&nbsp;-------&nbsp;-------&nbsp;------------&nbsp;----------
<br>IND_TCT_OID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;154&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;69,547&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;69,547&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,772&nbsp;03-30-2016
<br>IND_TCT_ONAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;339&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;38,504&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;69,547&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;37,834&nbsp;03-30-2016</div>
<br>从上面可以看出，IND_TCT_OID索引的CLUF值比IND_TCT_ONAME索引的CLUF值要低很多，再默认情况下IND_TCT_OID索引的选择性会高一些，也就是在两个字段同事出现在where条件后会走IND_TCT_OID索引：
<br><div class="ubbcode">SQL&gt;&nbsp;select&nbsp;*&nbsp;from&nbsp;table(dbms_xplan.display_cursor('','','advanced'));
<br>
<br>PLAN_TABLE_OUTPUT
<br>--------------------------------------------------------------------------------------------------------------------------------------------
<br>SQL_ID&nbsp;&nbsp;9mnapsj9sjhyb,&nbsp;child&nbsp;number&nbsp;1
<br>-------------------------------------
<br>select&nbsp;count(*)&nbsp;from&nbsp;t_clstfct_test&nbsp;where&nbsp;OBJECT_ID=100&nbsp;and&nbsp;OBJECT_NAME='XXXX'
<br>
<br>Plan&nbsp;hash&nbsp;value:&nbsp;379601504
<br>
<br>-----------------------------------------------------------------------------------------------
<br>|&nbsp;Id&nbsp;&nbsp;|&nbsp;Operation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Rows&nbsp;&nbsp;|&nbsp;Bytes&nbsp;|&nbsp;Cost&nbsp;(%CPU)|&nbsp;Time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
<br>-----------------------------------------------------------------------------------------------
<br>|&nbsp;&nbsp;&nbsp;0&nbsp;|&nbsp;SELECT&nbsp;STATEMENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;(100)|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
<br>|&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;SORT&nbsp;AGGREGATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;79&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
<br>|*&nbsp;&nbsp;2&nbsp;|&nbsp;&nbsp;&nbsp;TABLE&nbsp;ACCESS&nbsp;BY&nbsp;INDEX&nbsp;ROWID|&nbsp;T_CLSTFCT_TEST&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;|&nbsp;&nbsp;&nbsp;474&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;(0)|&nbsp;00:00:01&nbsp;|
<br>|*&nbsp;&nbsp;3&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;INDEX&nbsp;RANGE&nbsp;SCAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;IND_TCT_OID&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;11&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;(0)|&nbsp;00:00:01&nbsp;|
<br>-----------------------------------------------------------------------------------------------
<br>
<br>Query&nbsp;Block&nbsp;Name&nbsp;/&nbsp;Object&nbsp;Alias&nbsp;(identified&nbsp;by&nbsp;operation&nbsp;id):
<br>-------------------------------------------------------------
<br>
<br>&nbsp;&nbsp;&nbsp;1&nbsp;-&nbsp;SEL$1
<br>&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;SEL$1&nbsp;/&nbsp;T_CLSTFCT_TEST@SEL$1
<br>&nbsp;&nbsp;&nbsp;3&nbsp;-&nbsp;SEL$1&nbsp;/&nbsp;T_CLSTFCT_TEST@SEL$1
<br>
<br>Outline&nbsp;Data
<br>-------------
<br>
<br>&nbsp;&nbsp;/*+
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN_OUTLINE_DATA
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IGNORE_OPTIM_EMBEDDED_HINTS
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OPTIMIZER_FEATURES_ENABLE('10.2.0.5')
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALL_ROWS
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTLINE_LEAF(@"SEL$1")
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INDEX_RS_ASC(@"SEL$1"&nbsp;"T_CLSTFCT_TEST"@"SEL$1"&nbsp;("T_CLSTFCT_TEST"."OBJECT_ID"))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END_OUTLINE_DATA
<br>&nbsp;&nbsp;*/
<br>
<br>Predicate&nbsp;Information&nbsp;(identified&nbsp;by&nbsp;operation&nbsp;id):
<br>---------------------------------------------------
<br>
<br>&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;filter("OBJECT_NAME"='XXXX')
<br>&nbsp;&nbsp;&nbsp;3&nbsp;-&nbsp;access("OBJECT_ID"=100)
<br>
<br>Column&nbsp;Projection&nbsp;Information&nbsp;(identified&nbsp;by&nbsp;operation&nbsp;id):
<br>-----------------------------------------------------------
<br>
<br>&nbsp;&nbsp;&nbsp;1&nbsp;-&nbsp;(#keys=0)&nbsp;COUNT(*)[22]
<br>&nbsp;&nbsp;&nbsp;3&nbsp;-&nbsp;"T_CLSTFCT_TEST".ROWID[ROWID,10]
<br>
<br>Note
<br>-----
<br>&nbsp;&nbsp;&nbsp;-&nbsp;dynamic&nbsp;sampling&nbsp;used&nbsp;for&nbsp;this&nbsp;statement
<br>
<br>51&nbsp;rows&nbsp;selected.</div>
<br>接下来我们通过手工设置两个索引的CLUF值，并通过赋权的操作让内存中的执行计划失效：
<br><div class="ubbcode">exec&nbsp;DBMS_STATS.SET_INDEX_STATS('AWEN','IND_TCT_OID',clstfct=&gt;100000);
<br>exec&nbsp;DBMS_STATS.SET_INDEX_STATS('AWEN','IND_TCT_ONAME',clstfct=&gt;100);
<br>
<br>Index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Leaf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Distinct&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cluster&nbsp;Date
<br>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Blks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keys&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;Rows&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEA&nbsp;&nbsp;&nbsp;&nbsp;Data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Factor&nbsp;MM-DD-YYYY
<br>------------------------------&nbsp;---&nbsp;------------&nbsp;--------------&nbsp;--------------&nbsp;-------&nbsp;-------&nbsp;------------&nbsp;----------
<br>IND_TCT_OID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;154&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;69,547&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;69,547&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100,000&nbsp;03-30-2016
<br>IND_TCT_ONAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;339&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;38,504&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;69,547&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100&nbsp;03-30-2016
<br>
<br>SQL&gt;&nbsp;GRANT&nbsp;SELECT&nbsp;on&nbsp;awen.T_CLSTFCT_TEST&nbsp;to&nbsp;system;
<br>
<br>Grant&nbsp;succeeded.</div>
<br>再次运行SQL，发现SQL已经走了IND_TCT_ONAME索引：
<br><div class="ubbcode">SQL&gt;&nbsp;&nbsp;select&nbsp;count(*)&nbsp;from&nbsp;t_clstfct_test&nbsp;where&nbsp;OBJECT_ID=100&nbsp;and&nbsp;OBJECT_NAME='XXXX';
<br>
<br>&nbsp;&nbsp;COUNT(*)
<br>----------
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0
<br>
<br>SQL&gt;&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;table(dbms_xplan.display_cursor('','','advanced'));
<br>
<br>PLAN_TABLE_OUTPUT
<br>--------------------------------------------------------------------------------------------------------------------------------------------
<br>SQL_ID&nbsp;&nbsp;8wnqf3d192ram,&nbsp;child&nbsp;number&nbsp;0
<br>-------------------------------------
<br>&nbsp;select&nbsp;count(*)&nbsp;from&nbsp;t_clstfct_test&nbsp;where&nbsp;OBJECT_ID=100&nbsp;and&nbsp;OBJECT_NAME='XXXX'
<br>
<br>Plan&nbsp;hash&nbsp;value:&nbsp;2253870163
<br>
<br>-----------------------------------------------------------------------------------------------
<br>|&nbsp;Id&nbsp;&nbsp;|&nbsp;Operation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Rows&nbsp;&nbsp;|&nbsp;Bytes&nbsp;|&nbsp;Cost&nbsp;(%CPU)|&nbsp;Time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
<br>-----------------------------------------------------------------------------------------------
<br>|&nbsp;&nbsp;&nbsp;0&nbsp;|&nbsp;SELECT&nbsp;STATEMENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;(100)|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
<br>|&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;SORT&nbsp;AGGREGATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;79&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
<br>|*&nbsp;&nbsp;2&nbsp;|&nbsp;&nbsp;&nbsp;TABLE&nbsp;ACCESS&nbsp;BY&nbsp;INDEX&nbsp;ROWID|&nbsp;T_CLSTFCT_TEST&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;|&nbsp;&nbsp;&nbsp;474&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;(0)|&nbsp;00:00:01&nbsp;|
<br>|*&nbsp;&nbsp;3&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;INDEX&nbsp;RANGE&nbsp;SCAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;IND_TCT_ONAME&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;11&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;(0)|&nbsp;00:00:01&nbsp;|
<br>-----------------------------------------------------------------------------------------------
<br>
<br>Query&nbsp;Block&nbsp;Name&nbsp;/&nbsp;Object&nbsp;Alias&nbsp;(identified&nbsp;by&nbsp;operation&nbsp;id):
<br>-------------------------------------------------------------
<br>
<br>&nbsp;&nbsp;&nbsp;1&nbsp;-&nbsp;SEL$1
<br>&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;SEL$1&nbsp;/&nbsp;T_CLSTFCT_TEST@SEL$1
<br>&nbsp;&nbsp;&nbsp;3&nbsp;-&nbsp;SEL$1&nbsp;/&nbsp;T_CLSTFCT_TEST@SEL$1
<br>
<br>Outline&nbsp;Data
<br>-------------
<br>
<br>&nbsp;&nbsp;/*+
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN_OUTLINE_DATA
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IGNORE_OPTIM_EMBEDDED_HINTS
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OPTIMIZER_FEATURES_ENABLE('10.2.0.5')
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALL_ROWS
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTLINE_LEAF(@"SEL$1")
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INDEX_RS_ASC(@"SEL$1"&nbsp;"T_CLSTFCT_TEST"@"SEL$1"&nbsp;("T_CLSTFCT_TEST"."OBJECT_NAME"))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END_OUTLINE_DATA
<br>&nbsp;&nbsp;*/
<br>
<br>Predicate&nbsp;Information&nbsp;(identified&nbsp;by&nbsp;operation&nbsp;id):
<br>---------------------------------------------------
<br>
<br>&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;filter("OBJECT_ID"=100)
<br>&nbsp;&nbsp;&nbsp;3&nbsp;-&nbsp;access("OBJECT_NAME"='XXXX')
<br>
<br>Column&nbsp;Projection&nbsp;Information&nbsp;(identified&nbsp;by&nbsp;operation&nbsp;id):
<br>-----------------------------------------------------------
<br>
<br>&nbsp;&nbsp;&nbsp;1&nbsp;-&nbsp;(#keys=0)&nbsp;COUNT(*)[22]
<br>&nbsp;&nbsp;&nbsp;3&nbsp;-&nbsp;"T_CLSTFCT_TEST".ROWID[ROWID,10]
<br>
<br>Note
<br>-----
<br>&nbsp;&nbsp;&nbsp;-&nbsp;dynamic&nbsp;sampling&nbsp;used&nbsp;for&nbsp;this&nbsp;statement
<br>
<br>51&nbsp;rows&nbsp;selected.</div>
<br>这里需要注意的是，再调整完之后EXPLAIN的执行计划变了，但是实际的执行计划缺没变，这是因为SQL沿用了内存中的执行计划，直到下次SQL重新硬解析才有可能改变执行计划。关于让SQL重新解析的方法有很多，也就是将SQL对应共享词中的share&nbsp;cursor置为失效，常见的方法有如下几种：
<br>1、收集统计信息时指定no_invalidate=false
<br>no_invalidate=false会让内存中的执行计划失效，重新解析：
<br><div class="ubbcode">exec&nbsp;DBMS_STATS.GATHER_TABLE_STATS(OWNNAME&nbsp;=&gt;&nbsp;'AWEN',TABNAME&nbsp;=&gt;&nbsp;'A_BIND_TEST',DEGREE&nbsp;=&gt;&nbsp;5,&nbsp;CASCADE&nbsp;=&gt;&nbsp;TRUE,ESTIMATE_PERCENT&nbsp;=&gt;&nbsp;DBMS_STATS.AUTO_SAMPLE_SIZE,METHOD_OPT=&gt;'for&nbsp;all&nbsp;columns&nbsp;size&nbsp;1',no_invalidate=&gt;false);</div>
<br>2、对象上执行DDL
<br>常见的就是赋权和添加注释，这种方法最快
<br><div class="ubbcode">grant&nbsp;select&nbsp;on&nbsp;table&nbsp;to&nbsp;system;
<br>
<br>comment&nbsp;on&nbsp;table&nbsp;table_name&nbsp;is&nbsp;'tab_comments';
<br>comment&nbsp;on&nbsp;column&nbsp;table.column_name&nbsp;is&nbsp;'col_comments';
<br>
<br>select&nbsp;*&nbsp;from&nbsp;dba_table_coments&nbsp;where&nbsp;table_name='TABLE_NAME';</div>
<br>3、直接使用dbms_shared_pool.purge清除内存中的执行计划
<br><div class="ubbcode">select&nbsp;sql_id,&nbsp;address,&nbsp;hash_value,&nbsp;executions,&nbsp;loads,&nbsp;parse_calls,&nbsp;invalidations&nbsp;from&nbsp;v$sqlarea&nbsp;where&nbsp;sql_id&nbsp;in&nbsp;&nbsp;('0nxb3h8d3n3jp')--('awcbdcc4hdxj5',&nbsp;&nbsp;'5k0hn1ku734dg');
<br>
<br>exec&nbsp;dbms_shared_pool.purge('00000026F954FD78,2001276846',&nbsp;'c');</div>
</div>

    </body>
</html>
            
